Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-09-18 14:30:22.721712: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-18 14:30:22.902067: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-09-18 14:30:22.905550: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa743770 executing computations on platform Host. Devices:
2019-09-18 14:30:22.905577: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Standard data
zero :  7189
one :  7122

First data
zero :  7189
one :  7122

hbase-CAST
After set document size of train data, the number of zero and one label data :  6474 6406
After set document size of test data, the number of zero and one label data :  714 716

Sentence length Average : 123

Under 10 : 804
Over 10, Under 30 : 1551
Over 30, Under 100 : 4648
Over 100, Under 150 : 2497
Over 150, Under 200 : 1802
Over 200, Under 400 : 2858
Over 400 : 150

After balance out data.
hbase-CAST

Sentence length Average : 123

Under 10 : 804
Over 10, Under 30 : 1551
Over 30, Under 100 : 4648
Over 100, Under 150 : 2497
Over 150, Under 200 : 1802
Over 200, Under 400 : 2858
Over 400 : 150

Loaded model from disk
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 597, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 597, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
(1430, 597, 200)

0~10

Test accuracy: 91.0

data size :  12980

test data size :  100

zero :  6527

one :  6453

train_zero :  6474

train_one :  6406

test_zero :  53

test_one :  47

choose_zero :  48

choose_one :  52

F1score :  0.9090909090909091

AUC :  0.9160979526294661

Confusion Matrix
[[46  7]
 [ 2 45]]
True label 0
0.8679245283018868  
0.1320754716981132  
True label 1
0.0425531914893617  
0.9574468085106383  

10~20

Test accuracy: 76.37795275590551

data size :  13007

test data size :  127

zero :  6539

one :  6468

train_zero :  6474

train_one :  6406

test_zero :  65

test_one :  62

choose_zero :  59

choose_one :  68

F1score :  0.7692307692307693

AUC :  0.8722084367245657

Confusion Matrix
[[47 18]
 [12 50]]
True label 0
0.7230769230769231  
0.27692307692307694  
True label 1
0.1935483870967742  
0.8064516129032258  

20~30

Test accuracy: 82.5531914893617

data size :  13115

test data size :  235

zero :  6600

one :  6515

train_zero :  6474

train_one :  6406

test_zero :  126

test_one :  109

choose_zero :  121

choose_one :  114

F1score :  0.8161434977578476

AUC :  0.8855395369156838

Confusion Matrix
[[103  23]
 [ 18  91]]
True label 0
0.8174603174603174  
0.18253968253968253  
True label 1
0.1651376146788991  
0.8348623853211009  

30~40

Test accuracy: 80.7017543859649

data size :  13051

test data size :  171

zero :  6552

one :  6499

train_zero :  6474

train_one :  6406

test_zero :  78

test_one :  93

choose_zero :  67

choose_one :  104

F1score :  0.83248730964467

AUC :  0.8855114419630548

Confusion Matrix
[[56 22]
 [11 82]]
True label 0
0.717948717948718  
0.28205128205128205  
True label 1
0.11827956989247312  
0.8817204301075269  

40~50

Test accuracy: 83.05084745762711

data size :  12998

test data size :  118

zero :  6535

one :  6463

train_zero :  6474

train_one :  6406

test_zero :  61

test_one :  57

choose_zero :  57

choose_one :  61

F1score :  0.8305084745762712

AUC :  0.90882945067587

Confusion Matrix
[[49 12]
 [ 8 49]]
True label 0
0.8032786885245902  
0.19672131147540983  
True label 1
0.14035087719298245  
0.8596491228070176  

50~60

Test accuracy: 77.18120805369128

data size :  13029

test data size :  149

zero :  6549

one :  6480

train_zero :  6474

train_one :  6406

test_zero :  75

test_one :  74

choose_zero :  69

choose_one :  80

F1score :  0.7792207792207791

AUC :  0.8632432432432433

Confusion Matrix
[[55 20]
 [14 60]]
True label 0
0.7333333333333333  
0.26666666666666666  
True label 1
0.1891891891891892  
0.8108108108108109  

60~70

Test accuracy: 84.61538461538461

data size :  12984

test data size :  104

zero :  6514

one :  6470

train_zero :  6474

train_one :  6406

test_zero :  40

test_one :  64

choose_zero :  42

choose_one :  62

F1score :  0.8730158730158729

AUC :  0.89140625

Confusion Matrix
[[33  7]
 [ 9 55]]
True label 0
0.825  
0.175  
True label 1
0.140625  
0.859375  

70~80

Test accuracy: 78.35051546391753

data size :  12977

test data size :  97

zero :  6523

one :  6454

train_zero :  6474

train_one :  6406

test_zero :  49

test_one :  48

choose_zero :  44

choose_one :  53

F1score :  0.7920792079207922

AUC :  0.8579931972789115

Confusion Matrix
[[36 13]
 [ 8 40]]
True label 0
0.7346938775510204  
0.2653061224489796  
True label 1
0.16666666666666666  
0.8333333333333334  

80~90

Test accuracy: 74.19354838709677

data size :  12942

test data size :  62

zero :  6504

one :  6438

train_zero :  6474

train_one :  6406

test_zero :  30

test_one :  32

choose_zero :  28

choose_one :  34

F1score :  0.7575757575757576

AUC :  0.7947916666666667

Confusion Matrix
[[21  9]
 [ 7 25]]
True label 0
0.7  
0.3  
True label 1
0.21875  
0.78125  

90~100

Test accuracy: 76.19047619047619

data size :  12943

test data size :  63

zero :  6506

one :  6437

train_zero :  6474

train_one :  6406

test_zero :  32

test_one :  31

choose_zero :  31

choose_one :  32

F1score :  0.7619047619047619

AUC :  0.8286290322580645

Confusion Matrix
[[24  8]
 [ 7 24]]
True label 0
0.75  
0.25  
True label 1
0.22580645161290322  
0.7741935483870968  

100~110

Test accuracy: 84.0

data size :  12930

test data size :  50

zero :  6503

one :  6427

train_zero :  6474

train_one :  6406

test_zero :  29

test_one :  21

choose_zero :  27

choose_one :  23

F1score :  0.8181818181818182

AUC :  0.9261083743842364

Confusion Matrix
[[24  5]
 [ 3 18]]
True label 0
0.8275862068965517  
0.1724137931034483  
True label 1
0.14285714285714285  
0.8571428571428571  

110~120

Test accuracy: 79.06976744186046

data size :  12923

test data size :  43

zero :  6496

one :  6427

train_zero :  6474

train_one :  6406

test_zero :  22

test_one :  21

choose_zero :  29

choose_one :  14

F1score :  0.742857142857143

AUC :  0.8658008658008658

Confusion Matrix
[[21  1]
 [ 8 13]]
True label 0
0.9545454545454546  
0.045454545454545456  
True label 1
0.38095238095238093  
0.6190476190476191  

120~130

Test accuracy: 87.87878787878788

data size :  12913

test data size :  33

zero :  6495

one :  6418

train_zero :  6474

train_one :  6406

test_zero :  21

test_one :  12

choose_zero :  21

choose_one :  12

F1score :  0.8333333333333334

AUC :  0.9642857142857143

Confusion Matrix
[[19  2]
 [ 2 10]]
True label 0
0.9047619047619048  
0.09523809523809523  
True label 1
0.16666666666666666  
0.8333333333333334  

130~140

Test accuracy: 88.88888888888889

data size :  12907

test data size :  27

zero :  6487

one :  6420

train_zero :  6474

train_one :  6406

test_zero :  13

test_one :  14

choose_zero :  12

choose_one :  15

F1score :  0.896551724137931

AUC :  0.9615384615384615

Confusion Matrix
[[11  2]
 [ 1 13]]
True label 0
0.8461538461538461  
0.15384615384615385  
True label 1
0.07142857142857142  
0.9285714285714286  

140~150

Test accuracy: 85.71428571428571

data size :  12894

test data size :  14

zero :  6479

one :  6415

train_zero :  6474

train_one :  6406

test_zero :  5

test_one :  9

choose_zero :  7

choose_one :  7

F1score :  0.8750000000000001

AUC :  0.9333333333333333

Confusion Matrix
[[5 0]
 [2 7]]
True label 0
1.0  
0.0  
True label 1
0.2222222222222222  
0.7777777777777778  

150~160

Test accuracy: 87.5

data size :  12904

test data size :  24

zero :  6484

one :  6420

train_zero :  6474

train_one :  6406

test_zero :  10

test_one :  14

choose_zero :  9

choose_one :  15

F1score :  0.896551724137931

AUC :  0.9785714285714286

Confusion Matrix
[[ 8  2]
 [ 1 13]]
True label 0
0.8  
0.2  
True label 1
0.07142857142857142  
0.9285714285714286  

160~170

Test accuracy: 75.0

data size :  12888

test data size :  8

zero :  6477

one :  6411

train_zero :  6474

train_one :  6406

test_zero :  3

test_one :  5

choose_zero :  3

choose_one :  5

F1score :  0.8000000000000002

AUC :  0.9333333333333333

Confusion Matrix
[[2 1]
 [1 4]]
True label 0
0.6666666666666666  
0.3333333333333333  
True label 1
0.2  
0.8  

170~180

Test accuracy: 80.0

data size :  12885

test data size :  5

zero :  6476

one :  6409

train_zero :  6474

train_one :  6406

test_zero :  2

test_one :  3

choose_zero :  1

choose_one :  4

F1score :  0.8571428571428571

AUC :  0.8333333333333333

Confusion Matrix
[[1 1]
 [0 3]]
True label 0
0.5  
0.5  
True label 1
0.0  
1.0  

180~190

190~200

200~210

210~220

220~230

230~240

240~250

250~260

260~270

270~280

280~290

290~300

300~310

310~320

320~330

330~340

340~350

350~360

360~370

370~380

380~390

390~400

400~410

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 07:28:16.579938: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-16 07:28:16.586315: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-16 07:28:16.588655: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8ef82f0 executing computations on platform Host. Devices:
2019-10-16 07:28:16.588701: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:93: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

Third data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

196
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
guava-CAST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-CAST

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

401
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 196, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 196, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 401, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 401, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          147840      concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 128)          32896       dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 64)           8256        dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 32)           2080        dense_5[0][0]                    
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            66          dense_6_task_layer[0][0]         
==================================================================================================
Total params: 1,851,106
Trainable params: 926,626
Non-trainable params: 924,480
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:24 - loss: 1.1284 - acc: 0.5938
 128/1000 [==>...........................] - ETA: 43s - loss: 1.0182 - acc: 0.4922 
 192/1000 [====>.........................] - ETA: 29s - loss: 0.9290 - acc: 0.4948
 256/1000 [======>.......................] - ETA: 21s - loss: 0.8475 - acc: 0.5273
 320/1000 [========>.....................] - ETA: 17s - loss: 0.7872 - acc: 0.5656
 384/1000 [==========>...................] - ETA: 13s - loss: 0.7578 - acc: 0.5859
 448/1000 [============>.................] - ETA: 11s - loss: 0.7611 - acc: 0.5893
 512/1000 [==============>...............] - ETA: 9s - loss: 0.7521 - acc: 0.5918 
 576/1000 [================>.............] - ETA: 7s - loss: 0.7295 - acc: 0.6024
 640/1000 [==================>...........] - ETA: 6s - loss: 0.7109 - acc: 0.6109
 704/1000 [====================>.........] - ETA: 4s - loss: 0.7088 - acc: 0.6136
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6961 - acc: 0.6263
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6852 - acc: 0.6334
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6807 - acc: 0.6362
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6777 - acc: 0.6375
1000/1000 [==============================] - 14s 14ms/step - loss: 0.6737 - acc: 0.6390

Test accuracy: 70.27201376196108

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  6755

choose_one :  11847

F1score :  0.73729216152019

AUC :  0.8130846303339218

Confusion Matrix
[[5312 4087]
 [1443 7760]]
True label 0
0.5651665070752208  
0.43483349292477924  
True label 1
0.1567966967293274  
0.8432033032706726  

Train_result {'loss': [0.6736550974845886], 'acc': [0.6390000004768371]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5092 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4999 - acc: 0.7188
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5012 - acc: 0.7292
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4944 - acc: 0.7422
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4960 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4958 - acc: 0.7500
 448/1000 [============>.................] - ETA: 4s - loss: 0.5042 - acc: 0.7478
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4991 - acc: 0.7559
 576/1000 [================>.............] - ETA: 3s - loss: 0.4940 - acc: 0.7587
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4885 - acc: 0.7547
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5042 - acc: 0.7457
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5008 - acc: 0.7461
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5105 - acc: 0.7416
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5033 - acc: 0.7489
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4947 - acc: 0.7521
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4943 - acc: 0.7530

Test accuracy: 74.66939038813031

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8711

choose_one :  9891

F1score :  0.7532209070912328

AUC :  0.8495601746688461

Confusion Matrix
[[6699 2700]
 [2012 7191]]
True label 0
0.7127353973827003  
0.2872646026172997  
True label 1
0.21862436162121046  
0.7813756383787895  

Train_result {'loss': [0.4943062970638275], 'acc': [0.7529999990463256]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4690 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4127 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4217 - acc: 0.7917
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4083 - acc: 0.8164
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4091 - acc: 0.8125
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4209 - acc: 0.7943
 448/1000 [============>.................] - ETA: 4s - loss: 0.4124 - acc: 0.8036
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4153 - acc: 0.8086
 576/1000 [================>.............] - ETA: 3s - loss: 0.4123 - acc: 0.8056
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4047 - acc: 0.8094
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4038 - acc: 0.8082
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4019 - acc: 0.8047
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3968 - acc: 0.8089
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3947 - acc: 0.8080
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3908 - acc: 0.8125
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3903 - acc: 0.8130

Test accuracy: 78.69583915707989

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10362

choose_one :  8240

F1score :  0.7728028435475549

AUC :  0.8747614611068842

Confusion Matrix
[[7899 1500]
 [2463 6740]]
True label 0
0.8404085541015002  
0.15959144589849983  
True label 1
0.26763012061284364  
0.7323698793871564  

Train_result {'loss': [0.39028515696525573], 'acc': [0.8129999995231628]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3016 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3327 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3190 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3304 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3685 - acc: 0.8531
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3598 - acc: 0.8542
 448/1000 [============>.................] - ETA: 5s - loss: 0.3502 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3480 - acc: 0.8652
 576/1000 [================>.............] - ETA: 3s - loss: 0.3419 - acc: 0.8681
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3454 - acc: 0.8594
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3517 - acc: 0.8580
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3498 - acc: 0.8607
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3457 - acc: 0.8570
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3424 - acc: 0.8560
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3456 - acc: 0.8542
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3409 - acc: 0.8540

Test accuracy: 79.65810127943232

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9927

choose_one :  8675

F1score :  0.7883432151247343

AUC :  0.8866989174452509

Confusion Matrix
[[7771 1628]
 [2156 7047]]
True label 0
0.8267900840514948  
0.17320991594850516  
True label 1
0.23427143322829513  
0.7657285667717049  

Train_result {'loss': [0.34085775089263914], 'acc': [0.8540000009536743]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2833 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2848 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2959 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2776 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2693 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2887 - acc: 0.8672
 448/1000 [============>.................] - ETA: 4s - loss: 0.2965 - acc: 0.8661
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3024 - acc: 0.8691
 576/1000 [================>.............] - ETA: 3s - loss: 0.3003 - acc: 0.8681
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2895 - acc: 0.8719
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2922 - acc: 0.8679
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2906 - acc: 0.8672
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2920 - acc: 0.8666
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2906 - acc: 0.8661
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2903 - acc: 0.8688
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2959 - acc: 0.8650

Test accuracy: 80.0397806687453

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10222

choose_one :  8380

F1score :  0.7888301200022748

AUC :  0.8930945985419922

Confusion Matrix
[[7954 1445]
 [2268 6935]]
True label 0
0.8462602404511118  
0.1537397595488882  
True label 1
0.24644137781158318  
0.7535586221884168  

Train_result {'loss': [0.2958777053356171], 'acc': [0.8649999990463256]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2358 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2461 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2301 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2390 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2508 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2505 - acc: 0.9010
 448/1000 [============>.................] - ETA: 4s - loss: 0.2428 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2470 - acc: 0.8945
 576/1000 [================>.............] - ETA: 3s - loss: 0.2590 - acc: 0.8906
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2646 - acc: 0.8906
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2593 - acc: 0.8949
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2619 - acc: 0.8919
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2618 - acc: 0.8906
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2573 - acc: 0.8929
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2502 - acc: 0.8969
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2528 - acc: 0.8970

Test accuracy: 80.6418664659714

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9654

choose_one :  8948

F1score :  0.8016087267919123

AUC :  0.8964428974823835

Confusion Matrix
[[7726 1673]
 [1928 7275]]
True label 0
0.8220023406745398  
0.17799765932546016  
True label 1
0.20949690318374442  
0.7905030968162555  

Train_result {'loss': [0.25280634641647337], 'acc': [0.8969999990463257]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1096 - acc: 0.9844
 128/1000 [==>...........................] - ETA: 7s - loss: 0.1673 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1605 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1813 - acc: 0.9492
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1829 - acc: 0.9406
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1899 - acc: 0.9349
 448/1000 [============>.................] - ETA: 5s - loss: 0.1837 - acc: 0.9353
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1869 - acc: 0.9316
 576/1000 [================>.............] - ETA: 3s - loss: 0.1967 - acc: 0.9253
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1953 - acc: 0.9266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1907 - acc: 0.9290
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1901 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1897 - acc: 0.9303
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1996 - acc: 0.9241
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2109 - acc: 0.9219
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2069 - acc: 0.9230

Test accuracy: 81.69014084507043

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10029

choose_one :  8573

F1score :  0.8083933393339334

AUC :  0.9030161124296042

Confusion Matrix
[[8011 1388]
 [2018 7185]]
True label 0
0.8523247153952548  
0.1476752846047452  
True label 1
0.21927632293817234  
0.7807236770618277  

Train_result {'loss': [0.2069246722459793], 'acc': [0.9229999995231628]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2337 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1671 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1754 - acc: 0.9219
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1772 - acc: 0.9258
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1820 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1806 - acc: 0.9141
 448/1000 [============>.................] - ETA: 4s - loss: 0.1832 - acc: 0.9174
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1850 - acc: 0.9180
 576/1000 [================>.............] - ETA: 3s - loss: 0.1766 - acc: 0.9236
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1676 - acc: 0.9297
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1761 - acc: 0.9247
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1716 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1765 - acc: 0.9279
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1798 - acc: 0.9286
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1775 - acc: 0.9281
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1758 - acc: 0.9280

Test accuracy: 81.5234920976239

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9176

choose_one :  9426

F1score :  0.8155027108272048

AUC :  0.9020730610321411

Confusion Matrix
[[7569 1830]
 [1607 7596]]
True label 0
0.8052984360038302  
0.1947015639961698  
True label 1
0.1746169727262849  
0.825383027273715  

Train_result {'loss': [0.1758281707763672], 'acc': [0.9280000004768372]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1202 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1276 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1101 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1073 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1170 - acc: 0.9625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1211 - acc: 0.9583
 448/1000 [============>.................] - ETA: 4s - loss: 0.1223 - acc: 0.9576
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1314 - acc: 0.9512
 576/1000 [================>.............] - ETA: 3s - loss: 0.1257 - acc: 0.9514
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1236 - acc: 0.9547
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1409 - acc: 0.9460
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1446 - acc: 0.9440
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1483 - acc: 0.9435
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1427 - acc: 0.9464
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1468 - acc: 0.9448
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1453 - acc: 0.9460

Test accuracy: 81.51274056553058

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9330

choose_one :  9272

F1score :  0.8138565629228688

AUC :  0.90317792355442

Confusion Matrix
[[7645 1754]
 [1685 7518]]
True label 0
0.8133844025960209  
0.18661559740397915  
True label 1
0.1830924698467891  
0.8169075301532109  

Train_result {'loss': [0.14528543716669082], 'acc': [0.9460000009536743]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1601 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 7s - loss: 0.1204 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1326 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1237 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1400 - acc: 0.9500
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1524 - acc: 0.9453
 448/1000 [============>.................] - ETA: 4s - loss: 0.1470 - acc: 0.9442
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1469 - acc: 0.9434
 576/1000 [================>.............] - ETA: 3s - loss: 0.1395 - acc: 0.9479
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1403 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1453 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1415 - acc: 0.9414
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1388 - acc: 0.9423
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1378 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1339 - acc: 0.9448
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1354 - acc: 0.9440

Test accuracy: 81.08267928179765

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9272

choose_one :  9330

F1score :  0.810122484217342

AUC :  0.9005318061664923

Confusion Matrix
[[7576 1823]
 [1696 7507]]
True label 0
0.8060431960846899  
0.19395680391531014  
True label 1
0.18428773226121917  
0.8157122677387808  

Train_result {'loss': [0.13536440467834474], 'acc': [0.9440000004768372]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.0487 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 7s - loss: 0.0616 - acc: 0.9844
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0899 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0887 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 5s - loss: 0.0927 - acc: 0.9625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1014 - acc: 0.9609
 448/1000 [============>.................] - ETA: 4s - loss: 0.1324 - acc: 0.9487
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1344 - acc: 0.9492
 576/1000 [================>.............] - ETA: 3s - loss: 0.1340 - acc: 0.9479
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1283 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1234 - acc: 0.9517
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1236 - acc: 0.9518
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1170 - acc: 0.9555
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1146 - acc: 0.9565
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1160 - acc: 0.9563
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1194 - acc: 0.9560

Test accuracy: 81.71164390925708

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8875

choose_one :  9727

F1score :  0.8202852614896988

AUC :  0.9031486630995269

Confusion Matrix
[[7436 1963]
 [1439 7764]]
True label 0
0.7911479944674965  
0.20885200553250347  
True label 1
0.15636205585135282  
0.8436379441486472  

Train_result {'loss': [0.11943172812461852], 'acc': [0.9559999995231628]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.0800 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0626 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0614 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 7s - loss: 0.0681 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0649 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0659 - acc: 0.9740
 448/1000 [============>.................] - ETA: 5s - loss: 0.0770 - acc: 0.9688
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0856 - acc: 0.9648
 576/1000 [================>.............] - ETA: 3s - loss: 0.0930 - acc: 0.9618
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1060 - acc: 0.9563
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1105 - acc: 0.9531
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1073 - acc: 0.9544
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1056 - acc: 0.9567
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1065 - acc: 0.9576
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1047 - acc: 0.9594
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1138 - acc: 0.9570

Test accuracy: 80.00215030641866

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7957

choose_one :  10645

F1score :  0.8125755743651754

AUC :  0.8993697059863017

Confusion Matrix
[[6818 2581]
 [1139 8064]]
True label 0
0.7253963187573146  
0.2746036812426854  
True label 1
0.12376399000325981  
0.8762360099967402  

Train_result {'loss': [0.11383417177200317], 'acc': [0.9569999990463257]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1131 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1048 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0901 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0914 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0936 - acc: 0.9563
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0894 - acc: 0.9635
 448/1000 [============>.................] - ETA: 4s - loss: 0.0853 - acc: 0.9665
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0929 - acc: 0.9609
 576/1000 [================>.............] - ETA: 3s - loss: 0.0908 - acc: 0.9635
 640/1000 [==================>...........] - ETA: 3s - loss: 0.0915 - acc: 0.9641
 704/1000 [====================>.........] - ETA: 2s - loss: 0.0872 - acc: 0.9659
 768/1000 [======================>.......] - ETA: 2s - loss: 0.0876 - acc: 0.9648
 832/1000 [=======================>......] - ETA: 1s - loss: 0.0935 - acc: 0.9627
 896/1000 [=========================>....] - ETA: 0s - loss: 0.0989 - acc: 0.9598
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0995 - acc: 0.9604
1000/1000 [==============================] - 9s 9ms/step - loss: 0.0963 - acc: 0.9620

Test accuracy: 81.79765616600365

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9895

choose_one :  8707

F1score :  0.8109436069235064

AUC :  0.9033069077089992

Confusion Matrix
[[7954 1445]
 [1941 7262]]
True label 0
0.8462602404511118  
0.1537397595488882  
True label 1
0.2109094860371618  
0.7890905139628382  

Train_result {'loss': [0.09633044227957725], 'acc': [0.962]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1450 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1067 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0897 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0768 - acc: 0.9766
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0820 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0840 - acc: 0.9688
 448/1000 [============>.................] - ETA: 4s - loss: 0.0836 - acc: 0.9688
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0834 - acc: 0.9668
 576/1000 [================>.............] - ETA: 3s - loss: 0.0825 - acc: 0.9670
 640/1000 [==================>...........] - ETA: 3s - loss: 0.0768 - acc: 0.9688
 704/1000 [====================>.........] - ETA: 2s - loss: 0.0859 - acc: 0.9631
 768/1000 [======================>.......] - ETA: 1s - loss: 0.0816 - acc: 0.9661
 832/1000 [=======================>......] - ETA: 1s - loss: 0.0913 - acc: 0.9651
 896/1000 [=========================>....] - ETA: 0s - loss: 0.0893 - acc: 0.9654
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0903 - acc: 0.9646
1000/1000 [==============================] - 9s 9ms/step - loss: 0.0897 - acc: 0.9650

Test accuracy: 81.51274056553058

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9786

choose_one :  8816

F1score :  0.8091459015483656

AUC :  0.9007420166964479

Confusion Matrix
[[7873 1526]
 [1913 7290]]
True label 0
0.8376423023725929  
0.16235769762740718  
True label 1
0.20786699989133978  
0.7921330001086602  

Train_result {'loss': [0.08972800570726394], 'acc': [0.9650000009536743]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.0337 - acc: 0.9844
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0713 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0885 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 7s - loss: 0.0774 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0820 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1270 - acc: 0.9609
 448/1000 [============>.................] - ETA: 5s - loss: 0.1253 - acc: 0.9621
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1278 - acc: 0.9629
 576/1000 [================>.............] - ETA: 3s - loss: 0.1164 - acc: 0.9670
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1129 - acc: 0.9688
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1143 - acc: 0.9688
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1105 - acc: 0.9688
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1076 - acc: 0.9688
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1060 - acc: 0.9688
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1123 - acc: 0.9646
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1123 - acc: 0.9650

Test accuracy: 81.48048596925062

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9786

choose_one :  8816

F1score :  0.8088129196958765

AUC :  0.900548395954233

Confusion Matrix
[[7870 1529]
 [1916 7287]]
True label 0
0.8373231194807959  
0.16267688051920418  
True label 1
0.20819298054982072  
0.7918070194501793  

Train_result {'loss': [0.11234224730730057], 'acc': [0.9650000009536743]}
Saved model to disk


[[70.27201376196108, 1], [74.66939038813031, 2], [78.69583915707989, 3], [79.65810127943232, 4], [80.0397806687453, 5], [80.6418664659714, 6], [81.69014084507043, 7], [81.5234920976239, 8], [81.51274056553058, 9], [81.08267928179765, 10], [81.71164390925708, 11], [80.00215030641866, 12], [81.79765616600365, 13], [81.51274056553058, 14], [81.48048596925062, 15]]
max accuracy :  [81.79765616600365, 13]

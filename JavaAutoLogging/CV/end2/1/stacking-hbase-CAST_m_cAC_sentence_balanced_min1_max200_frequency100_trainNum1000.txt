Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-12 06:48:29.456141: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-12 06:48:29.484950: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-12 06:48:29.487922: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8aa3240 executing computations on platform Host. Devices:
2019-10-12 06:48:29.487968: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:86: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

Third data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

188
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
hbase-CAST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-CAST

Sentence length Average : 52

Under 10 : 2622
Over 10, Under 30 : 6971
Over 30, Under 100 : 7184
Over 100, Under 150 : 1632
Over 150, Under 200 : 757
Over 200, Under 400 : 688
Over 400 : 1

630
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 188, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 188, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 630, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 630, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1_task_layer (Dense)      (None, 256)          98560       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2_task_layer (Dense)      (None, 128)          32896       dense_1_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_2_task_layer[0][0]         
==================================================================================================
Total params: 945,794
Trainable params: 538,754
Non-trainable params: 407,040
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:28 - loss: 0.6751 - acc: 0.5781
 128/1000 [==>...........................] - ETA: 47s - loss: 0.6969 - acc: 0.5469 
 192/1000 [====>.........................] - ETA: 33s - loss: 0.6671 - acc: 0.5938
 256/1000 [======>.......................] - ETA: 25s - loss: 0.6646 - acc: 0.5938
 320/1000 [========>.....................] - ETA: 20s - loss: 0.6546 - acc: 0.6062
 384/1000 [==========>...................] - ETA: 17s - loss: 0.6499 - acc: 0.6120
 448/1000 [============>.................] - ETA: 14s - loss: 0.6395 - acc: 0.6228
 512/1000 [==============>...............] - ETA: 12s - loss: 0.6276 - acc: 0.6406
 576/1000 [================>.............] - ETA: 9s - loss: 0.6285 - acc: 0.6493 
 640/1000 [==================>...........] - ETA: 8s - loss: 0.6439 - acc: 0.6453
 704/1000 [====================>.........] - ETA: 6s - loss: 0.6386 - acc: 0.6520
 768/1000 [======================>.......] - ETA: 4s - loss: 0.6384 - acc: 0.6523
 832/1000 [=======================>......] - ETA: 3s - loss: 0.6358 - acc: 0.6550
 896/1000 [=========================>....] - ETA: 2s - loss: 0.6253 - acc: 0.6618
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6187 - acc: 0.6635
1000/1000 [==============================] - 20s 20ms/step - loss: 0.6208 - acc: 0.6650

Test accuracy: 70.83532219570405

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  6902

choose_one :  11953

F1score :  0.7435287533230727

AUC :  0.7993673600910663

Confusion Matrix
[[5385 3982]
 [1517 7971]]
True label 0
0.5748905732892068  
0.4251094267107932  
True label 1
0.15988617200674538  
0.8401138279932546  

Train_result {'acc': [0.6649999995231628], 'loss': [0.620772171497345]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.5931 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5546 - acc: 0.6641
 192/1000 [====>.........................] - ETA: 10s - loss: 0.5331 - acc: 0.6979
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5251 - acc: 0.7031 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5283 - acc: 0.7156
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5464 - acc: 0.7057
 448/1000 [============>.................] - ETA: 7s - loss: 0.5295 - acc: 0.7210
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5295 - acc: 0.7266
 576/1000 [================>.............] - ETA: 5s - loss: 0.5345 - acc: 0.7292
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5340 - acc: 0.7344
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5214 - acc: 0.7443
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5163 - acc: 0.7435
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5203 - acc: 0.7416
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5223 - acc: 0.7366
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5231 - acc: 0.7365
1000/1000 [==============================] - 13s 13ms/step - loss: 0.5226 - acc: 0.7380

Test accuracy: 74.5107398568019

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8643

choose_one :  10212

F1score :  0.7560406091370558

AUC :  0.8222231481263111

Confusion Matrix
[[6602 2765]
 [2041 7447]]
True label 0
0.7048147752749012  
0.2951852247250987  
True label 1
0.21511382799325462  
0.7848861720067454  

Train_result {'acc': [0.7379999990463257], 'loss': [0.5226133775711059]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.5947 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5123 - acc: 0.7578
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5103 - acc: 0.7396
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4963 - acc: 0.7539
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5035 - acc: 0.7562 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5017 - acc: 0.7656
 448/1000 [============>.................] - ETA: 7s - loss: 0.5003 - acc: 0.7612
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4916 - acc: 0.7676
 576/1000 [================>.............] - ETA: 5s - loss: 0.4851 - acc: 0.7708
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4854 - acc: 0.7719
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4840 - acc: 0.7756
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4776 - acc: 0.7760
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4758 - acc: 0.7788
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4680 - acc: 0.7868
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4678 - acc: 0.7885
1000/1000 [==============================] - 13s 13ms/step - loss: 0.4629 - acc: 0.7890

Test accuracy: 75.23203394325112

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8129

choose_one :  10726

F1score :  0.7689719996042347

AUC :  0.8328678752467986

Confusion Matrix
[[6413 2954]
 [1716 7772]]
True label 0
0.6846375573822996  
0.3153624426177004  
True label 1
0.1808600337268128  
0.8191399662731872  

Train_result {'acc': [0.7890000004768372], 'loss': [0.46290192437171934]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.4085 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4666 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4796 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4448 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4434 - acc: 0.7969 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4368 - acc: 0.8073
 448/1000 [============>.................] - ETA: 7s - loss: 0.4368 - acc: 0.8125
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4309 - acc: 0.8125
 576/1000 [================>.............] - ETA: 5s - loss: 0.4184 - acc: 0.8194
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4233 - acc: 0.8125
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4179 - acc: 0.8139
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4228 - acc: 0.8125
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4244 - acc: 0.8125
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4229 - acc: 0.8147
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4268 - acc: 0.8104
1000/1000 [==============================] - 13s 13ms/step - loss: 0.4295 - acc: 0.8060

Test accuracy: 76.74356934500133

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9352

choose_one :  9503

F1score :  0.769101153177821

AUC :  0.8461576363038337

Confusion Matrix
[[7167 2200]
 [2185 7303]]
True label 0
0.7651329134194512  
0.23486708658054872  
True label 1
0.23029089376053963  
0.7697091062394603  

Train_result {'acc': [0.8059999995231628], 'loss': [0.4295431592464447]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.3296 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4322 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3750 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3760 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 9s - loss: 0.3662 - acc: 0.8375 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.3556 - acc: 0.8411
 448/1000 [============>.................] - ETA: 7s - loss: 0.3452 - acc: 0.8527
 512/1000 [==============>...............] - ETA: 6s - loss: 0.3553 - acc: 0.8516
 576/1000 [================>.............] - ETA: 5s - loss: 0.3468 - acc: 0.8576
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3592 - acc: 0.8531
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3589 - acc: 0.8509
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3590 - acc: 0.8477
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3582 - acc: 0.8462
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3651 - acc: 0.8393
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3728 - acc: 0.8333
1000/1000 [==============================] - 13s 13ms/step - loss: 0.3714 - acc: 0.8360

Test accuracy: 77.59215062317688

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9582

choose_one :  9273

F1score :  0.7747987847129685

AUC :  0.8519733185246688

Confusion Matrix
[[7362 2005]
 [2220 7268]]
True label 0
0.785950677911818  
0.21404932208818192  
True label 1
0.2339797639123103  
0.7660202360876898  

Train_result {'acc': [0.8359999990463257], 'loss': [0.37136655259132384]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.2229 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 12s - loss: 0.2902 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3301 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3308 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 9s - loss: 0.3303 - acc: 0.8531 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.3197 - acc: 0.8542
 448/1000 [============>.................] - ETA: 7s - loss: 0.3183 - acc: 0.8482
 512/1000 [==============>...............] - ETA: 6s - loss: 0.3281 - acc: 0.8398
 576/1000 [================>.............] - ETA: 5s - loss: 0.3339 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3262 - acc: 0.8422
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3268 - acc: 0.8423
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3320 - acc: 0.8424
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3361 - acc: 0.8401
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3352 - acc: 0.8426
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3305 - acc: 0.8448
1000/1000 [==============================] - 13s 13ms/step - loss: 0.3316 - acc: 0.8430

Test accuracy: 77.51259612834792

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10099

choose_one :  8756

F1score :  0.7675948256961193

AUC :  0.8528414680021049

Confusion Matrix
[[7613 1754]
 [2486 7002]]
True label 0
0.8127468773353261  
0.18725312266467387  
True label 1
0.26201517706576727  
0.7379848229342327  

Train_result {'acc': [0.8430000004768372], 'loss': [0.33163525223731993]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.2608 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3102 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3220 - acc: 0.8542
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3058 - acc: 0.8594
 320/1000 [========>.....................] - ETA: 9s - loss: 0.2959 - acc: 0.8719 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.3047 - acc: 0.8750
 448/1000 [============>.................] - ETA: 7s - loss: 0.2929 - acc: 0.8795
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2928 - acc: 0.8809
 576/1000 [================>.............] - ETA: 5s - loss: 0.2903 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 4s - loss: 0.2976 - acc: 0.8766
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3030 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3055 - acc: 0.8698
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3012 - acc: 0.8762
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3039 - acc: 0.8728
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3076 - acc: 0.8729
1000/1000 [==============================] - 13s 13ms/step - loss: 0.3012 - acc: 0.8750

Test accuracy: 78.17555025192256

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9608

choose_one :  9247

F1score :  0.7803576194288764

AUC :  0.8563797262140365

Confusion Matrix
[[7430 1937]
 [2178 7310]]
True label 0
0.7932102060424896  
0.2067897939575104  
True label 1
0.2295531197301855  
0.7704468802698144  

Train_result {'acc': [0.8750000004768371], 'loss': [0.30118289911746976]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.2939 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 12s - loss: 0.2575 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 10s - loss: 0.2405 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 9s - loss: 0.2440 - acc: 0.9023 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.2614 - acc: 0.8969
 384/1000 [==========>...................] - ETA: 8s - loss: 0.2541 - acc: 0.9010
 448/1000 [============>.................] - ETA: 7s - loss: 0.2544 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2432 - acc: 0.9043
 576/1000 [================>.............] - ETA: 5s - loss: 0.2576 - acc: 0.8976
 640/1000 [==================>...........] - ETA: 4s - loss: 0.2484 - acc: 0.9047
 704/1000 [====================>.........] - ETA: 3s - loss: 0.2537 - acc: 0.9034
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2501 - acc: 0.9023
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2647 - acc: 0.8942
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2584 - acc: 0.8984
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2616 - acc: 0.8969
1000/1000 [==============================] - 13s 13ms/step - loss: 0.2609 - acc: 0.8970

Test accuracy: 77.65579421904005

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8582

choose_one :  10273

F1score :  0.7868022873336369

AUC :  0.8568059077641701

Confusion Matrix
[[6868 2499]
 [1714 7774]]
True label 0
0.7332123411978222  
0.26678765880217786  
True label 1
0.18064924114671163  
0.8193507588532883  

Train_result {'acc': [0.8969999990463257], 'loss': [0.26092012989521024]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.1682 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 12s - loss: 0.2099 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 11s - loss: 0.2147 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1992 - acc: 0.9023
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1970 - acc: 0.9062 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.2032 - acc: 0.9036
 448/1000 [============>.................] - ETA: 7s - loss: 0.2082 - acc: 0.9107
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2005 - acc: 0.9121
 576/1000 [================>.............] - ETA: 5s - loss: 0.2154 - acc: 0.9062
 640/1000 [==================>...........] - ETA: 4s - loss: 0.2085 - acc: 0.9109
 704/1000 [====================>.........] - ETA: 3s - loss: 0.2049 - acc: 0.9162
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2114 - acc: 0.9141
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2151 - acc: 0.9111
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2163 - acc: 0.9118
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2169 - acc: 0.9094
1000/1000 [==============================] - 13s 13ms/step - loss: 0.2152 - acc: 0.9100

Test accuracy: 78.1012993900822

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8896

choose_one :  9959

F1score :  0.7876793335733019

AUC :  0.8569805424518748

Confusion Matrix
[[7067 2300]
 [1829 7659]]
True label 0
0.754457136756699  
0.24554286324330096  
True label 1
0.1927698145025295  
0.8072301854974705  

Train_result {'acc': [0.9100000004768372], 'loss': [0.21518867599964142]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.1902 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 11s - loss: 0.1597 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1746 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 10s - loss: 0.2022 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1918 - acc: 0.9375 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1965 - acc: 0.9323
 448/1000 [============>.................] - ETA: 7s - loss: 0.2033 - acc: 0.9263
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2036 - acc: 0.9219
 576/1000 [================>.............] - ETA: 5s - loss: 0.1993 - acc: 0.9253
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1943 - acc: 0.9250
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1916 - acc: 0.9247
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1925 - acc: 0.9271
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1967 - acc: 0.9243
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1959 - acc: 0.9241
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1960 - acc: 0.9240
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1940 - acc: 0.9250

Test accuracy: 77.78838504375497

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9879

choose_one :  8976

F1score :  0.7731802426343155

AUC :  0.854537153323056

Confusion Matrix
[[7529 1838]
 [2350 7138]]
True label 0
0.8037792249386143  
0.19622077506138572  
True label 1
0.24768128161888703  
0.752318718381113  

Train_result {'acc': [0.9249999995231628], 'loss': [0.19400334537029265]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.1396 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1601 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1783 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 9s - loss: 0.1596 - acc: 0.9414 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1585 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1670 - acc: 0.9375
 448/1000 [============>.................] - ETA: 7s - loss: 0.1707 - acc: 0.9308
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1639 - acc: 0.9336
 576/1000 [================>.............] - ETA: 5s - loss: 0.1689 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1730 - acc: 0.9281
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1694 - acc: 0.9276
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1654 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1632 - acc: 0.9315
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1674 - acc: 0.9297
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1679 - acc: 0.9302
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1646 - acc: 0.9320

Test accuracy: 77.9368867674357

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10155

choose_one :  8700

F1score :  0.7712777655597097

AUC :  0.8561344185149293

Confusion Matrix
[[7681 1686]
 [2474 7014]]
True label 0
0.8200064054659977  
0.17999359453400235  
True label 1
0.2607504215851602  
0.7392495784148398  

Train_result {'acc': [0.9320000009536743], 'loss': [0.16461717975139617]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.1334 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1305 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1546 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1737 - acc: 0.9492
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1628 - acc: 0.9500 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1703 - acc: 0.9427
 448/1000 [============>.................] - ETA: 7s - loss: 0.1609 - acc: 0.9464
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1617 - acc: 0.9434
 576/1000 [================>.............] - ETA: 5s - loss: 0.1694 - acc: 0.9410
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1631 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1551 - acc: 0.9474
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1590 - acc: 0.9453
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1611 - acc: 0.9435
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1616 - acc: 0.9420
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1709 - acc: 0.9396
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1695 - acc: 0.9390

Test accuracy: 77.9262795014585

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9507

choose_one :  9348

F1score :  0.7790401359099597

AUC :  0.8551976438668922

Confusion Matrix
[[7356 2011]
 [2151 7337]]
True label 0
0.785310131312053  
0.21468986868794704  
True label 1
0.22670741989881957  
0.7732925801011804  

Train_result {'acc': [0.9390000004768372], 'loss': [0.16950426304340363]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.0581 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1106 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 11s - loss: 0.1100 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1062 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 9s - loss: 0.0976 - acc: 0.9594 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.0967 - acc: 0.9583
 448/1000 [============>.................] - ETA: 7s - loss: 0.0901 - acc: 0.9643
 512/1000 [==============>...............] - ETA: 6s - loss: 0.0971 - acc: 0.9609
 576/1000 [================>.............] - ETA: 5s - loss: 0.1012 - acc: 0.9583
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1034 - acc: 0.9578
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1179 - acc: 0.9545
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1185 - acc: 0.9531
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1209 - acc: 0.9519
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1197 - acc: 0.9520
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1214 - acc: 0.9500
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1244 - acc: 0.9480

Test accuracy: 77.80959957570937

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9997

choose_one :  8858

F1score :  0.7719393873323885

AUC :  0.8528564273666424

Confusion Matrix
[[7590 1777]
 [2407 7081]]
True label 0
0.8102914487028932  
0.18970855129710687  
True label 1
0.25368887015177066  
0.7463111298482293  

Train_result {'acc': [0.9479999990463257], 'loss': [0.12439673268795014]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.0479 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 11s - loss: 0.0921 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1298 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 9s - loss: 0.1271 - acc: 0.9531 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1291 - acc: 0.9437
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1246 - acc: 0.9479
 448/1000 [============>.................] - ETA: 7s - loss: 0.1287 - acc: 0.9464
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1354 - acc: 0.9414
 576/1000 [================>.............] - ETA: 5s - loss: 0.1453 - acc: 0.9358
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1428 - acc: 0.9375
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1380 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1402 - acc: 0.9401
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1420 - acc: 0.9375
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1462 - acc: 0.9353
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1393 - acc: 0.9396
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1356 - acc: 0.9410

Test accuracy: 77.58154335719968

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9692

choose_one :  9163

F1score :  0.7733633585330546

AUC :  0.8483729049688449

Confusion Matrix
[[7416 1951]
 [2276 7212]]
True label 0
0.7917155973097043  
0.20828440269029572  
True label 1
0.23988195615514335  
0.7601180438448567  

Train_result {'acc': [0.9410000009536743], 'loss': [0.1356075204014778]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.1414 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1288 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1104 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1283 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1306 - acc: 0.9469 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1287 - acc: 0.9479
 448/1000 [============>.................] - ETA: 7s - loss: 0.1239 - acc: 0.9509
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1194 - acc: 0.9531
 576/1000 [================>.............] - ETA: 5s - loss: 0.1155 - acc: 0.9549
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1150 - acc: 0.9547
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1159 - acc: 0.9545
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1143 - acc: 0.9557
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1188 - acc: 0.9567
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1209 - acc: 0.9531
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1184 - acc: 0.9531
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1222 - acc: 0.9510

Test accuracy: 78.22858658180853

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8702

choose_one :  10153

F1score :  0.7909984216689578

AUC :  0.8591306740267716

Confusion Matrix
[[6982 2385]
 [1720 7768]]
True label 0
0.7453827265933597  
0.2546172734066403  
True label 1
0.1812816188870152  
0.8187183811129848  

Train_result {'acc': [0.9509999990463257], 'loss': [0.12219141995906829]}
Saved model to disk


[[70.83532219570405, 1], [74.5107398568019, 2], [75.23203394325112, 3], [76.74356934500133, 4], [77.59215062317688, 5], [77.51259612834792, 6], [78.17555025192256, 7], [77.65579421904005, 8], [78.1012993900822, 9], [77.78838504375497, 10], [77.9368867674357, 11], [77.9262795014585, 12], [77.80959957570937, 13], [77.58154335719968, 14], [78.22858658180853, 15]]
max accuracy :  [78.22858658180853, 15]

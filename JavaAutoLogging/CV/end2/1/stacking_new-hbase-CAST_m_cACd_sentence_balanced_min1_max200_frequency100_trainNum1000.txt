Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 06:03:04.164384: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-16 06:03:04.171104: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-16 06:03:04.171980: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa5ed750 executing computations on platform Host. Devices:
2019-10-16 06:03:04.171999: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:149: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

Third data
zero :  9858
one :  9997

4th data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

188
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
hbase-CAST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-CAST

Sentence length Average : 52

Under 10 : 2622
Over 10, Under 30 : 6971
Over 30, Under 100 : 7184
Over 100, Under 150 : 1632
Over 150, Under 200 : 757
Over 200, Under 400 : 688
Over 400 : 1

631
hbase-depth_num
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-depth_num

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5218
Over 100, Under 150 : 727
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 188, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 188, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 631, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 631, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 431, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          262656      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 768)          393984      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 512)          393728      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          131328      dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            130         dense_6_task_layer[0][0]         
==================================================================================================
Total params: 3,523,010
Trainable params: 1,765,698
Non-trainable params: 1,757,312
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:24 - loss: 1.3610 - acc: 0.5469
 128/1000 [==>...........................] - ETA: 1:16 - loss: 1.0837 - acc: 0.5938
 192/1000 [====>.........................] - ETA: 52s - loss: 0.9744 - acc: 0.5781 
 256/1000 [======>.......................] - ETA: 40s - loss: 0.9400 - acc: 0.5352
 320/1000 [========>.....................] - ETA: 32s - loss: 0.9248 - acc: 0.5219
 384/1000 [==========>...................] - ETA: 26s - loss: 0.9092 - acc: 0.5208
 448/1000 [============>.................] - ETA: 21s - loss: 0.8796 - acc: 0.5335
 512/1000 [==============>...............] - ETA: 17s - loss: 0.8581 - acc: 0.5469
 576/1000 [================>.............] - ETA: 14s - loss: 0.8304 - acc: 0.5642
 640/1000 [==================>...........] - ETA: 11s - loss: 0.8174 - acc: 0.5672
 704/1000 [====================>.........] - ETA: 9s - loss: 0.8022 - acc: 0.5739 
 768/1000 [======================>.......] - ETA: 7s - loss: 0.7903 - acc: 0.5846
 832/1000 [=======================>......] - ETA: 5s - loss: 0.7792 - acc: 0.5925
 896/1000 [=========================>....] - ETA: 3s - loss: 0.7700 - acc: 0.5971
 960/1000 [===========================>..] - ETA: 1s - loss: 0.7623 - acc: 0.6052
1000/1000 [==============================] - 28s 28ms/step - loss: 0.7586 - acc: 0.6070

Test accuracy: 67.87059135507822

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10653

choose_one :  8202

F1score :  0.6575466365178066

AUC :  0.7165407510867958

Confusion Matrix
[[6981 2386]
 [3672 5816]]
True label 0
0.7452759688267322  
0.25472403117326786  
True label 1
0.38701517706576727  
0.6129848229342327  

Train_result {'loss': [0.7585820326805115], 'acc': [0.6069999990463257]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.6597 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 15s - loss: 0.6380 - acc: 0.7266
 192/1000 [====>.........................] - ETA: 14s - loss: 0.6427 - acc: 0.7031
 256/1000 [======>.......................] - ETA: 13s - loss: 0.6333 - acc: 0.7188
 320/1000 [========>.....................] - ETA: 11s - loss: 0.6322 - acc: 0.7125
 384/1000 [==========>...................] - ETA: 10s - loss: 0.6304 - acc: 0.7161
 448/1000 [============>.................] - ETA: 9s - loss: 0.6262 - acc: 0.7165 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.6221 - acc: 0.7266
 576/1000 [================>.............] - ETA: 7s - loss: 0.6174 - acc: 0.7309
 640/1000 [==================>...........] - ETA: 6s - loss: 0.6108 - acc: 0.7328
 704/1000 [====================>.........] - ETA: 5s - loss: 0.6110 - acc: 0.7315
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6033 - acc: 0.7357
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5990 - acc: 0.7380
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5994 - acc: 0.7333
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5945 - acc: 0.7344
1000/1000 [==============================] - 17s 17ms/step - loss: 0.5892 - acc: 0.7380

Test accuracy: 72.61734287987271

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10042

choose_one :  8813

F1score :  0.7178842686192011

AUC :  0.7923235641125397

Confusion Matrix
[[7123 2244]
 [2919 6569]]
True label 0
0.7604355716878403  
0.2395644283121597  
True label 1
0.30765177065767285  
0.6923482293423272  

Train_result {'loss': [0.5892251815795898], 'acc': [0.7379999995231629]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 19s - loss: 0.4912 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 16s - loss: 0.5208 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 15s - loss: 0.5388 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 13s - loss: 0.5385 - acc: 0.7734
 320/1000 [========>.....................] - ETA: 11s - loss: 0.5289 - acc: 0.7750
 384/1000 [==========>...................] - ETA: 10s - loss: 0.5315 - acc: 0.7682
 448/1000 [============>.................] - ETA: 9s - loss: 0.5244 - acc: 0.7679 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.5196 - acc: 0.7656
 576/1000 [================>.............] - ETA: 7s - loss: 0.5064 - acc: 0.7708
 640/1000 [==================>...........] - ETA: 6s - loss: 0.5016 - acc: 0.7719
 704/1000 [====================>.........] - ETA: 5s - loss: 0.4916 - acc: 0.7770
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4966 - acc: 0.7773
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5000 - acc: 0.7764
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4985 - acc: 0.7757
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4974 - acc: 0.7792
1000/1000 [==============================] - 17s 17ms/step - loss: 0.4950 - acc: 0.7810

Test accuracy: 74.64863431450543

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9301

choose_one :  9554

F1score :  0.7489759479046318

AUC :  0.8230605462361046

Confusion Matrix
[[6944 2423]
 [2357 7131]]
True label 0
0.7413259314615138  
0.2586740685384862  
True label 1
0.24841905564924116  
0.7515809443507588  

Train_result {'loss': [0.49501775312423707], 'acc': [0.7809999995231628]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 21s - loss: 0.4128 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 17s - loss: 0.4300 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 16s - loss: 0.3660 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 14s - loss: 0.3684 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 12s - loss: 0.3764 - acc: 0.8250
 384/1000 [==========>...................] - ETA: 11s - loss: 0.3829 - acc: 0.8281
 448/1000 [============>.................] - ETA: 10s - loss: 0.4042 - acc: 0.8170
 512/1000 [==============>...............] - ETA: 8s - loss: 0.4034 - acc: 0.8125 
 576/1000 [================>.............] - ETA: 7s - loss: 0.4085 - acc: 0.8090
 640/1000 [==================>...........] - ETA: 6s - loss: 0.4150 - acc: 0.8063
 704/1000 [====================>.........] - ETA: 5s - loss: 0.4130 - acc: 0.8040
 768/1000 [======================>.......] - ETA: 4s - loss: 0.4266 - acc: 0.7956
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4309 - acc: 0.7945
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4304 - acc: 0.7969
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4281 - acc: 0.7979
1000/1000 [==============================] - 18s 18ms/step - loss: 0.4269 - acc: 0.7990

Test accuracy: 75.11535401750199

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9851

choose_one :  9004

F1score :  0.7462686567164178

AUC :  0.83913361549129

Confusion Matrix
[[7263 2104]
 [2588 6900]]
True label 0
0.7753816590156933  
0.2246183409843066  
True label 1
0.2727655986509275  
0.7272344013490725  

Train_result {'loss': [0.4268746838569641], 'acc': [0.7989999995231628]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.3793 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 15s - loss: 0.3798 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 14s - loss: 0.3790 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 12s - loss: 0.3699 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 11s - loss: 0.3799 - acc: 0.8438
 384/1000 [==========>...................] - ETA: 10s - loss: 0.3986 - acc: 0.8255
 448/1000 [============>.................] - ETA: 9s - loss: 0.3894 - acc: 0.8304 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.3842 - acc: 0.8301
 576/1000 [================>.............] - ETA: 7s - loss: 0.3847 - acc: 0.8229
 640/1000 [==================>...........] - ETA: 6s - loss: 0.3770 - acc: 0.8250
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3747 - acc: 0.8253
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3713 - acc: 0.8255
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3656 - acc: 0.8305
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3588 - acc: 0.8337
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3619 - acc: 0.8344
1000/1000 [==============================] - 17s 17ms/step - loss: 0.3579 - acc: 0.8360

Test accuracy: 75.8207372049854

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9874

choose_one :  8981

F1score :  0.7531539336184958

AUC :  0.8459678903513121

Confusion Matrix
[[7341 2026]
 [2533 6955]]
True label 0
0.7837087648126401  
0.21629123518735988  
True label 1
0.26696880269814505  
0.733031197301855  

Train_result {'loss': [0.35794284677505495], 'acc': [0.836]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.2550 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 15s - loss: 0.2936 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 14s - loss: 0.2662 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 13s - loss: 0.3116 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 11s - loss: 0.3228 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 10s - loss: 0.3270 - acc: 0.8516
 448/1000 [============>.................] - ETA: 9s - loss: 0.3180 - acc: 0.8594 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.3284 - acc: 0.8516
 576/1000 [================>.............] - ETA: 7s - loss: 0.3312 - acc: 0.8524
 640/1000 [==================>...........] - ETA: 6s - loss: 0.3254 - acc: 0.8562
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3207 - acc: 0.8565
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3225 - acc: 0.8555
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3186 - acc: 0.8558
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3189 - acc: 0.8560
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3132 - acc: 0.8594
1000/1000 [==============================] - 17s 17ms/step - loss: 0.3151 - acc: 0.8610

Test accuracy: 75.85255900291699

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10094

choose_one :  8761

F1score :  0.7505068770891555

AUC :  0.8458461338385935

Confusion Matrix
[[7454 1913]
 [2640 6848]]
True label 0
0.7957723924415501  
0.20422760755844988  
True label 1
0.2782462057335582  
0.7217537942664418  

Train_result {'loss': [0.3151226878166199], 'acc': [0.8609999990463257]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.2040 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 15s - loss: 0.2524 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 13s - loss: 0.2639 - acc: 0.9010
 256/1000 [======>.......................] - ETA: 12s - loss: 0.2693 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 11s - loss: 0.2487 - acc: 0.9094
 384/1000 [==========>...................] - ETA: 10s - loss: 0.2364 - acc: 0.9141
 448/1000 [============>.................] - ETA: 9s - loss: 0.2450 - acc: 0.8996 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.2481 - acc: 0.8945
 576/1000 [================>.............] - ETA: 7s - loss: 0.2493 - acc: 0.8889
 640/1000 [==================>...........] - ETA: 5s - loss: 0.2614 - acc: 0.8844
 704/1000 [====================>.........] - ETA: 4s - loss: 0.2563 - acc: 0.8864
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2567 - acc: 0.8841
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2602 - acc: 0.8834
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2679 - acc: 0.8795
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2662 - acc: 0.8823
1000/1000 [==============================] - 17s 17ms/step - loss: 0.2763 - acc: 0.8760

Test accuracy: 76.88146380270486

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9106

choose_one :  9749

F1score :  0.7734054166450071

AUC :  0.8473646021670926

Confusion Matrix
[[7057 2310]
 [2049 7439]]
True label 0
0.7533895590904238  
0.24661044090957618  
True label 1
0.21595699831365936  
0.7840430016863407  

Train_result {'loss': [0.2763116588592529], 'acc': [0.8760000009536744]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 19s - loss: 0.2527 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 16s - loss: 0.2518 - acc: 0.9141
 192/1000 [====>.........................] - ETA: 14s - loss: 0.2532 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 12s - loss: 0.2442 - acc: 0.9141
 320/1000 [========>.....................] - ETA: 11s - loss: 0.2438 - acc: 0.9094
 384/1000 [==========>...................] - ETA: 10s - loss: 0.2473 - acc: 0.9089
 448/1000 [============>.................] - ETA: 9s - loss: 0.2384 - acc: 0.9174 
 512/1000 [==============>...............] - ETA: 7s - loss: 0.2366 - acc: 0.9141
 576/1000 [================>.............] - ETA: 6s - loss: 0.2433 - acc: 0.9132
 640/1000 [==================>...........] - ETA: 5s - loss: 0.2383 - acc: 0.9172
 704/1000 [====================>.........] - ETA: 4s - loss: 0.2317 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2313 - acc: 0.9141
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2344 - acc: 0.9123
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2266 - acc: 0.9163
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2265 - acc: 0.9146
1000/1000 [==============================] - 16s 16ms/step - loss: 0.2289 - acc: 0.9130

Test accuracy: 76.94510739856803

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10072

choose_one :  8783

F1score :  0.7620819878495977

AUC :  0.8496591571519333

Confusion Matrix
[[7546 1821]
 [2526 6962]]
True label 0
0.8055941069712822  
0.19440589302871783  
True label 1
0.2662310286677909  
0.7337689713322091  

Train_result {'loss': [0.22888575220108032], 'acc': [0.913]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 22s - loss: 0.2722 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 17s - loss: 0.2759 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 15s - loss: 0.2726 - acc: 0.9010
 256/1000 [======>.......................] - ETA: 13s - loss: 0.2589 - acc: 0.8984
 320/1000 [========>.....................] - ETA: 12s - loss: 0.2472 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 10s - loss: 0.2370 - acc: 0.9010
 448/1000 [============>.................] - ETA: 9s - loss: 0.2218 - acc: 0.9152 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.2065 - acc: 0.9238
 576/1000 [================>.............] - ETA: 7s - loss: 0.1975 - acc: 0.9288
 640/1000 [==================>...........] - ETA: 6s - loss: 0.2067 - acc: 0.9234
 704/1000 [====================>.........] - ETA: 5s - loss: 0.2109 - acc: 0.9233
 768/1000 [======================>.......] - ETA: 4s - loss: 0.2115 - acc: 0.9206
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2124 - acc: 0.9171
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2108 - acc: 0.9174
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2152 - acc: 0.9125
1000/1000 [==============================] - 17s 17ms/step - loss: 0.2098 - acc: 0.9160

Test accuracy: 76.7913020418987

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9601

choose_one :  9254

F1score :  0.7665137125173407

AUC :  0.8475862921857455

Confusion Matrix
[[7296 2071]
 [2305 7183]]
True label 0
0.7789046653144016  
0.2210953346855984  
True label 1
0.24293844856661045  
0.7570615514333895  

Train_result {'loss': [0.2098449346423149], 'acc': [0.916]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 24s - loss: 0.1539 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 19s - loss: 0.2073 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 17s - loss: 0.1980 - acc: 0.9062
 256/1000 [======>.......................] - ETA: 15s - loss: 0.2030 - acc: 0.9102
 320/1000 [========>.....................] - ETA: 13s - loss: 0.2133 - acc: 0.9062
 384/1000 [==========>...................] - ETA: 12s - loss: 0.2079 - acc: 0.9089
 448/1000 [============>.................] - ETA: 10s - loss: 0.1950 - acc: 0.9129
 512/1000 [==============>...............] - ETA: 9s - loss: 0.1902 - acc: 0.9121 
 576/1000 [================>.............] - ETA: 8s - loss: 0.1939 - acc: 0.9149
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1897 - acc: 0.9172
 704/1000 [====================>.........] - ETA: 5s - loss: 0.1878 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 4s - loss: 0.1778 - acc: 0.9245
 832/1000 [=======================>......] - ETA: 3s - loss: 0.1723 - acc: 0.9267
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1674 - acc: 0.9275
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1668 - acc: 0.9281
1000/1000 [==============================] - 19s 19ms/step - loss: 0.1656 - acc: 0.9290

Test accuracy: 76.971625563511

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8585

choose_one :  10270

F1score :  0.7802409150723756

AUC :  0.8483269973288954

Confusion Matrix
[[6805 2562]
 [1780 7708]]
True label 0
0.7264866019002882  
0.27351339809971176  
True label 1
0.1876053962900506  
0.8123946037099494  

Train_result {'loss': [0.1655583951473236], 'acc': [0.9289999995231628]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 20s - loss: 0.1403 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 17s - loss: 0.1434 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1444 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 13s - loss: 0.1289 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 12s - loss: 0.1375 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1785 - acc: 0.9297
 448/1000 [============>.................] - ETA: 9s - loss: 0.1739 - acc: 0.9330 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1651 - acc: 0.9355
 576/1000 [================>.............] - ETA: 7s - loss: 0.1585 - acc: 0.9358
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1474 - acc: 0.9422
 704/1000 [====================>.........] - ETA: 5s - loss: 0.1530 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1497 - acc: 0.9401
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1587 - acc: 0.9387
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1578 - acc: 0.9408
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1588 - acc: 0.9396
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1579 - acc: 0.9400

Test accuracy: 76.998143728454

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9744

choose_one :  9111

F1score :  0.7668154201838808

AUC :  0.8452960185384052

Confusion Matrix
[[7387 1980]
 [2357 7131]]
True label 0
0.7886196220775061  
0.21138037792249387  
True label 1
0.24841905564924116  
0.7515809443507588  

Train_result {'loss': [0.15791544938087462], 'acc': [0.9399999995231628]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 20s - loss: 0.1107 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 18s - loss: 0.1068 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 16s - loss: 0.1350 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 14s - loss: 0.1378 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 12s - loss: 0.1282 - acc: 0.9437
 384/1000 [==========>...................] - ETA: 11s - loss: 0.1337 - acc: 0.9453
 448/1000 [============>.................] - ETA: 10s - loss: 0.1216 - acc: 0.9531
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1225 - acc: 0.9551 
 576/1000 [================>.............] - ETA: 7s - loss: 0.1336 - acc: 0.9497
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1333 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 5s - loss: 0.1446 - acc: 0.9460
 768/1000 [======================>.......] - ETA: 4s - loss: 0.1420 - acc: 0.9466
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1518 - acc: 0.9435
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1587 - acc: 0.9375
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1614 - acc: 0.9354
1000/1000 [==============================] - 18s 18ms/step - loss: 0.1617 - acc: 0.9350

Test accuracy: 77.63988332007426

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9259

choose_one :  9596

F1score :  0.7790819534688743

AUC :  0.8492101343005503

Confusion Matrix
[[7205 2162]
 [2054 7434]]
True label 0
0.7691897085512971  
0.23081029144870288  
True label 1
0.21648397976391232  
0.7835160202360877  

Train_result {'loss': [0.16173770487308503], 'acc': [0.9350000004768372]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 21s - loss: 0.1111 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 17s - loss: 0.1298 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 15s - loss: 0.1381 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 14s - loss: 0.1374 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 12s - loss: 0.1583 - acc: 0.9500
 384/1000 [==========>...................] - ETA: 11s - loss: 0.1433 - acc: 0.9531
 448/1000 [============>.................] - ETA: 10s - loss: 0.1483 - acc: 0.9487
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1515 - acc: 0.9434 
 576/1000 [================>.............] - ETA: 7s - loss: 0.1537 - acc: 0.9410
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1515 - acc: 0.9437
 704/1000 [====================>.........] - ETA: 5s - loss: 0.1553 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 4s - loss: 0.1556 - acc: 0.9401
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1515 - acc: 0.9435
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1478 - acc: 0.9453
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1457 - acc: 0.9458
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1516 - acc: 0.9440

Test accuracy: 77.72474144789182

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10019

choose_one :  8836

F1score :  0.77079240340537

AUC :  0.852933412678538

Confusion Matrix
[[7593 1774]
 [2426 7062]]
True label 0
0.8106117220027756  
0.1893882779972243  
True label 1
0.25569139966273186  
0.7443086003372681  

Train_result {'loss': [0.15159064412117004], 'acc': [0.9439999990463257]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 20s - loss: 0.0630 - acc: 0.9844
 128/1000 [==>...........................] - ETA: 16s - loss: 0.0688 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 15s - loss: 0.1170 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 13s - loss: 0.1196 - acc: 0.9492
 320/1000 [========>.....................] - ETA: 12s - loss: 0.1182 - acc: 0.9500
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1098 - acc: 0.9557
 448/1000 [============>.................] - ETA: 9s - loss: 0.1118 - acc: 0.9531 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1064 - acc: 0.9551
 576/1000 [================>.............] - ETA: 7s - loss: 0.1008 - acc: 0.9601
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1093 - acc: 0.9531
 704/1000 [====================>.........] - ETA: 5s - loss: 0.1030 - acc: 0.9560
 768/1000 [======================>.......] - ETA: 4s - loss: 0.1053 - acc: 0.9557
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1063 - acc: 0.9567
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1055 - acc: 0.9554
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1013 - acc: 0.9573
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1012 - acc: 0.9570

Test accuracy: 77.74595597984619

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10599

choose_one :  8256

F1score :  0.7635256988277728

AUC :  0.855469359710843

Confusion Matrix
[[7885 1482]
 [2714 6774]]
True label 0
0.8417849898580122  
0.15821501014198783  
True label 1
0.28604553119730186  
0.7139544688026982  

Train_result {'loss': [0.10117460072040557], 'acc': [0.9569999995231628]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 20s - loss: 0.1516 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 17s - loss: 0.1094 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 15s - loss: 0.0794 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 13s - loss: 0.0772 - acc: 0.9609
 320/1000 [========>.....................] - ETA: 12s - loss: 0.0726 - acc: 0.9625
 384/1000 [==========>...................] - ETA: 11s - loss: 0.0704 - acc: 0.9635
 448/1000 [============>.................] - ETA: 9s - loss: 0.0762 - acc: 0.9665 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.0923 - acc: 0.9609
 576/1000 [================>.............] - ETA: 7s - loss: 0.0876 - acc: 0.9653
 640/1000 [==================>...........] - ETA: 6s - loss: 0.0918 - acc: 0.9625
 704/1000 [====================>.........] - ETA: 5s - loss: 0.0981 - acc: 0.9588
 768/1000 [======================>.......] - ETA: 4s - loss: 0.0960 - acc: 0.9596
 832/1000 [=======================>......] - ETA: 2s - loss: 0.0953 - acc: 0.9603
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0968 - acc: 0.9576
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0934 - acc: 0.9604
1000/1000 [==============================] - 17s 17ms/step - loss: 0.0971 - acc: 0.9590

Test accuracy: 77.28984354282684

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10261

choose_one :  8594

F1score :  0.7631899126202853

AUC :  0.8525664834891823

Confusion Matrix
[[7673 1694]
 [2588 6900]]
True label 0
0.8191523433329775  
0.18084765666702252  
True label 1
0.2727655986509275  
0.7272344013490725  

Train_result {'loss': [0.09712600016593934], 'acc': [0.9590000004768372]}
Saved model to disk


[[67.87059135507822, 1], [72.61734287987271, 2], [74.64863431450543, 3], [75.11535401750199, 4], [75.8207372049854, 5], [75.85255900291699, 6], [76.88146380270486, 7], [76.94510739856803, 8], [76.7913020418987, 9], [76.971625563511, 10], [76.998143728454, 11], [77.63988332007426, 12], [77.72474144789182, 13], [77.74595597984619, 14], [77.28984354282684, 15]]
max accuracy :  [77.74595597984619, 14]

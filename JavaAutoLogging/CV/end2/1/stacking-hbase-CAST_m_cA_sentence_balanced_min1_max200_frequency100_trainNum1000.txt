Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-12 07:26:31.110704: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-12 07:26:31.125342: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-12 07:26:31.128330: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8459d50 executing computations on platform Host. Devices:
2019-10-12 07:26:31.128381: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:44: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

184
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 184, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 184, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1_task_layer (Dense)      (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_1_task_layer[0][0]         
==================================================================================================
Total params: 575,874
Trainable params: 304,514
Non-trainable params: 271,360
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 47s - loss: 0.7829 - acc: 0.5312
 128/1000 [==>...........................] - ETA: 25s - loss: 0.7460 - acc: 0.5703
 192/1000 [====>.........................] - ETA: 18s - loss: 0.7314 - acc: 0.5885
 256/1000 [======>.......................] - ETA: 14s - loss: 0.7097 - acc: 0.5898
 320/1000 [========>.....................] - ETA: 11s - loss: 0.6998 - acc: 0.5938
 384/1000 [==========>...................] - ETA: 9s - loss: 0.6841 - acc: 0.6094 
 448/1000 [============>.................] - ETA: 8s - loss: 0.6667 - acc: 0.6205
 512/1000 [==============>...............] - ETA: 6s - loss: 0.6843 - acc: 0.6094
 576/1000 [================>.............] - ETA: 5s - loss: 0.6792 - acc: 0.6163
 640/1000 [==================>...........] - ETA: 4s - loss: 0.6721 - acc: 0.6250
 704/1000 [====================>.........] - ETA: 3s - loss: 0.6635 - acc: 0.6321
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6563 - acc: 0.6354
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6453 - acc: 0.6478
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6380 - acc: 0.6562
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6370 - acc: 0.6562
1000/1000 [==============================] - 11s 11ms/step - loss: 0.6443 - acc: 0.6520

Test accuracy: 71.90665605940069

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10348

choose_one :  8507

F1score :  0.705640455682134

AUC :  0.7897378838036226

Confusion Matrix
[[7209 2158]
 [3139 6349]]
True label 0
0.7696167396178072  
0.2303832603821928  
True label 1
0.3308389544688027  
0.6691610455311973  

Train_result {'acc': [0.6520000004768371], 'loss': [0.6442866163253784]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.5784 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 8s - loss: 0.6046 - acc: 0.6953
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5816 - acc: 0.7135
 256/1000 [======>.......................] - ETA: 6s - loss: 0.5714 - acc: 0.7305
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5727 - acc: 0.7188
 384/1000 [==========>...................] - ETA: 5s - loss: 0.5516 - acc: 0.7292
 448/1000 [============>.................] - ETA: 5s - loss: 0.5658 - acc: 0.7143
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5568 - acc: 0.7227
 576/1000 [================>.............] - ETA: 3s - loss: 0.5561 - acc: 0.7222
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5484 - acc: 0.7297
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5501 - acc: 0.7315
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5424 - acc: 0.7331
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5376 - acc: 0.7332
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5428 - acc: 0.7288
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5409 - acc: 0.7323
1000/1000 [==============================] - 9s 9ms/step - loss: 0.5379 - acc: 0.7350

Test accuracy: 74.18721824449747

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10190

choose_one :  8665

F1score :  0.73189004572247

AUC :  0.821838114674044

Confusion Matrix
[[7345 2022]
 [2845 6643]]
True label 0
0.7841357958791502  
0.21586420412084978  
True label 1
0.2998524451939292  
0.7001475548060708  

Train_result {'acc': [0.7350000004768371], 'loss': [0.5379198775291443]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5205 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 7s - loss: 0.5149 - acc: 0.7188
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5402 - acc: 0.7240
 256/1000 [======>.......................] - ETA: 6s - loss: 0.5291 - acc: 0.7344
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5121 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 5s - loss: 0.5000 - acc: 0.7552
 448/1000 [============>.................] - ETA: 4s - loss: 0.4962 - acc: 0.7656
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4854 - acc: 0.7695
 576/1000 [================>.............] - ETA: 3s - loss: 0.4868 - acc: 0.7743
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4847 - acc: 0.7781
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4742 - acc: 0.7869
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4697 - acc: 0.7891
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4758 - acc: 0.7873
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4796 - acc: 0.7801
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4794 - acc: 0.7771
1000/1000 [==============================] - 8s 8ms/step - loss: 0.4797 - acc: 0.7780

Test accuracy: 75.14717581543357

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8627

choose_one :  10228

F1score :  0.7623250152160682

AUC :  0.829078424606423

Confusion Matrix
[[6654 2713]
 [1973 7515]]
True label 0
0.7103661791395324  
0.2896338208604676  
True label 1
0.2079468802698145  
0.7920531197301856  

Train_result {'acc': [0.7780000004768372], 'loss': [0.4797488598823547]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.3812 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4685 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4902 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4498 - acc: 0.8086
 320/1000 [========>.....................] - ETA: 5s - loss: 0.4392 - acc: 0.8156
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4485 - acc: 0.8099
 448/1000 [============>.................] - ETA: 4s - loss: 0.4569 - acc: 0.8080
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4503 - acc: 0.8125
 576/1000 [================>.............] - ETA: 3s - loss: 0.4542 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 2s - loss: 0.4586 - acc: 0.8063
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4569 - acc: 0.8082
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4510 - acc: 0.8125
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4554 - acc: 0.8077
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4477 - acc: 0.8170
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4579 - acc: 0.8063
1000/1000 [==============================] - 8s 8ms/step - loss: 0.4590 - acc: 0.8040

Test accuracy: 75.70405727923628

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10508

choose_one :  8347

F1score :  0.7431455004205214

AUC :  0.8377451625499515

Confusion Matrix
[[7647 1720]
 [2861 6627]]
True label 0
0.8163766414006619  
0.1836233585993381  
True label 1
0.30153878583473864  
0.6984612141652614  

Train_result {'acc': [0.804], 'loss': [0.45898525762557985]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3821 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4388 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4102 - acc: 0.8281
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4098 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4145 - acc: 0.8187
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4315 - acc: 0.8021
 448/1000 [============>.................] - ETA: 5s - loss: 0.4267 - acc: 0.8036
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4243 - acc: 0.7988
 576/1000 [================>.............] - ETA: 3s - loss: 0.4138 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4177 - acc: 0.8031
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4086 - acc: 0.8068
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4260 - acc: 0.7943
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4368 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4518 - acc: 0.7812
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4536 - acc: 0.7812
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4520 - acc: 0.7840

Test accuracy: 76.48899496154866

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8774

choose_one :  10081

F1score :  0.7734682405845982

AUC :  0.8441040120396837

Confusion Matrix
[[6854 2513]
 [1920 7568]]
True label 0
0.7317177324650368  
0.26828226753496315  
True label 1
0.20236087689713322  
0.7976391231028668  

Train_result {'acc': [0.7840000009536743], 'loss': [0.452036212682724]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4350 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 7s - loss: 0.3939 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3867 - acc: 0.8281
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3996 - acc: 0.8359
 320/1000 [========>.....................] - ETA: 5s - loss: 0.3852 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3867 - acc: 0.8385
 448/1000 [============>.................] - ETA: 4s - loss: 0.3859 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3835 - acc: 0.8301
 576/1000 [================>.............] - ETA: 3s - loss: 0.3793 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3700 - acc: 0.8391
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3748 - acc: 0.8338
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3810 - acc: 0.8320
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3937 - acc: 0.8257
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3924 - acc: 0.8225
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3912 - acc: 0.8240
1000/1000 [==============================] - 8s 8ms/step - loss: 0.3884 - acc: 0.8270

Test accuracy: 76.616282153275

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9406

choose_one :  9449

F1score :  0.7671753709668901

AUC :  0.8466487355325674

Confusion Matrix
[[7182 2185]
 [2224 7264]]
True label 0
0.7667342799188641  
0.2332657200811359  
True label 1
0.23440134907251264  
0.7655986509274874  

Train_result {'acc': [0.8269999990463257], 'loss': [0.3883544611930847]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2487 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3297 - acc: 0.8750 
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3366 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3465 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3508 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3528 - acc: 0.8594
 448/1000 [============>.................] - ETA: 4s - loss: 0.3618 - acc: 0.8527
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3506 - acc: 0.8535
 576/1000 [================>.............] - ETA: 3s - loss: 0.3527 - acc: 0.8490
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3639 - acc: 0.8406
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3560 - acc: 0.8480
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3488 - acc: 0.8529
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3548 - acc: 0.8510
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3529 - acc: 0.8516
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3642 - acc: 0.8490
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3756 - acc: 0.8470

Test accuracy: 76.52612039246884

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10221

choose_one :  8634

F1score :  0.7557664716918663

AUC :  0.8445220022266106

Confusion Matrix
[[7581 1786]
 [2640 6848]]
True label 0
0.8093306288032455  
0.19066937119675456  
True label 1
0.2782462057335582  
0.7217537942664418  

Train_result {'acc': [0.8470000004768372], 'loss': [0.3755977554321289]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.3715 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3017 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3172 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3093 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3021 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3190 - acc: 0.8698
 448/1000 [============>.................] - ETA: 4s - loss: 0.3324 - acc: 0.8661
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3375 - acc: 0.8672
 576/1000 [================>.............] - ETA: 3s - loss: 0.3353 - acc: 0.8628
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3416 - acc: 0.8578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3531 - acc: 0.8494
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3574 - acc: 0.8438
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3560 - acc: 0.8474
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3634 - acc: 0.8415
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3665 - acc: 0.8406
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3671 - acc: 0.8400

Test accuracy: 76.88676743569344

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9635

choose_one :  9220

F1score :  0.7670515287577507

AUC :  0.8496155673977264

Confusion Matrix
[[7322 2045]
 [2313 7175]]
True label 0
0.7816803672467172  
0.2183196327532828  
True label 1
0.2437816188870152  
0.7562183811129848  

Train_result {'acc': [0.8399999995231628], 'loss': [0.36711812257766724]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2619 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2942 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2919 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2958 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3103 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3076 - acc: 0.8698
 448/1000 [============>.................] - ETA: 4s - loss: 0.3101 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3152 - acc: 0.8691
 576/1000 [================>.............] - ETA: 3s - loss: 0.3216 - acc: 0.8628
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3284 - acc: 0.8578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3205 - acc: 0.8622
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3286 - acc: 0.8568
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3272 - acc: 0.8594
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3263 - acc: 0.8605
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3186 - acc: 0.8635
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3184 - acc: 0.8640

Test accuracy: 77.36939803765578

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8990

choose_one :  9865

F1score :  0.7795173874851444

AUC :  0.8509962734248233

Confusion Matrix
[[7045 2322]
 [1945 7543]]
True label 0
0.7521084658908935  
0.24789153410910644  
True label 1
0.20499578414839797  
0.795004215851602  

Train_result {'acc': [0.864], 'loss': [0.3184479377269745]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2896 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3222 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3375 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3261 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 5s - loss: 0.3169 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3076 - acc: 0.8828
 448/1000 [============>.................] - ETA: 4s - loss: 0.3104 - acc: 0.8728
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3162 - acc: 0.8691
 576/1000 [================>.............] - ETA: 3s - loss: 0.3256 - acc: 0.8646
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3238 - acc: 0.8641
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3176 - acc: 0.8651
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3104 - acc: 0.8672
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3111 - acc: 0.8690
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3049 - acc: 0.8717
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3103 - acc: 0.8698
1000/1000 [==============================] - 8s 8ms/step - loss: 0.3135 - acc: 0.8680

Test accuracy: 77.05648369132857

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9827

choose_one :  9028

F1score :  0.7663642255346729

AUC :  0.84808302860262

Confusion Matrix
[[7434 1933]
 [2393 7095]]
True label 0
0.7936372371089997  
0.2063627628910003  
True label 1
0.2522133220910624  
0.7477866779089376  

Train_result {'acc': [0.8679999995231629], 'loss': [0.31345621609687807]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2361 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2746 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2833 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2658 - acc: 0.8984
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2474 - acc: 0.9125
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2418 - acc: 0.9115
 448/1000 [============>.................] - ETA: 4s - loss: 0.2439 - acc: 0.9129
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2470 - acc: 0.9102
 576/1000 [================>.............] - ETA: 3s - loss: 0.2516 - acc: 0.9080
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2590 - acc: 0.9047
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2619 - acc: 0.9020
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2739 - acc: 0.8958
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2751 - acc: 0.8954
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2784 - acc: 0.8929
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2794 - acc: 0.8906
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2754 - acc: 0.8930

Test accuracy: 77.14134181914612

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9025

choose_one :  9830

F1score :  0.7768920178072265

AUC :  0.8483252476627161

Confusion Matrix
[[7041 2326]
 [1984 7504]]
True label 0
0.7516814348243834  
0.2483185651756165  
True label 1
0.209106239460371  
0.790893760539629  

Train_result {'acc': [0.8929999995231629], 'loss': [0.27537529277801515]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2050 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2787 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2845 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2708 - acc: 0.9023
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2678 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2616 - acc: 0.9010
 448/1000 [============>.................] - ETA: 4s - loss: 0.2658 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2562 - acc: 0.9023
 576/1000 [================>.............] - ETA: 3s - loss: 0.2581 - acc: 0.9028
 640/1000 [==================>...........] - ETA: 2s - loss: 0.2707 - acc: 0.8984
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2651 - acc: 0.9020
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2692 - acc: 0.8997
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2696 - acc: 0.9002
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2679 - acc: 0.8973
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2664 - acc: 0.8979
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2683 - acc: 0.8970

Test accuracy: 76.91858923362503

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8503

choose_one :  10352

F1score :  0.7806451612903226

AUC :  0.8489723766079151

Confusion Matrix
[[6759 2608]
 [1744 7744]]
True label 0
0.7215757446354222  
0.27842425536457777  
True label 1
0.18381112984822934  
0.8161888701517707  

Train_result {'acc': [0.897], 'loss': [0.26827267813682554]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2664 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2685 - acc: 0.8516
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2364 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2342 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2409 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2375 - acc: 0.8750
 448/1000 [============>.................] - ETA: 5s - loss: 0.2369 - acc: 0.8750
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2426 - acc: 0.8750
 576/1000 [================>.............] - ETA: 3s - loss: 0.2401 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2509 - acc: 0.8797
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2523 - acc: 0.8807
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2600 - acc: 0.8724
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2635 - acc: 0.8714
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2614 - acc: 0.8750
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2542 - acc: 0.8802
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2499 - acc: 0.8830

Test accuracy: 76.09652612039247

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  7904

choose_one :  10951

F1score :  0.7794901903224227

AUC :  0.8465201716369638

Confusion Matrix
[[6382 2985]
 [1522 7966]]
True label 0
0.6813280666168464  
0.31867193338315364  
True label 1
0.1604131534569983  
0.8395868465430016  

Train_result {'acc': [0.8829999995231629], 'loss': [0.24989020669460296]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2223 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2117 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2209 - acc: 0.9010
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2153 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2276 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2315 - acc: 0.9036
 448/1000 [============>.................] - ETA: 4s - loss: 0.2171 - acc: 0.9062
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2286 - acc: 0.9004
 576/1000 [================>.............] - ETA: 3s - loss: 0.2325 - acc: 0.8993
 640/1000 [==================>...........] - ETA: 2s - loss: 0.2390 - acc: 0.9000
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2382 - acc: 0.9048
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2348 - acc: 0.9049
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2336 - acc: 0.9038
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2288 - acc: 0.9062
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2274 - acc: 0.9052
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2260 - acc: 0.9060

Test accuracy: 76.55794219040042

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9407

choose_one :  9448

F1score :  0.7665821715251373

AUC :  0.8444079138650255

Confusion Matrix
[[7177 2190]
 [2230 7258]]
True label 0
0.7662004910857265  
0.2337995089142735  
True label 1
0.2350337268128162  
0.7649662731871838  

Train_result {'acc': [0.9060000004768372], 'loss': [0.22596751093864442]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1990 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2606 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2281 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2914 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2680 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2720 - acc: 0.8828
 448/1000 [============>.................] - ETA: 4s - loss: 0.2438 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2336 - acc: 0.9023
 576/1000 [================>.............] - ETA: 3s - loss: 0.2254 - acc: 0.9097
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2262 - acc: 0.9078
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2262 - acc: 0.9077
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2239 - acc: 0.9089
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2207 - acc: 0.9099
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2193 - acc: 0.9129
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2180 - acc: 0.9125
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2134 - acc: 0.9140

Test accuracy: 77.38530893662158

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9813

choose_one :  9042

F1score :  0.7698866702644361

AUC :  0.8479598993614518

Confusion Matrix
[[7458 1909]
 [2355 7133]]
True label 0
0.7961994235080602  
0.20380057649193978  
True label 1
0.24820826306913996  
0.75179173693086  

Train_result {'acc': [0.9139999995231628], 'loss': [0.21336500269174577]}
Saved model to disk


[[71.90665605940069, 1], [74.18721824449747, 2], [75.14717581543357, 3], [75.70405727923628, 4], [76.48899496154866, 5], [76.616282153275, 6], [76.52612039246884, 7], [76.88676743569344, 8], [77.36939803765578, 9], [77.05648369132857, 10], [77.14134181914612, 11], [76.91858923362503, 12], [76.09652612039247, 13], [76.55794219040042, 14], [77.38530893662158, 15]]
max accuracy :  [77.38530893662158, 15]

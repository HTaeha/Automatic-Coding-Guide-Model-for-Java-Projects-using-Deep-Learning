Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-17 05:56:35.493691: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-17 05:56:35.502477: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-17 05:56:35.504764: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa12a320 executing computations on platform Host. Devices:
2019-10-17 05:56:35.504804: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:95: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  10792
one :  10820

Second data
zero :  10792
one :  10820

Third data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

179
glassfish-AST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-AST

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 821
Over 150, Under 200 : 164
Over 200, Under 400 : 4
Over 400 : 0

253
glassfish-CAST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-CAST

Sentence length Average : 50

Under 10 : 4320
Over 10, Under 30 : 6874
Over 30, Under 100 : 7059
Over 100, Under 150 : 1787
Over 150, Under 200 : 894
Over 200, Under 400 : 678
Over 400 : 0

342
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 179, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 179, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 253, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 342, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 342, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          147840      concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 128)          32896       dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 64)           8256        dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 128)          8320        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7_task_layer (Dense)      (None, 64)           8256        dense_6_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            130         dense_7_task_layer[0][0]         
==================================================================================================
Total params: 1,865,666
Trainable params: 941,186
Non-trainable params: 924,480
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:27 - loss: 0.8080 - acc: 0.5156
 128/1000 [==>...........................] - ETA: 44s - loss: 0.7402 - acc: 0.5234 
 192/1000 [====>.........................] - ETA: 29s - loss: 0.7235 - acc: 0.5417
 256/1000 [======>.......................] - ETA: 22s - loss: 0.7232 - acc: 0.5547
 320/1000 [========>.....................] - ETA: 17s - loss: 0.7143 - acc: 0.5594
 384/1000 [==========>...................] - ETA: 14s - loss: 0.7145 - acc: 0.5469
 448/1000 [============>.................] - ETA: 11s - loss: 0.7096 - acc: 0.5603
 512/1000 [==============>...............] - ETA: 9s - loss: 0.7058 - acc: 0.5684 
 576/1000 [================>.............] - ETA: 7s - loss: 0.7125 - acc: 0.5608
 640/1000 [==================>...........] - ETA: 6s - loss: 0.7144 - acc: 0.5625
 704/1000 [====================>.........] - ETA: 4s - loss: 0.7137 - acc: 0.5739
 768/1000 [======================>.......] - ETA: 3s - loss: 0.7120 - acc: 0.5755
 832/1000 [=======================>......] - ETA: 2s - loss: 0.7073 - acc: 0.5793
 896/1000 [=========================>....] - ETA: 1s - loss: 0.7068 - acc: 0.5759
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7025 - acc: 0.5844
1000/1000 [==============================] - 14s 14ms/step - loss: 0.6985 - acc: 0.5880

Test accuracy: 64.19561420531728

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9510

choose_one :  11102

F1score :  0.6555586670400447

AUC :  0.6943289321398809

Confusion Matrix
[[6209 4079]
 [3301 7023]]
True label 0
0.6035186625194401  
0.39648133748055986  
True label 1
0.31974041069352965  
0.6802595893064703  

Train_result {'acc': [0.5880000004768372], 'loss': [0.6984795451164245]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.6254 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 8s - loss: 0.5737 - acc: 0.6953
 192/1000 [====>.........................] - ETA: 7s - loss: 0.6028 - acc: 0.6771
 256/1000 [======>.......................] - ETA: 6s - loss: 0.6349 - acc: 0.6602
 320/1000 [========>.....................] - ETA: 5s - loss: 0.6240 - acc: 0.6687
 384/1000 [==========>...................] - ETA: 5s - loss: 0.6197 - acc: 0.6745
 448/1000 [============>.................] - ETA: 4s - loss: 0.6078 - acc: 0.6920
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6130 - acc: 0.6797
 576/1000 [================>.............] - ETA: 3s - loss: 0.6172 - acc: 0.6684
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6132 - acc: 0.6625
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6122 - acc: 0.6619
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6160 - acc: 0.6602
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6081 - acc: 0.6695
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6062 - acc: 0.6730
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5979 - acc: 0.6813
1000/1000 [==============================] - 9s 9ms/step - loss: 0.5909 - acc: 0.6880

Test accuracy: 69.60508441684455

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10119

choose_one :  10493

F1score :  0.6990440505356198

AUC :  0.7649542789890593

Confusion Matrix
[[7071 3217]
 [3048 7276]]
True label 0
0.6873055987558321  
0.312694401244168  
True label 1
0.29523440526927547  
0.7047655947307245  

Train_result {'acc': [0.6880000009536743], 'loss': [0.5908964467048645]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4478 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4813 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4898 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4961 - acc: 0.7656
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5000 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4972 - acc: 0.7604
 448/1000 [============>.................] - ETA: 4s - loss: 0.4953 - acc: 0.7634
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5045 - acc: 0.7578
 576/1000 [================>.............] - ETA: 3s - loss: 0.4950 - acc: 0.7622
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4753 - acc: 0.7703
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4754 - acc: 0.7699
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4801 - acc: 0.7734
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4789 - acc: 0.7752
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4810 - acc: 0.7723
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4815 - acc: 0.7750
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4802 - acc: 0.7740

Test accuracy: 72.07937124005433

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9215

choose_one :  11397

F1score :  0.7350490308917637

AUC :  0.7963333918068576

Confusion Matrix
[[6874 3414]
 [2341 7983]]
True label 0
0.6681570762052877  
0.3318429237947123  
True label 1
0.2267531964354901  
0.7732468035645099  

Train_result {'acc': [0.774], 'loss': [0.48022655725479124]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4333 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4000 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3907 - acc: 0.8125
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3830 - acc: 0.8242
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3849 - acc: 0.8250
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3876 - acc: 0.8229
 448/1000 [============>.................] - ETA: 5s - loss: 0.3759 - acc: 0.8348
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3867 - acc: 0.8320
 576/1000 [================>.............] - ETA: 3s - loss: 0.3879 - acc: 0.8316
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3960 - acc: 0.8266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4082 - acc: 0.8224
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4043 - acc: 0.8203
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3978 - acc: 0.8233
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4001 - acc: 0.8225
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3983 - acc: 0.8229
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3951 - acc: 0.8250

Test accuracy: 73.6221618474675

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11439

choose_one :  9173

F1score :  0.7211365851156588

AUC :  0.8125935146434375

Confusion Matrix
[[8145 2143]
 [3294 7030]]
True label 0
0.791699066874028  
0.208300933125972  
True label 1
0.3190623789228981  
0.6809376210771019  

Train_result {'acc': [0.825], 'loss': [0.3950931015014648]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4849 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4367 - acc: 0.7734
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4318 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4145 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3831 - acc: 0.8156
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3659 - acc: 0.8229
 448/1000 [============>.................] - ETA: 4s - loss: 0.3585 - acc: 0.8304
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3612 - acc: 0.8340
 576/1000 [================>.............] - ETA: 3s - loss: 0.3425 - acc: 0.8438
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3354 - acc: 0.8500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3434 - acc: 0.8523
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3294 - acc: 0.8581
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3227 - acc: 0.8630
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3197 - acc: 0.8650
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3360 - acc: 0.8625
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3403 - acc: 0.8600

Test accuracy: 73.73374733165147

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9678

choose_one :  10934

F1score :  0.7453194091636091

AUC :  0.8159340328263185

Confusion Matrix
[[7276 3012]
 [2402 7922]]
True label 0
0.7072317262830482  
0.2927682737169518  
True label 1
0.23266175900813638  
0.7673382409918637  

Train_result {'acc': [0.8600000004768371], 'loss': [0.3402650773525238]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3636 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3014 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2902 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2787 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2605 - acc: 0.8969
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2735 - acc: 0.8854
 448/1000 [============>.................] - ETA: 4s - loss: 0.2761 - acc: 0.8795
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2690 - acc: 0.8828
 576/1000 [================>.............] - ETA: 3s - loss: 0.2719 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2620 - acc: 0.8828
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2667 - acc: 0.8821
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2620 - acc: 0.8854
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2657 - acc: 0.8846
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2748 - acc: 0.8828
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2760 - acc: 0.8823
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2756 - acc: 0.8830

Test accuracy: 74.5391034348923

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11886

choose_one :  8726

F1score :  0.724514435695538

AUC :  0.8252952652488608

Confusion Matrix
[[8463 1825]
 [3423 6901]]
True label 0
0.8226088646967341  
0.17739113530326595  
True label 1
0.33155753583882214  
0.6684424641611778  

Train_result {'acc': [0.8829999990463256], 'loss': [0.27562762212753295]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3469 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2616 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2703 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2764 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2510 - acc: 0.9062
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2475 - acc: 0.9115
 448/1000 [============>.................] - ETA: 5s - loss: 0.2433 - acc: 0.9107
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2452 - acc: 0.9082
 576/1000 [================>.............] - ETA: 3s - loss: 0.2390 - acc: 0.9132
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2377 - acc: 0.9141
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2378 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2317 - acc: 0.9180
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2366 - acc: 0.9159
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2474 - acc: 0.9096
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2555 - acc: 0.9062
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2598 - acc: 0.9050

Test accuracy: 74.58276732000776

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11543

choose_one :  9069

F1score :  0.729850977156706

AUC :  0.824604193681485

Confusion Matrix
[[8296 1992]
 [3247 7077]]
True label 0
0.8063763608087092  
0.19362363919129083  
True label 1
0.3145098798915149  
0.6854901201084851  

Train_result {'acc': [0.905], 'loss': [0.25984000420570375]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2004 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1841 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1758 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1807 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1865 - acc: 0.9313
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1732 - acc: 0.9375
 448/1000 [============>.................] - ETA: 5s - loss: 0.1792 - acc: 0.9397
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1891 - acc: 0.9336
 576/1000 [================>.............] - ETA: 3s - loss: 0.1923 - acc: 0.9288
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1911 - acc: 0.9297
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1861 - acc: 0.9304
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1868 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1951 - acc: 0.9267
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1968 - acc: 0.9252
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1947 - acc: 0.9271
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1966 - acc: 0.9250

Test accuracy: 73.87929361536969

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9258

choose_one :  11354

F1score :  0.7516376049451057

AUC :  0.8235440629136959

Confusion Matrix
[[7081 3207]
 [2177 8147]]
True label 0
0.6882776049766719  
0.31172239502332816  
True label 1
0.21086788066640838  
0.7891321193335916  

Train_result {'acc': [0.925], 'loss': [0.1965509476661682]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3197 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2662 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2053 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2042 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2154 - acc: 0.9062
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2002 - acc: 0.9193
 448/1000 [============>.................] - ETA: 4s - loss: 0.1900 - acc: 0.9241
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1858 - acc: 0.9277
 576/1000 [================>.............] - ETA: 3s - loss: 0.1895 - acc: 0.9219
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1833 - acc: 0.9266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1843 - acc: 0.9276
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1927 - acc: 0.9219
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1994 - acc: 0.9231
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1971 - acc: 0.9230
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2054 - acc: 0.9208
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2054 - acc: 0.9210

Test accuracy: 74.19949543954978

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9078

choose_one :  11534

F1score :  0.7567023515417697

AUC :  0.8267369866029599

Confusion Matrix
[[7024 3264]
 [2054 8270]]
True label 0
0.6827371695178849  
0.31726283048211507  
True label 1
0.19895389383959705  
0.801046106160403  

Train_result {'acc': [0.9210000004768372], 'loss': [0.20535803306102754]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1163 - acc: 0.9844
 128/1000 [==>...........................] - ETA: 7s - loss: 0.1464 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1421 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1411 - acc: 0.9531
 320/1000 [========>.....................] - ETA: 5s - loss: 0.1442 - acc: 0.9469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1534 - acc: 0.9479
 448/1000 [============>.................] - ETA: 4s - loss: 0.1515 - acc: 0.9487
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1523 - acc: 0.9453
 576/1000 [================>.............] - ETA: 3s - loss: 0.1509 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1535 - acc: 0.9437
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1555 - acc: 0.9389
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1584 - acc: 0.9362
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1603 - acc: 0.9375
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1596 - acc: 0.9386
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1600 - acc: 0.9385
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1585 - acc: 0.9390

Test accuracy: 75.59673976324471

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10492

choose_one :  10120

F1score :  0.7539620426531011

AUC :  0.8316776996841978

Confusion Matrix
[[7875 2413]
 [2617 7707]]
True label 0
0.765454898911353  
0.23454510108864696  
True label 1
0.2534870205346765  
0.7465129794653235  

Train_result {'acc': [0.9389999995231628], 'loss': [0.15851237004995347]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1084 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1605 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1555 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1597 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1655 - acc: 0.9313
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1575 - acc: 0.9349
 448/1000 [============>.................] - ETA: 4s - loss: 0.1419 - acc: 0.9420
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1464 - acc: 0.9414
 576/1000 [================>.............] - ETA: 3s - loss: 0.1455 - acc: 0.9392
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1465 - acc: 0.9375
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1440 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1498 - acc: 0.9375
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1492 - acc: 0.9375
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1480 - acc: 0.9397
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1547 - acc: 0.9375
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1520 - acc: 0.9380

Test accuracy: 75.47059965068892

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10882

choose_one :  9730

F1score :  0.7478807220504636

AUC :  0.8336082251158875

Confusion Matrix
[[8057 2231]
 [2825 7499]]
True label 0
0.7831454121306376  
0.21685458786936238  
True label 1
0.273634250290585  
0.7263657497094149  

Train_result {'acc': [0.9379999995231628], 'loss': [0.15201870906352996]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1163 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0971 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1020 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0999 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0954 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1093 - acc: 0.9714
 448/1000 [============>.................] - ETA: 4s - loss: 0.1102 - acc: 0.9710
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1105 - acc: 0.9668
 576/1000 [================>.............] - ETA: 3s - loss: 0.1068 - acc: 0.9670
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1079 - acc: 0.9672
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1179 - acc: 0.9631
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1221 - acc: 0.9570
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1271 - acc: 0.9555
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1332 - acc: 0.9554
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1338 - acc: 0.9552
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1348 - acc: 0.9530

Test accuracy: 76.1789248981176

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12154

choose_one :  8458

F1score :  0.7385794910020234

AUC :  0.8334548827551861

Confusion Matrix
[[8766 1522]
 [3388 6936]]
True label 0
0.8520606531881804  
0.14793934681181958  
True label 1
0.32816737698566445  
0.6718326230143356  

Train_result {'acc': [0.9529999990463257], 'loss': [0.13477277791500092]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1909 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1381 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1189 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1058 - acc: 0.9609
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1155 - acc: 0.9563
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1216 - acc: 0.9583
 448/1000 [============>.................] - ETA: 4s - loss: 0.1309 - acc: 0.9576
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1335 - acc: 0.9551
 576/1000 [================>.............] - ETA: 3s - loss: 0.1346 - acc: 0.9531
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1375 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1338 - acc: 0.9517
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1361 - acc: 0.9505
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1339 - acc: 0.9483
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1349 - acc: 0.9464
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1310 - acc: 0.9479
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1282 - acc: 0.9490

Test accuracy: 76.26625266834853

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12042

choose_one :  8570

F1score :  0.7410818249179634

AUC :  0.8339643433772219

Confusion Matrix
[[8719 1569]
 [3323 7001]]
True label 0
0.8474922239502333  
0.15250777604976673  
True label 1
0.321871367686943  
0.678128632313057  

Train_result {'acc': [0.9490000009536743], 'loss': [0.12823873716592787]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.0996 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0912 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0990 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1196 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1129 - acc: 0.9531
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1178 - acc: 0.9531
 448/1000 [============>.................] - ETA: 4s - loss: 0.1290 - acc: 0.9464
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1269 - acc: 0.9473
 576/1000 [================>.............] - ETA: 3s - loss: 0.1300 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1310 - acc: 0.9437
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1341 - acc: 0.9418
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1316 - acc: 0.9440
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1258 - acc: 0.9471
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1225 - acc: 0.9475
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1264 - acc: 0.9458
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1252 - acc: 0.9460

Test accuracy: 76.49427517950708

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10653

choose_one :  9959

F1score :  0.761130010353498

AUC :  0.8328760946650453

Confusion Matrix
[[8048 2240]
 [2605 7719]]
True label 0
0.7822706065318819  
0.2177293934681182  
True label 1
0.252324680356451  
0.747675319643549  

Train_result {'acc': [0.9459999995231628], 'loss': [0.12521492326259612]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.0745 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 7s - loss: 0.1215 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1017 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1143 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0993 - acc: 0.9656
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0903 - acc: 0.9688
 448/1000 [============>.................] - ETA: 4s - loss: 0.0891 - acc: 0.9688
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0864 - acc: 0.9688
 576/1000 [================>.............] - ETA: 3s - loss: 0.0909 - acc: 0.9635
 640/1000 [==================>...........] - ETA: 3s - loss: 0.0863 - acc: 0.9641
 704/1000 [====================>.........] - ETA: 2s - loss: 0.0878 - acc: 0.9631
 768/1000 [======================>.......] - ETA: 2s - loss: 0.0948 - acc: 0.9609
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1046 - acc: 0.9579
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1051 - acc: 0.9565
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0993 - acc: 0.9594
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1025 - acc: 0.9580

Test accuracy: 75.95575392974966

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10506

choose_one :  10106

F1score :  0.7574155653450808

AUC :  0.8296567524417278

Confusion Matrix
[[7919 2369]
 [2587 7737]]
True label 0
0.7697317262830482  
0.2302682737169518  
True label 1
0.25058117008911274  
0.7494188299108873  

Train_result {'acc': [0.9580000004768372], 'loss': [0.10251884055137635]}
Saved model to disk


[[64.19561420531728, 1], [69.60508441684455, 2], [72.07937124005433, 3], [73.6221618474675, 4], [73.73374733165147, 5], [74.5391034348923, 6], [74.58276732000776, 7], [73.87929361536969, 8], [74.19949543954978, 9], [75.59673976324471, 10], [75.47059965068892, 11], [76.1789248981176, 12], [76.26625266834853, 13], [76.49427517950708, 14], [75.95575392974966, 15]]
max accuracy :  [76.49427517950708, 14]

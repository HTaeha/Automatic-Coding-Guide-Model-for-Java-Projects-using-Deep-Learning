Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-15 03:44:03.113573: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-15 03:44:03.124691: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-15 03:44:03.127208: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x886f1f0 executing computations on platform Host. Devices:
2019-10-15 03:44:03.127267: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:44: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

193
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 193, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1_task_layer (Dense)      (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_1_task_layer[0][0]         
==================================================================================================
Total params: 575,874
Trainable params: 304,514
Non-trainable params: 271,360
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 45s - loss: 0.8093 - acc: 0.5469
 128/1000 [==>...........................] - ETA: 23s - loss: 0.7839 - acc: 0.5312
 192/1000 [====>.........................] - ETA: 15s - loss: 0.7877 - acc: 0.5312
 256/1000 [======>.......................] - ETA: 11s - loss: 0.7447 - acc: 0.5703
 320/1000 [========>.....................] - ETA: 9s - loss: 0.7525 - acc: 0.5750 
 384/1000 [==========>...................] - ETA: 7s - loss: 0.7226 - acc: 0.5833
 448/1000 [============>.................] - ETA: 5s - loss: 0.6932 - acc: 0.6071
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6769 - acc: 0.6230
 576/1000 [================>.............] - ETA: 3s - loss: 0.6590 - acc: 0.6389
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6535 - acc: 0.6406
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6534 - acc: 0.6449
 768/1000 [======================>.......] - ETA: 1s - loss: 0.6429 - acc: 0.6497
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6450 - acc: 0.6478
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6386 - acc: 0.6518
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6375 - acc: 0.6552
1000/1000 [==============================] - 7s 7ms/step - loss: 0.6349 - acc: 0.6570

Test accuracy: 73.54047951833135

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7209

choose_one :  11393

F1score :  0.7610215575839969

AUC :  0.8329071723224721

Confusion Matrix
[[5843 3556]
 [1366 7837]]
True label 0
0.6216618789232897  
0.3783381210767103  
True label 1
0.14842985982831686  
0.8515701401716832  

Train_result {'acc': [0.6569999995231628], 'loss': [0.6349291105270386]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.4973 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4514 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4888 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4999 - acc: 0.7695
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5168 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5242 - acc: 0.7578
 448/1000 [============>.................] - ETA: 2s - loss: 0.5223 - acc: 0.7522
 512/1000 [==============>...............] - ETA: 2s - loss: 0.5263 - acc: 0.7461
 576/1000 [================>.............] - ETA: 1s - loss: 0.5217 - acc: 0.7483
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5102 - acc: 0.7562
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5092 - acc: 0.7599
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5061 - acc: 0.7604
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5013 - acc: 0.7632
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5003 - acc: 0.7623
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5033 - acc: 0.7625
1000/1000 [==============================] - 4s 4ms/step - loss: 0.5058 - acc: 0.7600

Test accuracy: 77.23900655843458

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9263

choose_one :  9339

F1score :  0.7716535433070866

AUC :  0.8621420199820352

Confusion Matrix
[[7214 2185]
 [2049 7154]]
True label 0
0.7675284604745186  
0.23247153952548144  
True label 1
0.22264478974247529  
0.7773552102575247  

Train_result {'acc': [0.7599999995231629], 'loss': [0.5058251829147339]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.5006 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 4s - loss: 0.5133 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 3s - loss: 0.5006 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4652 - acc: 0.7930
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4509 - acc: 0.7969
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4533 - acc: 0.7917
 448/1000 [============>.................] - ETA: 2s - loss: 0.4480 - acc: 0.7969
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4479 - acc: 0.8027
 576/1000 [================>.............] - ETA: 1s - loss: 0.4472 - acc: 0.7969
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4407 - acc: 0.8000
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4430 - acc: 0.7983
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4501 - acc: 0.7943
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4435 - acc: 0.7945
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4342 - acc: 0.7991
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4378 - acc: 0.7979
1000/1000 [==============================] - 4s 4ms/step - loss: 0.4460 - acc: 0.7950

Test accuracy: 76.89495753144823

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7999

choose_one :  10603

F1score :  0.7829950520044432

AUC :  0.8734037806241846

Confusion Matrix
[[6550 2849]
 [1449 7754]]
True label 0
0.6968826470901159  
0.303117352909884  
True label 1
0.15744865804628924  
0.8425513419537107  

Train_result {'acc': [0.7950000009536743], 'loss': [0.4459514617919922]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3600 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4309 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4345 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4406 - acc: 0.7852
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4377 - acc: 0.7937
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4310 - acc: 0.8099
 448/1000 [============>.................] - ETA: 2s - loss: 0.4207 - acc: 0.8170
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4232 - acc: 0.8125
 576/1000 [================>.............] - ETA: 1s - loss: 0.4104 - acc: 0.8194
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4161 - acc: 0.8156
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4076 - acc: 0.8210
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4040 - acc: 0.8242
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4044 - acc: 0.8257
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3973 - acc: 0.8270
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4014 - acc: 0.8229
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3995 - acc: 0.8240

Test accuracy: 79.23341576174604

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9610

choose_one :  8992

F1score :  0.7876889255289914

AUC :  0.8814441975552617

Confusion Matrix
[[7573 1826]
 [2037 7166]]
True label 0
0.8057240131928929  
0.19427598680710714  
True label 1
0.22134086710855155  
0.7786591328914484  

Train_result {'acc': [0.8240000009536743], 'loss': [0.39947063851356507]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3534 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3558 - acc: 0.8359
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3772 - acc: 0.8333
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3732 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3618 - acc: 0.8438
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3457 - acc: 0.8516
 448/1000 [============>.................] - ETA: 2s - loss: 0.3608 - acc: 0.8460
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3583 - acc: 0.8438
 576/1000 [================>.............] - ETA: 1s - loss: 0.3690 - acc: 0.8403
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3633 - acc: 0.8438
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3522 - acc: 0.8480
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3432 - acc: 0.8503
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3584 - acc: 0.8425
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3586 - acc: 0.8449
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3568 - acc: 0.8427
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3524 - acc: 0.8470

Test accuracy: 78.1045048919471

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7988

choose_one :  10614

F1score :  0.7944693949639199

AUC :  0.8873430289602087

Confusion Matrix
[[6657 2742]
 [1331 7872]]
True label 0
0.7082668368975423  
0.2917331631024577  
True label 1
0.14462675214603934  
0.8553732478539606  

Train_result {'acc': [0.8469999995231628], 'loss': [0.3524027259349823]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2919 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2819 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2615 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2917 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2888 - acc: 0.8688
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2989 - acc: 0.8594
 448/1000 [============>.................] - ETA: 2s - loss: 0.2962 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3038 - acc: 0.8613
 576/1000 [================>.............] - ETA: 1s - loss: 0.3140 - acc: 0.8611
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3170 - acc: 0.8578
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3099 - acc: 0.8665
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3183 - acc: 0.8620
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3101 - acc: 0.8666
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3065 - acc: 0.8694
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3074 - acc: 0.8688
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3090 - acc: 0.8670

Test accuracy: 80.6848725943447

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9600

choose_one :  9002

F1score :  0.8026366382861851

AUC :  0.8951008414583119

Confusion Matrix
[[7703 1696]
 [1897 7306]]
True label 0
0.8195552718374295  
0.18044472816257048  
True label 1
0.20612843637944148  
0.7938715636205586  

Train_result {'acc': [0.8669999995231629], 'loss': [0.30897800040245055]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2717 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2582 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2580 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2893 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2749 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2559 - acc: 0.8932
 448/1000 [============>.................] - ETA: 2s - loss: 0.2712 - acc: 0.8862
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2915 - acc: 0.8770
 576/1000 [================>.............] - ETA: 1s - loss: 0.2842 - acc: 0.8837
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2802 - acc: 0.8812
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2907 - acc: 0.8807
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2866 - acc: 0.8828
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2864 - acc: 0.8798
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2872 - acc: 0.8783
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2889 - acc: 0.8781
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2911 - acc: 0.8780

Test accuracy: 81.2439522631975

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9450

choose_one :  9152

F1score :  0.8099155543448652

AUC :  0.8983168903103005

Confusion Matrix
[[7680 1719]
 [1770 7433]]
True label 0
0.8171082030003192  
0.1828917969996808  
True label 1
0.1923285885037488  
0.8076714114962512  

Train_result {'acc': [0.878], 'loss': [0.29108748865127565]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2115 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2245 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2422 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2538 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2561 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2497 - acc: 0.9193
 448/1000 [============>.................] - ETA: 2s - loss: 0.2343 - acc: 0.9241
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2493 - acc: 0.9121
 576/1000 [================>.............] - ETA: 1s - loss: 0.2506 - acc: 0.9080
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2483 - acc: 0.9047
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2417 - acc: 0.9062
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2372 - acc: 0.9062
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2395 - acc: 0.9038
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2420 - acc: 0.9018
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2478 - acc: 0.9010
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2564 - acc: 0.8980

Test accuracy: 81.59337705623051

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9425

choose_one :  9177

F1score :  0.8137105549510337

AUC :  0.9004250419227404

Confusion Matrix
[[7700 1699]
 [1725 7478]]
True label 0
0.8192360889456325  
0.18076391105436748  
True label 1
0.18743887862653483  
0.8125611213734651  

Train_result {'acc': [0.8979999995231629], 'loss': [0.25635233545303343]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3468 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2798 - acc: 0.9141
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2658 - acc: 0.9062
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2362 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2127 - acc: 0.9281
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2171 - acc: 0.9245
 448/1000 [============>.................] - ETA: 2s - loss: 0.2203 - acc: 0.9219
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2277 - acc: 0.9180
 576/1000 [================>.............] - ETA: 1s - loss: 0.2225 - acc: 0.9184
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2208 - acc: 0.9156
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2279 - acc: 0.9119
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2264 - acc: 0.9128
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2329 - acc: 0.9050
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2287 - acc: 0.9074
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2303 - acc: 0.9073
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2326 - acc: 0.9070

Test accuracy: 81.78152886786367

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9176

choose_one :  9426

F1score :  0.8180793386655215

AUC :  0.9001453681595869

Confusion Matrix
[[7593 1806]
 [1583 7620]]
True label 0
0.8078518991382062  
0.19214810086179382  
True label 1
0.17200912745843747  
0.8279908725415626  

Train_result {'acc': [0.9069999990463257], 'loss': [0.23258623600006104]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.0837 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1448 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1447 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1628 - acc: 0.9531
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1673 - acc: 0.9406
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1772 - acc: 0.9375
 448/1000 [============>.................] - ETA: 2s - loss: 0.1714 - acc: 0.9442
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1684 - acc: 0.9414
 576/1000 [================>.............] - ETA: 1s - loss: 0.1624 - acc: 0.9462
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1743 - acc: 0.9375
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1757 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 0s - loss: 0.1827 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1797 - acc: 0.9315
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1816 - acc: 0.9308
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1831 - acc: 0.9292
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1817 - acc: 0.9290

Test accuracy: 81.21169766691753

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8816

choose_one :  9786

F1score :  0.8159460740428668

AUC :  0.9038838681562978

Confusion Matrix
[[7360 2039]
 [1456 7747]]
True label 0
0.7830620278753059  
0.21693797212469412  
True label 1
0.15820927958274475  
0.8417907204172552  

Train_result {'acc': [0.9290000004768372], 'loss': [0.18171811175346375]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.0814 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 3s - loss: 0.1014 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1417 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1638 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1694 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1712 - acc: 0.9323
 448/1000 [============>.................] - ETA: 2s - loss: 0.1639 - acc: 0.9330
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1648 - acc: 0.9355
 576/1000 [================>.............] - ETA: 1s - loss: 0.1617 - acc: 0.9340
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1585 - acc: 0.9328
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1664 - acc: 0.9290
 768/1000 [======================>.......] - ETA: 0s - loss: 0.1613 - acc: 0.9349
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1626 - acc: 0.9339
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1635 - acc: 0.9319
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1690 - acc: 0.9292
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1773 - acc: 0.9280

Test accuracy: 81.8890441887969

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9282

choose_one :  9320

F1score :  0.8181180154402635

AUC :  0.902529066319694

Confusion Matrix
[[7656 1743]
 [1626 7577]]
True label 0
0.8145547398659432  
0.18544526013405682  
True label 1
0.17668151689666414  
0.8233184831033359  

Train_result {'acc': [0.9279999990463257], 'loss': [0.17729785299301148]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1477 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1400 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1424 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1471 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 2s - loss: 0.1331 - acc: 0.9500
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1255 - acc: 0.9557
 448/1000 [============>.................] - ETA: 2s - loss: 0.1494 - acc: 0.9487
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1509 - acc: 0.9512
 576/1000 [================>.............] - ETA: 1s - loss: 0.1475 - acc: 0.9479
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1485 - acc: 0.9484
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1551 - acc: 0.9460
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1562 - acc: 0.9440
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1551 - acc: 0.9447
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1555 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1630 - acc: 0.9375
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1620 - acc: 0.9380

Test accuracy: 82.15783249113

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9154

choose_one :  9448

F1score :  0.8220470752238486

AUC :  0.905931273399621

Confusion Matrix
[[7617 1782]
 [1537 7666]]
True label 0
0.8104053622725822  
0.1895946377274178  
True label 1
0.16701075736172988  
0.8329892426382701  

Train_result {'acc': [0.9379999995231628], 'loss': [0.16201445508003234]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1790 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1347 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1486 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1531 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1574 - acc: 0.9313
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1658 - acc: 0.9323
 448/1000 [============>.................] - ETA: 2s - loss: 0.1630 - acc: 0.9375
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1537 - acc: 0.9414
 576/1000 [================>.............] - ETA: 1s - loss: 0.1479 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1497 - acc: 0.9406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1441 - acc: 0.9446
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1524 - acc: 0.9401
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1518 - acc: 0.9387
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1493 - acc: 0.9408
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1572 - acc: 0.9375
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1589 - acc: 0.9360

Test accuracy: 82.48575421997634

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9067

choose_one :  9535

F1score :  0.8261287223823248

AUC :  0.9058364283692213

Confusion Matrix
[[7604 1795]
 [1463 7740]]
True label 0
0.8090222364081285  
0.19097776359187146  
True label 1
0.15896990111920026  
0.8410300988807997  

Train_result {'acc': [0.9359999990463257], 'loss': [0.15888638663291932]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1759 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1489 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1346 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1290 - acc: 0.9648
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1381 - acc: 0.9563
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1226 - acc: 0.9635
 448/1000 [============>.................] - ETA: 2s - loss: 0.1254 - acc: 0.9554
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1286 - acc: 0.9531
 576/1000 [================>.............] - ETA: 1s - loss: 0.1298 - acc: 0.9549
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1356 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1369 - acc: 0.9517
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1382 - acc: 0.9505
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1339 - acc: 0.9519
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1428 - acc: 0.9453
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1446 - acc: 0.9458
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1399 - acc: 0.9480

Test accuracy: 81.8890441887969

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9330

choose_one :  9272

F1score :  0.8176454668470907

AUC :  0.902220033834612

Confusion Matrix
[[7680 1719]
 [1650 7553]]
True label 0
0.8171082030003192  
0.1828917969996808  
True label 1
0.17928936216451158  
0.8207106378354885  

Train_result {'acc': [0.948], 'loss': [0.13991808614134787]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.0612 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1457 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1331 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1166 - acc: 0.9648
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1271 - acc: 0.9594
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1174 - acc: 0.9635
 448/1000 [============>.................] - ETA: 2s - loss: 0.1237 - acc: 0.9576
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1270 - acc: 0.9512
 576/1000 [================>.............] - ETA: 1s - loss: 0.1268 - acc: 0.9531
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1250 - acc: 0.9547
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1273 - acc: 0.9560
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1250 - acc: 0.9544
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1235 - acc: 0.9555
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1243 - acc: 0.9531
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1255 - acc: 0.9531
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1238 - acc: 0.9540

Test accuracy: 82.14170519299

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9457

choose_one :  9145

F1score :  0.8189448441247003

AUC :  0.9056656922854261

Confusion Matrix
[[7767 1632]
 [1690 7513]]
True label 0
0.8263645068624321  
0.17363549313756782  
True label 1
0.18363577094425731  
0.8163642290557427  

Train_result {'acc': [0.9540000009536743], 'loss': [0.1237552012205124]}
Saved model to disk


[[73.54047951833135, 1], [77.23900655843458, 2], [76.89495753144823, 3], [79.23341576174604, 4], [78.1045048919471, 5], [80.6848725943447, 6], [81.2439522631975, 7], [81.59337705623051, 8], [81.78152886786367, 9], [81.21169766691753, 10], [81.8890441887969, 11], [82.15783249113, 12], [82.48575421997634, 13], [81.8890441887969, 14], [82.14170519299, 15]]
max accuracy :  [82.48575421997634, 13]

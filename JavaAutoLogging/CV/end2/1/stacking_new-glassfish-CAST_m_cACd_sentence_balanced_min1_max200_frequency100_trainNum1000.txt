Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 07:54:44.495067: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-16 07:54:44.507628: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-16 07:54:44.510030: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xb7d94f0 executing computations on platform Host. Devices:
2019-10-16 07:54:44.510072: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:149: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  10792
one :  10820

Second data
zero :  10792
one :  10820

Third data
zero :  10792
one :  10820

4th data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

179
glassfish-AST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-AST

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 821
Over 150, Under 200 : 164
Over 200, Under 400 : 4
Over 400 : 0

253
glassfish-CAST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-CAST

Sentence length Average : 50

Under 10 : 4320
Over 10, Under 30 : 6874
Over 30, Under 100 : 7059
Over 100, Under 150 : 1787
Over 150, Under 200 : 894
Over 200, Under 400 : 678
Over 400 : 0

342
glassfish-depth_num
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-depth_num

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 822
Over 150, Under 200 : 163
Over 200, Under 400 : 4
Over 400 : 0

253
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 179, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 179, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 253, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 342, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 342, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 253, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          262656      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 768)          393984      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 512)          393728      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          131328      dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            130         dense_6_task_layer[0][0]         
==================================================================================================
Total params: 3,523,010
Trainable params: 1,765,698
Non-trainable params: 1,757,312
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:02 - loss: 0.7834 - acc: 0.5156
 128/1000 [==>...........................] - ETA: 1:02 - loss: 0.8505 - acc: 0.5000
 192/1000 [====>.........................] - ETA: 41s - loss: 0.8154 - acc: 0.4740 
 256/1000 [======>.......................] - ETA: 30s - loss: 0.7892 - acc: 0.4766
 320/1000 [========>.....................] - ETA: 23s - loss: 0.7735 - acc: 0.4750
 384/1000 [==========>...................] - ETA: 19s - loss: 0.7603 - acc: 0.4714
 448/1000 [============>.................] - ETA: 15s - loss: 0.7508 - acc: 0.4844
 512/1000 [==============>...............] - ETA: 12s - loss: 0.7418 - acc: 0.5020
 576/1000 [================>.............] - ETA: 10s - loss: 0.7384 - acc: 0.5000
 640/1000 [==================>...........] - ETA: 8s - loss: 0.7325 - acc: 0.5047 
 704/1000 [====================>.........] - ETA: 6s - loss: 0.7268 - acc: 0.5085
 768/1000 [======================>.......] - ETA: 4s - loss: 0.7230 - acc: 0.5156
 832/1000 [=======================>......] - ETA: 3s - loss: 0.7181 - acc: 0.5228
 896/1000 [=========================>....] - ETA: 2s - loss: 0.7175 - acc: 0.5212
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7156 - acc: 0.5177
1000/1000 [==============================] - 19s 19ms/step - loss: 0.7133 - acc: 0.5210

Test accuracy: 53.968562002716865

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  17034

choose_one :  3578

F1score :  0.31750827219105165

AUC :  0.5852248727541798

Confusion Matrix
[[8917 1371]
 [8117 2207]]
True label 0
0.8667379471228616  
0.1332620528771384  
True label 1
0.7862262688880279  
0.2137737311119721  

Train_result {'loss': [0.7132627339363098], 'acc': [0.5210000009536743]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.6730 - acc: 0.5781
 128/1000 [==>...........................] - ETA: 9s - loss: 0.6838 - acc: 0.5781 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6817 - acc: 0.5677
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6807 - acc: 0.5703
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6830 - acc: 0.5563
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6792 - acc: 0.5625
 448/1000 [============>.................] - ETA: 5s - loss: 0.6806 - acc: 0.5670
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6795 - acc: 0.5723
 576/1000 [================>.............] - ETA: 4s - loss: 0.6795 - acc: 0.5781
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6802 - acc: 0.5719
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6817 - acc: 0.5568
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6805 - acc: 0.5599
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6775 - acc: 0.5673
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6767 - acc: 0.5681
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6759 - acc: 0.5698
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6754 - acc: 0.5720

Test accuracy: 58.19910731612653

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  16424

choose_one :  4188

F1score :  0.40628445424476295

AUC :  0.633110998365252

Confusion Matrix
[[9048 1240]
 [7376 2948]]
True label 0
0.8794712286158631  
0.12052877138413685  
True label 1
0.7144517628826036  
0.28554823711739635  

Train_result {'loss': [0.6754058208465576], 'acc': [0.572]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.6755 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 9s - loss: 0.6566 - acc: 0.6250 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6494 - acc: 0.6406
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6345 - acc: 0.6562
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6418 - acc: 0.6469
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6300 - acc: 0.6641
 448/1000 [============>.................] - ETA: 5s - loss: 0.6285 - acc: 0.6607
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6226 - acc: 0.6602
 576/1000 [================>.............] - ETA: 4s - loss: 0.6264 - acc: 0.6493
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6200 - acc: 0.6500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6165 - acc: 0.6506
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6197 - acc: 0.6458
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6205 - acc: 0.6466
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6250 - acc: 0.6429
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6249 - acc: 0.6417
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6304 - acc: 0.6390

Test accuracy: 66.77663496992044

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12010

choose_one :  8602

F1score :  0.6381697136214731

AUC :  0.724081299715049

Confusion Matrix
[[7725 2563]
 [4285 6039]]
True label 0
0.7508748055987559  
0.24912519440124417  
True label 1
0.4150523053080201  
0.5849476946919798  

Train_result {'loss': [0.6303538460731506], 'acc': [0.6389999995231629]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.5414 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 9s - loss: 0.5371 - acc: 0.7031 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.5334 - acc: 0.6979
 256/1000 [======>.......................] - ETA: 7s - loss: 0.5384 - acc: 0.6953
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5395 - acc: 0.7063
 384/1000 [==========>...................] - ETA: 6s - loss: 0.5719 - acc: 0.6849
 448/1000 [============>.................] - ETA: 5s - loss: 0.5711 - acc: 0.6830
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5652 - acc: 0.6934
 576/1000 [================>.............] - ETA: 4s - loss: 0.5713 - acc: 0.6910
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5680 - acc: 0.6906
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5636 - acc: 0.6960
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5589 - acc: 0.7005
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5510 - acc: 0.7091
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5429 - acc: 0.7165
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5395 - acc: 0.7167
1000/1000 [==============================] - 10s 10ms/step - loss: 0.5444 - acc: 0.7130

Test accuracy: 69.72152144381913

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12897

choose_one :  7715

F1score :  0.6540273851100394

AUC :  0.7849916072667049

Confusion Matrix
[[8472 1816]
 [4425 5899]]
True label 0
0.8234836702954899  
0.17651632970451012  
True label 1
0.4286129407206509  
0.5713870592793491  

Train_result {'loss': [0.5444110860824585], 'acc': [0.713]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4990 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 9s - loss: 0.4784 - acc: 0.7344 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4870 - acc: 0.7240
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4659 - acc: 0.7578
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4511 - acc: 0.7781
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4671 - acc: 0.7656
 448/1000 [============>.................] - ETA: 5s - loss: 0.4591 - acc: 0.7723
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4456 - acc: 0.7852
 576/1000 [================>.............] - ETA: 4s - loss: 0.4450 - acc: 0.7865
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4344 - acc: 0.7953
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4496 - acc: 0.7827
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4596 - acc: 0.7865
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4611 - acc: 0.7849
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4607 - acc: 0.7891
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4661 - acc: 0.7854
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4642 - acc: 0.7860

Test accuracy: 74.14127692606249

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10284

choose_one :  10328

F1score :  0.741913616114662

AUC :  0.811561049899282

Confusion Matrix
[[7621 2667]
 [2663 7661]]
True label 0
0.7407659409020217  
0.25923405909797825  
True label 1
0.25794265788454085  
0.7420573421154592  

Train_result {'loss': [0.46418189215660094], 'acc': [0.7860000004768372]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4334 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 9s - loss: 0.4043 - acc: 0.8516 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4102 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4091 - acc: 0.8242
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4200 - acc: 0.8250
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4021 - acc: 0.8333
 448/1000 [============>.................] - ETA: 5s - loss: 0.4087 - acc: 0.8237
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3984 - acc: 0.8262
 576/1000 [================>.............] - ETA: 4s - loss: 0.3886 - acc: 0.8264
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3893 - acc: 0.8266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3870 - acc: 0.8239
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3870 - acc: 0.8216
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3885 - acc: 0.8221
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3772 - acc: 0.8292
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3766 - acc: 0.8302
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3790 - acc: 0.8310

Test accuracy: 75.21831942557733

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10442

choose_one :  10170

F1score :  0.7507563189226113

AUC :  0.8297779378163068

Confusion Matrix
[[7811 2477]
 [2631 7693]]
True label 0
0.7592340590979783  
0.24076594090202177  
True label 1
0.2548430840759396  
0.7451569159240604  

Train_result {'loss': [0.3790450279712677], 'acc': [0.8310000009536743]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.3372 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 9s - loss: 0.3269 - acc: 0.8750 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.3079 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3679 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3690 - acc: 0.8406
 384/1000 [==========>...................] - ETA: 6s - loss: 0.3479 - acc: 0.8490
 448/1000 [============>.................] - ETA: 5s - loss: 0.3556 - acc: 0.8415
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3531 - acc: 0.8438
 576/1000 [================>.............] - ETA: 4s - loss: 0.3479 - acc: 0.8490
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3458 - acc: 0.8469
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3632 - acc: 0.8438
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3576 - acc: 0.8477
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3505 - acc: 0.8510
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3439 - acc: 0.8549
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3389 - acc: 0.8594
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3410 - acc: 0.8560

Test accuracy: 74.75742286046963

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  8945

choose_one :  11667

F1score :  0.7634032104042563

AUC :  0.8324001938664713

Confusion Matrix
[[7015 3273]
 [1930 8394]]
True label 0
0.6818623639191291  
0.3181376360808709  
True label 1
0.18694304533126696  
0.8130569546687331  

Train_result {'loss': [0.34098536205291746], 'acc': [0.8559999990463257]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3121 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2821 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2959 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2611 - acc: 0.9102
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2641 - acc: 0.9125
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2649 - acc: 0.9089
 448/1000 [============>.................] - ETA: 5s - loss: 0.2703 - acc: 0.9040
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2843 - acc: 0.8945
 576/1000 [================>.............] - ETA: 4s - loss: 0.2660 - acc: 0.9010
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2599 - acc: 0.9016
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2561 - acc: 0.9034
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2609 - acc: 0.8958
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2681 - acc: 0.8918
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2736 - acc: 0.8895
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2766 - acc: 0.8927
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2765 - acc: 0.8920

Test accuracy: 75.86842615951873

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10282

choose_one :  10330

F1score :  0.7591749782124527

AUC :  0.8354390125787623

Confusion Matrix
[[7798 2490]
 [2484 7840]]
True label 0
0.7579704510108864  
0.24202954898911352  
True label 1
0.24060441689267725  
0.7593955831073227  

Train_result {'loss': [0.276499320268631], 'acc': [0.892]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2549 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2084 - acc: 0.9062 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2031 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2180 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2306 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2419 - acc: 0.8932
 448/1000 [============>.................] - ETA: 5s - loss: 0.2388 - acc: 0.8951
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2275 - acc: 0.9062
 576/1000 [================>.............] - ETA: 4s - loss: 0.2278 - acc: 0.9080
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2255 - acc: 0.9094
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2276 - acc: 0.9105
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2261 - acc: 0.9102
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2229 - acc: 0.9123
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2199 - acc: 0.9141
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2170 - acc: 0.9156
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2124 - acc: 0.9180

Test accuracy: 76.30021346788278

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10225

choose_one :  10387

F1score :  0.7641350007242529

AUC :  0.835615958383823

Confusion Matrix
[[7814 2474]
 [2411 7913]]
True label 0
0.7595256609642301  
0.24047433903576984  
True label 1
0.2335335141418055  
0.7664664858581945  

Train_result {'loss': [0.21237733936309813], 'acc': [0.9180000009536743]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1664 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1192 - acc: 0.9531 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1520 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1612 - acc: 0.9453
 320/1000 [========>.....................] - ETA: 7s - loss: 0.1820 - acc: 0.9313
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1593 - acc: 0.9401
 448/1000 [============>.................] - ETA: 5s - loss: 0.1533 - acc: 0.9375
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1671 - acc: 0.9316
 576/1000 [================>.............] - ETA: 4s - loss: 0.1914 - acc: 0.9201
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1983 - acc: 0.9187
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2090 - acc: 0.9119
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2049 - acc: 0.9128
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2012 - acc: 0.9147
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2034 - acc: 0.9107
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2060 - acc: 0.9094
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2100 - acc: 0.9070

Test accuracy: 74.98544537162817

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9308

choose_one :  11304

F1score :  0.7616053264287035

AUC :  0.8339911243893797

Confusion Matrix
[[7220 3068]
 [2088 8236]]
True label 0
0.7017884914463453  
0.29821150855365475  
True label 1
0.20224719101123595  
0.797752808988764  

Train_result {'loss': [0.2100386369228363], 'acc': [0.9070000009536743]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1703 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1685 - acc: 0.9453 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1690 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1865 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 7s - loss: 0.1951 - acc: 0.9281
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1956 - acc: 0.9271
 448/1000 [============>.................] - ETA: 5s - loss: 0.1919 - acc: 0.9308
 512/1000 [==============>...............] - ETA: 5s - loss: 0.1818 - acc: 0.9355
 576/1000 [================>.............] - ETA: 4s - loss: 0.1715 - acc: 0.9375
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1649 - acc: 0.9391
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1726 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1732 - acc: 0.9349
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1652 - acc: 0.9399
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1731 - acc: 0.9364
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1685 - acc: 0.9375
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1672 - acc: 0.9370

Test accuracy: 75.89753541626237

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10246

choose_one :  10366

F1score :  0.7598840019333011

AUC :  0.8346239640846527

Confusion Matrix
[[7783 2505]
 [2463 7861]]
True label 0
0.7565124416796267  
0.24348755832037325  
True label 1
0.23857032158078265  
0.7614296784192174  

Train_result {'loss': [0.1672232882976532], 'acc': [0.9370000004768372]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1262 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 9s - loss: 0.0839 - acc: 0.9609 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.0924 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1044 - acc: 0.9453
 320/1000 [========>.....................] - ETA: 7s - loss: 0.1354 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1448 - acc: 0.9323
 448/1000 [============>.................] - ETA: 5s - loss: 0.1486 - acc: 0.9375
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1488 - acc: 0.9395
 576/1000 [================>.............] - ETA: 4s - loss: 0.1750 - acc: 0.9358
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1754 - acc: 0.9375
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1666 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1646 - acc: 0.9414
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1643 - acc: 0.9423
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1598 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1570 - acc: 0.9448
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1549 - acc: 0.9440

Test accuracy: 76.38268969532311

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10880

choose_one :  9732

F1score :  0.7572796170721979

AUC :  0.8373824224594372

Confusion Matrix
[[8150 2138]
 [2730 7594]]
True label 0
0.7921850699844479  
0.2078149300155521  
True label 1
0.2644323905462999  
0.7355676094537001  

Train_result {'loss': [0.15493190717697145], 'acc': [0.9440000004768372]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1412 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1175 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1156 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1165 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1220 - acc: 0.9531
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1125 - acc: 0.9583
 448/1000 [============>.................] - ETA: 5s - loss: 0.1131 - acc: 0.9531
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1202 - acc: 0.9453
 576/1000 [================>.............] - ETA: 4s - loss: 0.1233 - acc: 0.9427
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1202 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1132 - acc: 0.9489
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1075 - acc: 0.9518
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1089 - acc: 0.9495
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1089 - acc: 0.9498
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1085 - acc: 0.9490
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1119 - acc: 0.9480

Test accuracy: 77.2850766543761

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11026

choose_one :  9586

F1score :  0.7648417880462078

AUC :  0.8434302613593294

Confusion Matrix
[[8316 1972]
 [2710 7614]]
True label 0
0.8083203732503889  
0.1916796267496112  
True label 1
0.26249515691592407  
0.7375048430840759  

Train_result {'loss': [0.11190377509593964], 'acc': [0.9480000004768372]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2509 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1609 - acc: 0.9297 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1977 - acc: 0.9271
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1608 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1562 - acc: 0.9406
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1612 - acc: 0.9401
 448/1000 [============>.................] - ETA: 5s - loss: 0.1639 - acc: 0.9420
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1581 - acc: 0.9434
 576/1000 [================>.............] - ETA: 4s - loss: 0.1505 - acc: 0.9462
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1400 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1422 - acc: 0.9489
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1400 - acc: 0.9505
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1481 - acc: 0.9447
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1452 - acc: 0.9453
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1416 - acc: 0.9479
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1469 - acc: 0.9450

Test accuracy: 76.6349699204347

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10946

choose_one :  9666

F1score :  0.7590795397698848

AUC :  0.8371246769896414

Confusion Matrix
[[8209 2079]
 [2737 7587]]
True label 0
0.7979199066874028  
0.20208009331259721  
True label 1
0.26511042231693144  
0.7348895776830686  

Train_result {'loss': [0.14691861772537232], 'acc': [0.945]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1087 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1308 - acc: 0.9453 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1380 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1266 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1259 - acc: 0.9594
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1232 - acc: 0.9583
 448/1000 [============>.................] - ETA: 5s - loss: 0.1189 - acc: 0.9621
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1211 - acc: 0.9629
 576/1000 [================>.............] - ETA: 4s - loss: 0.1268 - acc: 0.9566
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1185 - acc: 0.9609
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1258 - acc: 0.9574
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1232 - acc: 0.9557
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1231 - acc: 0.9567
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1231 - acc: 0.9554
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1241 - acc: 0.9542
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1261 - acc: 0.9540

Test accuracy: 76.87754705996507

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9380

choose_one :  11232

F1score :  0.7789014659491557

AUC :  0.8440213219224348

Confusion Matrix
[[7451 2837]
 [1929 8395]]
True label 0
0.724241835147745  
0.27575816485225507  
True label 1
0.18684618364974817  
0.8131538163502519  

Train_result {'loss': [0.12613812506198882], 'acc': [0.9539999995231628]}
Saved model to disk


[[53.968562002716865, 1], [58.19910731612653, 2], [66.77663496992044, 3], [69.72152144381913, 4], [74.14127692606249, 5], [75.21831942557733, 6], [74.75742286046963, 7], [75.86842615951873, 8], [76.30021346788278, 9], [74.98544537162817, 10], [75.89753541626237, 11], [76.38268969532311, 12], [77.2850766543761, 13], [76.6349699204347, 14], [76.87754705996507, 15]]
max accuracy :  [77.2850766543761, 13]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-15 03:21:01.883911: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-15 03:21:01.893703: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-15 03:21:01.896256: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8e89690 executing computations on platform Host. Devices:
2019-10-15 03:21:01.896282: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:86: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

Third data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

196
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
guava-CAST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-CAST

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

401
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 196, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 196, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 401, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 401, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1_task_layer (Dense)      (None, 256)          98560       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2_task_layer (Dense)      (None, 128)          32896       dense_1_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_2_task_layer[0][0]         
==================================================================================================
Total params: 945,794
Trainable params: 538,754
Non-trainable params: 407,040
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:14 - loss: 0.6359 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 38s - loss: 0.7082 - acc: 0.5859 
 192/1000 [====>.........................] - ETA: 26s - loss: 0.6606 - acc: 0.6406
 256/1000 [======>.......................] - ETA: 19s - loss: 0.6671 - acc: 0.6367
 320/1000 [========>.....................] - ETA: 15s - loss: 0.6582 - acc: 0.6500
 384/1000 [==========>...................] - ETA: 12s - loss: 0.6752 - acc: 0.6484
 448/1000 [============>.................] - ETA: 10s - loss: 0.6630 - acc: 0.6585
 512/1000 [==============>...............] - ETA: 8s - loss: 0.6592 - acc: 0.6621 
 576/1000 [================>.............] - ETA: 6s - loss: 0.6548 - acc: 0.6649
 640/1000 [==================>...........] - ETA: 5s - loss: 0.6536 - acc: 0.6687
 704/1000 [====================>.........] - ETA: 4s - loss: 0.6496 - acc: 0.6662
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6379 - acc: 0.6732
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6235 - acc: 0.6815
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6209 - acc: 0.6819
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6080 - acc: 0.6927
1000/1000 [==============================] - 13s 13ms/step - loss: 0.6029 - acc: 0.6980

Test accuracy: 72.98677561552522

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  13534

choose_one :  5068

F1score :  0.6478873239436619

AUC :  0.8598261087351105

Confusion Matrix
[[8954  445]
 [4580 4623]]
True label 0
0.9526545377167783  
0.04734546228322162  
True label 1
0.49766380528088666  
0.5023361947191133  

Train_result {'loss': [0.6029318232536316], 'acc': [0.6979999995231628]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.4618 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4503 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4522 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4529 - acc: 0.7734
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4476 - acc: 0.7750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4280 - acc: 0.7891
 448/1000 [============>.................] - ETA: 4s - loss: 0.4310 - acc: 0.7790
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4278 - acc: 0.7812
 576/1000 [================>.............] - ETA: 3s - loss: 0.4344 - acc: 0.7778
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4356 - acc: 0.7812
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4553 - acc: 0.7642
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4566 - acc: 0.7656
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4697 - acc: 0.7644
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4723 - acc: 0.7612
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4684 - acc: 0.7625
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4684 - acc: 0.7640

Test accuracy: 79.28717342221266

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10378

choose_one :  8224

F1score :  0.7789062948298615

AUC :  0.8794712035793896

Confusion Matrix
[[7962 1437]
 [2416 6787]]
True label 0
0.8471113948292371  
0.15288860517076286  
True label 1
0.2625230902966424  
0.7374769097033576  

Train_result {'loss': [0.4684160559177399], 'acc': [0.7640000004768371]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4309 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3987 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3854 - acc: 0.8229
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3674 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3671 - acc: 0.8281
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3835 - acc: 0.8099
 448/1000 [============>.................] - ETA: 5s - loss: 0.3986 - acc: 0.7991
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4011 - acc: 0.7949
 576/1000 [================>.............] - ETA: 3s - loss: 0.4156 - acc: 0.7847
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4118 - acc: 0.7875
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4140 - acc: 0.7841
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4159 - acc: 0.7852
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4096 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4031 - acc: 0.7980
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3969 - acc: 0.8052
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3961 - acc: 0.8070

Test accuracy: 80.19030211805183

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10960

choose_one :  7642

F1score :  0.7812407242505194

AUC :  0.8905260832099592

Confusion Matrix
[[8337 1062]
 [2623 6580]]
True label 0
0.8870092563038621  
0.11299074369613789  
True label 1
0.2850157557318266  
0.7149842442681734  

Train_result {'loss': [0.39606200623512267], 'acc': [0.8070000009536743]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3592 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3826 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3908 - acc: 0.8125
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3684 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3904 - acc: 0.8281
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3870 - acc: 0.8255
 448/1000 [============>.................] - ETA: 5s - loss: 0.3780 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3766 - acc: 0.8281
 576/1000 [================>.............] - ETA: 3s - loss: 0.3612 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3674 - acc: 0.8313
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3738 - acc: 0.8310
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3632 - acc: 0.8333
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3592 - acc: 0.8353
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3499 - acc: 0.8415
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3547 - acc: 0.8396
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3504 - acc: 0.8410

Test accuracy: 80.48059348457156

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9226

choose_one :  9376

F1score :  0.804564293019

AUC :  0.8946993917166461

Confusion Matrix
[[7497 1902]
 [1729 7474]]
True label 0
0.7976380466007023  
0.2023619533992978  
True label 1
0.1878735195045094  
0.8121264804954906  

Train_result {'loss': [0.3503637094497681], 'acc': [0.841]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2269 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2398 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2646 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2690 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2675 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2989 - acc: 0.8698
 448/1000 [============>.................] - ETA: 4s - loss: 0.3100 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3103 - acc: 0.8613
 576/1000 [================>.............] - ETA: 3s - loss: 0.3046 - acc: 0.8611
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3060 - acc: 0.8609
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3170 - acc: 0.8537
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3108 - acc: 0.8568
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3098 - acc: 0.8582
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3087 - acc: 0.8583
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3127 - acc: 0.8573
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3132 - acc: 0.8600

Test accuracy: 81.36759488227072

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10681

choose_one :  7921

F1score :  0.7975940200887642

AUC :  0.9026177494289327

Confusion Matrix
[[8307 1092]
 [2374 6829]]
True label 0
0.8838174273858921  
0.11618257261410789  
True label 1
0.2579593610779094  
0.7420406389220906  

Train_result {'loss': [0.31321118474006654], 'acc': [0.8600000004768371]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2530 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2989 - acc: 0.8516
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3044 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2984 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2940 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3083 - acc: 0.8646
 448/1000 [============>.................] - ETA: 5s - loss: 0.2944 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3010 - acc: 0.8633
 576/1000 [================>.............] - ETA: 3s - loss: 0.3003 - acc: 0.8646
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3050 - acc: 0.8641
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3027 - acc: 0.8651
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3008 - acc: 0.8646
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2975 - acc: 0.8678
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2999 - acc: 0.8661
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2935 - acc: 0.8688
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2912 - acc: 0.8690

Test accuracy: 81.77077733577035

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9556

choose_one :  9046

F1score :  0.8141815989917255

AUC :  0.9051751894880353

Confusion Matrix
[[7782 1617]
 [1774 7429]]
True label 0
0.8279604213214171  
0.17203957867858283  
True label 1
0.19276322938172336  
0.8072367706182767  

Train_result {'loss': [0.2912353792190552], 'acc': [0.869]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1850 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2337 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2454 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2311 - acc: 0.8984
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2290 - acc: 0.8906
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2278 - acc: 0.8880
 448/1000 [============>.................] - ETA: 4s - loss: 0.2228 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2222 - acc: 0.8945
 576/1000 [================>.............] - ETA: 3s - loss: 0.2393 - acc: 0.8906
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2490 - acc: 0.8859
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2409 - acc: 0.8906
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2397 - acc: 0.8919
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2294 - acc: 0.8954
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2316 - acc: 0.8929
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2375 - acc: 0.8927
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2339 - acc: 0.8940

Test accuracy: 81.70089237716375

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10881

choose_one :  7721

F1score :  0.7988655164263768

AUC :  0.9086050096049091

Confusion Matrix
[[8438  961]
 [2443 6760]]
True label 0
0.8977550803276945  
0.10224491967230556  
True label 1
0.2654569162229708  
0.7345430837770293  

Train_result {'loss': [0.23386704802513122], 'acc': [0.8940000004768371]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1783 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1342 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1732 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1687 - acc: 0.9219
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1784 - acc: 0.9187
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1791 - acc: 0.9167
 448/1000 [============>.................] - ETA: 4s - loss: 0.1947 - acc: 0.9085
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1920 - acc: 0.9102
 576/1000 [================>.............] - ETA: 3s - loss: 0.2161 - acc: 0.9010
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2080 - acc: 0.9047
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2126 - acc: 0.9048
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2099 - acc: 0.9062
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2139 - acc: 0.9075
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2153 - acc: 0.9062
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2226 - acc: 0.9042
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2213 - acc: 0.9050

Test accuracy: 82.17933555531664

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10148

choose_one :  8454

F1score :  0.812255762587076

AUC :  0.9085000315090359

Confusion Matrix
[[8116 1283]
 [2032 7171]]
True label 0
0.8634961166081498  
0.13650388339185018  
True label 1
0.22079756601108333  
0.7792024339889166  

Train_result {'loss': [0.22131099438667298], 'acc': [0.9050000004768372]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1449 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 7s - loss: 0.1546 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1494 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1594 - acc: 0.9453
 320/1000 [========>.....................] - ETA: 5s - loss: 0.1613 - acc: 0.9437
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1547 - acc: 0.9401
 448/1000 [============>.................] - ETA: 4s - loss: 0.1517 - acc: 0.9375
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1545 - acc: 0.9336
 576/1000 [================>.............] - ETA: 3s - loss: 0.1500 - acc: 0.9340
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1502 - acc: 0.9344
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1490 - acc: 0.9361
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1536 - acc: 0.9336
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1513 - acc: 0.9363
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1559 - acc: 0.9342
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1602 - acc: 0.9344
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1580 - acc: 0.9360

Test accuracy: 82.6900333297495

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9361

choose_one :  9241

F1score :  0.8254174799392757

AUC :  0.9106635132428184

Confusion Matrix
[[7770 1629]
 [1591 7612]]
True label 0
0.8266836897542291  
0.17331631024577082  
True label 1
0.1728784092143866  
0.8271215907856134  

Train_result {'loss': [0.15802372181415558], 'acc': [0.9360000009536743]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1293 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1464 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1556 - acc: 0.9219
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1406 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1566 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1588 - acc: 0.9219
 448/1000 [============>.................] - ETA: 5s - loss: 0.1601 - acc: 0.9241
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1536 - acc: 0.9316
 576/1000 [================>.............] - ETA: 3s - loss: 0.1486 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1435 - acc: 0.9328
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1470 - acc: 0.9304
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1467 - acc: 0.9336
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1439 - acc: 0.9363
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1383 - acc: 0.9397
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1347 - acc: 0.9427
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1413 - acc: 0.9420

Test accuracy: 82.20083861950329

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9648

choose_one :  8954

F1score :  0.8176460869086303

AUC :  0.9096673051596194

Confusion Matrix
[[7868 1531]
 [1780 7423]]
True label 0
0.8371103308862645  
0.1628896691137355  
True label 1
0.1934151906986852  
0.8065848093013148  

Train_result {'loss': [0.1412955641746521], 'acc': [0.9420000004768372]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1005 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0856 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0744 - acc: 0.9740
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0792 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0737 - acc: 0.9750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0878 - acc: 0.9661
 448/1000 [============>.................] - ETA: 4s - loss: 0.1132 - acc: 0.9554
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1191 - acc: 0.9551
 576/1000 [================>.............] - ETA: 3s - loss: 0.1193 - acc: 0.9549
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1132 - acc: 0.9547
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1114 - acc: 0.9531
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1177 - acc: 0.9518
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1245 - acc: 0.9507
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1226 - acc: 0.9498
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1188 - acc: 0.9521
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1217 - acc: 0.9510

Test accuracy: 82.3244812385765

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9771

choose_one :  8831

F1score :  0.817677719862482

AUC :  0.9078726311705094

Confusion Matrix
[[7941 1458]
 [1830 7373]]
True label 0
0.8448771145866582  
0.15512288541334185  
True label 1
0.1988482016733674  
0.8011517983266326  

Train_result {'loss': [0.12170801758766174], 'acc': [0.9510000004768372]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.0589 - acc: 0.9844
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0698 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0680 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0716 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 5s - loss: 0.0788 - acc: 0.9688
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0805 - acc: 0.9635
 448/1000 [============>.................] - ETA: 4s - loss: 0.0899 - acc: 0.9554
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0903 - acc: 0.9551
 576/1000 [================>.............] - ETA: 3s - loss: 0.0857 - acc: 0.9583
 640/1000 [==================>...........] - ETA: 3s - loss: 0.0878 - acc: 0.9578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.0979 - acc: 0.9574
 768/1000 [======================>.......] - ETA: 1s - loss: 0.0953 - acc: 0.9596
 832/1000 [=======================>......] - ETA: 1s - loss: 0.0949 - acc: 0.9591
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1057 - acc: 0.9554
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1057 - acc: 0.9563
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1100 - acc: 0.9540

Test accuracy: 81.97505644554349

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9152

choose_one :  9450

F1score :  0.8202433924837829

AUC :  0.9095006616088277

Confusion Matrix
[[7599 1800]
 [1553 7650]]
True label 0
0.8084902649218002  
0.19150973507819982  
True label 1
0.16874932087362818  
0.8312506791263718  

Train_result {'loss': [0.10996803414821625], 'acc': [0.9539999990463257]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.0512 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0874 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0922 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1108 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1137 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1130 - acc: 0.9688
 448/1000 [============>.................] - ETA: 4s - loss: 0.1384 - acc: 0.9621
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1393 - acc: 0.9551
 576/1000 [================>.............] - ETA: 3s - loss: 0.1311 - acc: 0.9566
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1257 - acc: 0.9594
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1215 - acc: 0.9616
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1252 - acc: 0.9596
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1293 - acc: 0.9543
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1292 - acc: 0.9531
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1268 - acc: 0.9542
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1244 - acc: 0.9550

Test accuracy: 81.85678959251693

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9766

choose_one :  8836

F1score :  0.8129053716946616

AUC :  0.9064068107055623

Confusion Matrix
[[7895 1504]
 [1871 7332]]
True label 0
0.8399829769124375  
0.1600170230875625  
True label 1
0.20330327067260676  
0.7966967293273932  

Train_result {'loss': [0.12443942970037461], 'acc': [0.9550000009536743]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1946 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1198 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1163 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1272 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1191 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1176 - acc: 0.9401
 448/1000 [============>.................] - ETA: 4s - loss: 0.1208 - acc: 0.9353
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1183 - acc: 0.9395
 576/1000 [================>.............] - ETA: 3s - loss: 0.1145 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1080 - acc: 0.9484
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1024 - acc: 0.9517
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1028 - acc: 0.9518
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1003 - acc: 0.9543
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1007 - acc: 0.9542
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1058 - acc: 0.9500
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1048 - acc: 0.9510

Test accuracy: 82.1847113213633

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9893

choose_one :  8709

F1score :  0.8149843680214381

AUC :  0.9052063343578423

Confusion Matrix
[[7989 1410]
 [1904 7299]]
True label 0
0.8499840408554101  
0.15001595914458984  
True label 1
0.20688905791589698  
0.793110942084103  

Train_result {'loss': [0.10478262543678284], 'acc': [0.9510000009536743]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1216 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 8s - loss: 0.0790 - acc: 0.9844
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0652 - acc: 0.9896
 256/1000 [======>.......................] - ETA: 6s - loss: 0.0677 - acc: 0.9883
 320/1000 [========>.....................] - ETA: 6s - loss: 0.0591 - acc: 0.9906
 384/1000 [==========>...................] - ETA: 5s - loss: 0.0704 - acc: 0.9870
 448/1000 [============>.................] - ETA: 4s - loss: 0.0653 - acc: 0.9888
 512/1000 [==============>...............] - ETA: 4s - loss: 0.0682 - acc: 0.9844
 576/1000 [================>.............] - ETA: 3s - loss: 0.0674 - acc: 0.9844
 640/1000 [==================>...........] - ETA: 3s - loss: 0.0741 - acc: 0.9844
 704/1000 [====================>.........] - ETA: 2s - loss: 0.0762 - acc: 0.9830
 768/1000 [======================>.......] - ETA: 1s - loss: 0.0802 - acc: 0.9818
 832/1000 [=======================>......] - ETA: 1s - loss: 0.0778 - acc: 0.9820
 896/1000 [=========================>....] - ETA: 0s - loss: 0.0796 - acc: 0.9810
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0813 - acc: 0.9802
1000/1000 [==============================] - 9s 9ms/step - loss: 0.0813 - acc: 0.9800

Test accuracy: 82.35673583485647

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9345

choose_one :  9257

F1score :  0.8222101841820152

AUC :  0.9066332815396692

Confusion Matrix
[[7731 1668]
 [1614 7589]]
True label 0
0.8225343121608681  
0.17746568783913183  
True label 1
0.1753775942627404  
0.8246224057372595  

Train_result {'loss': [0.08132546031475067], 'acc': [0.9800000009536743]}
Saved model to disk


[[72.98677561552522, 1], [79.28717342221266, 2], [80.19030211805183, 3], [80.48059348457156, 4], [81.36759488227072, 5], [81.77077733577035, 6], [81.70089237716375, 7], [82.17933555531664, 8], [82.6900333297495, 9], [82.20083861950329, 10], [82.3244812385765, 11], [81.97505644554349, 12], [81.85678959251693, 13], [82.1847113213633, 14], [82.35673583485647, 15]]
max accuracy :  [82.6900333297495, 9]

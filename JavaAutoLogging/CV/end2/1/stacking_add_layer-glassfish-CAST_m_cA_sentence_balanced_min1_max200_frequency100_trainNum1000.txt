Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-17 06:21:17.407776: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-17 06:21:17.415626: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-17 06:21:17.418310: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7edf2a0 executing computations on platform Host. Devices:
2019-10-17 06:21:17.418336: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:48: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  10792
one :  10820

Second data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

174
glassfish-AST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-AST

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 821
Over 150, Under 200 : 164
Over 200, Under 400 : 4
Over 400 : 0

253
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 174, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 174, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 253, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 256)          65792       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128)          32896       dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           8256        dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4_task_layer (Dense)      (None, 128)          8320        dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5_task_layer (Dense)      (None, 64)           8256        dense_4_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            130         dense_5_task_layer[0][0]         
==================================================================================================
Total params: 773,314
Trainable params: 395,010
Non-trainable params: 378,304
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 47s - loss: 0.6865 - acc: 0.5625
 128/1000 [==>...........................] - ETA: 24s - loss: 0.6870 - acc: 0.6016
 192/1000 [====>.........................] - ETA: 16s - loss: 0.6823 - acc: 0.5729
 256/1000 [======>.......................] - ETA: 12s - loss: 0.6843 - acc: 0.5742
 320/1000 [========>.....................] - ETA: 9s - loss: 0.6831 - acc: 0.5813 
 384/1000 [==========>...................] - ETA: 7s - loss: 0.6801 - acc: 0.5885
 448/1000 [============>.................] - ETA: 6s - loss: 0.6801 - acc: 0.5915
 512/1000 [==============>...............] - ETA: 5s - loss: 0.6766 - acc: 0.5957
 576/1000 [================>.............] - ETA: 4s - loss: 0.6825 - acc: 0.5868
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6801 - acc: 0.5875
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6742 - acc: 0.5952
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6700 - acc: 0.6042
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6681 - acc: 0.6070
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6647 - acc: 0.6116
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6659 - acc: 0.6094
1000/1000 [==============================] - 8s 8ms/step - loss: 0.6666 - acc: 0.6110

Test accuracy: 64.14709877741122

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10978

choose_one :  9634

F1score :  0.6297224170758594

AUC :  0.6912401808918266

Confusion Matrix
[[6938 3350]
 [4040 6284]]
True label 0
0.6743779160186625  
0.32562208398133746  
True label 1
0.3913211933359163  
0.6086788066640837  

Train_result {'acc': [0.6109999990463257], 'loss': [0.6665522375106812]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.5844 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 5s - loss: 0.6366 - acc: 0.6094
 192/1000 [====>.........................] - ETA: 4s - loss: 0.6292 - acc: 0.6302
 256/1000 [======>.......................] - ETA: 4s - loss: 0.6292 - acc: 0.6367
 320/1000 [========>.....................] - ETA: 3s - loss: 0.6190 - acc: 0.6656
 384/1000 [==========>...................] - ETA: 3s - loss: 0.6115 - acc: 0.6745
 448/1000 [============>.................] - ETA: 2s - loss: 0.6123 - acc: 0.6763
 512/1000 [==============>...............] - ETA: 2s - loss: 0.6049 - acc: 0.6797
 576/1000 [================>.............] - ETA: 2s - loss: 0.6032 - acc: 0.6892
 640/1000 [==================>...........] - ETA: 1s - loss: 0.6083 - acc: 0.6797
 704/1000 [====================>.........] - ETA: 1s - loss: 0.6043 - acc: 0.6776
 768/1000 [======================>.......] - ETA: 1s - loss: 0.6001 - acc: 0.6836
 832/1000 [=======================>......] - ETA: 0s - loss: 0.6002 - acc: 0.6839
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5949 - acc: 0.6875
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5884 - acc: 0.6896
1000/1000 [==============================] - 5s 5ms/step - loss: 0.5869 - acc: 0.6910

Test accuracy: 68.87735299825344

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11429

choose_one :  9183

F1score :  0.6711436920079972

AUC :  0.7536843592637428

Confusion Matrix
[[7651 2637]
 [3778 6546]]
True label 0
0.7436819595645412  
0.2563180404354588  
True label 1
0.365943432777993  
0.634056567222007  

Train_result {'acc': [0.6910000009536743], 'loss': [0.5869222764968872]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.5218 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 4s - loss: 0.5295 - acc: 0.7266
 192/1000 [====>.........................] - ETA: 4s - loss: 0.5280 - acc: 0.7135
 256/1000 [======>.......................] - ETA: 3s - loss: 0.5355 - acc: 0.7266
 320/1000 [========>.....................] - ETA: 3s - loss: 0.5551 - acc: 0.7063
 384/1000 [==========>...................] - ETA: 3s - loss: 0.5312 - acc: 0.7266
 448/1000 [============>.................] - ETA: 2s - loss: 0.5219 - acc: 0.7366
 512/1000 [==============>...............] - ETA: 2s - loss: 0.5251 - acc: 0.7324
 576/1000 [================>.............] - ETA: 2s - loss: 0.5298 - acc: 0.7257
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5297 - acc: 0.7250
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5324 - acc: 0.7259
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5232 - acc: 0.7357
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5204 - acc: 0.7416
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5149 - acc: 0.7467
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5255 - acc: 0.7417
1000/1000 [==============================] - 5s 5ms/step - loss: 0.5197 - acc: 0.7450

Test accuracy: 70.57539297496605

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12599

choose_one :  8013

F1score :  0.6692479685881005

AUC :  0.7806929088135394

Confusion Matrix
[[8411 1877]
 [4188 6136]]
True label 0
0.817554432348367  
0.18244556765163297  
True label 1
0.40565672220069743  
0.5943432777993026  

Train_result {'acc': [0.7449999995231629], 'loss': [0.519728059053421]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.4994 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 5s - loss: 0.4934 - acc: 0.7734
 192/1000 [====>.........................] - ETA: 4s - loss: 0.4881 - acc: 0.7708
 256/1000 [======>.......................] - ETA: 3s - loss: 0.5072 - acc: 0.7461
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4837 - acc: 0.7594
 384/1000 [==========>...................] - ETA: 3s - loss: 0.4748 - acc: 0.7682
 448/1000 [============>.................] - ETA: 2s - loss: 0.4721 - acc: 0.7723
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4691 - acc: 0.7715
 576/1000 [================>.............] - ETA: 2s - loss: 0.4632 - acc: 0.7760
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4729 - acc: 0.7656
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4742 - acc: 0.7685
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4742 - acc: 0.7747
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4716 - acc: 0.7716
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4691 - acc: 0.7701
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4639 - acc: 0.7729
1000/1000 [==============================] - 5s 5ms/step - loss: 0.4729 - acc: 0.7700

Test accuracy: 72.10362895400738

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11744

choose_one :  8868

F1score :  0.7003959983326387

AUC :  0.7943054962828011

Confusion Matrix
[[8141 2147]
 [3603 6721]]
True label 0
0.7913102643856921  
0.20868973561430793  
True label 1
0.3489926385122046  
0.6510073614877955  

Train_result {'acc': [0.7699999995231629], 'loss': [0.47289064931869507]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.4091 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4408 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 4s - loss: 0.4385 - acc: 0.7917
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4148 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4038 - acc: 0.8219
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3934 - acc: 0.8281
 448/1000 [============>.................] - ETA: 2s - loss: 0.4071 - acc: 0.8147
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4231 - acc: 0.8125
 576/1000 [================>.............] - ETA: 2s - loss: 0.4104 - acc: 0.8177
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4043 - acc: 0.8219
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4159 - acc: 0.8182
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4216 - acc: 0.8177
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4271 - acc: 0.8161
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4287 - acc: 0.8181
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4357 - acc: 0.8135
1000/1000 [==============================] - 5s 5ms/step - loss: 0.4369 - acc: 0.8110

Test accuracy: 71.95808267028914

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9512

choose_one :  11100

F1score :  0.7302091112770724

AUC :  0.8017710764918056

Confusion Matrix
[[7010 3278]
 [2502 7822]]
True label 0
0.6813763608087092  
0.31862363919129083  
True label 1
0.2423479271600155  
0.7576520728399845  

Train_result {'acc': [0.811], 'loss': [0.4369152567386627]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.4721 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4104 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 4s - loss: 0.4104 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4025 - acc: 0.8320
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4008 - acc: 0.8344
 384/1000 [==========>...................] - ETA: 3s - loss: 0.4238 - acc: 0.8229
 448/1000 [============>.................] - ETA: 2s - loss: 0.4165 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4261 - acc: 0.8223
 576/1000 [================>.............] - ETA: 2s - loss: 0.4296 - acc: 0.8160
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4202 - acc: 0.8187
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4208 - acc: 0.8210
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4203 - acc: 0.8190
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4206 - acc: 0.8185
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4238 - acc: 0.8158
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4182 - acc: 0.8198
1000/1000 [==============================] - 5s 5ms/step - loss: 0.4122 - acc: 0.8240

Test accuracy: 74.2868232097807

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11286

choose_one :  9326

F1score :  0.7302798982188295

AUC :  0.8151130434573023

Confusion Matrix
[[8137 2151]
 [3149 7175]]
True label 0
0.7909214618973561  
0.20907853810264385  
True label 1
0.3050174351026734  
0.6949825648973266  

Train_result {'acc': [0.8240000004768372], 'loss': [0.41220679569244384]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.4776 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4067 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 4s - loss: 0.3800 - acc: 0.8177
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3645 - acc: 0.8359
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3663 - acc: 0.8313
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3761 - acc: 0.8281
 448/1000 [============>.................] - ETA: 2s - loss: 0.3737 - acc: 0.8259
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3651 - acc: 0.8301
 576/1000 [================>.............] - ETA: 2s - loss: 0.3614 - acc: 0.8281
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3671 - acc: 0.8234
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3643 - acc: 0.8224
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3593 - acc: 0.8255
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3603 - acc: 0.8245
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3715 - acc: 0.8214
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3780 - acc: 0.8208
1000/1000 [==============================] - 5s 5ms/step - loss: 0.3765 - acc: 0.8240

Test accuracy: 74.18008926838735

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12478

choose_one :  8134

F1score :  0.711669736699534

AUC :  0.8166470507952901

Confusion Matrix
[[8722 1566]
 [3756 6568]]
True label 0
0.8477838258164853  
0.15221617418351477  
True label 1
0.36381247578457965  
0.6361875242154204  

Train_result {'acc': [0.8239999990463257], 'loss': [0.3765398383140564]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.4041 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3169 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 4s - loss: 0.3156 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3466 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3368 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3251 - acc: 0.8698
 448/1000 [============>.................] - ETA: 2s - loss: 0.3212 - acc: 0.8705
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3406 - acc: 0.8633
 576/1000 [================>.............] - ETA: 2s - loss: 0.3424 - acc: 0.8594
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3537 - acc: 0.8500
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3493 - acc: 0.8537
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3447 - acc: 0.8555
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3525 - acc: 0.8534
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3500 - acc: 0.8527
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3583 - acc: 0.8510
1000/1000 [==============================] - 5s 5ms/step - loss: 0.3566 - acc: 0.8520

Test accuracy: 73.93751212885698

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12054

choose_one :  8558

F1score :  0.7154962398051053

AUC :  0.8176121981771929

Confusion Matrix
[[8485 1803]
 [3569 6755]]
True label 0
0.8247472783825817  
0.17525272161741834  
True label 1
0.3456993413405657  
0.6543006586594343  

Train_result {'acc': [0.852], 'loss': [0.3566093051433563]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.2933 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3202 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 4s - loss: 0.2917 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2744 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2975 - acc: 0.8938
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3155 - acc: 0.8854
 448/1000 [============>.................] - ETA: 2s - loss: 0.3250 - acc: 0.8772
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3340 - acc: 0.8711
 576/1000 [================>.............] - ETA: 2s - loss: 0.3273 - acc: 0.8767
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3232 - acc: 0.8781
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3186 - acc: 0.8807
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3108 - acc: 0.8867
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3113 - acc: 0.8858
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3131 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3175 - acc: 0.8802
1000/1000 [==============================] - 5s 5ms/step - loss: 0.3199 - acc: 0.8770

Test accuracy: 73.80166893071997

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11636

choose_one :  8976

F1score :  0.7202072538860104

AUC :  0.8157344862760706

Confusion Matrix
[[8262 2026]
 [3374 6950]]
True label 0
0.8030715396578538  
0.1969284603421462  
True label 1
0.3268113134444014  
0.6731886865555986  

Train_result {'acc': [0.8770000004768371], 'loss': [0.3199165062904358]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3879 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 5s - loss: 0.2917 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 4s - loss: 0.2937 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2896 - acc: 0.8945
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2992 - acc: 0.8906
 384/1000 [==========>...................] - ETA: 3s - loss: 0.2827 - acc: 0.8958
 448/1000 [============>.................] - ETA: 2s - loss: 0.2885 - acc: 0.8929
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3036 - acc: 0.8867
 576/1000 [================>.............] - ETA: 2s - loss: 0.3256 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3381 - acc: 0.8719
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3475 - acc: 0.8679
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3401 - acc: 0.8685
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3369 - acc: 0.8678
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3342 - acc: 0.8683
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3330 - acc: 0.8688
1000/1000 [==============================] - 5s 5ms/step - loss: 0.3339 - acc: 0.8680

Test accuracy: 74.0102852707161

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12373

choose_one :  8239

F1score :  0.7114151807358724

AUC :  0.8174036179193809

Confusion Matrix
[[8652 1636]
 [3721 6603]]
True label 0
0.8409797822706065  
0.15902021772939348  
True label 1
0.3604223169314219  
0.6395776830685781  

Train_result {'acc': [0.8680000009536744], 'loss': [0.3338622725009918]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3363 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3321 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 4s - loss: 0.3346 - acc: 0.8646
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3357 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3395 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3462 - acc: 0.8594
 448/1000 [============>.................] - ETA: 2s - loss: 0.3506 - acc: 0.8594
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3350 - acc: 0.8691
 576/1000 [================>.............] - ETA: 2s - loss: 0.3264 - acc: 0.8698
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3247 - acc: 0.8703
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3164 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3060 - acc: 0.8802
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3004 - acc: 0.8846
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2999 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3020 - acc: 0.8844
1000/1000 [==============================] - 5s 5ms/step - loss: 0.3050 - acc: 0.8840

Test accuracy: 74.17038618280614

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11612

choose_one :  9000

F1score :  0.7244876837093769

AUC :  0.820266724193668

Confusion Matrix
[[8288 2000]
 [3324 7000]]
True label 0
0.8055987558320373  
0.19440124416796267  
True label 1
0.3219682293684618  
0.6780317706315382  

Train_result {'acc': [0.884], 'loss': [0.3050168204307556]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.2059 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2212 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 4s - loss: 0.2087 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2232 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2134 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 3s - loss: 0.2223 - acc: 0.9167
 448/1000 [============>.................] - ETA: 2s - loss: 0.2371 - acc: 0.9129
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2417 - acc: 0.9121
 576/1000 [================>.............] - ETA: 2s - loss: 0.2427 - acc: 0.9115
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2511 - acc: 0.9078
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2460 - acc: 0.9062
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2562 - acc: 0.8971
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2527 - acc: 0.9014
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2626 - acc: 0.8984
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2636 - acc: 0.8979
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2655 - acc: 0.8960

Test accuracy: 74.39355715117408

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10986

choose_one :  9626

F1score :  0.735438596491228

AUC :  0.8169337286083311

Confusion Matrix
[[7998 2290]
 [2988 7336]]
True label 0
0.7774105754276828  
0.22258942457231726  
True label 1
0.289422704378148  
0.710577295621852  

Train_result {'acc': [0.8960000009536743], 'loss': [0.2654658968448639]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3308 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3381 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 4s - loss: 0.3497 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3153 - acc: 0.8438
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2929 - acc: 0.8594
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3067 - acc: 0.8542
 448/1000 [============>.................] - ETA: 2s - loss: 0.2870 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2837 - acc: 0.8711
 576/1000 [================>.............] - ETA: 2s - loss: 0.2814 - acc: 0.8750
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2715 - acc: 0.8812
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2758 - acc: 0.8793
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2690 - acc: 0.8880
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2710 - acc: 0.8894
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2687 - acc: 0.8895
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2668 - acc: 0.8896
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2662 - acc: 0.8900

Test accuracy: 73.51542790607412

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11367

choose_one :  9245

F1score :  0.7210383770248863

AUC :  0.8133595815183693

Confusion Matrix
[[8098 2190]
 [3269 7055]]
True label 0
0.7871306376360808  
0.21286936236391912  
True label 1
0.31664083688492833  
0.6833591631150717  

Train_result {'acc': [0.8899999990463257], 'loss': [0.26618193674087526]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3605 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 5s - loss: 0.2949 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 4s - loss: 0.2519 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2221 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2283 - acc: 0.9187
 384/1000 [==========>...................] - ETA: 3s - loss: 0.2432 - acc: 0.9167
 448/1000 [============>.................] - ETA: 2s - loss: 0.2355 - acc: 0.9174
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2275 - acc: 0.9160
 576/1000 [================>.............] - ETA: 2s - loss: 0.2294 - acc: 0.9167
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2413 - acc: 0.9094
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2329 - acc: 0.9162
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2305 - acc: 0.9128
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2311 - acc: 0.9135
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2307 - acc: 0.9107
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2284 - acc: 0.9104
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2308 - acc: 0.9090

Test accuracy: 73.27285076654377

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10537

choose_one :  10075

F1score :  0.7299377420461788

AUC :  0.8065928167271538

Confusion Matrix
[[7658 2630]
 [2879 7445]]
True label 0
0.7443623639191291  
0.2556376360808709  
True label 1
0.27886478109259977  
0.7211352189074002  

Train_result {'acc': [0.909], 'loss': [0.230831729888916]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.1523 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1341 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 4s - loss: 0.1901 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2231 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2448 - acc: 0.8969
 384/1000 [==========>...................] - ETA: 3s - loss: 0.2463 - acc: 0.9010
 448/1000 [============>.................] - ETA: 2s - loss: 0.2575 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2379 - acc: 0.9062
 576/1000 [================>.............] - ETA: 2s - loss: 0.2326 - acc: 0.9097
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2267 - acc: 0.9125
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2297 - acc: 0.9077
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2302 - acc: 0.9062
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2334 - acc: 0.9050
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2352 - acc: 0.9029
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2301 - acc: 0.9062
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2260 - acc: 0.9100

Test accuracy: 73.68523190374539

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9822

choose_one :  10790

F1score :  0.7431088377379939

AUC :  0.8094835278274722

Confusion Matrix
[[7343 2945]
 [2479 7845]]
True label 0
0.7137441679626749  
0.286255832037325  
True label 1
0.2401201084850833  
0.7598798915149167  

Train_result {'acc': [0.91], 'loss': [0.22599651098251342]}
Saved model to disk


[[64.14709877741122, 1], [68.87735299825344, 2], [70.57539297496605, 3], [72.10362895400738, 4], [71.95808267028914, 5], [74.2868232097807, 6], [74.18008926838735, 7], [73.93751212885698, 8], [73.80166893071997, 9], [74.0102852707161, 10], [74.17038618280614, 11], [74.39355715117408, 12], [73.51542790607412, 13], [73.27285076654377, 14], [73.68523190374539, 15]]
max accuracy :  [74.39355715117408, 12]

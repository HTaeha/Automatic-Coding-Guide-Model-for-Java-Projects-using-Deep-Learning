Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 06:49:39.898506: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-16 06:49:39.922532: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-16 06:49:39.958244: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9c797a0 executing computations on platform Host. Devices:
2019-10-16 06:49:39.958264: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:93: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

Third data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

188
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
hbase-CAST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-CAST

Sentence length Average : 52

Under 10 : 2622
Over 10, Under 30 : 6971
Over 30, Under 100 : 7184
Over 100, Under 150 : 1632
Over 150, Under 200 : 757
Over 200, Under 400 : 688
Over 400 : 1

630
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 188, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 188, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 630, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 630, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          147840      concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 128)          32896       dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 64)           8256        dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 32)           2080        dense_5[0][0]                    
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            66          dense_6_task_layer[0][0]         
==================================================================================================
Total params: 1,851,106
Trainable params: 926,626
Non-trainable params: 924,480
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:58 - loss: 0.6204 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 1:29 - loss: 0.6702 - acc: 0.6094
 192/1000 [====>.........................] - ETA: 58s - loss: 0.6436 - acc: 0.6146 
 256/1000 [======>.......................] - ETA: 42s - loss: 0.6171 - acc: 0.6602
 320/1000 [========>.....................] - ETA: 33s - loss: 0.6332 - acc: 0.6500
 384/1000 [==========>...................] - ETA: 26s - loss: 0.6595 - acc: 0.6276
 448/1000 [============>.................] - ETA: 21s - loss: 0.6669 - acc: 0.6228
 512/1000 [==============>...............] - ETA: 17s - loss: 0.6665 - acc: 0.6387
 576/1000 [================>.............] - ETA: 14s - loss: 0.6594 - acc: 0.6389
 640/1000 [==================>...........] - ETA: 11s - loss: 0.6554 - acc: 0.6469
 704/1000 [====================>.........] - ETA: 8s - loss: 0.6530 - acc: 0.6591 
 768/1000 [======================>.......] - ETA: 6s - loss: 0.6523 - acc: 0.6641
 832/1000 [=======================>......] - ETA: 4s - loss: 0.6490 - acc: 0.6671
 896/1000 [=========================>....] - ETA: 2s - loss: 0.6424 - acc: 0.6730
 960/1000 [===========================>..] - ETA: 1s - loss: 0.6341 - acc: 0.6813
1000/1000 [==============================] - 25s 25ms/step - loss: 0.6338 - acc: 0.6800

Test accuracy: 70.88835852559004

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  7510

choose_one :  11345

F1score :  0.7365237843805501

AUC :  0.7834524302784469

Confusion Matrix
[[5694 3673]
 [1816 7672]]
True label 0
0.6078787231771111  
0.3921212768228889  
True label 1
0.19139966273187184  
0.8086003372681282  

Train_result {'loss': [0.633808102607727], 'acc': [0.6799999990463257]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.5977 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5472 - acc: 0.7109
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5461 - acc: 0.6979
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5396 - acc: 0.7148
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5378 - acc: 0.7281 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5437 - acc: 0.7240
 448/1000 [============>.................] - ETA: 7s - loss: 0.5518 - acc: 0.7232
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5446 - acc: 0.7266
 576/1000 [================>.............] - ETA: 5s - loss: 0.5382 - acc: 0.7309
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5244 - acc: 0.7406
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5111 - acc: 0.7486
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5158 - acc: 0.7461
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5159 - acc: 0.7488
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5169 - acc: 0.7467
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5196 - acc: 0.7479
1000/1000 [==============================] - 13s 13ms/step - loss: 0.5251 - acc: 0.7420

Test accuracy: 73.85308936621587

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9909

choose_one :  8946

F1score :  0.7325594011066506

AUC :  0.8145455116640512

Confusion Matrix
[[7173 2194]
 [2736 6752]]
True label 0
0.7657734600192164  
0.2342265399807836  
True label 1
0.28836424957841483  
0.7116357504215851  

Train_result {'loss': [0.5251087679862976], 'acc': [0.7420000009536744]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 28s - loss: 0.4066 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 26s - loss: 0.4035 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 23s - loss: 0.4415 - acc: 0.7969
 256/1000 [======>.......................] - ETA: 18s - loss: 0.4353 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 15s - loss: 0.4452 - acc: 0.7937
 384/1000 [==========>...................] - ETA: 13s - loss: 0.4579 - acc: 0.7995
 448/1000 [============>.................] - ETA: 11s - loss: 0.4624 - acc: 0.7902
 512/1000 [==============>...............] - ETA: 10s - loss: 0.4579 - acc: 0.7949
 576/1000 [================>.............] - ETA: 8s - loss: 0.4494 - acc: 0.8003 
 640/1000 [==================>...........] - ETA: 7s - loss: 0.4455 - acc: 0.7969
 704/1000 [====================>.........] - ETA: 5s - loss: 0.4477 - acc: 0.7983
 768/1000 [======================>.......] - ETA: 4s - loss: 0.4390 - acc: 0.8034
 832/1000 [=======================>......] - ETA: 3s - loss: 0.4365 - acc: 0.8029
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4333 - acc: 0.8036
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4333 - acc: 0.8010
1000/1000 [==============================] - 18s 18ms/step - loss: 0.4276 - acc: 0.8040

Test accuracy: 76.01697162556351

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9869

choose_one :  8986

F1score :  0.7552235574320667

AUC :  0.8324114205336053

Confusion Matrix
[[7357 2010]
 [2512 6976]]
True label 0
0.7854168890786805  
0.21458311092131951  
True label 1
0.26475548060708265  
0.7352445193929174  

Train_result {'loss': [0.42756173491477967], 'acc': [0.804]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.3781 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 14s - loss: 0.4113 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 13s - loss: 0.4291 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 11s - loss: 0.3944 - acc: 0.8359
 320/1000 [========>.....................] - ETA: 10s - loss: 0.3757 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3736 - acc: 0.8438 
 448/1000 [============>.................] - ETA: 8s - loss: 0.3607 - acc: 0.8504
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3738 - acc: 0.8457
 576/1000 [================>.............] - ETA: 6s - loss: 0.3634 - acc: 0.8524
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3716 - acc: 0.8469
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3652 - acc: 0.8494
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3629 - acc: 0.8516
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3607 - acc: 0.8498
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3557 - acc: 0.8504
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3589 - acc: 0.8469
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3637 - acc: 0.8450

Test accuracy: 76.64810395120658

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10196

choose_one :  8659

F1score :  0.757370364247534

AUC :  0.8444548116697581

Confusion Matrix
[[7580 1787]
 [2616 6872]]
True label 0
0.8092238710366179  
0.19077612896338209  
True label 1
0.275716694772344  
0.7242833052276559  

Train_result {'loss': [0.3636553349494934], 'acc': [0.8450000004768372]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 22s - loss: 0.3131 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 16s - loss: 0.4243 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 14s - loss: 0.3777 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 12s - loss: 0.3598 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 11s - loss: 0.3622 - acc: 0.8562
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3426 - acc: 0.8646 
 448/1000 [============>.................] - ETA: 8s - loss: 0.3371 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3442 - acc: 0.8613
 576/1000 [================>.............] - ETA: 6s - loss: 0.3330 - acc: 0.8646
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3300 - acc: 0.8703
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3202 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3155 - acc: 0.8750
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3134 - acc: 0.8762
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3171 - acc: 0.8761
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3227 - acc: 0.8740
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3217 - acc: 0.8740

Test accuracy: 77.41182710156457

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10532

choose_one :  8323

F1score :  0.7608781090337431

AUC :  0.8549443417123477

Confusion Matrix
[[7820 1547]
 [2712 6776]]
True label 0
0.8348457350272233  
0.16515426497277677  
True label 1
0.28583473861720066  
0.7141652613827993  

Train_result {'loss': [0.3216606047153473], 'acc': [0.874]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.1707 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 12s - loss: 0.2153 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 11s - loss: 0.2630 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 10s - loss: 0.2642 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 9s - loss: 0.2663 - acc: 0.8531 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.2629 - acc: 0.8646
 448/1000 [============>.................] - ETA: 7s - loss: 0.2546 - acc: 0.8705
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2538 - acc: 0.8730
 576/1000 [================>.............] - ETA: 5s - loss: 0.2596 - acc: 0.8733
 640/1000 [==================>...........] - ETA: 4s - loss: 0.2519 - acc: 0.8781
 704/1000 [====================>.........] - ETA: 3s - loss: 0.2470 - acc: 0.8835
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2522 - acc: 0.8802
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2598 - acc: 0.8774
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2605 - acc: 0.8783
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2543 - acc: 0.8823
1000/1000 [==============================] - 13s 13ms/step - loss: 0.2555 - acc: 0.8810

Test accuracy: 77.48607796340494

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10660

choose_one :  8195

F1score :  0.7599389243906577

AUC :  0.8553180163992893

Confusion Matrix
[[7891 1476]
 [2769 6719]]
True label 0
0.8424255364577773  
0.1575744635422227  
True label 1
0.2918423271500843  
0.7081576728499157  

Train_result {'loss': [0.25547075176239015], 'acc': [0.8810000009536744]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 15s - loss: 0.1291 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1723 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 11s - loss: 0.1942 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 10s - loss: 0.2119 - acc: 0.9219
 320/1000 [========>.....................] - ETA: 9s - loss: 0.2075 - acc: 0.9250 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.2093 - acc: 0.9193
 448/1000 [============>.................] - ETA: 7s - loss: 0.2083 - acc: 0.9174
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2126 - acc: 0.9121
 576/1000 [================>.............] - ETA: 5s - loss: 0.2080 - acc: 0.9149
 640/1000 [==================>...........] - ETA: 5s - loss: 0.2214 - acc: 0.9125
 704/1000 [====================>.........] - ETA: 4s - loss: 0.2188 - acc: 0.9119
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2245 - acc: 0.9076
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2194 - acc: 0.9123
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2234 - acc: 0.9096
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2273 - acc: 0.9073
1000/1000 [==============================] - 14s 14ms/step - loss: 0.2230 - acc: 0.9100

Test accuracy: 77.51259612834792

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10529

choose_one :  8326

F1score :  0.7619849556528573

AUC :  0.8546148081213675

Confusion Matrix
[[7828 1539]
 [2701 6787]]
True label 0
0.8356997971602435  
0.1643002028397566  
True label 1
0.28467537942664417  
0.7153246205733558  

Train_result {'loss': [0.2229797887802124], 'acc': [0.9100000009536743]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.3054 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 12s - loss: 0.2807 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 11s - loss: 0.2353 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 10s - loss: 0.2170 - acc: 0.9219
 320/1000 [========>.....................] - ETA: 9s - loss: 0.2137 - acc: 0.9219 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.2191 - acc: 0.9245
 448/1000 [============>.................] - ETA: 7s - loss: 0.2180 - acc: 0.9219
 512/1000 [==============>...............] - ETA: 6s - loss: 0.2080 - acc: 0.9258
 576/1000 [================>.............] - ETA: 5s - loss: 0.2051 - acc: 0.9219
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1946 - acc: 0.9234
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1963 - acc: 0.9247
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1874 - acc: 0.9284
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2059 - acc: 0.9231
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1991 - acc: 0.9252
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2053 - acc: 0.9240
1000/1000 [==============================] - 13s 13ms/step - loss: 0.2038 - acc: 0.9250

Test accuracy: 78.00053036329886

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9345

choose_one :  9510

F1score :  0.7816612274976315

AUC :  0.8551867858098945

Confusion Matrix
[[7282 2085]
 [2063 7425]]
True label 0
0.7774100565816163  
0.2225899434183837  
True label 1
0.21743254637436762  
0.7825674536256324  

Train_result {'loss': [0.20378168952465056], 'acc': [0.9249999995231628]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.0785 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1226 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 11s - loss: 0.1236 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1210 - acc: 0.9492
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1291 - acc: 0.9469 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1411 - acc: 0.9401
 448/1000 [============>.................] - ETA: 7s - loss: 0.1367 - acc: 0.9442
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1324 - acc: 0.9453
 576/1000 [================>.............] - ETA: 5s - loss: 0.1428 - acc: 0.9392
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1343 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1331 - acc: 0.9460
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1444 - acc: 0.9414
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1477 - acc: 0.9387
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1514 - acc: 0.9375
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1573 - acc: 0.9333
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1536 - acc: 0.9350

Test accuracy: 77.1678599840891

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8578

choose_one :  10277

F1score :  0.7821907412092082

AUC :  0.8491413572296702

Confusion Matrix
[[6820 2547]
 [1758 7730]]
True label 0
0.728087968399701  
0.2719120316002989  
True label 1
0.1852866779089376  
0.8147133220910624  

Train_result {'loss': [0.15360870116949082], 'acc': [0.9350000009536743]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.0977 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 12s - loss: 0.0761 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 11s - loss: 0.0890 - acc: 0.9740
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1130 - acc: 0.9609
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1200 - acc: 0.9594 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1191 - acc: 0.9557
 448/1000 [============>.................] - ETA: 7s - loss: 0.1189 - acc: 0.9576
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1279 - acc: 0.9531
 576/1000 [================>.............] - ETA: 5s - loss: 0.1278 - acc: 0.9531
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1253 - acc: 0.9563
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1343 - acc: 0.9503
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1349 - acc: 0.9466
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1443 - acc: 0.9411
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1443 - acc: 0.9408
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1455 - acc: 0.9417
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1460 - acc: 0.9430

Test accuracy: 77.21028904799788

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8610

choose_one :  10245

F1score :  0.782242943292961

AUC :  0.8508057060856068

Confusion Matrix
[[6840 2527]
 [1770 7718]]
True label 0
0.7302231237322515  
0.2697768762677485  
True label 1
0.1865514333895447  
0.8134485666104553  

Train_result {'loss': [0.14595016646385192], 'acc': [0.9430000009536743]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.1457 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1148 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 11s - loss: 0.1208 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1170 - acc: 0.9609
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1214 - acc: 0.9594 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1244 - acc: 0.9557
 448/1000 [============>.................] - ETA: 7s - loss: 0.1249 - acc: 0.9554
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1223 - acc: 0.9551
 576/1000 [================>.............] - ETA: 5s - loss: 0.1190 - acc: 0.9566
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1226 - acc: 0.9531
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1224 - acc: 0.9545
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1255 - acc: 0.9505
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1205 - acc: 0.9531
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1229 - acc: 0.9509
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1246 - acc: 0.9500
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1208 - acc: 0.9520

Test accuracy: 77.87854680456113

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9150

choose_one :  9705

F1score :  0.7826811858490075

AUC :  0.8552437371627386

Confusion Matrix
[[7173 2194]
 [1977 7511]]
True label 0
0.7657734600192164  
0.2342265399807836  
True label 1
0.20836846543001686  
0.7916315345699831  

Train_result {'loss': [0.12075011119246483], 'acc': [0.952]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.1035 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 12s - loss: 0.0658 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 11s - loss: 0.1055 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 10s - loss: 0.1186 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1009 - acc: 0.9656 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1114 - acc: 0.9583
 448/1000 [============>.................] - ETA: 7s - loss: 0.1072 - acc: 0.9598
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1062 - acc: 0.9570
 576/1000 [================>.............] - ETA: 5s - loss: 0.1156 - acc: 0.9566
 640/1000 [==================>...........] - ETA: 4s - loss: 0.1113 - acc: 0.9563
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1041 - acc: 0.9588
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1098 - acc: 0.9583
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1110 - acc: 0.9555
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1079 - acc: 0.9565
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1129 - acc: 0.9542
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1121 - acc: 0.9540

Test accuracy: 76.7913020418987

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8573

choose_one :  10282

F1score :  0.7786545270612039

AUC :  0.8463813404076708

Confusion Matrix
[[6782 2585]
 [1791 7697]]
True label 0
0.7240311732678553  
0.2759688267321448  
True label 1
0.1887647554806071  
0.8112352445193929  

Train_result {'loss': [0.11209324991703033], 'acc': [0.9539999995231628]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.0485 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 12s - loss: 0.0622 - acc: 0.9844
 192/1000 [====>.........................] - ETA: 11s - loss: 0.0721 - acc: 0.9792
 256/1000 [======>.......................] - ETA: 10s - loss: 0.0724 - acc: 0.9727
 320/1000 [========>.....................] - ETA: 9s - loss: 0.0704 - acc: 0.9750 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.0758 - acc: 0.9714
 448/1000 [============>.................] - ETA: 7s - loss: 0.0695 - acc: 0.9754
 512/1000 [==============>...............] - ETA: 6s - loss: 0.0711 - acc: 0.9746
 576/1000 [================>.............] - ETA: 5s - loss: 0.0669 - acc: 0.9757
 640/1000 [==================>...........] - ETA: 4s - loss: 0.0836 - acc: 0.9703
 704/1000 [====================>.........] - ETA: 3s - loss: 0.0962 - acc: 0.9659
 768/1000 [======================>.......] - ETA: 3s - loss: 0.0988 - acc: 0.9635
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1020 - acc: 0.9615
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0987 - acc: 0.9632
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0968 - acc: 0.9635
1000/1000 [==============================] - 13s 13ms/step - loss: 0.0983 - acc: 0.9630

Test accuracy: 77.76717051180059

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8901

choose_one :  9954

F1score :  0.7843843226005555

AUC :  0.8517117574956825

Confusion Matrix
[[7038 2329]
 [1863 7625]]
True label 0
0.7513611615245009  
0.24863883847549909  
True label 1
0.1963532883642496  
0.8036467116357504  

Train_result {'loss': [0.09830244982242584], 'acc': [0.9629999995231628]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.0778 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 12s - loss: 0.1012 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 10s - loss: 0.1146 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 9s - loss: 0.1204 - acc: 0.9453 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.1109 - acc: 0.9500
 384/1000 [==========>...................] - ETA: 8s - loss: 0.1035 - acc: 0.9531
 448/1000 [============>.................] - ETA: 7s - loss: 0.1086 - acc: 0.9509
 512/1000 [==============>...............] - ETA: 6s - loss: 0.1062 - acc: 0.9512
 576/1000 [================>.............] - ETA: 5s - loss: 0.1075 - acc: 0.9514
 640/1000 [==================>...........] - ETA: 4s - loss: 0.0997 - acc: 0.9563
 704/1000 [====================>.........] - ETA: 3s - loss: 0.0949 - acc: 0.9588
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1015 - acc: 0.9557
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1003 - acc: 0.9555
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0987 - acc: 0.9576
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1008 - acc: 0.9583
1000/1000 [==============================] - 13s 13ms/step - loss: 0.1020 - acc: 0.9580

Test accuracy: 77.1678599840891

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8636

choose_one :  10219

F1score :  0.7815497031511647

AUC :  0.8500116895703783

Confusion Matrix
[[6849 2518]
 [1787 7701]]
True label 0
0.7311839436318992  
0.2688160563681008  
True label 1
0.18834317032040473  
0.8116568296795953  

Train_result {'loss': [0.10197186517715454], 'acc': [0.9579999995231628]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.1176 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 12s - loss: 0.0665 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 11s - loss: 0.0535 - acc: 0.9792
 256/1000 [======>.......................] - ETA: 10s - loss: 0.0719 - acc: 0.9688
 320/1000 [========>.....................] - ETA: 9s - loss: 0.0742 - acc: 0.9688 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.0890 - acc: 0.9661
 448/1000 [============>.................] - ETA: 7s - loss: 0.0872 - acc: 0.9688
 512/1000 [==============>...............] - ETA: 6s - loss: 0.0810 - acc: 0.9707
 576/1000 [================>.............] - ETA: 5s - loss: 0.0821 - acc: 0.9705
 640/1000 [==================>...........] - ETA: 4s - loss: 0.0835 - acc: 0.9688
 704/1000 [====================>.........] - ETA: 4s - loss: 0.0831 - acc: 0.9688
 768/1000 [======================>.......] - ETA: 3s - loss: 0.0844 - acc: 0.9688
 832/1000 [=======================>......] - ETA: 2s - loss: 0.0828 - acc: 0.9700
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0803 - acc: 0.9721
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0792 - acc: 0.9719
1000/1000 [==============================] - 14s 14ms/step - loss: 0.0797 - acc: 0.9710

Test accuracy: 77.41182710156457

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8974

choose_one :  9881

F1score :  0.7801125509835305

AUC :  0.8485205520402707

Confusion Matrix
[[7041 2326]
 [1933 7555]]
True label 0
0.7516814348243834  
0.2483185651756165  
True label 1
0.2037310286677909  
0.7962689713322091  

Train_result {'loss': [0.07971185111999511], 'acc': [0.9709999995231628]}
Saved model to disk


[[70.88835852559004, 1], [73.85308936621587, 2], [76.01697162556351, 3], [76.64810395120658, 4], [77.41182710156457, 5], [77.48607796340494, 6], [77.51259612834792, 7], [78.00053036329886, 8], [77.1678599840891, 9], [77.21028904799788, 10], [77.87854680456113, 11], [76.7913020418987, 12], [77.76717051180059, 13], [77.1678599840891, 14], [77.41182710156457, 15]]
max accuracy :  [78.00053036329886, 8]

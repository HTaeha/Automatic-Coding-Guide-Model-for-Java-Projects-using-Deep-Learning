Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-16 07:29:56.147192: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-16 07:29:56.156889: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-16 07:29:56.159079: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9133720 executing computations on platform Host. Devices:
2019-10-16 07:29:56.159114: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:47: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

184
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 184, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 184, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 256)          65792       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128)          32896       dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           8256        dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4_task_layer (Dense)      (None, 32)           2080        dense_3[0][0]                    
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            66          dense_4_task_layer[0][0]         
==================================================================================================
Total params: 758,754
Trainable params: 380,450
Non-trainable params: 378,304
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 54s - loss: 0.8104 - acc: 0.5625
 128/1000 [==>...........................] - ETA: 29s - loss: 0.7586 - acc: 0.5156
 192/1000 [====>.........................] - ETA: 20s - loss: 0.7219 - acc: 0.5573
 256/1000 [======>.......................] - ETA: 15s - loss: 0.7097 - acc: 0.5781
 320/1000 [========>.....................] - ETA: 12s - loss: 0.6869 - acc: 0.6094
 384/1000 [==========>...................] - ETA: 10s - loss: 0.6732 - acc: 0.6172
 448/1000 [============>.................] - ETA: 8s - loss: 0.6483 - acc: 0.6406 
 512/1000 [==============>...............] - ETA: 7s - loss: 0.6447 - acc: 0.6367
 576/1000 [================>.............] - ETA: 5s - loss: 0.6589 - acc: 0.6319
 640/1000 [==================>...........] - ETA: 4s - loss: 0.6481 - acc: 0.6500
 704/1000 [====================>.........] - ETA: 3s - loss: 0.6368 - acc: 0.6591
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6371 - acc: 0.6615
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6303 - acc: 0.6671
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6266 - acc: 0.6775
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6259 - acc: 0.6771
1000/1000 [==============================] - 12s 12ms/step - loss: 0.6271 - acc: 0.6770

Test accuracy: 71.52479448422169

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9976

choose_one :  8879

F1score :  0.7076822562203953

AUC :  0.7817743091305255

Confusion Matrix
[[6987 2380]
 [2989 6499]]
True label 0
0.7459165154264973  
0.2540834845735027  
True label 1
0.3150295109612142  
0.6849704890387859  

Train_result {'loss': [0.6271495108604431], 'acc': [0.6770000004768372]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5213 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 7s - loss: 0.5401 - acc: 0.7344
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5446 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 6s - loss: 0.5248 - acc: 0.7500
 320/1000 [========>.....................] - ETA: 5s - loss: 0.5282 - acc: 0.7469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.5264 - acc: 0.7448
 448/1000 [============>.................] - ETA: 4s - loss: 0.5298 - acc: 0.7455
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5333 - acc: 0.7422
 576/1000 [================>.............] - ETA: 3s - loss: 0.5357 - acc: 0.7413
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5481 - acc: 0.7312
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5480 - acc: 0.7301
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5465 - acc: 0.7305
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5447 - acc: 0.7320
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5458 - acc: 0.7310
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5446 - acc: 0.7302
1000/1000 [==============================] - 8s 8ms/step - loss: 0.5430 - acc: 0.7320

Test accuracy: 73.51365685494564

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10187

choose_one :  8668

F1score :  0.7249394139678343

AUC :  0.8075680398481915

Confusion Matrix
[[7280 2087]
 [2907 6581]]
True label 0
0.7771965410483612  
0.22280345895163872  
True label 1
0.3063870151770658  
0.6936129848229342  

Train_result {'loss': [0.5430041933059693], 'acc': [0.7319999990463257]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.6471 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 7s - loss: 0.5774 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 6s - loss: 0.5483 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 6s - loss: 0.5250 - acc: 0.7500
 320/1000 [========>.....................] - ETA: 5s - loss: 0.5355 - acc: 0.7406
 384/1000 [==========>...................] - ETA: 5s - loss: 0.5290 - acc: 0.7422
 448/1000 [============>.................] - ETA: 4s - loss: 0.5185 - acc: 0.7500
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5137 - acc: 0.7520
 576/1000 [================>.............] - ETA: 3s - loss: 0.5122 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5069 - acc: 0.7656
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5047 - acc: 0.7642
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4946 - acc: 0.7682
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4943 - acc: 0.7716
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4956 - acc: 0.7746
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4896 - acc: 0.7750
1000/1000 [==============================] - 8s 8ms/step - loss: 0.4872 - acc: 0.7770

Test accuracy: 74.68045611243703

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9499

choose_one :  9356

F1score :  0.7466567607726597

AUC :  0.8204969871085946

Confusion Matrix
[[7046 2321]
 [2453 7035]]
True label 0
0.7522152236575211  
0.24778477634247892  
True label 1
0.2585370994940978  
0.7414629005059022  

Train_result {'loss': [0.48719205236434937], 'acc': [0.7769999995231628]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.4504 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4956 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5032 - acc: 0.7708
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4758 - acc: 0.7773
 320/1000 [========>.....................] - ETA: 5s - loss: 0.4966 - acc: 0.7688
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4961 - acc: 0.7656
 448/1000 [============>.................] - ETA: 4s - loss: 0.4873 - acc: 0.7656
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4812 - acc: 0.7676
 576/1000 [================>.............] - ETA: 3s - loss: 0.4689 - acc: 0.7743
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4626 - acc: 0.7797
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4555 - acc: 0.7812
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4539 - acc: 0.7852
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4513 - acc: 0.7873
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4451 - acc: 0.7946
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4516 - acc: 0.7896
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4476 - acc: 0.7920

Test accuracy: 74.7175815433572

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  11456

choose_one :  7399

F1score :  0.7177118493515723

AUC :  0.833508933806764

Confusion Matrix
[[8028 1339]
 [3428 6060]]
True label 0
0.8570513504857479  
0.14294864951425215  
True label 1
0.36129848229342326  
0.6387015177065767  

Train_result {'loss': [0.4475873875617981], 'acc': [0.7920000009536743]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.4358 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4451 - acc: 0.7578
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4417 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4151 - acc: 0.8047
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4118 - acc: 0.8125
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4077 - acc: 0.8177
 448/1000 [============>.................] - ETA: 5s - loss: 0.3992 - acc: 0.8214
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4049 - acc: 0.8203
 576/1000 [================>.............] - ETA: 3s - loss: 0.3959 - acc: 0.8247
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3895 - acc: 0.8266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3934 - acc: 0.8224
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4077 - acc: 0.8138
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4037 - acc: 0.8137
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4147 - acc: 0.8047
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4210 - acc: 0.8000
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4216 - acc: 0.8020

Test accuracy: 75.35401750198886

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9938

choose_one :  8917

F1score :  0.7475142624286879

AUC :  0.8383203470221515

Confusion Matrix
[[7329 2038]
 [2609 6879]]
True label 0
0.7824276716131099  
0.21757232838689014  
True label 1
0.2749789207419899  
0.7250210792580101  

Train_result {'loss': [0.42160228109359743], 'acc': [0.8020000009536743]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3949 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4067 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3999 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3904 - acc: 0.8242
 320/1000 [========>.....................] - ETA: 5s - loss: 0.3968 - acc: 0.8219
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3973 - acc: 0.8203
 448/1000 [============>.................] - ETA: 4s - loss: 0.3871 - acc: 0.8192
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3838 - acc: 0.8184
 576/1000 [================>.............] - ETA: 3s - loss: 0.3809 - acc: 0.8212
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3747 - acc: 0.8250
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3756 - acc: 0.8253
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3776 - acc: 0.8242
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3792 - acc: 0.8233
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3733 - acc: 0.8237
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3697 - acc: 0.8271
1000/1000 [==============================] - 8s 8ms/step - loss: 0.3649 - acc: 0.8310

Test accuracy: 76.32458233890215

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9835

choose_one :  9020

F1score :  0.7588070023773503

AUC :  0.8426928865751837

Confusion Matrix
[[7369 1998]
 [2466 7022]]
True label 0
0.7866979822782108  
0.21330201772178925  
True label 1
0.2599072512647555  
0.7400927487352446  

Train_result {'loss': [0.3648897808790207], 'acc': [0.8310000004768372]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2509 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3087 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3158 - acc: 0.8646
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3059 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 5s - loss: 0.3094 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3077 - acc: 0.8802
 448/1000 [============>.................] - ETA: 4s - loss: 0.3372 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3345 - acc: 0.8672
 576/1000 [================>.............] - ETA: 3s - loss: 0.3228 - acc: 0.8715
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3230 - acc: 0.8703
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3119 - acc: 0.8764
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3089 - acc: 0.8763
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3060 - acc: 0.8786
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3083 - acc: 0.8750
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3239 - acc: 0.8656
1000/1000 [==============================] - 8s 8ms/step - loss: 0.3318 - acc: 0.8630

Test accuracy: 74.7228851763458

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10807

choose_one :  8048

F1score :  0.7282162408759123

AUC :  0.8393009083321646

Confusion Matrix
[[7704 1663]
 [3103 6385]]
True label 0
0.8224618340984307  
0.17753816590156934  
True label 1
0.32704468802698144  
0.6729553119730185  

Train_result {'loss': [0.33175203466415404], 'acc': [0.8630000004768371]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.3464 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2987 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3072 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2899 - acc: 0.8984
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2762 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2977 - acc: 0.8906
 448/1000 [============>.................] - ETA: 4s - loss: 0.3226 - acc: 0.8795
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3152 - acc: 0.8828
 576/1000 [================>.............] - ETA: 3s - loss: 0.3086 - acc: 0.8854
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3135 - acc: 0.8797
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3296 - acc: 0.8693
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3383 - acc: 0.8607
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3363 - acc: 0.8618
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3489 - acc: 0.8571
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3508 - acc: 0.8552
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3497 - acc: 0.8550

Test accuracy: 76.18668788119862

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10845

choose_one :  8010

F1score :  0.7433992456280719

AUC :  0.8458250984628861

Confusion Matrix
[[7861 1506]
 [2984 6504]]
True label 0
0.8392228034589516  
0.16077719654104836  
True label 1
0.3145025295109612  
0.6854974704890388  

Train_result {'loss': [0.34969832372665405], 'acc': [0.8550000009536743]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2215 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2578 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2736 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2752 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2797 - acc: 0.8844
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2762 - acc: 0.8958
 448/1000 [============>.................] - ETA: 5s - loss: 0.2863 - acc: 0.8906
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2872 - acc: 0.8887
 576/1000 [================>.............] - ETA: 3s - loss: 0.2950 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3021 - acc: 0.8766
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2976 - acc: 0.8778
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2950 - acc: 0.8815
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2929 - acc: 0.8822
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2929 - acc: 0.8817
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2877 - acc: 0.8854
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2892 - acc: 0.8840

Test accuracy: 76.91328560063644

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9458

choose_one :  9397

F1score :  0.7694996028594123

AUC :  0.8430989328994132

Confusion Matrix
[[7236 2131]
 [2222 7266]]
True label 0
0.7724991993167503  
0.2275008006832497  
True label 1
0.23419055649241147  
0.7658094435075885  

Train_result {'loss': [0.2892264325618744], 'acc': [0.8840000009536744]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1925 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2255 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 6s - loss: 0.2847 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2917 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2776 - acc: 0.8781
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2698 - acc: 0.8828
 448/1000 [============>.................] - ETA: 4s - loss: 0.2634 - acc: 0.8906
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2550 - acc: 0.8926
 576/1000 [================>.............] - ETA: 3s - loss: 0.2634 - acc: 0.8837
 640/1000 [==================>...........] - ETA: 2s - loss: 0.2682 - acc: 0.8812
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2624 - acc: 0.8849
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2636 - acc: 0.8841
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2660 - acc: 0.8834
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2626 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2659 - acc: 0.8844
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2671 - acc: 0.8840

Test accuracy: 76.72235481304693

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9412

choose_one :  9443

F1score :  0.7681580476467169

AUC :  0.8392082266580804

Confusion Matrix
[[7195 2172]
 [2217 7271]]
True label 0
0.7681221308850219  
0.23187786911497812  
True label 1
0.2336635750421585  
0.7663364249578415  

Train_result {'loss': [0.2670523314476013], 'acc': [0.884]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2575 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2658 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2429 - acc: 0.9062
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2439 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2170 - acc: 0.9187
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2211 - acc: 0.9141
 448/1000 [============>.................] - ETA: 5s - loss: 0.2129 - acc: 0.9129
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2116 - acc: 0.9141
 576/1000 [================>.............] - ETA: 3s - loss: 0.2138 - acc: 0.9149
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2202 - acc: 0.9141
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2144 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2261 - acc: 0.9154
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2257 - acc: 0.9159
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2300 - acc: 0.9129
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2369 - acc: 0.9094
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2415 - acc: 0.9080

Test accuracy: 76.53672765844604

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8707

choose_one :  10148

F1score :  0.774699531472805

AUC :  0.8379682196711177

Confusion Matrix
[[6825 2542]
 [1882 7606]]
True label 0
0.7286217572328387  
0.2713782427671613  
True label 1
0.19835581787521078  
0.8016441821247892  

Train_result {'loss': [0.24154814457893373], 'acc': [0.908]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1987 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2812 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2709 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2399 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2231 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2239 - acc: 0.9036
 448/1000 [============>.................] - ETA: 4s - loss: 0.2325 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2168 - acc: 0.9043
 576/1000 [================>.............] - ETA: 3s - loss: 0.2098 - acc: 0.9097
 640/1000 [==================>...........] - ETA: 2s - loss: 0.2200 - acc: 0.9094
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2141 - acc: 0.9134
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2178 - acc: 0.9128
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2170 - acc: 0.9135
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2207 - acc: 0.9107
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2184 - acc: 0.9125
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2220 - acc: 0.9120

Test accuracy: 76.92919649960223

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9071

choose_one :  9784

F1score :  0.7742839352428393

AUC :  0.8413746621962827

Confusion Matrix
[[7044 2323]
 [2027 7461]]
True label 0
0.752001708124266  
0.24799829187573397  
True label 1
0.2136382799325464  
0.7863617200674536  

Train_result {'loss': [0.22195416784286498], 'acc': [0.9119999990463257]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2066 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2046 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 6s - loss: 0.1929 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2102 - acc: 0.9258
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2397 - acc: 0.9156
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2487 - acc: 0.9089
 448/1000 [============>.................] - ETA: 4s - loss: 0.2342 - acc: 0.9152
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2316 - acc: 0.9160
 576/1000 [================>.............] - ETA: 3s - loss: 0.2357 - acc: 0.9132
 640/1000 [==================>...........] - ETA: 2s - loss: 0.2301 - acc: 0.9125
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2248 - acc: 0.9148
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2270 - acc: 0.9115
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2312 - acc: 0.9075
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2340 - acc: 0.9074
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2269 - acc: 0.9104
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2278 - acc: 0.9110

Test accuracy: 76.88676743569344

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10445

choose_one :  8410

F1score :  0.7565091071628115

AUC :  0.8456017600449067

Confusion Matrix
[[7727 1640]
 [2718 6770]]
True label 0
0.8249172627308636  
0.17508273726913634  
True label 1
0.2864671163575042  
0.7135328836424958  

Train_result {'loss': [0.22784462594985963], 'acc': [0.9110000004768372]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1536 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1630 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1640 - acc: 0.9062
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1781 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 5s - loss: 0.1760 - acc: 0.9125
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1782 - acc: 0.9141
 448/1000 [============>.................] - ETA: 4s - loss: 0.1660 - acc: 0.9241
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1766 - acc: 0.9160
 576/1000 [================>.............] - ETA: 3s - loss: 0.1711 - acc: 0.9219
 640/1000 [==================>...........] - ETA: 2s - loss: 0.1765 - acc: 0.9203
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1826 - acc: 0.9148
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1869 - acc: 0.9154
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1822 - acc: 0.9183
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1796 - acc: 0.9196
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1755 - acc: 0.9229
1000/1000 [==============================] - 8s 8ms/step - loss: 0.1806 - acc: 0.9220

Test accuracy: 76.63749668522938

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10092

choose_one :  8763

F1score :  0.7586433620075612

AUC :  0.8408506624922519

Confusion Matrix
[[7527 1840]
 [2565 6923]]
True label 0
0.8035657094053592  
0.19643429059464076  
True label 1
0.27034148397976393  
0.7296585160202361  

Train_result {'loss': [0.18059345483779907], 'acc': [0.9219999990463257]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1403 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1676 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1427 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2024 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1838 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2106 - acc: 0.9115
 448/1000 [============>.................] - ETA: 4s - loss: 0.1949 - acc: 0.9196
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1906 - acc: 0.9238
 576/1000 [================>.............] - ETA: 3s - loss: 0.1788 - acc: 0.9288
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1885 - acc: 0.9234
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1885 - acc: 0.9205
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1911 - acc: 0.9167
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1869 - acc: 0.9183
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1870 - acc: 0.9196
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1846 - acc: 0.9219
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1806 - acc: 0.9250

Test accuracy: 76.53672765844604

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9669

choose_one :  9186

F1score :  0.7630930705794151

AUC :  0.8375675573678971

Confusion Matrix
[[7306 2061]
 [2363 7125]]
True label 0
0.7799722429806768  
0.22002775701932314  
True label 1
0.2490514333895447  
0.7509485666104553  

Train_result {'loss': [0.1806355184316635], 'acc': [0.925]}
Saved model to disk


[[71.52479448422169, 1], [73.51365685494564, 2], [74.68045611243703, 3], [74.7175815433572, 4], [75.35401750198886, 5], [76.32458233890215, 6], [74.7228851763458, 7], [76.18668788119862, 8], [76.91328560063644, 9], [76.72235481304693, 10], [76.53672765844604, 11], [76.92919649960223, 12], [76.88676743569344, 13], [76.63749668522938, 14], [76.53672765844604, 15]]
max accuracy :  [76.92919649960223, 12]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-17 03:41:43.630965: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-17 03:41:43.639923: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-17 03:41:43.642076: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xabb9d30 executing computations on platform Host. Devices:
2019-10-17 03:41:43.642127: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:152: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9858
one :  9997

Second data
zero :  9858
one :  9997

Third data
zero :  9858
one :  9997

4th data
zero :  9858
one :  9997

hbase-code
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 32

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 856
Over 150, Under 200 : 191
Over 200, Under 400 : 0
Over 400 : 0

188
hbase-AST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-AST

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5216
Over 100, Under 150 : 729
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
hbase-CAST
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-CAST

Sentence length Average : 52

Under 10 : 2622
Over 10, Under 30 : 6971
Over 30, Under 100 : 7184
Over 100, Under 150 : 1632
Over 150, Under 200 : 757
Over 200, Under 400 : 688
Over 400 : 1

631
hbase-depth_num
After set document size of train data, the number of zero and one label data :  491 509
After set document size of test data, the number of zero and one label data :  9367 9488
After balance out data.
hbase-depth_num

Sentence length Average : 27

Under 10 : 7489
Over 10, Under 30 : 6290
Over 30, Under 100 : 5218
Over 100, Under 150 : 727
Over 150, Under 200 : 126
Over 200, Under 400 : 4
Over 400 : 1

431
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 188, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 188, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 431, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 631, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 631, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 431, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 431, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          262656      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 768)          393984      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 512)          393728      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          131328      dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 256)          33024       dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7_task_layer (Dense)      (None, 128)          32896       dense_6_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_7_task_layer[0][0]         
==================================================================================================
Total params: 3,580,802
Trainable params: 1,823,490
Non-trainable params: 1,757,312
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:19 - loss: 0.7657 - acc: 0.5625
 128/1000 [==>...........................] - ETA: 1:12 - loss: 0.6679 - acc: 0.6172
 192/1000 [====>.........................] - ETA: 49s - loss: 0.6481 - acc: 0.6667 
 256/1000 [======>.......................] - ETA: 37s - loss: 0.7110 - acc: 0.6484
 320/1000 [========>.....................] - ETA: 29s - loss: 0.7503 - acc: 0.6406
 384/1000 [==========>...................] - ETA: 24s - loss: 0.7357 - acc: 0.6328
 448/1000 [============>.................] - ETA: 20s - loss: 0.7391 - acc: 0.6228
 512/1000 [==============>...............] - ETA: 16s - loss: 0.7166 - acc: 0.6367
 576/1000 [================>.............] - ETA: 13s - loss: 0.7152 - acc: 0.6406
 640/1000 [==================>...........] - ETA: 11s - loss: 0.7073 - acc: 0.6547
 704/1000 [====================>.........] - ETA: 8s - loss: 0.7016 - acc: 0.6562 
 768/1000 [======================>.......] - ETA: 6s - loss: 0.6933 - acc: 0.6615
 832/1000 [=======================>......] - ETA: 4s - loss: 0.6885 - acc: 0.6647
 896/1000 [=========================>....] - ETA: 2s - loss: 0.6818 - acc: 0.6741
 960/1000 [===========================>..] - ETA: 1s - loss: 0.6768 - acc: 0.6771
1000/1000 [==============================] - 26s 26ms/step - loss: 0.6740 - acc: 0.6770

Test accuracy: 71.42932909042695

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  11124

choose_one :  7731

F1score :  0.6871479179975608

AUC :  0.7905323503937525

Confusion Matrix
[[7552 1815]
 [3572 5916]]
True label 0
0.8062346535710473  
0.1937653464289527  
True label 1
0.37647554806070826  
0.6235244519392917  

Train_result {'acc': [0.6770000004768372], 'loss': [0.6740260009765625]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.5629 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 15s - loss: 0.5276 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 13s - loss: 0.5566 - acc: 0.7292
 256/1000 [======>.......................] - ETA: 12s - loss: 0.5381 - acc: 0.7383
 320/1000 [========>.....................] - ETA: 11s - loss: 0.5286 - acc: 0.7469
 384/1000 [==========>...................] - ETA: 10s - loss: 0.5322 - acc: 0.7448
 448/1000 [============>.................] - ETA: 9s - loss: 0.5212 - acc: 0.7545 
 512/1000 [==============>...............] - ETA: 7s - loss: 0.5119 - acc: 0.7578
 576/1000 [================>.............] - ETA: 7s - loss: 0.5138 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5066 - acc: 0.7625
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5145 - acc: 0.7571
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5078 - acc: 0.7604
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5097 - acc: 0.7596
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5158 - acc: 0.7533
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5126 - acc: 0.7542
1000/1000 [==============================] - 16s 16ms/step - loss: 0.5075 - acc: 0.7570

Test accuracy: 74.69106337841421

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9219

choose_one :  9636

F1score :  0.7504706128425016

AUC :  0.823903373374397

Confusion Matrix
[[6907 2460]
 [2312 7176]]
True label 0
0.7373758940962956  
0.2626241059037045  
True label 1
0.2436762225969646  
0.7563237774030354  

Train_result {'acc': [0.7569999995231629], 'loss': [0.5075177330970764]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.3624 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 16s - loss: 0.4102 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 14s - loss: 0.4181 - acc: 0.8021
 256/1000 [======>.......................] - ETA: 12s - loss: 0.4243 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 11s - loss: 0.4273 - acc: 0.8031
 384/1000 [==========>...................] - ETA: 10s - loss: 0.4253 - acc: 0.7995
 448/1000 [============>.................] - ETA: 9s - loss: 0.4306 - acc: 0.7991 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.4246 - acc: 0.7988
 576/1000 [================>.............] - ETA: 7s - loss: 0.4168 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 6s - loss: 0.4157 - acc: 0.8063
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4072 - acc: 0.8111
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4121 - acc: 0.8112
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4203 - acc: 0.8053
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4216 - acc: 0.8036
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4213 - acc: 0.8042
1000/1000 [==============================] - 17s 17ms/step - loss: 0.4204 - acc: 0.8040

Test accuracy: 75.94272076372314

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9401

choose_one :  9454

F1score :  0.7605321507760532

AUC :  0.8384081003760646

Confusion Matrix
[[7116 2251]
 [2285 7203]]
True label 0
0.7596882673214477  
0.24031173267855235  
True label 1
0.24083052276559866  
0.7591694772344013  

Train_result {'acc': [0.8040000004768372], 'loss': [0.4204021210670471]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.3390 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 14s - loss: 0.3521 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 13s - loss: 0.2947 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 12s - loss: 0.3072 - acc: 0.8594
 320/1000 [========>.....................] - ETA: 11s - loss: 0.3093 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 10s - loss: 0.3167 - acc: 0.8646
 448/1000 [============>.................] - ETA: 9s - loss: 0.3419 - acc: 0.8549 
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3397 - acc: 0.8535
 576/1000 [================>.............] - ETA: 6s - loss: 0.3395 - acc: 0.8524
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3386 - acc: 0.8500
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3412 - acc: 0.8509
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3507 - acc: 0.8451
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3492 - acc: 0.8462
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3541 - acc: 0.8438
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3548 - acc: 0.8427
1000/1000 [==============================] - 16s 16ms/step - loss: 0.3541 - acc: 0.8410

Test accuracy: 76.88676743569344

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9199

choose_one :  9656

F1score :  0.7723568742164646

AUC :  0.8501664140696295

Confusion Matrix
[[7104 2263]
 [2095 7393]]
True label 0
0.7584071741219174  
0.24159282587808262  
True label 1
0.2208052276559865  
0.7791947723440135  

Train_result {'acc': [0.8410000004768372], 'loss': [0.354119366645813]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.2916 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 15s - loss: 0.2971 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 14s - loss: 0.2864 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 12s - loss: 0.2780 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 11s - loss: 0.2897 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 10s - loss: 0.3121 - acc: 0.8490
 448/1000 [============>.................] - ETA: 9s - loss: 0.3078 - acc: 0.8527 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.3006 - acc: 0.8574
 576/1000 [================>.............] - ETA: 7s - loss: 0.3022 - acc: 0.8542
 640/1000 [==================>...........] - ETA: 5s - loss: 0.2956 - acc: 0.8578
 704/1000 [====================>.........] - ETA: 4s - loss: 0.2946 - acc: 0.8565
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2911 - acc: 0.8594
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2905 - acc: 0.8630
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2855 - acc: 0.8661
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2869 - acc: 0.8677
1000/1000 [==============================] - 17s 17ms/step - loss: 0.2845 - acc: 0.8680

Test accuracy: 76.69053301511536

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9578

choose_one :  9277

F1score :  0.765787370103917

AUC :  0.8509920652244947

Confusion Matrix
[[7275 2092]
 [2303 7185]]
True label 0
0.7766627522152236  
0.22333724778477634  
True label 1
0.24272765598650928  
0.7572723440134908  

Train_result {'acc': [0.868], 'loss': [0.2844793778657913]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.2234 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 15s - loss: 0.2481 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 14s - loss: 0.2308 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 13s - loss: 0.2534 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 11s - loss: 0.2579 - acc: 0.8906
 384/1000 [==========>...................] - ETA: 10s - loss: 0.2516 - acc: 0.8984
 448/1000 [============>.................] - ETA: 9s - loss: 0.2448 - acc: 0.9018 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.2589 - acc: 0.8926
 576/1000 [================>.............] - ETA: 7s - loss: 0.2648 - acc: 0.8906
 640/1000 [==================>...........] - ETA: 5s - loss: 0.2568 - acc: 0.8953
 704/1000 [====================>.........] - ETA: 4s - loss: 0.2499 - acc: 0.8963
 768/1000 [======================>.......] - ETA: 3s - loss: 0.2529 - acc: 0.8945
 832/1000 [=======================>......] - ETA: 2s - loss: 0.2503 - acc: 0.8942
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2490 - acc: 0.8940
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2441 - acc: 0.8958
1000/1000 [==============================] - 16s 16ms/step - loss: 0.2493 - acc: 0.8950

Test accuracy: 77.52850702731371

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9606

choose_one :  9249

F1score :  0.7738698831189625

AUC :  0.850266319445882

Confusion Matrix
[[7368 1999]
 [2238 7250]]
True label 0
0.7865912245115833  
0.21340877548841677  
True label 1
0.2358768971332209  
0.7641231028667791  

Train_result {'acc': [0.895], 'loss': [0.24933353090286256]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.1229 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 15s - loss: 0.1511 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 13s - loss: 0.1933 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 12s - loss: 0.1973 - acc: 0.9336
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1851 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1798 - acc: 0.9375
 448/1000 [============>.................] - ETA: 9s - loss: 0.1848 - acc: 0.9308 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1869 - acc: 0.9297
 576/1000 [================>.............] - ETA: 7s - loss: 0.1855 - acc: 0.9271
 640/1000 [==================>...........] - ETA: 5s - loss: 0.1931 - acc: 0.9266
 704/1000 [====================>.........] - ETA: 4s - loss: 0.1872 - acc: 0.9276
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1827 - acc: 0.9297
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1846 - acc: 0.9291
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1982 - acc: 0.9230
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1988 - acc: 0.9198
1000/1000 [==============================] - 16s 16ms/step - loss: 0.2117 - acc: 0.9150

Test accuracy: 77.76717051180059

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9781

choose_one :  9074

F1score :  0.7741622669970908

AUC :  0.8555379848814441

Confusion Matrix
[[7478 1889]
 [2303 7185]]
True label 0
0.7983345788406107  
0.20166542115938935  
True label 1
0.24272765598650928  
0.7572723440134908  

Train_result {'acc': [0.9150000004768372], 'loss': [0.21171560621261595]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.1194 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 15s - loss: 0.1479 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1497 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 12s - loss: 0.1523 - acc: 0.9453
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1688 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1806 - acc: 0.9271
 448/1000 [============>.................] - ETA: 9s - loss: 0.1746 - acc: 0.9353 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1709 - acc: 0.9316
 576/1000 [================>.............] - ETA: 7s - loss: 0.1761 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1743 - acc: 0.9344
 704/1000 [====================>.........] - ETA: 4s - loss: 0.1735 - acc: 0.9361
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1731 - acc: 0.9349
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1785 - acc: 0.9303
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1750 - acc: 0.9308
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1790 - acc: 0.9281
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1814 - acc: 0.9250

Test accuracy: 77.82020684168656

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10125

choose_one :  8730

F1score :  0.7704468108464156

AUC :  0.8562717982526652

Confusion Matrix
[[7655 1712]
 [2470 7018]]
True label 0
0.8172307035336821  
0.18276929646631793  
True label 1
0.26032883642495785  
0.7396711635750421  

Train_result {'acc': [0.9250000009536743], 'loss': [0.18138226687908174]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 19s - loss: 0.2071 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 16s - loss: 0.1744 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1706 - acc: 0.9271
 256/1000 [======>.......................] - ETA: 12s - loss: 0.1623 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1575 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1509 - acc: 0.9375
 448/1000 [============>.................] - ETA: 9s - loss: 0.1474 - acc: 0.9397 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1414 - acc: 0.9434
 576/1000 [================>.............] - ETA: 7s - loss: 0.1358 - acc: 0.9462
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1366 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 4s - loss: 0.1525 - acc: 0.9432
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1504 - acc: 0.9427
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1491 - acc: 0.9399
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1453 - acc: 0.9408
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1527 - acc: 0.9375
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1483 - acc: 0.9400

Test accuracy: 77.58154335719968

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  8930

choose_one :  9925

F1score :  0.7822593107711326

AUC :  0.8538769778316506

Confusion Matrix
[[7035 2332]
 [1895 7593]]
True label 0
0.7510408882246183  
0.24895911177538166  
True label 1
0.19972596964586847  
0.8002740303541316  

Train_result {'acc': [0.94], 'loss': [0.14828215473890305]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.1439 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 15s - loss: 0.1271 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1254 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 13s - loss: 0.1247 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1189 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1156 - acc: 0.9401
 448/1000 [============>.................] - ETA: 9s - loss: 0.1132 - acc: 0.9397 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1080 - acc: 0.9453
 576/1000 [================>.............] - ETA: 7s - loss: 0.1158 - acc: 0.9427
 640/1000 [==================>...........] - ETA: 5s - loss: 0.1198 - acc: 0.9406
 704/1000 [====================>.........] - ETA: 4s - loss: 0.1204 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1168 - acc: 0.9388
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1129 - acc: 0.9411
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1096 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1084 - acc: 0.9448
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1135 - acc: 0.9420

Test accuracy: 77.57093609122249

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9104

choose_one :  9751

F1score :  0.780186080357607

AUC :  0.850494046094151

Confusion Matrix
[[7121 2246]
 [1983 7505]]
True label 0
0.7602220561545853  
0.23977794384541476  
True label 1
0.20900084317032042  
0.7909991568296796  

Train_result {'acc': [0.942], 'loss': [0.11345360052585601]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.1041 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 15s - loss: 0.1086 - acc: 0.9531
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1073 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 12s - loss: 0.1052 - acc: 0.9531
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1098 - acc: 0.9469
 384/1000 [==========>...................] - ETA: 10s - loss: 0.1241 - acc: 0.9401
 448/1000 [============>.................] - ETA: 9s - loss: 0.1175 - acc: 0.9442 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.1220 - acc: 0.9434
 576/1000 [================>.............] - ETA: 7s - loss: 0.1258 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 6s - loss: 0.1186 - acc: 0.9469
 704/1000 [====================>.........] - ETA: 4s - loss: 0.1184 - acc: 0.9474
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1181 - acc: 0.9466
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1211 - acc: 0.9447
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1180 - acc: 0.9487
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1155 - acc: 0.9500
1000/1000 [==============================] - 17s 17ms/step - loss: 0.1202 - acc: 0.9500

Test accuracy: 77.77247414478919

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9696

choose_one :  9159

F1score :  0.7752453477771223

AUC :  0.8546856724146032

Confusion Matrix
[[7436 1931]
 [2260 7228]]
True label 0
0.7938507526422547  
0.20614924735774529  
True label 1
0.2381956155143339  
0.7618043844856661  

Train_result {'acc': [0.9499999995231628], 'loss': [0.12020252346992492]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.0885 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 15s - loss: 0.0637 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 14s - loss: 0.0994 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 12s - loss: 0.0969 - acc: 0.9531
 320/1000 [========>.....................] - ETA: 11s - loss: 0.0915 - acc: 0.9531
 384/1000 [==========>...................] - ETA: 10s - loss: 0.0828 - acc: 0.9609
 448/1000 [============>.................] - ETA: 9s - loss: 0.0771 - acc: 0.9643 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.0776 - acc: 0.9648
 576/1000 [================>.............] - ETA: 6s - loss: 0.0816 - acc: 0.9618
 640/1000 [==================>...........] - ETA: 5s - loss: 0.0780 - acc: 0.9656
 704/1000 [====================>.........] - ETA: 4s - loss: 0.0786 - acc: 0.9645
 768/1000 [======================>.......] - ETA: 3s - loss: 0.0807 - acc: 0.9635
 832/1000 [=======================>......] - ETA: 2s - loss: 0.0823 - acc: 0.9627
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0796 - acc: 0.9643
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0798 - acc: 0.9646
1000/1000 [==============================] - 16s 16ms/step - loss: 0.0818 - acc: 0.9640

Test accuracy: 77.91036860249271

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9358

choose_one :  9497

F1score :  0.7806162760073743

AUC :  0.857217647535903

Confusion Matrix
[[7280 2087]
 [2078 7410]]
True label 0
0.7771965410483612  
0.22280345895163872  
True label 1
0.21901349072512646  
0.7809865092748736  

Train_result {'acc': [0.9639999995231628], 'loss': [0.08182551455497741]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 18s - loss: 0.0145 - acc: 1.0000
 128/1000 [==>...........................] - ETA: 15s - loss: 0.0892 - acc: 0.9844
 192/1000 [====>.........................] - ETA: 14s - loss: 0.1153 - acc: 0.9792
 256/1000 [======>.......................] - ETA: 12s - loss: 0.1094 - acc: 0.9766
 320/1000 [========>.....................] - ETA: 11s - loss: 0.1032 - acc: 0.9688
 384/1000 [==========>...................] - ETA: 10s - loss: 0.0920 - acc: 0.9714
 448/1000 [============>.................] - ETA: 9s - loss: 0.0880 - acc: 0.9732 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.0824 - acc: 0.9746
 576/1000 [================>.............] - ETA: 7s - loss: 0.0874 - acc: 0.9757
 640/1000 [==================>...........] - ETA: 5s - loss: 0.0943 - acc: 0.9734
 704/1000 [====================>.........] - ETA: 4s - loss: 0.0955 - acc: 0.9702
 768/1000 [======================>.......] - ETA: 3s - loss: 0.1013 - acc: 0.9701
 832/1000 [=======================>......] - ETA: 2s - loss: 0.1000 - acc: 0.9688
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0973 - acc: 0.9699
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0960 - acc: 0.9698
1000/1000 [==============================] - 16s 16ms/step - loss: 0.1010 - acc: 0.9680

Test accuracy: 77.7141341819146

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  9843

choose_one :  9012

F1score :  0.7728648648648649

AUC :  0.855302370670527

Confusion Matrix
[[7504 1863]
 [2339 7149]]
True label 0
0.8011102807729262  
0.19888971922707377  
True label 1
0.24652192242833051  
0.7534780775716695  

Train_result {'acc': [0.9680000004768372], 'loss': [0.10098410153388977]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.0554 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 14s - loss: 0.0623 - acc: 0.9688
 192/1000 [====>.........................] - ETA: 13s - loss: 0.1086 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 12s - loss: 0.0981 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 11s - loss: 0.0846 - acc: 0.9656
 384/1000 [==========>...................] - ETA: 9s - loss: 0.0857 - acc: 0.9661 
 448/1000 [============>.................] - ETA: 8s - loss: 0.0774 - acc: 0.9688
 512/1000 [==============>...............] - ETA: 7s - loss: 0.0760 - acc: 0.9688
 576/1000 [================>.............] - ETA: 6s - loss: 0.0745 - acc: 0.9705
 640/1000 [==================>...........] - ETA: 5s - loss: 0.0808 - acc: 0.9656
 704/1000 [====================>.........] - ETA: 4s - loss: 0.0749 - acc: 0.9688
 768/1000 [======================>.......] - ETA: 3s - loss: 0.0745 - acc: 0.9688
 832/1000 [=======================>......] - ETA: 2s - loss: 0.0747 - acc: 0.9700
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0759 - acc: 0.9710
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0724 - acc: 0.9729
1000/1000 [==============================] - 16s 16ms/step - loss: 0.0704 - acc: 0.9740

Test accuracy: 77.53911429329091

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  10538

choose_one :  8317

F1score :  0.7621454647570907

AUC :  0.8555009437170533

Confusion Matrix
[[7835 1532]
 [2703 6785]]
True label 0
0.836447101526636  
0.16355289847336393  
True label 1
0.2848861720067454  
0.7151138279932546  

Train_result {'acc': [0.974], 'loss': [0.0704035294353962]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 17s - loss: 0.0650 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 15s - loss: 0.0376 - acc: 0.9766
 192/1000 [====>.........................] - ETA: 13s - loss: 0.0434 - acc: 0.9740
 256/1000 [======>.......................] - ETA: 12s - loss: 0.0616 - acc: 0.9766
 320/1000 [========>.....................] - ETA: 11s - loss: 0.0599 - acc: 0.9750
 384/1000 [==========>...................] - ETA: 10s - loss: 0.0589 - acc: 0.9766
 448/1000 [============>.................] - ETA: 9s - loss: 0.0583 - acc: 0.9777 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.0665 - acc: 0.9746
 576/1000 [================>.............] - ETA: 6s - loss: 0.0691 - acc: 0.9722
 640/1000 [==================>...........] - ETA: 5s - loss: 0.0820 - acc: 0.9719
 704/1000 [====================>.........] - ETA: 4s - loss: 0.0896 - acc: 0.9688
 768/1000 [======================>.......] - ETA: 3s - loss: 0.0844 - acc: 0.9701
 832/1000 [=======================>......] - ETA: 2s - loss: 0.0835 - acc: 0.9700
 896/1000 [=========================>....] - ETA: 1s - loss: 0.0852 - acc: 0.9676
 960/1000 [===========================>..] - ETA: 0s - loss: 0.0824 - acc: 0.9688
1000/1000 [==============================] - 16s 16ms/step - loss: 0.0809 - acc: 0.9700

Test accuracy: 77.12012728719174

data size :  19855

zero :  9858

one :  9997

train_zero :  491

train_one :  509

test_zero :  9367

test_one :  9488

choose_zero :  11121

choose_one :  7734

F1score :  0.7495064452444546

AUC :  0.8563133457920066

Confusion Matrix
[[8087 1280]
 [3034 6454]]
True label 0
0.8633500587167716  
0.13664994128322835  
True label 1
0.31977234401349075  
0.6802276559865092  

Train_result {'acc': [0.97], 'loss': [0.08085895675420761]}
Saved model to disk


[[71.42932909042695, 1], [74.69106337841421, 2], [75.94272076372314, 3], [76.88676743569344, 4], [76.69053301511536, 5], [77.52850702731371, 6], [77.76717051180059, 7], [77.82020684168656, 8], [77.58154335719968, 9], [77.57093609122249, 10], [77.77247414478919, 11], [77.91036860249271, 12], [77.7141341819146, 13], [77.53911429329091, 14], [77.12012728719174, 15]]
max accuracy :  [77.91036860249271, 12]

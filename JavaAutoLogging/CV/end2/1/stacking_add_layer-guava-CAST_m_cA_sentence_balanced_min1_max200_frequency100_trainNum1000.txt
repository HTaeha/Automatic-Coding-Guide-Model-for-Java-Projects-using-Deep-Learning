Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-17 05:38:20.314889: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-17 05:38:20.320453: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-17 05:38:20.322153: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8183b90 executing computations on platform Host. Devices:
2019-10-17 05:38:20.322172: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:48: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

193
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 193, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 256)          65792       concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128)          32896       dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           8256        dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4_task_layer (Dense)      (None, 128)          8320        dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5_task_layer (Dense)      (None, 64)           8256        dense_4_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            130         dense_5_task_layer[0][0]         
==================================================================================================
Total params: 773,314
Trainable params: 395,010
Non-trainable params: 378,304
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 42s - loss: 0.6629 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 22s - loss: 0.6265 - acc: 0.6562
 192/1000 [====>.........................] - ETA: 15s - loss: 0.6222 - acc: 0.6875
 256/1000 [======>.......................] - ETA: 11s - loss: 0.6343 - acc: 0.6836
 320/1000 [========>.....................] - ETA: 8s - loss: 0.6147 - acc: 0.6750 
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5881 - acc: 0.6797
 448/1000 [============>.................] - ETA: 5s - loss: 0.5916 - acc: 0.6696
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6131 - acc: 0.6621
 576/1000 [================>.............] - ETA: 3s - loss: 0.5978 - acc: 0.6736
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5900 - acc: 0.6813
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5956 - acc: 0.6747
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5847 - acc: 0.6888
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5925 - acc: 0.6815
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5958 - acc: 0.6886
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5976 - acc: 0.6885
1000/1000 [==============================] - 7s 7ms/step - loss: 0.5991 - acc: 0.6860

Test accuracy: 70.35265025266101

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  5230

choose_one :  13372

F1score :  0.7557032115171651

AUC :  0.7992918114414668

Confusion Matrix
[[4557 4842]
 [ 673 8530]]
True label 0
0.4848388126396425  
0.5151611873603574  
True label 1
0.073128327719222  
0.926871672280778  

Train_result {'acc': [0.686], 'loss': [0.5990956802368164]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.5042 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4983 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 3s - loss: 0.5004 - acc: 0.7396
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4893 - acc: 0.7422
 320/1000 [========>.....................] - ETA: 3s - loss: 0.5171 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5213 - acc: 0.7448
 448/1000 [============>.................] - ETA: 2s - loss: 0.5119 - acc: 0.7478
 512/1000 [==============>...............] - ETA: 2s - loss: 0.5154 - acc: 0.7383
 576/1000 [================>.............] - ETA: 1s - loss: 0.5099 - acc: 0.7344
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5067 - acc: 0.7328
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5210 - acc: 0.7287
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5146 - acc: 0.7305
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5125 - acc: 0.7332
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5103 - acc: 0.7344
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5052 - acc: 0.7406
1000/1000 [==============================] - 4s 4ms/step - loss: 0.5062 - acc: 0.7410

Test accuracy: 72.86850876249865

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7972

choose_one :  10630

F1score :  0.7455251348762164

AUC :  0.8312572109940188

Confusion Matrix
[[6162 3237]
 [1810 7393]]
True label 0
0.6556016597510373  
0.34439834024896265  
True label 1
0.19667499728349452  
0.8033250027165055  

Train_result {'acc': [0.741], 'loss': [0.5061627759933471]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.5141 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 4s - loss: 0.5150 - acc: 0.7344
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4914 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4603 - acc: 0.7539
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4581 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4517 - acc: 0.7552
 448/1000 [============>.................] - ETA: 2s - loss: 0.4559 - acc: 0.7567
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4492 - acc: 0.7617
 576/1000 [================>.............] - ETA: 1s - loss: 0.4573 - acc: 0.7535
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4580 - acc: 0.7609
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4572 - acc: 0.7557
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4618 - acc: 0.7565
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4585 - acc: 0.7608
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4515 - acc: 0.7634
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4488 - acc: 0.7646
1000/1000 [==============================] - 5s 5ms/step - loss: 0.4535 - acc: 0.7580

Test accuracy: 76.0294591979357

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10154

choose_one :  8448

F1score :  0.747379751855419

AUC :  0.8508293859176195

Confusion Matrix
[[7547 1852]
 [2607 6596]]
True label 0
0.8029577614639856  
0.19704223853601446  
True label 1
0.2832771922199283  
0.7167228077800717  

Train_result {'acc': [0.7580000009536744], 'loss': [0.4534723596572876]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3466 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4202 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4217 - acc: 0.8229
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4371 - acc: 0.8047
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4316 - acc: 0.8063
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4345 - acc: 0.8021
 448/1000 [============>.................] - ETA: 2s - loss: 0.4271 - acc: 0.8103
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4350 - acc: 0.7969
 576/1000 [================>.............] - ETA: 1s - loss: 0.4225 - acc: 0.8021
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4198 - acc: 0.8016
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4103 - acc: 0.8054
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4126 - acc: 0.8060
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4068 - acc: 0.8077
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4028 - acc: 0.8092
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4099 - acc: 0.8063
1000/1000 [==============================] - 5s 5ms/step - loss: 0.4106 - acc: 0.8080

Test accuracy: 78.35179013009353

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10370

choose_one :  8232

F1score :  0.7690278176082592

AUC :  0.8684475266227654

Confusion Matrix
[[7871 1528]
 [2499 6704]]
True label 0
0.8374295137780615  
0.1625704862219385  
True label 1
0.2715418885146148  
0.7284581114853852  

Train_result {'acc': [0.8080000009536743], 'loss': [0.4106233789920807]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3479 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3657 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3771 - acc: 0.8177
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3533 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3691 - acc: 0.8281
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3539 - acc: 0.8438
 448/1000 [============>.................] - ETA: 2s - loss: 0.3679 - acc: 0.8326
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3726 - acc: 0.8359
 576/1000 [================>.............] - ETA: 1s - loss: 0.3730 - acc: 0.8420
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3640 - acc: 0.8453
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3579 - acc: 0.8480
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3503 - acc: 0.8503
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3541 - acc: 0.8462
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3585 - acc: 0.8460
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3588 - acc: 0.8458
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3565 - acc: 0.8450

Test accuracy: 79.34630684872594

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9733

choose_one :  8869

F1score :  0.7874059318282426

AUC :  0.8811910385504238

Confusion Matrix
[[7645 1754]
 [2088 7115]]
True label 0
0.8133844025960209  
0.18661559740397915  
True label 1
0.22688253830272737  
0.7731174616972726  

Train_result {'acc': [0.8449999995231628], 'loss': [0.3565479519367218]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3260 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3310 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3033 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3359 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3169 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3189 - acc: 0.8646
 448/1000 [============>.................] - ETA: 2s - loss: 0.3107 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3121 - acc: 0.8691
 576/1000 [================>.............] - ETA: 1s - loss: 0.3169 - acc: 0.8681
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3206 - acc: 0.8609
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3153 - acc: 0.8636
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3321 - acc: 0.8568
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3264 - acc: 0.8618
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3250 - acc: 0.8627
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3210 - acc: 0.8656
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3227 - acc: 0.8640

Test accuracy: 80.39995699387163

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10423

choose_one :  8179

F1score :  0.7902427798872397

AUC :  0.8906486511051683

Confusion Matrix
[[8088 1311]
 [2335 6868]]
True label 0
0.8605170762847112  
0.13948292371528886  
True label 1
0.2537216125176573  
0.7462783874823428  

Train_result {'acc': [0.8639999995231629], 'loss': [0.3226649966239929]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3348 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2857 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2537 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2709 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2578 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2477 - acc: 0.8906
 448/1000 [============>.................] - ETA: 2s - loss: 0.2747 - acc: 0.8839
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2901 - acc: 0.8770
 576/1000 [================>.............] - ETA: 1s - loss: 0.2990 - acc: 0.8715
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2912 - acc: 0.8750
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3061 - acc: 0.8693
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2975 - acc: 0.8724
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3040 - acc: 0.8690
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3063 - acc: 0.8650
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3077 - acc: 0.8646
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3045 - acc: 0.8660

Test accuracy: 80.8085152134179

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10531

choose_one :  8071

F1score :  0.7933310177144842

AUC :  0.8954177699887086

Confusion Matrix
[[8180 1219]
 [2351 6852]]
True label 0
0.8703053516331525  
0.12969464836684755  
True label 1
0.25546017602955556  
0.7445398239704444  

Train_result {'acc': [0.8659999990463256], 'loss': [0.3044814776182175]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2226 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2620 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2547 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2582 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2698 - acc: 0.8844
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2568 - acc: 0.8880
 448/1000 [============>.................] - ETA: 2s - loss: 0.2389 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2457 - acc: 0.8945
 576/1000 [================>.............] - ETA: 2s - loss: 0.2538 - acc: 0.8958
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2534 - acc: 0.8953
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2457 - acc: 0.8977
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2385 - acc: 0.9010
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2434 - acc: 0.8978
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2457 - acc: 0.8962
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2509 - acc: 0.8948
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2573 - acc: 0.8910

Test accuracy: 81.45360713901731

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10307

choose_one :  8295

F1score :  0.8028346096696766

AUC :  0.8982271551657415

Confusion Matrix
[[8128 1271]
 [2179 7024]]
True label 0
0.8647728481753378  
0.1352271518246622  
True label 1
0.23677061827664891  
0.7632293817233511  

Train_result {'acc': [0.8910000004768371], 'loss': [0.25731009435653684]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2632 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 3s - loss: 0.2515 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2552 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2431 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2282 - acc: 0.9156
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2291 - acc: 0.9193
 448/1000 [============>.................] - ETA: 2s - loss: 0.2246 - acc: 0.9196
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2225 - acc: 0.9199
 576/1000 [================>.............] - ETA: 1s - loss: 0.2155 - acc: 0.9219
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2206 - acc: 0.9203
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2277 - acc: 0.9162
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2264 - acc: 0.9154
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2384 - acc: 0.9087
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2364 - acc: 0.9096
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2371 - acc: 0.9062
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2386 - acc: 0.9060

Test accuracy: 81.88366842275025

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9837

choose_one :  8765

F1score :  0.8124443455031167

AUC :  0.90026197644812

Confusion Matrix
[[7933 1466]
 [1904 7299]]
True label 0
0.8440259602085328  
0.15597403979146718  
True label 1
0.20688905791589698  
0.793110942084103  

Train_result {'acc': [0.9059999990463257], 'loss': [0.2386195487976074]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2057 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2414 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2265 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2199 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2087 - acc: 0.9281
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2163 - acc: 0.9245
 448/1000 [============>.................] - ETA: 2s - loss: 0.2352 - acc: 0.9107
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2340 - acc: 0.9141
 576/1000 [================>.............] - ETA: 1s - loss: 0.2245 - acc: 0.9184
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2233 - acc: 0.9187
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2250 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2210 - acc: 0.9167
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2180 - acc: 0.9159
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2131 - acc: 0.9185
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2102 - acc: 0.9208
1000/1000 [==============================] - 5s 5ms/step - loss: 0.2081 - acc: 0.9220

Test accuracy: 81.61488012041715

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9515

choose_one :  9087

F1score :  0.8130125751776928

AUC :  0.8985420374296363

Confusion Matrix
[[7747 1652]
 [1768 7435]]
True label 0
0.8242366209171188  
0.17576337908288114  
True label 1
0.1921112680647615  
0.8078887319352385  

Train_result {'acc': [0.9219999995231628], 'loss': [0.20814690327644347]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1354 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1242 - acc: 0.9453
 192/1000 [====>.........................] - ETA: 4s - loss: 0.1509 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1512 - acc: 0.9453
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1791 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1888 - acc: 0.9349
 448/1000 [============>.................] - ETA: 2s - loss: 0.1793 - acc: 0.9397
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1772 - acc: 0.9395
 576/1000 [================>.............] - ETA: 1s - loss: 0.1774 - acc: 0.9375
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1682 - acc: 0.9422
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1736 - acc: 0.9403
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1722 - acc: 0.9375
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1763 - acc: 0.9351
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1841 - acc: 0.9342
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1895 - acc: 0.9313
1000/1000 [==============================] - 5s 5ms/step - loss: 0.1873 - acc: 0.9320

Test accuracy: 81.57187399204386

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9997

choose_one :  8605

F1score :  0.8075022461814914

AUC :  0.8974992160891762

Confusion Matrix
[[7984 1415]
 [2013 7190]]
True label 0
0.8494520693690818  
0.15054793063091818  
True label 1
0.21873302184070412  
0.7812669781592959  

Train_result {'acc': [0.9319999995231628], 'loss': [0.18733999073505403]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1827 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2006 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 4s - loss: 0.1790 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1920 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1816 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 3s - loss: 0.1678 - acc: 0.9427
 448/1000 [============>.................] - ETA: 2s - loss: 0.1872 - acc: 0.9375
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1849 - acc: 0.9355
 576/1000 [================>.............] - ETA: 2s - loss: 0.1835 - acc: 0.9392
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1800 - acc: 0.9406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1765 - acc: 0.9432
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1688 - acc: 0.9453
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1674 - acc: 0.9447
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1719 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1728 - acc: 0.9417
1000/1000 [==============================] - 5s 5ms/step - loss: 0.1743 - acc: 0.9410

Test accuracy: 81.32458875389743

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9473

choose_one :  9129

F1score :  0.8104953087497273

AUC :  0.8959932737717179

Confusion Matrix
[[7699 1700]
 [1774 7429]]
True label 0
0.8191296946483668  
0.18087030535163315  
True label 1
0.19276322938172336  
0.8072367706182767  

Train_result {'acc': [0.9410000004768372], 'loss': [0.17427742671966553]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1457 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 3s - loss: 0.1728 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1663 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1730 - acc: 0.9102
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2017 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1900 - acc: 0.9141
 448/1000 [============>.................] - ETA: 2s - loss: 0.1762 - acc: 0.9219
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1694 - acc: 0.9258
 576/1000 [================>.............] - ETA: 1s - loss: 0.1630 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1611 - acc: 0.9313
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1502 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1452 - acc: 0.9401
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1407 - acc: 0.9411
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1371 - acc: 0.9431
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1443 - acc: 0.9448
1000/1000 [==============================] - 5s 5ms/step - loss: 0.1451 - acc: 0.9440

Test accuracy: 82.48037845392969

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9824

choose_one :  8778

F1score :  0.8187531283020967

AUC :  0.9060413266988517

Confusion Matrix
[[7982 1417]
 [1842 7361]]
True label 0
0.8492392807745505  
0.1507607192254495  
True label 1
0.2001521243072911  
0.7998478756927089  

Train_result {'acc': [0.9440000004768372], 'loss': [0.14511851799488068]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2344 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1373 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1297 - acc: 0.9531
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1160 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1116 - acc: 0.9563
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1191 - acc: 0.9557
 448/1000 [============>.................] - ETA: 2s - loss: 0.1228 - acc: 0.9531
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1682 - acc: 0.9434
 576/1000 [================>.............] - ETA: 1s - loss: 0.1685 - acc: 0.9444
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1630 - acc: 0.9453
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1577 - acc: 0.9460
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1636 - acc: 0.9440
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1583 - acc: 0.9459
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1598 - acc: 0.9464
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1596 - acc: 0.9458
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1601 - acc: 0.9450

Test accuracy: 82.03956563810343

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10350

choose_one :  8252

F1score :  0.8085935262102549

AUC :  0.9029059839849934

Confusion Matrix
[[8204 1195]
 [2146 7057]]
True label 0
0.8728588147675285  
0.12714118523247153  
True label 1
0.23318483103335869  
0.7668151689666413  

Train_result {'acc': [0.9450000004768372], 'loss': [0.1601429269313812]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1237 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1092 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1012 - acc: 0.9688
 256/1000 [======>.......................] - ETA: 3s - loss: 0.0896 - acc: 0.9766
 320/1000 [========>.....................] - ETA: 3s - loss: 0.0989 - acc: 0.9719
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1110 - acc: 0.9688
 448/1000 [============>.................] - ETA: 2s - loss: 0.1195 - acc: 0.9621
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1287 - acc: 0.9590
 576/1000 [================>.............] - ETA: 1s - loss: 0.1222 - acc: 0.9601
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1179 - acc: 0.9625
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1238 - acc: 0.9602
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1234 - acc: 0.9596
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1207 - acc: 0.9615
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1172 - acc: 0.9632
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1198 - acc: 0.9604
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1241 - acc: 0.9590

Test accuracy: 82.42662079346307

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9792

choose_one :  8810

F1score :  0.8185199578082496

AUC :  0.9042262883117593

Confusion Matrix
[[7961 1438]
 [1831 7372]]
True label 0
0.8470050005319715  
0.15299499946802853  
True label 1
0.19895686189286102  
0.801043138107139  

Train_result {'acc': [0.9590000004768372], 'loss': [0.12414319658279419]}
Saved model to disk


[[70.35265025266101, 1], [72.86850876249865, 2], [76.0294591979357, 3], [78.35179013009353, 4], [79.34630684872594, 5], [80.39995699387163, 6], [80.8085152134179, 7], [81.45360713901731, 8], [81.88366842275025, 9], [81.61488012041715, 10], [81.57187399204386, 11], [81.32458875389743, 12], [82.48037845392969, 13], [82.03956563810343, 14], [82.42662079346307, 15]]
max accuracy :  [82.48037845392969, 13]

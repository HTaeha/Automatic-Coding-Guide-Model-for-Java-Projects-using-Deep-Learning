Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-10-17 05:27:29.772143: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-17 05:27:29.779795: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-17 05:27:29.781781: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa7044b0 executing computations on platform Host. Devices:
2019-10-17 05:27:29.781822: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
/home/2014313303/taeha/JavaAutoLogging/model.py:152: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
/usr/local/lib/python3.5/dist-packages/keras/engine/training.py:479: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?
  'Discrepancy between trainable weights and collected trainable'
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
First data
zero :  10792
one :  10820

Second data
zero :  10792
one :  10820

Third data
zero :  10792
one :  10820

4th data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

179
glassfish-AST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-AST

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 821
Over 150, Under 200 : 164
Over 200, Under 400 : 4
Over 400 : 0

253
glassfish-CAST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-CAST

Sentence length Average : 50

Under 10 : 4320
Over 10, Under 30 : 6874
Over 30, Under 100 : 7059
Over 100, Under 150 : 1787
Over 150, Under 200 : 894
Over 200, Under 400 : 678
Over 400 : 0

342
glassfish-depth_num
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-depth_num

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 822
Over 150, Under 200 : 163
Over 200, Under 400 : 4
Over 400 : 0

253
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 179, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 179, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 253, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 342, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 342, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 253, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          262656      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 768)          393984      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 512)          393728      dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          131328      dense_3[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          32896       dense_4[0][0]                    
__________________________________________________________________________________________________
dense_6_task_layer (Dense)      (None, 256)          33024       dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7_task_layer (Dense)      (None, 128)          32896       dense_6_task_layer[0][0]         
__________________________________________________________________________________________________
output_task_layer (Dense)       (None, 2)            258         dense_7_task_layer[0][0]         
==================================================================================================
Total params: 3,580,802
Trainable params: 1,823,490
Non-trainable params: 1,757,312
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:00 - loss: 0.8782 - acc: 0.5156
 128/1000 [==>...........................] - ETA: 1:01 - loss: 0.8053 - acc: 0.5078
 192/1000 [====>.........................] - ETA: 40s - loss: 0.7620 - acc: 0.5365 
 256/1000 [======>.......................] - ETA: 30s - loss: 0.7376 - acc: 0.5586
 320/1000 [========>.....................] - ETA: 23s - loss: 0.7746 - acc: 0.5281
 384/1000 [==========>...................] - ETA: 18s - loss: 0.7774 - acc: 0.5078
 448/1000 [============>.................] - ETA: 15s - loss: 0.7779 - acc: 0.5000
 512/1000 [==============>...............] - ETA: 12s - loss: 0.7663 - acc: 0.4980
 576/1000 [================>.............] - ETA: 10s - loss: 0.7588 - acc: 0.5017
 640/1000 [==================>...........] - ETA: 8s - loss: 0.7529 - acc: 0.5000 
 704/1000 [====================>.........] - ETA: 6s - loss: 0.7487 - acc: 0.4901
 768/1000 [======================>.......] - ETA: 4s - loss: 0.7441 - acc: 0.4870
 832/1000 [=======================>......] - ETA: 3s - loss: 0.7409 - acc: 0.4868
 896/1000 [=========================>....] - ETA: 2s - loss: 0.7377 - acc: 0.4833
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7347 - acc: 0.4875
1000/1000 [==============================] - 19s 19ms/step - loss: 0.7329 - acc: 0.4910

Test accuracy: 49.15583155443431

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  3092

choose_one :  17520

F1score :  0.6236172963654647

AUC :  0.538483810767524

Confusion Matrix
[[1450 8838]
 [1642 8682]]
True label 0
0.14094090202177295  
0.8590590979782271  
True label 1
0.1590468810538551  
0.8409531189461449  

Train_result {'acc': [0.49099999952316287], 'loss': [0.7329479212760925]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.6860 - acc: 0.4219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.6906 - acc: 0.4297 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6929 - acc: 0.4427
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6945 - acc: 0.4609
 320/1000 [========>.....................] - ETA: 7s - loss: 0.6957 - acc: 0.4562
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6966 - acc: 0.4583
 448/1000 [============>.................] - ETA: 5s - loss: 0.6977 - acc: 0.4643
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6969 - acc: 0.4727
 576/1000 [================>.............] - ETA: 4s - loss: 0.6956 - acc: 0.4983
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6946 - acc: 0.4953
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6953 - acc: 0.4943
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6946 - acc: 0.4935
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6928 - acc: 0.4964
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6919 - acc: 0.4911
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6911 - acc: 0.4958
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6906 - acc: 0.4980

Test accuracy: 50.315350281389485

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  911

choose_one :  19701

F1score :  0.658917568692756

AUC :  0.5825798464885457

Confusion Matrix
[[ 479 9809]
 [ 432 9892]]
True label 0
0.04655909797822706  
0.9534409020217729  
True label 1
0.04184424641611778  
0.9581557535838822  

Train_result {'acc': [0.4980000004768372], 'loss': [0.6906113114356994]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.6840 - acc: 0.4531
 128/1000 [==>...........................] - ETA: 9s - loss: 0.6880 - acc: 0.4531 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6874 - acc: 0.4688
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6789 - acc: 0.5000
 320/1000 [========>.....................] - ETA: 7s - loss: 0.6765 - acc: 0.5437
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6762 - acc: 0.5573
 448/1000 [============>.................] - ETA: 5s - loss: 0.6779 - acc: 0.5558
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6776 - acc: 0.5586
 576/1000 [================>.............] - ETA: 4s - loss: 0.6760 - acc: 0.5642
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6765 - acc: 0.5563
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6731 - acc: 0.5597
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6735 - acc: 0.5612
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6680 - acc: 0.5673
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6750 - acc: 0.5681
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6790 - acc: 0.5667
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6827 - acc: 0.5670

Test accuracy: 62.64797205511352

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11075

choose_one :  9537

F1score :  0.612355873319571

AUC :  0.6616798608069016

Confusion Matrix
[[6832 3456]
 [4243 6081]]
True label 0
0.6640746500777605  
0.3359253499222395  
True label 1
0.4109841146842309  
0.5890158853157691  

Train_result {'acc': [0.5669999995231628], 'loss': [0.6827066297531128]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.6076 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 8s - loss: 0.6093 - acc: 0.6797 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6162 - acc: 0.6615
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6210 - acc: 0.6484
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6236 - acc: 0.6531
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6324 - acc: 0.6354
 448/1000 [============>.................] - ETA: 5s - loss: 0.6302 - acc: 0.6384
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6291 - acc: 0.6445
 576/1000 [================>.............] - ETA: 4s - loss: 0.6290 - acc: 0.6493
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6279 - acc: 0.6578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6239 - acc: 0.6605
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6144 - acc: 0.6732
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6106 - acc: 0.6767
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6046 - acc: 0.6842
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6004 - acc: 0.6823
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6010 - acc: 0.6830

Test accuracy: 65.47642150203765

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  8986

choose_one :  11626

F1score :  0.6758086560364465

AUC :  0.7407687795292552

Confusion Matrix
[[6079 4209]
 [2907 7417]]
True label 0
0.5908825816485226  
0.40911741835147747  
True label 1
0.28157690817512593  
0.7184230918248741  

Train_result {'acc': [0.6829999995231628], 'loss': [0.6010397119522095]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.5447 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 9s - loss: 0.5655 - acc: 0.6875 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.5699 - acc: 0.7083
 256/1000 [======>.......................] - ETA: 7s - loss: 0.5420 - acc: 0.7344
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5340 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 6s - loss: 0.5305 - acc: 0.7474
 448/1000 [============>.................] - ETA: 5s - loss: 0.5225 - acc: 0.7522
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5313 - acc: 0.7500
 576/1000 [================>.............] - ETA: 4s - loss: 0.5346 - acc: 0.7517
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5304 - acc: 0.7516
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5375 - acc: 0.7386
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5332 - acc: 0.7435
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5316 - acc: 0.7452
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5306 - acc: 0.7422
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5357 - acc: 0.7365
1000/1000 [==============================] - 10s 10ms/step - loss: 0.5344 - acc: 0.7390

Test accuracy: 68.74636134290705

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  8972

choose_one :  11640

F1score :  0.7067018757967582

AUC :  0.7870344161756295

Confusion Matrix
[[6409 3879]
 [2563 7761]]
True label 0
0.6229587869362364  
0.3770412130637636  
True label 1
0.24825648973266176  
0.7517435102673382  

Train_result {'acc': [0.7390000004768371], 'loss': [0.5343726778030395]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4390 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4601 - acc: 0.7969 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4988 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 7s - loss: 0.5067 - acc: 0.7617
 320/1000 [========>.....................] - ETA: 6s - loss: 0.5062 - acc: 0.7594
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4915 - acc: 0.7630
 448/1000 [============>.................] - ETA: 5s - loss: 0.5002 - acc: 0.7656
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4877 - acc: 0.7676
 576/1000 [================>.............] - ETA: 4s - loss: 0.4777 - acc: 0.7708
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4677 - acc: 0.7734
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4598 - acc: 0.7756
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4572 - acc: 0.7760
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4482 - acc: 0.7812
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4448 - acc: 0.7835
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4456 - acc: 0.7812
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4482 - acc: 0.7860

Test accuracy: 73.0399767125946

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11645

choose_one :  8967

F1score :  0.7119382095277591

AUC :  0.8232267486395679

Confusion Matrix
[[8188 2100]
 [3457 6867]]
True label 0
0.7958786936236392  
0.2041213063763608  
True label 1
0.33485083301046104  
0.665149166989539  

Train_result {'acc': [0.7859999990463257], 'loss': [0.44818421840667727]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.5292 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4059 - acc: 0.8438 
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3879 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3911 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3807 - acc: 0.8406
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3744 - acc: 0.8411
 448/1000 [============>.................] - ETA: 5s - loss: 0.3792 - acc: 0.8348
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3781 - acc: 0.8340
 576/1000 [================>.............] - ETA: 4s - loss: 0.3712 - acc: 0.8403
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3645 - acc: 0.8453
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3622 - acc: 0.8452
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3642 - acc: 0.8464
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3577 - acc: 0.8474
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3553 - acc: 0.8471
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3581 - acc: 0.8427
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3717 - acc: 0.8350

Test accuracy: 73.4960217349117

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9649

choose_one :  10963

F1score :  0.7433644947620615

AUC :  0.8281963705265118

Confusion Matrix
[[7237 3051]
 [2412 7912]]
True label 0
0.7034409020217729  
0.29655909797822705  
True label 1
0.2336303758233243  
0.7663696241766758  

Train_result {'acc': [0.8349999990463257], 'loss': [0.3716623468399048]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4354 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3483 - acc: 0.8281 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.3110 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3020 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2887 - acc: 0.8500
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2886 - acc: 0.8542
 448/1000 [============>.................] - ETA: 5s - loss: 0.3102 - acc: 0.8460
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3208 - acc: 0.8379
 576/1000 [================>.............] - ETA: 4s - loss: 0.3092 - acc: 0.8472
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3110 - acc: 0.8500
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3065 - acc: 0.8537
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3037 - acc: 0.8555
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3038 - acc: 0.8558
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3059 - acc: 0.8538
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3062 - acc: 0.8521
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3060 - acc: 0.8530

Test accuracy: 73.79681738792937

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9933

choose_one :  10679

F1score :  0.742846260058087

AUC :  0.8283050292227023

Confusion Matrix
[[7410 2878]
 [2523 7801]]
True label 0
0.7202566096423018  
0.2797433903576983  
True label 1
0.2443820224719101  
0.7556179775280899  

Train_result {'acc': [0.853], 'loss': [0.30595285034179687]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4253 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3009 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2876 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3011 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2781 - acc: 0.8688
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2776 - acc: 0.8646
 448/1000 [============>.................] - ETA: 5s - loss: 0.2729 - acc: 0.8705
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2577 - acc: 0.8789
 576/1000 [================>.............] - ETA: 4s - loss: 0.2641 - acc: 0.8785
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2542 - acc: 0.8812
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2615 - acc: 0.8764
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2621 - acc: 0.8750
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2606 - acc: 0.8750
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2623 - acc: 0.8761
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2614 - acc: 0.8781
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2604 - acc: 0.8780

Test accuracy: 74.00543372792548

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9392

choose_one :  11220

F1score :  0.7512996658002229

AUC :  0.8333726002254783

Confusion Matrix
[[7161 3127]
 [2231 8093]]
True label 0
0.6960536547433903  
0.30394634525660963  
True label 1
0.2160984114684231  
0.7839015885315769  

Train_result {'acc': [0.878], 'loss': [0.2604341782331467]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2709 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2025 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2399 - acc: 0.9062
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2468 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2494 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2412 - acc: 0.8984
 448/1000 [============>.................] - ETA: 5s - loss: 0.2341 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2333 - acc: 0.8984
 576/1000 [================>.............] - ETA: 4s - loss: 0.2417 - acc: 0.8906
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2423 - acc: 0.8906
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2405 - acc: 0.8920
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2468 - acc: 0.8893
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2405 - acc: 0.8906
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2383 - acc: 0.8895
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2417 - acc: 0.8885
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2446 - acc: 0.8870

Test accuracy: 74.91267222976906

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10297

choose_one :  10315

F1score :  0.7494549154513299

AUC :  0.8346623961787389

Confusion Matrix
[[7707 2581]
 [2590 7734]]
True label 0
0.7491251944012441  
0.25087480559875586  
True label 1
0.2508717551336691  
0.7491282448663309  

Train_result {'acc': [0.8870000009536743], 'loss': [0.24457369422912598]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2171 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2270 - acc: 0.8906 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2035 - acc: 0.9010
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2256 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2283 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2396 - acc: 0.8880
 448/1000 [============>.................] - ETA: 5s - loss: 0.2367 - acc: 0.8929
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2255 - acc: 0.8984
 576/1000 [================>.............] - ETA: 4s - loss: 0.2234 - acc: 0.9010
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2159 - acc: 0.9016
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2171 - acc: 0.9020
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2189 - acc: 0.9023
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2213 - acc: 0.9026
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2291 - acc: 0.8996
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2235 - acc: 0.9031
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2226 - acc: 0.9030

Test accuracy: 74.8059382883757

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10097

choose_one :  10515

F1score :  0.7508037813714671

AUC :  0.8372378501858599

Confusion Matrix
[[7596 2692]
 [2501 7823]]
True label 0
0.7383359253499222  
0.26166407465007774  
True label 1
0.2422510654784967  
0.7577489345215033  

Train_result {'acc': [0.9029999990463257], 'loss': [0.22262785136699675]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2137 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1764 - acc: 0.9375 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1809 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1845 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1834 - acc: 0.9156
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1865 - acc: 0.9115
 448/1000 [============>.................] - ETA: 5s - loss: 0.1863 - acc: 0.9085
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1774 - acc: 0.9102
 576/1000 [================>.............] - ETA: 4s - loss: 0.1743 - acc: 0.9132
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1683 - acc: 0.9156
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1676 - acc: 0.9162
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1732 - acc: 0.9167
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1799 - acc: 0.9159
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1765 - acc: 0.9174
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1758 - acc: 0.9198
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1720 - acc: 0.9230

Test accuracy: 76.41665049485736

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10233

choose_one :  10379

F1score :  0.7652031106602908

AUC :  0.8418850831052138

Confusion Matrix
[[7830 2458]
 [2403 7921]]
True label 0
0.7610808709175739  
0.23891912908242613  
True label 1
0.23275862068965517  
0.7672413793103449  

Train_result {'acc': [0.923], 'loss': [0.17196187686920167]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1602 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1410 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1564 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1475 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1476 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1367 - acc: 0.9427
 448/1000 [============>.................] - ETA: 5s - loss: 0.1426 - acc: 0.9397
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1568 - acc: 0.9297
 576/1000 [================>.............] - ETA: 4s - loss: 0.1533 - acc: 0.9340
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1516 - acc: 0.9328
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1453 - acc: 0.9347
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1434 - acc: 0.9336
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1427 - acc: 0.9339
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1417 - acc: 0.9342
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1370 - acc: 0.9365
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1407 - acc: 0.9340

Test accuracy: 76.72714923345623

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11661

choose_one :  8951

F1score :  0.7511284046692607

AUC :  0.8451290361795705

Confusion Matrix
[[8576 1712]
 [3085 7239]]
True label 0
0.833592534992224  
0.16640746500777606  
True label 1
0.29881828748547073  
0.7011817125145292  

Train_result {'acc': [0.934], 'loss': [0.14072703182697296]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2015 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2119 - acc: 0.9141 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1710 - acc: 0.9219
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1563 - acc: 0.9336
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1530 - acc: 0.9344
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1595 - acc: 0.9349
 448/1000 [============>.................] - ETA: 5s - loss: 0.1545 - acc: 0.9397
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1559 - acc: 0.9336
 576/1000 [================>.............] - ETA: 4s - loss: 0.1494 - acc: 0.9358
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1456 - acc: 0.9391
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1458 - acc: 0.9389
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1385 - acc: 0.9414
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1436 - acc: 0.9399
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1450 - acc: 0.9386
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1442 - acc: 0.9365
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1478 - acc: 0.9340

Test accuracy: 76.57675140694741

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10846

choose_one :  9766

F1score :  0.7596814335490294

AUC :  0.8407711596452241

Confusion Matrix
[[8153 2135]
 [2693 7631]]
True label 0
0.7924766718506998  
0.20752332814930016  
True label 1
0.2608485083301046  
0.7391514916698954  

Train_result {'acc': [0.934], 'loss': [0.14776213908195496]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1510 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1494 - acc: 0.9219 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1274 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1372 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1368 - acc: 0.9281
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1348 - acc: 0.9297
 448/1000 [============>.................] - ETA: 5s - loss: 0.1266 - acc: 0.9330
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1267 - acc: 0.9336
 576/1000 [================>.............] - ETA: 4s - loss: 0.1339 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1281 - acc: 0.9359
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1274 - acc: 0.9361
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1276 - acc: 0.9336
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1281 - acc: 0.9339
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1316 - acc: 0.9319
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1393 - acc: 0.9313
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1373 - acc: 0.9310

Test accuracy: 74.63613429070445

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9148

choose_one :  11464

F1score :  0.7600514044428125

AUC :  0.8415377349310037

Confusion Matrix
[[7104 3184]
 [2044 8280]]
True label 0
0.6905132192846034  
0.3094867807153966  
True label 1
0.19798527702440916  
0.8020147229755908  

Train_result {'acc': [0.9310000004768372], 'loss': [0.1372528105378151]}
Saved model to disk


[[49.15583155443431, 1], [50.315350281389485, 2], [62.64797205511352, 3], [65.47642150203765, 4], [68.74636134290705, 5], [73.0399767125946, 6], [73.4960217349117, 7], [73.79681738792937, 8], [74.00543372792548, 9], [74.91267222976906, 10], [74.8059382883757, 11], [76.41665049485736, 12], [76.72714923345623, 13], [76.57675140694741, 14], [74.63613429070445, 15]]
max accuracy :  [76.72714923345623, 13]

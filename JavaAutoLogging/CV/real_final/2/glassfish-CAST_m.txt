Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 22:26:18.654705: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 22:26:18.665343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 22:26:18.667843: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xde4d520 executing computations on platform Host. Devices:
2019-08-02 22:26:18.667882: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
31687
one : 
7755

Second data
zero : 
31687
one : 
7755

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15231
Over 200, Under 400 : 607
Over 400 : 0


glassfish-code

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 14743
Over 200, Under 400 : 1095
Over 400 : 0


Test_zero:  1187
Train_zero:  10631
zero:  11818
Test_one:  575
Train_one:  5207
one:  5782
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 423s - loss: 0.5395 - acc: 0.7423

Test accuracy: 78.97480451781061

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  748

choose_one :  403

F1score :  0.7525562372188139

AUC : 0.8990111714975846

Confusion Matrix
[[541  35]
 [207 368]]
True label 0
0.9392361111111112  
0.06076388888888889  
True label 1
0.36  
0.64  

Train_result {'loss': [0.5395010506683282], 'acc': [0.7422947671799149]}
2

Epoch 1/1
 - 420s - loss: 0.4102 - acc: 0.8224

Test accuracy: 83.23197219808863

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  549

choose_one :  602

F1score :  0.8360237892948174

AUC : 0.9208137077294687

Confusion Matrix
[[466 110]
 [ 83 492]]
True label 0
0.8090277777777778  
0.1909722222222222  
True label 1
0.1443478260869565  
0.8556521739130435  

Train_result {'loss': [0.41020685969438336], 'acc': [0.8223715794813272]}
3

Epoch 1/1
 - 429s - loss: 0.3583 - acc: 0.8472

Test accuracy: 85.14335360556038

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  617

choose_one :  534

F1score :  0.8458070333633905

AUC : 0.9291198671497585

Confusion Matrix
[[511  65]
 [106 469]]
True label 0
0.8871527777777778  
0.11284722222222222  
True label 1
0.18434782608695652  
0.8156521739130435  

Train_result {'loss': [0.358317742756766], 'acc': [0.8472395583293327]}
4

Epoch 1/1
 - 428s - loss: 0.3171 - acc: 0.8704

Test accuracy: 86.53344917463076

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  591

choose_one :  560

F1score :  0.8634361233480177

AUC : 0.9386458333333333

Confusion Matrix
[[506  70]
 [ 85 490]]
True label 0
0.8784722222222222  
0.12152777777777778  
True label 1
0.14782608695652175  
0.8521739130434782  

Train_result {'loss': [0.31706886317972605], 'acc': [0.8703792606817091]}
5

Epoch 1/1
 - 428s - loss: 0.2821 - acc: 0.8864

Test accuracy: 85.31711555169417

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  537

choose_one :  614

F1score :  0.8578637510513035

AUC : 0.9403457125603865

Confusion Matrix
[[472 104]
 [ 65 510]]
True label 0
0.8194444444444444  
0.18055555555555555  
True label 1
0.11304347826086956  
0.8869565217391304  

Train_result {'loss': [0.28206690328658], 'acc': [0.8864138262179169]}
6

Epoch 1/1
 - 428s - loss: 0.2557 - acc: 0.8970

Test accuracy: 87.66290182450044

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  592

choose_one :  559

F1score :  0.8747795414462082

AUC : 0.947878925120773

Confusion Matrix
[[513  63]
 [ 79 496]]
True label 0
0.890625  
0.109375  
True label 1
0.1373913043478261  
0.8626086956521739  

Train_result {'loss': [0.2556653888850503], 'acc': [0.8969755160882962]}
7

Epoch 1/1
 - 427s - loss: 0.2278 - acc: 0.9112

Test accuracy: 86.53344917463076

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  643

choose_one :  508

F1score :  0.8568790397045245

AUC : 0.9449984903381642

Confusion Matrix
[[532  44]
 [111 464]]
True label 0
0.9236111111111112  
0.0763888888888889  
True label 1
0.19304347826086957  
0.8069565217391305  

Train_result {'loss': [0.22780380229851516], 'acc': [0.9111857897435252]}
8

Epoch 1/1
 - 429s - loss: 0.1960 - acc: 0.9257

Test accuracy: 87.48913987836664

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  596

choose_one :  555

F1score :  0.8725663716814159

AUC : 0.9506567028985509

Confusion Matrix
[[514  62]
 [ 82 493]]
True label 0
0.8923611111111112  
0.1076388888888889  
True label 1
0.1426086956521739  
0.8573913043478261  

Train_result {'loss': [0.19603972175514903], 'acc': [0.9256841094575132]}
9

Epoch 1/1
 - 428s - loss: 0.1780 - acc: 0.9340

Test accuracy: 88.44483058210251

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  537

choose_one :  614

F1score :  0.8881412952060554

AUC : 0.9501071859903382

Confusion Matrix
[[490  86]
 [ 47 528]]
True label 0
0.8506944444444444  
0.14930555555555555  
True label 1
0.0817391304347826  
0.9182608695652174  

Train_result {'loss': [0.17800836924086152], 'acc': [0.9340374459913586]}
10

Epoch 1/1
 - 427s - loss: 0.1489 - acc: 0.9446

Test accuracy: 89.1398783666377

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  537

choose_one :  614

F1score :  0.894869638351556

AUC : 0.9562182971014492

Confusion Matrix
[[494  82]
 [ 43 532]]
True label 0
0.8576388888888888  
0.1423611111111111  
True label 1
0.07478260869565218  
0.9252173913043479  

Train_result {'loss': [0.14890505753411049], 'acc': [0.9445991358617378]}
11

Epoch 1/1
 - 428s - loss: 0.1366 - acc: 0.9491

Test accuracy: 88.61859252823632

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  533

choose_one :  618

F1score :  0.8901927912824812

AUC : 0.9539839975845411

Confusion Matrix
[[489  87]
 [ 44 531]]
True label 0
0.8489583333333334  
0.15104166666666666  
True label 1
0.07652173913043478  
0.9234782608695652  

Train_result {'loss': [0.13662909637319315], 'acc': [0.9491118579258784]}
12

Epoch 1/1
 - 428s - loss: 0.1167 - acc: 0.9579

Test accuracy: 87.31537793223283

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  538

choose_one :  613

F1score :  0.877104377104377

AUC : 0.9508288043478261

Confusion Matrix
[[484  92]
 [ 54 521]]
True label 0
0.8402777777777778  
0.1597222222222222  
True label 1
0.09391304347826086  
0.9060869565217391  

Train_result {'loss': [0.11665452958026072], 'acc': [0.9579452712433989]}
13

Epoch 1/1
 - 427s - loss: 0.1004 - acc: 0.9646

Test accuracy: 87.22849695916595

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  553

choose_one :  598

F1score :  0.8746803069053708

AUC : 0.9414628623188406

Confusion Matrix
[[491  85]
 [ 62 513]]
True label 0
0.8524305555555556  
0.14756944444444445  
True label 1
0.10782608695652174  
0.8921739130434783  

Train_result {'loss': [0.10039802015469773], 'acc': [0.9645703312530005]}
14

Epoch 1/1
 - 429s - loss: 0.0820 - acc: 0.9736

Test accuracy: 88.01042571676803

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  588

choose_one :  563

F1score :  0.8787346221441125

AUC : 0.9441515700483091

Confusion Matrix
[[513  63]
 [ 75 500]]
True label 0
0.890625  
0.109375  
True label 1
0.13043478260869565  
0.8695652173913043  

Train_result {'loss': [0.08204051534494584], 'acc': [0.9735957753240518]}
15

Epoch 1/1
 - 428s - loss: 0.0722 - acc: 0.9747

Test accuracy: 87.83666377063423

data size :  11566

zero :  5784

one :  5782

train_zero :  5208

train_one :  5207

test_zero :  576

test_one :  575

choose_zero :  590

choose_one :  561

F1score :  0.8767605633802817

AUC : 0.944849033816425

Confusion Matrix
[[513  63]
 [ 77 498]]
True label 0
0.890625  
0.109375  
True label 1
0.13391304347826086  
0.8660869565217392  

Train_result {'loss': [0.07224198230151024], 'acc': [0.9747479596849937]}
Saved model to disk




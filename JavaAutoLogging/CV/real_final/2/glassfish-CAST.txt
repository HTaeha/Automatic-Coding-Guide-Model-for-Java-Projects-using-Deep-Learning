Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 10:09:46.061482: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 10:09:46.071894: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 10:09:46.074119: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6405a30 executing computations on platform Host. Devices:
2019-08-02 10:09:46.074163: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST
all data

Sentence length Average : 71

Under 10 : 9739
Over 10, Under 200 : 26001
Over 200, Under 400 : 2683
Over 400 : 1019

glassfish-CAST
updated_train_data

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 23118
Over 200, Under 400 : 3148
Over 400 : 0


Test_zero:  2280
Train_zero:  20351
zero:  22631
Test_one:  650
Train_one:  5915
one:  6565

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 269s - loss: 0.4560 - acc: 0.7897

Test accuracy: 85.85703305149885

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  607

choose_one :  694

F1score :  0.8630952380952381

AUC : 0.9292189530899209

Confusion Matrix
[[537 114]
 [ 70 580]]
True label 0
0.8248847926267281  
0.17511520737327188  
True label 1
0.1076923076923077  
0.8923076923076924  

Train_result {'acc': [0.7897050122206718], 'loss': [0.45600658727713905]}
2

Epoch 1/1
 - 267s - loss: 0.3368 - acc: 0.8640

Test accuracy: 88.16295157571099

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  635

choose_one :  666

F1score :  0.8829787234042553

AUC : 0.9492733073378234

Confusion Matrix
[[566  85]
 [ 69 581]]
True label 0
0.869431643625192  
0.130568356374808  
True label 1
0.10615384615384615  
0.8938461538461538  

Train_result {'acc': [0.8640013523440764], 'loss': [0.3367798079068759]}
3

Epoch 1/1
 - 272s - loss: 0.2857 - acc: 0.8845

Test accuracy: 88.85472713297463

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  690

choose_one :  611

F1score :  0.8850118953211737

AUC : 0.952863050927567

Confusion Matrix
[[598  53]
 [ 92 558]]
True label 0
0.9185867895545314  
0.08141321044546851  
True label 1
0.14153846153846153  
0.8584615384615385  

Train_result {'acc': [0.8844560898778082], 'loss': [0.2856713628065615]}
4

Epoch 1/1
 - 280s - loss: 0.2570 - acc: 0.8992

Test accuracy: 88.08608762490393

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  658

choose_one :  643

F1score :  0.880123743232792

AUC : 0.9515845444877703

Confusion Matrix
[[577  74]
 [ 81 569]]
True label 0
0.8863287250384024  
0.11367127496159754  
True label 1
0.12461538461538461  
0.8753846153846154  

Train_result {'acc': [0.8991632153020386], 'loss': [0.25698880414851527]}
5

Epoch 1/1
 - 282s - loss: 0.2284 - acc: 0.9073

Test accuracy: 89.62336664104535

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  664

choose_one :  637

F1score :  0.8951048951048952

AUC : 0.9583575564220725

Confusion Matrix
[[590  61]
 [ 74 576]]
True label 0
0.9062980030721967  
0.09370199692780339  
True label 1
0.11384615384615385  
0.8861538461538462  

Train_result {'acc': [0.9072774913766238], 'loss': [0.22838267455257394]}
6

Epoch 1/1
 - 280s - loss: 0.2024 - acc: 0.9231

Test accuracy: 90.00768639508071

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  669

choose_one :  632

F1score :  0.8985959438377534

AUC : 0.9615597305919886

Confusion Matrix
[[595  56]
 [ 74 576]]
True label 0
0.9139784946236559  
0.08602150537634409  
True label 1
0.11384615384615385  
0.8861538461538462  

Train_result {'acc': [0.9230834249409887], 'loss': [0.2024481889550356]}
7

Epoch 1/1
 - 280s - loss: 0.1757 - acc: 0.9357

Test accuracy: 88.47040737893927

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  727

choose_one :  574

F1score :  0.877450980392157

AUC : 0.9615987238567884

Confusion Matrix
[[614  37]
 [113 537]]
True label 0
0.9431643625192012  
0.05683563748079877  
True label 1
0.17384615384615384  
0.8261538461538461  

Train_result {'acc': [0.9356774574714182], 'loss': [0.17568462797900386]}
8

Epoch 1/1
 - 281s - loss: 0.1490 - acc: 0.9440

Test accuracy: 90.31514219830899

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  683

choose_one :  618

F1score :  0.9006309148264984

AUC : 0.9593997400449015

Confusion Matrix
[[604  47]
 [ 79 571]]
True label 0
0.9278033794162827  
0.07219662058371736  
True label 1
0.12153846153846154  
0.8784615384615385  

Train_result {'acc': [0.9439607809990702], 'loss': [0.14897908166906743]}
9

Epoch 1/1
 - 280s - loss: 0.1296 - acc: 0.9536

Test accuracy: 90.16141429669486

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  671

choose_one :  630

F1score :  0.9

AUC : 0.9608354011579818

Confusion Matrix
[[597  54]
 [ 74 576]]
True label 0
0.9170506912442397  
0.08294930875576037  
True label 1
0.11384615384615385  
0.8861538461538462  

Train_result {'acc': [0.9535964838338618], 'loss': [0.1295922480233271]}
10

Epoch 1/1
 - 280s - loss: 0.1155 - acc: 0.9577

Test accuracy: 89.23904688700999

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  663

choose_one :  638

F1score :  0.8913043478260869

AUC : 0.958059789672693

Confusion Matrix
[[587  64]
 [ 76 574]]
True label 0
0.901689708141321  
0.09831029185867896  
True label 1
0.11692307692307692  
0.8830769230769231  

Train_result {'acc': [0.9576536218409264], 'loss': [0.1155060444487848]}
11

Epoch 1/1
 - 280s - loss: 0.0983 - acc: 0.9640

Test accuracy: 90.16141429669486

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  647

choose_one :  654

F1score :  0.901840490797546

AUC : 0.9608224034030485

Confusion Matrix
[[585  66]
 [ 62 588]]
True label 0
0.8986175115207373  
0.10138248847926268  
True label 1
0.09538461538461539  
0.9046153846153846  

Train_result {'acc': [0.9639929000487564], 'loss': [0.09830968372266216]}
12

Epoch 1/1
 - 280s - loss: 0.0823 - acc: 0.9709

Test accuracy: 90.62259800153728

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  643

choose_one :  658

F1score :  0.9067278287461773

AUC : 0.9609275670565993

Confusion Matrix
[[586  65]
 [ 57 593]]
True label 0
0.9001536098310292  
0.09984639016897082  
True label 1
0.0876923076923077  
0.9123076923076923  

Train_result {'acc': [0.9709238441382808], 'loss': [0.08231782727935351]}
13

Epoch 1/1
 - 280s - loss: 0.0746 - acc: 0.9744

Test accuracy: 90.39200614911607

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  638

choose_one :  663

F1score :  0.9047981721249049

AUC : 0.9550005908070424

Confusion Matrix
[[582  69]
 [ 56 594]]
True label 0
0.8940092165898618  
0.10599078341013825  
True label 1
0.08615384615384615  
0.9138461538461539  

Train_result {'acc': [0.974389316243499], 'loss': [0.07464420444606555]}
14

Epoch 1/1
 - 280s - loss: 0.0674 - acc: 0.9769

Test accuracy: 90.69946195234435

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  640

choose_one :  661

F1score :  0.9077040427154843

AUC : 0.952848871558549

Confusion Matrix
[[585  66]
 [ 55 595]]
True label 0
0.8986175115207373  
0.10138248847926268  
True label 1
0.08461538461538462  
0.9153846153846154  

Train_result {'acc': [0.9769250274903574], 'loss': [0.06740922659694426]}
15

Epoch 1/1
 - 280s - loss: 0.0684 - acc: 0.9781

Test accuracy: 90.08455034588778

data size :  13132

zero :  6567

one :  6565

train_zero :  5916

train_one :  5915

test_zero :  651

test_one :  650

choose_zero :  662

choose_one :  639

F1score :  0.899922420480993

AUC : 0.9574453503485761

Confusion Matrix
[[592  59]
 [ 70 580]]
True label 0
0.9093701996927803  
0.09062980030721966  
True label 1
0.1076923076923077  
0.8923076923076924  

Train_result {'acc': [0.9781083593948102], 'loss': [0.06842157676860541]}
Saved model to disk




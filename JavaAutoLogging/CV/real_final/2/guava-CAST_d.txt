Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-03 00:18:33.241377: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-03 00:18:33.295272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-03 00:18:33.297878: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xbb7db10 executing computations on platform Host. Devices:
2019-08-03 00:18:33.297918: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
44755
one : 
13975

Second data
zero : 
44755
one : 
13975

guava-AST

Sentence length Average : 30

Under 10 : 0
Over 10, Under 200 : 30901
Over 200, Under 400 : 118
Over 400 : 0


guava-code

Sentence length Average : 42

Under 10 : 0
Over 10, Under 200 : 30606
Over 200, Under 400 : 413
Over 400 : 0


Test_zero:  2432
Train_zero:  21902
zero:  24334
Test_one:  1058
Train_one:  9117
one:  10175
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1003s - loss: 0.3121 - acc: 0.8642

Test accuracy: 89.74964572508266

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1020

choose_one :  1097

F1score :  0.8993039443155453

AUC : 0.9664090851482744

Confusion Matrix
[[931 128]
 [ 89 969]]
True label 0
0.8791312559017942  
0.12086874409820586  
True label 1
0.08412098298676748  
0.9158790170132325  

Train_result {'acc': [0.8641623252085996], 'loss': [0.31212409222848386]}
2

Epoch 1/1
 - 945s - loss: 0.1999 - acc: 0.9163

Test accuracy: 92.58384506376949

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1040

choose_one :  1077

F1score :  0.9264637002341921

AUC : 0.9799968226257607

Confusion Matrix
[[971  88]
 [ 69 989]]
True label 0
0.9169027384324835  
0.08309726156751653  
True label 1
0.06521739130434782  
0.9347826086956522  

Train_result {'acc': [0.9162599396535656], 'loss': [0.19993752769845985]}
3

Epoch 1/1
 - 878s - loss: 0.1550 - acc: 0.9369

Test accuracy: 93.48134152102031

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1015

choose_one :  1102

F1score :  0.9361111111111111

AUC : 0.9858383716135527

Confusion Matrix
[[ 968   91]
 [  47 1011]]
True label 0
0.9140698772426817  
0.08593012275731822  
True label 1
0.0444234404536862  
0.9555765595463138  

Train_result {'acc': [0.9369344666849465], 'loss': [0.15500671208407377]}
4

Epoch 1/1
 - 877s - loss: 0.1293 - acc: 0.9486

Test accuracy: 94.7094945677846

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1035

choose_one :  1082

F1score :  0.9476635514018692

AUC : 0.989999303833734

Confusion Matrix
[[ 991   68]
 [  44 1014]]
True label 0
0.9357884796978282  
0.06421152030217187  
True label 1
0.04158790170132325  
0.9584120982986768  

Train_result {'acc': [0.9486153002565842], 'loss': [0.12927984106056914]}
5

Epoch 1/1
 - 884s - loss: 0.1021 - acc: 0.9617

Test accuracy: 94.75673122342938

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1052

choose_one :  1065

F1score :  0.9477154969382948

AUC : 0.9894191652787968

Confusion Matrix
[[1000   59]
 [  52 1006]]
True label 0
0.9442870632672332  
0.05571293673276676  
True label 1
0.04914933837429111  
0.9508506616257089  

Train_result {'acc': [0.961721963267278], 'loss': [0.10208709481434525]}
6

Epoch 1/1
 - 892s - loss: 0.0852 - acc: 0.9686

Test accuracy: 95.60699102503543

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1050

choose_one :  1067

F1score :  0.9562352941176471

AUC : 0.9923118253657995

Confusion Matrix
[[1008   51]
 [  42 1016]]
True label 0
0.9518413597733711  
0.04815864022662889  
True label 1
0.03969754253308128  
0.9603024574669187  

Train_result {'acc': [0.9685769125308473], 'loss': [0.08520421650815344]}
7

Epoch 1/1
 - 894s - loss: 0.0710 - acc: 0.9753

Test accuracy: 96.92961738308927

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1040

choose_one :  1077

F1score :  0.9695550351288056

AUC : 0.9955262392205794

Confusion Matrix
[[1017   42]
 [  23 1035]]
True label 0
0.9603399433427762  
0.039660056657223795  
True label 1
0.021739130434782608  
0.9782608695652174  

Train_result {'acc': [0.9753221826158487], 'loss': [0.0710277281244969]}
8

Epoch 1/1
 - 893s - loss: 0.0523 - acc: 0.9822

Test accuracy: 96.92961738308927

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1076

choose_one :  1041

F1score :  0.9690328727965698

AUC : 0.9957498156944437

Confusion Matrix
[[1035   24]
 [  41 1017]]
True label 0
0.9773371104815864  
0.0226628895184136  
True label 1
0.038752362948960305  
0.9612476370510397  

Train_result {'acc': [0.9821771319219109], 'loss': [0.052314464245892985]}
9

Epoch 1/1
 - 892s - loss: 0.0478 - acc: 0.9841

Test accuracy: 96.97685403873406

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1041

choose_one :  1076

F1score :  0.9700093720712277

AUC : 0.9965468368168421

Confusion Matrix
[[1018   41]
 [  23 1035]]
True label 0
0.9612842304060434  
0.03871576959395656  
True label 1
0.021739130434782608  
0.9782608695652174  

Train_result {'acc': [0.9840965176857691], 'loss': [0.0477526107753829]}
10

Epoch 1/1
 - 891s - loss: 0.0415 - acc: 0.9862

Test accuracy: 97.54369390647142

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1033

choose_one :  1084

F1score :  0.9757236227824463

AUC : 0.9970613750890288

Confusion Matrix
[[1020   39]
 [  13 1045]]
True label 0
0.9631728045325779  
0.036827195467422094  
True label 1
0.012287334593572778  
0.9877126654064272  

Train_result {'acc': [0.9862352618917491], 'loss': [0.04151454415565092]}
11

Epoch 1/1
 - 894s - loss: 0.0335 - acc: 0.9892

Test accuracy: 97.44922059518186

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1037

choose_one :  1080

F1score :  0.9747427502338635

AUC : 0.9949983131355864

Confusion Matrix
[[1021   38]
 [  16 1042]]
True label 0
0.9641170915958451  
0.03588290840415486  
True label 1
0.015122873345935728  
0.9848771266540642  

Train_result {'acc': [0.9891965999451604], 'loss': [0.03354311967860718]}
12

Epoch 1/1
 - 892s - loss: 0.0349 - acc: 0.9894

Test accuracy: 97.49645725082664

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1030

choose_one :  1087

F1score :  0.9752913752913752

AUC : 0.9962188354030892

Confusion Matrix
[[1018   41]
 [  12 1046]]
True label 0
0.9612842304060434  
0.03871576959395656  
True label 1
0.011342155009451797  
0.9886578449905482  

Train_result {'acc': [0.9894159583219084], 'loss': [0.03486648834585183]}
13

Epoch 1/1
 - 891s - loss: 0.0313 - acc: 0.9909

Test accuracy: 97.49645725082664

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1042

choose_one :  1075

F1score :  0.9751523675574308

AUC : 0.9967628268634497

Confusion Matrix
[[1024   35]
 [  18 1040]]
True label 0
0.9669499527856469  
0.033050047214353166  
True label 1
0.017013232514177693  
0.9829867674858223  

Train_result {'acc': [0.9908966273649575], 'loss': [0.03132084750027058]}
14

Epoch 1/1
 - 890s - loss: 0.0262 - acc: 0.9925

Test accuracy: 97.63816721776098

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1045

choose_one :  1072

F1score :  0.9765258215962441

AUC : 0.9971287604134871

Confusion Matrix
[[1027   32]
 [  18 1040]]
True label 0
0.9697828139754485  
0.030217186024551465  
True label 1
0.017013232514177693  
0.9829867674858223  

Train_result {'acc': [0.9924869755963805], 'loss': [0.026217386357771703]}
15

Epoch 1/1
 - 890s - loss: 0.0253 - acc: 0.9925

Test accuracy: 97.87435049598488

data size :  20352

zero :  10177

one :  10175

train_zero :  9118

train_one :  9117

test_zero :  1059

test_one :  1058

choose_zero :  1028

choose_one :  1089

F1score :  0.9790405216581276

AUC : 0.9953539826958056

Confusion Matrix
[[1021   38]
 [   7 1051]]
True label 0
0.9641170915958451  
0.03588290840415486  
True label 1
0.006616257088846881  
0.9933837429111532  

Train_result {'acc': [0.9925418152232546], 'loss': [0.02529649761953406]}
Saved model to disk




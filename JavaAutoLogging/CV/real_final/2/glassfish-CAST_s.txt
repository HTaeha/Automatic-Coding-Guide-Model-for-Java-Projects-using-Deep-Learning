Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 00:39:32.945376: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 00:39:32.956197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 00:39:32.958212: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7846c80 executing computations on platform Host. Devices:
2019-08-02 00:39:32.958264: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST_s
all data

Sentence length Average : 51

Under 10 : 10903
Over 10, Under 200 : 26333
Over 200, Under 400 : 1747
Over 400 : 459

glassfish-CAST_s
updated_train_data

Sentence length Average : 64

Under 10 : 0
Over 10, Under 200 : 22940
Over 200, Under 400 : 1805
Over 400 : 0


Test_zero:  2097
Train_zero:  18916
zero:  21013
Test_one:  645
Train_one:  5829
one:  6474

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 265s - loss: 0.4672 - acc: 0.7891

Test accuracy: 79.55073586367158

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  862

choose_one :  429

F1score :  0.7541899441340782

AUC : 0.9283773729810162

Confusion Matrix
[[622  24]
 [240 405]]
True label 0
0.9628482972136223  
0.03715170278637771  
True label 1
0.37209302325581395  
0.627906976744186  

Train_result {'acc': [0.7890899734059864], 'loss': [0.46717174362590297]}
2

Epoch 1/1
 - 263s - loss: 0.3489 - acc: 0.8512

Test accuracy: 87.6839659178931

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  657

choose_one :  634

F1score :  0.8756841282251757

AUC : 0.9470996232030142

Confusion Matrix
[[572  74]
 [ 85 560]]
True label 0
0.8854489164086687  
0.11455108359133127  
True label 1
0.13178294573643412  
0.8682170542635659  

Train_result {'acc': [0.8511879235181424], 'loss': [0.34889466979535533]}
3

Epoch 1/1
 - 279s - loss: 0.2837 - acc: 0.8817

Test accuracy: 88.14872192099148

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  653

choose_one :  638

F1score :  0.8807482462977396

AUC : 0.9474644202846377

Confusion Matrix
[[573  73]
 [ 80 565]]
True label 0
0.8869969040247678  
0.1130030959752322  
True label 1
0.12403100775193798  
0.875968992248062  

Train_result {'acc': [0.881722274637619], 'loss': [0.2837333240344109]}
4

Epoch 1/1
 - 278s - loss: 0.2539 - acc: 0.8950

Test accuracy: 89.46553059643688

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  646

choose_one :  645

F1score :  0.8945736434108527

AUC : 0.956452348381213

Confusion Matrix
[[578  68]
 [ 68 577]]
True label 0
0.8947368421052632  
0.10526315789473684  
True label 1
0.10542635658914729  
0.8945736434108527  

Train_result {'acc': [0.8950167252766104], 'loss': [0.25389049657264945]}
5

Epoch 1/1
 - 278s - loss: 0.2174 - acc: 0.9142

Test accuracy: 89.85282726568552

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  659

choose_one :  632

F1score :  0.8974158183241973

AUC : 0.958626730986152

Confusion Matrix
[[587  59]
 [ 72 573]]
True label 0
0.9086687306501547  
0.0913312693498452  
True label 1
0.11162790697674418  
0.8883720930232558  

Train_result {'acc': [0.9142293507110726], 'loss': [0.21738072631647232]}
6

Epoch 1/1
 - 278s - loss: 0.1882 - acc: 0.9257

Test accuracy: 88.53601859024013

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  614

choose_one :  677

F1score :  0.8880484114977307

AUC : 0.9549907600739195

Confusion Matrix
[[556  90]
 [ 58 587]]
True label 0
0.8606811145510835  
0.1393188854489164  
True label 1
0.08992248062015504  
0.9100775193798449  

Train_result {'acc': [0.9257226177457778], 'loss': [0.18822473774851264]}
7

Epoch 1/1
 - 278s - loss: 0.1628 - acc: 0.9364

Test accuracy: 88.07126258714175

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  646

choose_one :  645

F1score :  0.8806201550387597

AUC : 0.9545347637218902

Confusion Matrix
[[569  77]
 [ 77 568]]
True label 0
0.8808049535603715  
0.11919504643962849  
True label 1
0.11937984496124031  
0.8806201550387597  

Train_result {'acc': [0.9363581782569709], 'loss': [0.1628130455196635]}
8

Epoch 1/1
 - 280s - loss: 0.1430 - acc: 0.9454

Test accuracy: 90.39504260263361

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  686

choose_one :  605

F1score :  0.9008

AUC : 0.962250701994384

Confusion Matrix
[[604  42]
 [ 82 563]]
True label 0
0.934984520123839  
0.06501547987616099  
True label 1
0.12713178294573643  
0.8728682170542635  

Train_result {'acc': [0.9453640964062098], 'loss': [0.14295633624207402]}
9

Epoch 1/1
 - 278s - loss: 0.1180 - acc: 0.9565

Test accuracy: 89.62044926413633

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  606

choose_one :  685

F1score :  0.8992481203007519

AUC : 0.9602587179302565

Confusion Matrix
[[559  87]
 [ 47 598]]
True label 0
0.8653250773993808  
0.1346749226006192  
True label 1
0.07286821705426356  
0.9271317829457364  

Train_result {'acc': [0.9565142808131057], 'loss': [0.11803773352207708]}
10

Epoch 1/1
 - 279s - loss: 0.1020 - acc: 0.9629

Test accuracy: 90.31758326878389

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  645

choose_one :  646

F1score :  0.9031758326878387

AUC : 0.9605107159142727

Confusion Matrix
[[583  63]
 [ 62 583]]
True label 0
0.9024767801857585  
0.09752321981424149  
True label 1
0.09612403100775194  
0.9038759689922481  

Train_result {'acc': [0.9629470795093918], 'loss': [0.1020015626784709]}
11

Epoch 1/1
 - 277s - loss: 0.0864 - acc: 0.9694

Test accuracy: 89.07823392718822

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  603

choose_one :  688

F1score :  0.8942235558889723

AUC : 0.9613087095303238

Confusion Matrix
[[554  92]
 [ 49 596]]
True label 0
0.8575851393188855  
0.14241486068111456  
True label 1
0.07596899224806201  
0.924031007751938  

Train_result {'acc': [0.9693798782312396], 'loss': [0.08641327132002569]}
12

Epoch 1/1
 - 277s - loss: 0.0771 - acc: 0.9735

Test accuracy: 89.62044926413633

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  666

choose_one :  625

F1score :  0.8944881889763779

AUC : 0.9607783137734898

Confusion Matrix
[[589  57]
 [ 77 568]]
True label 0
0.9117647058823529  
0.08823529411764706  
True label 1
0.11937984496124031  
0.8806201550387597  

Train_result {'acc': [0.9734968693713011], 'loss': [0.07707345387708271]}
13

Epoch 1/1
 - 279s - loss: 0.0701 - acc: 0.9762

Test accuracy: 90.70487993803253

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  650

choose_one :  641

F1score :  0.9066874027993779

AUC : 0.9611971104231165

Confusion Matrix
[[588  58]
 [ 62 583]]
True label 0
0.9102167182662538  
0.08978328173374613  
True label 1
0.09612403100775194  
0.9038759689922481  

Train_result {'acc': [0.9762415301483832], 'loss': [0.07008308437707604]}
14

Epoch 1/1
 - 277s - loss: 0.0667 - acc: 0.9789

Test accuracy: 90.39504260263361

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  634

choose_one :  657

F1score :  0.9047619047619048

AUC : 0.9622243022055823

Confusion Matrix
[[578  68]
 [ 56 589]]
True label 0
0.8947368421052632  
0.10526315789473684  
True label 1
0.08682170542635659  
0.9131782945736434  

Train_result {'acc': [0.9789004203017432], 'loss': [0.06670298867355143]}
15

Epoch 1/1
 - 276s - loss: 0.0513 - acc: 0.9837

Test accuracy: 90.6274206041828

data size :  12950

zero :  6476

one :  6474

train_zero :  5830

train_one :  5829

test_zero :  646

test_one :  645

choose_zero :  643

choose_one :  648

F1score :  0.9064191802010827

AUC : 0.9623419012647899

Confusion Matrix
[[584  62]
 [ 59 586]]
True label 0
0.9040247678018576  
0.09597523219814241  
True label 1
0.09147286821705426  
0.9085271317829458  

Train_result {'acc': [0.9837035766616368], 'loss': [0.05134906270471356]}
Saved model to disk




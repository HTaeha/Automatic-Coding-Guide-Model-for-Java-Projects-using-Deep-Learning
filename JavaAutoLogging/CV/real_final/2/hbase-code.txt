Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 11:22:26.118983: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 11:22:26.126628: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 11:22:26.129128: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x75851a0 executing computations on platform Host. Devices:
2019-08-02 11:22:26.129169: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 49

Under 10 : 17243
Over 10, Under 200 : 28715
Over 200, Under 400 : 2031
Over 400 : 481

hbase-code
updated_train_data

Sentence length Average : 70

Under 10 : 0
Over 10, Under 200 : 25151
Over 200, Under 400 : 2075
Over 400 : 0


Test_zero:  2180
Train_zero:  19687
zero:  21867
Test_one:  779
Train_one:  7539
one:  8318

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 343s - loss: 0.4812 - acc: 0.7725

Test accuracy: 83.06606799230276

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  768

choose_one :  791

F1score :  0.8318471337579618

AUC : 0.9066340805108456

Confusion Matrix
[[642 138]
 [126 653]]
True label 0
0.823076923076923  
0.17692307692307693  
True label 1
0.16174582798459564  
0.8382541720154044  

Train_result {'loss': [0.4812436817987535], 'acc': [0.7724650175741097]}
2

Epoch 1/1
 - 345s - loss: 0.3722 - acc: 0.8345

Test accuracy: 84.60551635663887

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  666

choose_one :  893

F1score :  0.8564593301435406

AUC : 0.9351502583851748

Confusion Matrix
[[603 177]
 [ 63 716]]
True label 0
0.7730769230769231  
0.22692307692307692  
True label 1
0.08087291399229782  
0.9191270860077022  

Train_result {'loss': [0.3721685468769096], 'acc': [0.8344717819484051]}
3

Epoch 1/1
 - 362s - loss: 0.3211 - acc: 0.8623

Test accuracy: 83.1302116741501

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  607

choose_one :  952

F1score :  0.8480647024841133

AUC : 0.9459629373621671

Confusion Matrix
[[562 218]
 [ 45 734]]
True label 0
0.7205128205128205  
0.2794871794871795  
True label 1
0.057766367137355584  
0.9422336328626444  

Train_result {'loss': [0.3210951545283715], 'acc': [0.8622587704794485]}
4

Epoch 1/1
 - 362s - loss: 0.2858 - acc: 0.8792

Test accuracy: 88.1975625400898

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  864

choose_one :  695

F1score :  0.87516960651289

AUC : 0.9538296961916988

Confusion Matrix
[[730  50]
 [134 645]]
True label 0
0.9358974358974359  
0.0641025641025641  
True label 1
0.17201540436456997  
0.82798459563543  

Train_result {'loss': [0.2857849619290985], 'acc': [0.8791697062139399]}
5

Epoch 1/1
 - 361s - loss: 0.2601 - acc: 0.8918

Test accuracy: 88.58242463117382

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  798

choose_one :  761

F1score :  0.8844155844155843

AUC : 0.9541769527007012

Confusion Matrix
[[700  80]
 [ 98 681]]
True label 0
0.8974358974358975  
0.10256410256410256  
True label 1
0.1258023106546855  
0.8741976893453145  

Train_result {'loss': [0.26010696903004293], 'acc': [0.8917700112739572]}
6

Epoch 1/1
 - 362s - loss: 0.2378 - acc: 0.8988

Test accuracy: 88.83899935856319

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  764

choose_one :  795

F1score :  0.889453621346887

AUC : 0.9561304762845199

Confusion Matrix
[[685  95]
 [ 79 700]]
True label 0
0.8782051282051282  
0.12179487179487179  
True label 1
0.10141206675224647  
0.8985879332477535  

Train_result {'loss': [0.23775978916970036], 'acc': [0.8987996551534986]}
7

Epoch 1/1
 - 362s - loss: 0.2109 - acc: 0.9139

Test accuracy: 87.62026940346375

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  875

choose_one :  684

F1score :  0.8680792891319207

AUC : 0.9513199038872979

Confusion Matrix
[[731  49]
 [144 635]]
True label 0
0.9371794871794872  
0.06282051282051282  
True label 1
0.18485237483953787  
0.8151476251604621  

Train_result {'loss': [0.21086802391601073], 'acc': [0.9138537038265137]}
8

Epoch 1/1
 - 362s - loss: 0.1894 - acc: 0.9235

Test accuracy: 89.92944194996792

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  789

choose_one :  770

F1score :  0.8986442866365397

AUC : 0.9609048418419406

Confusion Matrix
[[706  74]
 [ 83 696]]
True label 0
0.9051282051282051  
0.09487179487179487  
True label 1
0.10654685494223363  
0.8934531450577664  

Train_result {'loss': [0.18937478948909384], 'acc': [0.9235360435042111]}
9

Epoch 1/1
 - 362s - loss: 0.1647 - acc: 0.9327

Test accuracy: 89.41629249518923

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  807

choose_one :  752

F1score :  0.892227302416721

AUC : 0.9594894835588033

Confusion Matrix
[[711  69]
 [ 96 683]]
True label 0
0.9115384615384615  
0.08846153846153847  
True label 1
0.12323491655969192  
0.8767650834403081  

Train_result {'loss': [0.16471740543506078], 'acc': [0.9326878440214869]}
10

Epoch 1/1
 - 361s - loss: 0.1449 - acc: 0.9410

Test accuracy: 88.5182809493265

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  881

choose_one :  678

F1score :  0.8771448181194235

AUC : 0.9594269444718739

Confusion Matrix
[[741  39]
 [140 639]]
True label 0
0.95  
0.05  
True label 1
0.1797175866495507  
0.8202824133504493  

Train_result {'loss': [0.14491171763310723], 'acc': [0.9409775184030771]}
11

Epoch 1/1
 - 361s - loss: 0.1281 - acc: 0.9506

Test accuracy: 89.73701090442592

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  786

choose_one :  773

F1score :  0.8969072164948455

AUC : 0.9607188703465982

Confusion Matrix
[[703  77]
 [ 83 696]]
True label 0
0.9012820512820513  
0.09871794871794871  
True label 1
0.10654685494223363  
0.8934531450577664  

Train_result {'loss': [0.12810962053188887], 'acc': [0.9505935406857219]}
12

Epoch 1/1
 - 362s - loss: 0.1066 - acc: 0.9583

Test accuracy: 88.96728672225785

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  852

choose_one :  707

F1score :  0.8842530282637954

AUC : 0.9592936374707877

Confusion Matrix
[[730  50]
 [122 657]]
True label 0
0.9358974358974359  
0.0641025641025641  
True label 1
0.15661103979460847  
0.8433889602053916  

Train_result {'loss': [0.10662831690267911], 'acc': [0.9582863585118376]}
13

Epoch 1/1
 - 362s - loss: 0.0963 - acc: 0.9643

Test accuracy: 88.7107119948685

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  740

choose_one :  819

F1score :  0.8898623279098874

AUC : 0.9577943451499293

Confusion Matrix
[[672 108]
 [ 68 711]]
True label 0
0.8615384615384616  
0.13846153846153847  
True label 1
0.08729139922978177  
0.9127086007702182  

Train_result {'loss': [0.09632135263148635], 'acc': [0.9642549240665826]}
14

Epoch 1/1
 - 360s - loss: 0.0891 - acc: 0.9679

Test accuracy: 88.77485567671584

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  801

choose_one :  758

F1score :  0.8861418347430058

AUC : 0.9588476350350548

Confusion Matrix
[[703  77]
 [ 98 681]]
True label 0
0.9012820512820513  
0.09871794871794871  
True label 1
0.1258023106546855  
0.8741976893453145  

Train_result {'loss': [0.08905923125666738], 'acc': [0.9679023807944824]}
15

Epoch 1/1
 - 361s - loss: 0.0705 - acc: 0.9733

Test accuracy: 89.54457985888389

data size :  16638

zero :  8320

one :  8318

train_zero :  7540

train_one :  7539

test_zero :  780

test_one :  779

choose_zero :  771

choose_one :  788

F1score :  0.8959795788130184

AUC : 0.9600120140877523

Confusion Matrix
[[694  86]
 [ 77 702]]
True label 0
0.8897435897435897  
0.11025641025641025  
True label 1
0.09884467265725289  
0.9011553273427471  

Train_result {'loss': [0.0705088814466666], 'acc': [0.9732740897937529]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 12:55:49.005094: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 12:55:49.016146: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 12:55:49.018291: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa4f1070 executing computations on platform Host. Devices:
2019-08-02 12:55:49.018353: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-code
all data

Sentence length Average : 29

Under 10 : 16024
Over 10, Under 200 : 42161
Over 200, Under 400 : 494
Over 400 : 51

guava-code
updated_train_data

Sentence length Average : 37

Under 10 : 0
Over 10, Under 200 : 37211
Over 200, Under 400 : 430
Over 400 : 0


Test_zero:  3103
Train_zero:  28046
zero:  31149
Test_one:  1120
Train_one:  9595
one:  10715

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 434s - loss: 0.2968 - acc: 0.8775

Test accuracy: 89.2904953145917

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1087

choose_one :  1154

F1score :  0.8944591029023745

AUC : 0.9632578533197401

Confusion Matrix
[[ 984  137]
 [ 103 1017]]
True label 0
0.8777876895628903  
0.12221231043710973  
True label 1
0.09196428571428572  
0.9080357142857143  

Train_result {'loss': [0.2968264312743147], 'acc': [0.8774946589671418]}
2

Epoch 1/1
 - 433s - loss: 0.1929 - acc: 0.9249

Test accuracy: 91.74475680499778

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1094

choose_one :  1147

F1score :  0.9183943537715042

AUC : 0.9768872658340767

Confusion Matrix
[[1015  106]
 [  79 1041]]
True label 0
0.9054415700267618  
0.09455842997323818  
True label 1
0.07053571428571428  
0.9294642857142857  

Train_result {'loss': [0.19294491690249113], 'acc': [0.9249127195287811]}
3

Epoch 1/1
 - 441s - loss: 0.1559 - acc: 0.9387

Test accuracy: 93.66354306113342

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1109

choose_one :  1132

F1score :  0.9369449378330373

AUC : 0.9842595100038232

Confusion Matrix
[[1044   77]
 [  65 1055]]
True label 0
0.9313113291703836  
0.06868867082961641  
True label 1
0.05803571428571429  
0.9419642857142857  

Train_result {'loss': [0.15587873213436895], 'acc': [0.9387212755979365]}
4

Epoch 1/1
 - 452s - loss: 0.1230 - acc: 0.9505

Test accuracy: 94.37751004016064

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1147

choose_one :  1094

F1score :  0.9430894308943091

AUC : 0.9874542022428954

Confusion Matrix
[[1071   50]
 [  76 1044]]
True label 0
0.9553969669937555  
0.04460303300624442  
True label 1
0.06785714285714285  
0.9321428571428572  

Train_result {'loss': [0.12298338547318693], 'acc': [0.9505497368682413]}
5

Epoch 1/1
 - 452s - loss: 0.1001 - acc: 0.9598

Test accuracy: 95.58232931726907

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1146

choose_one :  1095

F1score :  0.9553047404063204

AUC : 0.989951175608513

Confusion Matrix
[[1084   37]
 [  62 1058]]
True label 0
0.9669937555753791  
0.03300624442462088  
True label 1
0.055357142857142855  
0.9446428571428571  

Train_result {'loss': [0.10014876648302275], 'acc': [0.9598249179427033]}
6

Epoch 1/1
 - 451s - loss: 0.0819 - acc: 0.9687

Test accuracy: 95.58232931726907

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1090

choose_one :  1151

F1score :  0.9564068692206077

AUC : 0.9921960621893718

Confusion Matrix
[[1056   65]
 [  34 1086]]
True label 0
0.9420160570918823  
0.05798394290811775  
True label 1
0.030357142857142857  
0.9696428571428571  

Train_result {'loss': [0.0818676025426212], 'acc': [0.9686832369339795]}
7

Epoch 1/1
 - 460s - loss: 0.0684 - acc: 0.9750

Test accuracy: 96.96564033913432

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1119

choose_one :  1122

F1score :  0.9696699375557538

AUC : 0.9942195265706639

Confusion Matrix
[[1086   35]
 [  33 1087]]
True label 0
0.9687778768956289  
0.031222123104371096  
True label 1
0.029464285714285714  
0.9705357142857143  

Train_result {'loss': [0.06837074832273408], 'acc': [0.9749882757542598]}
8

Epoch 1/1
 - 470s - loss: 0.0566 - acc: 0.9791

Test accuracy: 96.0285586791611

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1094

choose_one :  1147

F1score :  0.9607410674900749

AUC : 0.9911343507072767

Confusion Matrix
[[1063   58]
 [  31 1089]]
True label 0
0.9482604817127565  
0.05173951828724353  
True label 1
0.027678571428571427  
0.9723214285714286  

Train_result {'loss': [0.05663493325280418], 'acc': [0.979052680956616]}
9

Epoch 1/1
 - 470s - loss: 0.0483 - acc: 0.9834

Test accuracy: 96.25167336010709

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1063

choose_one :  1178

F1score :  0.9634464751958226

AUC : 0.9929670574741939

Confusion Matrix
[[1050   71]
 [  13 1107]]
True label 0
0.936663693131133  
0.06333630686886708  
True label 1
0.011607142857142858  
0.9883928571428572  

Train_result {'loss': [0.04826678254678947], 'acc': [0.9834297326871971]}
10

Epoch 1/1
 - 468s - loss: 0.0432 - acc: 0.9847

Test accuracy: 97.23337795626952

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1117

choose_one :  1124

F1score :  0.9723707664884135

AUC : 0.9944648432521983

Confusion Matrix
[[1088   33]
 [  29 1091]]
True label 0
0.9705619982158786  
0.029438001784121322  
True label 1
0.025892857142857145  
0.9741071428571428  

Train_result {'loss': [0.043150771306822086], 'acc': [0.9847324266583294]}
11

Epoch 1/1
 - 469s - loss: 0.0380 - acc: 0.9868

Test accuracy: 97.23337795626952

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1111

choose_one :  1130

F1score :  0.9724444444444443

AUC : 0.9932609596023959

Confusion Matrix
[[1085   36]
 [  26 1094]]
True label 0
0.967885816235504  
0.032114183764495985  
True label 1
0.023214285714285715  
0.9767857142857143  

Train_result {'loss': [0.037956690868548665], 'acc': [0.9868167370121411]}
12

Epoch 1/1
 - 470s - loss: 0.0345 - acc: 0.9886

Test accuracy: 96.78714859437751

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1097

choose_one :  1144

F1score :  0.9681978798586572

AUC : 0.9937352650694533

Confusion Matrix
[[1073   48]
 [  24 1096]]
True label 0
0.9571810883140054  
0.042818911685994644  
True label 1
0.02142857142857143  
0.9785714285714285  

Train_result {'loss': [0.03453797445390588], 'acc': [0.988588400812881]}
13

Epoch 1/1
 - 470s - loss: 0.0281 - acc: 0.9900

Test accuracy: 96.83177153056671

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1100

choose_one :  1141

F1score :  0.9685979655019903

AUC : 0.9922315056709571

Confusion Matrix
[[1075   46]
 [  25 1095]]
True label 0
0.9589652096342551  
0.04103479036574487  
True label 1
0.022321428571428572  
0.9776785714285714  

Train_result {'loss': [0.02810528451429274], 'acc': [0.989995310301704]}
14

Epoch 1/1
 - 470s - loss: 0.0287 - acc: 0.9907

Test accuracy: 97.05488621151271

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1091

choose_one :  1150

F1score :  0.9709251101321587

AUC : 0.993809337963553

Confusion Matrix
[[1073   48]
 [  18 1102]]
True label 0
0.9571810883140054  
0.042818911685994644  
True label 1
0.01607142857142857  
0.9839285714285714  

Train_result {'loss': [0.028701757069821282], 'acc': [0.9906727111666928]}
15

Epoch 1/1
 - 474s - loss: 0.0277 - acc: 0.9908

Test accuracy: 97.72423025435074

data size :  21432

zero :  10717

one :  10715

train_zero :  9596

train_one :  9595

test_zero :  1121

test_one :  1120

choose_zero :  1110

choose_one :  1131

F1score :  0.9773434029320301

AUC : 0.9925966930036956

Confusion Matrix
[[1090   31]
 [  20 1100]]
True label 0
0.9723461195361285  
0.027653880463871544  
True label 1
0.017857142857142856  
0.9821428571428571  

Train_result {'loss': [0.027706926294676054], 'acc': [0.9907769266843833]}
Saved model to disk




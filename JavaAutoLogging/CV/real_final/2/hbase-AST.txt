Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 04:52:48.405616: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 04:52:48.416290: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 04:52:48.418401: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7ba00d0 executing computations on platform Host. Devices:
2019-08-02 04:52:48.418451: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22948
Over 200, Under 400 : 1191
Over 400 : 0


Test_zero:  1888
Train_zero:  16882
zero:  18770
Test_one:  748
Train_one:  7257
one:  8005

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 344s - loss: 0.4990 - acc: 0.7609

Test accuracy: 82.6319305277221

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  773

choose_one :  724

F1score :  0.8233695652173912

AUC : 0.8993167360402103

Confusion Matrix
[[631 118]
 [142 606]]
True label 0
0.842456608811749  
0.157543391188251  
True label 1
0.18983957219251338  
0.8101604278074866  

Train_result {'loss': [0.4990166265636816], 'acc': [0.7608680675040431]}
2

Epoch 1/1
 - 345s - loss: 0.4161 - acc: 0.8105

Test accuracy: 83.70073480293921

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  747

choose_one :  750

F1score :  0.8371161548731643

AUC : 0.914827613288306

Confusion Matrix
[[626 123]
 [121 627]]
True label 0
0.835781041388518  
0.16421895861148197  
True label 1
0.16176470588235295  
0.8382352941176471  

Train_result {'loss': [0.4160611731510018], 'acc': [0.8104719256229578]}
3

Epoch 1/1
 - 345s - loss: 0.3871 - acc: 0.8267

Test accuracy: 82.96593186372746

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  766

choose_one :  731

F1score :  0.8275862068965518

AUC : 0.9184545525941897

Confusion Matrix
[[630 119]
 [136 612]]
True label 0
0.8411214953271028  
0.1588785046728972  
True label 1
0.18181818181818182  
0.8181818181818182  

Train_result {'loss': [0.3870688278716965], 'acc': [0.8267309680011328]}
4

Epoch 1/1
 - 345s - loss: 0.3714 - acc: 0.8372

Test accuracy: 83.63393453573813

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  854

choose_one :  643

F1score :  0.8238677210639828

AUC : 0.9193220193769946

Confusion Matrix
[[679  70]
 [175 573]]
True label 0
0.9065420560747663  
0.09345794392523364  
True label 1
0.2339572192513369  
0.766042780748663  

Train_result {'loss': [0.37143000496940864], 'acc': [0.8372028935953456]}
5

Epoch 1/1
 - 345s - loss: 0.3567 - acc: 0.8417

Test accuracy: 83.70073480293921

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  719

choose_one :  778

F1score :  0.8401048492791612

AUC : 0.9217798419282752

Confusion Matrix
[[612 137]
 [107 641]]
True label 0
0.8170894526034713  
0.1829105473965287  
True label 1
0.14304812834224598  
0.856951871657754  

Train_result {'loss': [0.35670982513844945], 'acc': [0.8416810196225413]}
6

Epoch 1/1
 - 345s - loss: 0.3414 - acc: 0.8488

Test accuracy: 83.76753507014027

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  676

choose_one :  821

F1score :  0.8451242829827916

AUC : 0.9243947366542198

Confusion Matrix
[[591 158]
 [ 85 663]]
True label 0
0.7890520694259012  
0.2109479305740988  
True label 1
0.11363636363636363  
0.8863636363636364  

Train_result {'loss': [0.3414081163152595], 'acc': [0.8488460213654295]}
7

Epoch 1/1
 - 348s - loss: 0.3228 - acc: 0.8597

Test accuracy: 85.03674014696058

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  749

choose_one :  748

F1score :  0.8502673796791445

AUC : 0.9326856486009867

Confusion Matrix
[[637 112]
 [112 636]]
True label 0
0.8504672897196262  
0.14953271028037382  
True label 1
0.1497326203208556  
0.8502673796791443  

Train_result {'loss': [0.3228125478824664], 'acc': [0.8597313124436244]}
8

Epoch 1/1
 - 351s - loss: 0.3047 - acc: 0.8668

Test accuracy: 84.5691382765531

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  692

choose_one :  805

F1score :  0.8512556342562781

AUC : 0.931703947509335

Confusion Matrix
[[605 144]
 [ 87 661]]
True label 0
0.807743658210948  
0.19225634178905207  
True label 1
0.1163101604278075  
0.8836898395721925  

Train_result {'loss': [0.30472800599740285], 'acc': [0.8667585256918521]}
9

Epoch 1/1
 - 351s - loss: 0.2945 - acc: 0.8732

Test accuracy: 84.76953907815631

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  843

choose_one :  654

F1score :  0.8373751783166905

AUC : 0.935587914010124

Confusion Matrix
[[682  67]
 [161 587]]
True label 0
0.910547396528705  
0.08945260347129506  
True label 1
0.21524064171122995  
0.7847593582887701  

Train_result {'loss': [0.29452473969242715], 'acc': [0.8732345848916278]}
10

Epoch 1/1
 - 350s - loss: 0.2777 - acc: 0.8827

Test accuracy: 85.17034068136272

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  691

choose_one :  806

F1score :  0.8571428571428571

AUC : 0.9335209869844284

Confusion Matrix
[[609 140]
 [ 82 666]]
True label 0
0.8130841121495327  
0.18691588785046728  
True label 1
0.10962566844919786  
0.8903743315508021  

Train_result {'loss': [0.2776847929932765], 'acc': [0.8826730968251624]}
11

Epoch 1/1
 - 351s - loss: 0.2588 - acc: 0.8918

Test accuracy: 85.37074148296593

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  756

choose_one :  741

F1score :  0.8529214237743451

AUC : 0.9327927432655305

Confusion Matrix
[[643 106]
 [113 635]]
True label 0
0.8584779706275033  
0.14152202937249667  
True label 1
0.15106951871657753  
0.8489304812834224  

Train_result {'loss': [0.25877592317757425], 'acc': [0.8918360317200987]}
12

Epoch 1/1
 - 351s - loss: 0.2477 - acc: 0.8946

Test accuracy: 85.97194388777555

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  779

choose_one :  718

F1score :  0.8567530695770805

AUC : 0.9375281123494429

Confusion Matrix
[[659  90]
 [120 628]]
True label 0
0.8798397863818425  
0.12016021361815754  
True label 1
0.16042780748663102  
0.839572192513369  

Train_result {'loss': [0.24765742179179578], 'acc': [0.8945918016133126]}
13

Epoch 1/1
 - 350s - loss: 0.2244 - acc: 0.9042

Test accuracy: 85.70474281897128

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  767

choose_one :  730

F1score :  0.8552097428958052

AUC : 0.9330354911718298

Confusion Matrix
[[651  98]
 [116 632]]
True label 0
0.8691588785046729  
0.1308411214953271  
True label 1
0.15508021390374332  
0.8449197860962567  

Train_result {'loss': [0.22436055754982845], 'acc': [0.9042369961902843]}
14

Epoch 1/1
 - 351s - loss: 0.2111 - acc: 0.9126

Test accuracy: 86.63994655978624

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  791

choose_one :  706

F1score :  0.8624484181568088

AUC : 0.937526327438367

Confusion Matrix
[[670  79]
 [121 627]]
True label 0
0.8945260347129506  
0.1054739652870494  
True label 1
0.16176470588235295  
0.8382352941176471  

Train_result {'loss': [0.21114280826155168], 'acc': [0.9125732001665334]}
15

Epoch 1/1
 - 350s - loss: 0.1936 - acc: 0.9199

Test accuracy: 85.50434201736807

data size :  16012

zero :  8007

one :  8005

train_zero :  7258

train_one :  7257

test_zero :  749

test_one :  748

choose_zero :  726

choose_one :  771

F1score :  0.8571428571428572

AUC : 0.9324304063171572

Confusion Matrix
[[629 120]
 [ 97 651]]
True label 0
0.8397863818424566  
0.1602136181575434  
True label 1
0.12967914438502673  
0.8703208556149733  

Train_result {'loss': [0.1936129195697136], 'acc': [0.9199448845816036]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 08:01:17.117542: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 08:01:17.128340: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 08:01:17.131319: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5a13f80 executing computations on platform Host. Devices:
2019-08-02 08:01:17.131371: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST
all data

Sentence length Average : 55

Under 10 : 5732
Over 10, Under 200 : 50810
Over 200, Under 400 : 1896
Over 400 : 292

guava-CAST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 45649
Over 200, Under 400 : 1899
Over 400 : 0


Test_zero:  4099
Train_zero:  37204
zero:  41303
Test_one:  1189
Train_one:  10344
one:  11533

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 486s - loss: 0.2681 - acc: 0.8958

Test accuracy: 91.71920975199663

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1159

choose_one :  1220

F1score :  0.9182233291822333

AUC : 0.975751461223682

Confusion Matrix
[[1076  114]
 [  83 1106]]
True label 0
0.9042016806722689  
0.0957983193277311  
True label 1
0.06980656013456686  
0.9301934398654331  

Train_result {'acc': [0.8957900333510561], 'loss': [0.2681435381348041]}
2

Epoch 1/1
 - 488s - loss: 0.1724 - acc: 0.9320

Test accuracy: 92.98024379991593

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1197

choose_one :  1182

F1score :  0.9295655841417124

AUC : 0.9839724788149071

Confusion Matrix
[[1110   80]
 [  87 1102]]
True label 0
0.9327731092436975  
0.06722689075630252  
True label 1
0.07317073170731707  
0.926829268292683  

Train_result {'acc': [0.9319928464458992], 'loss': [0.17239331545617848]}
3

Epoch 1/1
 - 491s - loss: 0.1361 - acc: 0.9471

Test accuracy: 93.90500210172341

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1145

choose_one :  1234

F1score :  0.9401568303755674

AUC : 0.9872094338155785

Confusion Matrix
[[1095   95]
 [  50 1139]]
True label 0
0.9201680672268907  
0.07983193277310924  
True label 1
0.04205214465937763  
0.9579478553406223  

Train_result {'acc': [0.9471216588554113], 'loss': [0.13611056208120767]}
4

Epoch 1/1
 - 491s - loss: 0.1131 - acc: 0.9576

Test accuracy: 95.46027742749055

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1142

choose_one :  1237

F1score :  0.9554822753503709

AUC : 0.9912340714250375

Confusion Matrix
[[1112   78]
 [  30 1159]]
True label 0
0.934453781512605  
0.06554621848739496  
True label 1
0.025231286795626577  
0.9747687132043734  

Train_result {'acc': [0.9575619894687616], 'loss': [0.11307493666808771]}
5

Epoch 1/1
 - 490s - loss: 0.0937 - acc: 0.9656

Test accuracy: 95.29213955443464

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1156

choose_one :  1223

F1score :  0.9535655058043118

AUC : 0.9900534309602731

Confusion Matrix
[[1117   73]
 [  39 1150]]
True label 0
0.938655462184874  
0.06134453781512605  
True label 1
0.03280067283431455  
0.9671993271656855  

Train_result {'acc': [0.9656339117491815], 'loss': [0.09365169682389063]}
6

Epoch 1/1
 - 490s - loss: 0.0737 - acc: 0.9734

Test accuracy: 95.8806221101303

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1178

choose_one :  1201

F1score :  0.9589958158995816

AUC : 0.9929037889335717

Confusion Matrix
[[1135   55]
 [  43 1146]]
True label 0
0.9537815126050421  
0.046218487394957986  
True label 1
0.03616484440706476  
0.9638351555929352  

Train_result {'acc': [0.973415824837334], 'loss': [0.0736841398635072]}
7

Epoch 1/1
 - 490s - loss: 0.0659 - acc: 0.9766

Test accuracy: 96.0907944514502

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1161

choose_one :  1218

F1score :  0.9613626921479019

AUC : 0.9927836399488307

Confusion Matrix
[[1129   61]
 [  32 1157]]
True label 0
0.9487394957983193  
0.05126050420168067  
True label 1
0.02691337258200168  
0.9730866274179983  

Train_result {'acc': [0.9766059258543187], 'loss': [0.06594857163067133]}
8

Epoch 1/1
 - 490s - loss: 0.0564 - acc: 0.9809

Test accuracy: 97.22572509457756

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1190

choose_one :  1189

F1score :  0.9722455845248108

AUC : 0.9955566078407813

Confusion Matrix
[[1157   33]
 [  33 1156]]
True label 0
0.9722689075630252  
0.02773109243697479  
True label 1
0.027754415475189236  
0.9722455845248108  

Train_result {'acc': [0.9808593938808062], 'loss': [0.05642029716387094]}
9

Epoch 1/1
 - 496s - loss: 0.0519 - acc: 0.9826

Test accuracy: 97.05758722152164

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1164

choose_one :  1215

F1score :  0.9708818635607321

AUC : 0.9943600653045069

Confusion Matrix
[[1142   48]
 [  22 1167]]
True label 0
0.9596638655462185  
0.040336134453781515  
True label 1
0.018502943650126155  
0.9814970563498738  

Train_result {'acc': [0.9825994489854321], 'loss': [0.051860248645623025]}
10

Epoch 1/1
 - 497s - loss: 0.0459 - acc: 0.9836

Test accuracy: 96.72131147540983

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1144

choose_one :  1235

F1score :  0.9678217821782178

AUC : 0.9938317631510133

Confusion Matrix
[[1128   62]
 [  16 1173]]
True label 0
0.9478991596638655  
0.052100840336134456  
True label 1
0.01345668629100084  
0.9865433137089992  

Train_result {'acc': [0.9836144811252356], 'loss': [0.0459354441457082]}
11

Epoch 1/1
 - 497s - loss: 0.0433 - acc: 0.9859

Test accuracy: 96.30096679277007

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1134

choose_one :  1245

F1score :  0.9638455217748562

AUC : 0.9930939070329563

Confusion Matrix
[[1118   72]
 [  16 1173]]
True label 0
0.9394957983193277  
0.06050420168067227  
True label 1
0.01345668629100084  
0.9865433137089992  

Train_result {'acc': [0.9858862197302914], 'loss': [0.04325501206929603]}
12

Epoch 1/1
 - 497s - loss: 0.0405 - acc: 0.9862

Test accuracy: 97.01555275325767

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1187

choose_one :  1192

F1score :  0.9701805963880723

AUC : 0.9938243421843085

Confusion Matrix
[[1153   37]
 [  34 1155]]
True label 0
0.9689075630252101  
0.031092436974789917  
True label 1
0.028595458368376788  
0.9714045416316233  

Train_result {'acc': [0.9861762289139157], 'loss': [0.040477175488202864]}
13

Epoch 1/1
 - 497s - loss: 0.0371 - acc: 0.9884

Test accuracy: 97.26775956284153

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1173

choose_one :  1206

F1score :  0.9728601252609603

AUC : 0.9942042250037104

Confusion Matrix
[[1149   41]
 [  24 1165]]
True label 0
0.965546218487395  
0.034453781512605045  
True label 1
0.020185029436501262  
0.9798149705634988  

Train_result {'acc': [0.9883996326579151], 'loss': [0.0370836129427394]}
14

Epoch 1/1
 - 497s - loss: 0.0335 - acc: 0.9900

Test accuracy: 97.18369062631358

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1165

choose_one :  1214

F1score :  0.9721181856013318

AUC : 0.9946332275551095

Confusion Matrix
[[1144   46]
 [  21 1168]]
True label 0
0.9613445378151261  
0.03865546218487395  
True label 1
0.017661900756938603  
0.9823380992430614  

Train_result {'acc': [0.9899946831649669], 'loss': [0.033540909725034325]}
15

Epoch 1/1
 - 497s - loss: 0.0312 - acc: 0.9896

Test accuracy: 97.18369062631358

data size :  23068

zero :  11535

one :  11533

train_zero :  10345

train_one :  10344

test_zero :  1190

test_one :  1189

choose_zero :  1161

choose_one :  1218

F1score :  0.9721645201495638

AUC : 0.9941854958972656

Confusion Matrix
[[1142   48]
 [  19 1170]]
True label 0
0.9596638655462185  
0.040336134453781515  
True label 1
0.0159798149705635  
0.9840201850294366  

Train_result {'acc': [0.9896080042534681], 'loss': [0.03121338507106848]}
Saved model to disk




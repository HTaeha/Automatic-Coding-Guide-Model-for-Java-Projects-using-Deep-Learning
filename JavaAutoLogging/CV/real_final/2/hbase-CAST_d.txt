Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("ou...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-03 04:13:22.520701: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-03 04:13:22.769357: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-03 04:13:22.771704: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xf3017a0 executing computations on platform Host. Devices:
2019-08-03 04:13:22.771744: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 60

Under 10 : 0
Over 10, Under 200 : 22740
Over 200, Under 400 : 1186
Over 400 : 0


hbase-code

Sentence length Average : 77

Under 10 : 0
Over 10, Under 200 : 21865
Over 200, Under 400 : 2061
Over 400 : 0


Test_zero:  1867
Train_zero:  16711
zero:  18578
Test_one:  744
Train_one:  7215
one:  7959
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 961s - loss: 0.5103 - acc: 0.7620

Test accuracy: 83.2102081934184

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  683

choose_one :  806

F1score :  0.8387096774193548

AUC : 0.9116800173197662

Confusion Matrix
[[589 156]
 [ 94 650]]
True label 0
0.7906040268456376  
0.20939597315436242  
True label 1
0.12634408602150538  
0.8736559139784946  

Train_result {'loss': [0.510279853988624], 'acc': [0.7619707573435756]}
2

Epoch 1/1
 - 941s - loss: 0.3790 - acc: 0.8326

Test accuracy: 85.89657488247146

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  753

choose_one :  736

F1score :  0.8581081081081081

AUC : 0.9316681099805153

Confusion Matrix
[[644 101]
 [109 635]]
True label 0
0.8644295302013423  
0.13557046979865772  
True label 1
0.14650537634408603  
0.853494623655914  

Train_result {'loss': [0.37896188850933493], 'acc': [0.832582634614317]}
3

Epoch 1/1
 - 693s - loss: 0.3345 - acc: 0.8541

Test accuracy: 86.97112155809268

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  761

choose_one :  728

F1score :  0.8682065217391305

AUC : 0.9405066031608573

Confusion Matrix
[[656  89]
 [105 639]]
True label 0
0.8805369127516779  
0.11946308724832215  
True label 1
0.14112903225806453  
0.8588709677419355  

Train_result {'loss': [0.3344685587703905], 'acc': [0.8541334626968896]}
4

Epoch 1/1
 - 697s - loss: 0.2997 - acc: 0.8712

Test accuracy: 87.97850906648758

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  806

choose_one :  683

F1score :  0.874562018220042

AUC : 0.943837951937649

Confusion Matrix
[[686  59]
 [120 624]]
True label 0
0.9208053691275168  
0.07919463087248323  
True label 1
0.16129032258064516  
0.8387096774193549  

Train_result {'loss': [0.2997077335381853], 'acc': [0.8711800983373246]}
5

Epoch 1/1
 - 773s - loss: 0.2790 - acc: 0.8846

Test accuracy: 88.0456682337139

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  757

choose_one :  732

F1score :  0.8794037940379404

AUC : 0.9489932885906041

Confusion Matrix
[[662  83]
 [ 95 649]]
True label 0
0.8885906040268456  
0.11140939597315436  
True label 1
0.12768817204301075  
0.8723118279569892  

Train_result {'loss': [0.2790039611365805], 'acc': [0.8846233801611759]}
6

Epoch 1/1
 - 705s - loss: 0.2551 - acc: 0.8909

Test accuracy: 88.44862323707186

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  759

choose_one :  730

F1score :  0.8833107191316145

AUC : 0.9527116258930504

Confusion Matrix
[[666  79]
 [ 93 651]]
True label 0
0.8939597315436242  
0.10604026845637583  
True label 1
0.125  
0.875  

Train_result {'loss': [0.25511480467737974], 'acc': [0.890859954269254]}
7

Epoch 1/1
 - 757s - loss: 0.2355 - acc: 0.9021

Test accuracy: 88.24714573539289

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  732

choose_one :  757

F1score :  0.8834110592938043

AUC : 0.9536624088908133

Confusion Matrix
[[651  94]
 [ 81 663]]
True label 0
0.8738255033557047  
0.1261744966442953  
True label 1
0.10887096774193548  
0.8911290322580645  

Train_result {'loss': [0.23554490156707675], 'acc': [0.9020857874911471]}
8

Epoch 1/1
 - 718s - loss: 0.2109 - acc: 0.9120

Test accuracy: 89.38885157824042

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  787

choose_one :  702

F1score :  0.8907330567081605

AUC : 0.9538247816987804

Confusion Matrix
[[687  58]
 [100 644]]
True label 0
0.9221476510067114  
0.07785234899328859  
True label 1
0.13440860215053763  
0.8655913978494624  

Train_result {'loss': [0.21089325410628648], 'acc': [0.9119950106788116]}
9

Epoch 1/1
 - 706s - loss: 0.1868 - acc: 0.9246

Test accuracy: 88.58294157152451

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  765

choose_one :  724

F1score :  0.8841961852861036

AUC : 0.9501136609655769

Confusion Matrix
[[670  75]
 [ 95 649]]
True label 0
0.8993288590604027  
0.10067114093959731  
True label 1
0.12768817204301075  
0.8723118279569892  

Train_result {'loss': [0.18675647415161364], 'acc': [0.924606749297064]}
10

Epoch 1/1
 - 703s - loss: 0.1678 - acc: 0.9321

Test accuracy: 88.31430490261921

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  727

choose_one :  762

F1score :  0.8844621513944222

AUC : 0.952543840658151

Confusion Matrix
[[649  96]
 [ 78 666]]
True label 0
0.8711409395973154  
0.12885906040268458  
True label 1
0.10483870967741936  
0.8951612903225806  

Train_result {'loss': [0.16782825587052877], 'acc': [0.9320906382135407]}
11

Epoch 1/1
 - 701s - loss: 0.1457 - acc: 0.9448

Test accuracy: 88.91873740765615

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  748

choose_one :  741

F1score :  0.8888888888888887

AUC : 0.9518041423107455

Confusion Matrix
[[664  81]
 [ 84 660]]
True label 0
0.8912751677852349  
0.1087248322147651  
True label 1
0.11290322580645161  
0.8870967741935484  

Train_result {'loss': [0.14570661355358558], 'acc': [0.9447716720328412]}
12

Epoch 1/1
 - 711s - loss: 0.1267 - acc: 0.9525

Test accuracy: 88.91873740765615

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  822

choose_one :  667

F1score :  0.8830616583982991

AUC : 0.9506558057299558

Confusion Matrix
[[701  44]
 [121 623]]
True label 0
0.9409395973154362  
0.05906040268456376  
True label 1
0.16263440860215053  
0.8373655913978495  

Train_result {'loss': [0.12668258342671218], 'acc': [0.952532741955896]}
13

Epoch 1/1
 - 691s - loss: 0.1059 - acc: 0.9584

Test accuracy: 89.45601074546676

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  768

choose_one :  721

F1score :  0.8928327645051196

AUC : 0.9539104784585409

Confusion Matrix
[[678  67]
 [ 90 654]]
True label 0
0.9100671140939597  
0.08993288590604027  
True label 1
0.12096774193548387  
0.8790322580645161  

Train_result {'loss': [0.10591014913296132], 'acc': [0.9583535443909591]}
14

Epoch 1/1
 - 691s - loss: 0.0917 - acc: 0.9669

Test accuracy: 88.7844190732035

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  750

choose_one :  739

F1score :  0.887390424814565

AUC : 0.951335967381107

Confusion Matrix
[[664  81]
 [ 86 658]]
True label 0
0.8912751677852349  
0.1087248322147651  
True label 1
0.11559139784946236  
0.8844086021505376  

Train_result {'loss': [0.09168323021846496], 'acc': [0.9669461575815678]}
15

Epoch 1/1
 - 691s - loss: 0.0778 - acc: 0.9710

Test accuracy: 89.85896574882472

data size :  15920

zero :  7961

one :  7959

train_zero :  7216

train_one :  7215

test_zero :  745

test_one :  744

choose_zero :  750

choose_one :  739

F1score :  0.8981793661496966

AUC : 0.9498466479035865

Confusion Matrix
[[672  73]
 [ 78 666]]
True label 0
0.9020134228187919  
0.09798657718120805  
True label 1
0.10483870967741936  
0.8951612903225806  

Train_result {'loss': [0.07781389663052081], 'acc': [0.9709652830711663]}
Saved model to disk




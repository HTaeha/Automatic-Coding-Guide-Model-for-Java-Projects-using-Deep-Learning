Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 06:23:50.259233: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 06:23:50.269336: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-02 06:23:50.271280: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5b1cd90 executing computations on platform Host. Devices:
2019-08-02 06:23:50.271320: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 90

Under 10 : 0
Over 10, Under 200 : 31557
Over 200, Under 400 : 5177
Over 400 : 0


Test_zero:  3263
Train_zero:  29035
zero:  32298
Test_one:  798
Train_one:  7699
one:  8497

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 355s - loss: 0.4065 - acc: 0.8216

Test accuracy: 87.03819661866

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  796

choose_one :  801

F1score :  0.8705440900562851

AUC : 0.9402260344227278

Confusion Matrix
[[694 105]
 [102 696]]
True label 0
0.8685857321652065  
0.13141426783479349  
True label 1
0.12781954887218044  
0.8721804511278195  

Train_result {'acc': [0.821611792981311], 'loss': [0.4065141208768394]}
2

Epoch 1/1
 - 376s - loss: 0.3198 - acc: 0.8642

Test accuracy: 87.78960551033187

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  714

choose_one :  883

F1score :  0.8839976204640095

AUC : 0.9528687174757922

Confusion Matrix
[[659 140]
 [ 55 743]]
True label 0
0.8247809762202754  
0.17521902377972465  
True label 1
0.06892230576441102  
0.931077694235589  

Train_result {'acc': [0.864211961819573], 'loss': [0.3197589038174929]}
3

Epoch 1/1
 - 374s - loss: 0.2933 - acc: 0.8778

Test accuracy: 88.72886662492174

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  783

choose_one :  814

F1score :  0.8883374689826302

AUC : 0.9578969325692203

Confusion Matrix
[[701  98]
 [ 82 716]]
True label 0
0.8773466833541927  
0.12265331664580725  
True label 1
0.10275689223057644  
0.8972431077694235  

Train_result {'acc': [0.877784271705955], 'loss': [0.29326822559696814]}
4

Epoch 1/1
 - 375s - loss: 0.2682 - acc: 0.8908

Test accuracy: 88.41577958672511

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  804

choose_one :  793

F1score :  0.8837209302325583

AUC : 0.9595092236222595

Confusion Matrix
[[709  90]
 [ 95 703]]
True label 0
0.8873591989987485  
0.11264080100125157  
True label 1
0.11904761904761904  
0.8809523809523809  

Train_result {'acc': [0.890772128068005], 'loss': [0.26818253023182076]}
5

Epoch 1/1
 - 375s - loss: 0.2452 - acc: 0.9009

Test accuracy: 89.48027551659361

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  801

choose_one :  796

F1score :  0.8946047678795483

AUC : 0.9628655493552403

Confusion Matrix
[[716  83]
 [ 85 713]]
True label 0
0.8961201501877347  
0.10387984981226533  
True label 1
0.10651629072681704  
0.893483709273183  

Train_result {'acc': [0.9009026560204951], 'loss': [0.24518686418208496]}
6

Epoch 1/1
 - 375s - loss: 0.2173 - acc: 0.9148

Test accuracy: 89.29242329367564

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  826

choose_one :  771

F1score :  0.8910133843212237

AUC : 0.9627024381981236

Confusion Matrix
[[727  72]
 [ 99 699]]
True label 0
0.9098873591989988  
0.09011264080100125  
True label 1
0.12406015037593984  
0.8759398496240601  

Train_result {'acc': [0.9147996623196055], 'loss': [0.21727092677033158]}
7

Epoch 1/1
 - 374s - loss: 0.1875 - acc: 0.9273

Test accuracy: 88.54101440200375

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  712

choose_one :  885

F1score :  0.8912655971479501

AUC : 0.9635085837246433

Confusion Matrix
[[664 135]
 [ 48 750]]
True label 0
0.8310387984981227  
0.16896120150187735  
True label 1
0.06015037593984962  
0.9398496240601504  

Train_result {'acc': [0.9273329436976427], 'loss': [0.18752981438827374]}
8

Epoch 1/1
 - 375s - loss: 0.1628 - acc: 0.9352

Test accuracy: 89.29242329367564

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  832

choose_one :  765

F1score :  0.8905950095969288

AUC : 0.9634850580769823

Confusion Matrix
[[730  69]
 [102 696]]
True label 0
0.9136420525657072  
0.08635794743429287  
True label 1
0.12781954887218044  
0.8721804511278195  

Train_result {'acc': [0.9351905967919995], 'loss': [0.16279087669547948]}
9

Epoch 1/1
 - 374s - loss: 0.1399 - acc: 0.9484

Test accuracy: 91.10832811521603

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  791

choose_one :  806

F1score :  0.9114713216957606

AUC : 0.9647899473339167

Confusion Matrix
[[724  75]
 [ 67 731]]
True label 0
0.9061326658322904  
0.09386733416770963  
True label 1
0.08395989974937343  
0.9160401002506265  

Train_result {'acc': [0.9483732709916228], 'loss': [0.13985945123660695]}
10

Epoch 1/1
 - 375s - loss: 0.1192 - acc: 0.9556

Test accuracy: 90.35691922354414

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  789

choose_one :  808

F1score :  0.904109589041096

AUC : 0.9661865866167295

Confusion Matrix
[[717  82]
 [ 72 726]]
True label 0
0.8973717146433041  
0.10262828535669587  
True label 1
0.09022556390977443  
0.9097744360902256  

Train_result {'acc': [0.9555815312682642], 'loss': [0.11921641899532816]}
11

Epoch 1/1
 - 375s - loss: 0.1031 - acc: 0.9635

Test accuracy: 89.91859737006888

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  796

choose_one :  801

F1score :  0.8993120700437774

AUC : 0.9593367022060784

Confusion Matrix
[[717  82]
 [ 79 719]]
True label 0
0.8973717146433041  
0.10262828535669587  
True label 1
0.09899749373433583  
0.9010025062656641  

Train_result {'acc': [0.9635041236443925], 'loss': [0.10312733241792421]}
12

Epoch 1/1
 - 375s - loss: 0.0868 - acc: 0.9682

Test accuracy: 90.2316844082655

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  771

choose_one :  826

F1score :  0.9039408866995073

AUC : 0.9626891069977823

Confusion Matrix
[[707  92]
 [ 64 734]]
True label 0
0.8848560700876095  
0.11514392991239049  
True label 1
0.08020050125313283  
0.9197994987468672  

Train_result {'acc': [0.9682446912137151], 'loss': [0.08680389844021684]}
13

Epoch 1/1
 - 375s - loss: 0.0793 - acc: 0.9716

Test accuracy: 89.85597996242956

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  729

choose_one :  868

F1score :  0.9027611044417767

AUC : 0.9619754956853963

Confusion Matrix
[[683 116]
 [ 46 752]]
True label 0
0.8548185231539425  
0.14518147684605756  
True label 1
0.05764411027568922  
0.9423558897243107  

Train_result {'acc': [0.9715565945879345], 'loss': [0.07927609279621627]}
14

Epoch 1/1
 - 376s - loss: 0.0707 - acc: 0.9752

Test accuracy: 89.66812773951159

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  768

choose_one :  829

F1score :  0.8985863552550707

AUC : 0.9595798005652427

Confusion Matrix
[[701  98]
 [ 67 731]]
True label 0
0.8773466833541927  
0.12265331664580725  
True label 1
0.08395989974937343  
0.9160401002506265  

Train_result {'acc': [0.9751931943632703], 'loss': [0.07069380964889116]}
15

Epoch 1/1
 - 375s - loss: 0.0623 - acc: 0.9790

Test accuracy: 88.79148403256106

data size :  16996

zero :  8499

one :  8497

train_zero :  7700

train_one :  7699

test_zero :  799

test_one :  798

choose_zero :  770

choose_one :  827

F1score :  0.8898461538461538

AUC : 0.9586575951769285

Confusion Matrix
[[695 104]
 [ 75 723]]
True label 0
0.869837296620776  
0.13016270337922403  
True label 1
0.09398496240601503  
0.9060150375939849  

Train_result {'acc': [0.9790246119877914], 'loss': [0.062324667428353145]}
Saved model to disk




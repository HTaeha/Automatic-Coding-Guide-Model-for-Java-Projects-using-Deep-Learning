Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 02:38:41.565078: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 02:38:41.576603: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 02:38:41.579261: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x747cfc0 executing computations on platform Host. Devices:
2019-08-04 02:38:41.579302: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST_s
all data

Sentence length Average : 51

Under 10 : 10903
Over 10, Under 200 : 26333
Over 200, Under 400 : 1747
Over 400 : 459

glassfish-CAST_s
updated_train_data

Sentence length Average : 64

Under 10 : 0
Over 10, Under 200 : 22951
Over 200, Under 400 : 1810
Over 400 : 0


Test_zero:  2097
Train_zero:  18915
zero:  21012
Test_one:  629
Train_one:  5846
one:  6475

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 254s - loss: 0.4552 - acc: 0.7894

Test accuracy: 82.04924543288324

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  792

choose_one :  467

F1score :  0.7937956204379563

AUC : 0.9294508794508793

Confusion Matrix
[[598  32]
 [194 435]]
True label 0
0.9492063492063492  
0.050793650793650794  
True label 1
0.30842607313195547  
0.6915739268680445  

Train_result {'loss': [0.45523052556711197], 'acc': [0.7894466774993586]}
2

Epoch 1/1
 - 256s - loss: 0.3446 - acc: 0.8546

Test accuracy: 86.10007942811755

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  563

choose_one :  696

F1score :  0.8679245283018868

AUC : 0.9455144219850103

Confusion Matrix
[[509 121]
 [ 54 575]]
True label 0
0.807936507936508  
0.19206349206349208  
True label 1
0.08585055643879173  
0.9141494435612083  

Train_result {'loss': [0.3445640216429954], 'acc': [0.8546138715572744]}
3

Epoch 1/1
 - 259s - loss: 0.2846 - acc: 0.8815

Test accuracy: 88.95949166004765

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  633

choose_one :  626

F1score :  0.8892430278884462

AUC : 0.9555517702576526

Confusion Matrix
[[562  68]
 [ 71 558]]
True label 0
0.8920634920634921  
0.10793650793650794  
True label 1
0.11287758346581876  
0.8871224165341812  

Train_result {'loss': [0.28464592460956767], 'acc': [0.8814675446950491]}
4

Epoch 1/1
 - 258s - loss: 0.2487 - acc: 0.8967

Test accuracy: 89.1977760127085

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  692

choose_one :  567

F1score :  0.88628762541806

AUC : 0.9589333030509503

Confusion Matrix
[[593  37]
 [ 99 530]]
True label 0
0.9412698412698413  
0.05873015873015873  
True label 1
0.1573926868044515  
0.8426073131955485  

Train_result {'loss': [0.24873001801618955], 'acc': [0.8966903275463953]}
5

Epoch 1/1
 - 258s - loss: 0.2169 - acc: 0.9101

Test accuracy: 89.1977760127085

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  588

choose_one :  671

F1score :  0.8953846153846153

AUC : 0.9578456607868373

Confusion Matrix
[[541  89]
 [ 47 582]]
True label 0
0.8587301587301587  
0.14126984126984127  
True label 1
0.07472178060413355  
0.9252782193958664  

Train_result {'loss': [0.2168546575716153], 'acc': [0.9101171641254776]}
6

Epoch 1/1
 - 260s - loss: 0.1876 - acc: 0.9247

Test accuracy: 89.7537728355838

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  687

choose_one :  572

F1score :  0.8925895087427145

AUC : 0.9626328008680952

Confusion Matrix
[[594  36]
 [ 93 536]]
True label 0
0.9428571428571428  
0.05714285714285714  
True label 1
0.1478537360890302  
0.8521462639109698  

Train_result {'loss': [0.18763296057408893], 'acc': [0.9246557769605747]}
7

Epoch 1/1
 - 258s - loss: 0.1625 - acc: 0.9380

Test accuracy: 91.02462271644161

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  653

choose_one :  606

F1score :  0.908502024291498

AUC : 0.9679246473364121

Confusion Matrix
[[585  45]
 [ 68 561]]
True label 0
0.9285714285714286  
0.07142857142857142  
True label 1
0.10810810810810811  
0.8918918918918919  

Train_result {'loss': [0.1624959384221104], 'acc': [0.9379970922825284]}
8

Epoch 1/1
 - 259s - loss: 0.1412 - acc: 0.9469

Test accuracy: 89.1977760127085

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  588

choose_one :  671

F1score :  0.8953846153846153

AUC : 0.9672407701819467

Confusion Matrix
[[541  89]
 [ 47 582]]
True label 0
0.8587301587301587  
0.14126984126984127  
True label 1
0.07472178060413355  
0.9252782193958664  

Train_result {'loss': [0.14118671089787993], 'acc': [0.9468913024937659]}
9

Epoch 1/1
 - 257s - loss: 0.1194 - acc: 0.9558

Test accuracy: 89.67434471803018

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  624

choose_one :  635

F1score :  0.8971518987341772

AUC : 0.9659840512781689

Confusion Matrix
[[562  68]
 [ 62 567]]
True label 0
0.8920634920634921  
0.10793650793650794  
True label 1
0.0985691573926868  
0.9014308426073132  

Train_result {'loss': [0.1193975767189694], 'acc': [0.9557855127050033]}
10

Epoch 1/1
 - 259s - loss: 0.0980 - acc: 0.9631

Test accuracy: 88.95949166004765

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  603

choose_one :  656

F1score :  0.8918287937743191

AUC : 0.9526206879148055

Confusion Matrix
[[547  83]
 [ 56 573]]
True label 0
0.8682539682539683  
0.13174603174603175  
True label 1
0.0890302066772655  
0.9109697933227345  

Train_result {'loss': [0.09804719854979359], 'acc': [0.9630548191276495]}
11

Epoch 1/1
 - 258s - loss: 0.0893 - acc: 0.9677

Test accuracy: 89.35663224781572

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  606

choose_one :  653

F1score :  0.8954758190327613

AUC : 0.9590001766472354

Confusion Matrix
[[551  79]
 [ 55 574]]
True label 0
0.8746031746031746  
0.1253968253968254  
True label 1
0.08744038155802862  
0.9125596184419714  

Train_result {'loss': [0.0893017322645082], 'acc': [0.9676729667322329]}
12

Epoch 1/1
 - 260s - loss: 0.0758 - acc: 0.9732

Test accuracy: 90.70691024622717

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  623

choose_one :  636

F1score :  0.907509881422925

AUC : 0.9671776818835642

Confusion Matrix
[[568  62]
 [ 55 574]]
True label 0
0.9015873015873016  
0.09841269841269841  
True label 1
0.08744038155802862  
0.9125596184419714  

Train_result {'loss': [0.07584086382166551], 'acc': [0.9732318481142564]}
13

Epoch 1/1
 - 259s - loss: 0.0650 - acc: 0.9783

Test accuracy: 90.15091342335187

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  678

choose_one :  581

F1score :  0.8975206611570248

AUC : 0.9663449163449164

Confusion Matrix
[[592  38]
 [ 86 543]]
True label 0
0.9396825396825397  
0.06031746031746032  
True label 1
0.13672496025437203  
0.863275039745628  

Train_result {'loss': [0.0649576169667807], 'acc': [0.9782776019942879]}
14

Epoch 1/1
 - 258s - loss: 0.0580 - acc: 0.9802

Test accuracy: 90.86576648133439

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  623

choose_one :  636

F1score :  0.9090909090909091

AUC : 0.9643210437328085

Confusion Matrix
[[569  61]
 [ 54 575]]
True label 0
0.9031746031746032  
0.09682539682539683  
True label 1
0.08585055643879173  
0.9141494435612083  

Train_result {'loss': [0.05799147403295384], 'acc': [0.9801590695287778]}
15

Epoch 1/1
 - 258s - loss: 0.0582 - acc: 0.9800

Test accuracy: 90.38919777601271

data size :  12952

zero :  6477

one :  6475

train_zero :  5847

train_one :  5846

test_zero :  630

test_one :  629

choose_zero :  639

choose_one :  620

F1score :  0.9031224979983986

AUC : 0.9665518459636105

Confusion Matrix
[[574  56]
 [ 65 564]]
True label 0
0.9111111111111111  
0.08888888888888889  
True label 1
0.10333863275039745  
0.8966613672496025  

Train_result {'loss': [0.05816205815060618], 'acc': [0.9799880270247157]}
Saved model to disk




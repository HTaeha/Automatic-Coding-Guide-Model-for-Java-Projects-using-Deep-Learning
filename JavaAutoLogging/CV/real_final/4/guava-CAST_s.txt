Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 00:42:10.596644: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 00:42:10.607847: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 00:42:10.610533: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x738d910 executing computations on platform Host. Devices:
2019-08-04 00:42:10.610573: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST_s
all data

Sentence length Average : 42

Under 10 : 7428
Over 10, Under 200 : 50330
Over 200, Under 400 : 889
Over 400 : 83

guava-CAST_s
updated_train_data

Sentence length Average : 46

Under 10 : 0
Over 10, Under 200 : 44778
Over 200, Under 400 : 807
Over 400 : 0


Test_zero:  3952
Train_zero:  35429
zero:  39381
Test_one:  1091
Train_one:  10156
one:  11247

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 438s - loss: 0.2543 - acc: 0.8966

Test accuracy: 92.3957856161246

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1086

choose_one :  1097

F1score :  0.9241316270566726

AUC : 0.9813164989608619

Confusion Matrix
[[1006   86]
 [  80 1011]]
True label 0
0.9212454212454212  
0.07875457875457875  
True label 1
0.07332722273143905  
0.9266727772685609  

Train_result {'acc': [0.8966179293784059], 'loss': [0.2543035581328695]}
2

Epoch 1/1
 - 437s - loss: 0.1767 - acc: 0.9306

Test accuracy: 92.16674301420063

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  989

choose_one :  1194

F1score :  0.925164113785558

AUC : 0.9860261950087797

Confusion Matrix
[[ 955  137]
 [  34 1057]]
True label 0
0.8745421245421245  
0.12545787545787546  
True label 1
0.031164069660861594  
0.9688359303391384  

Train_result {'acc': [0.9306355536069134], 'loss': [0.17668293159234438]}
3

Epoch 1/1
 - 436s - loss: 0.1397 - acc: 0.9442

Test accuracy: 95.23591387998168

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1110

choose_one :  1073

F1score :  0.9519408502772642

AUC : 0.9904513451717851

Confusion Matrix
[[1049   43]
 [  61 1030]]
True label 0
0.9606227106227107  
0.039377289377289376  
True label 1
0.05591200733272227  
0.9440879926672777  

Train_result {'acc': [0.9441736818727313], 'loss': [0.1397384453456863]}
4

Epoch 1/1
 - 455s - loss: 0.1180 - acc: 0.9547

Test accuracy: 95.05267979844251

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1076

choose_one :  1107

F1score :  0.9508644222020017

AUC : 0.9926337029911733

Confusion Matrix
[[1030   62]
 [  46 1045]]
True label 0
0.9432234432234432  
0.056776556776556776  
True label 1
0.04216315307057745  
0.9578368469294225  

Train_result {'acc': [0.9546595776309375], 'loss': [0.11795480209909137]}
5

Epoch 1/1
 - 473s - loss: 0.0968 - acc: 0.9623

Test accuracy: 95.41914796152085

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1136

choose_one :  1047

F1score :  0.9532273152478953

AUC : 0.993522594118378

Confusion Matrix
[[1064   28]
 [  72 1019]]
True label 0
0.9743589743589743  
0.02564102564102564  
True label 1
0.06599450045829514  
0.9340054995417049  

Train_result {'acc': [0.962339388542488], 'loss': [0.09675932686346964]}
6

Epoch 1/1
 - 474s - loss: 0.0793 - acc: 0.9696

Test accuracy: 96.51855245075585

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1098

choose_one :  1085

F1score :  0.9650735294117647

AUC : 0.9950426902764208

Confusion Matrix
[[1057   35]
 [  41 1050]]
True label 0
0.967948717948718  
0.03205128205128205  
True label 1
0.03758020164986251  
0.9624197983501375  

Train_result {'acc': [0.9696253630415772], 'loss': [0.07929451051454468]}
7

Epoch 1/1
 - 446s - loss: 0.0687 - acc: 0.9726

Test accuracy: 96.93082913421897

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1103

choose_one :  1080

F1score :  0.9691386457853524

AUC : 0.9937618141101187

Confusion Matrix
[[1064   28]
 [  39 1052]]
True label 0
0.9743589743589743  
0.02564102564102564  
True label 1
0.035747021081576534  
0.9642529789184234  

Train_result {'acc': [0.972628366070989], 'loss': [0.06870627266100904]}
8

Epoch 1/1
 - 445s - loss: 0.0595 - acc: 0.9768

Test accuracy: 96.79340357306458

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1118

choose_one :  1065

F1score :  0.9675324675324676

AUC : 0.9952437190063222

Confusion Matrix
[[1070   22]
 [  48 1043]]
True label 0
0.9798534798534798  
0.020146520146520148  
True label 1
0.043996333638863426  
0.9560036663611365  

Train_result {'acc': [0.9767636488947964], 'loss': [0.05953584094191236]}
9

Epoch 1/1
 - 445s - loss: 0.0531 - acc: 0.9799

Test accuracy: 97.06825469537334

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1090

choose_one :  1093

F1score :  0.9706959706959707

AUC : 0.9952403615327539

Confusion Matrix
[[1059   33]
 [  31 1060]]
True label 0
0.9697802197802198  
0.03021978021978022  
True label 1
0.02841429880843263  
0.9715857011915674  

Train_result {'acc': [0.9798651109862432], 'loss': [0.05307479441452054]}
10

Epoch 1/1
 - 447s - loss: 0.0508 - acc: 0.9810

Test accuracy: 97.52633989922126

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1094

choose_one :  1089

F1score :  0.9752293577981651

AUC : 0.9958119714077551

Confusion Matrix
[[1066   26]
 [  28 1063]]
True label 0
0.9761904761904762  
0.023809523809523808  
True label 1
0.025664527956003668  
0.9743354720439963  

Train_result {'acc': [0.9810466203908826], 'loss': [0.050843255606350696]}
11

Epoch 1/1
 - 444s - loss: 0.0454 - acc: 0.9834

Test accuracy: 96.61016949152543

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1110

choose_one :  1073

F1score :  0.965804066543438

AUC : 0.9942079384105049

Confusion Matrix
[[1064   28]
 [  46 1045]]
True label 0
0.9743589743589743  
0.02564102564102564  
True label 1
0.04216315307057745  
0.9578368469294225  

Train_result {'acc': [0.9834096391209353], 'loss': [0.04544281812657707]}
12

Epoch 1/1
 - 445s - loss: 0.0423 - acc: 0.9847

Test accuracy: 97.57214841960604

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1095

choose_one :  1088

F1score :  0.9756769160165213

AUC : 0.9951207515368836

Confusion Matrix
[[1067   25]
 [  28 1063]]
True label 0
0.9771062271062271  
0.022893772893772892  
True label 1
0.025664527956003668  
0.9743354720439963  

Train_result {'acc': [0.9846896076404273], 'loss': [0.04234428533241626]}
13

Epoch 1/1
 - 444s - loss: 0.0405 - acc: 0.9848

Test accuracy: 96.83921209344938

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1061

choose_one :  1122

F1score :  0.9688206055128784

AUC : 0.9938839422111649

Confusion Matrix
[[1042   50]
 [  19 1072]]
True label 0
0.9542124542124543  
0.045787545787545784  
True label 1
0.017415215398716773  
0.9825847846012832  

Train_result {'acc': [0.9847880667288711], 'loss': [0.040469765057597314]}
14

Epoch 1/1
 - 444s - loss: 0.0384 - acc: 0.9860

Test accuracy: 97.70957398076042

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1098

choose_one :  1085

F1score :  0.9770220588235294

AUC : 0.9957078897271383

Confusion Matrix
[[1070   22]
 [  28 1063]]
True label 0
0.9798534798534798  
0.020146520146520148  
True label 1
0.025664527956003668  
0.9743354720439963  

Train_result {'acc': [0.9859695761335106], 'loss': [0.03836535401108444]}
15

Epoch 1/1
 - 444s - loss: 0.0360 - acc: 0.9861

Test accuracy: 97.52633989922126

data size :  22496

zero :  11249

one :  11247

train_zero :  10157

train_one :  10156

test_zero :  1092

test_one :  1091

choose_zero :  1078

choose_one :  1105

F1score :  0.9754098360655737

AUC : 0.994719113761277

Confusion Matrix
[[1058   34]
 [  20 1071]]
True label 0
0.9688644688644689  
0.031135531135531136  
True label 1
0.01833180568285976  
0.9816681943171403  

Train_result {'acc': [0.9860680352219543], 'loss': [0.03599865408926854]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 12:49:21.968389: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 12:49:21.974228: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 12:49:21.975788: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x70f6090 executing computations on platform Host. Devices:
2019-08-04 12:49:21.975808: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 49

Under 10 : 17243
Over 10, Under 200 : 28715
Over 200, Under 400 : 2031
Over 400 : 481

hbase-code
updated_train_data

Sentence length Average : 69

Under 10 : 0
Over 10, Under 200 : 25115
Over 200, Under 400 : 2063
Over 400 : 0


Test_zero:  2138
Train_zero:  19729
zero:  21867
Test_one:  868
Train_one:  7449
one:  8317

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 338s - loss: 0.4826 - acc: 0.7701

Test accuracy: 84.22567645365572

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  847

choose_one :  890

F1score :  0.844141069397042

AUC : 0.9135109480148271

Confusion Matrix
[[721 148]
 [126 742]]
True label 0
0.8296892980437284  
0.17031070195627157  
True label 1
0.14516129032258066  
0.8548387096774194  

Train_result {'loss': [0.4825801813700062], 'acc': [0.7700516813008911]}
2

Epoch 1/1
 - 340s - loss: 0.3760 - acc: 0.8363

Test accuracy: 86.9314910765688

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  922

choose_one :  815

F1score :  0.865121806298277

AUC : 0.9387584648915804

Confusion Matrix
[[782  87]
 [140 728]]
True label 0
0.8998849252013809  
0.1001150747986191  
True label 1
0.16129032258064516  
0.8387096774193549  

Train_result {'loss': [0.3759774758404666], 'acc': [0.8362977380712238]}
3

Epoch 1/1
 - 340s - loss: 0.3214 - acc: 0.8648

Test accuracy: 87.21934369602764

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  757

choose_one :  980

F1score :  0.8798701298701299

AUC : 0.9505827981736517

Confusion Matrix
[[702 167]
 [ 55 813]]
True label 0
0.807825086306099  
0.19217491369390102  
True label 1
0.06336405529953917  
0.9366359447004609  

Train_result {'loss': [0.3214495119483281], 'acc': [0.8648231425207888]}
4

Epoch 1/1
 - 339s - loss: 0.2885 - acc: 0.8802

Test accuracy: 88.54346574553828

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  902

choose_one :  835

F1score :  0.8831473869641808

AUC : 0.9561933574795969

Confusion Matrix
[[786  83]
 [116 752]]
True label 0
0.904487917146145  
0.09551208285385501  
True label 1
0.1336405529953917  
0.8663594470046083  

Train_result {'loss': [0.2884615785872042], 'acc': [0.8801933015438604]}
5

Epoch 1/1
 - 339s - loss: 0.2623 - acc: 0.8917

Test accuracy: 87.73747841105354

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  832

choose_one :  905

F1score :  0.8798646362098139

AUC : 0.9549763221670122

Confusion Matrix
[[744 125]
 [ 88 780]]
True label 0
0.856156501726122  
0.14384349827387802  
True label 1
0.10138248847926268  
0.8986175115207373  

Train_result {'loss': [0.2622721514387238], 'acc': [0.8917377005448173]}
6

Epoch 1/1
 - 340s - loss: 0.2360 - acc: 0.9015

Test accuracy: 89.23431203223949

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  820

choose_one :  917

F1score :  0.8952380952380953

AUC : 0.9611993763688333

Confusion Matrix
[[751 118]
 [ 69 799]]
True label 0
0.8642117376294591  
0.13578826237054084  
True label 1
0.07949308755760369  
0.9205069124423964  

Train_result {'loss': [0.2359810476595463], 'acc': [0.9014698973365483]}
7

Epoch 1/1
 - 340s - loss: 0.2040 - acc: 0.9164

Test accuracy: 87.4496257915947

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  955

choose_one :  782

F1score :  0.8678787878787878

AUC : 0.9567514967678299

Confusion Matrix
[[803  66]
 [152 716]]
True label 0
0.9240506329113924  
0.0759493670886076  
True label 1
0.17511520737327188  
0.8248847926267281  

Train_result {'loss': [0.2040322409679333], 'acc': [0.916437344824246]}
8

Epoch 1/1
 - 339s - loss: 0.1817 - acc: 0.9264

Test accuracy: 89.69487622337363

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  876

choose_one :  861

F1score :  0.8964719491035281

AUC : 0.9628684912474214

Confusion Matrix
[[783  86]
 [ 93 775]]
True label 0
0.9010356731875719  
0.09896432681242807  
True label 1
0.10714285714285714  
0.8928571428571429  

Train_result {'loss': [0.181685295605063], 'acc': [0.9264380160022305]}
9

Epoch 1/1
 - 340s - loss: 0.1573 - acc: 0.9356

Test accuracy: 88.88888888888889

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  798

choose_one :  939

F1score :  0.8931931377974544

AUC : 0.9637779533655401

Confusion Matrix
[[737 132]
 [ 61 807]]
True label 0
0.8481012658227848  
0.1518987341772152  
True label 1
0.07027649769585254  
0.9297235023041475  

Train_result {'loss': [0.15726726554337664], 'acc': [0.9356332639854493]}
10

Epoch 1/1
 - 339s - loss: 0.1373 - acc: 0.9464

Test accuracy: 89.00402993667242

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  884

choose_one :  853

F1score :  0.8890180127832656

AUC : 0.9573354881133566

Confusion Matrix
[[781  88]
 [103 765]]
True label 0
0.8987341772151899  
0.10126582278481013  
True label 1
0.11866359447004608  
0.881336405529954  

Train_result {'loss': [0.13734829491221254], 'acc': [0.9464393583261949]}
11

Epoch 1/1
 - 339s - loss: 0.1176 - acc: 0.9532

Test accuracy: 89.4070236039148

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  891

choose_one :  846

F1score :  0.8926487747957993

AUC : 0.9608507050320035

Confusion Matrix
[[788  81]
 [103 765]]
True label 0
0.906789413118527  
0.09321058688147296  
True label 1
0.11866359447004608  
0.881336405529954  

Train_result {'loss': [0.11762399430156627], 'acc': [0.9531512182105651]}
12

Epoch 1/1
 - 339s - loss: 0.0998 - acc: 0.9617

Test accuracy: 88.48589522164652

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  813

choose_one :  924

F1score :  0.8883928571428572

AUC : 0.9596058290423337

Confusion Matrix
[[741 128]
 [ 72 796]]
True label 0
0.8527042577675489  
0.1472957422324511  
True label 1
0.08294930875576037  
0.9170506912442397  

Train_result {'loss': [0.09984369477813088], 'acc': [0.9617423988467168]}
13

Epoch 1/1
 - 340s - loss: 0.0837 - acc: 0.9684

Test accuracy: 89.63730569948186

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  855

choose_one :  882

F1score :  0.8971428571428571

AUC : 0.9583881308564852

Confusion Matrix
[[772  97]
 [ 83 785]]
True label 0
0.8883774453394706  
0.11162255466052934  
True label 1
0.0956221198156682  
0.9043778801843319  

Train_result {'loss': [0.08374058846008016], 'acc': [0.9683871400765152]}
14

Epoch 1/1
 - 339s - loss: 0.0802 - acc: 0.9720

Test accuracy: 89.17674150834772

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  865

choose_one :  872

F1score :  0.8919540229885057

AUC : 0.9589250582002726

Confusion Matrix
[[773  96]
 [ 92 776]]
True label 0
0.8895281933256617  
0.11047180667433831  
True label 1
0.10599078341013825  
0.8940092165898618  

Train_result {'loss': [0.08020407481503967], 'acc': [0.9720115443789501]}
15

Epoch 1/1
 - 339s - loss: 0.0677 - acc: 0.9766

Test accuracy: 90.04029936672424

data size :  16636

zero :  8319

one :  8317

train_zero :  7450

train_one :  7449

test_zero :  869

test_one :  868

choose_zero :  898

choose_one :  839

F1score :  0.8986526069127124

AUC : 0.9624005027230833

Confusion Matrix
[[797  72]
 [101 767]]
True label 0
0.9171461449942463  
0.08285385500575373  
True label 1
0.11635944700460829  
0.8836405529953917  

Train_result {'loss': [0.0676647044107677], 'acc': [0.9765756091012819]}
Saved model to disk




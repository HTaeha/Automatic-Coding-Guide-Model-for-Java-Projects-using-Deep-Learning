Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 09:36:56.755274: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 09:36:56.765340: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 09:36:56.767665: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7125ea0 executing computations on platform Host. Devices:
2019-08-04 09:36:56.767708: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST
all data

Sentence length Average : 55

Under 10 : 5732
Over 10, Under 200 : 50810
Over 200, Under 400 : 1896
Over 400 : 292

guava-CAST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 45661
Over 200, Under 400 : 1886
Over 400 : 0


Test_zero:  4172
Train_zero:  37131
zero:  41303
Test_one:  1118
Train_one:  10416
one:  11534

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 472s - loss: 0.2736 - acc: 0.8953

Test accuracy: 92.80286097451945

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1164

choose_one :  1073

F1score :  0.9265175718849841

AUC : 0.9806289477091896

Confusion Matrix
[[1061   58]
 [ 103 1015]]
True label 0
0.9481680071492404  
0.05183199285075961  
True label 1
0.09212880143112702  
0.907871198568873  

Train_result {'loss': [0.2736367525184417], 'acc': [0.8952623241971872]}
2

Epoch 1/1
 - 468s - loss: 0.1814 - acc: 0.9304

Test accuracy: 92.89226642825213

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1234

choose_one :  1003

F1score :  0.9250353606789251

AUC : 0.9890707106555975

Confusion Matrix
[[1097   22]
 [ 137  981]]
True label 0
0.9803395889186773  
0.01966041108132261  
True label 1
0.12254025044722719  
0.8774597495527728  

Train_result {'loss': [0.1814432783691964], 'acc': [0.9303988863821822]}
3

Epoch 1/1
 - 468s - loss: 0.1435 - acc: 0.9463

Test accuracy: 94.68037550290568

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1108

choose_one :  1129

F1score :  0.9470404984423676

AUC : 0.9898644489953176

Confusion Matrix
[[1054   65]
 [  54 1064]]
True label 0
0.9419124218051832  
0.0580875781948168  
True label 1
0.04830053667262969  
0.9516994633273703  

Train_result {'loss': [0.14350825198253514], 'acc': [0.9463351413622618]}
4

Epoch 1/1
 - 469s - loss: 0.1146 - acc: 0.9583

Test accuracy: 95.70853822083147

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1159

choose_one :  1078

F1score :  0.9562841530054644

AUC : 0.9925494108111478

Confusion Matrix
[[1091   28]
 [  68 1050]]
True label 0
0.9749776586237712  
0.025022341376228777  
True label 1
0.06082289803220036  
0.9391771019677997  

Train_result {'loss': [0.11457412106707744], 'acc': [0.9582873325973216]}
5

Epoch 1/1
 - 469s - loss: 0.0952 - acc: 0.9641

Test accuracy: 96.11086276262853

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1124

choose_one :  1113

F1score :  0.9610040340654415

AUC : 0.9944366376188809

Confusion Matrix
[[1078   41]
 [  46 1072]]
True label 0
0.9633601429848079  
0.03663985701519214  
True label 1
0.04114490161001789  
0.9588550983899821  

Train_result {'loss': [0.09519858882085089], 'acc': [0.9641434262948207]}
6

Epoch 1/1
 - 469s - loss: 0.0805 - acc: 0.9706

Test accuracy: 96.5578900312919

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1094

choose_one :  1143

F1score :  0.9659442724458205

AUC : 0.9935689609141819

Confusion Matrix
[[1068   51]
 [  26 1092]]
True label 0
0.9544235924932976  
0.045576407506702415  
True label 1
0.023255813953488372  
0.9767441860465116  

Train_result {'loss': [0.08052895979598428], 'acc': [0.9705755292084673]}
7

Epoch 1/1
 - 470s - loss: 0.0700 - acc: 0.9760

Test accuracy: 95.57443004023244

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1174

choose_one :  1063

F1score :  0.9546079779917469

AUC : 0.9943223329032919

Confusion Matrix
[[1097   22]
 [  77 1041]]
True label 0
0.9803395889186773  
0.01966041108132261  
True label 1
0.06887298747763863  
0.9311270125223614  

Train_result {'loss': [0.06998437802540082], 'acc': [0.9759996159938559]}
8

Epoch 1/1
 - 469s - loss: 0.0650 - acc: 0.9786

Test accuracy: 96.91551184622263

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1128

choose_one :  1109

F1score :  0.9690166142792995

AUC : 0.9951208672450644

Confusion Matrix
[[1089   30]
 [  39 1079]]
True label 0
0.9731903485254692  
0.02680965147453083  
True label 1
0.03488372093023256  
0.9651162790697675  

Train_result {'loss': [0.06496228712533295], 'acc': [0.9785916574665194]}
9

Epoch 1/1
 - 470s - loss: 0.0560 - acc: 0.9794

Test accuracy: 97.04962002682164

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1095

choose_one :  1142

F1score :  0.9707964601769911

AUC : 0.9945549390028472

Confusion Matrix
[[1074   45]
 [  21 1097]]
True label 0
0.9597855227882037  
0.040214477211796246  
True label 1
0.018783542039355994  
0.981216457960644  

Train_result {'loss': [0.055972646766288665], 'acc': [0.9793596697547161]}
10

Epoch 1/1
 - 471s - loss: 0.0477 - acc: 0.9841

Test accuracy: 97.27313366115334

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1092

choose_one :  1145

F1score :  0.9730446310207689

AUC : 0.9955477114277539

Confusion Matrix
[[1075   44]
 [  17 1101]]
True label 0
0.9606791778373548  
0.03932082216264522  
True label 1
0.01520572450805009  
0.9847942754919499  

Train_result {'loss': [0.04772876020196787], 'acc': [0.9840637450199203]}
11

Epoch 1/1
 - 469s - loss: 0.0420 - acc: 0.9870

Test accuracy: 96.96021457308895

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1123

choose_one :  1114

F1score :  0.9695340501792115

AUC : 0.9956636148106939

Confusion Matrix
[[1087   32]
 [  36 1082]]
True label 0
0.9714030384271671  
0.028596961572832886  
True label 1
0.03220035778175313  
0.9677996422182469  

Train_result {'loss': [0.04201773588069787], 'acc': [0.9870397926366822]}
12

Epoch 1/1
 - 471s - loss: 0.0414 - acc: 0.9864

Test accuracy: 97.49664729548503

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1093

choose_one :  1144

F1score :  0.9752431476569406

AUC : 0.9962007670405949

Confusion Matrix
[[1078   41]
 [  15 1103]]
True label 0
0.9633601429848079  
0.03663985701519214  
True label 1
0.013416815742397137  
0.9865831842576028  

Train_result {'loss': [0.04136351469892475], 'acc': [0.9863677818845101]}
13

Epoch 1/1
 - 471s - loss: 0.0390 - acc: 0.9871

Test accuracy: 97.45194456861869

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1104

choose_one :  1133

F1score :  0.9746779209240337

AUC : 0.9934870292124485

Confusion Matrix
[[1083   36]
 [  21 1097]]
True label 0
0.967828418230563  
0.032171581769437  
True label 1
0.018783542039355994  
0.981216457960644  

Train_result {'loss': [0.03899466257212023], 'acc': [0.9870877934046944]}
14

Epoch 1/1
 - 471s - loss: 0.0358 - acc: 0.9891

Test accuracy: 97.54135002235135

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1108

choose_one :  1129

F1score :  0.975522919448153

AUC : 0.9942851638873835

Confusion Matrix
[[1086   33]
 [  22 1096]]
True label 0
0.9705093833780161  
0.029490616621983913  
True label 1
0.01967799642218247  
0.9803220035778175  

Train_result {'loss': [0.03578812689651402], 'acc': [0.9890558248931983]}
15

Epoch 1/1
 - 471s - loss: 0.0362 - acc: 0.9889

Test accuracy: 97.94367456414841

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1119

choose_one :  1118

F1score :  0.9794275491949911

AUC : 0.9956220494595704

Confusion Matrix
[[1096   23]
 [  23 1095]]
True label 0
0.9794459338695264  
0.020554066130473638  
True label 1
0.020572450805008944  
0.9794275491949911  

Train_result {'loss': [0.03620119108080258], 'acc': [0.9888638218211492]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 08:06:28.669752: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 08:06:28.676795: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 08:06:28.679068: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6691a10 executing computations on platform Host. Devices:
2019-08-04 08:06:28.679109: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 90

Under 10 : 0
Over 10, Under 200 : 31544
Over 200, Under 400 : 5147
Over 400 : 0


Test_zero:  3207
Train_zero:  29091
zero:  32298
Test_one:  896
Train_one:  7600
one:  8496

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 329s - loss: 0.4073 - acc: 0.8161

Test accuracy: 84.04907975460122

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  1045

choose_one :  748

F1score :  0.8260340632603406

AUC : 0.9347179089026915

Confusion Matrix
[[828  69]
 [217 679]]
True label 0
0.9230769230769231  
0.07692307692307693  
True label 1
0.2421875  
0.7578125  

Train_result {'loss': [0.40729031497871754], 'acc': [0.8161305177290967]}
2

Epoch 1/1
 - 329s - loss: 0.3156 - acc: 0.8647

Test accuracy: 86.27997769102063

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  959

choose_one :  834

F1score :  0.8578034682080925

AUC : 0.9447613075330465

Confusion Matrix
[[805  92]
 [154 742]]
True label 0
0.8974358974358975  
0.10256410256410256  
True label 1
0.171875  
0.828125  

Train_result {'loss': [0.3156399543026891], 'acc': [0.8647457404118151]}
3

Epoch 1/1
 - 329s - loss: 0.2902 - acc: 0.8794

Test accuracy: 87.78583379810374

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  858

choose_one :  935

F1score :  0.880393227744402

AUC : 0.9519827998088867

Confusion Matrix
[[768 129]
 [ 90 806]]
True label 0
0.8561872909698997  
0.14381270903010032  
True label 1
0.10044642857142858  
0.8995535714285714  

Train_result {'loss': [0.2902215427202758], 'acc': [0.8793500427603447]}
4

Epoch 1/1
 - 328s - loss: 0.2620 - acc: 0.8897

Test accuracy: 88.62242052426102

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  873

choose_one :  920

F1score :  0.8876651982378854

AUC : 0.9564041596989966

Confusion Matrix
[[783 114]
 [ 90 806]]
True label 0
0.8729096989966555  
0.12709030100334448  
True label 1
0.10044642857142858  
0.8995535714285714  

Train_result {'loss': [0.26195317444052557], 'acc': [0.8896783106374581]}
5

Epoch 1/1
 - 343s - loss: 0.2368 - acc: 0.9056

Test accuracy: 88.78973786949247

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  936

choose_one :  857

F1score :  0.8853394181403309

AUC : 0.955503961618092

Confusion Matrix
[[816  81]
 [120 776]]
True label 0
0.9096989966555183  
0.0903010033444816  
True label 1
0.13392857142857142  
0.8660714285714286  

Train_result {'loss': [0.23679052796573843], 'acc': [0.9055983159002697]}
6

Epoch 1/1
 - 352s - loss: 0.2101 - acc: 0.9153

Test accuracy: 87.73006134969326

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  977

choose_one :  816

F1score :  0.8714953271028038

AUC : 0.9573205327281414

Confusion Matrix
[[827  70]
 [150 746]]
True label 0
0.9219620958751393  
0.07803790412486064  
True label 1
0.16741071428571427  
0.8325892857142857  

Train_result {'loss': [0.21007379313702604], 'acc': [0.9152687323202421]}
7

Epoch 1/1
 - 353s - loss: 0.1904 - acc: 0.9258

Test accuracy: 88.62242052426102

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  951

choose_one :  842

F1score :  0.8826237054085154

AUC : 0.9597890786749481

Confusion Matrix
[[822  75]
 [129 767]]
True label 0
0.9163879598662207  
0.08361204013377926  
True label 1
0.14397321428571427  
0.8560267857142857  

Train_result {'loss': [0.1904344848423861], 'acc': [0.9257943556344977]}
8

Epoch 1/1
 - 352s - loss: 0.1657 - acc: 0.9357

Test accuracy: 89.18014500836587

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  885

choose_one :  908

F1score :  0.8924611973392461

AUC : 0.9593797280617933

Confusion Matrix
[[794 103]
 [ 91 805]]
True label 0
0.8851727982162765  
0.11482720178372352  
True label 1
0.1015625  
0.8984375  

Train_result {'loss': [0.1657185540567219], 'acc': [0.9356621274916124]}
9

Epoch 1/1
 - 353s - loss: 0.1447 - acc: 0.9463

Test accuracy: 88.51087562744004

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  839

choose_one :  954

F1score :  0.8886486486486487

AUC : 0.9593635531135531

Confusion Matrix
[[765 132]
 [ 74 822]]
True label 0
0.8528428093645485  
0.14715719063545152  
True label 1
0.08258928571428571  
0.9174107142857143  

Train_result {'loss': [0.14473210136584502], 'acc': [0.9463193210972962]}
10

Epoch 1/1
 - 352s - loss: 0.1224 - acc: 0.9551

Test accuracy: 89.90518683770217

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  910

choose_one :  883

F1score :  0.8982574480044969

AUC : 0.9613661361283643

Confusion Matrix
[[813  84]
 [ 97 799]]
True label 0
0.9063545150501672  
0.09364548494983277  
True label 1
0.10825892857142858  
0.8917410714285714  

Train_result {'loss': [0.12244948033563248], 'acc': [0.9551345306229854]}
11

Epoch 1/1
 - 354s - loss: 0.1009 - acc: 0.9624

Test accuracy: 88.73396542108199

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  901

choose_one :  892

F1score :  0.8870246085011185

AUC : 0.9571737139671922

Confusion Matrix
[[798  99]
 [103 793]]
True label 0
0.8896321070234113  
0.11036789297658862  
True label 1
0.11495535714285714  
0.8850446428571429  

Train_result {'loss': [0.10090849496403122], 'acc': [0.9623708966515361]}
12

Epoch 1/1
 - 353s - loss: 0.0880 - acc: 0.9674

Test accuracy: 89.51477969882879

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  897

choose_one :  896

F1score :  0.8950892857142857

AUC : 0.9590363214683868

Confusion Matrix
[[803  94]
 [ 94 802]]
True label 0
0.89520624303233  
0.10479375696767002  
True label 1
0.10491071428571429  
0.8950892857142857  

Train_result {'loss': [0.08803803813388576], 'acc': [0.9673705677258075]}
13

Epoch 1/1
 - 352s - loss: 0.0837 - acc: 0.9703

Test accuracy: 89.4590072504183

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  864

choose_one :  929

F1score :  0.8964383561643836

AUC : 0.9549745431199236

Confusion Matrix
[[786 111]
 [ 78 818]]
True label 0
0.8762541806020067  
0.12374581939799331  
True label 1
0.08705357142857142  
0.9129464285714286  

Train_result {'loss': [0.08370292522868018], 'acc': [0.9703308992829419]}
14

Epoch 1/1
 - 355s - loss: 0.0703 - acc: 0.9755

Test accuracy: 89.51477969882879

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  861

choose_one :  932

F1score :  0.8971553610503281

AUC : 0.9592186006927855

Confusion Matrix
[[785 112]
 [ 76 820]]
True label 0
0.875139353400223  
0.12486064659977704  
True label 1
0.08482142857142858  
0.9151785714285714  

Train_result {'loss': [0.07032163752737104], 'acc': [0.9755279257943557]}
15

Epoch 1/1
 - 339s - loss: 0.0637 - acc: 0.9780

Test accuracy: 89.4590072504183

data size :  16994

zero :  8498

one :  8496

train_zero :  7601

train_one :  7600

test_zero :  897

test_one :  896

choose_zero :  854

choose_one :  939

F1score :  0.8970027247956404

AUC : 0.9604199016563147

Confusion Matrix
[[781 116]
 [ 73 823]]
True label 0
0.8706800445930881  
0.12931995540691194  
True label 1
0.08147321428571429  
0.9185267857142857  

Train_result {'loss': [0.06368779840521771], 'acc': [0.9780277613314914]}
Saved model to disk




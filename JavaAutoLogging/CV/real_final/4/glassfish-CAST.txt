Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 11:39:06.302918: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 11:39:06.315658: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 11:39:06.318101: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5da5aa0 executing computations on platform Host. Devices:
2019-08-04 11:39:06.318145: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST
all data

Sentence length Average : 71

Under 10 : 9739
Over 10, Under 200 : 26001
Over 200, Under 400 : 2683
Over 400 : 1019

glassfish-CAST
updated_train_data

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 23121
Over 200, Under 400 : 3165
Over 400 : 0


Test_zero:  2276
Train_zero:  20354
zero:  22630
Test_one:  634
Train_one:  5932
one:  6566

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 260s - loss: 0.4625 - acc: 0.7915

Test accuracy: 83.29393223010244

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  753

choose_one :  516

F1score :  0.8156521739130435

AUC : 0.9169663926078642

Confusion Matrix
[[588  47]
 [165 469]]
True label 0
0.925984251968504  
0.07401574803149606  
True label 1
0.26025236593059936  
0.7397476340694006  

Train_result {'loss': [0.4624861148417976], 'acc': [0.7914875685138839]}
2

Epoch 1/1
 - 259s - loss: 0.3456 - acc: 0.8582

Test accuracy: 88.49487785657998

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  615

choose_one :  654

F1score :  0.8866459627329191

AUC : 0.9482413870190517

Confusion Matrix
[[552  83]
 [ 63 571]]
True label 0
0.8692913385826772  
0.13070866141732285  
True label 1
0.09936908517350158  
0.9006309148264984  

Train_result {'loss': [0.3455657413362], 'acc': [0.8581542351353384]}
3

Epoch 1/1
 - 265s - loss: 0.2897 - acc: 0.8820

Test accuracy: 87.70685579196218

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  589

choose_one :  680

F1score :  0.8812785388127854

AUC : 0.9563861496808167

Confusion Matrix
[[534 101]
 [ 55 579]]
True label 0
0.8409448818897638  
0.15905511811023623  
True label 1
0.08675078864353312  
0.9132492113564669  

Train_result {'loss': [0.2897058357763682], 'acc': [0.8820058996598026]}
4

Epoch 1/1
 - 269s - loss: 0.2520 - acc: 0.8963

Test accuracy: 87.78565799842396

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  612

choose_one :  657

F1score :  0.8799380325329201

AUC : 0.9476676022752676

Confusion Matrix
[[546  89]
 [ 66 568]]
True label 0
0.8598425196850393  
0.14015748031496064  
True label 1
0.10410094637223975  
0.8958990536277602  

Train_result {'loss': [0.25202728525727197], 'acc': [0.8963337546855751]}
5

Epoch 1/1
 - 269s - loss: 0.2253 - acc: 0.9110

Test accuracy: 89.75571315996848

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  653

choose_one :  616

F1score :  0.8959999999999999

AUC : 0.9644042325939541

Confusion Matrix
[[579  56]
 [ 74 560]]
True label 0
0.9118110236220472  
0.08818897637795275  
True label 1
0.1167192429022082  
0.8832807570977917  

Train_result {'loss': [0.22526728410008484], 'acc': [0.9109987358126618]}
6

Epoch 1/1
 - 271s - loss: 0.1932 - acc: 0.9240

Test accuracy: 90.9377462568952

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  656

choose_one :  613

F1score :  0.9077786688051322

AUC : 0.9661181350753868

Confusion Matrix
[[588  47]
 [ 68 566]]
True label 0
0.925984251968504  
0.07401574803149606  
True label 1
0.10725552050473186  
0.8927444794952681  

Train_result {'loss': [0.19319687984032918], 'acc': [0.9239780867998981]}
7

Epoch 1/1
 - 269s - loss: 0.1713 - acc: 0.9349

Test accuracy: 90.9377462568952

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  650

choose_one :  619

F1score :  0.9082202713487629

AUC : 0.9631945651903923

Confusion Matrix
[[585  50]
 [ 65 569]]
True label 0
0.9212598425196851  
0.07874015748031496  
True label 1
0.10252365930599369  
0.8974763406940063  

Train_result {'loss': [0.17127243346659082], 'acc': [0.9349346818373367]}
8

Epoch 1/1
 - 270s - loss: 0.1538 - acc: 0.9413

Test accuracy: 90.9377462568952

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  606

choose_one :  663

F1score :  0.9113338473400155

AUC : 0.9646749795076877

Confusion Matrix
[[563  72]
 [ 43 591]]
True label 0
0.8866141732283465  
0.11338582677165354  
True label 1
0.06782334384858044  
0.9321766561514195  

Train_result {'loss': [0.1537614162855896], 'acc': [0.9413400758533502]}
9

Epoch 1/1
 - 270s - loss: 0.1348 - acc: 0.9540

Test accuracy: 90.4649330181245

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  678

choose_one :  591

F1score :  0.9012244897959183

AUC : 0.964108646513823

Confusion Matrix
[[596  39]
 [ 82 552]]
True label 0
0.9385826771653544  
0.06141732283464567  
True label 1
0.12933753943217666  
0.8706624605678234  

Train_result {'loss': [0.1347813278059893], 'acc': [0.9539823009201207]}
10

Epoch 1/1
 - 270s - loss: 0.1071 - acc: 0.9600

Test accuracy: 90.78014184397163

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  608

choose_one :  661

F1score :  0.9096525096525098

AUC : 0.9626009091134902

Confusion Matrix
[[563  72]
 [ 45 589]]
True label 0
0.8866141732283465  
0.11338582677165354  
True label 1
0.07097791798107256  
0.9290220820189274  

Train_result {'loss': [0.10706825563790072], 'acc': [0.9599662873547036]}
11

Epoch 1/1
 - 269s - loss: 0.0947 - acc: 0.9660

Test accuracy: 91.33175728920409

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  635

choose_one :  634

F1score :  0.9132492113564669

AUC : 0.9662373630740951

Confusion Matrix
[[580  55]
 [ 55 579]]
True label 0
0.9133858267716536  
0.08661417322834646  
True label 1
0.08675078864353312  
0.9132492113564669  

Train_result {'loss': [0.09470773404797722], 'acc': [0.9659502739148756]}
12

Epoch 1/1
 - 274s - loss: 0.0863 - acc: 0.9702

Test accuracy: 90.85894405043341

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  647

choose_one :  622

F1score :  0.9076433121019107

AUC : 0.9654002831664968

Confusion Matrix
[[583  52]
 [ 64 570]]
True label 0
0.9181102362204724  
0.08188976377952756  
True label 1
0.10094637223974763  
0.8990536277602523  

Train_result {'loss': [0.08630006195615476], 'acc': [0.9701643489153637]}
13

Epoch 1/1
 - 274s - loss: 0.0748 - acc: 0.9746

Test accuracy: 91.09535066981876

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  644

choose_one :  625

F1score :  0.9102462271644162

AUC : 0.960636131051442

Confusion Matrix
[[583  52]
 [ 61 573]]
True label 0
0.9181102362204724  
0.08188976377952756  
True label 1
0.09621451104100946  
0.9037854889589906  

Train_result {'loss': [0.0747754315587033], 'acc': [0.9746312684365782]}
14

Epoch 1/1
 - 274s - loss: 0.0723 - acc: 0.9756

Test accuracy: 91.56816390858944

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  650

choose_one :  619

F1score :  0.9146049481245013

AUC : 0.9686790531309768

Confusion Matrix
[[589  46]
 [ 61 573]]
True label 0
0.9275590551181102  
0.07244094488188976  
True label 1
0.09621451104100946  
0.9037854889589906  

Train_result {'loss': [0.07226062649427303], 'acc': [0.9756426464391066]}
15

Epoch 1/1
 - 274s - loss: 0.0587 - acc: 0.9808

Test accuracy: 91.17415287628053

data size :  13134

zero :  6568

one :  6566

train_zero :  5933

train_one :  5932

test_zero :  635

test_one :  634

choose_zero :  635

choose_one :  634

F1score :  0.9116719242902208

AUC : 0.9657790804540599

Confusion Matrix
[[579  56]
 [ 56 578]]
True label 0
0.9118110236220472  
0.08818897637795275  
True label 1
0.08832807570977919  
0.9116719242902208  

Train_result {'loss': [0.05872532354861661], 'acc': [0.9807838179419124]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 22:39:44.006039: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 22:39:44.017782: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 22:39:44.020446: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xdd171a0 executing computations on platform Host. Devices:
2019-08-04 22:39:44.020487: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
31687
one : 
7755

Second data
zero : 
31687
one : 
7755

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15242
Over 200, Under 400 : 620
Over 400 : 0


glassfish-code

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 14755
Over 200, Under 400 : 1107
Over 400 : 0


Test_zero:  1183
Train_zero:  10634
zero:  11817
Test_one:  555
Train_one:  5228
one:  5783
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 404s - loss: 0.5544 - acc: 0.7340

Test accuracy: 74.97749774977498

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  794

choose_one :  317

F1score :  0.6811926605504587

AUC : 0.8934214790329899

Confusion Matrix
[[536  20]
 [258 297]]
True label 0
0.9640287769784173  
0.03597122302158273  
True label 1
0.4648648648648649  
0.5351351351351351  

Train_result {'acc': [0.7339581142502875], 'loss': [0.5544327005859405]}
2

Epoch 1/1
 - 401s - loss: 0.4113 - acc: 0.8190

Test accuracy: 87.03870387038704

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  516

choose_one :  595

F1score :  0.8747826086956522

AUC : 0.9329574178495043

Confusion Matrix
[[464  92]
 [ 52 503]]
True label 0
0.8345323741007195  
0.16546762589928057  
True label 1
0.0936936936936937  
0.9063063063063063  

Train_result {'acc': [0.8189729368571537], 'loss': [0.4113263538773639]}
3

Epoch 1/1
 - 408s - loss: 0.3584 - acc: 0.8476

Test accuracy: 87.21872187218722

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  562

choose_one :  549

F1score :  0.8713768115942029

AUC : 0.9405923909521032

Confusion Matrix
[[488  68]
 [ 74 481]]
True label 0
0.8776978417266187  
0.1223021582733813  
True label 1
0.13333333333333333  
0.8666666666666667  

Train_result {'acc': [0.8475662235309896], 'loss': [0.358420486290938]}
4

Epoch 1/1
 - 409s - loss: 0.3193 - acc: 0.8653

Test accuracy: 88.38883888388838

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  609

choose_one :  502

F1score :  0.8779564806054873

AUC : 0.9514258863179725

Confusion Matrix
[[518  38]
 [ 91 464]]
True label 0
0.9316546762589928  
0.0683453237410072  
True label 1
0.16396396396396395  
0.836036036036036  

Train_result {'acc': [0.865257722037329], 'loss': [0.3192977211956906]}
5

Epoch 1/1
 - 410s - loss: 0.2796 - acc: 0.8870

Test accuracy: 88.02880288028803

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  573

choose_one :  538

F1score :  0.8783165599268069

AUC : 0.9535096247326463

Confusion Matrix
[[498  58]
 [ 75 480]]
True label 0
0.89568345323741  
0.10431654676258993  
True label 1
0.13513513513513514  
0.8648648648648649  

Train_result {'acc': [0.8869656689698032], 'loss': [0.2795811336720162]}
6

Epoch 1/1
 - 410s - loss: 0.2458 - acc: 0.8993

Test accuracy: 87.48874887488749

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  631

choose_one :  480

F1score :  0.8657004830917875

AUC : 0.9577840430358416

Confusion Matrix
[[524  32]
 [107 448]]
True label 0
0.9424460431654677  
0.05755395683453238  
True label 1
0.1927927927927928  
0.8072072072072072  

Train_result {'acc': [0.8993019029801624], 'loss': [0.24584510325359502]}
7

Epoch 1/1
 - 409s - loss: 0.2225 - acc: 0.9146

Test accuracy: 88.02880288028803

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  537

choose_one :  574

F1score :  0.8821966341895483

AUC : 0.9525633547216281

Confusion Matrix
[[480  76]
 [ 57 498]]
True label 0
0.8633093525179856  
0.1366906474820144  
True label 1
0.10270270270270271  
0.8972972972972973  

Train_result {'acc': [0.9146026585461636], 'loss': [0.2225204890814226]}
8

Epoch 1/1
 - 409s - loss: 0.1983 - acc: 0.9229

Test accuracy: 89.91899189918992

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  538

choose_one :  573

F1score :  0.900709219858156

AUC : 0.9574599779635751

Confusion Matrix
[[491  65]
 [ 47 508]]
True label 0
0.8830935251798561  
0.11690647482014388  
True label 1
0.08468468468468468  
0.9153153153153153  

Train_result {'acc': [0.9229224442443873], 'loss': [0.1983444150674408]}
9

Epoch 1/1
 - 410s - loss: 0.1777 - acc: 0.9314

Test accuracy: 89.73897389738974

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  560

choose_one :  551

F1score :  0.8969258589511755

AUC : 0.9563711193207597

Confusion Matrix
[[501  55]
 [ 59 496]]
True label 0
0.9010791366906474  
0.09892086330935251  
True label 1
0.1063063063063063  
0.8936936936936937  

Train_result {'acc': [0.9314334895684453], 'loss': [0.17769301466610324]}
10

Epoch 1/1
 - 410s - loss: 0.1487 - acc: 0.9432

Test accuracy: 89.10891089108911

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  549

choose_one :  562

F1score :  0.891674127126231

AUC : 0.9563792209475662

Confusion Matrix
[[492  64]
 [ 57 498]]
True label 0
0.8848920863309353  
0.11510791366906475  
True label 1
0.10270270270270271  
0.8972972972972973  

Train_result {'acc': [0.943195945339699], 'loss': [0.14873971550320078]}
11

Epoch 1/1
 - 410s - loss: 0.1338 - acc: 0.9525

Test accuracy: 89.46894689468947

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  565

choose_one :  546

F1score :  0.8937329700272478

AUC : 0.9605013286667964

Confusion Matrix
[[502  54]
 [ 63 492]]
True label 0
0.9028776978417267  
0.09712230215827339  
True label 1
0.11351351351351352  
0.8864864864864865  

Train_result {'acc': [0.9524720282550978], 'loss': [0.13383659680806007]}
12

Epoch 1/1
 - 410s - loss: 0.1159 - acc: 0.9568

Test accuracy: 89.64896489648964

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  545

choose_one :  566

F1score :  0.8974130240856377

AUC : 0.9632250955991962

Confusion Matrix
[[493  63]
 [ 52 503]]
True label 0
0.8866906474820144  
0.11330935251798561  
True label 1
0.0936936936936937  
0.9063063063063063  

Train_result {'acc': [0.9567753657722856], 'loss': [0.11586995299435647]}
13

Epoch 1/1
 - 409s - loss: 0.1025 - acc: 0.9640

Test accuracy: 91.17911791179118

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  602

choose_one :  509

F1score :  0.9078947368421052

AUC : 0.9623339166504634

Confusion Matrix
[[530  26]
 [ 72 483]]
True label 0
0.9532374100719424  
0.046762589928057555  
True label 1
0.12972972972972974  
0.8702702702702703  

Train_result {'acc': [0.9640432245829166], 'loss': [0.102536009457698]}
14

Epoch 1/1
 - 410s - loss: 0.0879 - acc: 0.9686

Test accuracy: 89.73897389738974

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  568

choose_one :  543

F1score :  0.8961748633879781

AUC : 0.9610311750599521

Confusion Matrix
[[505  51]
 [ 63 492]]
True label 0
0.908273381294964  
0.09172661870503597  
True label 1
0.11351351351351352  
0.8864864864864865  

Train_result {'acc': [0.968633451225357], 'loss': [0.08785999680957364]}
15

Epoch 1/1
 - 410s - loss: 0.0789 - acc: 0.9728

Test accuracy: 90.72907290729073

data size :  11568

zero :  5785

one :  5783

train_zero :  5229

train_one :  5228

test_zero :  556

test_one :  555

choose_zero :  565

choose_one :  546

F1score :  0.9064486830154405

AUC : 0.9640854883660641

Confusion Matrix
[[509  47]
 [ 56 499]]
True label 0
0.9154676258992805  
0.08453237410071943  
True label 1
0.1009009009009009  
0.8990990990990991  

Train_result {'acc': [0.9728411590322272], 'loss': [0.0789166982633466]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 20:17:52.197241: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 20:17:52.208850: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 20:17:52.211236: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5f942b0 executing computations on platform Host. Devices:
2019-08-04 20:17:52.211265: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22707
Over 200, Under 400 : 1157
Over 400 : 0


hbase-code

Sentence length Average : 76

Under 10 : 0
Over 10, Under 200 : 21819
Over 200, Under 400 : 2045
Over 400 : 0


Test_zero:  1829
Train_zero:  16749
zero:  18578
Test_one:  843
Train_one:  7115
one:  7958
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 545s - loss: 0.4889 - acc: 0.7683

Test accuracy: 82.09839952578541

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  820

choose_one :  867

F1score :  0.8233918128654971

AUC : 0.9119076532132477

Confusion Matrix
[[681 163]
 [139 704]]
True label 0
0.806872037914692  
0.19312796208530805  
True label 1
0.16488730723606168  
0.8351126927639383  

Train_result {'acc': [0.7682524067219173], 'loss': [0.4889060564574233]}
2

Epoch 1/1
 - 542s - loss: 0.3872 - acc: 0.8227

Test accuracy: 83.10610551274452

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  793

choose_one :  894

F1score :  0.835924006908463

AUC : 0.9202380350025018

Confusion Matrix
[[676 168]
 [117 726]]
True label 0
0.8009478672985783  
0.1990521327014218  
True label 1
0.1387900355871886  
0.8612099644128114  

Train_result {'acc': [0.8227109830986464], 'loss': [0.38717593553069435]}
3

Epoch 1/1
 - 543s - loss: 0.3496 - acc: 0.8464

Test accuracy: 85.24007113218731

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  753

choose_one :  934

F1score :  0.8598761958356781

AUC : 0.9313625451867344

Confusion Matrix
[[674 170]
 [ 79 764]]
True label 0
0.7985781990521327  
0.2014218009478673  
True label 1
0.0937129300118624  
0.9062870699881376  

Train_result {'acc': [0.8463916801516702], 'loss': [0.34962844972608464]}
4

Epoch 1/1
 - 543s - loss: 0.3172 - acc: 0.8621

Test accuracy: 86.54416123295792

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  799

choose_one :  888

F1score :  0.8688619295205083

AUC : 0.9365727232351173

Confusion Matrix
[[708 136]
 [ 91 752]]
True label 0
0.8388625592417062  
0.16113744075829384  
True label 1
0.10794780545670225  
0.8920521945432978  

Train_result {'acc': [0.8621319653815156], 'loss': [0.31722524232325255]}
5

Epoch 1/1
 - 542s - loss: 0.2832 - acc: 0.8770

Test accuracy: 87.37403675163011

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  871

choose_one :  816

F1score :  0.8716094032549728

AUC : 0.9483367346365104

Confusion Matrix
[[751  93]
 [120 723]]
True label 0
0.8898104265402843  
0.11018957345971564  
True label 1
0.1423487544483986  
0.8576512455516014  

Train_result {'acc': [0.8770290211216898], 'loss': [0.2832364472298484]}
6

Epoch 1/1
 - 543s - loss: 0.2506 - acc: 0.8940

Test accuracy: 88.38174273858921

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  876

choose_one :  811

F1score :  0.8814993954050786

AUC : 0.9505363377241065

Confusion Matrix
[[762  82]
 [114 729]]
True label 0
0.9028436018957346  
0.0971563981042654  
True label 1
0.13523131672597866  
0.8647686832740213  

Train_result {'acc': [0.8939638816835372], 'loss': [0.2506179421141196]}
7

Epoch 1/1
 - 542s - loss: 0.2279 - acc: 0.9074

Test accuracy: 88.44101956135151

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  779

choose_one :  908

F1score :  0.8886350656767561

AUC : 0.9541231665289279

Confusion Matrix
[[714 130]
 [ 65 778]]
True label 0
0.8459715639810427  
0.15402843601895735  
True label 1
0.0771055753262159  
0.9228944246737841  

Train_result {'acc': [0.9073852856775235], 'loss': [0.22789505651407455]}
8

Epoch 1/1
 - 542s - loss: 0.1999 - acc: 0.9205

Test accuracy: 89.38944872554832

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  857

choose_one :  830

F1score :  0.8930065750149433

AUC : 0.957355810044245

Confusion Matrix
[[761  83]
 [ 96 747]]
True label 0
0.9016587677725119  
0.09834123222748815  
True label 1
0.11387900355871886  
0.8861209964412812  

Train_result {'acc': [0.9205256131149194], 'loss': [0.1999138167177573]}
9

Epoch 1/1
 - 543s - loss: 0.1753 - acc: 0.9306

Test accuracy: 88.67812685240071

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  885

choose_one :  802

F1score :  0.8838905775075988

AUC : 0.955063444142731

Confusion Matrix
[[769  75]
 [116 727]]
True label 0
0.9111374407582938  
0.08886255924170616  
True label 1
0.1376037959667853  
0.8623962040332147  

Train_result {'acc': [0.9305740987523259], 'loss': [0.17533074583020317]}
10

Epoch 1/1
 - 542s - loss: 0.1541 - acc: 0.9406

Test accuracy: 89.09306461173682

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  836

choose_one :  851

F1score :  0.8913813459268005

AUC : 0.9546923928870598

Confusion Matrix
[[748  96]
 [ 88 755]]
True label 0
0.8862559241706162  
0.11374407582938388  
True label 1
0.10438908659549229  
0.8956109134045077  

Train_result {'acc': [0.9405523153217868], 'loss': [0.15414350211105163]}
11

Epoch 1/1
 - 543s - loss: 0.1288 - acc: 0.9509

Test accuracy: 89.27089508002372

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  819

choose_one :  868

F1score :  0.8942139099941555

AUC : 0.9544471336290499

Confusion Matrix
[[741 103]
 [ 78 765]]
True label 0
0.8779620853080569  
0.12203791469194313  
True label 1
0.09252669039145907  
0.9074733096085409  

Train_result {'acc': [0.9508818776079276], 'loss': [0.1287933580761138]}
12

Epoch 1/1
 - 543s - loss: 0.1095 - acc: 0.9602

Test accuracy: 88.20391227030231

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  831

choose_one :  856

F1score :  0.8828722778104767

AUC : 0.9522369893125995

Confusion Matrix
[[738 106]
 [ 93 750]]
True label 0
0.8744075829383886  
0.12559241706161137  
True label 1
0.1103202846975089  
0.8896797153024911  

Train_result {'acc': [0.9601574028696802], 'loss': [0.10950965549649964]}
13

Epoch 1/1
 - 544s - loss: 0.0963 - acc: 0.9648

Test accuracy: 87.61114404267931

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  773

choose_one :  914

F1score :  0.8810472396129767

AUC : 0.9514555328802012

Confusion Matrix
[[704 140]
 [ 69 774]]
True label 0
0.8341232227488151  
0.16587677725118483  
True label 1
0.08185053380782918  
0.9181494661921709  

Train_result {'acc': [0.9647951655173099], 'loss': [0.09625612342954373]}
14

Epoch 1/1
 - 543s - loss: 0.0819 - acc: 0.9708

Test accuracy: 88.44101956135151

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  811

choose_one :  876

F1score :  0.8865619546247818

AUC : 0.9544302676628832

Confusion Matrix
[[730 114]
 [ 81 762]]
True label 0
0.8649289099526066  
0.13507109004739337  
True label 1
0.09608540925266904  
0.9039145907473309  

Train_result {'acc': [0.9707680415993254], 'loss': [0.08187874970814578]}
15

Epoch 1/1
 - 552s - loss: 0.0742 - acc: 0.9732

Test accuracy: 88.73740367516301

data size :  15918

zero :  7960

one :  7958

train_zero :  7116

train_one :  7115

test_zero :  844

test_one :  843

choose_zero :  840

choose_one :  847

F1score :  0.8875739644970414

AUC : 0.9536705964367835

Confusion Matrix
[[747  97]
 [ 93 750]]
True label 0
0.8850710900473934  
0.11492890995260663  
True label 1
0.1103202846975089  
0.8896797153024911  

Train_result {'acc': [0.9732274611763052], 'loss': [0.074161465810568]}
Saved model to disk




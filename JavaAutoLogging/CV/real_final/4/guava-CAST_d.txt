Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-05 00:26:56.536853: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-05 00:26:56.546825: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-05 00:26:56.549165: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xc402bf0 executing computations on platform Host. Devices:
2019-08-05 00:26:56.549205: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
44755
one : 
13975

Second data
zero : 
44755
one : 
13975

guava-AST

Sentence length Average : 30

Under 10 : 0
Over 10, Under 200 : 30920
Over 200, Under 400 : 116
Over 400 : 0


guava-code

Sentence length Average : 42

Under 10 : 0
Over 10, Under 200 : 30621
Over 200, Under 400 : 415
Over 400 : 0


Test_zero:  2473
Train_zero:  21860
zero:  24333
Test_one:  1000
Train_one:  9176
one:  10176
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 833s - loss: 0.3206 - acc: 0.8618

Test accuracy: 90.35482258870566

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  952

choose_one :  1049

F1score :  0.9058077110785749

AUC : 0.9715784215784216

Confusion Matrix
[[880 121]
 [ 72 928]]
True label 0
0.8791208791208791  
0.12087912087912088  
True label 1
0.072  
0.928  

Train_result {'loss': [0.3205744038094281], 'acc': [0.8618209557020651]}
2

Epoch 1/1
 - 831s - loss: 0.2025 - acc: 0.9156

Test accuracy: 91.80409795102449

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  1059

choose_one :  942

F1score :  0.9155509783728116

AUC : 0.9810859140859141

Confusion Matrix
[[948  53]
 [111 889]]
True label 0
0.9470529470529471  
0.052947052947052944  
True label 1
0.111  
0.889  

Train_result {'loss': [0.2025409830446004], 'acc': [0.9155996294948624]}
3

Epoch 1/1
 - 832s - loss: 0.1631 - acc: 0.9332

Test accuracy: 93.85307346326837

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  1072

choose_one :  929

F1score :  0.9362363919129083

AUC : 0.988084915084915

Confusion Matrix
[[975  26]
 [ 97 903]]
True label 0
0.974025974025974  
0.025974025974025976  
True label 1
0.097  
0.903  

Train_result {'loss': [0.16307742574773795], 'acc': [0.9331989320579527]}
4

Epoch 1/1
 - 831s - loss: 0.1325 - acc: 0.9473

Test accuracy: 95.15242378810595

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  1034

choose_one :  967

F1score :  0.9506863243518048

AUC : 0.9901728271728272

Confusion Matrix
[[969  32]
 [ 65 935]]
True label 0
0.968031968031968  
0.03196803196803197  
True label 1
0.065  
0.935  

Train_result {'loss': [0.13254374500498234], 'acc': [0.947311066310685]}
5

Epoch 1/1
 - 840s - loss: 0.1109 - acc: 0.9559

Test accuracy: 95.60219890054972

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  963

choose_one :  1038

F1score :  0.9568204121687929

AUC : 0.9921933066933066

Confusion Matrix
[[938  63]
 [ 25 975]]
True label 0
0.9370629370629371  
0.06293706293706294  
True label 1
0.025  
0.975  

Train_result {'loss': [0.11089543347081872], 'acc': [0.9558655260752795]}
6

Epoch 1/1
 - 837s - loss: 0.0873 - acc: 0.9679

Test accuracy: 95.95202398800599

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  986

choose_one :  1015

F1score :  0.9598014888337467

AUC : 0.9921468531468531

Confusion Matrix
[[953  48]
 [ 33 967]]
True label 0
0.952047952047952  
0.04795204795204795  
True label 1
0.033  
0.967  

Train_result {'loss': [0.08727108890677669], 'acc': [0.9678526671388874]}
7

Epoch 1/1
 - 844s - loss: 0.0723 - acc: 0.9725

Test accuracy: 96.7016491754123

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  995

choose_one :  1006

F1score :  0.967098703888335

AUC : 0.9933706293706294

Confusion Matrix
[[965  36]
 [ 30 970]]
True label 0
0.964035964035964  
0.03596403596403597  
True label 1
0.03  
0.97  

Train_result {'loss': [0.07233346690923269], 'acc': [0.9725385495559309]}
8

Epoch 1/1
 - 857s - loss: 0.0642 - acc: 0.9773

Test accuracy: 96.20189905047476

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  1021

choose_one :  980

F1score :  0.9616161616161616

AUC : 0.9928101898101899

Confusion Matrix
[[973  28]
 [ 48 952]]
True label 0
0.972027972027972  
0.027972027972027972  
True label 1
0.048  
0.952  

Train_result {'loss': [0.06416594664800813], 'acc': [0.9772789189810714]}
9

Epoch 1/1
 - 840s - loss: 0.0520 - acc: 0.9819

Test accuracy: 96.65167416291854

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  962

choose_one :  1039

F1score :  0.9671407552721922

AUC : 0.9927207792207793

Confusion Matrix
[[948  53]
 [ 14 986]]
True label 0
0.9470529470529471  
0.052947052947052944  
True label 1
0.014  
0.986  

Train_result {'loss': [0.05204094920746798], 'acc': [0.9818558273884164]}
10

Epoch 1/1
 - 837s - loss: 0.0400 - acc: 0.9860

Test accuracy: 97.35132433783107

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  1016

choose_one :  985

F1score :  0.9732997481108312

AUC : 0.9940274725274725

Confusion Matrix
[[982  19]
 [ 34 966]]
True label 0
0.981018981018981  
0.01898101898101898  
True label 1
0.034  
0.966  

Train_result {'loss': [0.03999393561355679], 'acc': [0.9859968397537188]}
11

Epoch 1/1
 - 838s - loss: 0.0404 - acc: 0.9874

Test accuracy: 97.65117441279361

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  984

choose_one :  1017

F1score :  0.9766980664352999

AUC : 0.993670829170829

Confusion Matrix
[[969  32]
 [ 15 985]]
True label 0
0.968031968031968  
0.03196803196803197  
True label 1
0.015  
0.985  

Train_result {'loss': [0.040426966125534994], 'acc': [0.9873590148749524]}
12

Epoch 1/1
 - 836s - loss: 0.0336 - acc: 0.9899

Test accuracy: 97.80109945027486

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  981

choose_one :  1020

F1score :  0.9782178217821782

AUC : 0.9951338661338662

Confusion Matrix
[[969  32]
 [ 12 988]]
True label 0
0.968031968031968  
0.03196803196803197  
True label 1
0.012  
0.988  

Train_result {'loss': [0.03360545455466263], 'acc': [0.9899199041028715]}
13

Epoch 1/1
 - 836s - loss: 0.0291 - acc: 0.9914

Test accuracy: 98.00099950024988

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  995

choose_one :  1006

F1score :  0.9800598205383848

AUC : 0.9936288711288712

Confusion Matrix
[[978  23]
 [ 17 983]]
True label 0
0.977022977022977  
0.022977022977022976  
True label 1
0.017  
0.983  

Train_result {'loss': [0.029141816253809242], 'acc': [0.9914455402386531]}
14

Epoch 1/1
 - 836s - loss: 0.0282 - acc: 0.9913

Test accuracy: 97.70114942528735

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  993

choose_one :  1008

F1score :  0.9770916334661355

AUC : 0.9943176823176821

Confusion Matrix
[[974  27]
 [ 19 981]]
True label 0
0.973026973026973  
0.026973026973026972  
True label 1
0.019  
0.981  

Train_result {'loss': [0.02821453662551622], 'acc': [0.991282079224105]}
15

Epoch 1/1
 - 836s - loss: 0.0247 - acc: 0.9920

Test accuracy: 97.80109945027486

data size :  20354

zero :  10178

one :  10176

train_zero :  9177

train_one :  9176

test_zero :  1001

test_one :  1000

choose_zero :  997

choose_one :  1004

F1score :  0.9780439121756487

AUC : 0.9934310689310689

Confusion Matrix
[[977  24]
 [ 20 980]]
True label 0
0.9760239760239761  
0.023976023976023976  
True label 1
0.02  
0.98  

Train_result {'loss': [0.02471683739235493], 'acc': [0.9919904102871465]}
Saved model to disk




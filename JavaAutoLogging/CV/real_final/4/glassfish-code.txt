Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 16:11:57.987258: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 16:11:57.995618: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-04 16:11:57.997914: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9862270 executing computations on platform Host. Devices:
2019-08-04 16:11:57.997959: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-code
all data

Sentence length Average : 40

Under 10 : 18074
Over 10, Under 200 : 19988
Over 200, Under 400 : 1063
Over 400 : 317

glassfish-code
updated_train_data

Sentence length Average : 65

Under 10 : 0
Over 10, Under 200 : 17421
Over 200, Under 400 : 1118
Over 400 : 0


Test_zero:  1460
Train_zero:  13075
zero:  14535
Test_one:  580
Train_one:  5464
one:  6044

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 244s - loss: 0.5236 - acc: 0.7453

Test accuracy: 83.97932816537468

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  627

choose_one :  534

F1score :  0.8330341113105924

AUC : 0.9158807644370585

Confusion Matrix
[[511  70]
 [116 464]]
True label 0
0.8795180722891566  
0.12048192771084337  
True label 1
0.2  
0.8  

Train_result {'loss': [0.5236402839730366], 'acc': [0.7452648915783333]}
2

Epoch 1/1
 - 243s - loss: 0.3841 - acc: 0.8356

Test accuracy: 83.54866494401378

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  480

choose_one :  681

F1score :  0.8485329103885805

AUC : 0.9329915722001305

Confusion Matrix
[[435 146]
 [ 45 535]]
True label 0
0.7487091222030982  
0.2512908777969019  
True label 1
0.07758620689655173  
0.9224137931034483  

Train_result {'loss': [0.38410724336137403], 'acc': [0.8355750755145048]}
3

Epoch 1/1
 - 243s - loss: 0.3293 - acc: 0.8640

Test accuracy: 85.27131782945736

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  484

choose_one :  677

F1score :  0.8639618138424822

AUC : 0.9458469345361743

Confusion Matrix
[[447 134]
 [ 37 543]]
True label 0
0.7693631669535284  
0.2306368330464716  
True label 1
0.06379310344827586  
0.9362068965517242  

Train_result {'loss': [0.3292852923259042], 'acc': [0.864031475900742]}
4

Epoch 1/1
 - 243s - loss: 0.2901 - acc: 0.8799

Test accuracy: 88.45822566752798

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  585

choose_one :  576

F1score :  0.8840830449826991

AUC : 0.9569128731675471

Confusion Matrix
[[516  65]
 [ 69 511]]
True label 0
0.8881239242685026  
0.11187607573149742  
True label 1
0.11896551724137931  
0.8810344827586207  

Train_result {'loss': [0.29007841751793406], 'acc': [0.8798609205085935]}
5

Epoch 1/1
 - 243s - loss: 0.2610 - acc: 0.8960

Test accuracy: 90.35314384151593

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  581

choose_one :  580

F1score :  0.903448275862069

AUC : 0.9641684966466854

Confusion Matrix
[[525  56]
 [ 56 524]]
True label 0
0.9036144578313253  
0.0963855421686747  
True label 1
0.09655172413793103  
0.903448275862069  

Train_result {'loss': [0.26100091773480444], 'acc': [0.8959648641447908]}
6

Epoch 1/1
 - 243s - loss: 0.2295 - acc: 0.9065

Test accuracy: 88.54435831180018

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  510

choose_one :  651

F1score :  0.89195775792039

AUC : 0.9569870615466793

Confusion Matrix
[[479 102]
 [ 31 549]]
True label 0
0.8244406196213425  
0.17555938037865748  
True label 1
0.05344827586206897  
0.946551724137931  

Train_result {'loss': [0.22952110423270253], 'acc': [0.9064873272998083]}
7

Epoch 1/1
 - 243s - loss: 0.2078 - acc: 0.9185

Test accuracy: 90.26701119724375

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  608

choose_one :  553

F1score :  0.9002647837599295

AUC : 0.9651744910677191

Confusion Matrix
[[538  43]
 [ 70 510]]
True label 0
0.9259896729776248  
0.07401032702237521  
True label 1
0.1206896551724138  
0.8793103448275862  

Train_result {'loss': [0.2077948116505721], 'acc': [0.9184737853472051]}
8

Epoch 1/1
 - 243s - loss: 0.1808 - acc: 0.9301

Test accuracy: 91.12833763996555

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  602

choose_one :  559

F1score :  0.909569798068481

AUC : 0.9673111163867293

Confusion Matrix
[[540  41]
 [ 62 518]]
True label 0
0.9294320137693631  
0.07056798623063683  
True label 1
0.10689655172413794  
0.8931034482758621  

Train_result {'loss': [0.180846559467173], 'acc': [0.9300942446701437]}
9

Epoch 1/1
 - 243s - loss: 0.1581 - acc: 0.9419

Test accuracy: 90.869939707149

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  595

choose_one :  566

F1score :  0.9075043630017452

AUC : 0.9648376758264585

Confusion Matrix
[[535  46]
 [ 60 520]]
True label 0
0.9208261617900172  
0.07917383820998279  
True label 1
0.10344827586206896  
0.896551724137931  

Train_result {'loss': [0.1580548582572832], 'acc': [0.9418977033634921]}
10

Epoch 1/1
 - 243s - loss: 0.1358 - acc: 0.9495

Test accuracy: 91.30060292850992

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  550

choose_one :  611

F1score :  0.9151973131821998

AUC : 0.9663407323876787

Confusion Matrix
[[515  66]
 [ 35 545]]
True label 0
0.8864027538726333  
0.11359724612736662  
True label 1
0.0603448275862069  
0.9396551724137931  

Train_result {'loss': [0.1357928684741594], 'acc': [0.9494921767773813]}
11

Epoch 1/1
 - 242s - loss: 0.1201 - acc: 0.9575

Test accuracy: 90.00861326442721

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  557

choose_one :  604

F1score :  0.902027027027027

AUC : 0.9638287138702594

Confusion Matrix
[[511  70]
 [ 46 534]]
True label 0
0.8795180722891566  
0.12048192771084337  
True label 1
0.07931034482758621  
0.9206896551724137  

Train_result {'loss': [0.1201161627066911], 'acc': [0.9574526489211826]}
12

Epoch 1/1
 - 242s - loss: 0.1009 - acc: 0.9639

Test accuracy: 90.69767441860465

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  569

choose_one :  592

F1score :  0.9078498293515358

AUC : 0.9669906225888776

Confusion Matrix
[[521  60]
 [ 48 532]]
True label 0
0.8967297762478486  
0.10327022375215146  
True label 1
0.08275862068965517  
0.9172413793103448  

Train_result {'loss': [0.1008975535630498], 'acc': [0.9638576264983073]}
13

Epoch 1/1
 - 242s - loss: 0.0905 - acc: 0.9672

Test accuracy: 90.43927648578811

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  560

choose_one :  601

F1score :  0.9060118543607113

AUC : 0.9647990978693097

Confusion Matrix
[[515  66]
 [ 45 535]]
True label 0
0.8864027538726333  
0.11359724612736662  
True label 1
0.07758620689655173  
0.9224137931034483  

Train_result {'loss': [0.09053761106789227], 'acc': [0.9672431146490987]}
14

Epoch 1/1
 - 243s - loss: 0.0797 - acc: 0.9737

Test accuracy: 90.5254091300603

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  583

choose_one :  578

F1score :  0.9050086355785839

AUC : 0.9615095851385839

Confusion Matrix
[[527  54]
 [ 56 524]]
True label 0
0.9070567986230637  
0.09294320137693632  
True label 1
0.09655172413793103  
0.903448275862069  

Train_result {'loss': [0.07972310263055857], 'acc': [0.9737395919114283]}
15

Epoch 1/1
 - 243s - loss: 0.0720 - acc: 0.9758

Test accuracy: 89.49181739879414

data size :  12090

zero :  6046

one :  6044

train_zero :  5465

train_one :  5464

test_zero :  581

test_one :  580

choose_zero :  579

choose_one :  582

F1score :  0.8950086058519794

AUC : 0.9558831384651908

Confusion Matrix
[[519  62]
 [ 60 520]]
True label 0
0.8932874354561101  
0.10671256454388985  
True label 1
0.10344827586206896  
0.896551724137931  

Train_result {'loss': [0.07200702237010805], 'acc': [0.975752584865953]}
Saved model to disk




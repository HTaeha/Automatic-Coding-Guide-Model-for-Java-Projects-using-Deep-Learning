Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 21:32:12.344720: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 21:32:12.354462: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-04 21:32:12.357220: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x70d6bb0 executing computations on platform Host. Devices:
2019-08-04 21:32:12.357256: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 60

Under 10 : 0
Over 10, Under 200 : 22689
Over 200, Under 400 : 1159
Over 400 : 0


hbase-code

Sentence length Average : 77

Under 10 : 0
Over 10, Under 200 : 21805
Over 200, Under 400 : 2043
Over 400 : 0


Test_zero:  1844
Train_zero:  16735
zero:  18579
Test_one:  845
Train_one:  7113
one:  7958
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 580s - loss: 0.4888 - acc: 0.7707

Test accuracy: 80.01182732111177

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  1096

choose_one :  595

F1score :  0.7652777777777777

AUC : 0.9266279183627792

Confusion Matrix
[[802  44]
 [294 551]]
True label 0
0.9479905437352246  
0.05200945626477541  
True label 1
0.3479289940828402  
0.6520710059171597  

Train_result {'acc': [0.7707176495479868], 'loss': [0.4887697807603973]}
2

Epoch 1/1
 - 588s - loss: 0.3841 - acc: 0.8270

Test accuracy: 85.62980484920165

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  761

choose_one :  930

F1score :  0.8630985915492958

AUC : 0.9382845832109336

Confusion Matrix
[[682 164]
 [ 79 766]]
True label 0
0.806146572104019  
0.1938534278959811  
True label 1
0.09349112426035502  
0.906508875739645  

Train_result {'acc': [0.8270190482675178], 'loss': [0.3841149551393177]}
3

Epoch 1/1
 - 588s - loss: 0.3474 - acc: 0.8437

Test accuracy: 85.51153163808397

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  709

choose_one :  982

F1score :  0.8659003831417623

AUC : 0.949465637108845

Confusion Matrix
[[655 191]
 [ 54 791]]
True label 0
0.7742316784869976  
0.22576832151300236  
True label 1
0.06390532544378698  
0.936094674556213  

Train_result {'acc': [0.8436775145723755], 'loss': [0.3474311394618402]}
4

Epoch 1/1
 - 594s - loss: 0.3178 - acc: 0.8634

Test accuracy: 87.52217622708457

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  839

choose_one :  852

F1score :  0.8756629345904537

AUC : 0.9506140976681074

Confusion Matrix
[[737 109]
 [102 743]]
True label 0
0.8711583924349882  
0.1288416075650118  
True label 1
0.12071005917159763  
0.8792899408284024  

Train_result {'acc': [0.8634286919531337], 'loss': [0.3178227950132864]}
5

Epoch 1/1
 - 595s - loss: 0.2836 - acc: 0.8825

Test accuracy: 89.47368421052632

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  886

choose_one :  805

F1score :  0.8921212121212121

AUC : 0.9562682725530516

Confusion Matrix
[[777  69]
 [109 736]]
True label 0
0.9184397163120568  
0.08156028368794327  
True label 1
0.1289940828402367  
0.8710059171597633  

Train_result {'acc': [0.8825472692851064], 'loss': [0.28360820557929195]}
6

Epoch 1/1
 - 594s - loss: 0.2557 - acc: 0.8923

Test accuracy: 87.9952690715553

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  805

choose_one :  886

F1score :  0.8827267475447718

AUC : 0.9566683452935499

Confusion Matrix
[[724 122]
 [ 81 764]]
True label 0
0.8557919621749409  
0.14420803782505912  
True label 1
0.09585798816568047  
0.9041420118343195  

Train_result {'acc': [0.8923174245942206], 'loss': [0.25570888228784117]}
7

Epoch 1/1
 - 594s - loss: 0.2317 - acc: 0.9069

Test accuracy: 89.17800118273212

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  797

choose_one :  894

F1score :  0.894767107533065

AUC : 0.9579496971477331

Confusion Matrix
[[730 116]
 [ 67 778]]
True label 0
0.8628841607565012  
0.13711583924349882  
True label 1
0.07928994082840236  
0.9207100591715977  

Train_result {'acc': [0.9068672243211663], 'loss': [0.2317187951610237]}
8

Epoch 1/1
 - 594s - loss: 0.2070 - acc: 0.9147

Test accuracy: 88.94145476049675

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  803

choose_one :  888

F1score :  0.8920946335833815

AUC : 0.9614720158910011

Confusion Matrix
[[731 115]
 [ 72 773]]
True label 0
0.8640661938534279  
0.1359338061465721  
True label 1
0.08520710059171598  
0.914792899408284  

Train_result {'acc': [0.9146692907641791], 'loss': [0.20698537774881007]}
9

Epoch 1/1
 - 594s - loss: 0.1775 - acc: 0.9287

Test accuracy: 89.05972797161444

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  925

choose_one :  766

F1score :  0.8851644941030415

AUC : 0.9565648299690852

Confusion Matrix
[[793  53]
 [132 713]]
True label 0
0.9373522458628841  
0.06264775413711583  
True label 1
0.15621301775147928  
0.8437869822485207  

Train_result {'acc': [0.9287270682295619], 'loss': [0.177527954003678]}
10

Epoch 1/1
 - 593s - loss: 0.1566 - acc: 0.9371

Test accuracy: 89.23713778829095

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  894

choose_one :  797

F1score :  0.8891595615103532

AUC : 0.956499783177361

Confusion Matrix
[[779  67]
 [115 730]]
True label 0
0.9208037825059102  
0.07919621749408984  
True label 1
0.13609467455621302  
0.863905325443787  

Train_result {'acc': [0.9370914458801182], 'loss': [0.15660985231236144]}
11

Epoch 1/1
 - 593s - loss: 0.1315 - acc: 0.9476

Test accuracy: 89.05972797161444

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  869

choose_one :  822

F1score :  0.8890221955608877

AUC : 0.9537153608348372

Confusion Matrix
[[765  81]
 [104 741]]
True label 0
0.9042553191489362  
0.09574468085106383  
True label 1
0.12307692307692308  
0.8769230769230769  

Train_result {'acc': [0.9476347789707762], 'loss': [0.13154982188023293]}
12

Epoch 1/1
 - 593s - loss: 0.1107 - acc: 0.9547

Test accuracy: 89.8876404494382

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  835

choose_one :  856

F1score :  0.8994708994708994

AUC : 0.9597339376390113

Confusion Matrix
[[755  91]
 [ 80 765]]
True label 0
0.892434988179669  
0.10756501182033097  
True label 1
0.09467455621301775  
0.9053254437869822  

Train_result {'acc': [0.9546636677034676], 'loss': [0.11074919988224291]}
13

Epoch 1/1
 - 594s - loss: 0.1011 - acc: 0.9632

Test accuracy: 89.41454760496748

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  897

choose_one :  794

F1score :  0.8907870652837094

AUC : 0.9567263978065944

Confusion Matrix
[[782  64]
 [115 730]]
True label 0
0.9243498817966903  
0.07565011820330969  
True label 1
0.13609467455621302  
0.863905325443787  

Train_result {'acc': [0.9632389119280241], 'loss': [0.10106929141428203]}
14

Epoch 1/1
 - 593s - loss: 0.0870 - acc: 0.9684

Test accuracy: 90.71555292726198

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  859

choose_one :  832

F1score :  0.9063804412641622

AUC : 0.9590212206415153

Confusion Matrix
[[774  72]
 [ 85 760]]
True label 0
0.9148936170212766  
0.0851063829787234  
True label 1
0.10059171597633136  
0.8994082840236687  

Train_result {'acc': [0.9684402895902158], 'loss': [0.08699727727978356]}
15

Epoch 1/1
 - 593s - loss: 0.0707 - acc: 0.9760

Test accuracy: 89.71023063276168

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  924

choose_one :  767

F1score :  0.8920595533498759

AUC : 0.9578643669478368

Confusion Matrix
[[798  48]
 [126 719]]
True label 0
0.9432624113475178  
0.05673758865248227  
True label 1
0.14911242603550295  
0.850887573964497  

Train_result {'acc': [0.9760314894215224], 'loss': [0.07071966288368169]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 07:04:42.129975: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 07:04:42.140584: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-04 07:04:42.142910: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7395a40 executing computations on platform Host. Devices:
2019-08-04 07:04:42.142949: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22902
Over 200, Under 400 : 1162
Over 400 : 0


Test_zero:  1858
Train_zero:  16913
zero:  18771
Test_one:  853
Train_one:  7151
one:  8004

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 340s - loss: 0.5009 - acc: 0.7626

Test accuracy: 82.19097832454598

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  946

choose_one :  761

F1score :  0.8116480793060717

AUC : 0.9103982088290125

Confusion Matrix
[[748 106]
 [198 655]]
True label 0
0.8758782201405152  
0.12412177985948478  
True label 1
0.2321219226260258  
0.7678780773739742  

Train_result {'loss': [0.5009475683512524], 'acc': [0.7625672935205998]}
2

Epoch 1/1
 - 336s - loss: 0.4140 - acc: 0.8123

Test accuracy: 84.41710603397775

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  850

choose_one :  857

F1score :  0.8444444444444444

AUC : 0.9232979894627311

Confusion Matrix
[[719 135]
 [131 722]]
True label 0
0.84192037470726  
0.15807962529274006  
True label 1
0.15357561547479484  
0.8464243845252052  

Train_result {'loss': [0.41401008034655906], 'acc': [0.8123470599989887]}
3

Epoch 1/1
 - 340s - loss: 0.3854 - acc: 0.8268

Test accuracy: 85.00292911540714

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  896

choose_one :  811

F1score :  0.8461538461538461

AUC : 0.9224413902166482

Confusion Matrix
[[747 107]
 [149 704]]
True label 0
0.8747072599531616  
0.1252927400468384  
True label 1
0.1746776084407972  
0.8253223915592028  

Train_result {'loss': [0.3853564346340047], 'acc': [0.8268195483548353]}
4

Epoch 1/1
 - 342s - loss: 0.3640 - acc: 0.8401

Test accuracy: 86.76039835969537

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  846

choose_one :  861

F1score :  0.868144690781797

AUC : 0.9370214232176833

Confusion Matrix
[[737 117]
 [109 744]]
True label 0
0.8629976580796253  
0.13700234192037472  
True label 1
0.12778429073856976  
0.8722157092614302  

Train_result {'loss': [0.3639887901654504], 'acc': [0.8401034747371555]}
5

Epoch 1/1
 - 342s - loss: 0.3489 - acc: 0.8451

Test accuracy: 86.40890451083773

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  926

choose_one :  781

F1score :  0.8580171358629132

AUC : 0.9389597535629862

Confusion Matrix
[[774  80]
 [152 701]]
True label 0
0.9063231850117096  
0.0936768149882904  
True label 1
0.17819460726846426  
0.8218053927315357  

Train_result {'loss': [0.348891115939543], 'acc': [0.8451373837073016]}
6

Epoch 1/1
 - 342s - loss: 0.3309 - acc: 0.8581

Test accuracy: 87.11189220855302

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  896

choose_one :  811

F1score :  0.8677884615384616

AUC : 0.9382747487171603

Confusion Matrix
[[765  89]
 [131 722]]
True label 0
0.8957845433255269  
0.10421545667447307  
True label 1
0.15357561547479484  
0.8464243845252052  

Train_result {'loss': [0.33087152521347557], 'acc': [0.8581416485426785]}
7

Epoch 1/1
 - 342s - loss: 0.3176 - acc: 0.8635

Test accuracy: 87.05330990041008

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  923

choose_one :  784

F1score :  0.864996945632254

AUC : 0.9414444404787071

Confusion Matrix
[[778  76]
 [145 708]]
True label 0
0.9110070257611241  
0.08899297423887588  
True label 1
0.16998827667057445  
0.8300117233294255  

Train_result {'loss': [0.3176480376627915], 'acc': [0.8634552191972883]}
8

Epoch 1/1
 - 343s - loss: 0.2999 - acc: 0.8727

Test accuracy: 86.99472759226714

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  968

choose_one :  739

F1score :  0.8605527638190954

AUC : 0.9452428541227957

Confusion Matrix
[[800  54]
 [168 685]]
True label 0
0.936768149882904  
0.06323185011709602  
True label 1
0.1969519343493552  
0.8030480656506448  

Train_result {'loss': [0.29986090957389167], 'acc': [0.8726840522425463]}
9

Epoch 1/1
 - 343s - loss: 0.2827 - acc: 0.8783

Test accuracy: 88.04920913884007

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  892

choose_one :  815

F1score :  0.8776978417266188

AUC : 0.9432276494861778

Confusion Matrix
[[771  83]
 [121 732]]
True label 0
0.9028103044496487  
0.09718969555035128  
True label 1
0.141852286049238  
0.8581477139507621  

Train_result {'loss': [0.28273372661023094], 'acc': [0.8782772844899395]}
10

Epoch 1/1
 - 343s - loss: 0.2631 - acc: 0.8874

Test accuracy: 87.5219683655536

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  939

choose_one :  768

F1score :  0.8685996298581122

AUC : 0.9442009329244352

Confusion Matrix
[[790  64]
 [149 704]]
True label 0
0.9250585480093677  
0.07494145199063232  
True label 1
0.1746776084407972  
0.8253223915592028  

Train_result {'loss': [0.26306840935597625], 'acc': [0.8873662867971478]}
11

Epoch 1/1
 - 343s - loss: 0.2482 - acc: 0.8958

Test accuracy: 87.34622144112478

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  870

choose_one :  837

F1score :  0.872189349112426

AUC : 0.9412323497999895

Confusion Matrix
[[754 100]
 [116 737]]
True label 0
0.882903981264637  
0.117096018735363  
True label 1
0.13599062133645956  
0.8640093786635404  

Train_result {'loss': [0.24817947881134925], 'acc': [0.8957561350223827]}
12

Epoch 1/1
 - 343s - loss: 0.2335 - acc: 0.9011

Test accuracy: 87.05330990041008

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  805

choose_one :  902

F1score :  0.8740740740740741

AUC : 0.9388224780427805

Confusion Matrix
[[719 135]
 [ 86 767]]
True label 0
0.84192037470726  
0.15807962529274006  
True label 1
0.10082063305978899  
0.8991793669402111  

Train_result {'loss': [0.23353935996402456], 'acc': [0.9010697056644906]}
13

Epoch 1/1
 - 342s - loss: 0.2137 - acc: 0.9108

Test accuracy: 87.75629759812537

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  877

choose_one :  830

F1score :  0.8758169934640523

AUC : 0.9403723186659015

Confusion Matrix
[[761  93]
 [116 737]]
True label 0
0.8911007025761124  
0.10889929742388758  
True label 1
0.13599062133645956  
0.8640093786635404  

Train_result {'loss': [0.21365085716748633], 'acc': [0.9107879465929671]}
14

Epoch 1/1
 - 342s - loss: 0.2028 - acc: 0.9167

Test accuracy: 87.40480374926773

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  881

choose_one :  826

F1score :  0.8719475878499107

AUC : 0.9392288135825893

Confusion Matrix
[[760  94]
 [121 732]]
True label 0
0.8899297423887588  
0.11007025761124122  
True label 1
0.141852286049238  
0.8581477139507621  

Train_result {'loss': [0.20284321596011876], 'acc': [0.916660840391471]}
15

Epoch 1/1
 - 342s - loss: 0.1868 - acc: 0.9253

Test accuracy: 87.46338605741066

data size :  16010

zero :  8006

one :  8004

train_zero :  7152

train_one :  7151

test_zero :  854

test_one :  853

choose_zero :  886

choose_one :  821

F1score :  0.8721624850657108

AUC : 0.9418610716825311

Confusion Matrix
[[763  91]
 [123 730]]
True label 0
0.8934426229508197  
0.10655737704918032  
True label 1
0.14419695193434937  
0.8558030480656507  

Train_result {'loss': [0.186781054998556], 'acc': [0.9252604348821373]}
Saved model to disk




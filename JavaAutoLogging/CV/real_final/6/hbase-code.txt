Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 13:33:21.519248: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 13:33:21.528920: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-04 13:33:21.531172: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x707cb30 executing computations on platform Host. Devices:
2019-08-04 13:33:21.531213: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 49

Under 10 : 17243
Over 10, Under 200 : 28715
Over 200, Under 400 : 2031
Over 400 : 481

hbase-code
updated_train_data

Sentence length Average : 70

Under 10 : 0
Over 10, Under 200 : 25058
Over 200, Under 400 : 2057
Over 400 : 0


Test_zero:  2188
Train_zero:  19680
zero:  21868
Test_one:  882
Train_one:  7435
one:  8317

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 338s - loss: 0.4820 - acc: 0.7711

Test accuracy: 84.92917847025497

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  917

choose_one :  848

F1score :  0.846242774566474

AUC : 0.9297995906554393

Confusion Matrix
[[767 116]
 [150 732]]
True label 0
0.8686296715741789  
0.13137032842582105  
True label 1
0.17006802721088435  
0.8299319727891157  

Train_result {'loss': [0.4819949586136052], 'acc': [0.771098110404222]}
2

Epoch 1/1
 - 346s - loss: 0.3675 - acc: 0.8408

Test accuracy: 87.53541076487252

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  999

choose_one :  766

F1score :  0.866504854368932

AUC : 0.9500112993479763

Confusion Matrix
[[831  52]
 [168 714]]
True label 0
0.9411098527746319  
0.05889014722536806  
True label 1
0.19047619047619047  
0.8095238095238095  

Train_result {'loss': [0.36747837673879474], 'acc': [0.8408311478276074]}
3

Epoch 1/1
 - 358s - loss: 0.3239 - acc: 0.8625

Test accuracy: 89.12181303116147

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  899

choose_one :  866

F1score :  0.8901601830663616

AUC : 0.9565995896282257

Confusion Matrix
[[795  88]
 [104 778]]
True label 0
0.9003397508493771  
0.09966024915062288  
True label 1
0.11791383219954649  
0.8820861678004536  

Train_result {'loss': [0.3238689208335718], 'acc': [0.8624840293348409]}
4

Epoch 1/1
 - 357s - loss: 0.2871 - acc: 0.8804

Test accuracy: 88.89518413597733

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  957

choose_one :  808

F1score :  0.8840236686390532

AUC : 0.9602603215691713

Confusion Matrix
[[822  61]
 [135 747]]
True label 0
0.9309173272933182  
0.06908267270668177  
True label 1
0.15306122448979592  
0.8469387755102041  

Train_result {'loss': [0.2871429787708366], 'acc': [0.8804384371827281]}
5

Epoch 1/1
 - 357s - loss: 0.2561 - acc: 0.8923

Test accuracy: 89.06515580736544

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  1006

choose_one :  759

F1score :  0.882388787324802

AUC : 0.9601858485938731

Confusion Matrix
[[848  35]
 [158 724]]
True label 0
0.9603624009060022  
0.039637599093997736  
True label 1
0.17913832199546487  
0.8208616780045351  

Train_result {'loss': [0.2561208219464389], 'acc': [0.8923407974973282]}
6

Epoch 1/1
 - 357s - loss: 0.2358 - acc: 0.9055

Test accuracy: 90.59490084985836

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  919

choose_one :  846

F1score :  0.9039351851851852

AUC : 0.9655337786303649

Confusion Matrix
[[818  65]
 [101 781]]
True label 0
0.9263873159682899  
0.07361268403171008  
True label 1
0.1145124716553288  
0.8854875283446711  

Train_result {'loss': [0.2358326858698532], 'acc': [0.9055208122751899]}
7

Epoch 1/1
 - 357s - loss: 0.2048 - acc: 0.9151

Test accuracy: 90.25495750708215

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  871

choose_one :  894

F1score :  0.9031531531531531

AUC : 0.9645515057665195

Confusion Matrix
[[791  92]
 [ 80 802]]
True label 0
0.8958097395243488  
0.10419026047565119  
True label 1
0.09070294784580499  
0.909297052154195  

Train_result {'loss': [0.2047638670476778], 'acc': [0.9150695985194518]}
8

Epoch 1/1
 - 357s - loss: 0.1820 - acc: 0.9270

Test accuracy: 89.63172804532577

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  824

choose_one :  941

F1score :  0.8996160175534833

AUC : 0.9610024832885213

Confusion Matrix
[[762 121]
 [ 62 820]]
True label 0
0.8629671574178935  
0.13703284258210646  
True label 1
0.07029478458049887  
0.9297052154195011  

Train_result {'loss': [0.18202590114131362], 'acc': [0.9269719588460763]}
9

Epoch 1/1
 - 357s - loss: 0.1603 - acc: 0.9357

Test accuracy: 90.25495750708215

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  935

choose_one :  830

F1score :  0.8995327102803738

AUC : 0.9651049170139933

Confusion Matrix
[[823  60]
 [112 770]]
True label 0
0.9320498301245753  
0.06795016987542468  
True label 1
0.12698412698412698  
0.873015873015873  

Train_result {'loss': [0.1603294115809913], 'acc': [0.9357138053930468]}
10

Epoch 1/1
 - 358s - loss: 0.1393 - acc: 0.9439

Test accuracy: 91.1614730878187

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  871

choose_one :  894

F1score :  0.9121621621621622

AUC : 0.969213128815135

Confusion Matrix
[[799  84]
 [ 72 810]]
True label 0
0.9048697621744054  
0.09513023782559456  
True label 1
0.08163265306122448  
0.9183673469387755  

Train_result {'loss': [0.13932208719086342], 'acc': [0.9438504471790734]}
11

Epoch 1/1
 - 357s - loss: 0.1199 - acc: 0.9527

Test accuracy: 89.97167138810198

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  894

choose_one :  871

F1score :  0.8990302338847689

AUC : 0.9611084146757987

Confusion Matrix
[[800  83]
 [ 94 788]]
True label 0
0.9060022650056625  
0.09399773499433749  
True label 1
0.10657596371882086  
0.8934240362811792  

Train_result {'loss': [0.11985628170088844], 'acc': [0.9527267836288312]}
12

Epoch 1/1
 - 358s - loss: 0.1068 - acc: 0.9586

Test accuracy: 90.53824362606233

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  906

choose_one :  859

F1score :  0.9040781160252728

AUC : 0.9659433799945045

Confusion Matrix
[[811  72]
 [ 95 787]]
True label 0
0.9184597961494904  
0.08154020385050963  
True label 1
0.10770975056689343  
0.8922902494331065  

Train_result {'loss': [0.10681621561485856], 'acc': [0.9586443413675501]}
13

Epoch 1/1
 - 359s - loss: 0.0896 - acc: 0.9662

Test accuracy: 90.19830028328612

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  898

choose_one :  867

F1score :  0.9010863350485993

AUC : 0.9639698461491052

Confusion Matrix
[[804  79]
 [ 94 788]]
True label 0
0.9105322763306908  
0.08946772366930918  
True label 1
0.10657596371882086  
0.8934240362811792  

Train_result {'loss': [0.08964388261059872], 'acc': [0.9662430233340058]}
14

Epoch 1/1
 - 365s - loss: 0.0791 - acc: 0.9722

Test accuracy: 90.70821529745042

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  867

choose_one :  898

F1score :  0.9078651685393258

AUC : 0.964186844990922

Confusion Matrix
[[793  90]
 [ 74 808]]
True label 0
0.8980747451868629  
0.10192525481313704  
True label 1
0.08390022675736962  
0.9160997732426304  

Train_result {'loss': [0.07911938737622456], 'acc': [0.9722278259700088]}
15

Epoch 1/1
 - 366s - loss: 0.0672 - acc: 0.9753

Test accuracy: 89.34844192634561

data size :  16636

zero :  8319

one :  8317

train_zero :  7436

train_one :  7435

test_zero :  883

test_one :  882

choose_zero :  937

choose_one :  828

F1score :  0.8900584795321638

AUC : 0.9637592673913657

Confusion Matrix
[[816  67]
 [121 761]]
True label 0
0.9241223103057757  
0.07587768969422423  
True label 1
0.13718820861678005  
0.86281179138322  

Train_result {'loss': [0.06721832529510735], 'acc': [0.9752538497907618]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 02:52:11.101354: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 02:52:11.111429: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-04 02:52:11.113506: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6d50730 executing computations on platform Host. Devices:
2019-08-04 02:52:11.113557: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST_s
all data

Sentence length Average : 51

Under 10 : 10903
Over 10, Under 200 : 26333
Over 200, Under 400 : 1747
Over 400 : 459

glassfish-CAST_s
updated_train_data

Sentence length Average : 64

Under 10 : 0
Over 10, Under 200 : 22902
Over 200, Under 400 : 1803
Over 400 : 0


Test_zero:  2138
Train_zero:  18874
zero:  21012
Test_one:  643
Train_one:  5831
one:  6474

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 264s - loss: 0.4652 - acc: 0.7934

Test accuracy: 81.58508158508158

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  757

choose_one :  530

F1score :  0.7979539641943735

AUC : 0.9146578538102645

Confusion Matrix
[[582  62]
 [175 468]]
True label 0
0.9037267080745341  
0.09627329192546584  
True label 1
0.27216174183514774  
0.7278382581648523  

Train_result {'loss': [0.4652331601302906], 'acc': [0.7933636285740894]}
2

Epoch 1/1
 - 264s - loss: 0.3476 - acc: 0.8549

Test accuracy: 82.43978243978243

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  528

choose_one :  759

F1score :  0.8388017118402282

AUC : 0.92014214232586

Confusion Matrix
[[473 171]
 [ 55 588]]
True label 0
0.734472049689441  
0.265527950310559  
True label 1
0.08553654743390357  
0.9144634525660964  

Train_result {'loss': [0.3475972794447981], 'acc': [0.8549258338386011]}
3

Epoch 1/1
 - 275s - loss: 0.2950 - acc: 0.8763

Test accuracy: 88.11188811188812

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  665

choose_one :  622

F1score :  0.8790513833992095

AUC : 0.9464285714285714

Confusion Matrix
[[578  66]
 [ 87 556]]
True label 0
0.8975155279503105  
0.10248447204968944  
True label 1
0.13530326594090203  
0.864696734059098  

Train_result {'loss': [0.29496701860125313], 'acc': [0.8762754008555959]}
4

Epoch 1/1
 - 278s - loss: 0.2624 - acc: 0.8921

Test accuracy: 88.57808857808858

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  623

choose_one :  664

F1score :  0.8875286916602907

AUC : 0.956373221409735

Confusion Matrix
[[560  84]
 [ 63 580]]
True label 0
0.8695652173913043  
0.13043478260869565  
True label 1
0.09797822706065319  
0.9020217729393468  

Train_result {'loss': [0.2623672299556582], 'acc': [0.8920517877098177]}
5

Epoch 1/1
 - 279s - loss: 0.2290 - acc: 0.9059

Test accuracy: 89.5104895104895

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  701

choose_one :  586

F1score :  0.8901545972335232

AUC : 0.9636735314857567

Confusion Matrix
[[605  39]
 [ 96 547]]
True label 0
0.9394409937888198  
0.06055900621118013  
True label 1
0.14930015552099535  
0.8506998444790047  

Train_result {'loss': [0.22895242694535672], 'acc': [0.9059418674593855]}
6

Epoch 1/1
 - 278s - loss: 0.2000 - acc: 0.9227

Test accuracy: 89.12198912198912

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  614

choose_one :  673

F1score :  0.8936170212765957

AUC : 0.9643171082754557

Confusion Matrix
[[559  85]
 [ 55 588]]
True label 0
0.8680124223602484  
0.13198757763975155  
True label 1
0.08553654743390357  
0.9144634525660964  

Train_result {'loss': [0.20000341796276042], 'acc': [0.9227471491193359]}
7

Epoch 1/1
 - 276s - loss: 0.1708 - acc: 0.9329

Test accuracy: 91.45299145299145

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  670

choose_one :  617

F1score :  0.9126984126984127

AUC : 0.9651128251692861

Confusion Matrix
[[602  42]
 [ 68 575]]
True label 0
0.9347826086956522  
0.06521739130434782  
True label 1
0.1057542768273717  
0.8942457231726283  

Train_result {'loss': [0.17077096242019715], 'acc': [0.9328646145982684]}
8

Epoch 1/1
 - 278s - loss: 0.1500 - acc: 0.9438

Test accuracy: 91.21989121989122

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  651

choose_one :  636

F1score :  0.9116497263487099

AUC : 0.9665158950184983

Confusion Matrix
[[591  53]
 [ 60 583]]
True label 0
0.9177018633540373  
0.08229813664596274  
True label 1
0.09331259720062209  
0.9066874027993779  

Train_result {'loss': [0.1500270176587225], 'acc': [0.943753751178942]}
9

Epoch 1/1
 - 279s - loss: 0.1297 - acc: 0.9529

Test accuracy: 89.04428904428904

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  613

choose_one :  674

F1score :  0.8929384965831435

AUC : 0.9630710083749505

Confusion Matrix
[[558  86]
 [ 55 588]]
True label 0
0.8664596273291926  
0.13354037267080746  
True label 1
0.08553654743390357  
0.9144634525660964  

Train_result {'loss': [0.12966203080410538], 'acc': [0.9529280631055475]}
10

Epoch 1/1
 - 277s - loss: 0.1104 - acc: 0.9592

Test accuracy: 90.05439005439005

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  600

choose_one :  687

F1score :  0.9037593984962405

AUC : 0.9616196400799824

Confusion Matrix
[[558  86]
 [ 42 601]]
True label 0
0.8664596273291926  
0.13354037267080746  
True label 1
0.06531881804043546  
0.9346811819595645  

Train_result {'loss': [0.11044927355559057], 'acc': [0.9591871731115493]}
11

Epoch 1/1
 - 279s - loss: 0.0933 - acc: 0.9650

Test accuracy: 91.06449106449107

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  651

choose_one :  636

F1score :  0.910086004691165

AUC : 0.9667984409261711

Confusion Matrix
[[590  54]
 [ 61 582]]
True label 0
0.9161490683229814  
0.08385093167701864  
True label 1
0.09486780715396578  
0.9051321928460342  

Train_result {'loss': [0.09326145242815652], 'acc': [0.9650175769527566]}
12

Epoch 1/1
 - 279s - loss: 0.0869 - acc: 0.9702

Test accuracy: 90.5982905982906

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  601

choose_one :  686

F1score :  0.9089541008276901

AUC : 0.9646262183282942

Confusion Matrix
[[562  82]
 [ 39 604]]
True label 0
0.8726708074534162  
0.12732919254658384  
True label 1
0.060653188180404355  
0.9393468118195957  

Train_result {'loss': [0.08691384724223071], 'acc': [0.970162050935403]}
13

Epoch 1/1
 - 279s - loss: 0.0669 - acc: 0.9759

Test accuracy: 90.05439005439005

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  600

choose_one :  687

F1score :  0.9037593984962405

AUC : 0.9609627812177005

Confusion Matrix
[[558  86]
 [ 42 601]]
True label 0
0.8664596273291926  
0.13354037267080746  
True label 1
0.06531881804043546  
0.9346811819595645  

Train_result {'loss': [0.06686095867003672], 'acc': [0.9759067135436512]}
14

Epoch 1/1
 - 280s - loss: 0.0686 - acc: 0.9768

Test accuracy: 90.5982905982906

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  619

choose_one :  668

F1score :  0.9077040427154843

AUC : 0.9627268819489389

Confusion Matrix
[[571  73]
 [ 48 595]]
True label 0
0.8866459627329193  
0.11335403726708075  
True label 1
0.07465007776049767  
0.9253499222395023  

Train_result {'loss': [0.06861265018089613], 'acc': [0.9768498671010889]}
15

Epoch 1/1
 - 278s - loss: 0.0606 - acc: 0.9801

Test accuracy: 91.21989121989122

data size :  12950

zero :  6476

one :  6474

train_zero :  5832

train_one :  5831

test_zero :  644

test_one :  643

choose_zero :  647

choose_one :  640

F1score :  0.9119251753702261

AUC : 0.9629261130376825

Confusion Matrix
[[589  55]
 [ 58 585]]
True label 0
0.9145962732919255  
0.08540372670807453  
True label 1
0.09020217729393468  
0.9097978227060654  

Train_result {'loss': [0.060578687330748636], 'acc': [0.9801080339535283]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-03 23:11:54.930379: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-03 23:11:54.940726: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-03 23:11:54.943235: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x66237a0 executing computations on platform Host. Devices:
2019-08-03 23:11:54.943302: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST_s
all data

Sentence length Average : 63

Under 10 : 8733
Over 10, Under 200 : 36158
Over 200, Under 400 : 2746
Over 400 : 833

hbase-CAST_s
updated_train_data

Sentence length Average : 70

Under 10 : 0
Over 10, Under 200 : 31637
Over 200, Under 400 : 3009
Over 400 : 0


Test_zero:  2969
Train_zero:  27072
zero:  30041
Test_one:  897
Train_one:  7574
one:  8471

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 353s - loss: 0.4008 - acc: 0.8196

Test accuracy: 87.13091922005572

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  875

choose_one :  920

F1score :  0.8728673637864612

AUC : 0.9489004427030959

Confusion Matrix
[[771 127]
 [104 793]]
True label 0
0.8585746102449888  
0.14142538975501115  
True label 1
0.11594202898550725  
0.8840579710144928  

Train_result {'loss': [0.4007811709472201], 'acc': [0.8195920522924822]}
2

Epoch 1/1
 - 366s - loss: 0.3222 - acc: 0.8610

Test accuracy: 88.41225626740948

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  894

choose_one :  901

F1score :  0.8843159065628475

AUC : 0.9614254890714655

Confusion Matrix
[[792 106]
 [102 795]]
True label 0
0.8819599109131403  
0.11804008908685969  
True label 1
0.11371237458193979  
0.8862876254180602  

Train_result {'loss': [0.3221615214136632], 'acc': [0.8610469338106821]}
3

Epoch 1/1
 - 367s - loss: 0.2962 - acc: 0.8725

Test accuracy: 88.6908077994429

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  857

choose_one :  938

F1score :  0.8893732970027247

AUC : 0.9597681457369653

Confusion Matrix
[[776 122]
 [ 81 816]]
True label 0
0.8641425389755011  
0.1358574610244989  
True label 1
0.0903010033444816  
0.9096989966555183  

Train_result {'loss': [0.296174918659387], 'acc': [0.8724668295015651]}
4

Epoch 1/1
 - 362s - loss: 0.2655 - acc: 0.8849

Test accuracy: 88.74651810584957

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  792

choose_one :  1003

F1score :  0.8936842105263159

AUC : 0.9668518918543126

Confusion Matrix
[[744 154]
 [ 48 849]]
True label 0
0.8285077951002228  
0.1714922048997773  
True label 1
0.05351170568561873  
0.9464882943143813  

Train_result {'loss': [0.26545067016335083], 'acc': [0.8848768895636676]}
5

Epoch 1/1
 - 363s - loss: 0.2397 - acc: 0.9009

Test accuracy: 89.97214484679665

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  902

choose_one :  893

F1score :  0.8994413407821228

AUC : 0.9629015798765

Confusion Matrix
[[810  88]
 [ 92 805]]
True label 0
0.9020044543429844  
0.09799554565701558  
True label 1
0.10256410256410256  
0.8974358974358975  

Train_result {'loss': [0.23968143272190584], 'acc': [0.9008515413597996]}
6

Epoch 1/1
 - 361s - loss: 0.2122 - acc: 0.9137

Test accuracy: 89.63788300835654

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  926

choose_one :  869

F1score :  0.8946772366930917

AUC : 0.9668556162213564

Confusion Matrix
[[819  79]
 [107 790]]
True label 0
0.9120267260579065  
0.08797327394209355  
True label 1
0.11928651059085842  
0.8807134894091416  

Train_result {'loss': [0.21224784325220317], 'acc': [0.9136576671806198]}
7

Epoch 1/1
 - 361s - loss: 0.1891 - acc: 0.9257

Test accuracy: 90.47353760445682

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  903

choose_one :  892

F1score :  0.9044158747903857

AUC : 0.9654180105424415

Confusion Matrix
[[815  83]
 [ 88 809]]
True label 0
0.9075723830734966  
0.09242761692650334  
True label 1
0.09810479375696766  
0.9018952062430323  

Train_result {'loss': [0.18913599688413946], 'acc': [0.9256716614997429]}
8

Epoch 1/1
 - 362s - loss: 0.1651 - acc: 0.9349

Test accuracy: 91.25348189415043

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  891

choose_one :  904

F1score :  0.9128262076624097

AUC : 0.9697606225155369

Confusion Matrix
[[816  82]
 [ 75 822]]
True label 0
0.9086859688195991  
0.09131403118040089  
True label 1
0.08361204013377926  
0.9163879598662207  

Train_result {'loss': [0.16514422709937615], 'acc': [0.9349131955944026]}
9

Epoch 1/1
 - 363s - loss: 0.1397 - acc: 0.9451

Test accuracy: 89.97214484679665

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  910

choose_one :  885

F1score :  0.898989898989899

AUC : 0.9678078127288934

Confusion Matrix
[[814  84]
 [ 96 801]]
True label 0
0.9064587973273942  
0.0935412026726058  
True label 1
0.10702341137123746  
0.8929765886287625  

Train_result {'loss': [0.13965048810398392], 'acc': [0.9450788830985283]}
10

Epoch 1/1
 - 367s - loss: 0.1221 - acc: 0.9537

Test accuracy: 90.64066852367688

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  868

choose_one :  927

F1score :  0.9078947368421053

AUC : 0.9680114114606222

Confusion Matrix
[[799  99]
 [ 69 828]]
True label 0
0.8897550111358574  
0.11024498886414254  
True label 1
0.07692307692307693  
0.9230769230769231  

Train_result {'loss': [0.12207184937541041], 'acc': [0.953726318572817]}
11

Epoch 1/1
 - 363s - loss: 0.1064 - acc: 0.9596

Test accuracy: 90.08356545961003

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  858

choose_one :  937

F1score :  0.9029443838604144

AUC : 0.9661212951858832

Confusion Matrix
[[789 109]
 [ 69 828]]
True label 0
0.878619153674833  
0.12138084632516703  
True label 1
0.07692307692307693  
0.9230769230769231  

Train_result {'loss': [0.10644122650844995], 'acc': [0.9596012938187078]}
12

Epoch 1/1
 - 362s - loss: 0.0959 - acc: 0.9636

Test accuracy: 87.07520891364902

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  1016

choose_one :  779

F1score :  0.8615751789976134

AUC : 0.9548060473789146

Confusion Matrix
[[841  57]
 [175 722]]
True label 0
0.9365256124721604  
0.06347438752783964  
True label 1
0.19509476031215162  
0.8049052396878483  

Train_result {'loss': [0.0959449552387615], 'acc': [0.9635619512917822]}
13

Epoch 1/1
 - 360s - loss: 0.0803 - acc: 0.9702

Test accuracy: 89.19220055710306

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  958

choose_one :  837

F1score :  0.8881199538638985

AUC : 0.9585738653715801

Confusion Matrix
[[831  67]
 [127 770]]
True label 0
0.9253897550111359  
0.07461024498886415  
True label 1
0.1415830546265329  
0.8584169453734671  

Train_result {'loss': [0.08032496228995607], 'acc': [0.9701630470697474]}
14

Epoch 1/1
 - 360s - loss: 0.0678 - acc: 0.9749

Test accuracy: 89.69359331476323

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  901

choose_one :  894

F1score :  0.8967057509771078

AUC : 0.9612492023647248

Confusion Matrix
[[807  91]
 [ 94 803]]
True label 0
0.8986636971046771  
0.10133630289532294  
True label 1
0.10479375696767002  
0.89520624303233  

Train_result {'loss': [0.06778284838252595], 'acc': [0.9749158360287807]}
15

Epoch 1/1
 - 364s - loss: 0.0640 - acc: 0.9773

Test accuracy: 90.30640668523677

data size :  16944

zero :  8473

one :  8471

train_zero :  7575

train_one :  7574

test_zero :  898

test_one :  897

choose_zero :  866

choose_one :  929

F1score :  0.904709748083242

AUC : 0.962710395701584

Confusion Matrix
[[795 103]
 [ 71 826]]
True label 0
0.8853006681514477  
0.11469933184855234  
True label 1
0.07915273132664437  
0.9208472686733556  

Train_result {'loss': [0.06399859768913377], 'acc': [0.9772922305181339]}
Saved model to disk




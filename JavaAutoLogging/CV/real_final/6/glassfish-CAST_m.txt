Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-05 00:06:31.299642: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-05 00:06:31.310435: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-05 00:06:31.312908: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xf1fe260 executing computations on platform Host. Devices:
2019-08-05 00:06:31.312947: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
31687
one : 
7755

Second data
zero : 
31687
one : 
7755

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15208
Over 200, Under 400 : 609
Over 400 : 0


glassfish-code

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 14726
Over 200, Under 400 : 1091
Over 400 : 0


Test_zero:  1199
Train_zero:  10618
zero:  11817
Test_one:  584
Train_one:  5199
one:  5783
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 421s - loss: 0.5576 - acc: 0.7298

Test accuracy: 76.56116338751069

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  773

choose_one :  396

F1score :  0.7204081632653062

AUC : 0.8670998712094604

Confusion Matrix
[[542  43]
 [231 353]]
True label 0
0.9264957264957265  
0.0735042735042735  
True label 1
0.3955479452054795  
0.6044520547945206  

Train_result {'loss': [0.5576423469478435], 'acc': [0.7297817098027136]}
2

Epoch 1/1
 - 418s - loss: 0.4120 - acc: 0.8186

Test accuracy: 83.8323353293413

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  600

choose_one :  569

F1score :  0.8360797918473547

AUC : 0.9154812082894275

Confusion Matrix
[[498  87]
 [102 482]]
True label 0
0.8512820512820513  
0.14871794871794872  
True label 1
0.17465753424657535  
0.8253424657534246  

Train_result {'loss': [0.41198510666950033], 'acc': [0.8186364072838108]}
3

Epoch 1/1
 - 419s - loss: 0.3508 - acc: 0.8513

Test accuracy: 84.60222412318221

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  699

choose_one :  470

F1score :  0.8292220113851994

AUC : 0.9300960074932677

Confusion Matrix
[[552  33]
 [147 437]]
True label 0
0.9435897435897436  
0.05641025641025641  
True label 1
0.2517123287671233  
0.7482876712328768  

Train_result {'loss': [0.3508096119282005], 'acc': [0.8513318588440436]}
4

Epoch 1/1
 - 419s - loss: 0.3124 - acc: 0.8713

Test accuracy: 87.25406330196749

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  650

choose_one :  519

F1score :  0.8649138712601995

AUC : 0.9335733520665028

Confusion Matrix
[[543  42]
 [107 477]]
True label 0
0.9282051282051282  
0.07179487179487179  
True label 1
0.1832191780821918  
0.8167808219178082  

Train_result {'loss': [0.3124220646041576], 'acc': [0.8713337820084557]}
5

Epoch 1/1
 - 418s - loss: 0.2770 - acc: 0.8872

Test accuracy: 86.39863130881095

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  674

choose_one :  495

F1score :  0.8526413345690453

AUC : 0.9417764313312259

Confusion Matrix
[[550  35]
 [124 460]]
True label 0
0.9401709401709402  
0.05982905982905983  
True label 1
0.21232876712328766  
0.7876712328767124  

Train_result {'loss': [0.2770103104201197], 'acc': [0.8872006922997537]}
6

Epoch 1/1
 - 419s - loss: 0.2513 - acc: 0.8988

Test accuracy: 87.25406330196749

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  642

choose_one :  527

F1score :  0.8658865886588659

AUC : 0.9478925184404637

Confusion Matrix
[[539  46]
 [103 481]]
True label 0
0.9213675213675213  
0.07863247863247863  
True label 1
0.17636986301369864  
0.8236301369863014  

Train_result {'loss': [0.25128253199627953], 'acc': [0.898836426499234]}
7

Epoch 1/1
 - 419s - loss: 0.2243 - acc: 0.9129

Test accuracy: 88.45166809238665

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  562

choose_one :  607

F1score :  0.8866498740554156

AUC : 0.9466382742067673

Confusion Matrix
[[506  79]
 [ 56 528]]
True label 0
0.864957264957265  
0.13504273504273503  
True label 1
0.0958904109589041  
0.9041095890410958  

Train_result {'loss': [0.22429259291508183], 'acc': [0.9128762381112808]}
8

Epoch 1/1
 - 427s - loss: 0.1951 - acc: 0.9251

Test accuracy: 88.10949529512403

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  632

choose_one :  537

F1score :  0.8760035682426405

AUC : 0.9441605198454514

Confusion Matrix
[[539  46]
 [ 93 491]]
True label 0
0.9213675213675213  
0.07863247863247863  
True label 1
0.15924657534246575  
0.8407534246575342  

Train_result {'loss': [0.1950963712882647], 'acc': [0.925088950780415]}
9

Epoch 1/1
 - 427s - loss: 0.1655 - acc: 0.9356

Test accuracy: 88.87938408896493

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  627

choose_one :  542

F1score :  0.8845470692717584

AUC : 0.949680950708348

Confusion Matrix
[[541  44]
 [ 86 498]]
True label 0
0.9247863247863248  
0.07521367521367521  
True label 1
0.14726027397260275  
0.8527397260273972  

Train_result {'loss': [0.165468858700582], 'acc': [0.9355707278686345]}
10

Epoch 1/1
 - 428s - loss: 0.1514 - acc: 0.9441

Test accuracy: 88.70829769033361

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  573

choose_one :  596

F1score :  0.888135593220339

AUC : 0.9518235569605432

Confusion Matrix
[[513  72]
 [ 60 524]]
True label 0
0.8769230769230769  
0.12307692307692308  
True label 1
0.10273972602739725  
0.8972602739726028  

Train_result {'loss': [0.15144484769508168], 'acc': [0.9441292431219482]}
11

Epoch 1/1
 - 428s - loss: 0.1290 - acc: 0.9542

Test accuracy: 87.68177929854576

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  563

choose_one :  606

F1score :  0.8789915966386553

AUC : 0.9468168247277836

Confusion Matrix
[[502  83]
 [ 61 523]]
True label 0
0.8581196581196581  
0.14188034188034188  
True label 1
0.10445205479452055  
0.8955479452054794  

Train_result {'loss': [0.128997770966773], 'acc': [0.9542263678340158]}
12

Epoch 1/1
 - 428s - loss: 0.1119 - acc: 0.9586

Test accuracy: 89.73481608212147

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  639

choose_one :  530

F1score :  0.8922800718132854

AUC : 0.9512747336377474

Confusion Matrix
[[552  33]
 [ 87 497]]
True label 0
0.9435897435897436  
0.05641025641025641  
True label 1
0.14897260273972604  
0.851027397260274  

Train_result {'loss': [0.11188215813505938], 'acc': [0.958649870179825]}
13

Epoch 1/1
 - 428s - loss: 0.1024 - acc: 0.9645

Test accuracy: 90.16253207869974

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  584

choose_one :  585

F1score :  0.9016253207869974

AUC : 0.9525480037466338

Confusion Matrix
[[527  58]
 [ 57 527]]
True label 0
0.9008547008547009  
0.09914529914529914  
True label 1
0.0976027397260274  
0.9023972602739726  

Train_result {'loss': [0.10242994986610643], 'acc': [0.9645158188287335]}
14

Epoch 1/1
 - 427s - loss: 0.0815 - acc: 0.9709

Test accuracy: 89.13601368691188

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  594

choose_one :  575

F1score :  0.8904227782571182

AUC : 0.9537524879990633

Confusion Matrix
[[526  59]
 [ 68 516]]
True label 0
0.8991452991452992  
0.10085470085470086  
True label 1
0.11643835616438356  
0.8835616438356164  

Train_result {'loss': [0.08154424192769526], 'acc': [0.9708625829406674]}
15

Epoch 1/1
 - 427s - loss: 0.0800 - acc: 0.9720

Test accuracy: 89.22155688622755

data size :  11568

zero :  5785

one :  5783

train_zero :  5200

train_one :  5199

test_zero :  585

test_one :  584

choose_zero :  561

choose_one :  608

F1score :  0.8942953020134229

AUC : 0.9455903875424423

Confusion Matrix
[[510  75]
 [ 51 533]]
True label 0
0.8717948717948718  
0.1282051282051282  
True label 1
0.08732876712328767  
0.9126712328767124  

Train_result {'loss': [0.08001206605683993], 'acc': [0.9720165400519281]}
Saved model to disk




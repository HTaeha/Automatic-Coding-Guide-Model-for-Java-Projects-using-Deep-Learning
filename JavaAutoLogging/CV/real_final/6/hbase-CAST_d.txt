Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-05 05:54:03.416974: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-05 05:54:03.424513: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-05 05:54:03.427459: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x100e0e70 executing computations on platform Host. Devices:
2019-08-05 05:54:03.427498: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 60

Under 10 : 0
Over 10, Under 200 : 22689
Over 200, Under 400 : 1159
Over 400 : 0


hbase-code

Sentence length Average : 77

Under 10 : 0
Over 10, Under 200 : 21805
Over 200, Under 400 : 2043
Over 400 : 0


Test_zero:  1844
Train_zero:  16735
zero:  18579
Test_one:  845
Train_one:  7113
one:  7958
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 674s - loss: 0.5130 - acc: 0.7555

Test accuracy: 84.03311649911295

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  824

choose_one :  867

F1score :  0.842289719626168

AUC : 0.9181158812091709

Confusion Matrix
[[700 146]
 [124 721]]
True label 0
0.8274231678486997  
0.17257683215130024  
True label 1
0.1467455621301775  
0.8532544378698225  

Train_result {'acc': [0.7554649610189943], 'loss': [0.5129867129165575]}
2

Epoch 1/1
 - 674s - loss: 0.3865 - acc: 0.8326

Test accuracy: 85.62980484920165

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  725

choose_one :  966

F1score :  0.8658199889563777

AUC : 0.9399771986515031

Confusion Matrix
[[664 182]
 [ 61 784]]
True label 0
0.7848699763593381  
0.21513002364066194  
True label 1
0.07218934911242604  
0.927810650887574  

Train_result {'acc': [0.8326421592913769], 'loss': [0.38651282229108136]}
3

Epoch 1/1
 - 672s - loss: 0.3392 - acc: 0.8534

Test accuracy: 88.76404494382022

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  814

choose_one :  877

F1score :  0.8896631823461092

AUC : 0.9469658819085989

Confusion Matrix
[[735 111]
 [ 79 766]]
True label 0
0.8687943262411347  
0.13120567375886524  
True label 1
0.09349112426035502  
0.906508875739645  

Train_result {'acc': [0.8533773810234896], 'loss': [0.339165324147406]}
4

Epoch 1/1
 - 673s - loss: 0.3104 - acc: 0.8681

Test accuracy: 88.35008870490833

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  827

choose_one :  864

F1score :  0.8847279110590989

AUC : 0.9541825786506637

Confusion Matrix
[[738 108]
 [ 89 756]]
True label 0
0.8723404255319149  
0.1276595744680851  
True label 1
0.10532544378698225  
0.8946745562130177  

Train_result {'acc': [0.8680677584664355], 'loss': [0.31036831811934534]}
5

Epoch 1/1
 - 681s - loss: 0.2794 - acc: 0.8797

Test accuracy: 90.12418687167356

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  855

choose_one :  836

F1score :  0.9006543723973826

AUC : 0.9598801180634241

Confusion Matrix
[[767  79]
 [ 88 757]]
True label 0
0.9066193853427896  
0.0933806146572104  
True label 1
0.10414201183431952  
0.8958579881656805  

Train_result {'acc': [0.8797357137627031], 'loss': [0.2793869653593223]}
6

Epoch 1/1
 - 680s - loss: 0.2527 - acc: 0.8932

Test accuracy: 87.69958604376109

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  952

choose_one :  739

F1score :  0.8686868686868686

AUC : 0.9536677997398129

Confusion Matrix
[[795  51]
 [157 688]]
True label 0
0.9397163120567376  
0.06028368794326241  
True label 1
0.18579881656804734  
0.8142011834319527  

Train_result {'acc': [0.8931608912924182], 'loss': [0.252655088733938]}
7

Epoch 1/1
 - 685s - loss: 0.2369 - acc: 0.9035

Test accuracy: 89.35541099940863

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  910

choose_one :  781

F1score :  0.8892988929889298

AUC : 0.9615237735532335

Confusion Matrix
[[788  58]
 [122 723]]
True label 0
0.9314420803782506  
0.06855791962174941  
True label 1
0.14437869822485208  
0.855621301775148  

Train_result {'acc': [0.9034933577294744], 'loss': [0.23692853738533987]}
8

Epoch 1/1
 - 685s - loss: 0.2131 - acc: 0.9119

Test accuracy: 89.591957421644

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  916

choose_one :  775

F1score :  0.891358024691358

AUC : 0.9609852140948703

Confusion Matrix
[[793  53]
 [123 722]]
True label 0
0.9373522458628841  
0.06264775413711583  
True label 1
0.1455621301775148  
0.8544378698224852  

Train_result {'acc': [0.9119280241877563], 'loss': [0.2131124131667972]}
9

Epoch 1/1
 - 685s - loss: 0.1897 - acc: 0.9230

Test accuracy: 88.82318154937907

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  809

choose_one :  882

F1score :  0.8905616676317314

AUC : 0.9577384699315958

Confusion Matrix
[[733 113]
 [ 76 769]]
True label 0
0.8664302600472813  
0.13356973995271867  
True label 1
0.08994082840236686  
0.9100591715976332  

Train_result {'acc': [0.9229633794980817], 'loss': [0.18969874757360305]}
10

Epoch 1/1
 - 686s - loss: 0.1724 - acc: 0.9304

Test accuracy: 88.52749852158486

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  886

choose_one :  805

F1score :  0.8824242424242423

AUC : 0.9530690894848013

Confusion Matrix
[[769  77]
 [117 728]]
True label 0
0.9089834515366431  
0.09101654846335698  
True label 1
0.13846153846153847  
0.8615384615384616  

Train_result {'acc': [0.9304140015840614], 'loss': [0.1724245149696955]}
11

Epoch 1/1
 - 687s - loss: 0.1504 - acc: 0.9390

Test accuracy: 89.71023063276168

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  840

choose_one :  851

F1score :  0.8974056603773586

AUC : 0.9575027627400786

Confusion Matrix
[[756  90]
 [ 84 761]]
True label 0
0.8936170212765957  
0.10638297872340426  
True label 1
0.09940828402366864  
0.9005917159763314  

Train_result {'acc': [0.9389892457792912], 'loss': [0.150375764169453]}
12

Epoch 1/1
 - 688s - loss: 0.1365 - acc: 0.9446

Test accuracy: 89.8876404494382

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  917

choose_one :  774

F1score :  0.8943792464484249

AUC : 0.9590023360890791

Confusion Matrix
[[796  50]
 [121 724]]
True label 0
0.9408983451536643  
0.0591016548463357  
True label 1
0.14319526627218934  
0.8568047337278106  

Train_result {'acc': [0.9446123567863921], 'loss': [0.13651404907713383]}
13

Epoch 1/1
 - 686s - loss: 0.1185 - acc: 0.9555

Test accuracy: 88.2909520993495

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  876

choose_one :  815

F1score :  0.880722891566265

AUC : 0.9523025165414691

Confusion Matrix
[[762  84]
 [114 731]]
True label 0
0.900709219858156  
0.09929078014184398  
True label 1
0.1349112426035503  
0.8650887573964497  

Train_result {'acc': [0.9555071343513905], 'loss': [0.11851004600355226]}
14

Epoch 1/1
 - 687s - loss: 0.0979 - acc: 0.9630

Test accuracy: 90.77468953282082

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  862

choose_one :  829

F1score :  0.9068100358422939

AUC : 0.9612342104158798

Confusion Matrix
[[776  70]
 [ 86 759]]
True label 0
0.91725768321513  
0.08274231678486997  
True label 1
0.10177514792899409  
0.8982248520710059  

Train_result {'acc': [0.9629577563577688], 'loss': [0.09786108545809744]}
15

Epoch 1/1
 - 680s - loss: 0.0893 - acc: 0.9675

Test accuracy: 90.12418687167356

data size :  15918

zero :  7960

one :  7958

train_zero :  7114

train_one :  7113

test_zero :  846

test_one :  845

choose_zero :  829

choose_one :  862

F1score :  0.9021675454012889

AUC : 0.9599192860240323

Confusion Matrix
[[754  92]
 [ 75 770]]
True label 0
0.8912529550827423  
0.10874704491725769  
True label 1
0.08875739644970414  
0.9112426035502958  

Train_result {'acc': [0.967456245167639], 'loss': [0.08932312510557038]}
Saved model to disk




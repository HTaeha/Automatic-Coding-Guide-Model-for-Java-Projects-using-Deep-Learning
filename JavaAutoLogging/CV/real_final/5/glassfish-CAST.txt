Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 12:21:52.828315: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 12:21:52.838857: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-04 12:21:52.840821: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x73bb020 executing computations on platform Host. Devices:
2019-08-04 12:21:52.840864: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST
all data

Sentence length Average : 71

Under 10 : 9739
Over 10, Under 200 : 26001
Over 200, Under 400 : 2683
Over 400 : 1019

glassfish-CAST
updated_train_data

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 23076
Over 200, Under 400 : 3162
Over 400 : 0


Test_zero:  2282
Train_zero:  20349
zero:  22631
Test_one:  676
Train_one:  5889
one:  6565

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 270s - loss: 0.4648 - acc: 0.7864

Test accuracy: 80.48780487804879

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  723

choose_one :  630

F1score :  0.7978560490045942

AUC : 0.9014403957592231

Confusion Matrix
[[568 109]
 [155 521]]
True label 0
0.8389955686853766  
0.16100443131462333  
True label 1
0.22928994082840237  
0.7707100591715976  

Train_result {'acc': [0.7863995245826985], 'loss': [0.46476015921197283]}
2

Epoch 1/1
 - 275s - loss: 0.3443 - acc: 0.8586

Test accuracy: 87.50923872875093

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  676

choose_one :  677

F1score :  0.8750923872875093

AUC : 0.9438831251693427

Confusion Matrix
[[592  85]
 [ 84 592]]
True label 0
0.8744460856720827  
0.1255539143279173  
True label 1
0.1242603550295858  
0.8757396449704142  

Train_result {'acc': [0.8585618473554631], 'loss': [0.34431472630566173]}
3

Epoch 1/1
 - 285s - loss: 0.2889 - acc: 0.8836

Test accuracy: 88.83961566888397

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  666

choose_one :  687

F1score :  0.8892149669845928

AUC : 0.9542315995559947

Confusion Matrix
[[596  81]
 [ 70 606]]
True label 0
0.880354505169867  
0.11964549483013294  
True label 1
0.10355029585798817  
0.8964497041420119  

Train_result {'acc': [0.8836064182018847], 'loss': [0.28887401254277895]}
4

Epoch 1/1
 - 288s - loss: 0.2513 - acc: 0.8975

Test accuracy: 90.0960827790096

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  703

choose_one :  650

F1score :  0.8989441930618401

AUC : 0.9597226713747564

Confusion Matrix
[[623  54]
 [ 80 596]]
True label 0
0.9202363367799113  
0.07976366322008863  
True label 1
0.11834319526627218  
0.8816568047337278  

Train_result {'acc': [0.8975295016554886], 'loss': [0.25132749602799503]}
5

Epoch 1/1
 - 287s - loss: 0.2242 - acc: 0.9123

Test accuracy: 89.65262379896527

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  675

choose_one :  678

F1score :  0.896602658788774

AUC : 0.9603519704928637

Confusion Matrix
[[606  71]
 [ 69 607]]
True label 0
0.8951255539143279  
0.10487444608567208  
True label 1
0.10207100591715976  
0.8979289940828402  

Train_result {'acc': [0.912301553612361], 'loss': [0.22418345677315232]}
6

Epoch 1/1
 - 288s - loss: 0.1936 - acc: 0.9234

Test accuracy: 87.95269770879527

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  594

choose_one :  759

F1score :  0.886411149825784

AUC : 0.9624758550164753

Confusion Matrix
[[554 123]
 [ 40 636]]
True label 0
0.8183161004431314  
0.18168389955686853  
True label 1
0.05917159763313609  
0.9408284023668639  

Train_result {'acc': [0.9234230410077088], 'loss': [0.19364017102924608]}
7

Epoch 1/1
 - 288s - loss: 0.1708 - acc: 0.9346

Test accuracy: 90.31781226903178

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  726

choose_one :  627

F1score :  0.8994627782041443

AUC : 0.9697040546091791

Confusion Matrix
[[636  41]
 [ 90 586]]
True label 0
0.9394387001477105  
0.060561299852289516  
True label 1
0.13313609467455623  
0.8668639053254438  

Train_result {'acc': [0.9346294252483233], 'loss': [0.17083568200380464]}
8

Epoch 1/1
 - 289s - loss: 0.1503 - acc: 0.9454

Test accuracy: 90.9830007390983

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  649

choose_one :  704

F1score :  0.9115942028985508

AUC : 0.9671868581367502

Confusion Matrix
[[602  75]
 [ 47 629]]
True label 0
0.8892171344165436  
0.11078286558345643  
True label 1
0.0695266272189349  
0.9304733727810651  

Train_result {'acc': [0.9454113252398336], 'loss': [0.15026820558780726]}
9

Epoch 1/1
 - 288s - loss: 0.1267 - acc: 0.9525

Test accuracy: 90.53954175905396

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  657

choose_one :  696

F1score :  0.9067055393586005

AUC : 0.9677003487365946

Confusion Matrix
[[603  74]
 [ 54 622]]
True label 0
0.8906942392909897  
0.10930576070901034  
True label 1
0.07988165680473373  
0.9201183431952663  

Train_result {'acc': [0.9524577638220226], 'loss': [0.12665474765880047]}
10

Epoch 1/1
 - 287s - loss: 0.1101 - acc: 0.9598

Test accuracy: 90.61345158906134

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  640

choose_one :  713

F1score :  0.9085673146148309

AUC : 0.9731280536302693

Confusion Matrix
[[595  82]
 [ 45 631]]
True label 0
0.8788774002954209  
0.12112259970457903  
True label 1
0.06656804733727811  
0.9334319526627219  

Train_result {'acc': [0.9598437897953986], 'loss': [0.11014882200591898]}
11

Epoch 1/1
 - 289s - loss: 0.0972 - acc: 0.9650

Test accuracy: 89.65262379896527

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  645

choose_one :  708

F1score :  0.8988439306358381

AUC : 0.96548906155769

Confusion Matrix
[[591  86]
 [ 54 622]]
True label 0
0.8729689807976366  
0.12703101920236337  
True label 1
0.07988165680473373  
0.9201183431952663  

Train_result {'acc': [0.9650224976703968], 'loss': [0.09718255983572761]}
12

Epoch 1/1
 - 288s - loss: 0.0856 - acc: 0.9723

Test accuracy: 91.42645971914266

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  651

choose_one :  702

F1score :  0.9158200290275762

AUC : 0.9734831269173957

Confusion Matrix
[[606  71]
 [ 45 631]]
True label 0
0.8951255539143279  
0.10487444608567208  
True label 1
0.06656804733727811  
0.9334319526627219  

Train_result {'acc': [0.972323626793446], 'loss': [0.08560369617966984]}
13

Epoch 1/1
 - 288s - loss: 0.0745 - acc: 0.9749

Test accuracy: 90.68736141906874

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  671

choose_one :  682

F1score :  0.9072164948453608

AUC : 0.9686158915507853

Confusion Matrix
[[611  66]
 [ 60 616]]
True label 0
0.9025110782865583  
0.09748892171344166  
True label 1
0.08875739644970414  
0.9112426035502958  

Train_result {'acc': [0.9748705323032516], 'loss': [0.07449702861455464]}
14

Epoch 1/1
 - 289s - loss: 0.0643 - acc: 0.9778

Test accuracy: 90.83518107908351

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  679

choose_one :  674

F1score :  0.9081481481481481

AUC : 0.9700438324316292

Confusion Matrix
[[616  61]
 [ 63 613]]
True label 0
0.9098966026587888  
0.09010339734121123  
True label 1
0.09319526627218935  
0.9068047337278107  

Train_result {'acc': [0.9778419220646914], 'loss': [0.06429801974840914]}
15

Epoch 1/1
 - 289s - loss: 0.0594 - acc: 0.9797

Test accuracy: 90.39172209903917

data size :  13132

zero :  6567

one :  6565

train_zero :  5890

train_one :  5889

test_zero :  677

test_one :  676

choose_zero :  657

choose_one :  696

F1score :  0.9052478134110787

AUC : 0.9685547096920805

Confusion Matrix
[[602  75]
 [ 55 621]]
True label 0
0.8892171344165436  
0.11078286558345643  
True label 1
0.08136094674556213  
0.9186390532544378  

Train_result {'acc': [0.9797096527718822], 'loss': [0.059441884132152734]}
Saved model to disk




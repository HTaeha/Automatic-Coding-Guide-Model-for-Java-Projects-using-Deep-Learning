Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-05 00:02:00.999818: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-05 00:02:01.010545: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-05 00:02:01.012357: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xddda450 executing computations on platform Host. Devices:
2019-08-05 00:02:01.012385: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
31687
one : 
7755

Second data
zero : 
31687
one : 
7755

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15189
Over 200, Under 400 : 608
Over 400 : 0


glassfish-code

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 14711
Over 200, Under 400 : 1086
Over 400 : 0


Test_zero:  1212
Train_zero:  10606
zero:  11818
Test_one:  592
Train_one:  5191
one:  5783
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 422s - loss: 0.5421 - acc: 0.7372

Test accuracy: 76.45569620253164

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  816

choose_one :  369

F1score :  0.7096774193548386

AUC : 0.894163609224739

Confusion Matrix
[[565  28]
 [251 341]]
True label 0
0.9527824620573356  
0.047217537942664416  
True label 1
0.4239864864864865  
0.5760135135135135  

Train_result {'loss': [0.5421025695155998], 'acc': [0.7371665222341932]}
2

Epoch 1/1
 - 420s - loss: 0.3990 - acc: 0.8233

Test accuracy: 81.35021097046413

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  738

choose_one :  447

F1score :  0.7872954764196343

AUC : 0.9129754227245795

Confusion Matrix
[[555  38]
 [183 409]]
True label 0
0.9359190556492412  
0.06408094435075885  
True label 1
0.3091216216216216  
0.6908783783783784  

Train_result {'loss': [0.39902380575257024], 'acc': [0.8232688047942612]}
3

Epoch 1/1
 - 420s - loss: 0.3445 - acc: 0.8525

Test accuracy: 83.88185654008439

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  720

choose_one :  465

F1score :  0.8192999053926207

AUC : 0.9331004170274828

Confusion Matrix
[[561  32]
 [159 433]]
True label 0
0.9460370994940978  
0.05396290050590219  
True label 1
0.2685810810810811  
0.731418918918919  

Train_result {'loss': [0.34452098989192775], 'acc': [0.8525474333274023]}
4

Epoch 1/1
 - 425s - loss: 0.3078 - acc: 0.8754

Test accuracy: 85.65400843881856

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  669

choose_one :  516

F1score :  0.8465703971119133

AUC : 0.9415520600701882

Confusion Matrix
[[546  47]
 [123 469]]
True label 0
0.9207419898819561  
0.07925801011804384  
True label 1
0.20777027027027026  
0.7922297297297297  

Train_result {'loss': [0.3078146001795325], 'acc': [0.8753732062081869]}
5

Epoch 1/1
 - 429s - loss: 0.2770 - acc: 0.8876

Test accuracy: 85.82278481012658

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  549

choose_one :  636

F1score :  0.8631921824104235

AUC : 0.9409453192653023

Confusion Matrix
[[487 106]
 [ 62 530]]
True label 0
0.821247892074199  
0.178752107925801  
True label 1
0.10472972972972973  
0.8952702702702703  

Train_result {'loss': [0.2770342534402771], 'acc': [0.8876047385263612]}
6

Epoch 1/1
 - 429s - loss: 0.2546 - acc: 0.9012

Test accuracy: 86.83544303797468

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  665

choose_one :  520

F1score :  0.8597122302158274

AUC : 0.9433238571623901

Confusion Matrix
[[551  42]
 [114 478]]
True label 0
0.9291736930860034  
0.07082630691399663  
True label 1
0.19256756756756757  
0.8074324324324325  

Train_result {'loss': [0.2546199014349203], 'acc': [0.9011846287487261]}
7

Epoch 1/1
 - 429s - loss: 0.2245 - acc: 0.9123

Test accuracy: 89.36708860759494

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  609

choose_one :  576

F1score :  0.8921232876712328

AUC : 0.9517185292375004

Confusion Matrix
[[538  55]
 [ 71 521]]
True label 0
0.9072512647554806  
0.09274873524451939  
True label 1
0.11993243243243243  
0.8800675675675675  

Train_result {'loss': [0.22449554025489654], 'acc': [0.9122604257073302]}
8

Epoch 1/1
 - 429s - loss: 0.1962 - acc: 0.9230

Test accuracy: 89.28270042194093

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  600

choose_one :  585

F1score :  0.8920985556499574

AUC : 0.9531712889111708

Confusion Matrix
[[533  60]
 [ 67 525]]
True label 0
0.8988195615514334  
0.10118043844856661  
True label 1
0.11317567567567567  
0.8868243243243243  

Train_result {'loss': [0.19624872725529788], 'acc': [0.9229509775652128]}
9

Epoch 1/1
 - 429s - loss: 0.1786 - acc: 0.9315

Test accuracy: 89.0295358649789

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  607

choose_one :  578

F1score :  0.8888888888888888

AUC : 0.9522056310104371

Confusion Matrix
[[535  58]
 [ 72 520]]
True label 0
0.9021922428330523  
0.09780775716694773  
True label 1
0.12162162162162163  
0.8783783783783784  

Train_result {'loss': [0.17863134517770599], 'acc': [0.9315226813059809]}
10

Epoch 1/1
 - 430s - loss: 0.1562 - acc: 0.9399

Test accuracy: 89.19831223628692

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  635

choose_one :  550

F1score :  0.8879159369527146

AUC : 0.954558531972107

Confusion Matrix
[[550  43]
 [ 85 507]]
True label 0
0.927487352445194  
0.07251264755480608  
True label 1
0.14358108108108109  
0.856418918918919  

Train_result {'loss': [0.15624712714926306], 'acc': [0.9399017624963883]}
11

Epoch 1/1
 - 429s - loss: 0.1380 - acc: 0.9498

Test accuracy: 88.69198312236287

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  625

choose_one :  560

F1score :  0.8836805555555556

AUC : 0.9532937764915

Confusion Matrix
[[542  51]
 [ 83 509]]
True label 0
0.9139966273187183  
0.08600337268128162  
True label 1
0.14020270270270271  
0.8597972972972973  

Train_result {'loss': [0.13798974826537289], 'acc': [0.9498218241470875]}
12

Epoch 1/1
 - 429s - loss: 0.1158 - acc: 0.9595

Test accuracy: 89.62025316455696

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  618

choose_one :  567

F1score :  0.8938740293356341

AUC : 0.9532296841529557

Confusion Matrix
[[544  49]
 [ 74 518]]
True label 0
0.9173693086003373  
0.08263069139966273  
True label 1
0.125  
0.875  

Train_result {'loss': [0.11576448866314802], 'acc': [0.9595492632244635]}
13

Epoch 1/1
 - 429s - loss: 0.1006 - acc: 0.9643

Test accuracy: 89.19831223628692

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  597

choose_one :  588

F1score :  0.8915254237288134

AUC : 0.951816804156602

Confusion Matrix
[[531  62]
 [ 66 526]]
True label 0
0.8954468802698144  
0.1045531197301855  
True label 1
0.11148648648648649  
0.8885135135135135  

Train_result {'loss': [0.10057826540796591], 'acc': [0.9642685158489458]}
14

Epoch 1/1
 - 429s - loss: 0.0877 - acc: 0.9680

Test accuracy: 88.52320675105486

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  571

choose_one :  614

F1score :  0.8872305140961857

AUC : 0.9505905040791214

Confusion Matrix
[[514  79]
 [ 57 535]]
True label 0
0.866779089376054  
0.13322091062394603  
True label 1
0.09628378378378379  
0.9037162162162162  

Train_result {'loss': [0.08774255887628302], 'acc': [0.9680246556929216]}
15

Epoch 1/1
 - 429s - loss: 0.0745 - acc: 0.9727

Test accuracy: 90.12658227848101

data size :  11568

zero :  5785

one :  5783

train_zero :  5192

train_one :  5191

test_zero :  593

test_one :  592

choose_zero :  590

choose_one :  595

F1score :  0.9014321819713564

AUC : 0.9524790916548925

Confusion Matrix
[[533  60]
 [ 57 535]]
True label 0
0.8988195615514334  
0.10118043844856661  
True label 1
0.09628378378378379  
0.9037162162162162  

Train_result {'loss': [0.07454347222983165], 'acc': [0.9727439083174039]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 10:12:27.811243: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 10:12:27.821164: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-04 10:12:27.824071: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7016680 executing computations on platform Host. Devices:
2019-08-04 10:12:27.824111: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST
all data

Sentence length Average : 55

Under 10 : 5732
Over 10, Under 200 : 50810
Over 200, Under 400 : 1896
Over 400 : 292

guava-CAST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 45596
Over 200, Under 400 : 1922
Over 400 : 0


Test_zero:  4201
Train_zero:  37102
zero:  41303
Test_one:  1118
Train_one:  10416
one:  11534

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 493s - loss: 0.2720 - acc: 0.8944

Test accuracy: 92.31113097898972

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1177

choose_one :  1060

F1score :  0.921028466483012

AUC : 0.9782553263599464

Confusion Matrix
[[1062   57]
 [ 115 1003]]
True label 0
0.9490616621983914  
0.05093833780160858  
True label 1
0.10286225402504472  
0.8971377459749553  

Train_result {'acc': [0.8943503096049537], 'loss': [0.2719909583171439]}
2

Epoch 1/1
 - 492s - loss: 0.1782 - acc: 0.9309

Test accuracy: 90.61242735806884

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1285

choose_one :  952

F1score :  0.8985507246376812

AUC : 0.9863517771585606

Confusion Matrix
[[1097   22]
 [ 188  930]]
True label 0
0.9803395889186773  
0.01966041108132261  
True label 1
0.16815742397137745  
0.8318425760286225  

Train_result {'acc': [0.9309268948303173], 'loss': [0.17821313512161305]}
3

Epoch 1/1
 - 492s - loss: 0.1432 - acc: 0.9475

Test accuracy: 93.83102369244524

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1105

choose_one :  1132

F1score :  0.9386666666666666

AUC : 0.9869153073997515

Confusion Matrix
[[1043   76]
 [  62 1056]]
True label 0
0.9320822162645219  
0.0679177837354781  
True label 1
0.055456171735241505  
0.9445438282647585  

Train_result {'acc': [0.947535160562569], 'loss': [0.1431744309365451]}
4

Epoch 1/1
 - 494s - loss: 0.1175 - acc: 0.9561

Test accuracy: 95.12740277156907

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1138

choose_one :  1099

F1score :  0.9508344609833107

AUC : 0.9915810180633423

Confusion Matrix
[[1074   45]
 [  64 1054]]
True label 0
0.9597855227882037  
0.040214477211796246  
True label 1
0.057245080500894455  
0.9427549194991055  

Train_result {'acc': [0.9561272980367685], 'loss': [0.1174911262003473]}
5

Epoch 1/1
 - 499s - loss: 0.0998 - acc: 0.9635

Test accuracy: 95.52972731336612

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1127

choose_one :  1110

F1score :  0.955116696588869

AUC : 0.9933931075055833

Confusion Matrix
[[1073   46]
 [  54 1064]]
True label 0
0.9588918677390528  
0.041108132260947276  
True label 1
0.04830053667262969  
0.9516994633273703  

Train_result {'acc': [0.9634714155426487], 'loss': [0.09979234891538218]}
6

Epoch 1/1
 - 499s - loss: 0.0844 - acc: 0.9704

Test accuracy: 95.93205185516317

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1082

choose_one :  1155

F1score :  0.9599648042234932

AUC : 0.9935229992278437

Confusion Matrix
[[1055   64]
 [  27 1091]]
True label 0
0.9428060768543343  
0.05719392314566577  
True label 1
0.024150268336314847  
0.9758497316636852  

Train_result {'acc': [0.9703835261364182], 'loss': [0.0843733129304487]}
7

Epoch 1/1
 - 498s - loss: 0.0727 - acc: 0.9746

Test accuracy: 96.73670093875727

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1122

choose_one :  1115

F1score :  0.9673085535154501

AUC : 0.9952191852871447

Confusion Matrix
[[1084   35]
 [  38 1080]]
True label 0
0.968722073279714  
0.03127792672028597  
True label 1
0.03398926654740608  
0.9660107334525939  

Train_result {'acc': [0.9745595929534873], 'loss': [0.07274721483172694]}
8

Epoch 1/1
 - 499s - loss: 0.0621 - acc: 0.9783

Test accuracy: 96.7814036656236

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1143

choose_one :  1094

F1score :  0.9674502712477396

AUC : 0.9953630653487253

Confusion Matrix
[[1095   24]
 [  48 1070]]
True label 0
0.9785522788203753  
0.021447721179624665  
True label 1
0.04293381037567084  
0.9570661896243292  

Train_result {'acc': [0.9782556520904334], 'loss': [0.062135131603979606]}
9

Epoch 1/1
 - 498s - loss: 0.0561 - acc: 0.9805

Test accuracy: 97.8095663835494

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1104

choose_one :  1133

F1score :  0.9782318969346956

AUC : 0.9959941392854916

Confusion Matrix
[[1087   32]
 [  17 1101]]
True label 0
0.9714030384271671  
0.028596961572832886  
True label 1
0.01520572450805009  
0.9847942754919499  

Train_result {'acc': [0.9804636874189987], 'loss': [0.056137358119216586]}
10

Epoch 1/1
 - 499s - loss: 0.0504 - acc: 0.9830

Test accuracy: 97.54135002235135

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1090

choose_one :  1147

F1score :  0.9757174392935983

AUC : 0.9961839810334105

Confusion Matrix
[[1077   42]
 [  13 1105]]
True label 0
0.9624664879356568  
0.03753351206434316  
True label 1
0.011627906976744186  
0.9883720930232558  

Train_result {'acc': [0.9829597273556376], 'loss': [0.05035261422051757]}
11

Epoch 1/1
 - 499s - loss: 0.0437 - acc: 0.9851

Test accuracy: 97.63075547608405

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1118

choose_one :  1119

F1score :  0.9763075547608404

AUC : 0.9960768703209005

Confusion Matrix
[[1092   27]
 [  26 1092]]
True label 0
0.9758713136729222  
0.024128686327077747  
True label 1
0.023255813953488372  
0.9767441860465116  

Train_result {'acc': [0.9851197619161907], 'loss': [0.04368230512610331]}
12

Epoch 1/1
 - 498s - loss: 0.0407 - acc: 0.9861

Test accuracy: 97.72016092981673

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1102

choose_one :  1135

F1score :  0.9773635153129161

AUC : 0.997263880828941

Confusion Matrix
[[1085   34]
 [  17 1101]]
True label 0
0.9696157283288651  
0.03038427167113494  
True label 1
0.01520572450805009  
0.9847942754919499  

Train_result {'acc': [0.9861277780444487], 'loss': [0.04065418801840901]}
13

Epoch 1/1
 - 499s - loss: 0.0379 - acc: 0.9874

Test accuracy: 97.76486365668305

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1113

choose_one :  1124

F1score :  0.9776984834968777

AUC : 0.9962691100698458

Confusion Matrix
[[1091   28]
 [  22 1096]]
True label 0
0.9749776586237712  
0.025022341376228777  
True label 1
0.01967799642218247  
0.9803220035778175  

Train_result {'acc': [0.9874237987807805], 'loss': [0.037851557792594276]}
14

Epoch 1/1
 - 502s - loss: 0.0379 - acc: 0.9884

Test accuracy: 97.98837729101476

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1096

choose_one :  1141

F1score :  0.9800796812749003

AUC : 0.9965648635297616

Confusion Matrix
[[1085   34]
 [  11 1107]]
True label 0
0.9696157283288651  
0.03038427167113494  
True label 1
0.009838998211091235  
0.9901610017889088  

Train_result {'acc': [0.9884318149090385], 'loss': [0.0378799794448465]}
15

Epoch 1/1
 - 502s - loss: 0.0353 - acc: 0.9889

Test accuracy: 96.91551184622263

data size :  23070

zero :  11536

one :  11534

train_zero :  10417

train_one :  10416

test_zero :  1119

test_one :  1118

choose_zero :  1152

choose_one :  1085

F1score :  0.9686790739900136

AUC : 0.9943870789310031

Confusion Matrix
[[1101   18]
 [  51 1067]]
True label 0
0.9839142091152815  
0.0160857908847185  
True label 1
0.04561717352415027  
0.9543828264758497  

Train_result {'acc': [0.9889118225891614], 'loss': [0.03534755729634828]}
Saved model to disk




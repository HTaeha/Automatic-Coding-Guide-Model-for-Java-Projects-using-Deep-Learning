Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-03 23:11:47.065829: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-03 23:11:47.076649: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-03 23:11:47.078180: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6f232e0 executing computations on platform Host. Devices:
2019-08-03 23:11:47.078259: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST_s
all data

Sentence length Average : 63

Under 10 : 8733
Over 10, Under 200 : 36158
Over 200, Under 400 : 2746
Over 400 : 833

hbase-CAST_s
updated_train_data

Sentence length Average : 70

Under 10 : 0
Over 10, Under 200 : 31645
Over 200, Under 400 : 3012
Over 400 : 0


Test_zero:  2922
Train_zero:  27119
zero:  30041
Test_one:  933
Train_one:  7538
one:  8471

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 340s - loss: 0.4035 - acc: 0.8182

Test accuracy: 85.59185859667916

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  957

choose_one :  910

F1score :  0.8540423223005967

AUC : 0.9363023885098151

Confusion Matrix
[[811 123]
 [146 787]]
True label 0
0.8683083511777302  
0.1316916488222698  
True label 1
0.1564844587352626  
0.8435155412647374  

Train_result {'acc': [0.8181999071433309], 'loss': [0.4035083432650664]}
2

Epoch 1/1
 - 337s - loss: 0.3219 - acc: 0.8602

Test accuracy: 86.87734333154793

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  819

choose_one :  1048

F1score :  0.8763250883392225

AUC : 0.9471731262235749

Confusion Matrix
[[754 180]
 [ 65 868]]
True label 0
0.8072805139186295  
0.19271948608137046  
True label 1
0.06966773847802786  
0.9303322615219721  

Train_result {'acc': [0.8601843868222597], 'loss': [0.321871561709802]}
3

Epoch 1/1
 - 358s - loss: 0.2899 - acc: 0.8762

Test accuracy: 87.78789501874665

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  830

choose_one :  1037

F1score :  0.8842639593908629

AUC : 0.9505928241426083

Confusion Matrix
[[768 166]
 [ 62 871]]
True label 0
0.8222698072805139  
0.1777301927194861  
True label 1
0.06645230439442658  
0.9335476956055734  

Train_result {'acc': [0.8761689991377595], 'loss': [0.2898506830851208]}
4

Epoch 1/1
 - 359s - loss: 0.2626 - acc: 0.8890

Test accuracy: 86.44884841992501

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  1089

choose_one :  778

F1score :  0.8521332554061951

AUC : 0.9568113956269179

Confusion Matrix
[[885  49]
 [204 729]]
True label 0
0.9475374732334048  
0.05246252676659529  
True label 1
0.21864951768488747  
0.7813504823151125  

Train_result {'acc': [0.8889699542428341], 'loss': [0.2625901707368195]}
5

Epoch 1/1
 - 358s - loss: 0.2388 - acc: 0.9004

Test accuracy: 89.23406534547402

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  899

choose_one :  968

F1score :  0.8942661756970015

AUC : 0.9581924716153598

Confusion Matrix
[[816 118]
 [ 83 850]]
True label 0
0.8736616702355461  
0.12633832976445397  
True label 1
0.08896034297963558  
0.9110396570203644  

Train_result {'acc': [0.9004443854878291], 'loss': [0.23884721920088953]}
6

Epoch 1/1
 - 359s - loss: 0.2148 - acc: 0.9119

Test accuracy: 88.75200856989824

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  876

choose_one :  991

F1score :  0.8908523908523909

AUC : 0.9598833860058618

Confusion Matrix
[[800 134]
 [ 76 857]]
True label 0
0.8565310492505354  
0.14346895074946467  
True label 1
0.08145766345123258  
0.9185423365487674  

Train_result {'acc': [0.9119188167407309], 'loss': [0.21478416494487254]}
7

Epoch 1/1
 - 363s - loss: 0.1890 - acc: 0.9241

Test accuracy: 89.4483128012855

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  863

choose_one :  1004

F1score :  0.8982963345379452

AUC : 0.961206510737622

Confusion Matrix
[[800 134]
 [ 63 870]]
True label 0
0.8565310492505354  
0.14346895074946467  
True label 1
0.06752411575562701  
0.932475884244373  

Train_result {'acc': [0.9241228361079791], 'loss': [0.1890335195040785]}
8

Epoch 1/1
 - 364s - loss: 0.1599 - acc: 0.9373

Test accuracy: 89.50187466523835

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  906

choose_one :  961

F1score :  0.8965153115100317

AUC : 0.9608754426672725

Confusion Matrix
[[822 112]
 [ 84 849]]
True label 0
0.880085653104925  
0.11991434689507495  
True label 1
0.09003215434083602  
0.909967845659164  

Train_result {'acc': [0.9372554221662135], 'loss': [0.15993906932832405]}
9

Epoch 1/1
 - 362s - loss: 0.1392 - acc: 0.9459

Test accuracy: 89.87680771290842

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  877

choose_one :  990

F1score :  0.9017160686427458

AUC : 0.9633231660435473

Confusion Matrix
[[811 123]
 [ 66 867]]
True label 0
0.8683083511777302  
0.1316916488222698  
True label 1
0.0707395498392283  
0.9292604501607717  

Train_result {'acc': [0.9458778271539431], 'loss': [0.13919236545772257]}
10

Epoch 1/1
 - 362s - loss: 0.1174 - acc: 0.9554

Test accuracy: 89.66256025709694

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  931

choose_one :  936

F1score :  0.8967362225789192

AUC : 0.9622570924305331

Confusion Matrix
[[836  98]
 [ 95 838]]
True label 0
0.8950749464668094  
0.10492505353319058  
True label 1
0.10182207931404073  
0.8981779206859593  

Train_result {'acc': [0.9553624726404457], 'loss': [0.11740592943855684]}
11

Epoch 1/1
 - 361s - loss: 0.1031 - acc: 0.9613

Test accuracy: 89.39475093733262

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  886

choose_one :  981

F1score :  0.8965517241379312

AUC : 0.9630270982371344

Confusion Matrix
[[811 123]
 [ 75 858]]
True label 0
0.8683083511777302  
0.1316916488222698  
True label 1
0.08038585209003216  
0.9196141479099679  

Train_result {'acc': [0.9613318299396432], 'loss': [0.10309654296827173]}
12

Epoch 1/1
 - 363s - loss: 0.0847 - acc: 0.9684

Test accuracy: 90.3588644884842

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  940

choose_one :  927

F1score :  0.9032258064516129

AUC : 0.9632216079006499

Confusion Matrix
[[847  87]
 [ 93 840]]
True label 0
0.9068522483940042  
0.09314775160599571  
True label 1
0.09967845659163987  
0.9003215434083601  

Train_result {'acc': [0.9684287325064668], 'loss': [0.08469114902981531]}
13

Epoch 1/1
 - 362s - loss: 0.0725 - acc: 0.9730

Test accuracy: 90.68023567220139

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  900

choose_one :  967

F1score :  0.908421052631579

AUC : 0.961730367147031

Confusion Matrix
[[830 104]
 [ 70 863]]
True label 0
0.8886509635974305  
0.11134903640256959  
True label 1
0.07502679528403002  
0.92497320471597  

Train_result {'acc': [0.9730052397691848], 'loss': [0.07252789689906995]}
14

Epoch 1/1
 - 363s - loss: 0.0647 - acc: 0.9757

Test accuracy: 89.39475093733262

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  998

choose_one :  869

F1score :  0.8901220865704772

AUC : 0.9615720052970891

Confusion Matrix
[[867  67]
 [131 802]]
True label 0
0.9282655246252677  
0.07173447537473233  
True label 1
0.14040728831725616  
0.8595927116827439  

Train_result {'acc': [0.9757246136538837], 'loss': [0.06465833723557923]}
15

Epoch 1/1
 - 361s - loss: 0.0609 - acc: 0.9776

Test accuracy: 88.9662560257097

data size :  16944

zero :  8473

one :  8471

train_zero :  7539

train_one :  7538

test_zero :  934

test_one :  933

choose_zero :  964

choose_one :  903

F1score :  0.8877995642701524

AUC : 0.9563598348446563

Confusion Matrix
[[846  88]
 [118 815]]
True label 0
0.9057815845824411  
0.09421841541755889  
True label 1
0.1264737406216506  
0.8735262593783494  

Train_result {'acc': [0.9776480732241162], 'loss': [0.060898703431806096]}
Saved model to disk




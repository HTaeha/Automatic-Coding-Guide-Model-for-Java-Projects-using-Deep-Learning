Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 00:45:41.163868: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 00:45:41.173291: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-04 00:45:41.176045: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x641eb10 executing computations on platform Host. Devices:
2019-08-04 00:45:41.176113: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST_s
all data

Sentence length Average : 42

Under 10 : 7428
Over 10, Under 200 : 50330
Over 200, Under 400 : 889
Over 400 : 83

guava-CAST_s
updated_train_data

Sentence length Average : 46

Under 10 : 0
Over 10, Under 200 : 44690
Over 200, Under 400 : 847
Over 400 : 0


Test_zero:  4005
Train_zero:  35376
zero:  39381
Test_one:  1086
Train_one:  10161
one:  11247

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 456s - loss: 0.2569 - acc: 0.8964

Test accuracy: 92.22273354809019

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1004

choose_one :  1169

F1score :  0.9250554323725055

AUC : 0.9784668465931713

Confusion Matrix
[[ 961  126]
 [  43 1043]]
True label 0
0.8840846366145354  
0.11591536338546458  
True label 1
0.03959484346224678  
0.9604051565377533  

Train_result {'loss': [0.25686948487191147], 'acc': [0.8964227722285095]}
2

Epoch 1/1
 - 493s - loss: 0.1774 - acc: 0.9298

Test accuracy: 93.235158766682

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1024

choose_one :  1149

F1score :  0.934228187919463

AUC : 0.984559273246013

Confusion Matrix
[[ 982  105]
 [  42 1044]]
True label 0
0.9034038638454461  
0.09659613615455381  
True label 1
0.03867403314917127  
0.9613259668508287  

Train_result {'loss': [0.1774492818395324], 'acc': [0.9297839885843625]}
3

Epoch 1/1
 - 494s - loss: 0.1456 - acc: 0.9411

Test accuracy: 94.47768062586286

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1119

choose_one :  1054

F1score :  0.9439252336448598

AUC : 0.988721979665933

Confusion Matrix
[[1043   44]
 [  76 1010]]
True label 0
0.9595216191352346  
0.040478380864765406  
True label 1
0.06998158379373849  
0.9300184162062615  

Train_result {'loss': [0.14563086949541484], 'acc': [0.9411012153717463]}
4

Epoch 1/1
 - 496s - loss: 0.1208 - acc: 0.9540

Test accuracy: 95.02991256327658

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1093

choose_one :  1080

F1score :  0.9501385041551246

AUC : 0.9920875540668981

Confusion Matrix
[[1036   51]
 [  57 1029]]
True label 0
0.953081876724931  
0.046918123275068994  
True label 1
0.052486187845303865  
0.9475138121546961  

Train_result {'loss': [0.12075118722893796], 'acc': [0.9539930128425922]}
5

Epoch 1/1
 - 498s - loss: 0.1000 - acc: 0.9602

Test accuracy: 95.21398987574781

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1119

choose_one :  1054

F1score :  0.9514018691588786

AUC : 0.9925797259085696

Confusion Matrix
[[1051   36]
 [  68 1018]]
True label 0
0.9668813247470102  
0.03311867525298988  
True label 1
0.06261510128913444  
0.9373848987108656  

Train_result {'loss': [0.0999945467570304], 'acc': [0.9601928849087241]}
6

Epoch 1/1
 - 498s - loss: 0.0821 - acc: 0.9684

Test accuracy: 95.95029912563277

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1069

choose_one :  1104

F1score :  0.9598173515981735

AUC : 0.9933569508048407

Confusion Matrix
[[1034   53]
 [  35 1051]]
True label 0
0.9512419503219871  
0.04875804967801288  
True label 1
0.03222836095764273  
0.9677716390423573  

Train_result {'loss': [0.08209974138559352], 'acc': [0.9683609703321165]}
7

Epoch 1/1
 - 498s - loss: 0.0719 - acc: 0.9724

Test accuracy: 96.6405890473999

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1100

choose_one :  1073

F1score :  0.9661880500231589

AUC : 0.9962434835939896

Confusion Matrix
[[1057   30]
 [  43 1043]]
True label 0
0.9724011039558418  
0.027598896044158234  
True label 1
0.03959484346224678  
0.9604051565377533  

Train_result {'loss': [0.07193348950137231], 'acc': [0.9724450130394134]}
8

Epoch 1/1
 - 497s - loss: 0.0602 - acc: 0.9775

Test accuracy: 96.77864703175334

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1085

choose_one :  1088

F1score :  0.9678012879484821

AUC : 0.9966035060255048

Confusion Matrix
[[1051   36]
 [  34 1052]]
True label 0
0.9668813247470102  
0.03311867525298988  
True label 1
0.03130755064456722  
0.9686924493554327  

Train_result {'loss': [0.06015701346731638], 'acc': [0.9775131624268071]}
9

Epoch 1/1
 - 496s - loss: 0.0563 - acc: 0.9780

Test accuracy: 97.23884031293143

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1047

choose_one :  1126

F1score :  0.972875226039783

AUC : 0.9958652482629977

Confusion Matrix
[[1037   50]
 [  10 1076]]
True label 0
0.954001839926403  
0.045998160073597055  
True label 1
0.009208103130755065  
0.990791896869245  

Train_result {'loss': [0.05626072436994897], 'acc': [0.9779560104315308]}
10

Epoch 1/1
 - 497s - loss: 0.0496 - acc: 0.9816

Test accuracy: 97.0547630004602

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1065

choose_one :  1108

F1score :  0.9708295350957156

AUC : 0.9951193664960586

Confusion Matrix
[[1044   43]
 [  21 1065]]
True label 0
0.9604415823367065  
0.03955841766329347  
True label 1
0.019337016574585635  
0.9806629834254144  

Train_result {'loss': [0.04962721008695491], 'acc': [0.9815972051370369]}
11

Epoch 1/1
 - 498s - loss: 0.0455 - acc: 0.9835

Test accuracy: 97.23884031293143

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1081

choose_one :  1092

F1score :  0.9724517906336089

AUC : 0.9961422537573635

Confusion Matrix
[[1054   33]
 [  27 1059]]
True label 0
0.9696412143514259  
0.03035878564857406  
True label 1
0.024861878453038673  
0.9751381215469613  

Train_result {'loss': [0.045481663831076], 'acc': [0.983467007823648]}
12

Epoch 1/1
 - 495s - loss: 0.0451 - acc: 0.9827

Test accuracy: 97.100782328578

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1056

choose_one :  1117

F1score :  0.9714026327734908

AUC : 0.9959097216221848

Confusion Matrix
[[1040   47]
 [  16 1070]]
True label 0
0.9567617295308187  
0.04323827046918123  
True label 1
0.014732965009208104  
0.9852670349907919  

Train_result {'loss': [0.04514440372663811], 'acc': [0.9827289278157753]}
13

Epoch 1/1
 - 501s - loss: 0.0393 - acc: 0.9853

Test accuracy: 97.83709157846296

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1086

choose_one :  1087

F1score :  0.9783709157846295

AUC : 0.9967432794400931

Confusion Matrix
[[1063   24]
 [  23 1063]]
True label 0
0.9779208831646734  
0.02207911683532659  
True label 1
0.02117863720073665  
0.9788213627992634  

Train_result {'loss': [0.03931335464998705], 'acc': [0.985287605179334]}
14

Epoch 1/1
 - 484s - loss: 0.0393 - acc: 0.9864

Test accuracy: 97.83709157846296

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1070

choose_one :  1103

F1score :  0.9785290086797624

AUC : 0.9966467087172867

Confusion Matrix
[[1055   32]
 [  15 1071]]
True label 0
0.9705611775528978  
0.029438822447102116  
True label 1
0.013812154696132596  
0.9861878453038674  

Train_result {'loss': [0.03930097151052625], 'acc': [0.9864193278551395]}
15

Epoch 1/1
 - 482s - loss: 0.0368 - acc: 0.9865

Test accuracy: 97.28485964104924

data size :  22496

zero :  11249

one :  11247

train_zero :  10162

train_one :  10161

test_zero :  1087

test_one :  1086

choose_zero :  1080

choose_one :  1093

F1score :  0.9729233593391463

AUC : 0.995363758193687

Confusion Matrix
[[1054   33]
 [  26 1060]]
True label 0
0.9696412143514259  
0.03035878564857406  
True label 1
0.02394106813996317  
0.9760589318600368  

Train_result {'loss': [0.03681114779449799], 'acc': [0.9864685331889977]}
Saved model to disk




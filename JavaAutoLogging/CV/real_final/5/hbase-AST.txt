Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-04 07:07:57.150175: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-04 07:07:57.160490: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-04 07:07:57.163549: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6caa950 executing computations on platform Host. Devices:
2019-08-04 07:07:57.163589: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22890
Over 200, Under 400 : 1161
Over 400 : 0


Test_zero:  1834
Train_zero:  16936
zero:  18770
Test_one:  889
Train_one:  7115
one:  8004

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 339s - loss: 0.5014 - acc: 0.7577

Test accuracy: 80.7195053400787

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  953

choose_one :  826

F1score :  0.7999999999999999

AUC : 0.9014680047016594

Confusion Matrix
[[750 140]
 [203 686]]
True label 0
0.8426966292134831  
0.15730337078651685  
True label 1
0.2283464566929134  
0.7716535433070866  

Train_result {'loss': [0.5014077309969563], 'acc': [0.7577120370895359]}
2

Epoch 1/1
 - 339s - loss: 0.4150 - acc: 0.8136

Test accuracy: 83.81112984822934

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  874

choose_one :  905

F1score :  0.8394648829431439

AUC : 0.9239057898661545

Confusion Matrix
[[738 152]
 [136 753]]
True label 0
0.8292134831460675  
0.1707865168539326  
True label 1
0.1529808773903262  
0.8470191226096738  

Train_result {'loss': [0.4149934351810726], 'acc': [0.8135759960816822]}
3

Epoch 1/1
 - 340s - loss: 0.3854 - acc: 0.8302

Test accuracy: 83.75491849353568

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  845

choose_one :  934

F1score :  0.841470104223807

AUC : 0.9241838449969035

Confusion Matrix
[[723 167]
 [122 767]]
True label 0
0.8123595505617978  
0.18764044943820224  
True label 1
0.1372328458942632  
0.8627671541057368  

Train_result {'loss': [0.3853653820955228], 'acc': [0.8302297800115487]}
4

Epoch 1/1
 - 341s - loss: 0.3698 - acc: 0.8350

Test accuracy: 84.71051152332771

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  918

choose_one :  861

F1score :  0.8445714285714286

AUC : 0.9296261422378382

Confusion Matrix
[[768 122]
 [150 739]]
True label 0
0.8629213483146068  
0.13707865168539327  
True label 1
0.1687289088863892  
0.8312710911136107  

Train_result {'loss': [0.36979383530515236], 'acc': [0.835008080954227]}
5

Epoch 1/1
 - 339s - loss: 0.3479 - acc: 0.8482

Test accuracy: 84.65430016863407

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  849

choose_one :  930

F1score :  0.8499175371083013

AUC : 0.9272285486786062

Confusion Matrix
[[733 157]
 [116 773]]
True label 0
0.8235955056179776  
0.17640449438202246  
True label 1
0.13048368953880765  
0.8695163104611924  

Train_result {'loss': [0.3478664559952265], 'acc': [0.8482186774888869]}
6

Epoch 1/1
 - 339s - loss: 0.3312 - acc: 0.8579

Test accuracy: 85.60989319842608

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  934

choose_one :  845

F1score :  0.8523644752018454

AUC : 0.9299433778642838

Confusion Matrix
[[784 106]
 [150 739]]
True label 0
0.8808988764044944  
0.11910112359550562  
True label 1
0.1687289088863892  
0.8312710911136107  

Train_result {'loss': [0.3312043667564187], 'acc': [0.8579158175352645]}
7

Epoch 1/1
 - 340s - loss: 0.3163 - acc: 0.8642

Test accuracy: 85.94716132658797

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  868

choose_one :  911

F1score :  0.861111111111111

AUC : 0.9352731891659609

Confusion Matrix
[[754 136]
 [114 775]]
True label 0
0.8471910112359551  
0.15280898876404495  
True label 1
0.12823397075365578  
0.8717660292463442  

Train_result {'loss': [0.31626477318205104], 'acc': [0.8642400393046412]}
8

Epoch 1/1
 - 339s - loss: 0.2985 - acc: 0.8730

Test accuracy: 86.05958403597526

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  868

choose_one :  911

F1score :  0.8622222222222222

AUC : 0.9369377282895819

Confusion Matrix
[[755 135]
 [113 776]]
True label 0
0.848314606741573  
0.15168539325842698  
True label 1
0.12710911136107986  
0.8728908886389202  

Train_result {'loss': [0.2984705871257332], 'acc': [0.8730236807138232]}
9

Epoch 1/1
 - 339s - loss: 0.2843 - acc: 0.8795

Test accuracy: 86.05958403597526

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  926

choose_one :  853

F1score :  0.8576349024110219

AUC : 0.9330803452939169

Confusion Matrix
[[784 106]
 [142 747]]
True label 0
0.8808988764044944  
0.11910112359550562  
True label 1
0.1597300337457818  
0.8402699662542182  

Train_result {'loss': [0.28432519382606547], 'acc': [0.8794884407614951]}
10

Epoch 1/1
 - 339s - loss: 0.2638 - acc: 0.8903

Test accuracy: 86.7903316469927

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  927

choose_one :  852

F1score :  0.865020103388857

AUC : 0.9410681108681639

Confusion Matrix
[[791  99]
 [136 753]]
True label 0
0.8887640449438202  
0.11123595505617978  
True label 1
0.1529808773903262  
0.8470191226096738  

Train_result {'loss': [0.2637885793678106], 'acc': [0.8903098869002064]}
11

Epoch 1/1
 - 339s - loss: 0.2530 - acc: 0.8953

Test accuracy: 86.84654300168634

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  856

choose_one :  923

F1score :  0.870860927152318

AUC : 0.934660203991355

Confusion Matrix
[[756 134]
 [100 789]]
True label 0
0.849438202247191  
0.15056179775280898  
True label 1
0.1124859392575928  
0.8875140607424072  

Train_result {'loss': [0.25304946949841994], 'acc': [0.8952989951849369]}
12

Epoch 1/1
 - 339s - loss: 0.2373 - acc: 0.9011

Test accuracy: 84.59808881394042

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  1040

choose_one :  739

F1score :  0.8316953316953317

AUC : 0.9321779300059401

Confusion Matrix
[[828  62]
 [212 677]]
True label 0
0.9303370786516854  
0.0696629213483146  
True label 1
0.23847019122609675  
0.7615298087739033  

Train_result {'loss': [0.23731580646617642], 'acc': [0.9010610639081468]}
13

Epoch 1/1
 - 339s - loss: 0.2191 - acc: 0.9097

Test accuracy: 86.6779089376054

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  885

choose_one :  894

F1score :  0.8670779584969153

AUC : 0.9386035313001604

Confusion Matrix
[[769 121]
 [116 773]]
True label 0
0.8640449438202247  
0.13595505617977527  
True label 1
0.13048368953880765  
0.8695163104611924  

Train_result {'loss': [0.21909606424244396], 'acc': [0.9097041669762082]}
14

Epoch 1/1
 - 339s - loss: 0.2078 - acc: 0.9172

Test accuracy: 86.50927487352446

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  906

choose_one :  873

F1score :  0.8637911464245177

AUC : 0.9366318676457578

Confusion Matrix
[[778 112]
 [128 761]]
True label 0
0.8741573033707866  
0.1258426966292135  
True label 1
0.1439820022497188  
0.8560179977502812  

Train_result {'loss': [0.20780906792907836], 'acc': [0.9171526948379185]}
15

Epoch 1/1
 - 339s - loss: 0.1926 - acc: 0.9214

Test accuracy: 86.90275435637999

data size :  16010

zero :  8006

one :  8004

train_zero :  7116

train_one :  7115

test_zero :  890

test_one :  889

choose_zero :  897

choose_one :  882

F1score :  0.8684359119141729

AUC : 0.9378287685949368

Confusion Matrix
[[777 113]
 [120 769]]
True label 0
0.8730337078651685  
0.12696629213483146  
True label 1
0.13498312710911137  
0.8650168728908887  

Train_result {'loss': [0.19260714120451392], 'acc': [0.9213688426380976]}
Saved model to disk




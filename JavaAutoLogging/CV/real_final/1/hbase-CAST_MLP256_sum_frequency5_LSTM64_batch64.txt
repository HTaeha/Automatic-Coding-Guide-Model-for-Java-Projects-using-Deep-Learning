Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:400: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-21 03:37:23.986495: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-21 03:37:23.998486: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-21 03:37:23.999565: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x53ddf30 executing computations on platform Host. Devices:
2019-08-21 03:37:23.999606: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 90

Under 10 : 0
Over 10, Under 200 : 31581
Over 200, Under 400 : 5169
Over 400 : 0


Test_zero:  3235
Train_zero:  29064
zero:  32299
Test_one:  811
Train_one:  7686
one:  8497

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15373 [..............................] - ETA: 1:24 - loss: 5.2238 - acc: 0.5469
  832/15373 [>.............................] - ETA: 7s - loss: 7.9137 - acc: 0.4856  
 1664/15373 [==>...........................] - ETA: 3s - loss: 7.7503 - acc: 0.4946
 2496/15373 [===>..........................] - ETA: 2s - loss: 7.6698 - acc: 0.4980
 3328/15373 [=====>........................] - ETA: 2s - loss: 6.8312 - acc: 0.5430
 4160/15373 [=======>......................] - ETA: 1s - loss: 6.3333 - acc: 0.5721
 4992/15373 [========>.....................] - ETA: 1s - loss: 5.9790 - acc: 0.5938
 5888/15373 [==========>...................] - ETA: 1s - loss: 5.6450 - acc: 0.6148
 6720/15373 [============>.................] - ETA: 0s - loss: 5.5075 - acc: 0.6256
 7552/15373 [=============>................] - ETA: 0s - loss: 5.3967 - acc: 0.6323
 8384/15373 [===============>..............] - ETA: 0s - loss: 5.2557 - acc: 0.6428
 9216/15373 [================>.............] - ETA: 0s - loss: 5.1346 - acc: 0.6507
10048/15373 [==================>...........] - ETA: 0s - loss: 5.0232 - acc: 0.6578
10880/15373 [====================>.........] - ETA: 0s - loss: 4.9609 - acc: 0.6620
11712/15373 [=====================>........] - ETA: 0s - loss: 5.0131 - acc: 0.6596
12544/15373 [=======================>......] - ETA: 0s - loss: 4.8909 - acc: 0.6678
13376/15373 [=========================>....] - ETA: 0s - loss: 4.9447 - acc: 0.6650
14208/15373 [==========================>...] - ETA: 0s - loss: 4.8447 - acc: 0.6711
15104/15373 [============================>.] - ETA: 0s - loss: 4.7764 - acc: 0.6752
15373/15373 [==============================] - 1s 85us/step - loss: 4.7537 - acc: 0.6768

Test accuracy: 77.69562538508934

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  800

choose_one :  823

F1score :  0.7784577723378213

AUC : 0.7867279038831826

Confusion Matrix
[[625 187]
 [175 636]]
True label 0
0.7697044334975369  
0.23029556650246305  
True label 1
0.2157829839704069  
0.7842170160295932  

Train_result {'loss': [4.753732859084146], 'acc': [0.676836011200079]}
Saved model to disk



2

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 2.6870 - acc: 0.8281
  896/15373 [>.............................] - ETA: 0s - loss: 3.9858 - acc: 0.7277
 1728/15373 [==>...........................] - ETA: 0s - loss: 3.5505 - acc: 0.7500
 2560/15373 [===>..........................] - ETA: 0s - loss: 3.5018 - acc: 0.7559
 3392/15373 [=====>........................] - ETA: 0s - loss: 3.5331 - acc: 0.7565
 4160/15373 [=======>......................] - ETA: 0s - loss: 3.5461 - acc: 0.7541
 4992/15373 [========>.....................] - ETA: 0s - loss: 3.5385 - acc: 0.7560
 5824/15373 [==========>...................] - ETA: 0s - loss: 3.5714 - acc: 0.7534
 6656/15373 [===========>..................] - ETA: 0s - loss: 3.5994 - acc: 0.7520
 7488/15373 [=============>................] - ETA: 0s - loss: 3.6040 - acc: 0.7516
 8320/15373 [===============>..............] - ETA: 0s - loss: 3.6889 - acc: 0.7464
 9152/15373 [================>.............] - ETA: 0s - loss: 3.7099 - acc: 0.7450
 9984/15373 [==================>...........] - ETA: 0s - loss: 3.6641 - acc: 0.7481
10816/15373 [====================>.........] - ETA: 0s - loss: 3.6334 - acc: 0.7499
11648/15373 [=====================>........] - ETA: 0s - loss: 3.6390 - acc: 0.7487
12480/15373 [=======================>......] - ETA: 0s - loss: 3.6589 - acc: 0.7480
13248/15373 [========================>.....] - ETA: 0s - loss: 3.6409 - acc: 0.7492
14080/15373 [==========================>...] - ETA: 0s - loss: 3.6210 - acc: 0.7504
14912/15373 [============================>.] - ETA: 0s - loss: 3.6375 - acc: 0.7491
15373/15373 [==============================] - 1s 63us/step - loss: 3.6233 - acc: 0.7500

Test accuracy: 71.90388170055454

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  402

choose_one :  1221

F1score :  0.7755905511811023

AUC : 0.7727953994642629

Confusion Matrix
[[379 433]
 [ 23 788]]
True label 0
0.4667487684729064  
0.5332512315270936  
True label 1
0.02836004932182491  
0.9716399506781751  

Train_result {'loss': [3.6233200045822422], 'acc': [0.749951213177572]}
Saved model to disk



3

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 4.0826 - acc: 0.6875
  960/15373 [>.............................] - ETA: 0s - loss: 3.6310 - acc: 0.7344
 1792/15373 [==>...........................] - ETA: 0s - loss: 3.3341 - acc: 0.7561
 2624/15373 [====>.........................] - ETA: 0s - loss: 3.2389 - acc: 0.7626
 3456/15373 [=====>........................] - ETA: 0s - loss: 3.2413 - acc: 0.7610
 4288/15373 [=======>......................] - ETA: 0s - loss: 3.2172 - acc: 0.7624
 5120/15373 [========>.....................] - ETA: 0s - loss: 3.2574 - acc: 0.7596
 5952/15373 [==========>...................] - ETA: 0s - loss: 3.1713 - acc: 0.7653
 6720/15373 [============>.................] - ETA: 0s - loss: 3.1907 - acc: 0.7621
 7552/15373 [=============>................] - ETA: 0s - loss: 3.1660 - acc: 0.7622
 8384/15373 [===============>..............] - ETA: 0s - loss: 3.1445 - acc: 0.7637
 9216/15373 [================>.............] - ETA: 0s - loss: 3.1024 - acc: 0.7655
10048/15373 [==================>...........] - ETA: 0s - loss: 3.1007 - acc: 0.7649
10944/15373 [====================>.........] - ETA: 0s - loss: 3.0686 - acc: 0.7653
11776/15373 [=====================>........] - ETA: 0s - loss: 3.0397 - acc: 0.7670
12672/15373 [=======================>......] - ETA: 0s - loss: 3.0777 - acc: 0.7647
13568/15373 [=========================>....] - ETA: 0s - loss: 3.0684 - acc: 0.7658
14464/15373 [===========================>..] - ETA: 0s - loss: 3.0569 - acc: 0.7670
15360/15373 [============================>.] - ETA: 0s - loss: 3.0773 - acc: 0.7657
15373/15373 [==============================] - 1s 61us/step - loss: 3.0768 - acc: 0.7658

Test accuracy: 79.42082563154652

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  628

choose_one :  995

F1score :  0.8150609080841639

AUC : 0.8225340606075331

Confusion Matrix
[[553 259]
 [ 75 736]]
True label 0
0.6810344827586207  
0.31896551724137934  
True label 1
0.09247842170160296  
0.9075215782983971  

Train_result {'loss': [3.0767662791310015], 'acc': [0.7657581474090425]}
Saved model to disk



4

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 2.6773 - acc: 0.7969
 1088/15373 [=>............................] - ETA: 0s - loss: 2.6446 - acc: 0.7923
 2240/15373 [===>..........................] - ETA: 0s - loss: 2.6710 - acc: 0.7942
 3392/15373 [=====>........................] - ETA: 0s - loss: 2.6125 - acc: 0.7983
 4288/15373 [=======>......................] - ETA: 0s - loss: 2.6648 - acc: 0.7896
 5120/15373 [========>.....................] - ETA: 0s - loss: 2.7161 - acc: 0.7822
 5952/15373 [==========>...................] - ETA: 0s - loss: 2.6820 - acc: 0.7772
 6784/15373 [============>.................] - ETA: 0s - loss: 2.6053 - acc: 0.7754
 7616/15373 [=============>................] - ETA: 0s - loss: 2.5477 - acc: 0.7735
 8448/15373 [===============>..............] - ETA: 0s - loss: 2.4923 - acc: 0.7719
 9280/15373 [=================>............] - ETA: 0s - loss: 2.3951 - acc: 0.7722
10112/15373 [==================>...........] - ETA: 0s - loss: 2.2917 - acc: 0.7719
10880/15373 [====================>.........] - ETA: 0s - loss: 2.2192 - acc: 0.7698
11712/15373 [=====================>........] - ETA: 0s - loss: 2.1404 - acc: 0.7707
12480/15373 [=======================>......] - ETA: 0s - loss: 2.0545 - acc: 0.7707
13248/15373 [========================>.....] - ETA: 0s - loss: 1.9737 - acc: 0.7712
14016/15373 [==========================>...] - ETA: 0s - loss: 1.8999 - acc: 0.7713
14848/15373 [===========================>..] - ETA: 0s - loss: 1.8384 - acc: 0.7681
15373/15373 [==============================] - 1s 60us/step - loss: 1.7988 - acc: 0.7673

Test accuracy: 76.83302526186075

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  948

choose_one :  675

F1score :  0.746971736204576

AUC : 0.8792336591084413

Confusion Matrix
[[692 120]
 [256 555]]
True label 0
0.8522167487684729  
0.1477832512315271  
True label 1
0.3156596794081381  
0.6843403205918619  

Train_result {'loss': [1.7987662512688603], 'acc': [0.7673193261067077]}
Saved model to disk



5

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.4537 - acc: 0.7656
  896/15373 [>.............................] - ETA: 0s - loss: 0.8652 - acc: 0.7924
 1792/15373 [==>...........................] - ETA: 0s - loss: 0.7960 - acc: 0.7734
 2624/15373 [====>.........................] - ETA: 0s - loss: 0.7315 - acc: 0.7664
 3456/15373 [=====>........................] - ETA: 0s - loss: 0.7000 - acc: 0.7703
 4288/15373 [=======>......................] - ETA: 0s - loss: 0.6862 - acc: 0.7722
 5120/15373 [========>.....................] - ETA: 0s - loss: 0.6801 - acc: 0.7691
 5952/15373 [==========>...................] - ETA: 0s - loss: 0.6687 - acc: 0.7693
 6784/15373 [============>.................] - ETA: 0s - loss: 0.6594 - acc: 0.7733
 7616/15373 [=============>................] - ETA: 0s - loss: 0.6625 - acc: 0.7706
 8448/15373 [===============>..............] - ETA: 0s - loss: 0.6520 - acc: 0.7717
 9280/15373 [=================>............] - ETA: 0s - loss: 0.6487 - acc: 0.7710
10112/15373 [==================>...........] - ETA: 0s - loss: 0.6457 - acc: 0.7694
10944/15373 [====================>.........] - ETA: 0s - loss: 0.6418 - acc: 0.7703
11776/15373 [=====================>........] - ETA: 0s - loss: 0.6361 - acc: 0.7694
12608/15373 [=======================>......] - ETA: 0s - loss: 0.6349 - acc: 0.7697
13440/15373 [=========================>....] - ETA: 0s - loss: 0.6272 - acc: 0.7705
14272/15373 [==========================>...] - ETA: 0s - loss: 0.6267 - acc: 0.7720
15104/15373 [============================>.] - ETA: 0s - loss: 0.6288 - acc: 0.7715
15373/15373 [==============================] - 1s 62us/step - loss: 0.6296 - acc: 0.7716

Test accuracy: 73.44423906346272

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  1107

choose_one :  516

F1score :  0.6752072343632253

AUC : 0.8854801285283024

Confusion Matrix
[[744  68]
 [363 448]]
True label 0
0.916256157635468  
0.08374384236453201  
True label 1
0.4475955610357583  
0.5524044389642416  

Train_result {'loss': [0.6295702439088684], 'acc': [0.7716125674962082]}
Saved model to disk



6

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.5313 - acc: 0.7031
 1024/15373 [>.............................] - ETA: 0s - loss: 0.5634 - acc: 0.7637
 1984/15373 [==>...........................] - ETA: 0s - loss: 0.5891 - acc: 0.7737
 2880/15373 [====>.........................] - ETA: 0s - loss: 0.5785 - acc: 0.7722
 3712/15373 [======>.......................] - ETA: 0s - loss: 0.5702 - acc: 0.7745
 4544/15373 [=======>......................] - ETA: 0s - loss: 0.5684 - acc: 0.7705
 5376/15373 [=========>....................] - ETA: 0s - loss: 0.5729 - acc: 0.7719
 6272/15373 [===========>..................] - ETA: 0s - loss: 0.5688 - acc: 0.7720
 7104/15373 [============>.................] - ETA: 0s - loss: 0.5770 - acc: 0.7731
 7936/15373 [==============>...............] - ETA: 0s - loss: 0.5664 - acc: 0.7776
 8768/15373 [================>.............] - ETA: 0s - loss: 0.5684 - acc: 0.7789
 9600/15373 [=================>............] - ETA: 0s - loss: 0.5627 - acc: 0.7805
10432/15373 [===================>..........] - ETA: 0s - loss: 0.5713 - acc: 0.7823
11264/15373 [====================>.........] - ETA: 0s - loss: 0.5769 - acc: 0.7807
12096/15373 [======================>.......] - ETA: 0s - loss: 0.5710 - acc: 0.7800
12928/15373 [========================>.....] - ETA: 0s - loss: 0.5726 - acc: 0.7792
13760/15373 [=========================>....] - ETA: 0s - loss: 0.5712 - acc: 0.7805
14592/15373 [===========================>..] - ETA: 0s - loss: 0.5721 - acc: 0.7803
15373/15373 [==============================] - 1s 61us/step - loss: 0.5724 - acc: 0.7798

Test accuracy: 81.94701170671595

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  793

choose_one :  830

F1score :  0.8214503351614869

AUC : 0.905830696154477

Confusion Matrix
[[656 156]
 [137 674]]
True label 0
0.8078817733990148  
0.1921182266009852  
True label 1
0.16892725030826142  
0.8310727496917386  

Train_result {'loss': [0.5723826618470018], 'acc': [0.7798087556221176]}
Saved model to disk



7

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.5803 - acc: 0.7969
  768/15373 [>.............................] - ETA: 1s - loss: 0.5742 - acc: 0.7786
 1664/15373 [==>...........................] - ETA: 0s - loss: 0.5705 - acc: 0.7849
 2496/15373 [===>..........................] - ETA: 0s - loss: 0.5562 - acc: 0.7893
 3392/15373 [=====>........................] - ETA: 0s - loss: 0.5378 - acc: 0.7925
 4224/15373 [=======>......................] - ETA: 0s - loss: 0.5423 - acc: 0.7964
 4992/15373 [========>.....................] - ETA: 0s - loss: 0.5644 - acc: 0.7957
 5824/15373 [==========>...................] - ETA: 0s - loss: 0.5624 - acc: 0.7940
 6656/15373 [===========>..................] - ETA: 0s - loss: 0.5587 - acc: 0.7942
 7488/15373 [=============>................] - ETA: 0s - loss: 0.5593 - acc: 0.7919
 8320/15373 [===============>..............] - ETA: 0s - loss: 0.5565 - acc: 0.7909
 9152/15373 [================>.............] - ETA: 0s - loss: 0.5586 - acc: 0.7899
 9984/15373 [==================>...........] - ETA: 0s - loss: 0.5524 - acc: 0.7916
10816/15373 [====================>.........] - ETA: 0s - loss: 0.5483 - acc: 0.7911
11648/15373 [=====================>........] - ETA: 0s - loss: 0.5521 - acc: 0.7897
12480/15373 [=======================>......] - ETA: 0s - loss: 0.5542 - acc: 0.7901
13312/15373 [========================>.....] - ETA: 0s - loss: 0.5544 - acc: 0.7900
14080/15373 [==========================>...] - ETA: 0s - loss: 0.5534 - acc: 0.7906
14912/15373 [============================>.] - ETA: 0s - loss: 0.5535 - acc: 0.7904
15373/15373 [==============================] - 1s 63us/step - loss: 0.5541 - acc: 0.7907

Test accuracy: 82.99445471349352

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  724

choose_one :  899

F1score :  0.8385964912280701

AUC : 0.9083962510553778

Confusion Matrix
[[630 182]
 [ 94 717]]
True label 0
0.7758620689655172  
0.22413793103448276  
True label 1
0.1159062885326757  
0.8840937114673243  

Train_result {'loss': [0.5540740751226808], 'acc': [0.7906719573394142]}
Saved model to disk



8

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.9956 - acc: 0.7500
  960/15373 [>.............................] - ETA: 0s - loss: 0.6069 - acc: 0.7927
 1792/15373 [==>...........................] - ETA: 0s - loss: 0.5681 - acc: 0.7946
 2560/15373 [===>..........................] - ETA: 0s - loss: 0.5724 - acc: 0.7875
 3328/15373 [=====>........................] - ETA: 0s - loss: 0.5537 - acc: 0.7870
 4096/15373 [======>.......................] - ETA: 0s - loss: 0.5306 - acc: 0.7935
 4864/15373 [========>.....................] - ETA: 0s - loss: 0.5324 - acc: 0.7938
 5632/15373 [=========>....................] - ETA: 0s - loss: 0.5327 - acc: 0.7962
 6464/15373 [===========>..................] - ETA: 0s - loss: 0.5250 - acc: 0.7955
 7296/15373 [=============>................] - ETA: 0s - loss: 0.5249 - acc: 0.7963
 8128/15373 [==============>...............] - ETA: 0s - loss: 0.5266 - acc: 0.7972
 8960/15373 [================>.............] - ETA: 0s - loss: 0.5294 - acc: 0.7960
 9792/15373 [==================>...........] - ETA: 0s - loss: 0.5243 - acc: 0.7953
10688/15373 [===================>..........] - ETA: 0s - loss: 0.5202 - acc: 0.7970
11584/15373 [=====================>........] - ETA: 0s - loss: 0.5175 - acc: 0.7979
12416/15373 [=======================>......] - ETA: 0s - loss: 0.5161 - acc: 0.7974
13248/15373 [========================>.....] - ETA: 0s - loss: 0.5200 - acc: 0.7951
14080/15373 [==========================>...] - ETA: 0s - loss: 0.5196 - acc: 0.7942
14912/15373 [============================>.] - ETA: 0s - loss: 0.5175 - acc: 0.7955
15373/15373 [==============================] - 1s 63us/step - loss: 0.5155 - acc: 0.7958

Test accuracy: 79.97535428219346

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  563

choose_one :  1060

F1score :  0.826296098343132

AUC : 0.909454665832488

Confusion Matrix
[[525 287]
 [ 38 773]]
True label 0
0.646551724137931  
0.35344827586206895  
True label 1
0.0468557336621455  
0.9531442663378545  

Train_result {'loss': [0.5155318573593186], 'acc': [0.7958108371937042]}
Saved model to disk



9

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.6929 - acc: 0.7344
  960/15373 [>.............................] - ETA: 0s - loss: 0.5207 - acc: 0.8031
 1792/15373 [==>...........................] - ETA: 0s - loss: 0.5044 - acc: 0.7924
 2624/15373 [====>.........................] - ETA: 0s - loss: 0.5117 - acc: 0.7995
 3456/15373 [=====>........................] - ETA: 0s - loss: 0.5110 - acc: 0.8044
 4288/15373 [=======>......................] - ETA: 0s - loss: 0.5206 - acc: 0.8027
 5120/15373 [========>.....................] - ETA: 0s - loss: 0.5030 - acc: 0.8037
 5952/15373 [==========>...................] - ETA: 0s - loss: 0.4964 - acc: 0.8041
 6784/15373 [============>.................] - ETA: 0s - loss: 0.4976 - acc: 0.8060
 7616/15373 [=============>................] - ETA: 0s - loss: 0.4985 - acc: 0.8045
 8448/15373 [===============>..............] - ETA: 0s - loss: 0.5028 - acc: 0.8022
 9280/15373 [=================>............] - ETA: 0s - loss: 0.4980 - acc: 0.8023
10112/15373 [==================>...........] - ETA: 0s - loss: 0.5034 - acc: 0.8018
10944/15373 [====================>.........] - ETA: 0s - loss: 0.5063 - acc: 0.8002
11776/15373 [=====================>........] - ETA: 0s - loss: 0.5041 - acc: 0.8005
12608/15373 [=======================>......] - ETA: 0s - loss: 0.5054 - acc: 0.8001
13440/15373 [=========================>....] - ETA: 0s - loss: 0.5050 - acc: 0.8002
14272/15373 [==========================>...] - ETA: 0s - loss: 0.5039 - acc: 0.8007
15104/15373 [============================>.] - ETA: 0s - loss: 0.5018 - acc: 0.8010
15373/15373 [==============================] - 1s 62us/step - loss: 0.5030 - acc: 0.8013

Test accuracy: 78.86629698089956

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  1011

choose_one :  612

F1score :  0.7589599437807449

AUC : 0.9107226376242916

Confusion Matrix
[[740  72]
 [271 540]]
True label 0
0.9113300492610837  
0.08866995073891626  
True label 1
0.33415536374845867  
0.6658446362515413  

Train_result {'loss': [0.5030394372807927], 'acc': [0.8013400117204719]}
Saved model to disk



10

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.4566 - acc: 0.7344
  960/15373 [>.............................] - ETA: 0s - loss: 0.4632 - acc: 0.8208
 1792/15373 [==>...........................] - ETA: 0s - loss: 0.5094 - acc: 0.8181
 2624/15373 [====>.........................] - ETA: 0s - loss: 0.5046 - acc: 0.8178
 3456/15373 [=====>........................] - ETA: 0s - loss: 0.5041 - acc: 0.8139
 4288/15373 [=======>......................] - ETA: 0s - loss: 0.5121 - acc: 0.8137
 5120/15373 [========>.....................] - ETA: 0s - loss: 0.5039 - acc: 0.8127
 5952/15373 [==========>...................] - ETA: 0s - loss: 0.5146 - acc: 0.8103
 6848/15373 [============>.................] - ETA: 0s - loss: 0.5177 - acc: 0.8087
 7744/15373 [==============>...............] - ETA: 0s - loss: 0.5194 - acc: 0.8058
 8576/15373 [===============>..............] - ETA: 0s - loss: 0.5202 - acc: 0.8055
 9472/15373 [=================>............] - ETA: 0s - loss: 0.5195 - acc: 0.8058
10304/15373 [===================>..........] - ETA: 0s - loss: 0.5157 - acc: 0.8080
11200/15373 [====================>.........] - ETA: 0s - loss: 0.5164 - acc: 0.8100
12032/15373 [======================>.......] - ETA: 0s - loss: 0.5152 - acc: 0.8082
12864/15373 [========================>.....] - ETA: 0s - loss: 0.5144 - acc: 0.8083
13696/15373 [=========================>....] - ETA: 0s - loss: 0.5101 - acc: 0.8089
14528/15373 [===========================>..] - ETA: 0s - loss: 0.5077 - acc: 0.8082
15360/15373 [============================>.] - ETA: 0s - loss: 0.5107 - acc: 0.8066
15373/15373 [==============================] - 1s 61us/step - loss: 0.5107 - acc: 0.8066

Test accuracy: 83.24091189155884

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  650

choose_one :  973

F1score :  0.8475336322869955

AUC : 0.912007313236107

Confusion Matrix
[[595 217]
 [ 55 756]]
True label 0
0.7327586206896551  
0.2672413793103448  
True label 1
0.06781750924784218  
0.9321824907521579  

Train_result {'loss': [0.5106735632840343], 'acc': [0.806608989798921]}
Saved model to disk



11

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.3663 - acc: 0.8281
  960/15373 [>.............................] - ETA: 0s - loss: 0.4921 - acc: 0.7854
 1920/15373 [==>...........................] - ETA: 0s - loss: 0.4958 - acc: 0.7901
 2752/15373 [====>.........................] - ETA: 0s - loss: 0.4889 - acc: 0.7951
 3584/15373 [=====>........................] - ETA: 0s - loss: 0.4947 - acc: 0.7958
 4416/15373 [=======>......................] - ETA: 0s - loss: 0.4904 - acc: 0.7991
 5248/15373 [=========>....................] - ETA: 0s - loss: 0.4886 - acc: 0.7997
 6080/15373 [==========>...................] - ETA: 0s - loss: 0.4903 - acc: 0.8015
 6912/15373 [============>.................] - ETA: 0s - loss: 0.4862 - acc: 0.8030
 7744/15373 [==============>...............] - ETA: 0s - loss: 0.4837 - acc: 0.8060
 8640/15373 [===============>..............] - ETA: 0s - loss: 0.4819 - acc: 0.8052
 9472/15373 [=================>............] - ETA: 0s - loss: 0.4882 - acc: 0.8036
10304/15373 [===================>..........] - ETA: 0s - loss: 0.4901 - acc: 0.8044
11136/15373 [====================>.........] - ETA: 0s - loss: 0.4895 - acc: 0.8042
11968/15373 [======================>.......] - ETA: 0s - loss: 0.4872 - acc: 0.8042
12864/15373 [========================>.....] - ETA: 0s - loss: 0.4891 - acc: 0.8044
13696/15373 [=========================>....] - ETA: 0s - loss: 0.4865 - acc: 0.8059
14528/15373 [===========================>..] - ETA: 0s - loss: 0.4860 - acc: 0.8057
15360/15373 [============================>.] - ETA: 0s - loss: 0.4829 - acc: 0.8068
15373/15373 [==============================] - 1s 61us/step - loss: 0.4828 - acc: 0.8069

Test accuracy: 84.9044978434997

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  749

choose_one :  874

F1score :  0.85459940652819

AUC : 0.9191163071802129

Confusion Matrix
[[658 154]
 [ 91 720]]
True label 0
0.8103448275862069  
0.1896551724137931  
True label 1
0.11220715166461159  
0.8877928483353884  

Train_result {'loss': [0.48276514925364594], 'acc': [0.8069342353515647]}
Saved model to disk



12

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.2864 - acc: 0.8438
  896/15373 [>.............................] - ETA: 0s - loss: 0.5187 - acc: 0.8058
 1728/15373 [==>...........................] - ETA: 0s - loss: 0.4724 - acc: 0.8056
 2560/15373 [===>..........................] - ETA: 0s - loss: 0.4771 - acc: 0.8148
 3392/15373 [=====>........................] - ETA: 0s - loss: 0.4709 - acc: 0.8160
 4224/15373 [=======>......................] - ETA: 0s - loss: 0.4780 - acc: 0.8170
 5056/15373 [========>.....................] - ETA: 0s - loss: 0.4846 - acc: 0.8174
 5824/15373 [==========>...................] - ETA: 0s - loss: 0.4796 - acc: 0.8159
 6656/15373 [===========>..................] - ETA: 0s - loss: 0.4693 - acc: 0.8185
 7488/15373 [=============>................] - ETA: 0s - loss: 0.4652 - acc: 0.8181
 8320/15373 [===============>..............] - ETA: 0s - loss: 0.4710 - acc: 0.8178
 9152/15373 [================>.............] - ETA: 0s - loss: 0.4742 - acc: 0.8151
 9984/15373 [==================>...........] - ETA: 0s - loss: 0.4763 - acc: 0.8151
10816/15373 [====================>.........] - ETA: 0s - loss: 0.4771 - acc: 0.8155
11648/15373 [=====================>........] - ETA: 0s - loss: 0.4767 - acc: 0.8150
12416/15373 [=======================>......] - ETA: 0s - loss: 0.4783 - acc: 0.8142
13184/15373 [========================>.....] - ETA: 0s - loss: 0.4775 - acc: 0.8140
14016/15373 [==========================>...] - ETA: 0s - loss: 0.4734 - acc: 0.8148
14848/15373 [===========================>..] - ETA: 0s - loss: 0.4735 - acc: 0.8139
15373/15373 [==============================] - 1s 63us/step - loss: 0.4749 - acc: 0.8136

Test accuracy: 83.1792975970425

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  711

choose_one :  912

F1score :  0.8415554265815438

AUC : 0.914710295019832

Confusion Matrix
[[625 187]
 [ 86 725]]
True label 0
0.7697044334975369  
0.23029556650246305  
True label 1
0.1060419235511714  
0.8939580764488286  

Train_result {'loss': [0.47488029046141783], 'acc': [0.8135692447875632]}
Saved model to disk



13

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.5428 - acc: 0.8438
  960/15373 [>.............................] - ETA: 0s - loss: 0.4796 - acc: 0.8010
 1792/15373 [==>...........................] - ETA: 0s - loss: 0.4612 - acc: 0.8097
 2624/15373 [====>.........................] - ETA: 0s - loss: 0.4704 - acc: 0.8144
 3456/15373 [=====>........................] - ETA: 0s - loss: 0.4584 - acc: 0.8200
 4288/15373 [=======>......................] - ETA: 0s - loss: 0.4632 - acc: 0.8158
 5120/15373 [========>.....................] - ETA: 0s - loss: 0.4694 - acc: 0.8098
 5952/15373 [==========>...................] - ETA: 0s - loss: 0.4762 - acc: 0.8065
 6720/15373 [============>.................] - ETA: 0s - loss: 0.4781 - acc: 0.8094
 7552/15373 [=============>................] - ETA: 0s - loss: 0.4758 - acc: 0.8109
 8384/15373 [===============>..............] - ETA: 0s - loss: 0.4723 - acc: 0.8109
 9152/15373 [================>.............] - ETA: 0s - loss: 0.4748 - acc: 0.8082
 9984/15373 [==================>...........] - ETA: 0s - loss: 0.4719 - acc: 0.8095
10816/15373 [====================>.........] - ETA: 0s - loss: 0.4686 - acc: 0.8099
11648/15373 [=====================>........] - ETA: 0s - loss: 0.4694 - acc: 0.8101
12416/15373 [=======================>......] - ETA: 0s - loss: 0.4641 - acc: 0.8120
13248/15373 [========================>.....] - ETA: 0s - loss: 0.4607 - acc: 0.8134
14080/15373 [==========================>...] - ETA: 0s - loss: 0.4620 - acc: 0.8134
14912/15373 [============================>.] - ETA: 0s - loss: 0.4613 - acc: 0.8138
15373/15373 [==============================] - 1s 64us/step - loss: 0.4622 - acc: 0.8139

Test accuracy: 83.3641404805915

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  670

choose_one :  953

F1score :  0.8469387755102041

AUC : 0.9198998681916748

Confusion Matrix
[[606 206]
 [ 64 747]]
True label 0
0.7463054187192119  
0.2536945812807882  
True label 1
0.07891491985203453  
0.9210850801479655  

Train_result {'loss': [0.46221368729870466], 'acc': [0.8138944903479614]}
Saved model to disk



14

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.7696 - acc: 0.7812
  384/15373 [..............................] - ETA: 2s - loss: 0.5212 - acc: 0.8229
 1536/15373 [=>............................] - ETA: 0s - loss: 0.4678 - acc: 0.8236
 2432/15373 [===>..........................] - ETA: 0s - loss: 0.4441 - acc: 0.8289
 3264/15373 [=====>........................] - ETA: 0s - loss: 0.4387 - acc: 0.8278
 4032/15373 [======>.......................] - ETA: 0s - loss: 0.4421 - acc: 0.8239
 4864/15373 [========>.....................] - ETA: 0s - loss: 0.4382 - acc: 0.8255
 5632/15373 [=========>....................] - ETA: 0s - loss: 0.4312 - acc: 0.8279
 6464/15373 [===========>..................] - ETA: 0s - loss: 0.4285 - acc: 0.8270
 7296/15373 [=============>................] - ETA: 0s - loss: 0.4366 - acc: 0.8236
 8064/15373 [==============>...............] - ETA: 0s - loss: 0.4422 - acc: 0.8224
 8896/15373 [================>.............] - ETA: 0s - loss: 0.4423 - acc: 0.8221
 9728/15373 [=================>............] - ETA: 0s - loss: 0.4484 - acc: 0.8215
10560/15373 [===================>..........] - ETA: 0s - loss: 0.4514 - acc: 0.8207
11456/15373 [=====================>........] - ETA: 0s - loss: 0.4513 - acc: 0.8224
12288/15373 [======================>.......] - ETA: 0s - loss: 0.4507 - acc: 0.8200
13120/15373 [========================>.....] - ETA: 0s - loss: 0.4490 - acc: 0.8202
13952/15373 [==========================>...] - ETA: 0s - loss: 0.4500 - acc: 0.8203
14784/15373 [===========================>..] - ETA: 0s - loss: 0.4527 - acc: 0.8189
15373/15373 [==============================] - 1s 64us/step - loss: 0.4495 - acc: 0.8196

Test accuracy: 82.50154035736291

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  644

choose_one :  979

F1score :  0.8413407821229051

AUC : 0.9200790546245284

Confusion Matrix
[[586 226]
 [ 58 753]]
True label 0
0.7216748768472906  
0.27832512315270935  
True label 1
0.07151664611590629  
0.9284833538840938  

Train_result {'loss': [0.4495126730239299], 'acc': [0.8196188122070907]}
Saved model to disk



15

Epoch 1/1

   64/15373 [..............................] - ETA: 1s - loss: 0.4731 - acc: 0.8281
  896/15373 [>.............................] - ETA: 0s - loss: 0.4486 - acc: 0.8147
 1728/15373 [==>...........................] - ETA: 0s - loss: 0.4674 - acc: 0.8056
 2560/15373 [===>..........................] - ETA: 0s - loss: 0.4539 - acc: 0.8152
 3392/15373 [=====>........................] - ETA: 0s - loss: 0.4512 - acc: 0.8154
 4224/15373 [=======>......................] - ETA: 0s - loss: 0.4631 - acc: 0.8151
 5056/15373 [========>.....................] - ETA: 0s - loss: 0.4522 - acc: 0.8194
 5824/15373 [==========>...................] - ETA: 0s - loss: 0.4546 - acc: 0.8163
 6592/15373 [===========>..................] - ETA: 0s - loss: 0.4585 - acc: 0.8152
 7424/15373 [=============>................] - ETA: 0s - loss: 0.4559 - acc: 0.8147
 8256/15373 [===============>..............] - ETA: 0s - loss: 0.4579 - acc: 0.8154
 9088/15373 [================>.............] - ETA: 0s - loss: 0.4554 - acc: 0.8153
 9920/15373 [==================>...........] - ETA: 0s - loss: 0.4588 - acc: 0.8165
10752/15373 [===================>..........] - ETA: 0s - loss: 0.4617 - acc: 0.8179
11584/15373 [=====================>........] - ETA: 0s - loss: 0.4595 - acc: 0.8181
12416/15373 [=======================>......] - ETA: 0s - loss: 0.4570 - acc: 0.8190
13248/15373 [========================>.....] - ETA: 0s - loss: 0.4549 - acc: 0.8206
14080/15373 [==========================>...] - ETA: 0s - loss: 0.4559 - acc: 0.8217
14912/15373 [============================>.] - ETA: 0s - loss: 0.4557 - acc: 0.8220
15373/15373 [==============================] - 1s 63us/step - loss: 0.4548 - acc: 0.8220

Test accuracy: 82.80961182994456

data size :  16996

zero :  8499

one :  8497

train_zero :  7687

train_one :  7686

test_zero :  812

test_one :  811

choose_zero :  673

choose_one :  950

F1score :  0.8415672913117546

AUC : 0.915951692552526

Confusion Matrix
[[603 209]
 [ 70 741]]
True label 0
0.7426108374384236  
0.25738916256157635  
True label 1
0.08631319358816276  
0.9136868064118372  

Train_result {'loss': [0.45482663848540783], 'acc': [0.8220256293579138]}
Saved model to disk



[[77.69562538508934, 1], [71.90388170055454, 2], [79.42082563154652, 3], [76.83302526186075, 4], [73.44423906346272, 5], [81.94701170671595, 6], [82.99445471349352, 7], [79.97535428219346, 8], [78.86629698089956, 9], [83.24091189155884, 10], [84.9044978434997, 11], [83.1792975970425, 12], [83.3641404805915, 13], [82.50154035736291, 14], [82.80961182994456, 15]]
max accuracy :  [84.9044978434997, 11]

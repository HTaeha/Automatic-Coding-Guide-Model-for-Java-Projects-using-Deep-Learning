Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:400: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-21 03:44:38.587476: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-21 03:44:38.595247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-21 03:44:38.597235: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x53ef150 executing computations on platform Host. Devices:
2019-08-21 03:44:38.597286: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 77

Under 10 : 0
Over 10, Under 200 : 30861
Over 200, Under 400 : 3677
Over 400 : 0


Test_zero:  2982
Train_zero:  26968
zero:  29950
Test_one:  804
Train_one:  7570
one:  8374

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15141 [..............................] - ETA: 1:13 - loss: 5.2694 - acc: 0.4062
  896/15141 [>.............................] - ETA: 5s - loss: 4.8537 - acc: 0.6127  
 1664/15141 [==>...........................] - ETA: 3s - loss: 4.1246 - acc: 0.6635
 2432/15141 [===>..........................] - ETA: 2s - loss: 3.8568 - acc: 0.6830
 3200/15141 [=====>........................] - ETA: 1s - loss: 3.7329 - acc: 0.6909
 3968/15141 [======>.......................] - ETA: 1s - loss: 3.5525 - acc: 0.7031
 4800/15141 [========>.....................] - ETA: 1s - loss: 3.3282 - acc: 0.7183
 5568/15141 [==========>...................] - ETA: 1s - loss: 3.2191 - acc: 0.7227
 6336/15141 [===========>..................] - ETA: 1s - loss: 3.1968 - acc: 0.7214
 7168/15141 [=============>................] - ETA: 0s - loss: 3.0909 - acc: 0.7285
 8000/15141 [==============>...............] - ETA: 0s - loss: 3.0059 - acc: 0.7315
 8832/15141 [================>.............] - ETA: 0s - loss: 2.9610 - acc: 0.7330
 9664/15141 [==================>...........] - ETA: 0s - loss: 2.8777 - acc: 0.7337
10496/15141 [===================>..........] - ETA: 0s - loss: 2.8302 - acc: 0.7335
11328/15141 [=====================>........] - ETA: 0s - loss: 2.7668 - acc: 0.7337
12096/15141 [======================>.......] - ETA: 0s - loss: 2.7091 - acc: 0.7322
12864/15141 [========================>.....] - ETA: 0s - loss: 2.6656 - acc: 0.7319
13632/15141 [==========================>...] - ETA: 0s - loss: 2.5796 - acc: 0.7347
14400/15141 [===========================>..] - ETA: 0s - loss: 2.5092 - acc: 0.7352
15141/15141 [==============================] - 1s 85us/step - loss: 2.4443 - acc: 0.7364

Test accuracy: 79.3039154754506

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  652

choose_one :  957

F1score :  0.8109028960817718

AUC : 0.8719515775161459

Confusion Matrix
[[562 243]
 [ 90 714]]
True label 0
0.698136645962733  
0.3018633540372671  
True label 1
0.11194029850746269  
0.8880597014925373  

Train_result {'loss': [2.4442873643558047], 'acc': [0.7364110692387787]}
Saved model to disk



2

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.5387 - acc: 0.8906
  896/15141 [>.............................] - ETA: 0s - loss: 1.0289 - acc: 0.7600
 1792/15141 [==>...........................] - ETA: 0s - loss: 0.9459 - acc: 0.7606
 2624/15141 [====>.........................] - ETA: 0s - loss: 0.9061 - acc: 0.7603
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.8440 - acc: 0.7595
 4288/15141 [=======>......................] - ETA: 0s - loss: 0.8211 - acc: 0.7558
 5056/15141 [=========>....................] - ETA: 0s - loss: 0.7939 - acc: 0.7577
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.7633 - acc: 0.7627
 6720/15141 [============>.................] - ETA: 0s - loss: 0.7379 - acc: 0.7615
 7552/15141 [=============>................] - ETA: 0s - loss: 0.7258 - acc: 0.7636
 8384/15141 [===============>..............] - ETA: 0s - loss: 0.7090 - acc: 0.7648
 9216/15141 [=================>............] - ETA: 0s - loss: 0.6915 - acc: 0.7648
10048/15141 [==================>...........] - ETA: 0s - loss: 0.6737 - acc: 0.7678
10880/15141 [====================>.........] - ETA: 0s - loss: 0.6602 - acc: 0.7689
11712/15141 [======================>.......] - ETA: 0s - loss: 0.6546 - acc: 0.7687
12544/15141 [=======================>......] - ETA: 0s - loss: 0.6458 - acc: 0.7689
13376/15141 [=========================>....] - ETA: 0s - loss: 0.6403 - acc: 0.7694
14208/15141 [===========================>..] - ETA: 0s - loss: 0.6330 - acc: 0.7702
15040/15141 [============================>.] - ETA: 0s - loss: 0.6265 - acc: 0.7705
15141/15141 [==============================] - 1s 63us/step - loss: 0.6268 - acc: 0.7706

Test accuracy: 80.36047234307023

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  883

choose_one :  726

F1score :  0.7934640522875817

AUC : 0.8897955872809863

Confusion Matrix
[[686 119]
 [197 607]]
True label 0
0.8521739130434782  
0.14782608695652175  
True label 1
0.24502487562189054  
0.7549751243781094  

Train_result {'loss': [0.6267506858527948], 'acc': [0.7706228122277522]}
Saved model to disk



3

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.5246 - acc: 0.7969
  960/15141 [>.............................] - ETA: 0s - loss: 0.5037 - acc: 0.7833
 1792/15141 [==>...........................] - ETA: 0s - loss: 0.5231 - acc: 0.7818
 2624/15141 [====>.........................] - ETA: 0s - loss: 0.5261 - acc: 0.7812
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.5072 - acc: 0.7827
 4160/15141 [=======>......................] - ETA: 0s - loss: 0.5138 - acc: 0.7815
 4992/15141 [========>.....................] - ETA: 0s - loss: 0.5157 - acc: 0.7790
 5824/15141 [==========>...................] - ETA: 0s - loss: 0.5173 - acc: 0.7787
 6656/15141 [============>.................] - ETA: 0s - loss: 0.5273 - acc: 0.7767
 7424/15141 [=============>................] - ETA: 0s - loss: 0.5218 - acc: 0.7811
 8256/15141 [===============>..............] - ETA: 0s - loss: 0.5208 - acc: 0.7809
 9024/15141 [================>.............] - ETA: 0s - loss: 0.5183 - acc: 0.7840
 9792/15141 [==================>...........] - ETA: 0s - loss: 0.5160 - acc: 0.7845
10560/15141 [===================>..........] - ETA: 0s - loss: 0.5157 - acc: 0.7848
11392/15141 [=====================>........] - ETA: 0s - loss: 0.5119 - acc: 0.7859
12224/15141 [=======================>......] - ETA: 0s - loss: 0.5109 - acc: 0.7860
13056/15141 [========================>.....] - ETA: 0s - loss: 0.5109 - acc: 0.7852
13952/15141 [==========================>...] - ETA: 0s - loss: 0.5128 - acc: 0.7858
14848/15141 [============================>.] - ETA: 0s - loss: 0.5132 - acc: 0.7854
15141/15141 [==============================] - 1s 64us/step - loss: 0.5113 - acc: 0.7865

Test accuracy: 75.76134244872593

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  995

choose_one :  614

F1score :  0.7249647390691114

AUC : 0.8738242019715089

Confusion Matrix
[[705 100]
 [290 514]]
True label 0
0.8757763975155279  
0.12422360248447205  
True label 1
0.36069651741293535  
0.6393034825870647  

Train_result {'loss': [0.5113286442253078], 'acc': [0.7864738128497212]}
Saved model to disk



4

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4769 - acc: 0.7656
  768/15141 [>.............................] - ETA: 1s - loss: 0.4976 - acc: 0.7852
 1536/15141 [==>...........................] - ETA: 0s - loss: 0.5056 - acc: 0.7930
 2304/15141 [===>..........................] - ETA: 0s - loss: 0.5026 - acc: 0.7951
 3136/15141 [=====>........................] - ETA: 0s - loss: 0.5005 - acc: 0.7988
 3968/15141 [======>.......................] - ETA: 0s - loss: 0.4998 - acc: 0.7976
 4800/15141 [========>.....................] - ETA: 0s - loss: 0.4952 - acc: 0.7977
 5632/15141 [==========>...................] - ETA: 0s - loss: 0.4999 - acc: 0.7923
 6464/15141 [===========>..................] - ETA: 0s - loss: 0.5012 - acc: 0.7896
 7296/15141 [=============>................] - ETA: 0s - loss: 0.4959 - acc: 0.7929
 8128/15141 [===============>..............] - ETA: 0s - loss: 0.4943 - acc: 0.7940
 8960/15141 [================>.............] - ETA: 0s - loss: 0.4948 - acc: 0.7931
 9792/15141 [==================>...........] - ETA: 0s - loss: 0.4924 - acc: 0.7920
10624/15141 [====================>.........] - ETA: 0s - loss: 0.4918 - acc: 0.7918
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4906 - acc: 0.7924
12288/15141 [=======================>......] - ETA: 0s - loss: 0.4885 - acc: 0.7917
13120/15141 [========================>.....] - ETA: 0s - loss: 0.4917 - acc: 0.7916
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4921 - acc: 0.7922
14912/15141 [============================>.] - ETA: 0s - loss: 0.4924 - acc: 0.7940
15141/15141 [==============================] - 1s 63us/step - loss: 0.4930 - acc: 0.7939

Test accuracy: 81.91423244251088

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  702

choose_one :  907

F1score :  0.8299240210403274

AUC : 0.8923202311424245

Confusion Matrix
[[608 197]
 [ 94 710]]
True label 0
0.7552795031055901  
0.24472049689440994  
True label 1
0.11691542288557213  
0.8830845771144279  

Train_result {'loss': [0.49303288174292803], 'acc': [0.7938709463817142]}
Saved model to disk



5

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4845 - acc: 0.7188
  960/15141 [>.............................] - ETA: 0s - loss: 0.4693 - acc: 0.8052
 1728/15141 [==>...........................] - ETA: 0s - loss: 0.4380 - acc: 0.8142
 2560/15141 [====>.........................] - ETA: 0s - loss: 0.4534 - acc: 0.8133
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4664 - acc: 0.8104
 4224/15141 [=======>......................] - ETA: 0s - loss: 0.4721 - acc: 0.8068
 5056/15141 [=========>....................] - ETA: 0s - loss: 0.4690 - acc: 0.8036
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.4757 - acc: 0.8010
 6656/15141 [============>.................] - ETA: 0s - loss: 0.4751 - acc: 0.8032
 7488/15141 [=============>................] - ETA: 0s - loss: 0.4771 - acc: 0.8007
 8320/15141 [===============>..............] - ETA: 0s - loss: 0.4784 - acc: 0.7972
 9152/15141 [=================>............] - ETA: 0s - loss: 0.4852 - acc: 0.7968
 9984/15141 [==================>...........] - ETA: 0s - loss: 0.4854 - acc: 0.7943
10816/15141 [====================>.........] - ETA: 0s - loss: 0.4850 - acc: 0.7943
11648/15141 [======================>.......] - ETA: 0s - loss: 0.4891 - acc: 0.7934
12480/15141 [=======================>......] - ETA: 0s - loss: 0.4862 - acc: 0.7931
13312/15141 [=========================>....] - ETA: 0s - loss: 0.4832 - acc: 0.7936
14144/15141 [===========================>..] - ETA: 0s - loss: 0.4801 - acc: 0.7950
14976/15141 [============================>.] - ETA: 0s - loss: 0.4807 - acc: 0.7948
15141/15141 [==============================] - 1s 63us/step - loss: 0.4819 - acc: 0.7947

Test accuracy: 81.78993163455563

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  796

choose_one :  813

F1score :  0.8188002473716759

AUC : 0.892114736874633

Confusion Matrix
[[654 151]
 [142 662]]
True label 0
0.8124223602484472  
0.18757763975155278  
True label 1
0.17661691542288557  
0.8233830845771144  

Train_result {'loss': [0.48189866996316927], 'acc': [0.7947295423377876]}
Saved model to disk



6

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3833 - acc: 0.7812
  896/15141 [>.............................] - ETA: 0s - loss: 0.4714 - acc: 0.7935
 1728/15141 [==>...........................] - ETA: 0s - loss: 0.4904 - acc: 0.7928
 2560/15141 [====>.........................] - ETA: 0s - loss: 0.4835 - acc: 0.7969
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4763 - acc: 0.7972
 4224/15141 [=======>......................] - ETA: 0s - loss: 0.4900 - acc: 0.7924
 5120/15141 [=========>....................] - ETA: 0s - loss: 0.4826 - acc: 0.7957
 5952/15141 [==========>...................] - ETA: 0s - loss: 0.4802 - acc: 0.7969
 6784/15141 [============>.................] - ETA: 0s - loss: 0.4773 - acc: 0.7970
 7616/15141 [==============>...............] - ETA: 0s - loss: 0.4771 - acc: 0.7988
 8448/15141 [===============>..............] - ETA: 0s - loss: 0.4778 - acc: 0.7979
 9280/15141 [=================>............] - ETA: 0s - loss: 0.4820 - acc: 0.7957
10112/15141 [===================>..........] - ETA: 0s - loss: 0.4809 - acc: 0.7958
10880/15141 [====================>.........] - ETA: 0s - loss: 0.4781 - acc: 0.7961
11712/15141 [======================>.......] - ETA: 0s - loss: 0.4807 - acc: 0.7985
12480/15141 [=======================>......] - ETA: 0s - loss: 0.4810 - acc: 0.7990
13248/15141 [=========================>....] - ETA: 0s - loss: 0.4771 - acc: 0.8000
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4796 - acc: 0.8000
14848/15141 [============================>.] - ETA: 0s - loss: 0.4784 - acc: 0.8012
15141/15141 [==============================] - 1s 63us/step - loss: 0.4786 - acc: 0.8008

Test accuracy: 82.16283405842137

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  744

choose_one :  865

F1score :  0.8280407429598562

AUC : 0.900940174901888

Confusion Matrix
[[631 174]
 [113 691]]
True label 0
0.7838509316770186  
0.21614906832298136  
True label 1
0.14054726368159204  
0.8594527363184079  

Train_result {'loss': [0.4786088061564177], 'acc': [0.8008057591535797]}
Saved model to disk



7

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4216 - acc: 0.8594
  768/15141 [>.............................] - ETA: 1s - loss: 0.4808 - acc: 0.7786
 1536/15141 [==>...........................] - ETA: 0s - loss: 0.4807 - acc: 0.7845
 2368/15141 [===>..........................] - ETA: 0s - loss: 0.4808 - acc: 0.7931
 3200/15141 [=====>........................] - ETA: 0s - loss: 0.4787 - acc: 0.7922
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4690 - acc: 0.7986
 4864/15141 [========>.....................] - ETA: 0s - loss: 0.4676 - acc: 0.7961
 5696/15141 [==========>...................] - ETA: 0s - loss: 0.4669 - acc: 0.7960
 6464/15141 [===========>..................] - ETA: 0s - loss: 0.4635 - acc: 0.7981
 7296/15141 [=============>................] - ETA: 0s - loss: 0.4622 - acc: 0.8004
 8128/15141 [===============>..............] - ETA: 0s - loss: 0.4615 - acc: 0.8022
 8960/15141 [================>.............] - ETA: 0s - loss: 0.4634 - acc: 0.8031
 9728/15141 [==================>...........] - ETA: 0s - loss: 0.4650 - acc: 0.8042
10560/15141 [===================>..........] - ETA: 0s - loss: 0.4653 - acc: 0.8021
11392/15141 [=====================>........] - ETA: 0s - loss: 0.4650 - acc: 0.8025
12224/15141 [=======================>......] - ETA: 0s - loss: 0.4651 - acc: 0.8021
13120/15141 [========================>.....] - ETA: 0s - loss: 0.4633 - acc: 0.8024
13952/15141 [==========================>...] - ETA: 0s - loss: 0.4594 - acc: 0.8028
14784/15141 [============================>.] - ETA: 0s - loss: 0.4586 - acc: 0.8032
15141/15141 [==============================] - 1s 64us/step - loss: 0.4585 - acc: 0.8039

Test accuracy: 76.32069608452456

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  1006

choose_one :  603

F1score :  0.7292110874200426

AUC : 0.8889566144433114

Confusion Matrix
[[715  90]
 [291 513]]
True label 0
0.8881987577639752  
0.11180124223602485  
True label 1
0.3619402985074627  
0.6380597014925373  

Train_result {'loss': [0.45854716253803424], 'acc': [0.8039099135035749]}
Saved model to disk



8

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4937 - acc: 0.7969
  896/15141 [>.............................] - ETA: 0s - loss: 0.4951 - acc: 0.7958
 1728/15141 [==>...........................] - ETA: 0s - loss: 0.4774 - acc: 0.7957
 2560/15141 [====>.........................] - ETA: 0s - loss: 0.4806 - acc: 0.7949
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4684 - acc: 0.7933
 4224/15141 [=======>......................] - ETA: 0s - loss: 0.4712 - acc: 0.7943
 5056/15141 [=========>....................] - ETA: 0s - loss: 0.4733 - acc: 0.7957
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.4790 - acc: 0.7964
 6720/15141 [============>.................] - ETA: 0s - loss: 0.4755 - acc: 0.7970
 7488/15141 [=============>................] - ETA: 0s - loss: 0.4754 - acc: 0.7962
 8256/15141 [===============>..............] - ETA: 0s - loss: 0.4753 - acc: 0.7968
 9088/15141 [=================>............] - ETA: 0s - loss: 0.4682 - acc: 0.7993
 9920/15141 [==================>...........] - ETA: 0s - loss: 0.4694 - acc: 0.7980
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4659 - acc: 0.7985
11584/15141 [=====================>........] - ETA: 0s - loss: 0.4671 - acc: 0.7990
12416/15141 [=======================>......] - ETA: 0s - loss: 0.4655 - acc: 0.7984
13184/15141 [=========================>....] - ETA: 0s - loss: 0.4637 - acc: 0.7989
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4618 - acc: 0.8004
14784/15141 [============================>.] - ETA: 0s - loss: 0.4585 - acc: 0.8005
15141/15141 [==============================] - 1s 64us/step - loss: 0.4599 - acc: 0.8000

Test accuracy: 81.29272840273461

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  660

choose_one :  949

F1score :  0.8282943525385055

AUC : 0.9050747813726399

Confusion Matrix
[[582 223]
 [ 78 726]]
True label 0
0.7229813664596273  
0.27701863354037265  
True label 1
0.09701492537313433  
0.9029850746268657  

Train_result {'loss': [0.45992981506129343], 'acc': [0.8000132091120491]}
Saved model to disk



9

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3447 - acc: 0.7812
  896/15141 [>.............................] - ETA: 0s - loss: 0.4161 - acc: 0.8114
 1600/15141 [==>...........................] - ETA: 0s - loss: 0.4206 - acc: 0.8194
 2368/15141 [===>..........................] - ETA: 0s - loss: 0.4499 - acc: 0.8041
 3136/15141 [=====>........................] - ETA: 0s - loss: 0.4575 - acc: 0.8077
 3904/15141 [======>.......................] - ETA: 0s - loss: 0.4569 - acc: 0.8071
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4523 - acc: 0.8104
 5504/15141 [=========>....................] - ETA: 0s - loss: 0.4509 - acc: 0.8094
 6336/15141 [===========>..................] - ETA: 0s - loss: 0.4441 - acc: 0.8117
 7168/15141 [=============>................] - ETA: 0s - loss: 0.4467 - acc: 0.8114
 8000/15141 [==============>...............] - ETA: 0s - loss: 0.4483 - acc: 0.8100
 8832/15141 [================>.............] - ETA: 0s - loss: 0.4454 - acc: 0.8108
 9664/15141 [==================>...........] - ETA: 0s - loss: 0.4507 - acc: 0.8106
10496/15141 [===================>..........] - ETA: 0s - loss: 0.4494 - acc: 0.8115
11392/15141 [=====================>........] - ETA: 0s - loss: 0.4489 - acc: 0.8115
12224/15141 [=======================>......] - ETA: 0s - loss: 0.4488 - acc: 0.8127
13056/15141 [========================>.....] - ETA: 0s - loss: 0.4480 - acc: 0.8147
13888/15141 [==========================>...] - ETA: 0s - loss: 0.4469 - acc: 0.8139
14720/15141 [============================>.] - ETA: 0s - loss: 0.4497 - acc: 0.8128
15141/15141 [==============================] - 1s 64us/step - loss: 0.4504 - acc: 0.8124

Test accuracy: 79.42821628340585

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  970

choose_one :  639

F1score :  0.7706167706167706

AUC : 0.9005662680386886

Confusion Matrix
[[722  83]
 [248 556]]
True label 0
0.8968944099378882  
0.1031055900621118  
True label 1
0.30845771144278605  
0.6915422885572139  

Train_result {'loss': [0.4504169855397457], 'acc': [0.8124298263230717]}
Saved model to disk



10

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3829 - acc: 0.8750
  960/15141 [>.............................] - ETA: 0s - loss: 0.4437 - acc: 0.8031
 1792/15141 [==>...........................] - ETA: 0s - loss: 0.4410 - acc: 0.7980
 2624/15141 [====>.........................] - ETA: 0s - loss: 0.4320 - acc: 0.8007
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.4418 - acc: 0.7975
 4352/15141 [=======>......................] - ETA: 0s - loss: 0.4313 - acc: 0.8040
 5184/15141 [=========>....................] - ETA: 0s - loss: 0.4364 - acc: 0.8029
 6016/15141 [==========>...................] - ETA: 0s - loss: 0.4342 - acc: 0.8040
 6848/15141 [============>.................] - ETA: 0s - loss: 0.4378 - acc: 0.8048
 7552/15141 [=============>................] - ETA: 0s - loss: 0.4373 - acc: 0.8061
 8320/15141 [===============>..............] - ETA: 0s - loss: 0.4411 - acc: 0.8034
 9088/15141 [=================>............] - ETA: 0s - loss: 0.4403 - acc: 0.8030
 9920/15141 [==================>...........] - ETA: 0s - loss: 0.4397 - acc: 0.8039
10688/15141 [====================>.........] - ETA: 0s - loss: 0.4386 - acc: 0.8067
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4406 - acc: 0.8070
12224/15141 [=======================>......] - ETA: 0s - loss: 0.4442 - acc: 0.8060
12992/15141 [========================>.....] - ETA: 0s - loss: 0.4436 - acc: 0.8070
13824/15141 [==========================>...] - ETA: 0s - loss: 0.4415 - acc: 0.8087
14656/15141 [============================>.] - ETA: 0s - loss: 0.4370 - acc: 0.8113
15141/15141 [==============================] - 1s 65us/step - loss: 0.4392 - acc: 0.8104

Test accuracy: 82.41143567433188

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  754

choose_one :  855

F1score :  0.8294153104279687

AUC : 0.8978284045610457

Confusion Matrix
[[638 167]
 [116 688]]
True label 0
0.7925465838509317  
0.20745341614906831  
True label 1
0.14427860696517414  
0.8557213930348259  

Train_result {'loss': [0.4392197924300061], 'acc': [0.8104484512881365]}
Saved model to disk



11

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.6764 - acc: 0.7656
  896/15141 [>.............................] - ETA: 0s - loss: 0.4267 - acc: 0.8214
 1728/15141 [==>...........................] - ETA: 0s - loss: 0.4160 - acc: 0.8218
 2496/15141 [===>..........................] - ETA: 0s - loss: 0.4198 - acc: 0.8249
 3264/15141 [=====>........................] - ETA: 0s - loss: 0.4169 - acc: 0.8294
 4096/15141 [=======>......................] - ETA: 0s - loss: 0.4301 - acc: 0.8254
 4928/15141 [========>.....................] - ETA: 0s - loss: 0.4374 - acc: 0.8243
 5760/15141 [==========>...................] - ETA: 0s - loss: 0.4339 - acc: 0.8229
 6592/15141 [============>.................] - ETA: 0s - loss: 0.4341 - acc: 0.8230
 7424/15141 [=============>................] - ETA: 0s - loss: 0.4374 - acc: 0.8218
 8256/15141 [===============>..............] - ETA: 0s - loss: 0.4376 - acc: 0.8218
 9088/15141 [=================>............] - ETA: 0s - loss: 0.4374 - acc: 0.8205
 9920/15141 [==================>...........] - ETA: 0s - loss: 0.4387 - acc: 0.8210
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4423 - acc: 0.8185
11584/15141 [=====================>........] - ETA: 0s - loss: 0.4424 - acc: 0.8175
12416/15141 [=======================>......] - ETA: 0s - loss: 0.4425 - acc: 0.8177
13248/15141 [=========================>....] - ETA: 0s - loss: 0.4450 - acc: 0.8142
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4419 - acc: 0.8143
14848/15141 [============================>.] - ETA: 0s - loss: 0.4395 - acc: 0.8149
15141/15141 [==============================] - 1s 63us/step - loss: 0.4393 - acc: 0.8149

Test accuracy: 70.10565568676196

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  1198

choose_one :  411

F1score :  0.6041152263374485

AUC : 0.8872168659806559

Confusion Matrix
[[761  44]
 [437 367]]
True label 0
0.9453416149068323  
0.0546583850931677  
True label 1
0.5435323383084577  
0.4564676616915423  

Train_result {'loss': [0.4393257739938996], 'acc': [0.8148735222204871]}
Saved model to disk



12

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3127 - acc: 0.8438
  832/15141 [>.............................] - ETA: 0s - loss: 0.4318 - acc: 0.8329
 1600/15141 [==>...........................] - ETA: 0s - loss: 0.4351 - acc: 0.8163
 2368/15141 [===>..........................] - ETA: 0s - loss: 0.4381 - acc: 0.8117
 3200/15141 [=====>........................] - ETA: 0s - loss: 0.4306 - acc: 0.8166
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4310 - acc: 0.8165
 4864/15141 [========>.....................] - ETA: 0s - loss: 0.4352 - acc: 0.8172
 5696/15141 [==========>...................] - ETA: 0s - loss: 0.4321 - acc: 0.8172
 6528/15141 [===========>..................] - ETA: 0s - loss: 0.4342 - acc: 0.8145
 7424/15141 [=============>................] - ETA: 0s - loss: 0.4314 - acc: 0.8176
 8256/15141 [===============>..............] - ETA: 0s - loss: 0.4351 - acc: 0.8155
 9088/15141 [=================>............] - ETA: 0s - loss: 0.4327 - acc: 0.8149
 9920/15141 [==================>...........] - ETA: 0s - loss: 0.4310 - acc: 0.8157
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4310 - acc: 0.8172
11584/15141 [=====================>........] - ETA: 0s - loss: 0.4351 - acc: 0.8161
12352/15141 [=======================>......] - ETA: 0s - loss: 0.4360 - acc: 0.8161
13184/15141 [=========================>....] - ETA: 0s - loss: 0.4388 - acc: 0.8136
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4409 - acc: 0.8131
14848/15141 [============================>.] - ETA: 0s - loss: 0.4409 - acc: 0.8132
15141/15141 [==============================] - 1s 64us/step - loss: 0.4409 - acc: 0.8129

Test accuracy: 82.66003729024239

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  668

choose_one :  941

F1score :  0.8401146131805157

AUC : 0.9098243255770835

Confusion Matrix
[[597 208]
 [ 71 733]]
True label 0
0.7416149068322981  
0.25838509316770186  
True label 1
0.08830845771144279  
0.9116915422885572  

Train_result {'loss': [0.44085636509294657], 'acc': [0.8128921470831993]}
Saved model to disk



13

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4123 - acc: 0.7969
  768/15141 [>.............................] - ETA: 1s - loss: 0.4594 - acc: 0.8047
 1536/15141 [==>...........................] - ETA: 0s - loss: 0.4708 - acc: 0.7956
 2304/15141 [===>..........................] - ETA: 0s - loss: 0.4527 - acc: 0.8090
 3072/15141 [=====>........................] - ETA: 0s - loss: 0.4447 - acc: 0.8128
 3904/15141 [======>.......................] - ETA: 0s - loss: 0.4482 - acc: 0.8151
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4350 - acc: 0.8188
 5568/15141 [==========>...................] - ETA: 0s - loss: 0.4372 - acc: 0.8191
 6400/15141 [===========>..................] - ETA: 0s - loss: 0.4367 - acc: 0.8155
 7232/15141 [=============>................] - ETA: 0s - loss: 0.4345 - acc: 0.8157
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4353 - acc: 0.8171
 8896/15141 [================>.............] - ETA: 0s - loss: 0.4374 - acc: 0.8132
 9664/15141 [==================>...........] - ETA: 0s - loss: 0.4361 - acc: 0.8124
10432/15141 [===================>..........] - ETA: 0s - loss: 0.4353 - acc: 0.8124
11200/15141 [=====================>........] - ETA: 0s - loss: 0.4340 - acc: 0.8123
11968/15141 [======================>.......] - ETA: 0s - loss: 0.4324 - acc: 0.8128
12800/15141 [========================>.....] - ETA: 0s - loss: 0.4317 - acc: 0.8132
13632/15141 [==========================>...] - ETA: 0s - loss: 0.4334 - acc: 0.8125
14400/15141 [===========================>..] - ETA: 0s - loss: 0.4314 - acc: 0.8134
15141/15141 [==============================] - 1s 65us/step - loss: 0.4347 - acc: 0.8130

Test accuracy: 77.25295214418894

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  1035

choose_one :  574

F1score :  0.7343976777939041

AUC : 0.9042234479775038

Confusion Matrix
[[737  68]
 [298 506]]
True label 0
0.915527950310559  
0.084472049689441  
True label 1
0.3706467661691542  
0.6293532338308457  

Train_result {'loss': [0.4346817376496935], 'acc': [0.8129581929426292]}
Saved model to disk



14

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4548 - acc: 0.8125
  832/15141 [>.............................] - ETA: 0s - loss: 0.4716 - acc: 0.7981
 1600/15141 [==>...........................] - ETA: 0s - loss: 0.4553 - acc: 0.8037
 2368/15141 [===>..........................] - ETA: 0s - loss: 0.4603 - acc: 0.8079
 3136/15141 [=====>........................] - ETA: 0s - loss: 0.4438 - acc: 0.8106
 3904/15141 [======>.......................] - ETA: 0s - loss: 0.4419 - acc: 0.8128
 4672/15141 [========>.....................] - ETA: 0s - loss: 0.4390 - acc: 0.8097
 5440/15141 [=========>....................] - ETA: 0s - loss: 0.4422 - acc: 0.8123
 6272/15141 [===========>..................] - ETA: 0s - loss: 0.4404 - acc: 0.8130
 7040/15141 [============>.................] - ETA: 0s - loss: 0.4490 - acc: 0.8112
 7808/15141 [==============>...............] - ETA: 0s - loss: 0.4504 - acc: 0.8110
 8576/15141 [===============>..............] - ETA: 0s - loss: 0.4462 - acc: 0.8124
 9408/15141 [=================>............] - ETA: 0s - loss: 0.4439 - acc: 0.8138
10240/15141 [===================>..........] - ETA: 0s - loss: 0.4394 - acc: 0.8146
11072/15141 [====================>.........] - ETA: 0s - loss: 0.4352 - acc: 0.8160
11968/15141 [======================>.......] - ETA: 0s - loss: 0.4364 - acc: 0.8170
12864/15141 [========================>.....] - ETA: 0s - loss: 0.4372 - acc: 0.8161
13696/15141 [==========================>...] - ETA: 0s - loss: 0.4352 - acc: 0.8160
14528/15141 [===========================>..] - ETA: 0s - loss: 0.4361 - acc: 0.8165
15141/15141 [==============================] - 1s 64us/step - loss: 0.4360 - acc: 0.8165

Test accuracy: 81.9763828464885

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  869

choose_one :  740

F1score :  0.8121761658031088

AUC : 0.9060419949939743

Confusion Matrix
[[692 113]
 [177 627]]
True label 0
0.8596273291925466  
0.14037267080745341  
True label 1
0.22014925373134328  
0.7798507462686567  

Train_result {'loss': [0.4360163182888216], 'acc': [0.8165246681432949]}
Saved model to disk



15

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.6234 - acc: 0.7500
 1024/15141 [=>............................] - ETA: 0s - loss: 0.4535 - acc: 0.7988
 1984/15141 [==>...........................] - ETA: 0s - loss: 0.4175 - acc: 0.8150
 2880/15141 [====>.........................] - ETA: 0s - loss: 0.4314 - acc: 0.8135
 3712/15141 [======>.......................] - ETA: 0s - loss: 0.4387 - acc: 0.8133
 4544/15141 [========>.....................] - ETA: 0s - loss: 0.4345 - acc: 0.8171
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4282 - acc: 0.8185
 6208/15141 [===========>..................] - ETA: 0s - loss: 0.4329 - acc: 0.8154
 7040/15141 [============>.................] - ETA: 0s - loss: 0.4371 - acc: 0.8145
 7872/15141 [==============>...............] - ETA: 0s - loss: 0.4348 - acc: 0.8140
 8704/15141 [================>.............] - ETA: 0s - loss: 0.4314 - acc: 0.8148
 9536/15141 [=================>............] - ETA: 0s - loss: 0.4324 - acc: 0.8154
10368/15141 [===================>..........] - ETA: 0s - loss: 0.4338 - acc: 0.8154
11200/15141 [=====================>........] - ETA: 0s - loss: 0.4348 - acc: 0.8149
12032/15141 [======================>.......] - ETA: 0s - loss: 0.4366 - acc: 0.8146
12800/15141 [========================>.....] - ETA: 0s - loss: 0.4396 - acc: 0.8134
13632/15141 [==========================>...] - ETA: 0s - loss: 0.4385 - acc: 0.8139
14464/15141 [===========================>..] - ETA: 0s - loss: 0.4353 - acc: 0.8151
15141/15141 [==============================] - 1s 61us/step - loss: 0.4348 - acc: 0.8145

Test accuracy: 83.77874456183964

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  780

choose_one :  829

F1score :  0.8401714635639925

AUC : 0.913696270201786

Confusion Matrix
[[662 143]
 [118 686]]
True label 0
0.822360248447205  
0.17763975155279504  
True label 1
0.14676616915422885  
0.8532338308457711  

Train_result {'loss': [0.4348079749433409], 'acc': [0.8144772472607398]}
Saved model to disk



[[79.3039154754506, 1], [80.36047234307023, 2], [75.76134244872593, 3], [81.91423244251088, 4], [81.78993163455563, 5], [82.16283405842137, 6], [76.32069608452456, 7], [81.29272840273461, 8], [79.42821628340585, 9], [82.41143567433188, 10], [70.10565568676196, 11], [82.66003729024239, 12], [77.25295214418894, 13], [81.9763828464885, 14], [83.77874456183964, 15]]
max accuracy :  [83.77874456183964, 15]

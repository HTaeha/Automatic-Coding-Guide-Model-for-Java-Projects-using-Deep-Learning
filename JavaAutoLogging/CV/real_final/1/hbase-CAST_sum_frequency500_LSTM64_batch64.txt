Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_balanced_auto_logging.py:389: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-17 21:07:44.343225: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-17 21:07:44.353740: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-17 21:07:44.355959: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5fe1740 executing computations on platform Host. Devices:
2019-08-17 21:07:44.355985: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 83

Under 10 : 0
Over 10, Under 200 : 31184
Over 200, Under 400 : 4247
Over 400 : 0


Test_zero:  3082
Train_zero:  27814
zero:  30896
Test_one:  805
Train_one:  7617
one:  8422

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 200)       0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 1, 200)       0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

   64/15235 [..............................] - ETA: 5:59 - loss: 0.9755 - acc: 0.4062
  576/15235 [>.............................] - ETA: 39s - loss: 0.6764 - acc: 0.6285 
 1152/15235 [=>............................] - ETA: 19s - loss: 0.6138 - acc: 0.6840
 1792/15235 [==>...........................] - ETA: 12s - loss: 0.5928 - acc: 0.6975
 2496/15235 [===>..........................] - ETA: 8s - loss: 0.5736 - acc: 0.7171 
 3264/15235 [=====>........................] - ETA: 6s - loss: 0.5653 - acc: 0.7209
 4032/15235 [======>.......................] - ETA: 5s - loss: 0.5588 - acc: 0.7240
 4736/15235 [========>.....................] - ETA: 4s - loss: 0.5508 - acc: 0.7293
 5504/15235 [=========>....................] - ETA: 3s - loss: 0.5437 - acc: 0.7329
 6272/15235 [===========>..................] - ETA: 2s - loss: 0.5369 - acc: 0.7403
 6912/15235 [============>.................] - ETA: 2s - loss: 0.5292 - acc: 0.7442
 7552/15235 [=============>................] - ETA: 2s - loss: 0.5287 - acc: 0.7454
 8192/15235 [===============>..............] - ETA: 1s - loss: 0.5262 - acc: 0.7471
 8832/15235 [================>.............] - ETA: 1s - loss: 0.5244 - acc: 0.7462
 9472/15235 [=================>............] - ETA: 1s - loss: 0.5204 - acc: 0.7482
10112/15235 [==================>...........] - ETA: 1s - loss: 0.5166 - acc: 0.7499
10816/15235 [====================>.........] - ETA: 0s - loss: 0.5117 - acc: 0.7531
11456/15235 [=====================>........] - ETA: 0s - loss: 0.5096 - acc: 0.7546
12096/15235 [======================>.......] - ETA: 0s - loss: 0.5077 - acc: 0.7558
12800/15235 [========================>.....] - ETA: 0s - loss: 0.5053 - acc: 0.7577
13568/15235 [=========================>....] - ETA: 0s - loss: 0.5023 - acc: 0.7599
14272/15235 [===========================>..] - ETA: 0s - loss: 0.5013 - acc: 0.7611
14912/15235 [============================>.] - ETA: 0s - loss: 0.5009 - acc: 0.7620
15235/15235 [==============================] - 3s 177us/step - loss: 0.5013 - acc: 0.7625

Test accuracy: 79.95034140285537

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  711

choose_one :  900

F1score :  0.8105571847507331

AUC : 0.8831365689009448

Confusion Matrix
[[597 209]
 [114 691]]
True label 0
0.7406947890818859  
0.25930521091811415  
True label 1
0.14161490683229813  
0.8583850931677018  

Train_result {'loss': [0.5012935619296345], 'acc': [0.7624548736501218]}
Saved model to disk



2

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.5063 - acc: 0.7656
  640/15235 [>.............................] - ETA: 1s - loss: 0.4394 - acc: 0.7906
 1280/15235 [=>............................] - ETA: 1s - loss: 0.4617 - acc: 0.7867
 1920/15235 [==>...........................] - ETA: 1s - loss: 0.4639 - acc: 0.7849
 2624/15235 [====>.........................] - ETA: 1s - loss: 0.4522 - acc: 0.7931
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.4549 - acc: 0.7930
 4096/15235 [=======>......................] - ETA: 0s - loss: 0.4596 - acc: 0.7910
 4864/15235 [========>.....................] - ETA: 0s - loss: 0.4624 - acc: 0.7899
 5632/15235 [==========>...................] - ETA: 0s - loss: 0.4614 - acc: 0.7898
 6336/15235 [===========>..................] - ETA: 0s - loss: 0.4591 - acc: 0.7902
 7040/15235 [============>.................] - ETA: 0s - loss: 0.4596 - acc: 0.7891
 7680/15235 [==============>...............] - ETA: 0s - loss: 0.4596 - acc: 0.7892
 8320/15235 [===============>..............] - ETA: 0s - loss: 0.4600 - acc: 0.7883
 8960/15235 [================>.............] - ETA: 0s - loss: 0.4569 - acc: 0.7890
 9664/15235 [==================>...........] - ETA: 0s - loss: 0.4596 - acc: 0.7876
10368/15235 [===================>..........] - ETA: 0s - loss: 0.4574 - acc: 0.7891
11072/15235 [====================>.........] - ETA: 0s - loss: 0.4546 - acc: 0.7910
11776/15235 [======================>.......] - ETA: 0s - loss: 0.4525 - acc: 0.7925
12480/15235 [=======================>......] - ETA: 0s - loss: 0.4531 - acc: 0.7920
13184/15235 [========================>.....] - ETA: 0s - loss: 0.4557 - acc: 0.7910
13888/15235 [==========================>...] - ETA: 0s - loss: 0.4553 - acc: 0.7910
14592/15235 [===========================>..] - ETA: 0s - loss: 0.4540 - acc: 0.7919
15235/15235 [==============================] - 1s 76us/step - loss: 0.4547 - acc: 0.7907

Test accuracy: 80.26070763500931

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  754

choose_one :  857

F1score :  0.8086642599277978

AUC : 0.8904112017015243

Confusion Matrix
[[621 185]
 [133 672]]
True label 0
0.7704714640198511  
0.22952853598014888  
True label 1
0.16521739130434782  
0.8347826086956521  

Train_result {'loss': [0.45474572929742885], 'acc': [0.7907449950810373]}
Saved model to disk



3

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4305 - acc: 0.7812
  640/15235 [>.............................] - ETA: 1s - loss: 0.4284 - acc: 0.8078
 1344/15235 [=>............................] - ETA: 1s - loss: 0.4385 - acc: 0.7946
 2048/15235 [===>..........................] - ETA: 1s - loss: 0.4397 - acc: 0.7925
 2752/15235 [====>.........................] - ETA: 0s - loss: 0.4438 - acc: 0.7932
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.4380 - acc: 0.8006
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.4397 - acc: 0.8002
 4800/15235 [========>.....................] - ETA: 0s - loss: 0.4408 - acc: 0.7971
 5504/15235 [=========>....................] - ETA: 0s - loss: 0.4420 - acc: 0.7971
 6144/15235 [===========>..................] - ETA: 0s - loss: 0.4411 - acc: 0.7983
 6848/15235 [============>.................] - ETA: 0s - loss: 0.4412 - acc: 0.7991
 7552/15235 [=============>................] - ETA: 0s - loss: 0.4403 - acc: 0.7995
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.4402 - acc: 0.7985
 8832/15235 [================>.............] - ETA: 0s - loss: 0.4421 - acc: 0.7978
 9536/15235 [=================>............] - ETA: 0s - loss: 0.4430 - acc: 0.7968
10176/15235 [===================>..........] - ETA: 0s - loss: 0.4430 - acc: 0.7964
10816/15235 [====================>.........] - ETA: 0s - loss: 0.4415 - acc: 0.7974
11456/15235 [=====================>........] - ETA: 0s - loss: 0.4426 - acc: 0.7967
12160/15235 [======================>.......] - ETA: 0s - loss: 0.4422 - acc: 0.7960
12928/15235 [========================>.....] - ETA: 0s - loss: 0.4422 - acc: 0.7966
13632/15235 [=========================>....] - ETA: 0s - loss: 0.4428 - acc: 0.7968
14336/15235 [===========================>..] - ETA: 0s - loss: 0.4427 - acc: 0.7972
15040/15235 [============================>.] - ETA: 0s - loss: 0.4419 - acc: 0.7975
15235/15235 [==============================] - 1s 77us/step - loss: 0.4410 - acc: 0.7980

Test accuracy: 80.88144009931719

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  646

choose_one :  965

F1score :  0.8259887005649718

AUC : 0.8903564878319437

Confusion Matrix
[[572 234]
 [ 74 731]]
True label 0
0.7096774193548387  
0.2903225806451613  
True label 1
0.09192546583850932  
0.9080745341614906  

Train_result {'loss': [0.4409682499763807], 'acc': [0.7979652116855794]}
Saved model to disk



4

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4621 - acc: 0.8125
  704/15235 [>.............................] - ETA: 1s - loss: 0.4071 - acc: 0.8125
 1408/15235 [=>............................] - ETA: 1s - loss: 0.4191 - acc: 0.8082
 2112/15235 [===>..........................] - ETA: 1s - loss: 0.4174 - acc: 0.8063
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.4252 - acc: 0.7997
 3584/15235 [======>.......................] - ETA: 0s - loss: 0.4260 - acc: 0.8005
 4288/15235 [=======>......................] - ETA: 0s - loss: 0.4256 - acc: 0.8034
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.4215 - acc: 0.8065
 5696/15235 [==========>...................] - ETA: 0s - loss: 0.4269 - acc: 0.8032
 6400/15235 [===========>..................] - ETA: 0s - loss: 0.4332 - acc: 0.8009
 7104/15235 [============>.................] - ETA: 0s - loss: 0.4385 - acc: 0.7980
 7808/15235 [==============>...............] - ETA: 0s - loss: 0.4406 - acc: 0.7961
 8512/15235 [===============>..............] - ETA: 0s - loss: 0.4404 - acc: 0.7959
 9216/15235 [=================>............] - ETA: 0s - loss: 0.4398 - acc: 0.7964
 9920/15235 [==================>...........] - ETA: 0s - loss: 0.4383 - acc: 0.7975
10560/15235 [===================>..........] - ETA: 0s - loss: 0.4387 - acc: 0.7977
11264/15235 [=====================>........] - ETA: 0s - loss: 0.4362 - acc: 0.7994
12032/15235 [======================>.......] - ETA: 0s - loss: 0.4357 - acc: 0.7995
12672/15235 [=======================>......] - ETA: 0s - loss: 0.4358 - acc: 0.7995
13376/15235 [=========================>....] - ETA: 0s - loss: 0.4365 - acc: 0.7992
14080/15235 [==========================>...] - ETA: 0s - loss: 0.4355 - acc: 0.7997
14720/15235 [===========================>..] - ETA: 0s - loss: 0.4362 - acc: 0.7998
15235/15235 [==============================] - 1s 76us/step - loss: 0.4363 - acc: 0.7995

Test accuracy: 81.12973308504034

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  686

choose_one :  925

F1score :  0.8242774566473987

AUC : 0.8957192176687268

Confusion Matrix
[[594 212]
 [ 92 713]]
True label 0
0.7369727047146402  
0.2630272952853598  
True label 1
0.11428571428571428  
0.8857142857142857  

Train_result {'loss': [0.4363119377517137], 'acc': [0.7994748933416216]}
Saved model to disk



5

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.5845 - acc: 0.6875
  768/15235 [>.............................] - ETA: 1s - loss: 0.4508 - acc: 0.7721
 1408/15235 [=>............................] - ETA: 1s - loss: 0.4245 - acc: 0.7976
 2112/15235 [===>..........................] - ETA: 1s - loss: 0.4277 - acc: 0.7955
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.4226 - acc: 0.8015
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.4124 - acc: 0.8082
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.4146 - acc: 0.8070
 4864/15235 [========>.....................] - ETA: 0s - loss: 0.4240 - acc: 0.8024
 5568/15235 [=========>....................] - ETA: 0s - loss: 0.4278 - acc: 0.8014
 6272/15235 [===========>..................] - ETA: 0s - loss: 0.4294 - acc: 0.7991
 7040/15235 [============>.................] - ETA: 0s - loss: 0.4282 - acc: 0.8006
 7744/15235 [==============>...............] - ETA: 0s - loss: 0.4258 - acc: 0.8015
 8384/15235 [===============>..............] - ETA: 0s - loss: 0.4256 - acc: 0.8016
 9024/15235 [================>.............] - ETA: 0s - loss: 0.4267 - acc: 0.8010
 9728/15235 [==================>...........] - ETA: 0s - loss: 0.4273 - acc: 0.8003
10432/15235 [===================>..........] - ETA: 0s - loss: 0.4269 - acc: 0.8005
11072/15235 [====================>.........] - ETA: 0s - loss: 0.4271 - acc: 0.8011
11776/15235 [======================>.......] - ETA: 0s - loss: 0.4253 - acc: 0.8023
12480/15235 [=======================>......] - ETA: 0s - loss: 0.4245 - acc: 0.8029
13184/15235 [========================>.....] - ETA: 0s - loss: 0.4259 - acc: 0.8033
13888/15235 [==========================>...] - ETA: 0s - loss: 0.4273 - acc: 0.8027
14592/15235 [===========================>..] - ETA: 0s - loss: 0.4261 - acc: 0.8035
15235/15235 [==============================] - 1s 76us/step - loss: 0.4255 - acc: 0.8039

Test accuracy: 81.62631905648665

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  706

choose_one :  905

F1score :  0.8269005847953217

AUC : 0.8986583542684524

Confusion Matrix
[[608 198]
 [ 98 707]]
True label 0
0.7543424317617866  
0.2456575682382134  
True label 1
0.12173913043478261  
0.8782608695652174  

Train_result {'loss': [0.4254667336994756], 'acc': [0.8038726616383068]}
Saved model to disk



6

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.3945 - acc: 0.8281
  768/15235 [>.............................] - ETA: 1s - loss: 0.4167 - acc: 0.8268
 1472/15235 [=>............................] - ETA: 1s - loss: 0.4070 - acc: 0.8281
 2176/15235 [===>..........................] - ETA: 0s - loss: 0.4317 - acc: 0.8116
 2880/15235 [====>.........................] - ETA: 0s - loss: 0.4316 - acc: 0.8104
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.4257 - acc: 0.8128
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.4247 - acc: 0.8142
 4928/15235 [========>.....................] - ETA: 0s - loss: 0.4269 - acc: 0.8105
 5568/15235 [=========>....................] - ETA: 0s - loss: 0.4290 - acc: 0.8091
 6208/15235 [===========>..................] - ETA: 0s - loss: 0.4219 - acc: 0.8119
 6912/15235 [============>.................] - ETA: 0s - loss: 0.4209 - acc: 0.8124
 7616/15235 [=============>................] - ETA: 0s - loss: 0.4213 - acc: 0.8112
 8384/15235 [===============>..............] - ETA: 0s - loss: 0.4202 - acc: 0.8119
 9152/15235 [=================>............] - ETA: 0s - loss: 0.4197 - acc: 0.8115
 9792/15235 [==================>...........] - ETA: 0s - loss: 0.4174 - acc: 0.8126
10432/15235 [===================>..........] - ETA: 0s - loss: 0.4180 - acc: 0.8122
11136/15235 [====================>.........] - ETA: 0s - loss: 0.4183 - acc: 0.8116
11840/15235 [======================>.......] - ETA: 0s - loss: 0.4183 - acc: 0.8117
12544/15235 [=======================>......] - ETA: 0s - loss: 0.4183 - acc: 0.8111
13248/15235 [=========================>....] - ETA: 0s - loss: 0.4167 - acc: 0.8116
13952/15235 [==========================>...] - ETA: 0s - loss: 0.4186 - acc: 0.8114
14656/15235 [===========================>..] - ETA: 0s - loss: 0.4168 - acc: 0.8125
15235/15235 [==============================] - 1s 76us/step - loss: 0.4176 - acc: 0.8123

Test accuracy: 82.37119801365611

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  724

choose_one :  887

F1score :  0.8321513002364066

AUC : 0.9000994097067028

Confusion Matrix
[[623 183]
 [101 704]]
True label 0
0.7729528535980149  
0.22704714640198512  
True label 1
0.12546583850931678  
0.8745341614906832  

Train_result {'loss': [0.41758963172851254], 'acc': [0.8122743682330031]}
Saved model to disk



7

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.3062 - acc: 0.9062
  640/15235 [>.............................] - ETA: 1s - loss: 0.4090 - acc: 0.8281
 1408/15235 [=>............................] - ETA: 1s - loss: 0.3987 - acc: 0.8260
 2048/15235 [===>..........................] - ETA: 1s - loss: 0.4023 - acc: 0.8257
 2688/15235 [====>.........................] - ETA: 1s - loss: 0.4122 - acc: 0.8151
 3328/15235 [=====>........................] - ETA: 0s - loss: 0.4160 - acc: 0.8104
 4032/15235 [======>.......................] - ETA: 0s - loss: 0.4162 - acc: 0.8080
 4736/15235 [========>.....................] - ETA: 0s - loss: 0.4174 - acc: 0.8098
 5440/15235 [=========>....................] - ETA: 0s - loss: 0.4156 - acc: 0.8110
 6144/15235 [===========>..................] - ETA: 0s - loss: 0.4157 - acc: 0.8117
 6784/15235 [============>.................] - ETA: 0s - loss: 0.4170 - acc: 0.8106
 7488/15235 [=============>................] - ETA: 0s - loss: 0.4176 - acc: 0.8094
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.4152 - acc: 0.8108
 8960/15235 [================>.............] - ETA: 0s - loss: 0.4124 - acc: 0.8125
 9664/15235 [==================>...........] - ETA: 0s - loss: 0.4140 - acc: 0.8114
10368/15235 [===================>..........] - ETA: 0s - loss: 0.4154 - acc: 0.8109
11072/15235 [====================>.........] - ETA: 0s - loss: 0.4159 - acc: 0.8102
11776/15235 [======================>.......] - ETA: 0s - loss: 0.4163 - acc: 0.8107
12480/15235 [=======================>......] - ETA: 0s - loss: 0.4179 - acc: 0.8101
13184/15235 [========================>.....] - ETA: 0s - loss: 0.4166 - acc: 0.8116
13824/15235 [==========================>...] - ETA: 0s - loss: 0.4179 - acc: 0.8113
14528/15235 [===========================>..] - ETA: 0s - loss: 0.4158 - acc: 0.8129
15168/15235 [============================>.] - ETA: 0s - loss: 0.4149 - acc: 0.8136
15235/15235 [==============================] - 1s 77us/step - loss: 0.4156 - acc: 0.8132

Test accuracy: 81.56424581005587

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  763

choose_one :  848

F1score :  0.8203266787658803

AUC : 0.9016221506403835

Confusion Matrix
[[636 170]
 [127 678]]
True label 0
0.7890818858560794  
0.2109181141439206  
True label 1
0.1577639751552795  
0.8422360248447205  

Train_result {'loss': [0.41564733155015493], 'acc': [0.8131933048939681]}
Saved model to disk



8

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.3557 - acc: 0.8125
  768/15235 [>.............................] - ETA: 1s - loss: 0.4223 - acc: 0.7995
 1536/15235 [==>...........................] - ETA: 0s - loss: 0.4197 - acc: 0.8034
 2432/15235 [===>..........................] - ETA: 0s - loss: 0.4092 - acc: 0.8121
 3200/15235 [=====>........................] - ETA: 0s - loss: 0.4100 - acc: 0.8125
 3904/15235 [======>.......................] - ETA: 0s - loss: 0.4150 - acc: 0.8102
 4480/15235 [=======>......................] - ETA: 0s - loss: 0.4150 - acc: 0.8098
 5120/15235 [=========>....................] - ETA: 0s - loss: 0.4109 - acc: 0.8115
 5824/15235 [==========>...................] - ETA: 0s - loss: 0.4125 - acc: 0.8113
 6528/15235 [===========>..................] - ETA: 0s - loss: 0.4113 - acc: 0.8137
 7232/15235 [=============>................] - ETA: 0s - loss: 0.4153 - acc: 0.8113
 7936/15235 [==============>...............] - ETA: 0s - loss: 0.4171 - acc: 0.8109
 8640/15235 [================>.............] - ETA: 0s - loss: 0.4193 - acc: 0.8096
 9344/15235 [=================>............] - ETA: 0s - loss: 0.4189 - acc: 0.8100
10048/15235 [==================>...........] - ETA: 0s - loss: 0.4192 - acc: 0.8103
10752/15235 [====================>.........] - ETA: 0s - loss: 0.4186 - acc: 0.8096
11456/15235 [=====================>........] - ETA: 0s - loss: 0.4171 - acc: 0.8109
12160/15235 [======================>.......] - ETA: 0s - loss: 0.4167 - acc: 0.8118
12864/15235 [========================>.....] - ETA: 0s - loss: 0.4163 - acc: 0.8115
13504/15235 [=========================>....] - ETA: 0s - loss: 0.4148 - acc: 0.8116
14208/15235 [==========================>...] - ETA: 0s - loss: 0.4176 - acc: 0.8102
14912/15235 [============================>.] - ETA: 0s - loss: 0.4172 - acc: 0.8104
15235/15235 [==============================] - 1s 75us/step - loss: 0.4175 - acc: 0.8101

Test accuracy: 82.49534450651768

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  690

choose_one :  921

F1score :  0.8366164542294323

AUC : 0.9026917682597907

Confusion Matrix
[[607 199]
 [ 83 722]]
True label 0
0.7531017369727047  
0.24689826302729528  
True label 1
0.1031055900621118  
0.8968944099378882  

Train_result {'loss': [0.4175281160614081], 'acc': [0.8101083032530099]}
Saved model to disk



9

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4224 - acc: 0.7812
  704/15235 [>.............................] - ETA: 1s - loss: 0.4432 - acc: 0.7855
 1408/15235 [=>............................] - ETA: 1s - loss: 0.4309 - acc: 0.7862
 2112/15235 [===>..........................] - ETA: 1s - loss: 0.4350 - acc: 0.7874
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.4373 - acc: 0.7880
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.4294 - acc: 0.7946
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.4274 - acc: 0.7971
 4928/15235 [========>.....................] - ETA: 0s - loss: 0.4241 - acc: 0.8003
 5632/15235 [==========>...................] - ETA: 0s - loss: 0.4227 - acc: 0.8029
 6336/15235 [===========>..................] - ETA: 0s - loss: 0.4176 - acc: 0.8060
 7104/15235 [============>.................] - ETA: 0s - loss: 0.4163 - acc: 0.8072
 7872/15235 [==============>...............] - ETA: 0s - loss: 0.4148 - acc: 0.8087
 8576/15235 [===============>..............] - ETA: 0s - loss: 0.4126 - acc: 0.8099
 9280/15235 [=================>............] - ETA: 0s - loss: 0.4106 - acc: 0.8108
 9984/15235 [==================>...........] - ETA: 0s - loss: 0.4089 - acc: 0.8120
10688/15235 [====================>.........] - ETA: 0s - loss: 0.4108 - acc: 0.8125
11392/15235 [=====================>........] - ETA: 0s - loss: 0.4135 - acc: 0.8099
12096/15235 [======================>.......] - ETA: 0s - loss: 0.4135 - acc: 0.8099
12800/15235 [========================>.....] - ETA: 0s - loss: 0.4123 - acc: 0.8113
13504/15235 [=========================>....] - ETA: 0s - loss: 0.4110 - acc: 0.8118
14144/15235 [==========================>...] - ETA: 0s - loss: 0.4098 - acc: 0.8128
14848/15235 [============================>.] - ETA: 0s - loss: 0.4106 - acc: 0.8128
15235/15235 [==============================] - 1s 76us/step - loss: 0.4107 - acc: 0.8130

Test accuracy: 81.19180633147114

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  689

choose_one :  922

F1score :  0.8245512449334106

AUC : 0.9001425643080622

Confusion Matrix
[[596 210]
 [ 93 712]]
True label 0
0.739454094292804  
0.26054590570719605  
True label 1
0.115527950310559  
0.884472049689441  

Train_result {'loss': [0.4107187633841868], 'acc': [0.8129963898916968]}
Saved model to disk



10

Epoch 1/1

   64/15235 [..............................] - ETA: 2s - loss: 0.4167 - acc: 0.8125
  704/15235 [>.............................] - ETA: 1s - loss: 0.4207 - acc: 0.8139
 1408/15235 [=>............................] - ETA: 1s - loss: 0.4118 - acc: 0.8153
 2112/15235 [===>..........................] - ETA: 1s - loss: 0.4075 - acc: 0.8149
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.4069 - acc: 0.8150
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.4050 - acc: 0.8168
 4096/15235 [=======>......................] - ETA: 0s - loss: 0.4117 - acc: 0.8157
 4800/15235 [========>.....................] - ETA: 0s - loss: 0.4077 - acc: 0.8169
 5504/15235 [=========>....................] - ETA: 0s - loss: 0.4081 - acc: 0.8181
 6208/15235 [===========>..................] - ETA: 0s - loss: 0.4110 - acc: 0.8180
 6912/15235 [============>.................] - ETA: 0s - loss: 0.4082 - acc: 0.8184
 7616/15235 [=============>................] - ETA: 0s - loss: 0.4106 - acc: 0.8160
 8320/15235 [===============>..............] - ETA: 0s - loss: 0.4117 - acc: 0.8160
 9024/15235 [================>.............] - ETA: 0s - loss: 0.4104 - acc: 0.8163
 9792/15235 [==================>...........] - ETA: 0s - loss: 0.4098 - acc: 0.8165
10560/15235 [===================>..........] - ETA: 0s - loss: 0.4084 - acc: 0.8168
11200/15235 [=====================>........] - ETA: 0s - loss: 0.4079 - acc: 0.8159
11840/15235 [======================>.......] - ETA: 0s - loss: 0.4090 - acc: 0.8154
12480/15235 [=======================>......] - ETA: 0s - loss: 0.4093 - acc: 0.8150
13120/15235 [========================>.....] - ETA: 0s - loss: 0.4084 - acc: 0.8156
13760/15235 [==========================>...] - ETA: 0s - loss: 0.4097 - acc: 0.8145
14464/15235 [===========================>..] - ETA: 0s - loss: 0.4110 - acc: 0.8133
15168/15235 [============================>.] - ETA: 0s - loss: 0.4130 - acc: 0.8126
15235/15235 [==============================] - 1s 76us/step - loss: 0.4128 - acc: 0.8125

Test accuracy: 81.8746120422098

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  682

choose_one :  929

F1score :  0.831603229527105

AUC : 0.9073755837430452

Confusion Matrix
[[598 208]
 [ 84 721]]
True label 0
0.7419354838709677  
0.25806451612903225  
True label 1
0.10434782608695652  
0.8956521739130435  

Train_result {'loss': [0.4128238504123484], 'acc': [0.8125369215621924]}
Saved model to disk



11

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4925 - acc: 0.7500
  640/15235 [>.............................] - ETA: 1s - loss: 0.4004 - acc: 0.8172
 1344/15235 [=>............................] - ETA: 1s - loss: 0.3963 - acc: 0.8147
 2048/15235 [===>..........................] - ETA: 1s - loss: 0.4008 - acc: 0.8145
 2752/15235 [====>.........................] - ETA: 0s - loss: 0.4096 - acc: 0.8129
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.4111 - acc: 0.8148
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.4079 - acc: 0.8183
 4800/15235 [========>.....................] - ETA: 0s - loss: 0.4054 - acc: 0.8206
 5376/15235 [=========>....................] - ETA: 0s - loss: 0.4002 - acc: 0.8231
 6080/15235 [==========>...................] - ETA: 0s - loss: 0.3976 - acc: 0.8242
 6784/15235 [============>.................] - ETA: 0s - loss: 0.4025 - acc: 0.8212
 7488/15235 [=============>................] - ETA: 0s - loss: 0.4038 - acc: 0.8213
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.4068 - acc: 0.8199
 8896/15235 [================>.............] - ETA: 0s - loss: 0.4074 - acc: 0.8206
 9600/15235 [=================>............] - ETA: 0s - loss: 0.4085 - acc: 0.8191
10304/15235 [===================>..........] - ETA: 0s - loss: 0.4070 - acc: 0.8197
10944/15235 [====================>.........] - ETA: 0s - loss: 0.4053 - acc: 0.8199
11648/15235 [=====================>........] - ETA: 0s - loss: 0.4067 - acc: 0.8181
12352/15235 [=======================>......] - ETA: 0s - loss: 0.4074 - acc: 0.8176
13056/15235 [========================>.....] - ETA: 0s - loss: 0.4060 - acc: 0.8186
13824/15235 [==========================>...] - ETA: 0s - loss: 0.4066 - acc: 0.8179
14528/15235 [===========================>..] - ETA: 0s - loss: 0.4054 - acc: 0.8187
15232/15235 [============================>.] - ETA: 0s - loss: 0.4073 - acc: 0.8177
15235/15235 [==============================] - 1s 76us/step - loss: 0.4072 - acc: 0.8177

Test accuracy: 82.24705152079453

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  698

choose_one :  913

F1score :  0.8335273573923166

AUC : 0.9063075073594008

Confusion Matrix
[[609 197]
 [ 89 716]]
True label 0
0.7555831265508685  
0.24441687344913152  
True label 1
0.11055900621118013  
0.8894409937888199  

Train_result {'loss': [0.40720143821206606], 'acc': [0.8177223498523137]}
Saved model to disk



12

Epoch 1/1

   64/15235 [..............................] - ETA: 2s - loss: 0.5531 - acc: 0.7656
  640/15235 [>.............................] - ETA: 1s - loss: 0.3814 - acc: 0.8344
 1344/15235 [=>............................] - ETA: 1s - loss: 0.3877 - acc: 0.8296
 2048/15235 [===>..........................] - ETA: 1s - loss: 0.4018 - acc: 0.8257
 2752/15235 [====>.........................] - ETA: 0s - loss: 0.4047 - acc: 0.8201
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.4133 - acc: 0.8189
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.4098 - acc: 0.8202
 4864/15235 [========>.....................] - ETA: 0s - loss: 0.4088 - acc: 0.8211
 5504/15235 [=========>....................] - ETA: 0s - loss: 0.4088 - acc: 0.8196
 6144/15235 [===========>..................] - ETA: 0s - loss: 0.4126 - acc: 0.8172
 6848/15235 [============>.................] - ETA: 0s - loss: 0.4121 - acc: 0.8175
 7552/15235 [=============>................] - ETA: 0s - loss: 0.4086 - acc: 0.8181
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.4109 - acc: 0.8163
 8960/15235 [================>.............] - ETA: 0s - loss: 0.4109 - acc: 0.8166
 9664/15235 [==================>...........] - ETA: 0s - loss: 0.4108 - acc: 0.8164
10368/15235 [===================>..........] - ETA: 0s - loss: 0.4089 - acc: 0.8178
11008/15235 [====================>.........] - ETA: 0s - loss: 0.4088 - acc: 0.8176
11648/15235 [=====================>........] - ETA: 0s - loss: 0.4080 - acc: 0.8184
12288/15235 [=======================>......] - ETA: 0s - loss: 0.4081 - acc: 0.8184
12928/15235 [========================>.....] - ETA: 0s - loss: 0.4081 - acc: 0.8190
13632/15235 [=========================>....] - ETA: 0s - loss: 0.4075 - acc: 0.8194
14272/15235 [===========================>..] - ETA: 0s - loss: 0.4092 - acc: 0.8185
14912/15235 [============================>.] - ETA: 0s - loss: 0.4073 - acc: 0.8195
15235/15235 [==============================] - 1s 78us/step - loss: 0.4075 - acc: 0.8190

Test accuracy: 82.24705152079453

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  734

choose_one :  877

F1score :  0.8299643281807373

AUC : 0.9042746173882219

Confusion Matrix
[[627 179]
 [107 698]]
True label 0
0.7779156327543424  
0.22208436724565755  
True label 1
0.13291925465838508  
0.867080745341615  

Train_result {'loss': [0.40746513020588326], 'acc': [0.8189694781752543]}
Saved model to disk



13

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2949 - acc: 0.8750
  640/15235 [>.............................] - ETA: 1s - loss: 0.4266 - acc: 0.7984
 1344/15235 [=>............................] - ETA: 1s - loss: 0.4340 - acc: 0.7991
 2048/15235 [===>..........................] - ETA: 1s - loss: 0.4243 - acc: 0.8101
 2752/15235 [====>.........................] - ETA: 0s - loss: 0.4157 - acc: 0.8165
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.4141 - acc: 0.8151
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.4060 - acc: 0.8187
 4800/15235 [========>.....................] - ETA: 0s - loss: 0.4085 - acc: 0.8187
 5440/15235 [=========>....................] - ETA: 0s - loss: 0.4063 - acc: 0.8191
 6144/15235 [===========>..................] - ETA: 0s - loss: 0.3998 - acc: 0.8226
 6848/15235 [============>.................] - ETA: 0s - loss: 0.4027 - acc: 0.8211
 7552/15235 [=============>................] - ETA: 0s - loss: 0.3972 - acc: 0.8245
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.3946 - acc: 0.8265
 8896/15235 [================>.............] - ETA: 0s - loss: 0.3961 - acc: 0.8259
 9536/15235 [=================>............] - ETA: 0s - loss: 0.3965 - acc: 0.8256
10112/15235 [==================>...........] - ETA: 0s - loss: 0.3968 - acc: 0.8259
10752/15235 [====================>.........] - ETA: 0s - loss: 0.3944 - acc: 0.8266
11456/15235 [=====================>........] - ETA: 0s - loss: 0.3927 - acc: 0.8277
12096/15235 [======================>.......] - ETA: 0s - loss: 0.3926 - acc: 0.8276
12736/15235 [========================>.....] - ETA: 0s - loss: 0.3920 - acc: 0.8277
13376/15235 [=========================>....] - ETA: 0s - loss: 0.3945 - acc: 0.8255
14016/15235 [==========================>...] - ETA: 0s - loss: 0.3966 - acc: 0.8239
14656/15235 [===========================>..] - ETA: 0s - loss: 0.3968 - acc: 0.8237
15235/15235 [==============================] - 1s 79us/step - loss: 0.3966 - acc: 0.8240

Test accuracy: 82.43327126008691

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  781

choose_one :  830

F1score :  0.8269113149847096

AUC : 0.9045921119553659

Confusion Matrix
[[652 154]
 [129 676]]
True label 0
0.8089330024813896  
0.19106699751861042  
True label 1
0.16024844720496895  
0.8397515527950311  

Train_result {'loss': [0.39655963689881074], 'acc': [0.8239579914670168]}
Saved model to disk



14

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4350 - acc: 0.8281
  704/15235 [>.............................] - ETA: 1s - loss: 0.4140 - acc: 0.8125
 1408/15235 [=>............................] - ETA: 1s - loss: 0.4128 - acc: 0.8161
 2112/15235 [===>..........................] - ETA: 0s - loss: 0.4140 - acc: 0.8172
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.4133 - acc: 0.8178
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.4070 - acc: 0.8227
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.3999 - acc: 0.8272
 4864/15235 [========>.....................] - ETA: 0s - loss: 0.3994 - acc: 0.8250
 5568/15235 [=========>....................] - ETA: 0s - loss: 0.3967 - acc: 0.8254
 6272/15235 [===========>..................] - ETA: 0s - loss: 0.3964 - acc: 0.8249
 6912/15235 [============>.................] - ETA: 0s - loss: 0.3983 - acc: 0.8235
 7552/15235 [=============>................] - ETA: 0s - loss: 0.4006 - acc: 0.8215
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.4000 - acc: 0.8215
 8896/15235 [================>.............] - ETA: 0s - loss: 0.3987 - acc: 0.8222
 9536/15235 [=================>............] - ETA: 0s - loss: 0.3984 - acc: 0.8230
10176/15235 [===================>..........] - ETA: 0s - loss: 0.3983 - acc: 0.8232
10816/15235 [====================>.........] - ETA: 0s - loss: 0.4003 - acc: 0.8220
11456/15235 [=====================>........] - ETA: 0s - loss: 0.3979 - acc: 0.8238
12096/15235 [======================>.......] - ETA: 0s - loss: 0.3981 - acc: 0.8239
12800/15235 [========================>.....] - ETA: 0s - loss: 0.4003 - acc: 0.8227
13504/15235 [=========================>....] - ETA: 0s - loss: 0.3998 - acc: 0.8229
14208/15235 [==========================>...] - ETA: 0s - loss: 0.4011 - acc: 0.8226
14976/15235 [============================>.] - ETA: 0s - loss: 0.4008 - acc: 0.8232
15235/15235 [==============================] - 1s 78us/step - loss: 0.4018 - acc: 0.8225

Test accuracy: 82.86778398510242

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  744

choose_one :  867

F1score :  0.8349282296650719

AUC : 0.9104287717892205

Confusion Matrix
[[637 169]
 [107 698]]
True label 0
0.7903225806451613  
0.20967741935483872  
True label 1
0.13291925465838508  
0.867080745341615  

Train_result {'loss': [0.4017932508787563], 'acc': [0.8225139481496294]}
Saved model to disk



15

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4621 - acc: 0.7812
  768/15235 [>.............................] - ETA: 1s - loss: 0.4177 - acc: 0.8073
 1472/15235 [=>............................] - ETA: 1s - loss: 0.3988 - acc: 0.8288
 2176/15235 [===>..........................] - ETA: 0s - loss: 0.3948 - acc: 0.8304
 2816/15235 [====>.........................] - ETA: 0s - loss: 0.3982 - acc: 0.8263
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.3981 - acc: 0.8247
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.3971 - acc: 0.8234
 4864/15235 [========>.....................] - ETA: 0s - loss: 0.4024 - acc: 0.8218
 5504/15235 [=========>....................] - ETA: 0s - loss: 0.4023 - acc: 0.8199
 6144/15235 [===========>..................] - ETA: 0s - loss: 0.3983 - acc: 0.8211
 6784/15235 [============>.................] - ETA: 0s - loss: 0.3973 - acc: 0.8228
 7488/15235 [=============>................] - ETA: 0s - loss: 0.3962 - acc: 0.8240
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.3982 - acc: 0.8229
 8896/15235 [================>.............] - ETA: 0s - loss: 0.3949 - acc: 0.8248
 9600/15235 [=================>............] - ETA: 0s - loss: 0.3939 - acc: 0.8248
10240/15235 [===================>..........] - ETA: 0s - loss: 0.3948 - acc: 0.8245
10944/15235 [====================>.........] - ETA: 0s - loss: 0.3954 - acc: 0.8243
11648/15235 [=====================>........] - ETA: 0s - loss: 0.3948 - acc: 0.8250
12352/15235 [=======================>......] - ETA: 0s - loss: 0.3969 - acc: 0.8240
13056/15235 [========================>.....] - ETA: 0s - loss: 0.3965 - acc: 0.8238
13760/15235 [==========================>...] - ETA: 0s - loss: 0.3971 - acc: 0.8233
14464/15235 [===========================>..] - ETA: 0s - loss: 0.3964 - acc: 0.8243
15168/15235 [============================>.] - ETA: 0s - loss: 0.3973 - acc: 0.8236
15235/15235 [==============================] - 1s 77us/step - loss: 0.3980 - acc: 0.8235

Test accuracy: 82.55741775294848

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  695

choose_one :  916

F1score :  0.8367228355607205

AUC : 0.9101790915956414

Confusion Matrix
[[610 196]
 [ 85 720]]
True label 0
0.7568238213399504  
0.24317617866004962  
True label 1
0.10559006211180125  
0.8944099378881988  

Train_result {'loss': [0.39798098858415315], 'acc': [0.8234985231375123]}
Saved model to disk



[[79.95034140285537, 1], [80.26070763500931, 2], [80.88144009931719, 3], [81.12973308504034, 4], [81.62631905648665, 5], [82.37119801365611, 6], [81.56424581005587, 7], [82.49534450651768, 8], [81.19180633147114, 9], [81.8746120422098, 10], [82.24705152079453, 11], [82.24705152079453, 12], [82.43327126008691, 13], [82.86778398510242, 14], [82.55741775294848, 15]]
max accuracy :  [82.86778398510242, 14]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-01 22:29:58.518592: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-01 22:29:58.528838: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-01 22:29:58.531035: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7432bc0 executing computations on platform Host. Devices:
2019-08-01 22:29:58.531075: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-CAST_s
all data

Sentence length Average : 42

Under 10 : 7428
Over 10, Under 200 : 50330
Over 200, Under 400 : 889
Over 400 : 83

guava-CAST_s
updated_train_data

Sentence length Average : 46

Under 10 : 0
Over 10, Under 200 : 44707
Over 200, Under 400 : 829
Over 400 : 0


Test_zero:  3994
Train_zero:  35388
zero:  39382
Test_one:  1098
Train_one:  10148
one:  11246

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 440s - loss: 0.2582 - acc: 0.8948

Test accuracy: 92.76285844333182

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1100

choose_one :  1097

F1score :  0.9275626423690205

AUC : 0.981664072819967

Confusion Matrix
[[1020   79]
 [  80 1018]]
True label 0
0.9281164695177434  
0.0718835304822566  
True label 1
0.07285974499089254  
0.9271402550091075  

Train_result {'loss': [0.25819321289484554], 'acc': [0.894812041188353]}
2

Epoch 1/1
 - 472s - loss: 0.1773 - acc: 0.9290

Test accuracy: 93.53664087391898

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1119

choose_one :  1078

F1score :  0.9347426470588235

AUC : 0.9855540141642262

Confusion Matrix
[[1038   61]
 [  81 1017]]
True label 0
0.9444949954504095  
0.055505004549590536  
True label 1
0.07377049180327869  
0.9262295081967213  

Train_result {'loss': [0.17730021321581768], 'acc': [0.9289550179829531]}
3

Epoch 1/1
 - 473s - loss: 0.1408 - acc: 0.9443

Test accuracy: 94.03732362312243

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1086

choose_one :  1111

F1score :  0.9406971480307832

AUC : 0.9860379778934649

Confusion Matrix
[[1027   72]
 [  59 1039]]
True label 0
0.9344858962693358  
0.06551410373066424  
True label 1
0.05373406193078324  
0.9462659380692168  

Train_result {'loss': [0.14084277000770487], 'acc': [0.9443267477952407]}
4

Epoch 1/1
 - 476s - loss: 0.1174 - acc: 0.9546

Test accuracy: 94.2649066909422

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1181

choose_one :  1016

F1score :  0.9403973509933775

AUC : 0.9893743442871563

Confusion Matrix
[[1077   22]
 [ 104  994]]
True label 0
0.9799818016378526  
0.020018198362147407  
True label 1
0.0947176684881603  
0.9052823315118397  

Train_result {'loss': [0.11741814975662877], 'acc': [0.9546238360407553]}
5

Epoch 1/1
 - 477s - loss: 0.0939 - acc: 0.9634

Test accuracy: 95.35730541647702

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1065

choose_one :  1132

F1score :  0.9542600896860988

AUC : 0.992491932556671

Confusion Matrix
[[1031   68]
 [  34 1064]]
True label 0
0.9381255686988171  
0.06187443130118289  
True label 1
0.030965391621129327  
0.9690346083788707  

Train_result {'loss': [0.09389880678420123], 'acc': [0.9634428733310342]}
6

Epoch 1/1
 - 475s - loss: 0.0790 - acc: 0.9709

Test accuracy: 96.08557123350022

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1057

choose_one :  1140

F1score :  0.9615728328865057

AUC : 0.9935617907320947

Confusion Matrix
[[1035   64]
 [  22 1076]]
True label 0
0.9417652411282984  
0.05823475887170155  
True label 1
0.020036429872495445  
0.9799635701275046  

Train_result {'loss': [0.07898411539956288], 'acc': [0.970882396413263]}
7

Epoch 1/1
 - 476s - loss: 0.0665 - acc: 0.9752

Test accuracy: 96.54073736913973

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1093

choose_one :  1104

F1score :  0.9654859218891916

AUC : 0.9945885562466954

Confusion Matrix
[[1058   41]
 [  35 1063]]
True label 0
0.9626933575978162  
0.0373066424021838  
True label 1
0.031876138433515486  
0.9681238615664846  

Train_result {'loss': [0.06648233903434034], 'acc': [0.9751687441493817]}
8

Epoch 1/1
 - 475s - loss: 0.0613 - acc: 0.9769

Test accuracy: 96.49522075557579

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1062

choose_one :  1135

F1score :  0.9655172413793105

AUC : 0.9934047511315967

Confusion Matrix
[[1042   57]
 [  20 1078]]
True label 0
0.9481346678798908  
0.051865332120109194  
True label 1
0.018214936247723135  
0.9817850637522769  

Train_result {'loss': [0.06133335943068545], 'acc': [0.9768931369167857]}
9

Epoch 1/1
 - 475s - loss: 0.0519 - acc: 0.9797

Test accuracy: 97.17796995903505

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1119

choose_one :  1078

F1score :  0.9715073529411765

AUC : 0.9956874190976729

Confusion Matrix
[[1078   21]
 [  41 1057]]
True label 0
0.9808917197452229  
0.01910828025477707  
True label 1
0.037340619307832425  
0.9626593806921676  

Train_result {'loss': [0.05192803717657915], 'acc': [0.9796521653446322]}
10

Epoch 1/1
 - 476s - loss: 0.0493 - acc: 0.9818

Test accuracy: 97.13245334547109

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1102

choose_one :  1095

F1score :  0.9712722298221614

AUC : 0.9934117951242313

Confusion Matrix
[[1069   30]
 [  33 1065]]
True label 0
0.9727024567788899  
0.0272975432211101  
True label 1
0.030054644808743168  
0.9699453551912568  

Train_result {'loss': [0.049312810496848894], 'acc': [0.9817707050303001]}
11

Epoch 1/1
 - 478s - loss: 0.0445 - acc: 0.9834

Test accuracy: 97.223486572599

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1088

choose_one :  1109

F1score :  0.9723606705935659

AUC : 0.9955336943172384

Confusion Matrix
[[1063   36]
 [  25 1073]]
True label 0
0.9672429481346679  
0.03275705186533212  
True label 1
0.022768670309653915  
0.9772313296903461  

Train_result {'loss': [0.044452499684519406], 'acc': [0.9834458294329211]}
12

Epoch 1/1
 - 475s - loss: 0.0401 - acc: 0.9857

Test accuracy: 97.3145197997269

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1072

choose_one :  1125

F1score :  0.9734592892487629

AUC : 0.9949672744389253

Confusion Matrix
[[1056   43]
 [  16 1082]]
True label 0
0.9608735213830755  
0.039126478616924476  
True label 1
0.014571948998178506  
0.9854280510018215  

Train_result {'loss': [0.04006776623558034], 'acc': [0.9856629058481549]}
13

Epoch 1/1
 - 476s - loss: 0.0427 - acc: 0.9854

Test accuracy: 97.17796995903505

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1061

choose_one :  1136

F1score :  0.97224709042077

AUC : 0.9949714179640043

Confusion Matrix
[[1049   50]
 [  12 1086]]
True label 0
0.9545040946314831  
0.04549590536851683  
True label 1
0.01092896174863388  
0.9890710382513661  

Train_result {'loss': [0.042715090621876145], 'acc': [0.985367295659457]}
14

Epoch 1/1
 - 478s - loss: 0.0383 - acc: 0.9867

Test accuracy: 97.17796995903505

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1097

choose_one :  1100

F1score :  0.9717925386715196

AUC : 0.9965148810559692

Confusion Matrix
[[1067   32]
 [  30 1068]]
True label 0
0.9708826205641492  
0.029117379435850774  
True label 1
0.0273224043715847  
0.9726775956284153  

Train_result {'loss': [0.03833114172527054], 'acc': [0.9867468098733803]}
15

Epoch 1/1
 - 468s - loss: 0.0369 - acc: 0.9872

Test accuracy: 97.54210286754666

data size :  22494

zero :  11248

one :  11246

train_zero :  10149

train_one :  10148

test_zero :  1099

test_one :  1098

choose_zero :  1109

choose_one :  1088

F1score :  0.9752973467520585

AUC : 0.9952871545750318

Confusion Matrix
[[1077   22]
 [  32 1066]]
True label 0
0.9799818016378526  
0.020018198362147407  
True label 1
0.029143897996357013  
0.970856102003643  

Train_result {'loss': [0.03694988485553591], 'acc': [0.9871902251593637]}
Saved model to disk




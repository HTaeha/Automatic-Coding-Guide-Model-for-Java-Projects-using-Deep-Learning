Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_balanced_auto_logging.py:389: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-17 21:14:37.921476: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-17 21:14:37.932343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-17 21:14:37.934600: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x725c530 executing computations on platform Host. Devices:
2019-08-17 21:14:37.934641: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 30897
Over 200, Under 400 : 3419
Over 400 : 0


Test_zero:  2957
Train_zero:  26756
zero:  29713
Test_one:  799
Train_one:  7560
one:  8359

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 200)       0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 1, 200)       0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

   64/15121 [..............................] - ETA: 5:54 - loss: 0.7681 - acc: 0.5156
  640/15121 [>.............................] - ETA: 35s - loss: 0.6622 - acc: 0.6328 
 1280/15121 [=>............................] - ETA: 17s - loss: 0.6198 - acc: 0.6734
 1920/15121 [==>...........................] - ETA: 11s - loss: 0.6010 - acc: 0.6906
 2560/15121 [====>.........................] - ETA: 8s - loss: 0.5802 - acc: 0.7027 
 3264/15121 [=====>........................] - ETA: 6s - loss: 0.5774 - acc: 0.7068
 3968/15121 [======>.......................] - ETA: 5s - loss: 0.5692 - acc: 0.7112
 4672/15121 [========>.....................] - ETA: 4s - loss: 0.5644 - acc: 0.7147
 5376/15121 [=========>....................] - ETA: 3s - loss: 0.5600 - acc: 0.7158
 6016/15121 [==========>...................] - ETA: 2s - loss: 0.5569 - acc: 0.7192
 6656/15121 [============>.................] - ETA: 2s - loss: 0.5512 - acc: 0.7224
 7360/15121 [=============>................] - ETA: 2s - loss: 0.5483 - acc: 0.7251
 8064/15121 [==============>...............] - ETA: 1s - loss: 0.5457 - acc: 0.7262
 8768/15121 [================>.............] - ETA: 1s - loss: 0.5390 - acc: 0.7302
 9472/15121 [=================>............] - ETA: 1s - loss: 0.5361 - acc: 0.7334
10176/15121 [===================>..........] - ETA: 1s - loss: 0.5329 - acc: 0.7351
10880/15121 [====================>.........] - ETA: 0s - loss: 0.5310 - acc: 0.7374
11584/15121 [=====================>........] - ETA: 0s - loss: 0.5308 - acc: 0.7386
12224/15121 [=======================>......] - ETA: 0s - loss: 0.5322 - acc: 0.7371
12928/15121 [========================>.....] - ETA: 0s - loss: 0.5292 - acc: 0.7396
13632/15121 [==========================>...] - ETA: 0s - loss: 0.5292 - acc: 0.7399
14336/15121 [===========================>..] - ETA: 0s - loss: 0.5265 - acc: 0.7418
15040/15121 [============================>.] - ETA: 0s - loss: 0.5223 - acc: 0.7446
15121/15121 [==============================] - 3s 177us/step - loss: 0.5219 - acc: 0.7449

Test accuracy: 78.67417135709819

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  611

choose_one :  988

F1score :  0.8091773922775601

AUC : 0.8602917709637047

Confusion Matrix
[[535 265]
 [ 76 723]]
True label 0
0.66875  
0.33125  
True label 1
0.0951188986232791  
0.904881101376721  

Train_result {'loss': [0.5218514185833651], 'acc': [0.7448581443065674]}
Saved model to disk



2

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.6175 - acc: 0.7188
  704/15121 [>.............................] - ETA: 1s - loss: 0.5216 - acc: 0.7472
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4907 - acc: 0.7656
 1984/15121 [==>...........................] - ETA: 1s - loss: 0.4907 - acc: 0.7651
 2624/15121 [====>.........................] - ETA: 1s - loss: 0.4930 - acc: 0.7668
 3264/15121 [=====>........................] - ETA: 0s - loss: 0.4925 - acc: 0.7616
 3904/15121 [======>.......................] - ETA: 0s - loss: 0.4959 - acc: 0.7610
 4544/15121 [========>.....................] - ETA: 0s - loss: 0.4961 - acc: 0.7606
 5248/15121 [=========>....................] - ETA: 0s - loss: 0.4936 - acc: 0.7603
 5888/15121 [==========>...................] - ETA: 0s - loss: 0.4915 - acc: 0.7631
 6528/15121 [===========>..................] - ETA: 0s - loss: 0.4919 - acc: 0.7616
 7168/15121 [=============>................] - ETA: 0s - loss: 0.4894 - acc: 0.7640
 7808/15121 [==============>...............] - ETA: 0s - loss: 0.4898 - acc: 0.7633
 8448/15121 [===============>..............] - ETA: 0s - loss: 0.4882 - acc: 0.7643
 9152/15121 [=================>............] - ETA: 0s - loss: 0.4925 - acc: 0.7606
 9856/15121 [==================>...........] - ETA: 0s - loss: 0.4915 - acc: 0.7620
10560/15121 [===================>..........] - ETA: 0s - loss: 0.4920 - acc: 0.7620
11264/15121 [=====================>........] - ETA: 0s - loss: 0.4910 - acc: 0.7635
11904/15121 [======================>.......] - ETA: 0s - loss: 0.4919 - acc: 0.7625
12608/15121 [========================>.....] - ETA: 0s - loss: 0.4905 - acc: 0.7628
13312/15121 [=========================>....] - ETA: 0s - loss: 0.4902 - acc: 0.7638
14016/15121 [==========================>...] - ETA: 0s - loss: 0.4896 - acc: 0.7642
14720/15121 [============================>.] - ETA: 0s - loss: 0.4898 - acc: 0.7655
15121/15121 [==============================] - 1s 80us/step - loss: 0.4902 - acc: 0.7656

Test accuracy: 78.67417135709819

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  655

choose_one :  944

F1score :  0.804360298336202

AUC : 0.8615245619524406

Confusion Matrix
[[557 243]
 [ 98 701]]
True label 0
0.69625  
0.30375  
True label 1
0.12265331664580725  
0.8773466833541927  

Train_result {'loss': [0.4902040727313853], 'acc': [0.7655578334884474]}
Saved model to disk



3

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4004 - acc: 0.8281
  768/15121 [>.............................] - ETA: 1s - loss: 0.4604 - acc: 0.7826
 1472/15121 [=>............................] - ETA: 1s - loss: 0.4861 - acc: 0.7704
 2112/15121 [===>..........................] - ETA: 0s - loss: 0.4877 - acc: 0.7675
 2752/15121 [====>.........................] - ETA: 0s - loss: 0.4779 - acc: 0.7733
 3392/15121 [=====>........................] - ETA: 0s - loss: 0.4785 - acc: 0.7706
 4032/15121 [======>.......................] - ETA: 0s - loss: 0.4785 - acc: 0.7684
 4736/15121 [========>.....................] - ETA: 0s - loss: 0.4793 - acc: 0.7690
 5504/15121 [=========>....................] - ETA: 0s - loss: 0.4796 - acc: 0.7685
 6208/15121 [===========>..................] - ETA: 0s - loss: 0.4749 - acc: 0.7726
 6912/15121 [============>.................] - ETA: 0s - loss: 0.4739 - acc: 0.7737
 7616/15121 [==============>...............] - ETA: 0s - loss: 0.4717 - acc: 0.7749
 8256/15121 [===============>..............] - ETA: 0s - loss: 0.4722 - acc: 0.7748
 8896/15121 [================>.............] - ETA: 0s - loss: 0.4745 - acc: 0.7736
 9536/15121 [=================>............] - ETA: 0s - loss: 0.4747 - acc: 0.7722
10240/15121 [===================>..........] - ETA: 0s - loss: 0.4742 - acc: 0.7727
10944/15121 [====================>.........] - ETA: 0s - loss: 0.4755 - acc: 0.7734
11584/15121 [=====================>........] - ETA: 0s - loss: 0.4766 - acc: 0.7731
12288/15121 [=======================>......] - ETA: 0s - loss: 0.4769 - acc: 0.7725
12928/15121 [========================>.....] - ETA: 0s - loss: 0.4780 - acc: 0.7717
13632/15121 [==========================>...] - ETA: 0s - loss: 0.4792 - acc: 0.7716
14272/15121 [===========================>..] - ETA: 0s - loss: 0.4805 - acc: 0.7705
14912/15121 [============================>.] - ETA: 0s - loss: 0.4819 - acc: 0.7695
15121/15121 [==============================] - 1s 78us/step - loss: 0.4819 - acc: 0.7696

Test accuracy: 79.1119449656035

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  686

choose_one :  913

F1score :  0.8049065420560747

AUC : 0.8775219023779725

Confusion Matrix
[[576 224]
 [110 689]]
True label 0
0.72  
0.28  
True label 1
0.1376720901126408  
0.8623279098873592  

Train_result {'loss': [0.481927271189572], 'acc': [0.7695919582156481]}
Saved model to disk



4

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.5398 - acc: 0.7500
  704/15121 [>.............................] - ETA: 1s - loss: 0.5082 - acc: 0.7543
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4875 - acc: 0.7671
 2048/15121 [===>..........................] - ETA: 1s - loss: 0.4781 - acc: 0.7744
 2688/15121 [====>.........................] - ETA: 1s - loss: 0.4831 - acc: 0.7701
 3264/15121 [=====>........................] - ETA: 0s - loss: 0.4853 - acc: 0.7718
 3904/15121 [======>.......................] - ETA: 0s - loss: 0.4765 - acc: 0.7779
 4544/15121 [========>.....................] - ETA: 0s - loss: 0.4776 - acc: 0.7753
 5184/15121 [=========>....................] - ETA: 0s - loss: 0.4780 - acc: 0.7751
 5824/15121 [==========>...................] - ETA: 0s - loss: 0.4767 - acc: 0.7749
 6464/15121 [===========>..................] - ETA: 0s - loss: 0.4728 - acc: 0.7758
 7104/15121 [=============>................] - ETA: 0s - loss: 0.4740 - acc: 0.7753
 7744/15121 [==============>...............] - ETA: 0s - loss: 0.4781 - acc: 0.7727
 8448/15121 [===============>..............] - ETA: 0s - loss: 0.4804 - acc: 0.7707
 9152/15121 [=================>............] - ETA: 0s - loss: 0.4778 - acc: 0.7733
 9856/15121 [==================>...........] - ETA: 0s - loss: 0.4749 - acc: 0.7763
10560/15121 [===================>..........] - ETA: 0s - loss: 0.4761 - acc: 0.7763
11200/15121 [=====================>........] - ETA: 0s - loss: 0.4740 - acc: 0.7778
11840/15121 [======================>.......] - ETA: 0s - loss: 0.4748 - acc: 0.7778
12480/15121 [=======================>......] - ETA: 0s - loss: 0.4735 - acc: 0.7782
13120/15121 [=========================>....] - ETA: 0s - loss: 0.4728 - acc: 0.7790
13824/15121 [==========================>...] - ETA: 0s - loss: 0.4720 - acc: 0.7795
14464/15121 [===========================>..] - ETA: 0s - loss: 0.4716 - acc: 0.7800
15121/15121 [==============================] - 1s 80us/step - loss: 0.4725 - acc: 0.7792

Test accuracy: 79.42464040025015

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  707

choose_one :  892

F1score :  0.8054405677114134

AUC : 0.877764392991239

Confusion Matrix
[[589 211]
 [118 681]]
True label 0
0.73625  
0.26375  
True label 1
0.1476846057571965  
0.8523153942428036  

Train_result {'loss': [0.472501610881413], 'acc': [0.779247404276146]}
Saved model to disk



5

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4315 - acc: 0.7656
  576/15121 [>.............................] - ETA: 1s - loss: 0.4493 - acc: 0.7760
 1280/15121 [=>............................] - ETA: 1s - loss: 0.4606 - acc: 0.7727
 1920/15121 [==>...........................] - ETA: 1s - loss: 0.4607 - acc: 0.7734
 2560/15121 [====>.........................] - ETA: 1s - loss: 0.4573 - acc: 0.7785
 3200/15121 [=====>........................] - ETA: 1s - loss: 0.4591 - acc: 0.7803
 3904/15121 [======>.......................] - ETA: 0s - loss: 0.4528 - acc: 0.7846
 4544/15121 [========>.....................] - ETA: 0s - loss: 0.4558 - acc: 0.7841
 5248/15121 [=========>....................] - ETA: 0s - loss: 0.4560 - acc: 0.7843
 5952/15121 [==========>...................] - ETA: 0s - loss: 0.4597 - acc: 0.7806
 6592/15121 [============>.................] - ETA: 0s - loss: 0.4592 - acc: 0.7811
 7232/15121 [=============>................] - ETA: 0s - loss: 0.4578 - acc: 0.7824
 7936/15121 [==============>...............] - ETA: 0s - loss: 0.4607 - acc: 0.7810
 8640/15121 [================>.............] - ETA: 0s - loss: 0.4645 - acc: 0.7785
 9344/15121 [=================>............] - ETA: 0s - loss: 0.4660 - acc: 0.7773
10048/15121 [==================>...........] - ETA: 0s - loss: 0.4672 - acc: 0.7753
10752/15121 [====================>.........] - ETA: 0s - loss: 0.4679 - acc: 0.7749
11392/15121 [=====================>........] - ETA: 0s - loss: 0.4684 - acc: 0.7760
12032/15121 [======================>.......] - ETA: 0s - loss: 0.4694 - acc: 0.7764
12672/15121 [========================>.....] - ETA: 0s - loss: 0.4677 - acc: 0.7779
13312/15121 [=========================>....] - ETA: 0s - loss: 0.4686 - acc: 0.7767
13952/15121 [==========================>...] - ETA: 0s - loss: 0.4682 - acc: 0.7777
14656/15121 [============================>.] - ETA: 0s - loss: 0.4672 - acc: 0.7795
15121/15121 [==============================] - 1s 80us/step - loss: 0.4675 - acc: 0.7794

Test accuracy: 78.54909318323952

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  727

choose_one :  872

F1score :  0.7947336923997605

AUC : 0.876017678347935

Confusion Matrix
[[592 208]
 [135 664]]
True label 0
0.74  
0.26  
True label 1
0.16896120150187735  
0.8310387984981227  

Train_result {'loss': [0.4675060531645412], 'acc': [0.7794458038726029]}
Saved model to disk



6

Epoch 1/1

   64/15121 [..............................] - ETA: 3s - loss: 0.4033 - acc: 0.8125
  704/15121 [>.............................] - ETA: 1s - loss: 0.4679 - acc: 0.7599
 1408/15121 [=>............................] - ETA: 1s - loss: 0.4514 - acc: 0.7777
 2112/15121 [===>..........................] - ETA: 1s - loss: 0.4567 - acc: 0.7775
 2816/15121 [====>.........................] - ETA: 0s - loss: 0.4659 - acc: 0.7749
 3520/15121 [=====>........................] - ETA: 0s - loss: 0.4621 - acc: 0.7756
 4224/15121 [=======>......................] - ETA: 0s - loss: 0.4621 - acc: 0.7777
 4928/15121 [========>.....................] - ETA: 0s - loss: 0.4555 - acc: 0.7847
 5568/15121 [==========>...................] - ETA: 0s - loss: 0.4553 - acc: 0.7854
 6272/15121 [===========>..................] - ETA: 0s - loss: 0.4544 - acc: 0.7849
 6912/15121 [============>.................] - ETA: 0s - loss: 0.4531 - acc: 0.7869
 7616/15121 [==============>...............] - ETA: 0s - loss: 0.4525 - acc: 0.7877
 8320/15121 [===============>..............] - ETA: 0s - loss: 0.4521 - acc: 0.7882
 8960/15121 [================>.............] - ETA: 0s - loss: 0.4529 - acc: 0.7876
 9664/15121 [==================>...........] - ETA: 0s - loss: 0.4519 - acc: 0.7884
10368/15121 [===================>..........] - ETA: 0s - loss: 0.4546 - acc: 0.7861
11072/15121 [====================>.........] - ETA: 0s - loss: 0.4548 - acc: 0.7862
11712/15121 [======================>.......] - ETA: 0s - loss: 0.4564 - acc: 0.7854
12352/15121 [=======================>......] - ETA: 0s - loss: 0.4587 - acc: 0.7854
12992/15121 [========================>.....] - ETA: 0s - loss: 0.4590 - acc: 0.7848
13632/15121 [==========================>...] - ETA: 0s - loss: 0.4583 - acc: 0.7854
14336/15121 [===========================>..] - ETA: 0s - loss: 0.4603 - acc: 0.7840
15040/15121 [============================>.] - ETA: 0s - loss: 0.4614 - acc: 0.7832
15121/15121 [==============================] - 1s 78us/step - loss: 0.4615 - acc: 0.7831

Test accuracy: 79.2995622263915

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  677

choose_one :  922

F1score :  0.8076699593259734

AUC : 0.8752401439299125

Confusion Matrix
[[573 227]
 [104 695]]
True label 0
0.71625  
0.28375  
True label 1
0.13016270337922403  
0.869837296620776  

Train_result {'loss': [0.4614503116714411], 'acc': [0.7831492626227902]}
Saved model to disk



7

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.3885 - acc: 0.8125
  576/15121 [>.............................] - ETA: 1s - loss: 0.4719 - acc: 0.7830
 1216/15121 [=>............................] - ETA: 1s - loss: 0.4677 - acc: 0.7829
 1856/15121 [==>...........................] - ETA: 1s - loss: 0.4518 - acc: 0.7909
 2496/15121 [===>..........................] - ETA: 1s - loss: 0.4475 - acc: 0.7949
 3136/15121 [=====>........................] - ETA: 1s - loss: 0.4500 - acc: 0.7953
 3776/15121 [======>.......................] - ETA: 0s - loss: 0.4452 - acc: 0.7982
 4416/15121 [=======>......................] - ETA: 0s - loss: 0.4420 - acc: 0.7996
 5056/15121 [=========>....................] - ETA: 0s - loss: 0.4398 - acc: 0.8014
 5696/15121 [==========>...................] - ETA: 0s - loss: 0.4427 - acc: 0.8000
 6400/15121 [===========>..................] - ETA: 0s - loss: 0.4405 - acc: 0.8014
 7104/15121 [=============>................] - ETA: 0s - loss: 0.4444 - acc: 0.7986
 7808/15121 [==============>...............] - ETA: 0s - loss: 0.4454 - acc: 0.7997
 8448/15121 [===============>..............] - ETA: 0s - loss: 0.4462 - acc: 0.7977
 9088/15121 [=================>............] - ETA: 0s - loss: 0.4484 - acc: 0.7959
 9728/15121 [==================>...........] - ETA: 0s - loss: 0.4505 - acc: 0.7944
10368/15121 [===================>..........] - ETA: 0s - loss: 0.4526 - acc: 0.7917
10944/15121 [====================>.........] - ETA: 0s - loss: 0.4551 - acc: 0.7898
11520/15121 [=====================>........] - ETA: 0s - loss: 0.4540 - acc: 0.7901
12160/15121 [=======================>......] - ETA: 0s - loss: 0.4548 - acc: 0.7880
12800/15121 [========================>.....] - ETA: 0s - loss: 0.4564 - acc: 0.7870
13440/15121 [=========================>....] - ETA: 0s - loss: 0.4580 - acc: 0.7856
14080/15121 [==========================>...] - ETA: 0s - loss: 0.4580 - acc: 0.7849
14720/15121 [============================>.] - ETA: 0s - loss: 0.4590 - acc: 0.7840
15121/15121 [==============================] - 1s 83us/step - loss: 0.4584 - acc: 0.7841

Test accuracy: 79.61225766103814

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  652

choose_one :  947

F1score :  0.8132875143184423

AUC : 0.8798975281602003

Confusion Matrix
[[563 237]
 [ 89 710]]
True label 0
0.70375  
0.29625  
True label 1
0.1113892365456821  
0.8886107634543179  

Train_result {'loss': [0.4583907339234854], 'acc': [0.7841412605104698]}
Saved model to disk



8

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4461 - acc: 0.7969
  640/15121 [>.............................] - ETA: 1s - loss: 0.4302 - acc: 0.8141
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4330 - acc: 0.8028
 2048/15121 [===>..........................] - ETA: 1s - loss: 0.4457 - acc: 0.7925
 2688/15121 [====>.........................] - ETA: 0s - loss: 0.4488 - acc: 0.7894
 3328/15121 [=====>........................] - ETA: 0s - loss: 0.4492 - acc: 0.7903
 3904/15121 [======>.......................] - ETA: 0s - loss: 0.4466 - acc: 0.7918
 4480/15121 [=======>......................] - ETA: 0s - loss: 0.4422 - acc: 0.7937
 5120/15121 [=========>....................] - ETA: 0s - loss: 0.4432 - acc: 0.7949
 5824/15121 [==========>...................] - ETA: 0s - loss: 0.4492 - acc: 0.7921
 6464/15121 [===========>..................] - ETA: 0s - loss: 0.4482 - acc: 0.7916
 7104/15121 [=============>................] - ETA: 0s - loss: 0.4495 - acc: 0.7910
 7744/15121 [==============>...............] - ETA: 0s - loss: 0.4480 - acc: 0.7927
 8384/15121 [===============>..............] - ETA: 0s - loss: 0.4484 - acc: 0.7915
 9024/15121 [================>.............] - ETA: 0s - loss: 0.4470 - acc: 0.7924
 9728/15121 [==================>...........] - ETA: 0s - loss: 0.4493 - acc: 0.7902
10368/15121 [===================>..........] - ETA: 0s - loss: 0.4515 - acc: 0.7883
11008/15121 [====================>.........] - ETA: 0s - loss: 0.4524 - acc: 0.7872
11712/15121 [======================>.......] - ETA: 0s - loss: 0.4542 - acc: 0.7856
12416/15121 [=======================>......] - ETA: 0s - loss: 0.4561 - acc: 0.7836
13120/15121 [=========================>....] - ETA: 0s - loss: 0.4554 - acc: 0.7845
13824/15121 [==========================>...] - ETA: 0s - loss: 0.4527 - acc: 0.7857
14464/15121 [===========================>..] - ETA: 0s - loss: 0.4521 - acc: 0.7868
15104/15121 [============================>.] - ETA: 0s - loss: 0.4521 - acc: 0.7871
15121/15121 [==============================] - 1s 81us/step - loss: 0.4520 - acc: 0.7872

Test accuracy: 79.17448405253283

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  721

choose_one :  878

F1score :  0.8014311270125223

AUC : 0.8792435857321652

Confusion Matrix
[[594 206]
 [127 672]]
True label 0
0.7425  
0.2575  
True label 1
0.15894868585732166  
0.8410513141426783  

Train_result {'loss': [0.45196277461909057], 'acc': [0.7872495205422398]}
Saved model to disk



9

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4412 - acc: 0.7500
  704/15121 [>.............................] - ETA: 1s - loss: 0.4446 - acc: 0.7983
 1408/15121 [=>............................] - ETA: 1s - loss: 0.4516 - acc: 0.7891
 2112/15121 [===>..........................] - ETA: 1s - loss: 0.4595 - acc: 0.7855
 2752/15121 [====>.........................] - ETA: 0s - loss: 0.4562 - acc: 0.7878
 3392/15121 [=====>........................] - ETA: 0s - loss: 0.4586 - acc: 0.7863
 4032/15121 [======>.......................] - ETA: 0s - loss: 0.4561 - acc: 0.7852
 4672/15121 [========>.....................] - ETA: 0s - loss: 0.4538 - acc: 0.7866
 5312/15121 [=========>....................] - ETA: 0s - loss: 0.4506 - acc: 0.7888
 5952/15121 [==========>...................] - ETA: 0s - loss: 0.4473 - acc: 0.7918
 6656/15121 [============>.................] - ETA: 0s - loss: 0.4471 - acc: 0.7910
 7360/15121 [=============>................] - ETA: 0s - loss: 0.4469 - acc: 0.7908
 8064/15121 [==============>...............] - ETA: 0s - loss: 0.4459 - acc: 0.7913
 8768/15121 [================>.............] - ETA: 0s - loss: 0.4435 - acc: 0.7932
 9408/15121 [=================>............] - ETA: 0s - loss: 0.4457 - acc: 0.7913
10112/15121 [===================>..........] - ETA: 0s - loss: 0.4452 - acc: 0.7923
10816/15121 [====================>.........] - ETA: 0s - loss: 0.4473 - acc: 0.7915
11520/15121 [=====================>........] - ETA: 0s - loss: 0.4481 - acc: 0.7910
12224/15121 [=======================>......] - ETA: 0s - loss: 0.4490 - acc: 0.7896
12928/15121 [========================>.....] - ETA: 0s - loss: 0.4500 - acc: 0.7893
13568/15121 [=========================>....] - ETA: 0s - loss: 0.4507 - acc: 0.7883
14208/15121 [===========================>..] - ETA: 0s - loss: 0.4508 - acc: 0.7884
14912/15121 [============================>.] - ETA: 0s - loss: 0.4488 - acc: 0.7896
15121/15121 [==============================] - 1s 78us/step - loss: 0.4492 - acc: 0.7895

Test accuracy: 79.9249530956848

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  709

choose_one :  890

F1score :  0.8099467140319716

AUC : 0.886889080100125

Confusion Matrix
[[594 206]
 [115 684]]
True label 0
0.7425  
0.2575  
True label 1
0.1439299123904881  
0.8560700876095119  

Train_result {'loss': [0.4492117524083964], 'acc': [0.7894980490905379]}
Saved model to disk



10

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4388 - acc: 0.8281
  640/15121 [>.............................] - ETA: 1s - loss: 0.4767 - acc: 0.7812
 1408/15121 [=>............................] - ETA: 1s - loss: 0.4647 - acc: 0.7947
 2176/15121 [===>..........................] - ETA: 0s - loss: 0.4608 - acc: 0.7891
 2752/15121 [====>.........................] - ETA: 0s - loss: 0.4573 - acc: 0.7914
 3392/15121 [=====>........................] - ETA: 0s - loss: 0.4593 - acc: 0.7863
 4032/15121 [======>.......................] - ETA: 0s - loss: 0.4632 - acc: 0.7845
 4672/15121 [========>.....................] - ETA: 0s - loss: 0.4590 - acc: 0.7898
 5312/15121 [=========>....................] - ETA: 0s - loss: 0.4545 - acc: 0.7933
 6016/15121 [==========>...................] - ETA: 0s - loss: 0.4543 - acc: 0.7907
 6656/15121 [============>.................] - ETA: 0s - loss: 0.4496 - acc: 0.7913
 7360/15121 [=============>................] - ETA: 0s - loss: 0.4492 - acc: 0.7916
 8064/15121 [==============>...............] - ETA: 0s - loss: 0.4494 - acc: 0.7928
 8768/15121 [================>.............] - ETA: 0s - loss: 0.4501 - acc: 0.7915
 9472/15121 [=================>............] - ETA: 0s - loss: 0.4489 - acc: 0.7927
10176/15121 [===================>..........] - ETA: 0s - loss: 0.4481 - acc: 0.7934
10816/15121 [====================>.........] - ETA: 0s - loss: 0.4473 - acc: 0.7937
11456/15121 [=====================>........] - ETA: 0s - loss: 0.4457 - acc: 0.7944
12160/15121 [=======================>......] - ETA: 0s - loss: 0.4449 - acc: 0.7947
12800/15121 [========================>.....] - ETA: 0s - loss: 0.4447 - acc: 0.7941
13440/15121 [=========================>....] - ETA: 0s - loss: 0.4454 - acc: 0.7937
14080/15121 [==========================>...] - ETA: 0s - loss: 0.4437 - acc: 0.7948
14720/15121 [============================>.] - ETA: 0s - loss: 0.4450 - acc: 0.7935
15121/15121 [==============================] - 1s 79us/step - loss: 0.4451 - acc: 0.7935

Test accuracy: 80.48780487804879

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  684

choose_one :  915

F1score :  0.8179696616102684

AUC : 0.8835239361702127

Confusion Matrix
[[586 214]
 [ 98 701]]
True label 0
0.7325  
0.2675  
True label 1
0.12265331664580725  
0.8773466833541927  

Train_result {'loss': [0.4450680001171783], 'acc': [0.7935321738098547]}
Saved model to disk



11

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.5658 - acc: 0.7812
  640/15121 [>.............................] - ETA: 1s - loss: 0.4692 - acc: 0.7906
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4575 - acc: 0.7954
 2048/15121 [===>..........................] - ETA: 1s - loss: 0.4544 - acc: 0.7983
 2752/15121 [====>.........................] - ETA: 0s - loss: 0.4572 - acc: 0.7918
 3456/15121 [=====>........................] - ETA: 0s - loss: 0.4597 - acc: 0.7914
 4160/15121 [=======>......................] - ETA: 0s - loss: 0.4576 - acc: 0.7918
 4864/15121 [========>.....................] - ETA: 0s - loss: 0.4532 - acc: 0.7917
 5568/15121 [==========>...................] - ETA: 0s - loss: 0.4506 - acc: 0.7936
 6272/15121 [===========>..................] - ETA: 0s - loss: 0.4484 - acc: 0.7923
 6976/15121 [============>.................] - ETA: 0s - loss: 0.4464 - acc: 0.7934
 7680/15121 [==============>...............] - ETA: 0s - loss: 0.4453 - acc: 0.7932
 8384/15121 [===============>..............] - ETA: 0s - loss: 0.4430 - acc: 0.7941
 9088/15121 [=================>............] - ETA: 0s - loss: 0.4413 - acc: 0.7952
 9792/15121 [==================>...........] - ETA: 0s - loss: 0.4417 - acc: 0.7944
10496/15121 [===================>..........] - ETA: 0s - loss: 0.4428 - acc: 0.7933
11200/15121 [=====================>........] - ETA: 0s - loss: 0.4430 - acc: 0.7931
11840/15121 [======================>.......] - ETA: 0s - loss: 0.4429 - acc: 0.7921
12544/15121 [=======================>......] - ETA: 0s - loss: 0.4434 - acc: 0.7917
13248/15121 [=========================>....] - ETA: 0s - loss: 0.4450 - acc: 0.7908
13888/15121 [==========================>...] - ETA: 0s - loss: 0.4443 - acc: 0.7915
14528/15121 [===========================>..] - ETA: 0s - loss: 0.4458 - acc: 0.7917
15121/15121 [==============================] - 1s 77us/step - loss: 0.4461 - acc: 0.7918

Test accuracy: 80.42526579111944

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  773

choose_one :  826

F1score :  0.8073846153846154

AUC : 0.8838086670838547

Confusion Matrix
[[630 170]
 [143 656]]
True label 0
0.7875  
0.2125  
True label 1
0.17897371714643304  
0.8210262828535669  

Train_result {'loss': [0.4460730857299155], 'acc': [0.7918127108113758]}
Saved model to disk



12

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.5781 - acc: 0.6406
  704/15121 [>.............................] - ETA: 1s - loss: 0.4290 - acc: 0.8011
 1408/15121 [=>............................] - ETA: 1s - loss: 0.4339 - acc: 0.8026
 2176/15121 [===>..........................] - ETA: 0s - loss: 0.4227 - acc: 0.8033
 2880/15121 [====>.........................] - ETA: 0s - loss: 0.4276 - acc: 0.8042
 3520/15121 [=====>........................] - ETA: 0s - loss: 0.4343 - acc: 0.7983
 4160/15121 [=======>......................] - ETA: 0s - loss: 0.4364 - acc: 0.7966
 4864/15121 [========>.....................] - ETA: 0s - loss: 0.4339 - acc: 0.7952
 5568/15121 [==========>...................] - ETA: 0s - loss: 0.4350 - acc: 0.7947
 6272/15121 [===========>..................] - ETA: 0s - loss: 0.4348 - acc: 0.7972
 6976/15121 [============>.................] - ETA: 0s - loss: 0.4362 - acc: 0.7976
 7680/15121 [==============>...............] - ETA: 0s - loss: 0.4384 - acc: 0.7971
 8384/15121 [===============>..............] - ETA: 0s - loss: 0.4351 - acc: 0.7990
 9024/15121 [================>.............] - ETA: 0s - loss: 0.4363 - acc: 0.7993
 9664/15121 [==================>...........] - ETA: 0s - loss: 0.4377 - acc: 0.7980
10304/15121 [===================>..........] - ETA: 0s - loss: 0.4400 - acc: 0.7966
10944/15121 [====================>.........] - ETA: 0s - loss: 0.4411 - acc: 0.7969
11648/15121 [======================>.......] - ETA: 0s - loss: 0.4415 - acc: 0.7973
12288/15121 [=======================>......] - ETA: 0s - loss: 0.4408 - acc: 0.7983
12928/15121 [========================>.....] - ETA: 0s - loss: 0.4406 - acc: 0.7983
13568/15121 [=========================>....] - ETA: 0s - loss: 0.4416 - acc: 0.7978
14144/15121 [===========================>..] - ETA: 0s - loss: 0.4422 - acc: 0.7972
14784/15121 [============================>.] - ETA: 0s - loss: 0.4409 - acc: 0.7977
15121/15121 [==============================] - 1s 78us/step - loss: 0.4409 - acc: 0.7978

Test accuracy: 80.17510944340212

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  673

choose_one :  926

F1score :  0.816231884057971

AUC : 0.8881867959949938

Confusion Matrix
[[578 222]
 [ 95 704]]
True label 0
0.7225  
0.2775  
True label 1
0.11889862327909888  
0.8811013767209012  

Train_result {'loss': [0.4409295540042091], 'acc': [0.7977646981059192]}
Saved model to disk



13

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.3674 - acc: 0.8125
  704/15121 [>.............................] - ETA: 1s - loss: 0.4177 - acc: 0.8011
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4220 - acc: 0.7946
 2048/15121 [===>..........................] - ETA: 1s - loss: 0.4272 - acc: 0.7983
 2752/15121 [====>.........................] - ETA: 0s - loss: 0.4346 - acc: 0.7947
 3456/15121 [=====>........................] - ETA: 0s - loss: 0.4429 - acc: 0.7902
 4160/15121 [=======>......................] - ETA: 0s - loss: 0.4465 - acc: 0.7877
 4864/15121 [========>.....................] - ETA: 0s - loss: 0.4398 - acc: 0.7909
 5568/15121 [==========>...................] - ETA: 0s - loss: 0.4380 - acc: 0.7924
 6272/15121 [===========>..................] - ETA: 0s - loss: 0.4386 - acc: 0.7923
 6912/15121 [============>.................] - ETA: 0s - loss: 0.4387 - acc: 0.7930
 7616/15121 [==============>...............] - ETA: 0s - loss: 0.4379 - acc: 0.7941
 8320/15121 [===============>..............] - ETA: 0s - loss: 0.4397 - acc: 0.7925
 9024/15121 [================>.............] - ETA: 0s - loss: 0.4418 - acc: 0.7911
 9728/15121 [==================>...........] - ETA: 0s - loss: 0.4439 - acc: 0.7905
10432/15121 [===================>..........] - ETA: 0s - loss: 0.4420 - acc: 0.7913
11136/15121 [=====================>........] - ETA: 0s - loss: 0.4410 - acc: 0.7918
11776/15121 [======================>.......] - ETA: 0s - loss: 0.4389 - acc: 0.7932
12480/15121 [=======================>......] - ETA: 0s - loss: 0.4369 - acc: 0.7939
13184/15121 [=========================>....] - ETA: 0s - loss: 0.4366 - acc: 0.7932
13888/15121 [==========================>...] - ETA: 0s - loss: 0.4377 - acc: 0.7926
14528/15121 [===========================>..] - ETA: 0s - loss: 0.4372 - acc: 0.7935
15121/15121 [==============================] - 1s 77us/step - loss: 0.4359 - acc: 0.7947

Test accuracy: 80.17510944340212

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  645

choose_one :  954

F1score :  0.8191671420422134

AUC : 0.8869438360450563

Confusion Matrix
[[564 236]
 [ 81 718]]
True label 0
0.705  
0.295  
True label 1
0.10137672090112641  
0.8986232790988736  

Train_result {'loss': [0.4359231049595399], 'acc': [0.7946564380780909]}
Saved model to disk



14

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.5893 - acc: 0.7188
  640/15121 [>.............................] - ETA: 1s - loss: 0.4319 - acc: 0.7984
 1344/15121 [=>............................] - ETA: 1s - loss: 0.4520 - acc: 0.7842
 1984/15121 [==>...........................] - ETA: 1s - loss: 0.4504 - acc: 0.7878
 2688/15121 [====>.........................] - ETA: 0s - loss: 0.4422 - acc: 0.7946
 3392/15121 [=====>........................] - ETA: 0s - loss: 0.4469 - acc: 0.7939
 4096/15121 [=======>......................] - ETA: 0s - loss: 0.4449 - acc: 0.7969
 4800/15121 [========>.....................] - ETA: 0s - loss: 0.4473 - acc: 0.7963
 5504/15121 [=========>....................] - ETA: 0s - loss: 0.4490 - acc: 0.7954
 6144/15121 [===========>..................] - ETA: 0s - loss: 0.4439 - acc: 0.7987
 6848/15121 [============>.................] - ETA: 0s - loss: 0.4450 - acc: 0.7967
 7488/15121 [=============>................] - ETA: 0s - loss: 0.4419 - acc: 0.7973
 8128/15121 [===============>..............] - ETA: 0s - loss: 0.4407 - acc: 0.7975
 8832/15121 [================>.............] - ETA: 0s - loss: 0.4396 - acc: 0.7978
 9472/15121 [=================>............] - ETA: 0s - loss: 0.4380 - acc: 0.7993
10176/15121 [===================>..........] - ETA: 0s - loss: 0.4405 - acc: 0.7987
10880/15121 [====================>.........] - ETA: 0s - loss: 0.4379 - acc: 0.7999
11584/15121 [=====================>........] - ETA: 0s - loss: 0.4372 - acc: 0.8002
12224/15121 [=======================>......] - ETA: 0s - loss: 0.4390 - acc: 0.7995
12864/15121 [========================>.....] - ETA: 0s - loss: 0.4383 - acc: 0.8001
13568/15121 [=========================>....] - ETA: 0s - loss: 0.4399 - acc: 0.7993
14336/15121 [===========================>..] - ETA: 0s - loss: 0.4407 - acc: 0.7979
15104/15121 [============================>.] - ETA: 0s - loss: 0.4411 - acc: 0.7981
15121/15121 [==============================] - 1s 77us/step - loss: 0.4413 - acc: 0.7980

Test accuracy: 80.1125703564728

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  672

choose_one :  927

F1score :  0.8157589803012747

AUC : 0.885069618272841

Confusion Matrix
[[577 223]
 [ 95 704]]
True label 0
0.72125  
0.27875  
True label 1
0.11889862327909888  
0.8811013767209012  

Train_result {'loss': [0.44134387030392425], 'acc': [0.7979630977023761]}
Saved model to disk



15

Epoch 1/1

   64/15121 [..............................] - ETA: 1s - loss: 0.4890 - acc: 0.7344
  640/15121 [>.............................] - ETA: 1s - loss: 0.4432 - acc: 0.7906
 1280/15121 [=>............................] - ETA: 1s - loss: 0.4347 - acc: 0.7922
 1920/15121 [==>...........................] - ETA: 1s - loss: 0.4494 - acc: 0.7891
 2560/15121 [====>.........................] - ETA: 1s - loss: 0.4476 - acc: 0.7895
 3200/15121 [=====>........................] - ETA: 0s - loss: 0.4455 - acc: 0.7894
 3840/15121 [======>.......................] - ETA: 0s - loss: 0.4417 - acc: 0.7940
 4480/15121 [=======>......................] - ETA: 0s - loss: 0.4388 - acc: 0.7960
 5120/15121 [=========>....................] - ETA: 0s - loss: 0.4405 - acc: 0.7949
 5760/15121 [==========>...................] - ETA: 0s - loss: 0.4377 - acc: 0.7969
 6400/15121 [===========>..................] - ETA: 0s - loss: 0.4357 - acc: 0.7986
 7104/15121 [=============>................] - ETA: 0s - loss: 0.4367 - acc: 0.8000
 7808/15121 [==============>...............] - ETA: 0s - loss: 0.4389 - acc: 0.7988
 8512/15121 [===============>..............] - ETA: 0s - loss: 0.4395 - acc: 0.7990
 9216/15121 [=================>............] - ETA: 0s - loss: 0.4396 - acc: 0.7995
 9856/15121 [==================>...........] - ETA: 0s - loss: 0.4407 - acc: 0.7991
10496/15121 [===================>..........] - ETA: 0s - loss: 0.4390 - acc: 0.8007
11136/15121 [=====================>........] - ETA: 0s - loss: 0.4392 - acc: 0.8005
11776/15121 [======================>.......] - ETA: 0s - loss: 0.4426 - acc: 0.7982
12416/15121 [=======================>......] - ETA: 0s - loss: 0.4411 - acc: 0.7983
13056/15121 [========================>.....] - ETA: 0s - loss: 0.4402 - acc: 0.7983
13696/15121 [==========================>...] - ETA: 0s - loss: 0.4428 - acc: 0.7967
14400/15121 [===========================>..] - ETA: 0s - loss: 0.4435 - acc: 0.7961
15040/15121 [============================>.] - ETA: 0s - loss: 0.4431 - acc: 0.7959
15121/15121 [==============================] - 1s 81us/step - loss: 0.4433 - acc: 0.7960

Test accuracy: 79.17448405253283

data size :  16720

zero :  8361

one :  8359

train_zero :  7561

train_one :  7560

test_zero :  800

test_one :  799

choose_zero :  787

choose_one :  812

F1score :  0.7932960893854749

AUC : 0.8809019086357945

Confusion Matrix
[[627 173]
 [160 639]]
True label 0
0.78375  
0.21625  
True label 1
0.2002503128911139  
0.799749687108886  

Train_result {'loss': [0.44331621154812656], 'acc': [0.7959791019230747]}
Saved model to disk



[[78.67417135709819, 1], [78.67417135709819, 2], [79.1119449656035, 3], [79.42464040025015, 4], [78.54909318323952, 5], [79.2995622263915, 6], [79.61225766103814, 7], [79.17448405253283, 8], [79.9249530956848, 9], [80.48780487804879, 10], [80.42526579111944, 11], [80.17510944340212, 12], [80.17510944340212, 13], [80.1125703564728, 14], [79.17448405253283, 15]]
max accuracy :  [80.48780487804879, 10]

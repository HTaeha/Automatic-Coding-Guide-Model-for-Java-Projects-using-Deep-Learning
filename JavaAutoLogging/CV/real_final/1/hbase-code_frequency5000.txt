Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:359: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-05 23:30:06.224118: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-05 23:30:06.234667: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-05 23:30:06.236907: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6925580 executing computations on platform Host. Devices:
2019-08-05 23:30:06.236933: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 55

Under 10 : 8165
Over 10, Under 200 : 37669
Over 200, Under 400 : 2147
Over 400 : 489

hbase-code
updated_train_data

Sentence length Average : 52

Under 10 : 0
Over 10, Under 200 : 27853
Over 200, Under 400 : 1027
Over 400 : 0


Test_zero:  2410
Train_zero:  21283
zero:  23693
Test_one:  804
Train_one:  7597
one:  8401

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 344s - loss: 0.4962 - acc: 0.7676

Test accuracy: 81.29272840273461

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  912

choose_one :  697

F1score :  0.7994670219853433

AUC : 0.9001568245727882

Confusion Matrix
[[708  97]
 [204 600]]
True label 0
0.8795031055900621  
0.12049689440993788  
True label 1
0.2537313432835821  
0.746268656716418  

Train_result {'acc': [0.7676209278936722], 'loss': [0.49620013249551986]}
2

Epoch 1/1
 - 365s - loss: 0.3903 - acc: 0.8314

Test accuracy: 83.96519577377252

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  769

choose_one :  840

F1score :  0.843065693430657

AUC : 0.9195968913197985

Confusion Matrix
[[658 147]
 [111 693]]
True label 0
0.8173913043478261  
0.1826086956521739  
True label 1
0.13805970149253732  
0.8619402985074627  

Train_result {'acc': [0.8313919052162936], 'loss': [0.3903190092022147]}
3

Epoch 1/1
 - 368s - loss: 0.3554 - acc: 0.8463

Test accuracy: 85.64325668116842

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  822

choose_one :  787

F1score :  0.8548082966687618

AUC : 0.9296027625845926

Confusion Matrix
[[698 107]
 [124 680]]
True label 0
0.867080745341615  
0.13291925465838508  
True label 1
0.15422885572139303  
0.845771144278607  

Train_result {'acc': [0.8463310299950549], 'loss': [0.3554027558726361]}
4

Epoch 1/1
 - 366s - loss: 0.3294 - acc: 0.8580

Test accuracy: 83.71659415786202

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  951

choose_one :  658

F1score :  0.8207934336525308

AUC : 0.9366776366614133

Confusion Matrix
[[747  58]
 [204 600]]
True label 0
0.9279503105590062  
0.07204968944099378  
True label 1
0.2537313432835821  
0.746268656716418  

Train_result {'acc': [0.8579795985090062], 'loss': [0.329403859743675]}
5

Epoch 1/1
 - 367s - loss: 0.3090 - acc: 0.8670

Test accuracy: 85.39465506525794

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  864

choose_one :  745

F1score :  0.8482892188508715

AUC : 0.9358494793115167

Confusion Matrix
[[717  88]
 [147 657]]
True label 0
0.8906832298136645  
0.1093167701863354  
True label 1
0.1828358208955224  
0.8171641791044776  

Train_result {'acc': [0.8669957222613742], 'loss': [0.30901008735718244]}
6

Epoch 1/1
 - 366s - loss: 0.2879 - acc: 0.8777

Test accuracy: 85.95400870105657

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  881

choose_one :  728

F1score :  0.8524804177545692

AUC : 0.9400196223849696

Confusion Matrix
[[730  75]
 [151 653]]
True label 0
0.906832298136646  
0.09316770186335403  
True label 1
0.18781094527363185  
0.8121890547263682  

Train_result {'acc': [0.8776571241049596], 'loss': [0.2878518685987805]}
7

Epoch 1/1
 - 368s - loss: 0.2675 - acc: 0.8876

Test accuracy: 87.32131758856433

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  801

choose_one :  808

F1score :  0.8734491315136477

AUC : 0.9432704489972498

Confusion Matrix
[[701 104]
 [100 704]]
True label 0
0.8708074534161491  
0.12919254658385093  
True label 1
0.12437810945273632  
0.8756218905472637  

Train_result {'acc': [0.8875946034997574], 'loss': [0.2675115825138268]}
8

Epoch 1/1
 - 368s - loss: 0.2504 - acc: 0.8949

Test accuracy: 86.2647607209447

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  854

choose_one :  755

F1score :  0.858242463117383

AUC : 0.9427883872562652

Confusion Matrix
[[719  86]
 [135 669]]
True label 0
0.893167701863354  
0.10683229813664596  
True label 1
0.16791044776119404  
0.832089552238806  

Train_result {'acc': [0.8948996380780551], 'loss': [0.2503802963903014]}
9

Epoch 1/1
 - 367s - loss: 0.2300 - acc: 0.9044

Test accuracy: 86.94841516469857

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  855

choose_one :  754

F1score :  0.8652118100128369

AUC : 0.9455386112913692

Confusion Matrix
[[725  80]
 [130 674]]
True label 0
0.9006211180124224  
0.09937888198757763  
True label 1
0.16169154228855723  
0.8383084577114428  

Train_result {'acc': [0.9044422507796016], 'loss': [0.2300223128944292]}
10

Epoch 1/1
 - 367s - loss: 0.2132 - acc: 0.9127

Test accuracy: 87.0105655686762

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  816

choose_one :  793

F1score :  0.8691296180338134

AUC : 0.9406229720960415

Confusion Matrix
[[706  99]
 [110 694]]
True label 0
0.8770186335403727  
0.12298136645962733  
True label 1
0.13681592039800994  
0.8631840796019901  

Train_result {'acc': [0.9127344521341766], 'loss': [0.21318535889673876]}
11

Epoch 1/1
 - 370s - loss: 0.1916 - acc: 0.9203

Test accuracy: 87.44561839651958

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  819

choose_one :  790

F1score :  0.8732747804265997

AUC : 0.9452705417014307

Confusion Matrix
[[711  94]
 [108 696]]
True label 0
0.8832298136645963  
0.11677018633540373  
True label 1
0.13432835820895522  
0.8656716417910447  

Train_result {'acc': [0.9203027311341078], 'loss': [0.1915732337734973]}
12

Epoch 1/1
 - 366s - loss: 0.1765 - acc: 0.9268

Test accuracy: 86.94841516469857

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  845

choose_one :  764

F1score :  0.8660714285714286

AUC : 0.942121689688205

Confusion Matrix
[[720  85]
 [125 679]]
True label 0
0.8944099378881988  
0.10559006211180125  
True label 1
0.15547263681592038  
0.8445273631840796  

Train_result {'acc': [0.9267522211763646], 'loss': [0.17649585125516143]}
13

Epoch 1/1
 - 362s - loss: 0.1620 - acc: 0.9343

Test accuracy: 87.44561839651958

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  751

choose_one :  858

F1score :  0.8784596871239471

AUC : 0.9385942956027316

Confusion Matrix
[[677 128]
 [ 74 730]]
True label 0
0.8409937888198757  
0.15900621118012423  
True label 1
0.09203980099502487  
0.9079601990049752  

Train_result {'acc': [0.9343205001370692], 'loss': [0.16199026759732277]}
14

Epoch 1/1
 - 361s - loss: 0.1435 - acc: 0.9416

Test accuracy: 87.88067122436296

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  750

choose_one :  859

F1score :  0.8827420324714371

AUC : 0.9444400667470103

Confusion Matrix
[[680 125]
 [ 70 734]]
True label 0
0.84472049689441  
0.15527950310559005  
True label 1
0.08706467661691543  
0.9129353233830846  

Train_result {'acc': [0.9415597236050552], 'loss': [0.14349024499294277]}
15

Epoch 1/1
 - 360s - loss: 0.1273 - acc: 0.9468

Test accuracy: 87.81852082038533

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  737

choose_one :  872

F1score :  0.883054892601432

AUC : 0.9448448750038627

Confusion Matrix
[[673 132]
 [ 64 740]]
True label 0
0.8360248447204969  
0.1639751552795031  
True label 1
0.07960199004975124  
0.9203980099502488  

Train_result {'acc': [0.9467588022768046], 'loss': [0.12732089262586865]}
Saved model to disk




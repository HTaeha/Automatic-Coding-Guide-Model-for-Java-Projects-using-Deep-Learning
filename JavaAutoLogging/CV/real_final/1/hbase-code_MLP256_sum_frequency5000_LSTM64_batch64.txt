Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:400: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-21 03:42:04.513345: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-21 03:42:04.525493: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-21 03:42:04.528586: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x73db1a0 executing computations on platform Host. Devices:
2019-08-21 03:42:04.528628: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 55

Under 10 : 8165
Over 10, Under 200 : 37669
Over 200, Under 400 : 2147
Over 400 : 489

hbase-code
updated_train_data

Sentence length Average : 52

Under 10 : 0
Over 10, Under 200 : 27853
Over 200, Under 400 : 1027
Over 400 : 0


Test_zero:  2410
Train_zero:  21283
zero:  23693
Test_one:  804
Train_one:  7597
one:  8401

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15195 [..............................] - ETA: 1:25 - loss: 3.9953 - acc: 0.4688
  960/15195 [>.............................] - ETA: 6s - loss: 5.9768 - acc: 0.5010  
 1728/15195 [==>...........................] - ETA: 3s - loss: 4.8126 - acc: 0.5382
 2560/15195 [====>.........................] - ETA: 2s - loss: 4.0446 - acc: 0.5656
 3392/15195 [=====>........................] - ETA: 1s - loss: 3.6575 - acc: 0.5834
 4224/15195 [=======>......................] - ETA: 1s - loss: 3.2812 - acc: 0.5942
 5056/15195 [========>.....................] - ETA: 1s - loss: 2.9927 - acc: 0.5995
 5696/15195 [==========>...................] - ETA: 1s - loss: 2.8125 - acc: 0.6062
 6528/15195 [===========>..................] - ETA: 1s - loss: 2.5728 - acc: 0.6152
 7360/15195 [=============>................] - ETA: 1s - loss: 2.3713 - acc: 0.6257
 8128/15195 [===============>..............] - ETA: 0s - loss: 2.2399 - acc: 0.6284
 8896/15195 [================>.............] - ETA: 0s - loss: 2.1198 - acc: 0.6346
 9728/15195 [==================>...........] - ETA: 0s - loss: 2.0079 - acc: 0.6416
10560/15195 [===================>..........] - ETA: 0s - loss: 1.9192 - acc: 0.6438
11392/15195 [=====================>........] - ETA: 0s - loss: 1.8341 - acc: 0.6469
12224/15195 [=======================>......] - ETA: 0s - loss: 1.7632 - acc: 0.6518
13120/15195 [========================>.....] - ETA: 0s - loss: 1.6898 - acc: 0.6563
13952/15195 [==========================>...] - ETA: 0s - loss: 1.6334 - acc: 0.6611
14784/15195 [============================>.] - ETA: 0s - loss: 1.5835 - acc: 0.6628
15195/15195 [==============================] - 2s 103us/step - loss: 1.5591 - acc: 0.6644

Test accuracy: 70.54070851460534

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  457

choose_one :  1152

F1score :  0.7576687116564417

AUC : 0.8217252248076388

Confusion Matrix
[[394 411]
 [ 63 741]]
True label 0
0.4894409937888199  
0.5105590062111801  
True label 1
0.07835820895522388  
0.9216417910447762  

Train_result {'loss': [1.5590550693370433], 'acc': [0.6643632774174154]}
Saved model to disk



2

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 1.1137 - acc: 0.5938
  832/15195 [>.............................] - ETA: 0s - loss: 0.7048 - acc: 0.7091
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.7107 - acc: 0.7121
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.6975 - acc: 0.7143
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.6982 - acc: 0.7139
 4224/15195 [=======>......................] - ETA: 0s - loss: 0.6819 - acc: 0.7188
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.6710 - acc: 0.7184
 5952/15195 [==========>...................] - ETA: 0s - loss: 0.6726 - acc: 0.7154
 6784/15195 [============>.................] - ETA: 0s - loss: 0.6713 - acc: 0.7151
 7616/15195 [==============>...............] - ETA: 0s - loss: 0.6646 - acc: 0.7148
 8448/15195 [===============>..............] - ETA: 0s - loss: 0.6626 - acc: 0.7166
 9280/15195 [=================>............] - ETA: 0s - loss: 0.6567 - acc: 0.7181
10112/15195 [==================>...........] - ETA: 0s - loss: 0.6544 - acc: 0.7209
10944/15195 [====================>.........] - ETA: 0s - loss: 0.6512 - acc: 0.7209
11776/15195 [======================>.......] - ETA: 0s - loss: 0.6496 - acc: 0.7226
12608/15195 [=======================>......] - ETA: 0s - loss: 0.6473 - acc: 0.7226
13440/15195 [=========================>....] - ETA: 0s - loss: 0.6452 - acc: 0.7219
14272/15195 [===========================>..] - ETA: 0s - loss: 0.6432 - acc: 0.7205
15104/15195 [============================>.] - ETA: 0s - loss: 0.6378 - acc: 0.7212
15195/15195 [==============================] - 1s 63us/step - loss: 0.6370 - acc: 0.7216

Test accuracy: 74.2697327532629

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  943

choose_one :  666

F1score :  0.7183673469387755

AUC : 0.8313208800716911

Confusion Matrix
[[667 138]
 [276 528]]
True label 0
0.8285714285714286  
0.17142857142857143  
True label 1
0.34328358208955223  
0.6567164179104478  

Train_result {'loss': [0.6370496958445153], 'acc': [0.7216189535600098]}
Saved model to disk



3

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.3966 - acc: 0.8594
  896/15195 [>.............................] - ETA: 0s - loss: 0.5912 - acc: 0.7734
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5853 - acc: 0.7558
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.5880 - acc: 0.7473
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.5926 - acc: 0.7406
 4288/15195 [=======>......................] - ETA: 0s - loss: 0.5890 - acc: 0.7446
 5184/15195 [=========>....................] - ETA: 0s - loss: 0.5875 - acc: 0.7431
 6080/15195 [===========>..................] - ETA: 0s - loss: 0.5886 - acc: 0.7416
 6912/15195 [============>.................] - ETA: 0s - loss: 0.5913 - acc: 0.7403
 7744/15195 [==============>...............] - ETA: 0s - loss: 0.5941 - acc: 0.7394
 8640/15195 [================>.............] - ETA: 0s - loss: 0.5866 - acc: 0.7404
 9472/15195 [=================>............] - ETA: 0s - loss: 0.5827 - acc: 0.7418
10304/15195 [===================>..........] - ETA: 0s - loss: 0.5794 - acc: 0.7435
11136/15195 [====================>.........] - ETA: 0s - loss: 0.5782 - acc: 0.7443
11968/15195 [======================>.......] - ETA: 0s - loss: 0.5754 - acc: 0.7452
12800/15195 [========================>.....] - ETA: 0s - loss: 0.5699 - acc: 0.7477
13632/15195 [=========================>....] - ETA: 0s - loss: 0.5708 - acc: 0.7482
14528/15195 [===========================>..] - ETA: 0s - loss: 0.5675 - acc: 0.7486
15195/15195 [==============================] - 1s 61us/step - loss: 0.5681 - acc: 0.7491

Test accuracy: 75.32628962088253

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  1002

choose_one :  607

F1score :  0.7186392629340893

AUC : 0.8512584592565124

Confusion Matrix
[[705 100]
 [297 507]]
True label 0
0.8757763975155279  
0.12422360248447205  
True label 1
0.3694029850746269  
0.6305970149253731  

Train_result {'loss': [0.5680588511622003], 'acc': [0.7491280026834393]}
Saved model to disk



4

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5321 - acc: 0.7656
  832/15195 [>.............................] - ETA: 0s - loss: 0.5497 - acc: 0.7416
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.5690 - acc: 0.7398
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.5678 - acc: 0.7360
 3264/15195 [=====>........................] - ETA: 0s - loss: 0.5644 - acc: 0.7390
 4096/15195 [=======>......................] - ETA: 0s - loss: 0.5719 - acc: 0.7400
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.5711 - acc: 0.7431
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.5686 - acc: 0.7453
 6592/15195 [============>.................] - ETA: 0s - loss: 0.5615 - acc: 0.7476
 7424/15195 [=============>................] - ETA: 0s - loss: 0.5633 - acc: 0.7487
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.5625 - acc: 0.7495
 9088/15195 [================>.............] - ETA: 0s - loss: 0.5621 - acc: 0.7497
 9856/15195 [==================>...........] - ETA: 0s - loss: 0.5605 - acc: 0.7506
10624/15195 [===================>..........] - ETA: 0s - loss: 0.5588 - acc: 0.7525
11392/15195 [=====================>........] - ETA: 0s - loss: 0.5574 - acc: 0.7548
12224/15195 [=======================>......] - ETA: 0s - loss: 0.5582 - acc: 0.7538
13056/15195 [========================>.....] - ETA: 0s - loss: 0.5585 - acc: 0.7533
13888/15195 [==========================>...] - ETA: 0s - loss: 0.5596 - acc: 0.7530
14656/15195 [===========================>..] - ETA: 0s - loss: 0.5619 - acc: 0.7533
15195/15195 [==============================] - 1s 64us/step - loss: 0.5612 - acc: 0.7524

Test accuracy: 77.8744561839652

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  913

choose_one :  696

F1score :  0.7626666666666667

AUC : 0.8560095485306387

Confusion Matrix
[[681 124]
 [232 572]]
True label 0
0.8459627329192546  
0.15403726708074533  
True label 1
0.2885572139303483  
0.7114427860696517  

Train_result {'loss': [0.5612175530059905], 'acc': [0.7524185587207358]}
Saved model to disk



5

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4284 - acc: 0.8125
  960/15195 [>.............................] - ETA: 0s - loss: 0.5304 - acc: 0.7646
 1792/15195 [==>...........................] - ETA: 0s - loss: 0.5328 - acc: 0.7483
 2624/15195 [====>.........................] - ETA: 0s - loss: 0.5296 - acc: 0.7572
 3456/15195 [=====>........................] - ETA: 0s - loss: 0.5392 - acc: 0.7491
 4288/15195 [=======>......................] - ETA: 0s - loss: 0.5494 - acc: 0.7446
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.5460 - acc: 0.7458
 5888/15195 [==========>...................] - ETA: 0s - loss: 0.5441 - acc: 0.7449
 6720/15195 [============>.................] - ETA: 0s - loss: 0.5501 - acc: 0.7460
 7552/15195 [=============>................] - ETA: 0s - loss: 0.5482 - acc: 0.7475
 8384/15195 [===============>..............] - ETA: 0s - loss: 0.5489 - acc: 0.7505
 9216/15195 [=================>............] - ETA: 0s - loss: 0.5443 - acc: 0.7529
10048/15195 [==================>...........] - ETA: 0s - loss: 0.5461 - acc: 0.7529
10880/15195 [====================>.........] - ETA: 0s - loss: 0.5450 - acc: 0.7535
11712/15195 [======================>.......] - ETA: 0s - loss: 0.5484 - acc: 0.7528
12544/15195 [=======================>......] - ETA: 0s - loss: 0.5480 - acc: 0.7528
13376/15195 [=========================>....] - ETA: 0s - loss: 0.5482 - acc: 0.7527
14208/15195 [===========================>..] - ETA: 0s - loss: 0.5470 - acc: 0.7541
15040/15195 [============================>.] - ETA: 0s - loss: 0.5451 - acc: 0.7553
15195/15195 [==============================] - 1s 63us/step - loss: 0.5449 - acc: 0.7551

Test accuracy: 77.31510254816656

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  880

choose_one :  729

F1score :  0.7619047619047619

AUC : 0.8517436111368623

Confusion Matrix
[[660 145]
 [220 584]]
True label 0
0.8198757763975155  
0.18012422360248448  
True label 1
0.2736318407960199  
0.7263681592039801  

Train_result {'loss': [0.5448753301585023], 'acc': [0.7550510036156891]}
Saved model to disk



6

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4577 - acc: 0.8281
  896/15195 [>.............................] - ETA: 0s - loss: 0.5258 - acc: 0.7623
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5108 - acc: 0.7662
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.5286 - acc: 0.7598
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.5262 - acc: 0.7603
 4224/15195 [=======>......................] - ETA: 0s - loss: 0.5322 - acc: 0.7585
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.5289 - acc: 0.7605
 5888/15195 [==========>...................] - ETA: 0s - loss: 0.5360 - acc: 0.7580
 6720/15195 [============>.................] - ETA: 0s - loss: 0.5360 - acc: 0.7597
 7488/15195 [=============>................] - ETA: 0s - loss: 0.5363 - acc: 0.7608
 8320/15195 [===============>..............] - ETA: 0s - loss: 0.5417 - acc: 0.7602
 9152/15195 [=================>............] - ETA: 0s - loss: 0.5403 - acc: 0.7604
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.5347 - acc: 0.7636
10752/15195 [====================>.........] - ETA: 0s - loss: 0.5378 - acc: 0.7617
11584/15195 [=====================>........] - ETA: 0s - loss: 0.5391 - acc: 0.7617
12416/15195 [=======================>......] - ETA: 0s - loss: 0.5366 - acc: 0.7624
13248/15195 [=========================>....] - ETA: 0s - loss: 0.5351 - acc: 0.7635
14080/15195 [==========================>...] - ETA: 0s - loss: 0.5353 - acc: 0.7638
14912/15195 [============================>.] - ETA: 0s - loss: 0.5359 - acc: 0.7639
15195/15195 [==============================] - 1s 64us/step - loss: 0.5364 - acc: 0.7643

Test accuracy: 66.93598508390305

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  1257

choose_one :  352

F1score :  0.5397923875432525

AUC : 0.8589807175303608

Confusion Matrix
[[765  40]
 [492 312]]
True label 0
0.9503105590062112  
0.049689440993788817  
True label 1
0.6119402985074627  
0.3880597014925373  

Train_result {'loss': [0.536421053226781], 'acc': [0.764264560667611]}
Saved model to disk



7

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4662 - acc: 0.7812
  896/15195 [>.............................] - ETA: 0s - loss: 0.5249 - acc: 0.7645
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5347 - acc: 0.7697
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.5215 - acc: 0.7684
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.5176 - acc: 0.7752
 4096/15195 [=======>......................] - ETA: 0s - loss: 0.5243 - acc: 0.7656
 4864/15195 [========>.....................] - ETA: 0s - loss: 0.5222 - acc: 0.7658
 5632/15195 [==========>...................] - ETA: 0s - loss: 0.5247 - acc: 0.7654
 6464/15195 [===========>..................] - ETA: 0s - loss: 0.5280 - acc: 0.7633
 7296/15195 [=============>................] - ETA: 0s - loss: 0.5385 - acc: 0.7634
 8128/15195 [===============>..............] - ETA: 0s - loss: 0.5378 - acc: 0.7605
 8960/15195 [================>.............] - ETA: 0s - loss: 0.5344 - acc: 0.7616
 9792/15195 [==================>...........] - ETA: 0s - loss: 0.5326 - acc: 0.7617
10624/15195 [===================>..........] - ETA: 0s - loss: 0.5319 - acc: 0.7632
11456/15195 [=====================>........] - ETA: 0s - loss: 0.5317 - acc: 0.7612
12288/15195 [=======================>......] - ETA: 0s - loss: 0.5263 - acc: 0.7638
13056/15195 [========================>.....] - ETA: 0s - loss: 0.5268 - acc: 0.7620
13824/15195 [==========================>...] - ETA: 0s - loss: 0.5260 - acc: 0.7606
14656/15195 [===========================>..] - ETA: 0s - loss: 0.5272 - acc: 0.7604
15195/15195 [==============================] - 1s 64us/step - loss: 0.5278 - acc: 0.7606

Test accuracy: 74.64263517712865

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  891

choose_one :  718

F1score :  0.7319316688567673

AUC : 0.8427157689811811

Confusion Matrix
[[644 161]
 [247 557]]
True label 0
0.8  
0.2  
True label 1
0.3072139303482587  
0.6927860696517413  

Train_result {'loss': [0.5277788480750508], 'acc': [0.760579137882146]}
Saved model to disk



8

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5626 - acc: 0.7031
  896/15195 [>.............................] - ETA: 0s - loss: 0.5130 - acc: 0.7600
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5232 - acc: 0.7535
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.5308 - acc: 0.7645
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.5348 - acc: 0.7650
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.5369 - acc: 0.7644
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.5355 - acc: 0.7638
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.5363 - acc: 0.7603
 6656/15195 [============>.................] - ETA: 0s - loss: 0.5339 - acc: 0.7620
 7488/15195 [=============>................] - ETA: 0s - loss: 0.5341 - acc: 0.7612
 8320/15195 [===============>..............] - ETA: 0s - loss: 0.5313 - acc: 0.7613
 9152/15195 [=================>............] - ETA: 0s - loss: 0.5333 - acc: 0.7605
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.5309 - acc: 0.7615
10816/15195 [====================>.........] - ETA: 0s - loss: 0.5311 - acc: 0.7626
11648/15195 [=====================>........] - ETA: 0s - loss: 0.5285 - acc: 0.7623
12480/15195 [=======================>......] - ETA: 0s - loss: 0.5315 - acc: 0.7636
13312/15195 [=========================>....] - ETA: 0s - loss: 0.5296 - acc: 0.7635
14144/15195 [==========================>...] - ETA: 0s - loss: 0.5310 - acc: 0.7630
14976/15195 [============================>.] - ETA: 0s - loss: 0.5307 - acc: 0.7619
15195/15195 [==============================] - 1s 63us/step - loss: 0.5304 - acc: 0.7625

Test accuracy: 78.18520820385334

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  612

choose_one :  997

F1score :  0.8051082731815659

AUC : 0.8696216124347209

Confusion Matrix
[[533 272]
 [ 79 725]]
True label 0
0.662111801242236  
0.337888198757764  
True label 1
0.09825870646766169  
0.9017412935323383  

Train_result {'loss': [0.5304073896659915], 'acc': [0.7624876604656045]}
Saved model to disk



9

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.6698 - acc: 0.7031
  896/15195 [>.............................] - ETA: 0s - loss: 0.5540 - acc: 0.7411
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5209 - acc: 0.7500
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.5174 - acc: 0.7588
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.5131 - acc: 0.7623
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.5164 - acc: 0.7601
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.5220 - acc: 0.7566
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.5229 - acc: 0.7570
 6656/15195 [============>.................] - ETA: 0s - loss: 0.5233 - acc: 0.7578
 7488/15195 [=============>................] - ETA: 0s - loss: 0.5256 - acc: 0.7567
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.5263 - acc: 0.7582
 9088/15195 [================>.............] - ETA: 0s - loss: 0.5273 - acc: 0.7585
 9920/15195 [==================>...........] - ETA: 0s - loss: 0.5238 - acc: 0.7617
10752/15195 [====================>.........] - ETA: 0s - loss: 0.5243 - acc: 0.7628
11584/15195 [=====================>........] - ETA: 0s - loss: 0.5247 - acc: 0.7628
12352/15195 [=======================>......] - ETA: 0s - loss: 0.5240 - acc: 0.7628
13184/15195 [=========================>....] - ETA: 0s - loss: 0.5229 - acc: 0.7635
14016/15195 [==========================>...] - ETA: 0s - loss: 0.5229 - acc: 0.7649
14784/15195 [============================>.] - ETA: 0s - loss: 0.5196 - acc: 0.7667
15195/15195 [==============================] - 1s 65us/step - loss: 0.5209 - acc: 0.7666

Test accuracy: 79.67681789931635

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  790

choose_one :  819

F1score :  0.7985212569316081

AUC : 0.8684133679428943

Confusion Matrix
[[634 171]
 [156 648]]
True label 0
0.7875776397515528  
0.2124223602484472  
True label 1
0.19402985074626866  
0.8059701492537313  

Train_result {'loss': [0.5209157582645787], 'acc': [0.7665679500070831]}
Saved model to disk



10

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.2894 - acc: 0.8906
  896/15195 [>.............................] - ETA: 0s - loss: 0.4767 - acc: 0.7902
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.5040 - acc: 0.7800
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.5139 - acc: 0.7796
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.5219 - acc: 0.7776
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.5172 - acc: 0.7728
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.5150 - acc: 0.7712
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.5165 - acc: 0.7723
 6592/15195 [============>.................] - ETA: 0s - loss: 0.5168 - acc: 0.7755
 7424/15195 [=============>................] - ETA: 0s - loss: 0.5153 - acc: 0.7760
 8192/15195 [===============>..............] - ETA: 0s - loss: 0.5166 - acc: 0.7775
 9024/15195 [================>.............] - ETA: 0s - loss: 0.5182 - acc: 0.7779
 9856/15195 [==================>...........] - ETA: 0s - loss: 0.5150 - acc: 0.7795
10688/15195 [====================>.........] - ETA: 0s - loss: 0.5175 - acc: 0.7779
11520/15195 [=====================>........] - ETA: 0s - loss: 0.5192 - acc: 0.7760
12416/15195 [=======================>......] - ETA: 0s - loss: 0.5218 - acc: 0.7744
13312/15195 [=========================>....] - ETA: 0s - loss: 0.5225 - acc: 0.7745
14208/15195 [===========================>..] - ETA: 0s - loss: 0.5191 - acc: 0.7759
15104/15195 [============================>.] - ETA: 0s - loss: 0.5190 - acc: 0.7762
15195/15195 [==============================] - 1s 63us/step - loss: 0.5191 - acc: 0.7762

Test accuracy: 76.4449968924798

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  948

choose_one :  661

F1score :  0.741296928327645

AUC : 0.8694640153270912

Confusion Matrix
[[687 118]
 [261 543]]
True label 0
0.853416149068323  
0.14658385093167703  
True label 1
0.3246268656716418  
0.6753731343283582  

Train_result {'loss': [0.5191335634951452], 'acc': [0.7761763737640243]}
Saved model to disk



11

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.3635 - acc: 0.8281
  832/15195 [>.............................] - ETA: 0s - loss: 0.5047 - acc: 0.7740
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.5339 - acc: 0.7752
 2432/15195 [===>..........................] - ETA: 0s - loss: 0.5425 - acc: 0.7710
 3264/15195 [=====>........................] - ETA: 0s - loss: 0.5336 - acc: 0.7733
 4096/15195 [=======>......................] - ETA: 0s - loss: 0.5170 - acc: 0.7754
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.5189 - acc: 0.7741
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.5147 - acc: 0.7726
 6592/15195 [============>.................] - ETA: 0s - loss: 0.5152 - acc: 0.7720
 7424/15195 [=============>................] - ETA: 0s - loss: 0.5115 - acc: 0.7732
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.5066 - acc: 0.7736
 9088/15195 [================>.............] - ETA: 0s - loss: 0.5068 - acc: 0.7746
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.5077 - acc: 0.7750
10816/15195 [====================>.........] - ETA: 0s - loss: 0.5107 - acc: 0.7752
11584/15195 [=====================>........] - ETA: 0s - loss: 0.5090 - acc: 0.7766
12416/15195 [=======================>......] - ETA: 0s - loss: 0.5113 - acc: 0.7743
13248/15195 [=========================>....] - ETA: 0s - loss: 0.5137 - acc: 0.7739
14080/15195 [==========================>...] - ETA: 0s - loss: 0.5153 - acc: 0.7736
14912/15195 [============================>.] - ETA: 0s - loss: 0.5138 - acc: 0.7741
15195/15195 [==============================] - 1s 64us/step - loss: 0.5150 - acc: 0.7737

Test accuracy: 77.12865133623369

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  749

choose_one :  860

F1score :  0.778846153846154

AUC : 0.8472907203114862

Confusion Matrix
[[593 212]
 [156 648]]
True label 0
0.7366459627329193  
0.26335403726708073  
True label 1
0.19402985074626866  
0.8059701492537313  

Train_result {'loss': [0.5149621336445992], 'acc': [0.7737413623412215]}
Saved model to disk



12

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.6513 - acc: 0.7500
  896/15195 [>.............................] - ETA: 0s - loss: 0.5068 - acc: 0.7891
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.5069 - acc: 0.7825
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.5043 - acc: 0.7756
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.4994 - acc: 0.7725
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.5082 - acc: 0.7651
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.5090 - acc: 0.7686
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.5045 - acc: 0.7696
 6592/15195 [============>.................] - ETA: 0s - loss: 0.5076 - acc: 0.7703
 7360/15195 [=============>................] - ETA: 0s - loss: 0.5025 - acc: 0.7732
 8192/15195 [===============>..............] - ETA: 0s - loss: 0.5035 - acc: 0.7737
 9024/15195 [================>.............] - ETA: 0s - loss: 0.5080 - acc: 0.7734
 9792/15195 [==================>...........] - ETA: 0s - loss: 0.5105 - acc: 0.7736
10624/15195 [===================>..........] - ETA: 0s - loss: 0.5157 - acc: 0.7731
11456/15195 [=====================>........] - ETA: 0s - loss: 0.5147 - acc: 0.7723
12224/15195 [=======================>......] - ETA: 0s - loss: 0.5130 - acc: 0.7726
13056/15195 [========================>.....] - ETA: 0s - loss: 0.5128 - acc: 0.7727
13888/15195 [==========================>...] - ETA: 0s - loss: 0.5149 - acc: 0.7724
14720/15195 [============================>.] - ETA: 0s - loss: 0.5169 - acc: 0.7704
15195/15195 [==============================] - 1s 65us/step - loss: 0.5182 - acc: 0.7705

Test accuracy: 77.93660658794282

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  864

choose_one :  745

F1score :  0.7708198837959974

AUC : 0.867852507648095

Confusion Matrix
[[657 148]
 [207 597]]
True label 0
0.8161490683229814  
0.18385093167701863  
True label 1
0.2574626865671642  
0.7425373134328358  

Train_result {'loss': [0.5181575801683201], 'acc': [0.7705166173593195]}
Saved model to disk



13

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4814 - acc: 0.7812
  960/15195 [>.............................] - ETA: 0s - loss: 0.4598 - acc: 0.7990
 1792/15195 [==>...........................] - ETA: 0s - loss: 0.4869 - acc: 0.7829
 2624/15195 [====>.........................] - ETA: 0s - loss: 0.4999 - acc: 0.7702
 3456/15195 [=====>........................] - ETA: 0s - loss: 0.4944 - acc: 0.7755
 4288/15195 [=======>......................] - ETA: 0s - loss: 0.4878 - acc: 0.7801
 5184/15195 [=========>....................] - ETA: 0s - loss: 0.4930 - acc: 0.7780
 5952/15195 [==========>...................] - ETA: 0s - loss: 0.4954 - acc: 0.7791
 6720/15195 [============>.................] - ETA: 0s - loss: 0.5016 - acc: 0.7765
 7552/15195 [=============>................] - ETA: 0s - loss: 0.5021 - acc: 0.7738
 8384/15195 [===============>..............] - ETA: 0s - loss: 0.5014 - acc: 0.7761
 9216/15195 [=================>............] - ETA: 0s - loss: 0.5017 - acc: 0.7762
10048/15195 [==================>...........] - ETA: 0s - loss: 0.5015 - acc: 0.7767
10880/15195 [====================>.........] - ETA: 0s - loss: 0.5053 - acc: 0.7752
11712/15195 [======================>.......] - ETA: 0s - loss: 0.5025 - acc: 0.7755
12544/15195 [=======================>......] - ETA: 0s - loss: 0.5021 - acc: 0.7769
13376/15195 [=========================>....] - ETA: 0s - loss: 0.5022 - acc: 0.7768
14208/15195 [===========================>..] - ETA: 0s - loss: 0.5036 - acc: 0.7762
15040/15195 [============================>.] - ETA: 0s - loss: 0.5027 - acc: 0.7757
15195/15195 [==============================] - 1s 63us/step - loss: 0.5022 - acc: 0.7758

Test accuracy: 79.11746426351772

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  735

choose_one :  874

F1score :  0.799761620977354

AUC : 0.8765311640554989

Confusion Matrix
[[602 203]
 [133 671]]
True label 0
0.7478260869565218  
0.25217391304347825  
True label 1
0.1654228855721393  
0.8345771144278606  

Train_result {'loss': [0.5022173313119374], 'acc': [0.7758473181810847]}
Saved model to disk



14

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4732 - acc: 0.7500
  832/15195 [>.............................] - ETA: 1s - loss: 0.5024 - acc: 0.7812
 1600/15195 [==>...........................] - ETA: 0s - loss: 0.4880 - acc: 0.7831
 2368/15195 [===>..........................] - ETA: 0s - loss: 0.4894 - acc: 0.7838
 3136/15195 [=====>........................] - ETA: 0s - loss: 0.4937 - acc: 0.7797
 3968/15195 [======>.......................] - ETA: 0s - loss: 0.4916 - acc: 0.7825
 4736/15195 [========>.....................] - ETA: 0s - loss: 0.4986 - acc: 0.7785
 5568/15195 [=========>....................] - ETA: 0s - loss: 0.5042 - acc: 0.7782
 6400/15195 [===========>..................] - ETA: 0s - loss: 0.5091 - acc: 0.7789
 7232/15195 [=============>................] - ETA: 0s - loss: 0.5093 - acc: 0.7785
 8064/15195 [==============>...............] - ETA: 0s - loss: 0.5132 - acc: 0.7777
 8896/15195 [================>.............] - ETA: 0s - loss: 0.5129 - acc: 0.7792
 9792/15195 [==================>...........] - ETA: 0s - loss: 0.5125 - acc: 0.7789
10624/15195 [===================>..........] - ETA: 0s - loss: 0.5105 - acc: 0.7794
11456/15195 [=====================>........] - ETA: 0s - loss: 0.5079 - acc: 0.7805
12288/15195 [=======================>......] - ETA: 0s - loss: 0.5072 - acc: 0.7802
13120/15195 [========================>.....] - ETA: 0s - loss: 0.5085 - acc: 0.7773
13952/15195 [==========================>...] - ETA: 0s - loss: 0.5060 - acc: 0.7781
14784/15195 [============================>.] - ETA: 0s - loss: 0.5080 - acc: 0.7771
15195/15195 [==============================] - 1s 65us/step - loss: 0.5072 - acc: 0.7778

Test accuracy: 74.7669359850839

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  1045

choose_one :  564

F1score :  0.703216374269006

AUC : 0.8729257439510522

Confusion Matrix
[[722  83]
 [323 481]]
True label 0
0.8968944099378882  
0.1031055900621118  
True label 1
0.4017412935323383  
0.5982587064676617  

Train_result {'loss': [0.5072273924873235], 'acc': [0.7778216518709321]}
Saved model to disk



15

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.3994 - acc: 0.7969
  896/15195 [>.............................] - ETA: 0s - loss: 0.4490 - acc: 0.8158
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4708 - acc: 0.8056
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.4719 - acc: 0.8035
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.4878 - acc: 0.7939
 4224/15195 [=======>......................] - ETA: 0s - loss: 0.5002 - acc: 0.7869
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.5136 - acc: 0.7834
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.5084 - acc: 0.7828
 6656/15195 [============>.................] - ETA: 0s - loss: 0.5131 - acc: 0.7770
 7424/15195 [=============>................] - ETA: 0s - loss: 0.5134 - acc: 0.7757
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.5144 - acc: 0.7741
 9088/15195 [================>.............] - ETA: 0s - loss: 0.5104 - acc: 0.7763
 9920/15195 [==================>...........] - ETA: 0s - loss: 0.5104 - acc: 0.7762
10688/15195 [====================>.........] - ETA: 0s - loss: 0.5094 - acc: 0.7768
11520/15195 [=====================>........] - ETA: 0s - loss: 0.5090 - acc: 0.7755
12352/15195 [=======================>......] - ETA: 0s - loss: 0.5087 - acc: 0.7758
13184/15195 [=========================>....] - ETA: 0s - loss: 0.5062 - acc: 0.7773
14016/15195 [==========================>...] - ETA: 0s - loss: 0.5070 - acc: 0.7774
14848/15195 [============================>.] - ETA: 0s - loss: 0.5063 - acc: 0.7784
15195/15195 [==============================] - 1s 64us/step - loss: 0.5079 - acc: 0.7782

Test accuracy: 78.49596022374146

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  919

choose_one :  690

F1score :  0.7684069611780455

AUC : 0.8798283427582584

Confusion Matrix
[[689 116]
 [230 574]]
True label 0
0.8559006211180125  
0.14409937888198757  
True label 1
0.2860696517412935  
0.7139303482587065  

Train_result {'loss': [0.5078803891118086], 'acc': [0.7781507075048661]}
Saved model to disk



[[70.54070851460534, 1], [74.2697327532629, 2], [75.32628962088253, 3], [77.8744561839652, 4], [77.31510254816656, 5], [66.93598508390305, 6], [74.64263517712865, 7], [78.18520820385334, 8], [79.67681789931635, 9], [76.4449968924798, 10], [77.12865133623369, 11], [77.93660658794282, 12], [79.11746426351772, 13], [74.7669359850839, 14], [78.49596022374146, 15]]
max accuracy :  [79.67681789931635, 9]

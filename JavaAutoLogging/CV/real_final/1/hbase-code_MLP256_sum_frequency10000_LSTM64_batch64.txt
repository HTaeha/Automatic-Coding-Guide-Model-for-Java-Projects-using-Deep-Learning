Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:400: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-21 03:45:40.274369: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-21 03:45:40.284607: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-21 03:45:40.287083: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7e1ef90 executing computations on platform Host. Devices:
2019-08-21 03:45:40.287125: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 55

Under 10 : 8165
Over 10, Under 200 : 37669
Over 200, Under 400 : 2147
Over 400 : 489

hbase-code
updated_train_data

Sentence length Average : 50

Under 10 : 0
Over 10, Under 200 : 27203
Over 200, Under 400 : 820
Over 400 : 0


Test_zero:  2300
Train_zero:  20480
zero:  22780
Test_one:  797
Train_one:  7543
one:  8340

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15087 [..............................] - ETA: 1:22 - loss: 4.0694 - acc: 0.3750
  896/15087 [>.............................] - ETA: 6s - loss: 6.6659 - acc: 0.4877  
 1728/15087 [==>...........................] - ETA: 3s - loss: 5.3441 - acc: 0.5139
 2560/15087 [====>.........................] - ETA: 2s - loss: 4.5332 - acc: 0.5398
 3392/15087 [=====>........................] - ETA: 1s - loss: 3.9541 - acc: 0.5557
 4224/15087 [=======>......................] - ETA: 1s - loss: 3.5175 - acc: 0.5634
 5120/15087 [=========>....................] - ETA: 1s - loss: 3.1313 - acc: 0.5734
 5952/15087 [==========>...................] - ETA: 1s - loss: 2.8596 - acc: 0.5771
 6784/15087 [============>.................] - ETA: 0s - loss: 2.6502 - acc: 0.5803
 7616/15087 [==============>...............] - ETA: 0s - loss: 2.4760 - acc: 0.5832
 8448/15087 [===============>..............] - ETA: 0s - loss: 2.3261 - acc: 0.5866
 9280/15087 [=================>............] - ETA: 0s - loss: 2.2007 - acc: 0.5913
10112/15087 [===================>..........] - ETA: 0s - loss: 2.0981 - acc: 0.5927
10944/15087 [====================>.........] - ETA: 0s - loss: 1.9893 - acc: 0.5996
11776/15087 [======================>.......] - ETA: 0s - loss: 1.9022 - acc: 0.6049
12608/15087 [========================>.....] - ETA: 0s - loss: 1.8258 - acc: 0.6065
13440/15087 [=========================>....] - ETA: 0s - loss: 1.7624 - acc: 0.6094
14208/15087 [===========================>..] - ETA: 0s - loss: 1.7070 - acc: 0.6116
15040/15087 [============================>.] - ETA: 0s - loss: 1.6530 - acc: 0.6138
15087/15087 [==============================] - 1s 85us/step - loss: 1.6502 - acc: 0.6139

Test accuracy: 59.686520376175544

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1359

choose_one :  236

F1score :  0.377541142303969

AUC : 0.6087222447586973

Confusion Matrix
[[757  41]
 [602 195]]
True label 0
0.9486215538847118  
0.05137844611528822  
True label 1
0.7553324968632371  
0.24466750313676286  

Train_result {'acc': [0.6139060117468774], 'loss': [1.6501542737542922]}
Saved model to disk



2

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.7996 - acc: 0.7031
 1024/15087 [=>............................] - ETA: 0s - loss: 0.7509 - acc: 0.6445
 1856/15087 [==>...........................] - ETA: 0s - loss: 0.7142 - acc: 0.6536
 2688/15087 [====>.........................] - ETA: 0s - loss: 0.7050 - acc: 0.6622
 3456/15087 [=====>........................] - ETA: 0s - loss: 0.6973 - acc: 0.6644
 4224/15087 [=======>......................] - ETA: 0s - loss: 0.6860 - acc: 0.6610
 5056/15087 [=========>....................] - ETA: 0s - loss: 0.6795 - acc: 0.6634
 5888/15087 [==========>...................] - ETA: 0s - loss: 0.6760 - acc: 0.6620
 6720/15087 [============>.................] - ETA: 0s - loss: 0.6763 - acc: 0.6631
 7552/15087 [==============>...............] - ETA: 0s - loss: 0.6751 - acc: 0.6672
 8320/15087 [===============>..............] - ETA: 0s - loss: 0.6732 - acc: 0.6709
 9152/15087 [=================>............] - ETA: 0s - loss: 0.6707 - acc: 0.6708
 9984/15087 [==================>...........] - ETA: 0s - loss: 0.6677 - acc: 0.6732
10816/15087 [====================>.........] - ETA: 0s - loss: 0.6633 - acc: 0.6752
11648/15087 [======================>.......] - ETA: 0s - loss: 0.6605 - acc: 0.6762
12480/15087 [=======================>......] - ETA: 0s - loss: 0.6601 - acc: 0.6781
13312/15087 [=========================>....] - ETA: 0s - loss: 0.6587 - acc: 0.6786
14144/15087 [===========================>..] - ETA: 0s - loss: 0.6564 - acc: 0.6799
14976/15087 [============================>.] - ETA: 0s - loss: 0.6549 - acc: 0.6798
15087/15087 [==============================] - 1s 63us/step - loss: 0.6548 - acc: 0.6797

Test accuracy: 73.29153605015674

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  598

choose_one :  997

F1score :  0.762541806020067

AUC : 0.800089936258463

Confusion Matrix
[[485 313]
 [113 684]]
True label 0
0.6077694235588973  
0.39223057644110276  
True label 1
0.14178168130489335  
0.8582183186951067  

Train_result {'acc': [0.6796579836511135], 'loss': [0.6547645490868172]}
Saved model to disk



3

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.7036 - acc: 0.7031
  832/15087 [>.............................] - ETA: 0s - loss: 0.6440 - acc: 0.6815
 1664/15087 [==>...........................] - ETA: 0s - loss: 0.6310 - acc: 0.6959
 2432/15087 [===>..........................] - ETA: 0s - loss: 0.6418 - acc: 0.6978
 3264/15087 [=====>........................] - ETA: 0s - loss: 0.6367 - acc: 0.6921
 4096/15087 [=======>......................] - ETA: 0s - loss: 0.6332 - acc: 0.6963
 4992/15087 [========>.....................] - ETA: 0s - loss: 0.6226 - acc: 0.6987
 5824/15087 [==========>...................] - ETA: 0s - loss: 0.6214 - acc: 0.6963
 6656/15087 [============>.................] - ETA: 0s - loss: 0.6217 - acc: 0.6967
 7488/15087 [=============>................] - ETA: 0s - loss: 0.6249 - acc: 0.6963
 8320/15087 [===============>..............] - ETA: 0s - loss: 0.6276 - acc: 0.6950
 9152/15087 [=================>............] - ETA: 0s - loss: 0.6292 - acc: 0.6950
 9984/15087 [==================>...........] - ETA: 0s - loss: 0.6270 - acc: 0.6950
10816/15087 [====================>.........] - ETA: 0s - loss: 0.6288 - acc: 0.6958
11712/15087 [======================>.......] - ETA: 0s - loss: 0.6269 - acc: 0.6975
12608/15087 [========================>.....] - ETA: 0s - loss: 0.6239 - acc: 0.6995
13440/15087 [=========================>....] - ETA: 0s - loss: 0.6254 - acc: 0.6995
14336/15087 [===========================>..] - ETA: 0s - loss: 0.6282 - acc: 0.7000
15087/15087 [==============================] - 1s 62us/step - loss: 0.6278 - acc: 0.7000

Test accuracy: 67.7115987460815

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1167

choose_one :  428

F1score :  0.5795918367346938

AUC : 0.8302358782778779

Confusion Matrix
[[725  73]
 [442 355]]
True label 0
0.9085213032581454  
0.09147869674185463  
True label 1
0.5545796737766625  
0.4454203262233375  

Train_result {'acc': [0.7000066281874169], 'loss': [0.627783847031366]}
Saved model to disk



4

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.5654 - acc: 0.6875
  896/15087 [>.............................] - ETA: 0s - loss: 0.6153 - acc: 0.7020
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.6060 - acc: 0.7124
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.6103 - acc: 0.7129
 3392/15087 [=====>........................] - ETA: 0s - loss: 0.6064 - acc: 0.7120
 4160/15087 [=======>......................] - ETA: 0s - loss: 0.6138 - acc: 0.7094
 4928/15087 [========>.....................] - ETA: 0s - loss: 0.6121 - acc: 0.7076
 5760/15087 [==========>...................] - ETA: 0s - loss: 0.6119 - acc: 0.7097
 6592/15087 [============>.................] - ETA: 0s - loss: 0.6079 - acc: 0.7153
 7360/15087 [=============>................] - ETA: 0s - loss: 0.6063 - acc: 0.7132
 8192/15087 [===============>..............] - ETA: 0s - loss: 0.6067 - acc: 0.7124
 9024/15087 [================>.............] - ETA: 0s - loss: 0.6074 - acc: 0.7108
 9856/15087 [==================>...........] - ETA: 0s - loss: 0.6120 - acc: 0.7086
10688/15087 [====================>.........] - ETA: 0s - loss: 0.6120 - acc: 0.7081
11520/15087 [=====================>........] - ETA: 0s - loss: 0.6086 - acc: 0.7101
12352/15087 [=======================>......] - ETA: 0s - loss: 0.6085 - acc: 0.7084
13184/15087 [=========================>....] - ETA: 0s - loss: 0.6079 - acc: 0.7074
14016/15087 [==========================>...] - ETA: 0s - loss: 0.6067 - acc: 0.7085
14848/15087 [============================>.] - ETA: 0s - loss: 0.6061 - acc: 0.7084
15087/15087 [==============================] - 1s 64us/step - loss: 0.6059 - acc: 0.7082

Test accuracy: 70.53291536050156

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1080

choose_one :  515

F1score :  0.6417682926829268

AUC : 0.836311292660761

Confusion Matrix
[[704  94]
 [376 421]]
True label 0
0.8822055137844611  
0.11779448621553884  
True label 1
0.47176913425345046  
0.5282308657465495  

Train_result {'acc': [0.7082256247890298], 'loss': [0.6059173895625761]}
Saved model to disk



5

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.4791 - acc: 0.7656
  960/15087 [>.............................] - ETA: 0s - loss: 0.5960 - acc: 0.6979
 1792/15087 [==>...........................] - ETA: 0s - loss: 0.5821 - acc: 0.7210
 2624/15087 [====>.........................] - ETA: 0s - loss: 0.5874 - acc: 0.7195
 3456/15087 [=====>........................] - ETA: 0s - loss: 0.5884 - acc: 0.7185
 4352/15087 [=======>......................] - ETA: 0s - loss: 0.5912 - acc: 0.7181
 5184/15087 [=========>....................] - ETA: 0s - loss: 0.5898 - acc: 0.7166
 6016/15087 [==========>...................] - ETA: 0s - loss: 0.5863 - acc: 0.7176
 6848/15087 [============>.................] - ETA: 0s - loss: 0.5865 - acc: 0.7171
 7680/15087 [==============>...............] - ETA: 0s - loss: 0.5891 - acc: 0.7172
 8512/15087 [===============>..............] - ETA: 0s - loss: 0.5973 - acc: 0.7124
 9280/15087 [=================>............] - ETA: 0s - loss: 0.5962 - acc: 0.7137
10048/15087 [==================>...........] - ETA: 0s - loss: 0.5971 - acc: 0.7145
10816/15087 [====================>.........] - ETA: 0s - loss: 0.5962 - acc: 0.7163
11648/15087 [======================>.......] - ETA: 0s - loss: 0.5975 - acc: 0.7171
12480/15087 [=======================>......] - ETA: 0s - loss: 0.5985 - acc: 0.7168
13312/15087 [=========================>....] - ETA: 0s - loss: 0.5955 - acc: 0.7187
14144/15087 [===========================>..] - ETA: 0s - loss: 0.5950 - acc: 0.7182
14976/15087 [============================>.] - ETA: 0s - loss: 0.5981 - acc: 0.7188
15087/15087 [==============================] - 1s 63us/step - loss: 0.5976 - acc: 0.7190

Test accuracy: 73.60501567398119

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1001

choose_one :  594

F1score :  0.6973400431344355

AUC : 0.8409857768637402

Confusion Matrix
[[689 109]
 [312 485]]
True label 0
0.8634085213032582  
0.13659147869674185  
True label 1
0.39146800501882056  
0.6085319949811794  

Train_result {'acc': [0.7190296280658244], 'loss': [0.5976348890733267]}
Saved model to disk



6

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.6221 - acc: 0.7656
  960/15087 [>.............................] - ETA: 0s - loss: 0.6168 - acc: 0.7135
 1856/15087 [==>...........................] - ETA: 0s - loss: 0.5975 - acc: 0.7258
 2688/15087 [====>.........................] - ETA: 0s - loss: 0.5985 - acc: 0.7180
 3520/15087 [=====>........................] - ETA: 0s - loss: 0.5865 - acc: 0.7202
 4352/15087 [=======>......................] - ETA: 0s - loss: 0.5916 - acc: 0.7208
 5184/15087 [=========>....................] - ETA: 0s - loss: 0.5854 - acc: 0.7197
 6080/15087 [===========>..................] - ETA: 0s - loss: 0.5824 - acc: 0.7197
 6912/15087 [============>.................] - ETA: 0s - loss: 0.5827 - acc: 0.7183
 7744/15087 [==============>...............] - ETA: 0s - loss: 0.5784 - acc: 0.7199
 8576/15087 [================>.............] - ETA: 0s - loss: 0.5774 - acc: 0.7196
 9408/15087 [=================>............] - ETA: 0s - loss: 0.5845 - acc: 0.7180
10240/15087 [===================>..........] - ETA: 0s - loss: 0.5838 - acc: 0.7188
11072/15087 [=====================>........] - ETA: 0s - loss: 0.5816 - acc: 0.7200
11968/15087 [======================>.......] - ETA: 0s - loss: 0.5834 - acc: 0.7185
12800/15087 [========================>.....] - ETA: 0s - loss: 0.5849 - acc: 0.7185
13632/15087 [==========================>...] - ETA: 0s - loss: 0.5859 - acc: 0.7180
14464/15087 [===========================>..] - ETA: 0s - loss: 0.5860 - acc: 0.7181
15087/15087 [==============================] - 1s 62us/step - loss: 0.5864 - acc: 0.7180

Test accuracy: 75.36050156739812

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  933

choose_one :  662

F1score :  0.7306374228923921

AUC : 0.8437892095357591

Confusion Matrix
[[669 129]
 [264 533]]
True label 0
0.8383458646616542  
0.16165413533834586  
True label 1
0.3312421580928482  
0.6687578419071518  

Train_result {'acc': [0.7179691123900771], 'loss': [0.5864488310500058]}
Saved model to disk



7

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.5245 - acc: 0.7188
  896/15087 [>.............................] - ETA: 0s - loss: 0.5601 - acc: 0.7400
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5890 - acc: 0.7292
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.5727 - acc: 0.7340
 3392/15087 [=====>........................] - ETA: 0s - loss: 0.5982 - acc: 0.7291
 4224/15087 [=======>......................] - ETA: 0s - loss: 0.5835 - acc: 0.7386
 5120/15087 [=========>....................] - ETA: 0s - loss: 0.5917 - acc: 0.7336
 5952/15087 [==========>...................] - ETA: 0s - loss: 0.5902 - acc: 0.7362
 6784/15087 [============>.................] - ETA: 0s - loss: 0.5835 - acc: 0.7364
 7616/15087 [==============>...............] - ETA: 0s - loss: 0.5860 - acc: 0.7391
 8448/15087 [===============>..............] - ETA: 0s - loss: 0.5866 - acc: 0.7365
 9280/15087 [=================>............] - ETA: 0s - loss: 0.5825 - acc: 0.7362
10112/15087 [===================>..........] - ETA: 0s - loss: 0.5839 - acc: 0.7354
10944/15087 [====================>.........] - ETA: 0s - loss: 0.5889 - acc: 0.7337
11712/15087 [======================>.......] - ETA: 0s - loss: 0.5883 - acc: 0.7318
12544/15087 [=======================>......] - ETA: 0s - loss: 0.5900 - acc: 0.7298
13376/15087 [=========================>....] - ETA: 0s - loss: 0.5917 - acc: 0.7291
14208/15087 [===========================>..] - ETA: 0s - loss: 0.5916 - acc: 0.7285
15040/15087 [============================>.] - ETA: 0s - loss: 0.5909 - acc: 0.7298
15087/15087 [==============================] - 1s 63us/step - loss: 0.5912 - acc: 0.7294

Test accuracy: 75.61128526645768

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  767

choose_one :  828

F1score :  0.7606153846153846

AUC : 0.8364685238818501

Confusion Matrix
[[588 210]
 [179 618]]
True label 0
0.7368421052631579  
0.2631578947368421  
True label 1
0.2245922208281054  
0.7754077791718946  

Train_result {'acc': [0.7294359381815039], 'loss': [0.5912352481624467]}
Saved model to disk



8

Epoch 1/1

   64/15087 [..............................] - ETA: 0s - loss: 0.3800 - acc: 0.8125
  960/15087 [>.............................] - ETA: 0s - loss: 0.6307 - acc: 0.7125
 1792/15087 [==>...........................] - ETA: 0s - loss: 0.5819 - acc: 0.7238
 2624/15087 [====>.........................] - ETA: 0s - loss: 0.5860 - acc: 0.7237
 3456/15087 [=====>........................] - ETA: 0s - loss: 0.5834 - acc: 0.7269
 4288/15087 [=======>......................] - ETA: 0s - loss: 0.5871 - acc: 0.7241
 5056/15087 [=========>....................] - ETA: 0s - loss: 0.5900 - acc: 0.7217
 5888/15087 [==========>...................] - ETA: 0s - loss: 0.5779 - acc: 0.7259
 6656/15087 [============>.................] - ETA: 0s - loss: 0.5767 - acc: 0.7255
 7488/15087 [=============>................] - ETA: 0s - loss: 0.5813 - acc: 0.7262
 8320/15087 [===============>..............] - ETA: 0s - loss: 0.5792 - acc: 0.7280
 9152/15087 [=================>............] - ETA: 0s - loss: 0.5819 - acc: 0.7263
 9984/15087 [==================>...........] - ETA: 0s - loss: 0.5807 - acc: 0.7270
10880/15087 [====================>.........] - ETA: 0s - loss: 0.5798 - acc: 0.7256
11712/15087 [======================>.......] - ETA: 0s - loss: 0.5796 - acc: 0.7249
12544/15087 [=======================>......] - ETA: 0s - loss: 0.5788 - acc: 0.7266
13376/15087 [=========================>....] - ETA: 0s - loss: 0.5835 - acc: 0.7247
14208/15087 [===========================>..] - ETA: 0s - loss: 0.5814 - acc: 0.7252
15040/15087 [============================>.] - ETA: 0s - loss: 0.5828 - acc: 0.7253
15087/15087 [==============================] - 1s 63us/step - loss: 0.5825 - acc: 0.7253

Test accuracy: 75.98746081504703

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  889

choose_one :  706

F1score :  0.7451763140385894

AUC : 0.8407546469687394

Confusion Matrix
[[652 146]
 [237 560]]
True label 0
0.8170426065162907  
0.18295739348370926  
True label 1
0.2973651191969887  
0.7026348808030113  

Train_result {'acc': [0.7253264398984757], 'loss': [0.5825123280383582]}
Saved model to disk



9

Epoch 1/1

   64/15087 [..............................] - ETA: 0s - loss: 0.5616 - acc: 0.7500
  960/15087 [>.............................] - ETA: 0s - loss: 0.5601 - acc: 0.7219
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5506 - acc: 0.7321
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.5481 - acc: 0.7387
 3392/15087 [=====>........................] - ETA: 0s - loss: 0.5541 - acc: 0.7385
 4224/15087 [=======>......................] - ETA: 0s - loss: 0.5551 - acc: 0.7375
 5056/15087 [=========>....................] - ETA: 0s - loss: 0.5554 - acc: 0.7369
 5824/15087 [==========>...................] - ETA: 0s - loss: 0.5679 - acc: 0.7337
 6656/15087 [============>.................] - ETA: 0s - loss: 0.5683 - acc: 0.7338
 7424/15087 [=============>................] - ETA: 0s - loss: 0.5675 - acc: 0.7326
 8256/15087 [===============>..............] - ETA: 0s - loss: 0.5723 - acc: 0.7298
 9088/15087 [=================>............] - ETA: 0s - loss: 0.5708 - acc: 0.7302
 9920/15087 [==================>...........] - ETA: 0s - loss: 0.5728 - acc: 0.7289
10688/15087 [====================>.........] - ETA: 0s - loss: 0.5758 - acc: 0.7271
11520/15087 [=====================>........] - ETA: 0s - loss: 0.5768 - acc: 0.7270
12352/15087 [=======================>......] - ETA: 0s - loss: 0.5777 - acc: 0.7265
13184/15087 [=========================>....] - ETA: 0s - loss: 0.5779 - acc: 0.7267
14016/15087 [==========================>...] - ETA: 0s - loss: 0.5756 - acc: 0.7281
14912/15087 [============================>.] - ETA: 0s - loss: 0.5774 - acc: 0.7280
15087/15087 [==============================] - 1s 64us/step - loss: 0.5764 - acc: 0.7282

Test accuracy: 76.99059561128526

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  757

choose_one :  838

F1score :  0.7755351681957187

AUC : 0.8531083040097106

Confusion Matrix
[[594 204]
 [163 634]]
True label 0
0.7443609022556391  
0.2556390977443609  
True label 1
0.20451693851944794  
0.795483061480552  

Train_result {'acc': [0.7281765759390265], 'loss': [0.576422047364575]}
Saved model to disk



10

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.4140 - acc: 0.8281
  960/15087 [>.............................] - ETA: 0s - loss: 0.5450 - acc: 0.7510
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5481 - acc: 0.7535
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.5523 - acc: 0.7504
 3392/15087 [=====>........................] - ETA: 0s - loss: 0.5502 - acc: 0.7473
 4224/15087 [=======>......................] - ETA: 0s - loss: 0.5568 - acc: 0.7424
 4992/15087 [========>.....................] - ETA: 0s - loss: 0.5576 - acc: 0.7408
 5760/15087 [==========>...................] - ETA: 0s - loss: 0.5575 - acc: 0.7458
 6592/15087 [============>.................] - ETA: 0s - loss: 0.5570 - acc: 0.7436
 7424/15087 [=============>................] - ETA: 0s - loss: 0.5570 - acc: 0.7411
 8256/15087 [===============>..............] - ETA: 0s - loss: 0.5615 - acc: 0.7398
 9088/15087 [=================>............] - ETA: 0s - loss: 0.5615 - acc: 0.7378
 9920/15087 [==================>...........] - ETA: 0s - loss: 0.5636 - acc: 0.7372
10816/15087 [====================>.........] - ETA: 0s - loss: 0.5659 - acc: 0.7341
11648/15087 [======================>.......] - ETA: 0s - loss: 0.5658 - acc: 0.7344
12480/15087 [=======================>......] - ETA: 0s - loss: 0.5646 - acc: 0.7354
13312/15087 [=========================>....] - ETA: 0s - loss: 0.5635 - acc: 0.7348
14080/15087 [==========================>...] - ETA: 0s - loss: 0.5648 - acc: 0.7354
14912/15087 [============================>.] - ETA: 0s - loss: 0.5675 - acc: 0.7354
15087/15087 [==============================] - 1s 63us/step - loss: 0.5672 - acc: 0.7351

Test accuracy: 58.87147335423197

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1418

choose_one :  177

F1score :  0.3264887063655031

AUC : 0.8419260195658531

Confusion Matrix
[[780  18]
 [638 159]]
True label 0
0.9774436090225563  
0.022556390977443608  
True label 1
0.8005018820577164  
0.19949811794228356  

Train_result {'acc': [0.7351362099149414], 'loss': [0.5672401150336297]}
Saved model to disk



11

Epoch 1/1

   64/15087 [..............................] - ETA: 0s - loss: 0.6349 - acc: 0.6406
  960/15087 [>.............................] - ETA: 0s - loss: 0.5462 - acc: 0.7521
 1792/15087 [==>...........................] - ETA: 0s - loss: 0.5611 - acc: 0.7478
 2624/15087 [====>.........................] - ETA: 0s - loss: 0.5664 - acc: 0.7439
 3456/15087 [=====>........................] - ETA: 0s - loss: 0.5610 - acc: 0.7390
 4352/15087 [=======>......................] - ETA: 0s - loss: 0.5575 - acc: 0.7390
 5184/15087 [=========>....................] - ETA: 0s - loss: 0.5672 - acc: 0.7355
 6016/15087 [==========>...................] - ETA: 0s - loss: 0.5693 - acc: 0.7349
 6848/15087 [============>.................] - ETA: 0s - loss: 0.5668 - acc: 0.7341
 7680/15087 [==============>...............] - ETA: 0s - loss: 0.5666 - acc: 0.7353
 8512/15087 [===============>..............] - ETA: 0s - loss: 0.5662 - acc: 0.7352
 9344/15087 [=================>............] - ETA: 0s - loss: 0.5618 - acc: 0.7378
10176/15087 [===================>..........] - ETA: 0s - loss: 0.5640 - acc: 0.7381
11008/15087 [====================>.........] - ETA: 0s - loss: 0.5610 - acc: 0.7386
11840/15087 [======================>.......] - ETA: 0s - loss: 0.5637 - acc: 0.7379
12608/15087 [========================>.....] - ETA: 0s - loss: 0.5681 - acc: 0.7372
13440/15087 [=========================>....] - ETA: 0s - loss: 0.5683 - acc: 0.7363
14272/15087 [===========================>..] - ETA: 0s - loss: 0.5697 - acc: 0.7342
15087/15087 [==============================] - 1s 62us/step - loss: 0.5697 - acc: 0.7350

Test accuracy: 65.95611285266457

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1281

choose_one :  314

F1score :  0.5112511251125113

AUC : 0.8515595764819829

Confusion Matrix
[[768  30]
 [513 284]]
True label 0
0.9624060150375939  
0.03759398496240601  
True label 1
0.64366373902133  
0.35633626097867  

Train_result {'acc': [0.7350036454317687], 'loss': [0.5697164046540762]}
Saved model to disk



12

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.5660 - acc: 0.7188
  896/15087 [>.............................] - ETA: 0s - loss: 0.5449 - acc: 0.7411
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5594 - acc: 0.7448
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.5566 - acc: 0.7441
 3392/15087 [=====>........................] - ETA: 0s - loss: 0.5531 - acc: 0.7462
 4160/15087 [=======>......................] - ETA: 0s - loss: 0.5587 - acc: 0.7435
 4928/15087 [========>.....................] - ETA: 0s - loss: 0.5661 - acc: 0.7384
 5760/15087 [==========>...................] - ETA: 0s - loss: 0.5695 - acc: 0.7365
 6592/15087 [============>.................] - ETA: 0s - loss: 0.5674 - acc: 0.7373
 7360/15087 [=============>................] - ETA: 0s - loss: 0.5656 - acc: 0.7360
 8192/15087 [===============>..............] - ETA: 0s - loss: 0.5651 - acc: 0.7358
 9024/15087 [================>.............] - ETA: 0s - loss: 0.5625 - acc: 0.7375
 9856/15087 [==================>...........] - ETA: 0s - loss: 0.5632 - acc: 0.7388
10688/15087 [====================>.........] - ETA: 0s - loss: 0.5658 - acc: 0.7365
11520/15087 [=====================>........] - ETA: 0s - loss: 0.5637 - acc: 0.7382
12288/15087 [=======================>......] - ETA: 0s - loss: 0.5629 - acc: 0.7407
13056/15087 [========================>.....] - ETA: 0s - loss: 0.5612 - acc: 0.7407
13888/15087 [==========================>...] - ETA: 0s - loss: 0.5630 - acc: 0.7412
14720/15087 [============================>.] - ETA: 0s - loss: 0.5597 - acc: 0.7424
15087/15087 [==============================] - 1s 64us/step - loss: 0.5605 - acc: 0.7427

Test accuracy: 77.05329153605017

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  802

choose_one :  793

F1score :  0.769811320754717

AUC : 0.8522246645471898

Confusion Matrix
[[617 181]
 [185 612]]
True label 0
0.7731829573934837  
0.22681704260651628  
True label 1
0.23212045169385195  
0.767879548306148  

Train_result {'acc': [0.7426923842508181], 'loss': [0.5605353435417874]}
Saved model to disk



13

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.4328 - acc: 0.8281
  896/15087 [>.............................] - ETA: 0s - loss: 0.5387 - acc: 0.7467
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5450 - acc: 0.7448
 2496/15087 [===>..........................] - ETA: 0s - loss: 0.5581 - acc: 0.7392
 3328/15087 [=====>........................] - ETA: 0s - loss: 0.5586 - acc: 0.7386
 4096/15087 [=======>......................] - ETA: 0s - loss: 0.5548 - acc: 0.7393
 4928/15087 [========>.....................] - ETA: 0s - loss: 0.5560 - acc: 0.7394
 5696/15087 [==========>...................] - ETA: 0s - loss: 0.5573 - acc: 0.7402
 6528/15087 [===========>..................] - ETA: 0s - loss: 0.5554 - acc: 0.7420
 7360/15087 [=============>................] - ETA: 0s - loss: 0.5580 - acc: 0.7387
 8192/15087 [===============>..............] - ETA: 0s - loss: 0.5555 - acc: 0.7399
 8960/15087 [================>.............] - ETA: 0s - loss: 0.5543 - acc: 0.7412
 9728/15087 [==================>...........] - ETA: 0s - loss: 0.5560 - acc: 0.7419
10560/15087 [===================>..........] - ETA: 0s - loss: 0.5593 - acc: 0.7415
11392/15087 [=====================>........] - ETA: 0s - loss: 0.5578 - acc: 0.7439
12224/15087 [=======================>......] - ETA: 0s - loss: 0.5580 - acc: 0.7439
13120/15087 [=========================>....] - ETA: 0s - loss: 0.5595 - acc: 0.7438
14016/15087 [==========================>...] - ETA: 0s - loss: 0.5592 - acc: 0.7448
14848/15087 [============================>.] - ETA: 0s - loss: 0.5603 - acc: 0.7458
15087/15087 [==============================] - 1s 64us/step - loss: 0.5607 - acc: 0.7453

Test accuracy: 76.92789968652038

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  844

choose_one :  751

F1score :  0.7622739018087855

AUC : 0.8495171429200354

Confusion Matrix
[[637 161]
 [207 590]]
True label 0
0.7982456140350878  
0.20175438596491227  
True label 1
0.25972396486825594  
0.740276035131744  

Train_result {'acc': [0.7452773910563738], 'loss': [0.5606537252800866]}
Saved model to disk



14

Epoch 1/1

   64/15087 [..............................] - ETA: 0s - loss: 0.5331 - acc: 0.7500
  960/15087 [>.............................] - ETA: 0s - loss: 0.5814 - acc: 0.7125
 1792/15087 [==>...........................] - ETA: 0s - loss: 0.5701 - acc: 0.7288
 2688/15087 [====>.........................] - ETA: 0s - loss: 0.5641 - acc: 0.7362
 3520/15087 [=====>........................] - ETA: 0s - loss: 0.5830 - acc: 0.7267
 4416/15087 [=======>......................] - ETA: 0s - loss: 0.5785 - acc: 0.7280
 5248/15087 [=========>....................] - ETA: 0s - loss: 0.5705 - acc: 0.7298
 6080/15087 [===========>..................] - ETA: 0s - loss: 0.5734 - acc: 0.7266
 6912/15087 [============>.................] - ETA: 0s - loss: 0.5753 - acc: 0.7270
 7744/15087 [==============>...............] - ETA: 0s - loss: 0.5713 - acc: 0.7292
 8576/15087 [================>.............] - ETA: 0s - loss: 0.5695 - acc: 0.7305
 9408/15087 [=================>............] - ETA: 0s - loss: 0.5694 - acc: 0.7318
10240/15087 [===================>..........] - ETA: 0s - loss: 0.5675 - acc: 0.7334
11072/15087 [=====================>........] - ETA: 0s - loss: 0.5693 - acc: 0.7318
11904/15087 [======================>.......] - ETA: 0s - loss: 0.5640 - acc: 0.7354
12736/15087 [========================>.....] - ETA: 0s - loss: 0.5658 - acc: 0.7348
13568/15087 [=========================>....] - ETA: 0s - loss: 0.5636 - acc: 0.7359
14400/15087 [===========================>..] - ETA: 0s - loss: 0.5660 - acc: 0.7355
15087/15087 [==============================] - 1s 63us/step - loss: 0.5649 - acc: 0.7364

Test accuracy: 76.8025078369906

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  800

choose_one :  795

F1score :  0.7675879396984926

AUC : 0.8562151929384314

Confusion Matrix
[[614 184]
 [186 611]]
True label 0
0.7694235588972431  
0.23057644110275688  
True label 1
0.23337515683814303  
0.766624843161857  

Train_result {'acc': [0.7363955724260683], 'loss': [0.5649120000810124]}
Saved model to disk



15

Epoch 1/1

   64/15087 [..............................] - ETA: 1s - loss: 0.7177 - acc: 0.7031
  896/15087 [>.............................] - ETA: 0s - loss: 0.5604 - acc: 0.7321
 1728/15087 [==>...........................] - ETA: 0s - loss: 0.5702 - acc: 0.7367
 2560/15087 [====>.........................] - ETA: 0s - loss: 0.5697 - acc: 0.7340
 3328/15087 [=====>........................] - ETA: 0s - loss: 0.5580 - acc: 0.7398
 4096/15087 [=======>......................] - ETA: 0s - loss: 0.5577 - acc: 0.7422
 4864/15087 [========>.....................] - ETA: 0s - loss: 0.5648 - acc: 0.7385
 5632/15087 [==========>...................] - ETA: 0s - loss: 0.5612 - acc: 0.7424
 6464/15087 [===========>..................] - ETA: 0s - loss: 0.5624 - acc: 0.7410
 7232/15087 [=============>................] - ETA: 0s - loss: 0.5608 - acc: 0.7406
 8000/15087 [==============>...............] - ETA: 0s - loss: 0.5586 - acc: 0.7442
 8768/15087 [================>.............] - ETA: 0s - loss: 0.5603 - acc: 0.7446
 9600/15087 [==================>...........] - ETA: 0s - loss: 0.5572 - acc: 0.7458
10432/15087 [===================>..........] - ETA: 0s - loss: 0.5587 - acc: 0.7437
11264/15087 [=====================>........] - ETA: 0s - loss: 0.5587 - acc: 0.7442
12096/15087 [=======================>......] - ETA: 0s - loss: 0.5559 - acc: 0.7466
12928/15087 [========================>.....] - ETA: 0s - loss: 0.5556 - acc: 0.7471
13760/15087 [==========================>...] - ETA: 0s - loss: 0.5578 - acc: 0.7449
14656/15087 [============================>.] - ETA: 0s - loss: 0.5602 - acc: 0.7432
15087/15087 [==============================] - 1s 64us/step - loss: 0.5594 - acc: 0.7436

Test accuracy: 72.97805642633229

data size :  16682

zero :  8342

one :  8340

train_zero :  7544

train_one :  7543

test_zero :  798

test_one :  797

choose_zero :  1031

choose_one :  564

F1score :  0.6833210874357091

AUC : 0.8485155800416978

Confusion Matrix
[[699  99]
 [332 465]]
True label 0
0.8759398496240601  
0.12406015037593984  
True label 1
0.41656210790464243  
0.5834378920953576  

Train_result {'acc': [0.7435540532215599], 'loss': [0.5594072538645484]}
Saved model to disk



[[59.686520376175544, 1], [73.29153605015674, 2], [67.7115987460815, 3], [70.53291536050156, 4], [73.60501567398119, 5], [75.36050156739812, 6], [75.61128526645768, 7], [75.98746081504703, 8], [76.99059561128526, 9], [58.87147335423197, 10], [65.95611285266457, 11], [77.05329153605017, 12], [76.92789968652038, 13], [76.8025078369906, 14], [72.97805642633229, 15]]
max accuracy :  [77.05329153605017, 12]

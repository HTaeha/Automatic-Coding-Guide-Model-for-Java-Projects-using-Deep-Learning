Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_balanced_auto_logging.py:389: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-17 21:02:45.919086: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-17 21:02:45.930052: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-17 21:02:45.932579: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6741640 executing computations on platform Host. Devices:
2019-08-17 21:02:45.932620: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22976
Over 200, Under 400 : 1162
Over 400 : 0


Test_zero:  1874
Train_zero:  16897
zero:  18771
Test_one:  764
Train_one:  7241
one:  8005

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 200)       0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 1, 200)       0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

   64/14483 [..............................] - ETA: 5:29 - loss: 0.6525 - acc: 0.6562
  576/14483 [>.............................] - ETA: 36s - loss: 0.6587 - acc: 0.6337 
 1152/14483 [=>............................] - ETA: 18s - loss: 0.6430 - acc: 0.6441
 1792/14483 [==>...........................] - ETA: 11s - loss: 0.6301 - acc: 0.6579
 2496/14483 [====>.........................] - ETA: 8s - loss: 0.6254 - acc: 0.6571 
 3200/14483 [=====>........................] - ETA: 6s - loss: 0.6269 - acc: 0.6538
 3904/14483 [=======>......................] - ETA: 4s - loss: 0.6209 - acc: 0.6588
 4608/14483 [========>.....................] - ETA: 3s - loss: 0.6134 - acc: 0.6669
 5312/14483 [==========>...................] - ETA: 3s - loss: 0.6119 - acc: 0.6685
 5952/14483 [===========>..................] - ETA: 2s - loss: 0.6086 - acc: 0.6692
 6656/14483 [============>.................] - ETA: 2s - loss: 0.6103 - acc: 0.6668
 7360/14483 [==============>...............] - ETA: 1s - loss: 0.6090 - acc: 0.6637
 8064/14483 [===============>..............] - ETA: 1s - loss: 0.6084 - acc: 0.6643
 8768/14483 [=================>............] - ETA: 1s - loss: 0.6056 - acc: 0.6661
 9408/14483 [==================>...........] - ETA: 1s - loss: 0.6037 - acc: 0.6679
10048/14483 [===================>..........] - ETA: 0s - loss: 0.6034 - acc: 0.6692
10752/14483 [=====================>........] - ETA: 0s - loss: 0.6036 - acc: 0.6695
11520/14483 [======================>.......] - ETA: 0s - loss: 0.6034 - acc: 0.6710
12224/14483 [========================>.....] - ETA: 0s - loss: 0.6013 - acc: 0.6728
12928/14483 [=========================>....] - ETA: 0s - loss: 0.6005 - acc: 0.6726
13632/14483 [===========================>..] - ETA: 0s - loss: 0.5989 - acc: 0.6731
14336/14483 [============================>.] - ETA: 0s - loss: 0.5980 - acc: 0.6742
14483/14483 [==============================] - 3s 179us/step - loss: 0.5973 - acc: 0.6749

Test accuracy: 69.7187704381949

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  974

choose_one :  555

F1score :  0.6489764973464747

AUC : 0.8134260685076822

Confusion Matrix
[[638 127]
 [336 428]]
True label 0
0.8339869281045752  
0.16601307189542483  
True label 1
0.4397905759162304  
0.5602094240837696  

Train_result {'loss': [0.5973468024716031], 'acc': [0.674929227386482]}
Saved model to disk



2

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4833 - acc: 0.7969
  640/14483 [>.............................] - ETA: 1s - loss: 0.5614 - acc: 0.7312
 1280/14483 [=>............................] - ETA: 1s - loss: 0.5480 - acc: 0.7352
 1920/14483 [==>...........................] - ETA: 1s - loss: 0.5570 - acc: 0.7266
 2624/14483 [====>.........................] - ETA: 0s - loss: 0.5522 - acc: 0.7275
 3264/14483 [=====>........................] - ETA: 0s - loss: 0.5567 - acc: 0.7194
 3904/14483 [=======>......................] - ETA: 0s - loss: 0.5604 - acc: 0.7170
 4544/14483 [========>.....................] - ETA: 0s - loss: 0.5590 - acc: 0.7163
 5248/14483 [=========>....................] - ETA: 0s - loss: 0.5609 - acc: 0.7117
 5952/14483 [===========>..................] - ETA: 0s - loss: 0.5636 - acc: 0.7097
 6656/14483 [============>.................] - ETA: 0s - loss: 0.5673 - acc: 0.7051
 7360/14483 [==============>...............] - ETA: 0s - loss: 0.5633 - acc: 0.7067
 8064/14483 [===============>..............] - ETA: 0s - loss: 0.5649 - acc: 0.7060
 8768/14483 [=================>............] - ETA: 0s - loss: 0.5645 - acc: 0.7067
 9408/14483 [==================>...........] - ETA: 0s - loss: 0.5631 - acc: 0.7076
10048/14483 [===================>..........] - ETA: 0s - loss: 0.5621 - acc: 0.7082
10752/14483 [=====================>........] - ETA: 0s - loss: 0.5628 - acc: 0.7077
11456/14483 [======================>.......] - ETA: 0s - loss: 0.5618 - acc: 0.7084
12160/14483 [========================>.....] - ETA: 0s - loss: 0.5633 - acc: 0.7078
12864/14483 [=========================>....] - ETA: 0s - loss: 0.5629 - acc: 0.7088
13632/14483 [===========================>..] - ETA: 0s - loss: 0.5650 - acc: 0.7065
14400/14483 [============================>.] - ETA: 0s - loss: 0.5640 - acc: 0.7067
14483/14483 [==============================] - 1s 77us/step - loss: 0.5647 - acc: 0.7063

Test accuracy: 73.31589274035318

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  599

choose_one :  930

F1score :  0.7591499409681229

AUC : 0.8311150463675873

Confusion Matrix
[[478 287]
 [121 643]]
True label 0
0.6248366013071895  
0.37516339869281046  
True label 1
0.15837696335078533  
0.8416230366492147  

Train_result {'loss': [0.5646985529174151], 'acc': [0.7063453704219558]}
Saved model to disk



3

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.6324 - acc: 0.6406
  704/14483 [>.............................] - ETA: 1s - loss: 0.5669 - acc: 0.6960
 1344/14483 [=>............................] - ETA: 1s - loss: 0.5688 - acc: 0.6942
 1984/14483 [===>..........................] - ETA: 1s - loss: 0.5617 - acc: 0.7051
 2624/14483 [====>.........................] - ETA: 0s - loss: 0.5537 - acc: 0.7119
 3328/14483 [=====>........................] - ETA: 0s - loss: 0.5491 - acc: 0.7181
 4032/14483 [=======>......................] - ETA: 0s - loss: 0.5516 - acc: 0.7153
 4672/14483 [========>.....................] - ETA: 0s - loss: 0.5523 - acc: 0.7158
 5312/14483 [==========>...................] - ETA: 0s - loss: 0.5537 - acc: 0.7172
 5952/14483 [===========>..................] - ETA: 0s - loss: 0.5544 - acc: 0.7149
 6592/14483 [============>.................] - ETA: 0s - loss: 0.5541 - acc: 0.7128
 7296/14483 [==============>...............] - ETA: 0s - loss: 0.5557 - acc: 0.7124
 7936/14483 [===============>..............] - ETA: 0s - loss: 0.5513 - acc: 0.7142
 8576/14483 [================>.............] - ETA: 0s - loss: 0.5511 - acc: 0.7133
 9216/14483 [==================>...........] - ETA: 0s - loss: 0.5492 - acc: 0.7155
 9920/14483 [===================>..........] - ETA: 0s - loss: 0.5494 - acc: 0.7166
10624/14483 [=====================>........] - ETA: 0s - loss: 0.5464 - acc: 0.7202
11264/14483 [======================>.......] - ETA: 0s - loss: 0.5464 - acc: 0.7203
11904/14483 [=======================>......] - ETA: 0s - loss: 0.5471 - acc: 0.7183
12544/14483 [========================>.....] - ETA: 0s - loss: 0.5477 - acc: 0.7180
13120/14483 [==========================>...] - ETA: 0s - loss: 0.5473 - acc: 0.7179
13760/14483 [===========================>..] - ETA: 0s - loss: 0.5476 - acc: 0.7185
14400/14483 [============================>.] - ETA: 0s - loss: 0.5489 - acc: 0.7181
14483/14483 [==============================] - 1s 81us/step - loss: 0.5482 - acc: 0.7186

Test accuracy: 74.62393721386528

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  757

choose_one :  772

F1score :  0.7473958333333334

AUC : 0.8294947472880949

Confusion Matrix
[[567 198]
 [190 574]]
True label 0
0.7411764705882353  
0.25882352941176473  
True label 1
0.2486910994764398  
0.7513089005235603  

Train_result {'loss': [0.5481622424119416], 'acc': [0.718566595306303]}
Saved model to disk



4

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5750 - acc: 0.7188
  640/14483 [>.............................] - ETA: 1s - loss: 0.5712 - acc: 0.7094
 1344/14483 [=>............................] - ETA: 1s - loss: 0.5606 - acc: 0.7031
 2048/14483 [===>..........................] - ETA: 0s - loss: 0.5473 - acc: 0.7217
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5430 - acc: 0.7300
 3520/14483 [======>.......................] - ETA: 0s - loss: 0.5482 - acc: 0.7253
 4160/14483 [=======>......................] - ETA: 0s - loss: 0.5467 - acc: 0.7274
 4800/14483 [========>.....................] - ETA: 0s - loss: 0.5427 - acc: 0.7319
 5504/14483 [==========>...................] - ETA: 0s - loss: 0.5443 - acc: 0.7298
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5460 - acc: 0.7282
 6784/14483 [=============>................] - ETA: 0s - loss: 0.5446 - acc: 0.7286
 7424/14483 [==============>...............] - ETA: 0s - loss: 0.5445 - acc: 0.7274
 8064/14483 [===============>..............] - ETA: 0s - loss: 0.5434 - acc: 0.7273
 8704/14483 [=================>............] - ETA: 0s - loss: 0.5420 - acc: 0.7273
 9280/14483 [==================>...........] - ETA: 0s - loss: 0.5400 - acc: 0.7280
 9920/14483 [===================>..........] - ETA: 0s - loss: 0.5404 - acc: 0.7280
10624/14483 [=====================>........] - ETA: 0s - loss: 0.5409 - acc: 0.7275
11264/14483 [======================>.......] - ETA: 0s - loss: 0.5393 - acc: 0.7283
11968/14483 [=======================>......] - ETA: 0s - loss: 0.5397 - acc: 0.7281
12608/14483 [=========================>....] - ETA: 0s - loss: 0.5402 - acc: 0.7280
13248/14483 [==========================>...] - ETA: 0s - loss: 0.5403 - acc: 0.7281
13952/14483 [===========================>..] - ETA: 0s - loss: 0.5418 - acc: 0.7270
14483/14483 [==============================] - 1s 79us/step - loss: 0.5414 - acc: 0.7280

Test accuracy: 75.60497056899933

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  562

choose_one :  967

F1score :  0.7845176198729058

AUC : 0.8465763268658247

Confusion Matrix
[[477 288]
 [ 85 679]]
True label 0
0.6235294117647059  
0.3764705882352941  
True label 1
0.11125654450261781  
0.8887434554973822  

Train_result {'loss': [0.5414482848647384], 'acc': [0.727956915032606]}
Saved model to disk



5

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4662 - acc: 0.7500
  704/14483 [>.............................] - ETA: 1s - loss: 0.5026 - acc: 0.7500
 1408/14483 [=>............................] - ETA: 1s - loss: 0.5203 - acc: 0.7436
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.5363 - acc: 0.7296
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5401 - acc: 0.7253
 3456/14483 [======>.......................] - ETA: 0s - loss: 0.5363 - acc: 0.7280
 4160/14483 [=======>......................] - ETA: 0s - loss: 0.5343 - acc: 0.7300
 4800/14483 [========>.....................] - ETA: 0s - loss: 0.5338 - acc: 0.7315
 5440/14483 [==========>...................] - ETA: 0s - loss: 0.5382 - acc: 0.7285
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5348 - acc: 0.7324
 6848/14483 [=============>................] - ETA: 0s - loss: 0.5347 - acc: 0.7319
 7552/14483 [==============>...............] - ETA: 0s - loss: 0.5359 - acc: 0.7312
 8256/14483 [================>.............] - ETA: 0s - loss: 0.5362 - acc: 0.7309
 8960/14483 [=================>............] - ETA: 0s - loss: 0.5368 - acc: 0.7300
 9664/14483 [===================>..........] - ETA: 0s - loss: 0.5383 - acc: 0.7289
10368/14483 [====================>.........] - ETA: 0s - loss: 0.5386 - acc: 0.7278
11072/14483 [=====================>........] - ETA: 0s - loss: 0.5396 - acc: 0.7260
11840/14483 [=======================>......] - ETA: 0s - loss: 0.5387 - acc: 0.7274
12480/14483 [========================>.....] - ETA: 0s - loss: 0.5369 - acc: 0.7294
13184/14483 [==========================>...] - ETA: 0s - loss: 0.5369 - acc: 0.7296
13888/14483 [===========================>..] - ETA: 0s - loss: 0.5366 - acc: 0.7297
14483/14483 [==============================] - 1s 77us/step - loss: 0.5361 - acc: 0.7305

Test accuracy: 76.65140614780903

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  774

choose_one :  755

F1score :  0.7649769585253456

AUC : 0.8458748246244396

Confusion Matrix
[[591 174]
 [183 581]]
True label 0
0.7725490196078432  
0.22745098039215686  
True label 1
0.2395287958115183  
0.7604712041884817  

Train_result {'loss': [0.5361123253633606], 'acc': [0.730511634338135]}
Saved model to disk



6

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5451 - acc: 0.6719
  704/14483 [>.............................] - ETA: 1s - loss: 0.5325 - acc: 0.7287
 1408/14483 [=>............................] - ETA: 1s - loss: 0.5291 - acc: 0.7202
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.5322 - acc: 0.7235
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5312 - acc: 0.7224
 3392/14483 [======>.......................] - ETA: 0s - loss: 0.5313 - acc: 0.7220
 4096/14483 [=======>......................] - ETA: 0s - loss: 0.5243 - acc: 0.7300
 4800/14483 [========>.....................] - ETA: 0s - loss: 0.5243 - acc: 0.7325
 5440/14483 [==========>...................] - ETA: 0s - loss: 0.5279 - acc: 0.7298
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5317 - acc: 0.7266
 6848/14483 [=============>................] - ETA: 0s - loss: 0.5299 - acc: 0.7282
 7552/14483 [==============>...............] - ETA: 0s - loss: 0.5284 - acc: 0.7304
 8192/14483 [===============>..............] - ETA: 0s - loss: 0.5287 - acc: 0.7314
 8896/14483 [=================>............] - ETA: 0s - loss: 0.5308 - acc: 0.7291
 9536/14483 [==================>...........] - ETA: 0s - loss: 0.5316 - acc: 0.7278
10176/14483 [====================>.........] - ETA: 0s - loss: 0.5316 - acc: 0.7290
10816/14483 [=====================>........] - ETA: 0s - loss: 0.5314 - acc: 0.7287
11520/14483 [======================>.......] - ETA: 0s - loss: 0.5322 - acc: 0.7289
12224/14483 [========================>.....] - ETA: 0s - loss: 0.5330 - acc: 0.7289
12864/14483 [=========================>....] - ETA: 0s - loss: 0.5326 - acc: 0.7292
13568/14483 [===========================>..] - ETA: 0s - loss: 0.5323 - acc: 0.7294
14272/14483 [============================>.] - ETA: 0s - loss: 0.5331 - acc: 0.7291
14483/14483 [==============================] - 1s 78us/step - loss: 0.5331 - acc: 0.7294

Test accuracy: 75.27795945062132

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  673

choose_one :  856

F1score :  0.7666666666666667

AUC : 0.8446548951168601

Confusion Matrix
[[530 235]
 [143 621]]
True label 0
0.6928104575163399  
0.30718954248366015  
True label 1
0.18717277486910994  
0.81282722513089  

Train_result {'loss': [0.5330684997960858], 'acc': [0.7294068908457646]}
Saved model to disk



7

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5967 - acc: 0.7500
  704/14483 [>.............................] - ETA: 1s - loss: 0.5738 - acc: 0.7031
 1408/14483 [=>............................] - ETA: 1s - loss: 0.5541 - acc: 0.7244
 2048/14483 [===>..........................] - ETA: 0s - loss: 0.5538 - acc: 0.7256
 2688/14483 [====>.........................] - ETA: 0s - loss: 0.5536 - acc: 0.7202
 3392/14483 [======>.......................] - ETA: 0s - loss: 0.5488 - acc: 0.7252
 4032/14483 [=======>......................] - ETA: 0s - loss: 0.5447 - acc: 0.7287
 4672/14483 [========>.....................] - ETA: 0s - loss: 0.5450 - acc: 0.7301
 5312/14483 [==========>...................] - ETA: 0s - loss: 0.5417 - acc: 0.7314
 5952/14483 [===========>..................] - ETA: 0s - loss: 0.5367 - acc: 0.7349
 6656/14483 [============>.................] - ETA: 0s - loss: 0.5366 - acc: 0.7332
 7360/14483 [==============>...............] - ETA: 0s - loss: 0.5329 - acc: 0.7364
 8064/14483 [===============>..............] - ETA: 0s - loss: 0.5320 - acc: 0.7374
 8768/14483 [=================>............] - ETA: 0s - loss: 0.5306 - acc: 0.7368
 9472/14483 [==================>...........] - ETA: 0s - loss: 0.5310 - acc: 0.7368
10176/14483 [====================>.........] - ETA: 0s - loss: 0.5321 - acc: 0.7364
10880/14483 [=====================>........] - ETA: 0s - loss: 0.5310 - acc: 0.7370
11584/14483 [======================>.......] - ETA: 0s - loss: 0.5295 - acc: 0.7384
12288/14483 [========================>.....] - ETA: 0s - loss: 0.5274 - acc: 0.7400
12928/14483 [=========================>....] - ETA: 0s - loss: 0.5274 - acc: 0.7389
13632/14483 [===========================>..] - ETA: 0s - loss: 0.5260 - acc: 0.7400
14272/14483 [============================>.] - ETA: 0s - loss: 0.5263 - acc: 0.7396
14483/14483 [==============================] - 1s 78us/step - loss: 0.5263 - acc: 0.7396

Test accuracy: 76.52060170045782

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  630

choose_one :  899

F1score :  0.7841250751653639

AUC : 0.8513345652397085

Confusion Matrix
[[518 247]
 [112 652]]
True label 0
0.677124183006536  
0.32287581699346407  
True label 1
0.14659685863874344  
0.8534031413612565  

Train_result {'loss': [0.5263214974099494], 'acc': [0.7395567217107258]}
Saved model to disk



8

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5016 - acc: 0.7188
  704/14483 [>.............................] - ETA: 1s - loss: 0.5189 - acc: 0.7528
 1408/14483 [=>............................] - ETA: 1s - loss: 0.5401 - acc: 0.7259
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.5393 - acc: 0.7287
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5372 - acc: 0.7311
 3392/14483 [======>.......................] - ETA: 0s - loss: 0.5322 - acc: 0.7338
 4032/14483 [=======>......................] - ETA: 0s - loss: 0.5364 - acc: 0.7321
 4736/14483 [========>.....................] - ETA: 0s - loss: 0.5309 - acc: 0.7363
 5440/14483 [==========>...................] - ETA: 0s - loss: 0.5335 - acc: 0.7347
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5319 - acc: 0.7362
 6848/14483 [=============>................] - ETA: 0s - loss: 0.5287 - acc: 0.7404
 7552/14483 [==============>...............] - ETA: 0s - loss: 0.5287 - acc: 0.7406
 8256/14483 [================>.............] - ETA: 0s - loss: 0.5316 - acc: 0.7375
 8896/14483 [=================>............] - ETA: 0s - loss: 0.5323 - acc: 0.7363
 9536/14483 [==================>...........] - ETA: 0s - loss: 0.5308 - acc: 0.7380
10240/14483 [====================>.........] - ETA: 0s - loss: 0.5350 - acc: 0.7341
10944/14483 [=====================>........] - ETA: 0s - loss: 0.5320 - acc: 0.7357
11648/14483 [=======================>......] - ETA: 0s - loss: 0.5318 - acc: 0.7357
12352/14483 [========================>.....] - ETA: 0s - loss: 0.5314 - acc: 0.7363
13056/14483 [==========================>...] - ETA: 0s - loss: 0.5311 - acc: 0.7352
13760/14483 [===========================>..] - ETA: 0s - loss: 0.5306 - acc: 0.7353
14400/14483 [============================>.] - ETA: 0s - loss: 0.5307 - acc: 0.7351
14483/14483 [==============================] - 1s 78us/step - loss: 0.5302 - acc: 0.7356

Test accuracy: 76.45519947678221

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  709

choose_one :  820

F1score :  0.7727272727272727

AUC : 0.8493558156246792

Confusion Matrix
[[557 208]
 [152 612]]
True label 0
0.7281045751633987  
0.2718954248366013  
True label 1
0.19895287958115182  
0.8010471204188482  

Train_result {'loss': [0.5302132929358324], 'acc': [0.7356210730191564]}
Saved model to disk



9

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5555 - acc: 0.7969
  704/14483 [>.............................] - ETA: 1s - loss: 0.5484 - acc: 0.7244
 1344/14483 [=>............................] - ETA: 1s - loss: 0.5260 - acc: 0.7366
 2048/14483 [===>..........................] - ETA: 0s - loss: 0.5250 - acc: 0.7363
 2688/14483 [====>.........................] - ETA: 0s - loss: 0.5227 - acc: 0.7392
 3392/14483 [======>.......................] - ETA: 0s - loss: 0.5285 - acc: 0.7356
 4096/14483 [=======>......................] - ETA: 0s - loss: 0.5308 - acc: 0.7329
 4800/14483 [========>.....................] - ETA: 0s - loss: 0.5275 - acc: 0.7365
 5504/14483 [==========>...................] - ETA: 0s - loss: 0.5239 - acc: 0.7400
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5215 - acc: 0.7425
 6784/14483 [=============>................] - ETA: 0s - loss: 0.5220 - acc: 0.7429
 7424/14483 [==============>...............] - ETA: 0s - loss: 0.5250 - acc: 0.7404
 8128/14483 [===============>..............] - ETA: 0s - loss: 0.5268 - acc: 0.7384
 8768/14483 [=================>............] - ETA: 0s - loss: 0.5261 - acc: 0.7398
 9472/14483 [==================>...........] - ETA: 0s - loss: 0.5270 - acc: 0.7397
10112/14483 [===================>..........] - ETA: 0s - loss: 0.5256 - acc: 0.7395
10752/14483 [=====================>........] - ETA: 0s - loss: 0.5231 - acc: 0.7404
11392/14483 [======================>.......] - ETA: 0s - loss: 0.5231 - acc: 0.7406
12032/14483 [=======================>......] - ETA: 0s - loss: 0.5201 - acc: 0.7428
12672/14483 [=========================>....] - ETA: 0s - loss: 0.5203 - acc: 0.7431
13312/14483 [==========================>...] - ETA: 0s - loss: 0.5208 - acc: 0.7427
13952/14483 [===========================>..] - ETA: 0s - loss: 0.5202 - acc: 0.7430
14483/14483 [==============================] - 1s 79us/step - loss: 0.5196 - acc: 0.7431

Test accuracy: 77.50163505559189

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  847

choose_one :  682

F1score :  0.7621023513139695

AUC : 0.8595044998802314

Confusion Matrix
[[634 131]
 [213 551]]
True label 0
0.8287581699346406  
0.17124183006535948  
True label 1
0.2787958115183246  
0.7212041884816754  

Train_result {'loss': [0.5196358859806539], 'acc': [0.743147138040352]}
Saved model to disk



10

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4932 - acc: 0.7969
  704/14483 [>.............................] - ETA: 1s - loss: 0.5194 - acc: 0.7443
 1408/14483 [=>............................] - ETA: 1s - loss: 0.5241 - acc: 0.7408
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.5186 - acc: 0.7420
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5190 - acc: 0.7424
 3456/14483 [======>.......................] - ETA: 0s - loss: 0.5137 - acc: 0.7471
 4160/14483 [=======>......................] - ETA: 0s - loss: 0.5125 - acc: 0.7478
 4864/14483 [=========>....................] - ETA: 0s - loss: 0.5162 - acc: 0.7428
 5568/14483 [==========>...................] - ETA: 0s - loss: 0.5162 - acc: 0.7414
 6272/14483 [===========>..................] - ETA: 0s - loss: 0.5168 - acc: 0.7398
 6976/14483 [=============>................] - ETA: 0s - loss: 0.5173 - acc: 0.7408
 7680/14483 [==============>...............] - ETA: 0s - loss: 0.5168 - acc: 0.7424
 8384/14483 [================>.............] - ETA: 0s - loss: 0.5184 - acc: 0.7426
 9088/14483 [=================>............] - ETA: 0s - loss: 0.5170 - acc: 0.7446
 9792/14483 [===================>..........] - ETA: 0s - loss: 0.5153 - acc: 0.7457
10496/14483 [====================>.........] - ETA: 0s - loss: 0.5154 - acc: 0.7459
11200/14483 [======================>.......] - ETA: 0s - loss: 0.5143 - acc: 0.7460
11904/14483 [=======================>......] - ETA: 0s - loss: 0.5149 - acc: 0.7456
12608/14483 [=========================>....] - ETA: 0s - loss: 0.5159 - acc: 0.7452
13376/14483 [==========================>...] - ETA: 0s - loss: 0.5155 - acc: 0.7451
14080/14483 [============================>.] - ETA: 0s - loss: 0.5156 - acc: 0.7454
14483/14483 [==============================] - 1s 76us/step - loss: 0.5158 - acc: 0.7447

Test accuracy: 77.43623283191629

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  736

choose_one :  793

F1score :  0.7784200385356455

AUC : 0.8567010573863052

Confusion Matrix
[[578 187]
 [158 606]]
True label 0
0.7555555555555555  
0.24444444444444444  
True label 1
0.20680628272251309  
0.7931937172774869  

Train_result {'loss': [0.5157650945957528], 'acc': [0.744735206781826]}
Saved model to disk



11

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4758 - acc: 0.7969
  768/14483 [>.............................] - ETA: 1s - loss: 0.4938 - acc: 0.7604
 1472/14483 [==>...........................] - ETA: 1s - loss: 0.4968 - acc: 0.7582
 2240/14483 [===>..........................] - ETA: 0s - loss: 0.5005 - acc: 0.7558
 2944/14483 [=====>........................] - ETA: 0s - loss: 0.4980 - acc: 0.7592
 3648/14483 [======>.......................] - ETA: 0s - loss: 0.5033 - acc: 0.7604
 4352/14483 [========>.....................] - ETA: 0s - loss: 0.5053 - acc: 0.7610
 5056/14483 [=========>....................] - ETA: 0s - loss: 0.5066 - acc: 0.7587
 5696/14483 [==========>...................] - ETA: 0s - loss: 0.5079 - acc: 0.7581
 6336/14483 [============>.................] - ETA: 0s - loss: 0.5063 - acc: 0.7596
 7040/14483 [=============>................] - ETA: 0s - loss: 0.5079 - acc: 0.7570
 7744/14483 [===============>..............] - ETA: 0s - loss: 0.5093 - acc: 0.7552
 8448/14483 [================>.............] - ETA: 0s - loss: 0.5110 - acc: 0.7539
 9152/14483 [=================>............] - ETA: 0s - loss: 0.5115 - acc: 0.7539
 9792/14483 [===================>..........] - ETA: 0s - loss: 0.5122 - acc: 0.7529
10432/14483 [====================>.........] - ETA: 0s - loss: 0.5130 - acc: 0.7514
11136/14483 [======================>.......] - ETA: 0s - loss: 0.5142 - acc: 0.7498
11840/14483 [=======================>......] - ETA: 0s - loss: 0.5150 - acc: 0.7494
12544/14483 [========================>.....] - ETA: 0s - loss: 0.5138 - acc: 0.7498
13184/14483 [==========================>...] - ETA: 0s - loss: 0.5138 - acc: 0.7497
13824/14483 [===========================>..] - ETA: 0s - loss: 0.5151 - acc: 0.7488
14483/14483 [==============================] - 1s 77us/step - loss: 0.5151 - acc: 0.7487

Test accuracy: 76.84761281883584

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  607

choose_one :  922

F1score :  0.7900355871886121

AUC : 0.8558301680183418

Confusion Matrix
[[509 256]
 [ 98 666]]
True label 0
0.665359477124183  
0.33464052287581697  
True label 1
0.12827225130890052  
0.8717277486910995  

Train_result {'loss': [0.5151307016954743], 'acc': [0.748739901962246]}
Saved model to disk



12

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5720 - acc: 0.7500
  640/14483 [>.............................] - ETA: 1s - loss: 0.5178 - acc: 0.7609
 1344/14483 [=>............................] - ETA: 1s - loss: 0.4998 - acc: 0.7671
 2048/14483 [===>..........................] - ETA: 0s - loss: 0.5166 - acc: 0.7480
 2688/14483 [====>.........................] - ETA: 0s - loss: 0.5153 - acc: 0.7463
 3328/14483 [=====>........................] - ETA: 0s - loss: 0.5192 - acc: 0.7431
 4032/14483 [=======>......................] - ETA: 0s - loss: 0.5181 - acc: 0.7443
 4736/14483 [========>.....................] - ETA: 0s - loss: 0.5145 - acc: 0.7456
 5440/14483 [==========>...................] - ETA: 0s - loss: 0.5155 - acc: 0.7474
 6144/14483 [===========>..................] - ETA: 0s - loss: 0.5162 - acc: 0.7458
 6848/14483 [=============>................] - ETA: 0s - loss: 0.5148 - acc: 0.7455
 7552/14483 [==============>...............] - ETA: 0s - loss: 0.5131 - acc: 0.7474
 8128/14483 [===============>..............] - ETA: 0s - loss: 0.5119 - acc: 0.7488
 8768/14483 [=================>............] - ETA: 0s - loss: 0.5122 - acc: 0.7502
 9408/14483 [==================>...........] - ETA: 0s - loss: 0.5115 - acc: 0.7509
10048/14483 [===================>..........] - ETA: 0s - loss: 0.5130 - acc: 0.7500
10688/14483 [=====================>........] - ETA: 0s - loss: 0.5112 - acc: 0.7515
11392/14483 [======================>.......] - ETA: 0s - loss: 0.5088 - acc: 0.7531
12096/14483 [========================>.....] - ETA: 0s - loss: 0.5080 - acc: 0.7531
12736/14483 [=========================>....] - ETA: 0s - loss: 0.5093 - acc: 0.7520
13376/14483 [==========================>...] - ETA: 0s - loss: 0.5096 - acc: 0.7522
14016/14483 [============================>.] - ETA: 0s - loss: 0.5094 - acc: 0.7527
14483/14483 [==============================] - 1s 79us/step - loss: 0.5093 - acc: 0.7525

Test accuracy: 76.2589928057554

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  616

choose_one :  913

F1score :  0.7835420393559929

AUC : 0.8524937549190706

Confusion Matrix
[[509 256]
 [107 657]]
True label 0
0.665359477124183  
0.33464052287581697  
True label 1
0.1400523560209424  
0.8599476439790575  

Train_result {'loss': [0.5092971951874433], 'acc': [0.7525374576966917]}
Saved model to disk



13

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4593 - acc: 0.7969
  704/14483 [>.............................] - ETA: 1s - loss: 0.4982 - acc: 0.7614
 1280/14483 [=>............................] - ETA: 1s - loss: 0.5077 - acc: 0.7570
 1984/14483 [===>..........................] - ETA: 1s - loss: 0.5147 - acc: 0.7480
 2688/14483 [====>.........................] - ETA: 0s - loss: 0.5127 - acc: 0.7474
 3392/14483 [======>.......................] - ETA: 0s - loss: 0.5130 - acc: 0.7485
 4032/14483 [=======>......................] - ETA: 0s - loss: 0.5131 - acc: 0.7485
 4672/14483 [========>.....................] - ETA: 0s - loss: 0.5100 - acc: 0.7498
 5312/14483 [==========>...................] - ETA: 0s - loss: 0.5112 - acc: 0.7494
 5952/14483 [===========>..................] - ETA: 0s - loss: 0.5139 - acc: 0.7466
 6592/14483 [============>.................] - ETA: 0s - loss: 0.5150 - acc: 0.7465
 7232/14483 [=============>................] - ETA: 0s - loss: 0.5132 - acc: 0.7488
 7936/14483 [===============>..............] - ETA: 0s - loss: 0.5121 - acc: 0.7499
 8640/14483 [================>.............] - ETA: 0s - loss: 0.5114 - acc: 0.7519
 9280/14483 [==================>...........] - ETA: 0s - loss: 0.5131 - acc: 0.7502
 9920/14483 [===================>..........] - ETA: 0s - loss: 0.5114 - acc: 0.7511
10624/14483 [=====================>........] - ETA: 0s - loss: 0.5110 - acc: 0.7519
11264/14483 [======================>.......] - ETA: 0s - loss: 0.5125 - acc: 0.7499
11968/14483 [=======================>......] - ETA: 0s - loss: 0.5155 - acc: 0.7472
12672/14483 [=========================>....] - ETA: 0s - loss: 0.5155 - acc: 0.7480
13376/14483 [==========================>...] - ETA: 0s - loss: 0.5154 - acc: 0.7475
14080/14483 [============================>.] - ETA: 0s - loss: 0.5151 - acc: 0.7493
14483/14483 [==============================] - 1s 79us/step - loss: 0.5133 - acc: 0.7507

Test accuracy: 78.61347285807717

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  654

choose_one :  875

F1score :  0.8004881025015252

AUC : 0.8628212366971221

Confusion Matrix
[[546 219]
 [108 656]]
True label 0
0.7137254901960784  
0.28627450980392155  
True label 1
0.14136125654450263  
0.8586387434554974  

Train_result {'loss': [0.5133415808160274], 'acc': [0.7506732030738942]}
Saved model to disk



14

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.4866 - acc: 0.7500
  704/14483 [>.............................] - ETA: 1s - loss: 0.4929 - acc: 0.7443
 1408/14483 [=>............................] - ETA: 1s - loss: 0.4906 - acc: 0.7493
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.4984 - acc: 0.7486
 2752/14483 [====>.........................] - ETA: 0s - loss: 0.5028 - acc: 0.7511
 3456/14483 [======>.......................] - ETA: 0s - loss: 0.5039 - acc: 0.7500
 4160/14483 [=======>......................] - ETA: 0s - loss: 0.5066 - acc: 0.7507
 4864/14483 [=========>....................] - ETA: 0s - loss: 0.5104 - acc: 0.7488
 5568/14483 [==========>...................] - ETA: 0s - loss: 0.5129 - acc: 0.7471
 6272/14483 [===========>..................] - ETA: 0s - loss: 0.5117 - acc: 0.7486
 6912/14483 [=============>................] - ETA: 0s - loss: 0.5129 - acc: 0.7475
 7552/14483 [==============>...............] - ETA: 0s - loss: 0.5156 - acc: 0.7458
 8192/14483 [===============>..............] - ETA: 0s - loss: 0.5148 - acc: 0.7465
 8832/14483 [=================>............] - ETA: 0s - loss: 0.5178 - acc: 0.7442
 9472/14483 [==================>...........] - ETA: 0s - loss: 0.5183 - acc: 0.7442
10112/14483 [===================>..........] - ETA: 0s - loss: 0.5165 - acc: 0.7457
10816/14483 [=====================>........] - ETA: 0s - loss: 0.5143 - acc: 0.7466
11456/14483 [======================>.......] - ETA: 0s - loss: 0.5151 - acc: 0.7468
12096/14483 [========================>.....] - ETA: 0s - loss: 0.5147 - acc: 0.7461
12800/14483 [=========================>....] - ETA: 0s - loss: 0.5146 - acc: 0.7467
13504/14483 [==========================>...] - ETA: 0s - loss: 0.5150 - acc: 0.7474
14208/14483 [============================>.] - ETA: 0s - loss: 0.5170 - acc: 0.7458
14483/14483 [==============================] - 1s 79us/step - loss: 0.5172 - acc: 0.7456

Test accuracy: 79.07128842380641

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  691

choose_one :  838

F1score :  0.8002496878901372

AUC : 0.8639530506792595

Confusion Matrix
[[568 197]
 [123 641]]
True label 0
0.742483660130719  
0.257516339869281  
True label 1
0.16099476439790575  
0.8390052356020943  

Train_result {'loss': [0.517185992853159], 'acc': [0.7455637643805263]}
Saved model to disk



15

Epoch 1/1

   64/14483 [..............................] - ETA: 1s - loss: 0.5920 - acc: 0.7031
  640/14483 [>.............................] - ETA: 1s - loss: 0.5201 - acc: 0.7406
 1344/14483 [=>............................] - ETA: 1s - loss: 0.5058 - acc: 0.7440
 2112/14483 [===>..........................] - ETA: 0s - loss: 0.5150 - acc: 0.7420
 2816/14483 [====>.........................] - ETA: 0s - loss: 0.5101 - acc: 0.7461
 3520/14483 [======>.......................] - ETA: 0s - loss: 0.5046 - acc: 0.7509
 4224/14483 [=======>......................] - ETA: 0s - loss: 0.5007 - acc: 0.7519
 4928/14483 [=========>....................] - ETA: 0s - loss: 0.5035 - acc: 0.7502
 5632/14483 [==========>...................] - ETA: 0s - loss: 0.5090 - acc: 0.7459
 6336/14483 [============>.................] - ETA: 0s - loss: 0.5100 - acc: 0.7465
 6912/14483 [=============>................] - ETA: 0s - loss: 0.5133 - acc: 0.7470
 7616/14483 [==============>...............] - ETA: 0s - loss: 0.5135 - acc: 0.7459
 8256/14483 [================>.............] - ETA: 0s - loss: 0.5129 - acc: 0.7471
 8896/14483 [=================>............] - ETA: 0s - loss: 0.5125 - acc: 0.7483
 9600/14483 [==================>...........] - ETA: 0s - loss: 0.5150 - acc: 0.7471
10240/14483 [====================>.........] - ETA: 0s - loss: 0.5149 - acc: 0.7466
10880/14483 [=====================>........] - ETA: 0s - loss: 0.5135 - acc: 0.7478
11520/14483 [======================>.......] - ETA: 0s - loss: 0.5137 - acc: 0.7476
12160/14483 [========================>.....] - ETA: 0s - loss: 0.5135 - acc: 0.7472
12864/14483 [=========================>....] - ETA: 0s - loss: 0.5142 - acc: 0.7475
13504/14483 [==========================>...] - ETA: 0s - loss: 0.5149 - acc: 0.7464
14208/14483 [============================>.] - ETA: 0s - loss: 0.5120 - acc: 0.7488
14483/14483 [==============================] - 1s 79us/step - loss: 0.5116 - acc: 0.7486

Test accuracy: 78.22105951602354

data size :  16012

zero :  8007

one :  8005

train_zero :  7242

train_one :  7241

test_zero :  765

test_one :  764

choose_zero :  668

choose_one :  861

F1score :  0.795076923076923

AUC : 0.8627408205865243

Confusion Matrix
[[550 215]
 [118 646]]
True label 0
0.7189542483660131  
0.28104575163398693  
True label 1
0.1544502617801047  
0.8455497382198953  

Train_result {'loss': [0.5116232156646537], 'acc': [0.7486018090545081]}
Saved model to disk



[[69.7187704381949, 1], [73.31589274035318, 2], [74.62393721386528, 3], [75.60497056899933, 4], [76.65140614780903, 5], [75.27795945062132, 6], [76.52060170045782, 7], [76.45519947678221, 8], [77.50163505559189, 9], [77.43623283191629, 10], [76.84761281883584, 11], [76.2589928057554, 12], [78.61347285807717, 13], [79.07128842380641, 14], [78.22105951602354, 15]]
max accuracy :  [79.07128842380641, 14]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:404: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-22 01:47:05.157948: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-22 01:47:05.168551: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-22 01:47:05.170828: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x80bb790 executing computations on platform Host. Devices:
2019-08-22 01:47:05.170891: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 55

Under 10 : 8165
Over 10, Under 200 : 37669
Over 200, Under 400 : 2147
Over 400 : 489

hbase-code
updated_train_data

Sentence length Average : 52

Under 10 : 0
Over 10, Under 200 : 27853
Over 200, Under 400 : 1027
Over 400 : 0


Test_zero:  2410
Train_zero:  21283
zero:  23693
Test_one:  804
Train_one:  7597
one:  8401

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15195 [..............................] - ETA: 1:24 - loss: 0.6899 - acc: 0.4688
  896/15195 [>.............................] - ETA: 6s - loss: 0.6704 - acc: 0.5915  
 1728/15195 [==>...........................] - ETA: 3s - loss: 0.6488 - acc: 0.6267
 2560/15195 [====>.........................] - ETA: 2s - loss: 0.6345 - acc: 0.6371
 3392/15195 [=====>........................] - ETA: 1s - loss: 0.6207 - acc: 0.6501
 4160/15195 [=======>......................] - ETA: 1s - loss: 0.6126 - acc: 0.6575
 4928/15195 [========>.....................] - ETA: 1s - loss: 0.6055 - acc: 0.6680
 5696/15195 [==========>...................] - ETA: 1s - loss: 0.5964 - acc: 0.6771
 6656/15195 [============>.................] - ETA: 1s - loss: 0.5875 - acc: 0.6842
 7552/15195 [=============>................] - ETA: 1s - loss: 0.5836 - acc: 0.6886
 8448/15195 [===============>..............] - ETA: 0s - loss: 0.5804 - acc: 0.6915
 9280/15195 [=================>............] - ETA: 0s - loss: 0.5749 - acc: 0.6958
10112/15195 [==================>...........] - ETA: 0s - loss: 0.5709 - acc: 0.6995
10944/15195 [====================>.........] - ETA: 0s - loss: 0.5672 - acc: 0.7032
11776/15195 [======================>.......] - ETA: 0s - loss: 0.5637 - acc: 0.7059
12608/15195 [=======================>......] - ETA: 0s - loss: 0.5610 - acc: 0.7080
13376/15195 [=========================>....] - ETA: 0s - loss: 0.5571 - acc: 0.7123
14144/15195 [==========================>...] - ETA: 0s - loss: 0.5547 - acc: 0.7139
14976/15195 [============================>.] - ETA: 0s - loss: 0.5535 - acc: 0.7155
15195/15195 [==============================] - 2s 100us/step - loss: 0.5532 - acc: 0.7158

Test accuracy: 76.75574891236792

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  811

choose_one :  798

F1score :  0.766541822721598

AUC : 0.8466232502085843

Confusion Matrix
[[621 184]
 [190 614]]
True label 0
0.7714285714285715  
0.22857142857142856  
True label 1
0.236318407960199  
0.763681592039801  

Train_result {'loss': [0.5531747128156189], 'acc': [0.7157617637341491]}
Saved model to disk



2

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5745 - acc: 0.7344
  896/15195 [>.............................] - ETA: 0s - loss: 0.5010 - acc: 0.7612
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.5068 - acc: 0.7633
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.5066 - acc: 0.7605
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.5108 - acc: 0.7591
 4224/15195 [=======>......................] - ETA: 0s - loss: 0.5071 - acc: 0.7616
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.5060 - acc: 0.7613
 5888/15195 [==========>...................] - ETA: 0s - loss: 0.5065 - acc: 0.7622
 6720/15195 [============>.................] - ETA: 0s - loss: 0.5067 - acc: 0.7568
 7488/15195 [=============>................] - ETA: 0s - loss: 0.5052 - acc: 0.7580
 8320/15195 [===============>..............] - ETA: 0s - loss: 0.5051 - acc: 0.7583
 9152/15195 [=================>............] - ETA: 0s - loss: 0.5036 - acc: 0.7606
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.5014 - acc: 0.7613
10816/15195 [====================>.........] - ETA: 0s - loss: 0.5003 - acc: 0.7621
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4989 - acc: 0.7628
12480/15195 [=======================>......] - ETA: 0s - loss: 0.5012 - acc: 0.7607
13312/15195 [=========================>....] - ETA: 0s - loss: 0.5016 - acc: 0.7593
14144/15195 [==========================>...] - ETA: 0s - loss: 0.5022 - acc: 0.7593
14976/15195 [============================>.] - ETA: 0s - loss: 0.5007 - acc: 0.7594
15195/15195 [==============================] - 1s 63us/step - loss: 0.5009 - acc: 0.7593

Test accuracy: 76.07209446861405

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  874

choose_one :  735

F1score :  0.7498375568551008

AUC : 0.8510421495009426

Confusion Matrix
[[647 158]
 [227 577]]
True label 0
0.8037267080745342  
0.19627329192546583  
True label 1
0.28233830845771146  
0.7176616915422885  

Train_result {'loss': [0.5009221555371549], 'acc': [0.759262915389559]}
Saved model to disk



3

Epoch 1/1

   64/15195 [..............................] - ETA: 0s - loss: 0.2941 - acc: 0.9062
  960/15195 [>.............................] - ETA: 0s - loss: 0.4570 - acc: 0.8010
 1792/15195 [==>...........................] - ETA: 0s - loss: 0.4732 - acc: 0.7846
 2624/15195 [====>.........................] - ETA: 0s - loss: 0.4872 - acc: 0.7736
 3456/15195 [=====>........................] - ETA: 0s - loss: 0.4961 - acc: 0.7694
 4288/15195 [=======>......................] - ETA: 0s - loss: 0.4926 - acc: 0.7666
 5120/15195 [=========>....................] - ETA: 0s - loss: 0.4903 - acc: 0.7676
 5952/15195 [==========>...................] - ETA: 0s - loss: 0.4891 - acc: 0.7665
 6784/15195 [============>.................] - ETA: 0s - loss: 0.4927 - acc: 0.7653
 7616/15195 [==============>...............] - ETA: 0s - loss: 0.4915 - acc: 0.7652
 8448/15195 [===============>..............] - ETA: 0s - loss: 0.4901 - acc: 0.7667
 9280/15195 [=================>............] - ETA: 0s - loss: 0.4908 - acc: 0.7663
10112/15195 [==================>...........] - ETA: 0s - loss: 0.4906 - acc: 0.7663
10944/15195 [====================>.........] - ETA: 0s - loss: 0.4895 - acc: 0.7675
11776/15195 [======================>.......] - ETA: 0s - loss: 0.4879 - acc: 0.7683
12544/15195 [=======================>......] - ETA: 0s - loss: 0.4861 - acc: 0.7683
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4842 - acc: 0.7700
14144/15195 [==========================>...] - ETA: 0s - loss: 0.4842 - acc: 0.7704
14976/15195 [============================>.] - ETA: 0s - loss: 0.4832 - acc: 0.7709
15195/15195 [==============================] - 1s 63us/step - loss: 0.4837 - acc: 0.7701

Test accuracy: 78.8688626476072

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  771

choose_one :  838

F1score :  0.7929354445797807

AUC : 0.8653834862952319

Confusion Matrix
[[618 187]
 [153 651]]
True label 0
0.7677018633540372  
0.23229813664596274  
True label 1
0.19029850746268656  
0.8097014925373134  

Train_result {'loss': [0.48365247580478676], 'acc': [0.7700559395047621]}
Saved model to disk



4

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4043 - acc: 0.8438
  896/15195 [>.............................] - ETA: 0s - loss: 0.5111 - acc: 0.7422
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4964 - acc: 0.7581
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.4915 - acc: 0.7578
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.4947 - acc: 0.7571
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.4950 - acc: 0.7589
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.4896 - acc: 0.7606
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.4880 - acc: 0.7613
 6592/15195 [============>.................] - ETA: 0s - loss: 0.4835 - acc: 0.7637
 7424/15195 [=============>................] - ETA: 0s - loss: 0.4825 - acc: 0.7640
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.4802 - acc: 0.7655
 9152/15195 [=================>............] - ETA: 0s - loss: 0.4778 - acc: 0.7680
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.4769 - acc: 0.7698
10816/15195 [====================>.........] - ETA: 0s - loss: 0.4747 - acc: 0.7722
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4748 - acc: 0.7728
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4753 - acc: 0.7732
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4761 - acc: 0.7738
14144/15195 [==========================>...] - ETA: 0s - loss: 0.4754 - acc: 0.7740
14976/15195 [============================>.] - ETA: 0s - loss: 0.4762 - acc: 0.7738
15195/15195 [==============================] - 1s 63us/step - loss: 0.4774 - acc: 0.7735

Test accuracy: 77.62585456805469

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  695

choose_one :  914

F1score :  0.790454016298021

AUC : 0.8591769413800563

Confusion Matrix
[[570 235]
 [125 679]]
True label 0
0.7080745341614907  
0.2919254658385093  
True label 1
0.15547263681592038  
0.8445273631840796  

Train_result {'loss': [0.4774483123591324], 'acc': [0.773543928959292]}
Saved model to disk



5

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4858 - acc: 0.7188
 1024/15195 [=>............................] - ETA: 0s - loss: 0.4637 - acc: 0.7881
 2112/15195 [===>..........................] - ETA: 0s - loss: 0.4722 - acc: 0.7732
 3136/15195 [=====>........................] - ETA: 0s - loss: 0.4717 - acc: 0.7761
 4032/15195 [======>.......................] - ETA: 0s - loss: 0.4754 - acc: 0.7728
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.4721 - acc: 0.7741
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.4749 - acc: 0.7718
 6656/15195 [============>.................] - ETA: 0s - loss: 0.4758 - acc: 0.7731
 7488/15195 [=============>................] - ETA: 0s - loss: 0.4740 - acc: 0.7743
 8320/15195 [===============>..............] - ETA: 0s - loss: 0.4751 - acc: 0.7737
 9152/15195 [=================>............] - ETA: 0s - loss: 0.4707 - acc: 0.7760
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.4704 - acc: 0.7760
10816/15195 [====================>.........] - ETA: 0s - loss: 0.4711 - acc: 0.7746
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4701 - acc: 0.7758
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4712 - acc: 0.7753
13376/15195 [=========================>....] - ETA: 0s - loss: 0.4704 - acc: 0.7766
14272/15195 [===========================>..] - ETA: 0s - loss: 0.4707 - acc: 0.7765
15104/15195 [============================>.] - ETA: 0s - loss: 0.4710 - acc: 0.7759
15195/15195 [==============================] - 1s 59us/step - loss: 0.4711 - acc: 0.7760

Test accuracy: 77.99875699192044

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  747

choose_one :  862

F1score :  0.7875150060024009

AUC : 0.8615239022279906

Confusion Matrix
[[599 206]
 [148 656]]
True label 0
0.7440993788819876  
0.25590062111801243  
True label 1
0.18407960199004975  
0.8159203980099502  

Train_result {'loss': [0.47105701539264616], 'acc': [0.7759789404370119]}
Saved model to disk



6

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.3912 - acc: 0.8438
  960/15195 [>.............................] - ETA: 0s - loss: 0.4716 - acc: 0.7792
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4513 - acc: 0.7911
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.4698 - acc: 0.7789
 3392/15195 [=====>........................] - ETA: 0s - loss: 0.4620 - acc: 0.7821
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.4600 - acc: 0.7812
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.4596 - acc: 0.7837
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.4634 - acc: 0.7821
 6592/15195 [============>.................] - ETA: 0s - loss: 0.4605 - acc: 0.7835
 7424/15195 [=============>................] - ETA: 0s - loss: 0.4637 - acc: 0.7829
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.4645 - acc: 0.7832
 9088/15195 [================>.............] - ETA: 0s - loss: 0.4641 - acc: 0.7815
 9920/15195 [==================>...........] - ETA: 0s - loss: 0.4607 - acc: 0.7837
10752/15195 [====================>.........] - ETA: 0s - loss: 0.4640 - acc: 0.7820
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4642 - acc: 0.7823
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4631 - acc: 0.7831
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4612 - acc: 0.7843
14144/15195 [==========================>...] - ETA: 0s - loss: 0.4609 - acc: 0.7843
14976/15195 [============================>.] - ETA: 0s - loss: 0.4609 - acc: 0.7850
15195/15195 [==============================] - 1s 63us/step - loss: 0.4607 - acc: 0.7851

Test accuracy: 69.91920447482909

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  1167

choose_one :  442

F1score :  0.6115569823434992

AUC : 0.8575886097462997

Confusion Matrix
[[744  61]
 [423 381]]
True label 0
0.924223602484472  
0.07577639751552795  
True label 1
0.5261194029850746  
0.47388059701492535  

Train_result {'loss': [0.46072236458970434], 'acc': [0.7851266864335392]}
Saved model to disk



7

Epoch 1/1

   64/15195 [..............................] - ETA: 0s - loss: 0.4373 - acc: 0.7969
  896/15195 [>.............................] - ETA: 0s - loss: 0.4384 - acc: 0.8103
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4434 - acc: 0.8050
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.4397 - acc: 0.8009
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.4395 - acc: 0.7984
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.4494 - acc: 0.7925
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.4498 - acc: 0.7943
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.4580 - acc: 0.7881
 6656/15195 [============>.................] - ETA: 0s - loss: 0.4575 - acc: 0.7883
 7488/15195 [=============>................] - ETA: 0s - loss: 0.4594 - acc: 0.7865
 8384/15195 [===============>..............] - ETA: 0s - loss: 0.4593 - acc: 0.7853
 9216/15195 [=================>............] - ETA: 0s - loss: 0.4572 - acc: 0.7865
10048/15195 [==================>...........] - ETA: 0s - loss: 0.4589 - acc: 0.7840
10880/15195 [====================>.........] - ETA: 0s - loss: 0.4568 - acc: 0.7859
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4562 - acc: 0.7860
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4546 - acc: 0.7877
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4546 - acc: 0.7878
14144/15195 [==========================>...] - ETA: 0s - loss: 0.4552 - acc: 0.7871
14976/15195 [============================>.] - ETA: 0s - loss: 0.4563 - acc: 0.7871
15195/15195 [==============================] - 1s 63us/step - loss: 0.4559 - acc: 0.7876

Test accuracy: 77.56370416407707

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  722

choose_one :  887

F1score :  0.7865168539325842

AUC : 0.8545602731683198

Confusion Matrix
[[583 222]
 [139 665]]
True label 0
0.724223602484472  
0.27577639751552796  
True label 1
0.17288557213930347  
0.8271144278606966  

Train_result {'loss': [0.455893260489643], 'acc': [0.7876275090843331]}
Saved model to disk



8

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5231 - acc: 0.7656
  960/15195 [>.............................] - ETA: 0s - loss: 0.4389 - acc: 0.8083
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.4495 - acc: 0.7939
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.4514 - acc: 0.7957
 3456/15195 [=====>........................] - ETA: 0s - loss: 0.4515 - acc: 0.7960
 4288/15195 [=======>......................] - ETA: 0s - loss: 0.4499 - acc: 0.7969
 5184/15195 [=========>....................] - ETA: 0s - loss: 0.4501 - acc: 0.7963
 6080/15195 [===========>..................] - ETA: 0s - loss: 0.4508 - acc: 0.7941
 6912/15195 [============>.................] - ETA: 0s - loss: 0.4522 - acc: 0.7912
 7744/15195 [==============>...............] - ETA: 0s - loss: 0.4555 - acc: 0.7908
 8576/15195 [===============>..............] - ETA: 0s - loss: 0.4561 - acc: 0.7895
 9408/15195 [=================>............] - ETA: 0s - loss: 0.4542 - acc: 0.7899
10240/15195 [===================>..........] - ETA: 0s - loss: 0.4534 - acc: 0.7897
11072/15195 [====================>.........] - ETA: 0s - loss: 0.4543 - acc: 0.7901
11840/15195 [======================>.......] - ETA: 0s - loss: 0.4543 - acc: 0.7905
12608/15195 [=======================>......] - ETA: 0s - loss: 0.4543 - acc: 0.7916
13440/15195 [=========================>....] - ETA: 0s - loss: 0.4521 - acc: 0.7920
14272/15195 [===========================>..] - ETA: 0s - loss: 0.4531 - acc: 0.7907
15104/15195 [============================>.] - ETA: 0s - loss: 0.4532 - acc: 0.7897
15195/15195 [==============================] - 1s 63us/step - loss: 0.4532 - acc: 0.7897

Test accuracy: 77.43940335612182

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  582

choose_one :  1027

F1score :  0.8017476788640089

AUC : 0.8718094311053428

Confusion Matrix
[[512 293]
 [ 70 734]]
True label 0
0.6360248447204969  
0.3639751552795031  
True label 1
0.08706467661691543  
0.9129353233830846  

Train_result {'loss': [0.4531909373156449], 'acc': [0.7897334649398869]}
Saved model to disk



9

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5164 - acc: 0.7031
 1024/15195 [=>............................] - ETA: 0s - loss: 0.4626 - acc: 0.7793
 2112/15195 [===>..........................] - ETA: 0s - loss: 0.4462 - acc: 0.7884
 3264/15195 [=====>........................] - ETA: 0s - loss: 0.4451 - acc: 0.7907
 4608/15195 [========>.....................] - ETA: 0s - loss: 0.4545 - acc: 0.7856
 5632/15195 [==========>...................] - ETA: 0s - loss: 0.4567 - acc: 0.7850
 6528/15195 [===========>..................] - ETA: 0s - loss: 0.4521 - acc: 0.7878
 7424/15195 [=============>................] - ETA: 0s - loss: 0.4473 - acc: 0.7905
 8320/15195 [===============>..............] - ETA: 0s - loss: 0.4502 - acc: 0.7901
 9152/15195 [=================>............] - ETA: 0s - loss: 0.4527 - acc: 0.7889
 9984/15195 [==================>...........] - ETA: 0s - loss: 0.4509 - acc: 0.7892
10816/15195 [====================>.........] - ETA: 0s - loss: 0.4523 - acc: 0.7881
11648/15195 [=====================>........] - ETA: 0s - loss: 0.4536 - acc: 0.7878
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4538 - acc: 0.7867
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4534 - acc: 0.7873
14144/15195 [==========================>...] - ETA: 0s - loss: 0.4526 - acc: 0.7881
14976/15195 [============================>.] - ETA: 0s - loss: 0.4523 - acc: 0.7889
15195/15195 [==============================] - 1s 57us/step - loss: 0.4516 - acc: 0.7898

Test accuracy: 80.42262274704785

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  720

choose_one :  889

F1score :  0.8139397519196693

AUC : 0.8775292790704861

Confusion Matrix
[[605 200]
 [115 689]]
True label 0
0.7515527950310559  
0.2484472049689441  
True label 1
0.14303482587064675  
0.8569651741293532  

Train_result {'loss': [0.45158376794929916], 'acc': [0.789799276034508]}
Saved model to disk



10

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.3225 - acc: 0.8438
  896/15195 [>.............................] - ETA: 0s - loss: 0.4196 - acc: 0.8080
 1664/15195 [==>...........................] - ETA: 0s - loss: 0.4333 - acc: 0.7975
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.4353 - acc: 0.7985
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.4443 - acc: 0.7903
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.4500 - acc: 0.7863
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.4507 - acc: 0.7879
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.4474 - acc: 0.7896
 6592/15195 [============>.................] - ETA: 0s - loss: 0.4445 - acc: 0.7923
 7360/15195 [=============>................] - ETA: 0s - loss: 0.4438 - acc: 0.7933
 8192/15195 [===============>..............] - ETA: 0s - loss: 0.4459 - acc: 0.7927
 9024/15195 [================>.............] - ETA: 0s - loss: 0.4459 - acc: 0.7941
 9856/15195 [==================>...........] - ETA: 0s - loss: 0.4449 - acc: 0.7960
10688/15195 [====================>.........] - ETA: 0s - loss: 0.4462 - acc: 0.7958
11520/15195 [=====================>........] - ETA: 0s - loss: 0.4454 - acc: 0.7969
12352/15195 [=======================>......] - ETA: 0s - loss: 0.4477 - acc: 0.7954
13184/15195 [=========================>....] - ETA: 0s - loss: 0.4485 - acc: 0.7943
14016/15195 [==========================>...] - ETA: 0s - loss: 0.4448 - acc: 0.7958
14848/15195 [============================>.] - ETA: 0s - loss: 0.4449 - acc: 0.7954
15195/15195 [==============================] - 1s 64us/step - loss: 0.4440 - acc: 0.7955

Test accuracy: 76.81789931634556

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  1012

choose_one :  597

F1score :  0.7337615988579587

AUC : 0.8763612063904083

Confusion Matrix
[[722  83]
 [290 514]]
True label 0
0.8968944099378882  
0.1031055900621118  
True label 1
0.36069651741293535  
0.6393034825870647  

Train_result {'loss': [0.44401224495824054], 'acc': [0.795524843655436]}
Saved model to disk



11

Epoch 1/1

   64/15195 [..............................] - ETA: 0s - loss: 0.4485 - acc: 0.7812
  896/15195 [>.............................] - ETA: 0s - loss: 0.4292 - acc: 0.7980
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4241 - acc: 0.8038
 2560/15195 [====>.........................] - ETA: 0s - loss: 0.4439 - acc: 0.7996
 3328/15195 [=====>........................] - ETA: 0s - loss: 0.4454 - acc: 0.7993
 4160/15195 [=======>......................] - ETA: 0s - loss: 0.4426 - acc: 0.7976
 4992/15195 [========>.....................] - ETA: 0s - loss: 0.4418 - acc: 0.7991
 5824/15195 [==========>...................] - ETA: 0s - loss: 0.4439 - acc: 0.7965
 6656/15195 [============>.................] - ETA: 0s - loss: 0.4418 - acc: 0.7987
 7424/15195 [=============>................] - ETA: 0s - loss: 0.4387 - acc: 0.8009
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.4356 - acc: 0.8031
 9024/15195 [================>.............] - ETA: 0s - loss: 0.4357 - acc: 0.8010
 9856/15195 [==================>...........] - ETA: 0s - loss: 0.4364 - acc: 0.8017
10688/15195 [====================>.........] - ETA: 0s - loss: 0.4391 - acc: 0.8007
11520/15195 [=====================>........] - ETA: 0s - loss: 0.4368 - acc: 0.8013
12352/15195 [=======================>......] - ETA: 0s - loss: 0.4391 - acc: 0.8000
13184/15195 [=========================>....] - ETA: 0s - loss: 0.4392 - acc: 0.7994
14016/15195 [==========================>...] - ETA: 0s - loss: 0.4389 - acc: 0.7993
14848/15195 [============================>.] - ETA: 0s - loss: 0.4395 - acc: 0.7989
15195/15195 [==============================] - 1s 63us/step - loss: 0.4402 - acc: 0.7980

Test accuracy: 77.31510254816656

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  572

choose_one :  1037

F1score :  0.8017381857686041

AUC : 0.8727967306325515

Confusion Matrix
[[506 299]
 [ 66 738]]
True label 0
0.6285714285714286  
0.37142857142857144  
True label 1
0.08208955223880597  
0.917910447761194  

Train_result {'loss': [0.44018744265770354], 'acc': [0.7980256663886055]}
Saved model to disk



12

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5384 - acc: 0.7656
  960/15195 [>.............................] - ETA: 0s - loss: 0.4129 - acc: 0.8187
 1728/15195 [==>...........................] - ETA: 0s - loss: 0.4362 - acc: 0.7986
 2496/15195 [===>..........................] - ETA: 0s - loss: 0.4387 - acc: 0.7961
 3264/15195 [=====>........................] - ETA: 0s - loss: 0.4365 - acc: 0.7966
 4032/15195 [======>.......................] - ETA: 0s - loss: 0.4384 - acc: 0.7951
 4864/15195 [========>.....................] - ETA: 0s - loss: 0.4384 - acc: 0.7965
 5632/15195 [==========>...................] - ETA: 0s - loss: 0.4397 - acc: 0.7976
 6464/15195 [===========>..................] - ETA: 0s - loss: 0.4414 - acc: 0.7952
 7296/15195 [=============>................] - ETA: 0s - loss: 0.4378 - acc: 0.7969
 8128/15195 [===============>..............] - ETA: 0s - loss: 0.4352 - acc: 0.7980
 8960/15195 [================>.............] - ETA: 0s - loss: 0.4355 - acc: 0.7969
 9792/15195 [==================>...........] - ETA: 0s - loss: 0.4366 - acc: 0.7966
10624/15195 [===================>..........] - ETA: 0s - loss: 0.4372 - acc: 0.7966
11520/15195 [=====================>........] - ETA: 0s - loss: 0.4369 - acc: 0.7975
12416/15195 [=======================>......] - ETA: 0s - loss: 0.4364 - acc: 0.7972
13248/15195 [=========================>....] - ETA: 0s - loss: 0.4378 - acc: 0.7966
14080/15195 [==========================>...] - ETA: 0s - loss: 0.4381 - acc: 0.7967
14912/15195 [============================>.] - ETA: 0s - loss: 0.4388 - acc: 0.7971
15195/15195 [==============================] - 1s 63us/step - loss: 0.4403 - acc: 0.7964

Test accuracy: 80.17402113113735

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  716

choose_one :  893

F1score :  0.8120212139068945

AUC : 0.8825028583789128

Confusion Matrix
[[601 204]
 [115 689]]
True label 0
0.746583850931677  
0.253416149068323  
True label 1
0.14303482587064675  
0.8569651741293532  

Train_result {'loss': [0.44026168440862407], 'acc': [0.7963803883366147]}
Saved model to disk



13

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4376 - acc: 0.8281
  896/15195 [>.............................] - ETA: 0s - loss: 0.4171 - acc: 0.8114
 1792/15195 [==>...........................] - ETA: 0s - loss: 0.4193 - acc: 0.8075
 2624/15195 [====>.........................] - ETA: 0s - loss: 0.4279 - acc: 0.7995
 3456/15195 [=====>........................] - ETA: 0s - loss: 0.4226 - acc: 0.8024
 4224/15195 [=======>......................] - ETA: 0s - loss: 0.4227 - acc: 0.8026
 5056/15195 [========>.....................] - ETA: 0s - loss: 0.4241 - acc: 0.8014
 5888/15195 [==========>...................] - ETA: 0s - loss: 0.4260 - acc: 0.8021
 6720/15195 [============>.................] - ETA: 0s - loss: 0.4299 - acc: 0.8000
 7552/15195 [=============>................] - ETA: 0s - loss: 0.4342 - acc: 0.7967
 8448/15195 [===============>..............] - ETA: 0s - loss: 0.4298 - acc: 0.7992
 9280/15195 [=================>............] - ETA: 0s - loss: 0.4307 - acc: 0.7992
10112/15195 [==================>...........] - ETA: 0s - loss: 0.4284 - acc: 0.8008
11008/15195 [====================>.........] - ETA: 0s - loss: 0.4313 - acc: 0.8001
11840/15195 [======================>.......] - ETA: 0s - loss: 0.4306 - acc: 0.8002
12672/15195 [========================>.....] - ETA: 0s - loss: 0.4296 - acc: 0.8015
13504/15195 [=========================>....] - ETA: 0s - loss: 0.4305 - acc: 0.8013
14272/15195 [===========================>..] - ETA: 0s - loss: 0.4316 - acc: 0.8003
15104/15195 [============================>.] - ETA: 0s - loss: 0.4312 - acc: 0.7998
15195/15195 [==============================] - 1s 63us/step - loss: 0.4311 - acc: 0.7998

Test accuracy: 79.3039154754506

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  620

choose_one :  989

F1score :  0.8142777467930843

AUC : 0.8838872408145607

Confusion Matrix
[[546 259]
 [ 74 730]]
True label 0
0.6782608695652174  
0.3217391304347826  
True label 1
0.09203980099502487  
0.9079601990049752  

Train_result {'loss': [0.43105198179432025], 'acc': [0.7998025666455291]}
Saved model to disk



14

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.4265 - acc: 0.7969
 1152/15195 [=>............................] - ETA: 0s - loss: 0.4295 - acc: 0.7925
 2048/15195 [===>..........................] - ETA: 0s - loss: 0.4231 - acc: 0.7959
 2880/15195 [====>.........................] - ETA: 0s - loss: 0.4242 - acc: 0.7958
 3648/15195 [======>.......................] - ETA: 0s - loss: 0.4228 - acc: 0.7988
 4480/15195 [=======>......................] - ETA: 0s - loss: 0.4248 - acc: 0.7993
 5248/15195 [=========>....................] - ETA: 0s - loss: 0.4239 - acc: 0.8037
 6080/15195 [===========>..................] - ETA: 0s - loss: 0.4261 - acc: 0.8035
 6912/15195 [============>.................] - ETA: 0s - loss: 0.4241 - acc: 0.8053
 7744/15195 [==============>...............] - ETA: 0s - loss: 0.4293 - acc: 0.8029
 8576/15195 [===============>..............] - ETA: 0s - loss: 0.4305 - acc: 0.8034
 9408/15195 [=================>............] - ETA: 0s - loss: 0.4303 - acc: 0.8042
10240/15195 [===================>..........] - ETA: 0s - loss: 0.4280 - acc: 0.8047
11072/15195 [====================>.........] - ETA: 0s - loss: 0.4265 - acc: 0.8056
11904/15195 [======================>.......] - ETA: 0s - loss: 0.4251 - acc: 0.8054
12736/15195 [========================>.....] - ETA: 0s - loss: 0.4265 - acc: 0.8039
13568/15195 [=========================>....] - ETA: 0s - loss: 0.4263 - acc: 0.8028
14400/15195 [===========================>..] - ETA: 0s - loss: 0.4292 - acc: 0.8013
15195/15195 [==============================] - 1s 62us/step - loss: 0.4290 - acc: 0.8011

Test accuracy: 78.93101305158483

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  922

choose_one :  687

F1score :  0.772635814889336

AUC : 0.8827299836222613

Confusion Matrix
[[694 111]
 [228 576]]
True label 0
0.8621118012422361  
0.13788819875776398  
True label 1
0.2835820895522388  
0.7164179104477612  

Train_result {'loss': [0.4289882326467369], 'acc': [0.8011187890596632]}
Saved model to disk



15

Epoch 1/1

   64/15195 [..............................] - ETA: 1s - loss: 0.5562 - acc: 0.7500
  768/15195 [>.............................] - ETA: 1s - loss: 0.4032 - acc: 0.8229
 1600/15195 [==>...........................] - ETA: 0s - loss: 0.4027 - acc: 0.8169
 2432/15195 [===>..........................] - ETA: 0s - loss: 0.4126 - acc: 0.8162
 3264/15195 [=====>........................] - ETA: 0s - loss: 0.4190 - acc: 0.8131
 4096/15195 [=======>......................] - ETA: 0s - loss: 0.4234 - acc: 0.8091
 4928/15195 [========>.....................] - ETA: 0s - loss: 0.4278 - acc: 0.8040
 5760/15195 [==========>...................] - ETA: 0s - loss: 0.4252 - acc: 0.8052
 6592/15195 [============>.................] - ETA: 0s - loss: 0.4305 - acc: 0.8022
 7424/15195 [=============>................] - ETA: 0s - loss: 0.4350 - acc: 0.8001
 8256/15195 [===============>..............] - ETA: 0s - loss: 0.4338 - acc: 0.7997
 9088/15195 [================>.............] - ETA: 0s - loss: 0.4306 - acc: 0.8014
 9920/15195 [==================>...........] - ETA: 0s - loss: 0.4298 - acc: 0.8024
10752/15195 [====================>.........] - ETA: 0s - loss: 0.4284 - acc: 0.8039
11584/15195 [=====================>........] - ETA: 0s - loss: 0.4292 - acc: 0.8027
12480/15195 [=======================>......] - ETA: 0s - loss: 0.4290 - acc: 0.8034
13312/15195 [=========================>....] - ETA: 0s - loss: 0.4279 - acc: 0.8048
14208/15195 [===========================>..] - ETA: 0s - loss: 0.4282 - acc: 0.8045
15040/15195 [============================>.] - ETA: 0s - loss: 0.4279 - acc: 0.8051
15195/15195 [==============================] - 1s 63us/step - loss: 0.4281 - acc: 0.8052

Test accuracy: 77.00435052827844

data size :  16804

zero :  8403

one :  8401

train_zero :  7598

train_one :  7597

test_zero :  805

test_one :  804

choose_zero :  545

choose_one :  1064

F1score :  0.8019271948608137

AUC : 0.8808032817280059

Confusion Matrix
[[490 315]
 [ 55 749]]
True label 0
0.6086956521739131  
0.391304347826087  
True label 1
0.06840796019900497  
0.931592039800995  

Train_result {'loss': [0.4281415440507451], 'acc': [0.8051990786952853]}
Saved model to disk



[[76.75574891236792, 1], [76.07209446861405, 2], [78.8688626476072, 3], [77.62585456805469, 4], [77.99875699192044, 5], [69.91920447482909, 6], [77.56370416407707, 7], [77.43940335612182, 8], [80.42262274704785, 9], [76.81789931634556, 10], [77.31510254816656, 11], [80.17402113113735, 12], [79.3039154754506, 13], [78.93101305158483, 14], [77.00435052827844, 15]]
max accuracy :  [80.42262274704785, 9]

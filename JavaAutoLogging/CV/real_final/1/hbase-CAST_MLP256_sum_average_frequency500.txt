Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:404: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-22 01:46:03.878746: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-22 01:46:03.888924: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-22 01:46:03.891135: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6397a10 executing computations on platform Host. Devices:
2019-08-22 01:46:03.891184: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 83

Under 10 : 0
Over 10, Under 200 : 31184
Over 200, Under 400 : 4247
Over 400 : 0


Test_zero:  3082
Train_zero:  27814
zero:  30896
Test_one:  805
Train_one:  7617
one:  8422

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15235 [..............................] - ETA: 1:22 - loss: 0.6959 - acc: 0.5000
  832/15235 [>.............................] - ETA: 6s - loss: 0.5695 - acc: 0.6935  
 1664/15235 [==>...........................] - ETA: 3s - loss: 0.5255 - acc: 0.7296
 2432/15235 [===>..........................] - ETA: 2s - loss: 0.5275 - acc: 0.7344
 3264/15235 [=====>........................] - ETA: 2s - loss: 0.5035 - acc: 0.7525
 4096/15235 [=======>......................] - ETA: 1s - loss: 0.4934 - acc: 0.7600
 4928/15235 [========>.....................] - ETA: 1s - loss: 0.4822 - acc: 0.7679
 5760/15235 [==========>...................] - ETA: 1s - loss: 0.4739 - acc: 0.7759
 6592/15235 [===========>..................] - ETA: 1s - loss: 0.4691 - acc: 0.7793
 7424/15235 [=============>................] - ETA: 0s - loss: 0.4619 - acc: 0.7825
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.4578 - acc: 0.7857
 9088/15235 [================>.............] - ETA: 0s - loss: 0.4522 - acc: 0.7888
 9920/15235 [==================>...........] - ETA: 0s - loss: 0.4508 - acc: 0.7893
10752/15235 [====================>.........] - ETA: 0s - loss: 0.4458 - acc: 0.7922
11584/15235 [=====================>........] - ETA: 0s - loss: 0.4454 - acc: 0.7924
12416/15235 [=======================>......] - ETA: 0s - loss: 0.4427 - acc: 0.7943
13248/15235 [=========================>....] - ETA: 0s - loss: 0.4400 - acc: 0.7964
14144/15235 [==========================>...] - ETA: 0s - loss: 0.4389 - acc: 0.7969
14976/15235 [============================>.] - ETA: 0s - loss: 0.4383 - acc: 0.7973
15235/15235 [==============================] - 1s 86us/step - loss: 0.4386 - acc: 0.7970

Test accuracy: 81.31595282433271

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  809

choose_one :  802

F1score :  0.8126944617299316

AUC : 0.9011135428386481

Confusion Matrix
[[657 149]
 [152 653]]
True label 0
0.815136476426799  
0.184863523573201  
True label 1
0.18881987577639753  
0.8111801242236025  

Train_result {'acc': [0.7969806366957404], 'loss': [0.43858121411112594]}
Saved model to disk



2

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.3823 - acc: 0.8594
  896/15235 [>.............................] - ETA: 0s - loss: 0.3933 - acc: 0.8237
 1728/15235 [==>...........................] - ETA: 0s - loss: 0.3882 - acc: 0.8368
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3881 - acc: 0.8363
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3889 - acc: 0.8328
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.3820 - acc: 0.8324
 5056/15235 [========>.....................] - ETA: 0s - loss: 0.3846 - acc: 0.8305
 5888/15235 [==========>...................] - ETA: 0s - loss: 0.3820 - acc: 0.8336
 6720/15235 [============>.................] - ETA: 0s - loss: 0.3829 - acc: 0.8320
 7616/15235 [=============>................] - ETA: 0s - loss: 0.3818 - acc: 0.8334
 8448/15235 [===============>..............] - ETA: 0s - loss: 0.3807 - acc: 0.8350
 9344/15235 [=================>............] - ETA: 0s - loss: 0.3823 - acc: 0.8344
10176/15235 [===================>..........] - ETA: 0s - loss: 0.3862 - acc: 0.8314
11008/15235 [====================>.........] - ETA: 0s - loss: 0.3873 - acc: 0.8309
11840/15235 [======================>.......] - ETA: 0s - loss: 0.3859 - acc: 0.8323
12672/15235 [=======================>......] - ETA: 0s - loss: 0.3867 - acc: 0.8319
13504/15235 [=========================>....] - ETA: 0s - loss: 0.3838 - acc: 0.8328
14272/15235 [===========================>..] - ETA: 0s - loss: 0.3830 - acc: 0.8332
15040/15235 [============================>.] - ETA: 0s - loss: 0.3838 - acc: 0.8329
15235/15235 [==============================] - 1s 63us/step - loss: 0.3837 - acc: 0.8326

Test accuracy: 84.35754189944134

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  786

choose_one :  825

F1score :  0.845398773006135

AUC : 0.9173073069987516

Confusion Matrix
[[670 136]
 [116 689]]
True label 0
0.8312655086848635  
0.1687344913151365  
True label 1
0.14409937888198757  
0.8559006211180125  

Train_result {'acc': [0.8326222513948146], 'loss': [0.38372455413102086]}
Saved model to disk



3

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2929 - acc: 0.8906
  960/15235 [>.............................] - ETA: 0s - loss: 0.3720 - acc: 0.8365
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3535 - acc: 0.8488
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3557 - acc: 0.8477
 3328/15235 [=====>........................] - ETA: 0s - loss: 0.3610 - acc: 0.8453
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.3716 - acc: 0.8411
 4928/15235 [========>.....................] - ETA: 0s - loss: 0.3682 - acc: 0.8391
 5696/15235 [==========>...................] - ETA: 0s - loss: 0.3652 - acc: 0.8401
 6464/15235 [===========>..................] - ETA: 0s - loss: 0.3660 - acc: 0.8393
 7232/15235 [=============>................] - ETA: 0s - loss: 0.3622 - acc: 0.8418
 8064/15235 [==============>...............] - ETA: 0s - loss: 0.3635 - acc: 0.8413
 8896/15235 [================>.............] - ETA: 0s - loss: 0.3666 - acc: 0.8387
 9664/15235 [==================>...........] - ETA: 0s - loss: 0.3657 - acc: 0.8392
10496/15235 [===================>..........] - ETA: 0s - loss: 0.3671 - acc: 0.8389
11328/15235 [=====================>........] - ETA: 0s - loss: 0.3669 - acc: 0.8390
12160/15235 [======================>.......] - ETA: 0s - loss: 0.3698 - acc: 0.8379
12992/15235 [========================>.....] - ETA: 0s - loss: 0.3697 - acc: 0.8384
13824/15235 [==========================>...] - ETA: 0s - loss: 0.3704 - acc: 0.8383
14720/15235 [===========================>..] - ETA: 0s - loss: 0.3710 - acc: 0.8379
15235/15235 [==============================] - 1s 64us/step - loss: 0.3698 - acc: 0.8385

Test accuracy: 84.48168839230293

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  678

choose_one :  933

F1score :  0.8561565017261219

AUC : 0.9248454911147759

Confusion Matrix
[[617 189]
 [ 61 744]]
True label 0
0.7655086848635235  
0.23449131513647642  
True label 1
0.07577639751552795  
0.924223602484472  

Train_result {'acc': [0.8385297013455858], 'loss': [0.3698253522319875]}
Saved model to disk



4

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2485 - acc: 0.9062
  896/15235 [>.............................] - ETA: 0s - loss: 0.3674 - acc: 0.8382
 1728/15235 [==>...........................] - ETA: 0s - loss: 0.3653 - acc: 0.8385
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3557 - acc: 0.8457
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3532 - acc: 0.8473
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.3559 - acc: 0.8461
 5056/15235 [========>.....................] - ETA: 0s - loss: 0.3488 - acc: 0.8505
 5888/15235 [==========>...................] - ETA: 0s - loss: 0.3500 - acc: 0.8502
 6720/15235 [============>.................] - ETA: 0s - loss: 0.3508 - acc: 0.8485
 7552/15235 [=============>................] - ETA: 0s - loss: 0.3520 - acc: 0.8483
 8384/15235 [===============>..............] - ETA: 0s - loss: 0.3506 - acc: 0.8498
 9152/15235 [=================>............] - ETA: 0s - loss: 0.3529 - acc: 0.8480
 9984/15235 [==================>...........] - ETA: 0s - loss: 0.3528 - acc: 0.8489
10752/15235 [====================>.........] - ETA: 0s - loss: 0.3525 - acc: 0.8496
11584/15235 [=====================>........] - ETA: 0s - loss: 0.3526 - acc: 0.8481
12352/15235 [=======================>......] - ETA: 0s - loss: 0.3533 - acc: 0.8479
13120/15235 [========================>.....] - ETA: 0s - loss: 0.3536 - acc: 0.8475
13952/15235 [==========================>...] - ETA: 0s - loss: 0.3563 - acc: 0.8465
14784/15235 [============================>.] - ETA: 0s - loss: 0.3571 - acc: 0.8458
15235/15235 [==============================] - 1s 64us/step - loss: 0.3575 - acc: 0.8455

Test accuracy: 83.9851024208566

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  862

choose_one :  749

F1score :  0.833976833976834

AUC : 0.92290661652513

Confusion Matrix
[[705 101]
 [157 648]]
True label 0
0.8746898263027295  
0.12531017369727046  
True label 1
0.19503105590062111  
0.8049689440993789  

Train_result {'acc': [0.845487364624851], 'loss': [0.3575462485732976]}
Saved model to disk



5

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2810 - acc: 0.8594
  960/15235 [>.............................] - ETA: 0s - loss: 0.3225 - acc: 0.8750
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3265 - acc: 0.8655
 2624/15235 [====>.........................] - ETA: 0s - loss: 0.3424 - acc: 0.8533
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3456 - acc: 0.8523
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.3454 - acc: 0.8539
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.3464 - acc: 0.8546
 5760/15235 [==========>...................] - ETA: 0s - loss: 0.3447 - acc: 0.8559
 6592/15235 [===========>..................] - ETA: 0s - loss: 0.3488 - acc: 0.8521
 7424/15235 [=============>................] - ETA: 0s - loss: 0.3495 - acc: 0.8518
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.3517 - acc: 0.8517
 9088/15235 [================>.............] - ETA: 0s - loss: 0.3514 - acc: 0.8505
 9920/15235 [==================>...........] - ETA: 0s - loss: 0.3532 - acc: 0.8491
10752/15235 [====================>.........] - ETA: 0s - loss: 0.3523 - acc: 0.8481
11584/15235 [=====================>........] - ETA: 0s - loss: 0.3513 - acc: 0.8482
12416/15235 [=======================>......] - ETA: 0s - loss: 0.3516 - acc: 0.8484
13248/15235 [=========================>....] - ETA: 0s - loss: 0.3517 - acc: 0.8484
14016/15235 [==========================>...] - ETA: 0s - loss: 0.3537 - acc: 0.8476
14848/15235 [============================>.] - ETA: 0s - loss: 0.3535 - acc: 0.8480
15235/15235 [==============================] - 1s 64us/step - loss: 0.3533 - acc: 0.8480

Test accuracy: 81.56424581005587

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  587

choose_one :  1024

F1score :  0.8376161837069437

AUC : 0.9174552656319838

Confusion Matrix
[[548 258]
 [ 39 766]]
True label 0
0.6799007444168734  
0.3200992555831266  
True label 1
0.0484472049689441  
0.9515527950310559  

Train_result {'acc': [0.8479816212668199], 'loss': [0.3533331146240626]}
Saved model to disk



6

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4832 - acc: 0.7656
  896/15235 [>.............................] - ETA: 0s - loss: 0.3485 - acc: 0.8560
 1728/15235 [==>...........................] - ETA: 0s - loss: 0.3637 - acc: 0.8397
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3576 - acc: 0.8430
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3532 - acc: 0.8452
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.3529 - acc: 0.8433
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.3488 - acc: 0.8446
 5824/15235 [==========>...................] - ETA: 0s - loss: 0.3502 - acc: 0.8443
 6656/15235 [============>.................] - ETA: 0s - loss: 0.3465 - acc: 0.8468
 7488/15235 [=============>................] - ETA: 0s - loss: 0.3465 - acc: 0.8472
 8320/15235 [===============>..............] - ETA: 0s - loss: 0.3455 - acc: 0.8493
 9152/15235 [=================>............] - ETA: 0s - loss: 0.3461 - acc: 0.8482
 9984/15235 [==================>...........] - ETA: 0s - loss: 0.3445 - acc: 0.8503
10816/15235 [====================>.........] - ETA: 0s - loss: 0.3467 - acc: 0.8494
11712/15235 [======================>.......] - ETA: 0s - loss: 0.3451 - acc: 0.8508
12544/15235 [=======================>......] - ETA: 0s - loss: 0.3438 - acc: 0.8515
13440/15235 [=========================>....] - ETA: 0s - loss: 0.3433 - acc: 0.8508
14272/15235 [===========================>..] - ETA: 0s - loss: 0.3421 - acc: 0.8515
15104/15235 [============================>.] - ETA: 0s - loss: 0.3417 - acc: 0.8504
15235/15235 [==============================] - 1s 62us/step - loss: 0.3424 - acc: 0.8501

Test accuracy: 63.625077591558046

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  1354

choose_one :  257

F1score :  0.448210922787194

AUC : 0.8895881818041707

Confusion Matrix
[[787  19]
 [567 238]]
True label 0
0.9764267990074442  
0.02357320099255583  
True label 1
0.7043478260869566  
0.2956521739130435  

Train_result {'acc': [0.8500820479198953], 'loss': [0.3424435401749212]}
Saved model to disk



7

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.7661 - acc: 0.6406
  896/15235 [>.............................] - ETA: 0s - loss: 0.3424 - acc: 0.8549
 1664/15235 [==>...........................] - ETA: 0s - loss: 0.3348 - acc: 0.8570
 2432/15235 [===>..........................] - ETA: 0s - loss: 0.3335 - acc: 0.8553
 3264/15235 [=====>........................] - ETA: 0s - loss: 0.3343 - acc: 0.8551
 4096/15235 [=======>......................] - ETA: 0s - loss: 0.3359 - acc: 0.8564
 4928/15235 [========>.....................] - ETA: 0s - loss: 0.3393 - acc: 0.8545
 5760/15235 [==========>...................] - ETA: 0s - loss: 0.3372 - acc: 0.8547
 6592/15235 [===========>..................] - ETA: 0s - loss: 0.3357 - acc: 0.8560
 7488/15235 [=============>................] - ETA: 0s - loss: 0.3394 - acc: 0.8534
 8320/15235 [===============>..............] - ETA: 0s - loss: 0.3327 - acc: 0.8569
 9152/15235 [=================>............] - ETA: 0s - loss: 0.3341 - acc: 0.8562
 9984/15235 [==================>...........] - ETA: 0s - loss: 0.3354 - acc: 0.8561
10816/15235 [====================>.........] - ETA: 0s - loss: 0.3369 - acc: 0.8560
11712/15235 [======================>.......] - ETA: 0s - loss: 0.3371 - acc: 0.8557
12544/15235 [=======================>......] - ETA: 0s - loss: 0.3357 - acc: 0.8564
13312/15235 [=========================>....] - ETA: 0s - loss: 0.3361 - acc: 0.8563
14144/15235 [==========================>...] - ETA: 0s - loss: 0.3350 - acc: 0.8565
14976/15235 [============================>.] - ETA: 0s - loss: 0.3366 - acc: 0.8553
15235/15235 [==============================] - 1s 63us/step - loss: 0.3358 - acc: 0.8557

Test accuracy: 75.91558038485414

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  1098

choose_one :  513

F1score :  0.7056145675265553

AUC : 0.91643650879275

Confusion Matrix
[[758  48]
 [340 465]]
True label 0
0.9404466501240695  
0.05955334987593052  
True label 1
0.422360248447205  
0.577639751552795  

Train_result {'acc': [0.8557269445375649], 'loss': [0.3358132179346013]}
Saved model to disk



8

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4078 - acc: 0.7969
  896/15235 [>.............................] - ETA: 0s - loss: 0.3431 - acc: 0.8504
 1728/15235 [==>...........................] - ETA: 0s - loss: 0.3352 - acc: 0.8542
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3258 - acc: 0.8566
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3264 - acc: 0.8564
 4224/15235 [=======>......................] - ETA: 0s - loss: 0.3320 - acc: 0.8537
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.3298 - acc: 0.8546
 5760/15235 [==========>...................] - ETA: 0s - loss: 0.3279 - acc: 0.8559
 6528/15235 [===========>..................] - ETA: 0s - loss: 0.3242 - acc: 0.8591
 7360/15235 [=============>................] - ETA: 0s - loss: 0.3267 - acc: 0.8577
 8192/15235 [===============>..............] - ETA: 0s - loss: 0.3252 - acc: 0.8590
 9024/15235 [================>.............] - ETA: 0s - loss: 0.3311 - acc: 0.8557
 9856/15235 [==================>...........] - ETA: 0s - loss: 0.3317 - acc: 0.8564
10624/15235 [===================>..........] - ETA: 0s - loss: 0.3314 - acc: 0.8566
11392/15235 [=====================>........] - ETA: 0s - loss: 0.3304 - acc: 0.8573
12160/15235 [======================>.......] - ETA: 0s - loss: 0.3321 - acc: 0.8576
12928/15235 [========================>.....] - ETA: 0s - loss: 0.3327 - acc: 0.8579
13760/15235 [==========================>...] - ETA: 0s - loss: 0.3342 - acc: 0.8570
14592/15235 [===========================>..] - ETA: 0s - loss: 0.3335 - acc: 0.8574
15235/15235 [==============================] - 1s 64us/step - loss: 0.3335 - acc: 0.8570

Test accuracy: 85.90937306021105

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  747

choose_one :  864

F1score :  0.8639904134212103

AUC : 0.9293674768429326

Confusion Matrix
[[663 143]
 [ 84 721]]
True label 0
0.8225806451612904  
0.1774193548387097  
True label 1
0.10434782608695652  
0.8956521739130435  

Train_result {'acc': [0.8569740728585494], 'loss': [0.3335300383682833]}
Saved model to disk



9

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2442 - acc: 0.9062
 1088/15235 [=>............................] - ETA: 0s - loss: 0.3238 - acc: 0.8612
 2048/15235 [===>..........................] - ETA: 0s - loss: 0.3266 - acc: 0.8540
 3136/15235 [=====>........................] - ETA: 0s - loss: 0.3285 - acc: 0.8533
 4352/15235 [=======>......................] - ETA: 0s - loss: 0.3296 - acc: 0.8527
 5440/15235 [=========>....................] - ETA: 0s - loss: 0.3284 - acc: 0.8566
 6272/15235 [===========>..................] - ETA: 0s - loss: 0.3291 - acc: 0.8570
 7104/15235 [============>.................] - ETA: 0s - loss: 0.3294 - acc: 0.8561
 7936/15235 [==============>...............] - ETA: 0s - loss: 0.3311 - acc: 0.8556
 8768/15235 [================>.............] - ETA: 0s - loss: 0.3286 - acc: 0.8571
 9600/15235 [=================>............] - ETA: 0s - loss: 0.3276 - acc: 0.8577
10432/15235 [===================>..........] - ETA: 0s - loss: 0.3311 - acc: 0.8571
11200/15235 [=====================>........] - ETA: 0s - loss: 0.3310 - acc: 0.8578
11968/15235 [======================>.......] - ETA: 0s - loss: 0.3302 - acc: 0.8581
12800/15235 [========================>.....] - ETA: 0s - loss: 0.3316 - acc: 0.8574
13568/15235 [=========================>....] - ETA: 0s - loss: 0.3306 - acc: 0.8584
14400/15235 [===========================>..] - ETA: 0s - loss: 0.3304 - acc: 0.8583
15232/15235 [============================>.] - ETA: 0s - loss: 0.3283 - acc: 0.8602
15235/15235 [==============================] - 1s 58us/step - loss: 0.3283 - acc: 0.8603

Test accuracy: 84.0471756672874

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  679

choose_one :  932

F1score :  0.8520437535981578

AUC : 0.9285475394171046

Confusion Matrix
[[614 192]
 [ 65 740]]
True label 0
0.7617866004962779  
0.23821339950372208  
True label 1
0.08074534161490683  
0.9192546583850931  

Train_result {'acc': [0.8602559894978667], 'loss': [0.3282847172585244]}
Saved model to disk



10

Epoch 1/1

   64/15235 [..............................] - ETA: 0s - loss: 0.2945 - acc: 0.8594
  960/15235 [>.............................] - ETA: 0s - loss: 0.3527 - acc: 0.8375
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3441 - acc: 0.8421
 2624/15235 [====>.........................] - ETA: 0s - loss: 0.3326 - acc: 0.8502
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.3320 - acc: 0.8533
 4288/15235 [=======>......................] - ETA: 0s - loss: 0.3312 - acc: 0.8559
 5184/15235 [=========>....................] - ETA: 0s - loss: 0.3262 - acc: 0.8584
 6016/15235 [==========>...................] - ETA: 0s - loss: 0.3313 - acc: 0.8557
 6848/15235 [============>.................] - ETA: 0s - loss: 0.3308 - acc: 0.8541
 7616/15235 [=============>................] - ETA: 0s - loss: 0.3315 - acc: 0.8539
 8448/15235 [===============>..............] - ETA: 0s - loss: 0.3284 - acc: 0.8561
 9280/15235 [=================>............] - ETA: 0s - loss: 0.3247 - acc: 0.8570
10048/15235 [==================>...........] - ETA: 0s - loss: 0.3250 - acc: 0.8575
10816/15235 [====================>.........] - ETA: 0s - loss: 0.3249 - acc: 0.8579
11584/15235 [=====================>........] - ETA: 0s - loss: 0.3231 - acc: 0.8595
12352/15235 [=======================>......] - ETA: 0s - loss: 0.3227 - acc: 0.8606
13120/15235 [========================>.....] - ETA: 0s - loss: 0.3216 - acc: 0.8611
13952/15235 [==========================>...] - ETA: 0s - loss: 0.3232 - acc: 0.8603
14784/15235 [============================>.] - ETA: 0s - loss: 0.3216 - acc: 0.8615
15235/15235 [==============================] - 1s 64us/step - loss: 0.3221 - acc: 0.8611

Test accuracy: 82.06083178150217

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  953

choose_one :  658

F1score :  0.8024606971975393

AUC : 0.9275673134719418

Confusion Matrix
[[735  71]
 [218 587]]
True label 0
0.9119106699751861  
0.0880893300248139  
True label 1
0.2708074534161491  
0.7291925465838509  

Train_result {'acc': [0.8611092878280017], 'loss': [0.3221479466675851]}
Saved model to disk



11

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.4435 - acc: 0.7656
  960/15235 [>.............................] - ETA: 0s - loss: 0.3377 - acc: 0.8531
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3200 - acc: 0.8622
 2624/15235 [====>.........................] - ETA: 0s - loss: 0.3097 - acc: 0.8655
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.3150 - acc: 0.8617
 4288/15235 [=======>......................] - ETA: 0s - loss: 0.3266 - acc: 0.8566
 5056/15235 [========>.....................] - ETA: 0s - loss: 0.3285 - acc: 0.8556
 5824/15235 [==========>...................] - ETA: 0s - loss: 0.3321 - acc: 0.8544
 6656/15235 [============>.................] - ETA: 0s - loss: 0.3321 - acc: 0.8543
 7488/15235 [=============>................] - ETA: 0s - loss: 0.3293 - acc: 0.8560
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.3273 - acc: 0.8571
 9088/15235 [================>.............] - ETA: 0s - loss: 0.3258 - acc: 0.8578
 9856/15235 [==================>...........] - ETA: 0s - loss: 0.3240 - acc: 0.8586
10688/15235 [====================>.........] - ETA: 0s - loss: 0.3223 - acc: 0.8594
11520/15235 [=====================>........] - ETA: 0s - loss: 0.3238 - acc: 0.8594
12352/15235 [=======================>......] - ETA: 0s - loss: 0.3221 - acc: 0.8596
13184/15235 [========================>.....] - ETA: 0s - loss: 0.3238 - acc: 0.8593
14016/15235 [==========================>...] - ETA: 0s - loss: 0.3231 - acc: 0.8606
14848/15235 [============================>.] - ETA: 0s - loss: 0.3230 - acc: 0.8613
15235/15235 [==============================] - 1s 64us/step - loss: 0.3211 - acc: 0.8624

Test accuracy: 85.22656734947238

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  800

choose_one :  811

F1score :  0.8527227722772278

AUC : 0.9281961376631782

Confusion Matrix
[[684 122]
 [116 689]]
True label 0
0.8486352357320099  
0.1513647642679901  
True label 1
0.14409937888198757  
0.8559006211180125  

Train_result {'acc': [0.8624220544837286], 'loss': [0.3211305500876524]}
Saved model to disk



12

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2073 - acc: 0.9531
  896/15235 [>.............................] - ETA: 0s - loss: 0.2847 - acc: 0.8806
 1728/15235 [==>...........................] - ETA: 0s - loss: 0.3154 - acc: 0.8628
 2560/15235 [====>.........................] - ETA: 0s - loss: 0.3263 - acc: 0.8559
 3392/15235 [=====>........................] - ETA: 0s - loss: 0.3239 - acc: 0.8576
 4160/15235 [=======>......................] - ETA: 0s - loss: 0.3239 - acc: 0.8587
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.3178 - acc: 0.8608
 5824/15235 [==========>...................] - ETA: 0s - loss: 0.3184 - acc: 0.8604
 6656/15235 [============>.................] - ETA: 0s - loss: 0.3137 - acc: 0.8630
 7424/15235 [=============>................] - ETA: 0s - loss: 0.3178 - acc: 0.8599
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.3154 - acc: 0.8607
 9088/15235 [================>.............] - ETA: 0s - loss: 0.3157 - acc: 0.8598
 9920/15235 [==================>...........] - ETA: 0s - loss: 0.3132 - acc: 0.8617
10688/15235 [====================>.........] - ETA: 0s - loss: 0.3124 - acc: 0.8622
11456/15235 [=====================>........] - ETA: 0s - loss: 0.3116 - acc: 0.8632
12288/15235 [=======================>......] - ETA: 0s - loss: 0.3114 - acc: 0.8635
13120/15235 [========================>.....] - ETA: 0s - loss: 0.3117 - acc: 0.8637
13952/15235 [==========================>...] - ETA: 0s - loss: 0.3128 - acc: 0.8635
14784/15235 [============================>.] - ETA: 0s - loss: 0.3138 - acc: 0.8637
15235/15235 [==============================] - 1s 65us/step - loss: 0.3136 - acc: 0.8640

Test accuracy: 85.53693358162631

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  715

choose_one :  896

F1score :  0.8630217519106408

AUC : 0.930790037452029

Confusion Matrix
[[644 162]
 [ 71 734]]
True label 0
0.7990074441687345  
0.20099255583126552  
True label 1
0.08819875776397515  
0.9118012422360249  

Train_result {'acc': [0.8639973744666886], 'loss': [0.31359306393361774]}
Saved model to disk



13

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.3584 - acc: 0.8594
 1024/15235 [=>............................] - ETA: 0s - loss: 0.3314 - acc: 0.8564
 2048/15235 [===>..........................] - ETA: 0s - loss: 0.3152 - acc: 0.8628
 3072/15235 [=====>........................] - ETA: 0s - loss: 0.3057 - acc: 0.8665
 4096/15235 [=======>......................] - ETA: 0s - loss: 0.3145 - acc: 0.8623
 4992/15235 [========>.....................] - ETA: 0s - loss: 0.3194 - acc: 0.8598
 5824/15235 [==========>...................] - ETA: 0s - loss: 0.3147 - acc: 0.8621
 6656/15235 [============>.................] - ETA: 0s - loss: 0.3149 - acc: 0.8628
 7488/15235 [=============>................] - ETA: 0s - loss: 0.3162 - acc: 0.8614
 8256/15235 [===============>..............] - ETA: 0s - loss: 0.3133 - acc: 0.8636
 8832/15235 [================>.............] - ETA: 0s - loss: 0.3130 - acc: 0.8650
 9600/15235 [=================>............] - ETA: 0s - loss: 0.3143 - acc: 0.8641
10368/15235 [===================>..........] - ETA: 0s - loss: 0.3145 - acc: 0.8650
11200/15235 [=====================>........] - ETA: 0s - loss: 0.3119 - acc: 0.8655
11968/15235 [======================>.......] - ETA: 0s - loss: 0.3139 - acc: 0.8639
12736/15235 [========================>.....] - ETA: 0s - loss: 0.3146 - acc: 0.8638
13504/15235 [=========================>....] - ETA: 0s - loss: 0.3157 - acc: 0.8636
14272/15235 [===========================>..] - ETA: 0s - loss: 0.3148 - acc: 0.8638
15104/15235 [============================>.] - ETA: 0s - loss: 0.3141 - acc: 0.8647
15235/15235 [==============================] - 1s 62us/step - loss: 0.3143 - acc: 0.8647

Test accuracy: 86.1576660459342

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  731

choose_one :  880

F1score :  0.8676557863501484

AUC : 0.9355586209022393

Confusion Matrix
[[657 149]
 [ 74 731]]
True label 0
0.815136476426799  
0.184863523573201  
True label 1
0.09192546583850932  
0.9080745341614906  

Train_result {'acc': [0.864653757794552], 'loss': [0.31425164644742426]}
Saved model to disk



14

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.2397 - acc: 0.9219
  960/15235 [>.............................] - ETA: 0s - loss: 0.3427 - acc: 0.8458
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3221 - acc: 0.8588
 2624/15235 [====>.........................] - ETA: 0s - loss: 0.3133 - acc: 0.8613
 3456/15235 [=====>........................] - ETA: 0s - loss: 0.3074 - acc: 0.8637
 4288/15235 [=======>......................] - ETA: 0s - loss: 0.3105 - acc: 0.8629
 5120/15235 [=========>....................] - ETA: 0s - loss: 0.3061 - acc: 0.8668
 5952/15235 [==========>...................] - ETA: 0s - loss: 0.3030 - acc: 0.8681
 6784/15235 [============>.................] - ETA: 0s - loss: 0.3099 - acc: 0.8653
 7616/15235 [=============>................] - ETA: 0s - loss: 0.3107 - acc: 0.8667
 8448/15235 [===============>..............] - ETA: 0s - loss: 0.3089 - acc: 0.8683
 9216/15235 [=================>............] - ETA: 0s - loss: 0.3077 - acc: 0.8684
10048/15235 [==================>...........] - ETA: 0s - loss: 0.3077 - acc: 0.8683
10880/15235 [====================>.........] - ETA: 0s - loss: 0.3068 - acc: 0.8697
11712/15235 [======================>.......] - ETA: 0s - loss: 0.3070 - acc: 0.8697
12544/15235 [=======================>......] - ETA: 0s - loss: 0.3079 - acc: 0.8698
13440/15235 [=========================>....] - ETA: 0s - loss: 0.3100 - acc: 0.8680
14272/15235 [===========================>..] - ETA: 0s - loss: 0.3108 - acc: 0.8674
15104/15235 [============================>.] - ETA: 0s - loss: 0.3102 - acc: 0.8677
15235/15235 [==============================] - 1s 63us/step - loss: 0.3102 - acc: 0.8678

Test accuracy: 86.1576660459342

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  769

choose_one :  842

F1score :  0.8646023072252581

AUC : 0.9340851995129695

Confusion Matrix
[[676 130]
 [ 93 712]]
True label 0
0.8387096774193549  
0.16129032258064516  
True label 1
0.115527950310559  
0.884472049689441  

Train_result {'acc': [0.8678043977682967], 'loss': [0.310185848676771]}
Saved model to disk



15

Epoch 1/1

   64/15235 [..............................] - ETA: 1s - loss: 0.1618 - acc: 0.9531
  960/15235 [>.............................] - ETA: 0s - loss: 0.3345 - acc: 0.8583
 1792/15235 [==>...........................] - ETA: 0s - loss: 0.3276 - acc: 0.8605
 2624/15235 [====>.........................] - ETA: 0s - loss: 0.3225 - acc: 0.8647
 3520/15235 [=====>........................] - ETA: 0s - loss: 0.3112 - acc: 0.8676
 4352/15235 [=======>......................] - ETA: 0s - loss: 0.3090 - acc: 0.8683
 5184/15235 [=========>....................] - ETA: 0s - loss: 0.3068 - acc: 0.8696
 6016/15235 [==========>...................] - ETA: 0s - loss: 0.3038 - acc: 0.8727
 6784/15235 [============>.................] - ETA: 0s - loss: 0.3054 - acc: 0.8729
 7552/15235 [=============>................] - ETA: 0s - loss: 0.3020 - acc: 0.8742
 8320/15235 [===============>..............] - ETA: 0s - loss: 0.3007 - acc: 0.8746
 9088/15235 [================>.............] - ETA: 0s - loss: 0.3025 - acc: 0.8731
 9920/15235 [==================>...........] - ETA: 0s - loss: 0.3019 - acc: 0.8735
10688/15235 [====================>.........] - ETA: 0s - loss: 0.3028 - acc: 0.8732
11456/15235 [=====================>........] - ETA: 0s - loss: 0.3017 - acc: 0.8741
12288/15235 [=======================>......] - ETA: 0s - loss: 0.3025 - acc: 0.8735
13056/15235 [========================>.....] - ETA: 0s - loss: 0.3049 - acc: 0.8721
13888/15235 [==========================>...] - ETA: 0s - loss: 0.3058 - acc: 0.8714
14720/15235 [===========================>..] - ETA: 0s - loss: 0.3070 - acc: 0.8707
15235/15235 [==============================] - 1s 63us/step - loss: 0.3083 - acc: 0.8703

Test accuracy: 85.22656734947238

data size :  16846

zero :  8424

one :  8422

train_zero :  7618

train_one :  7617

test_zero :  806

test_one :  805

choose_zero :  814

choose_one :  797

F1score :  0.8514357053682896

AUC : 0.9334532928502074

Confusion Matrix
[[691 115]
 [123 682]]
True label 0
0.8573200992555832  
0.14267990074441686  
True label 1
0.15279503105590062  
0.8472049689440994  

Train_result {'acc': [0.8702986544141779], 'loss': [0.30832759331768755]}
Saved model to disk



[[81.31595282433271, 1], [84.35754189944134, 2], [84.48168839230293, 3], [83.9851024208566, 4], [81.56424581005587, 5], [63.625077591558046, 6], [75.91558038485414, 7], [85.90937306021105, 8], [84.0471756672874, 9], [82.06083178150217, 10], [85.22656734947238, 11], [85.53693358162631, 12], [86.1576660459342, 13], [86.1576660459342, 14], [85.22656734947238, 15]]
max accuracy :  [86.1576660459342, 14]

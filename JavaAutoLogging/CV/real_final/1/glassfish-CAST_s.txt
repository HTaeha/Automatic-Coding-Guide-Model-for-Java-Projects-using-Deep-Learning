Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 00:32:47.526344: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 00:32:47.536920: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-02 00:32:47.539423: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6bff8b0 executing computations on platform Host. Devices:
2019-08-02 00:32:47.539462: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST_s
all data

Sentence length Average : 51

Under 10 : 10903
Over 10, Under 200 : 26333
Over 200, Under 400 : 1747
Over 400 : 459

glassfish-CAST_s
updated_train_data

Sentence length Average : 64

Under 10 : 0
Over 10, Under 200 : 22912
Over 200, Under 400 : 1823
Over 400 : 0


Test_zero:  2143
Train_zero:  18870
zero:  21013
Test_one:  610
Train_one:  5865
one:  6475

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 255s - loss: 0.4624 - acc: 0.7883

Test accuracy: 85.25798525798525

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  653

choose_one :  568

F1score :  0.8471986417657045

AUC : 0.9347267312387647

Confusion Matrix
[[542  69]
 [111 499]]
True label 0
0.8870703764320785  
0.11292962356792144  
True label 1
0.1819672131147541  
0.8180327868852459  

Train_result {'loss': [0.4623602005300513], 'acc': [0.7882533458459815]}
2

Epoch 1/1
 - 257s - loss: 0.3423 - acc: 0.8554

Test accuracy: 86.73218673218673

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  639

choose_one :  582

F1score :  0.8640939597315436

AUC : 0.9503689195352956

Confusion Matrix
[[544  67]
 [ 95 515]]
True label 0
0.8903436988543372  
0.10965630114566285  
True label 1
0.1557377049180328  
0.8442622950819673  

Train_result {'loss': [0.34234827492418174], 'acc': [0.855425794937962]}
3

Epoch 1/1
 - 258s - loss: 0.2841 - acc: 0.8825

Test accuracy: 89.76248976248976

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  630

choose_one :  591

F1score :  0.8959200666111573

AUC : 0.9640632126854659

Confusion Matrix
[[558  53]
 [ 72 538]]
True label 0
0.9132569558101473  
0.0867430441898527  
True label 1
0.1180327868852459  
0.8819672131147541  

Train_result {'loss': [0.28409503845988754], 'acc': [0.8825334583581962]}
4

Epoch 1/1
 - 258s - loss: 0.2481 - acc: 0.8975

Test accuracy: 90.09009009009009

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  662

choose_one :  559

F1score :  0.8964927288280583

AUC : 0.9639934533551555

Confusion Matrix
[[576  35]
 [ 86 524]]
True label 0
0.9427168576104746  
0.057283142389525366  
True label 1
0.14098360655737704  
0.8590163934426229  

Train_result {'loss': [0.24807352325364193], 'acc': [0.8974511976813571]}
5

Epoch 1/1
 - 259s - loss: 0.2136 - acc: 0.9143

Test accuracy: 90.82719082719083

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  669

choose_one :  552

F1score :  0.9036144578313252

AUC : 0.966877733358375

Confusion Matrix
[[584  27]
 [ 85 525]]
True label 0
0.955810147299509  
0.044189852700491  
True label 1
0.13934426229508196  
0.860655737704918  

Train_result {'loss': [0.21361448669456967], 'acc': [0.9143295541473]}
6

Epoch 1/1
 - 259s - loss: 0.1833 - acc: 0.9274

Test accuracy: 90.82719082719083

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  623

choose_one :  598

F1score :  0.9072847682119206

AUC : 0.9692066217702773

Confusion Matrix
[[561  50]
 [ 62 548]]
True label 0
0.9181669394435352  
0.08183306055646482  
True label 1
0.10163934426229508  
0.898360655737705  

Train_result {'loss': [0.18325479700303973], 'acc': [0.9273719205879493]}
7

Epoch 1/1
 - 258s - loss: 0.1603 - acc: 0.9419

Test accuracy: 89.92628992628993

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  590

choose_one :  631

F1score :  0.9008863819500403

AUC : 0.962684124386252

Confusion Matrix
[[539  72]
 [ 51 559]]
True label 0
0.8821603927986906  
0.11783960720130933  
True label 1
0.08360655737704918  
0.9163934426229509  

Train_result {'loss': [0.16034364017183422], 'acc': [0.9418634387977531]}
8

Epoch 1/1
 - 258s - loss: 0.1378 - acc: 0.9471

Test accuracy: 90.9090909090909

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  658

choose_one :  563

F1score :  0.9053708439897697

AUC : 0.9672936062890719

Confusion Matrix
[[579  32]
 [ 79 531]]
True label 0
0.9476268412438625  
0.05237315875613748  
True label 1
0.12950819672131147  
0.8704918032786885  

Train_result {'loss': [0.13781186483096064], 'acc': [0.9470633364335501]}
9

Epoch 1/1
 - 260s - loss: 0.1205 - acc: 0.9554

Test accuracy: 89.51678951678952

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  567

choose_one :  654

F1score :  0.8987341772151899

AUC : 0.9632851278473882

Confusion Matrix
[[525  86]
 [ 42 568]]
True label 0
0.8592471358428805  
0.1407528641571195  
True label 1
0.06885245901639345  
0.9311475409836065  

Train_result {'loss': [0.12048451246792333], 'acc': [0.9554172704900868]}
10

Epoch 1/1
 - 259s - loss: 0.0965 - acc: 0.9633

Test accuracy: 90.990990990991

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  605

choose_one :  616

F1score :  0.9102773246329527

AUC : 0.964524697485981

Confusion Matrix
[[553  58]
 [ 52 558]]
True label 0
0.9050736497545008  
0.09492635024549918  
True label 1
0.08524590163934426  
0.9147540983606557  

Train_result {'loss': [0.09647859419761451], 'acc': [0.9632597391526724]}
11

Epoch 1/1
 - 261s - loss: 0.0861 - acc: 0.9708

Test accuracy: 91.07289107289107

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  626

choose_one :  595

F1score :  0.9095435684647303

AUC : 0.9622534946741435

Confusion Matrix
[[564  47]
 [ 62 548]]
True label 0
0.9230769230769231  
0.07692307692307693  
True label 1
0.10163934426229508  
0.898360655737705  

Train_result {'loss': [0.08607279284727887], 'acc': [0.9708464751868752]}
12

Epoch 1/1
 - 260s - loss: 0.0714 - acc: 0.9756

Test accuracy: 90.82719082719083

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  631

choose_one :  590

F1score :  0.9066666666666666

AUC : 0.9640980923506212

Confusion Matrix
[[565  46]
 [ 66 544]]
True label 0
0.9247135842880524  
0.07528641571194762  
True label 1
0.10819672131147541  
0.8918032786885246  

Train_result {'loss': [0.0714271217373433], 'acc': [0.9756201517347199]}
13

Epoch 1/1
 - 260s - loss: 0.0686 - acc: 0.9772

Test accuracy: 90.25389025389026

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  624

choose_one :  597

F1score :  0.9014084507042253

AUC : 0.9604746317512275

Confusion Matrix
[[558  53]
 [ 66 544]]
True label 0
0.9132569558101473  
0.0867430441898527  
True label 1
0.10819672131147541  
0.8918032786885246  

Train_result {'loss': [0.06864347352816423], 'acc': [0.9772397920396584]}
14

Epoch 1/1
 - 260s - loss: 0.0599 - acc: 0.9806

Test accuracy: 90.33579033579034

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  601

choose_one :  620

F1score :  0.9040650406504065

AUC : 0.9644509135789219

Confusion Matrix
[[547  64]
 [ 54 556]]
True label 0
0.8952536824877251  
0.10474631751227496  
True label 1
0.08852459016393442  
0.9114754098360656  

Train_result {'loss': [0.05990075873702132], 'acc': [0.9805643168031056]}
15

Epoch 1/1
 - 262s - loss: 0.0515 - acc: 0.9831

Test accuracy: 90.58149058149058

data size :  12952

zero :  6477

one :  6475

train_zero :  5866

train_one :  5865

test_zero :  611

test_one :  610

choose_zero :  624

choose_one :  597

F1score :  0.9047224523612262

AUC : 0.9638928389364385

Confusion Matrix
[[560  51]
 [ 64 546]]
True label 0
0.9165302782324058  
0.08346972176759411  
True label 1
0.10491803278688525  
0.8950819672131147  

Train_result {'loss': [0.05146215993253045], 'acc': [0.9831216435086523]}
Saved model to disk




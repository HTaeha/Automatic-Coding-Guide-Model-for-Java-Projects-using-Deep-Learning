Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_MLP.py:404: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-22 01:43:30.296310: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-22 01:43:30.307280: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-22 01:43:30.309926: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x80c40c0 executing computations on platform Host. Devices:
2019-08-22 01:43:30.309965: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-code
all data

Sentence length Average : 55

Under 10 : 8165
Over 10, Under 200 : 37669
Over 200, Under 400 : 2147
Over 400 : 489

hbase-code
updated_train_data

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 29835
Over 200, Under 400 : 1382
Over 400 : 0


Test_zero:  2643
Train_zero:  23540
zero:  26183
Test_one:  812
Train_one:  7677
one:  8489

Count model parameter.
Get a short summary of each layer dimensions and parameters.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 200)               0         
_________________________________________________________________
masking_1 (Masking)          (None, 200)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               51456     
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 256)               65792     
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 514       
=================================================================
Total params: 117,762
Trainable params: 117,762
Non-trainable params: 0
_________________________________________________________________
1

Epoch 1/1

   64/15355 [..............................] - ETA: 1:27 - loss: 0.7028 - acc: 0.4844
  768/15355 [>.............................] - ETA: 7s - loss: 0.6481 - acc: 0.6172  
 1600/15355 [==>...........................] - ETA: 4s - loss: 0.6056 - acc: 0.6681
 2432/15355 [===>..........................] - ETA: 2s - loss: 0.5986 - acc: 0.6756
 3200/15355 [=====>........................] - ETA: 2s - loss: 0.5787 - acc: 0.6928
 3968/15355 [======>.......................] - ETA: 1s - loss: 0.5719 - acc: 0.6991
 4800/15355 [========>.....................] - ETA: 1s - loss: 0.5583 - acc: 0.7113
 5632/15355 [==========>...................] - ETA: 1s - loss: 0.5501 - acc: 0.7163
 6400/15355 [===========>..................] - ETA: 1s - loss: 0.5456 - acc: 0.7202
 7232/15355 [=============>................] - ETA: 0s - loss: 0.5379 - acc: 0.7262
 8064/15355 [==============>...............] - ETA: 0s - loss: 0.5372 - acc: 0.7294
 8896/15355 [================>.............] - ETA: 0s - loss: 0.5300 - acc: 0.7358
 9600/15355 [=================>............] - ETA: 0s - loss: 0.5256 - acc: 0.7386
10368/15355 [===================>..........] - ETA: 0s - loss: 0.5221 - acc: 0.7413
11200/15355 [====================>.........] - ETA: 0s - loss: 0.5177 - acc: 0.7450
12032/15355 [======================>.......] - ETA: 0s - loss: 0.5160 - acc: 0.7468
12864/15355 [========================>.....] - ETA: 0s - loss: 0.5151 - acc: 0.7462
13632/15355 [=========================>....] - ETA: 0s - loss: 0.5134 - acc: 0.7478
14464/15355 [===========================>..] - ETA: 0s - loss: 0.5112 - acc: 0.7496
15232/15355 [============================>.] - ETA: 0s - loss: 0.5091 - acc: 0.7507
15355/15355 [==============================] - 1s 89us/step - loss: 0.5085 - acc: 0.7512

Test accuracy: 78.33846153846153

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  731

choose_one :  894

F1score :  0.7936694021101994

AUC : 0.8656658426190174

Confusion Matrix
[[596 217]
 [135 677]]
True label 0
0.7330873308733087  
0.26691266912669126  
True label 1
0.16625615763546797  
0.833743842364532  

Train_result {'loss': [0.5085000528356843], 'acc': [0.7512211006458634]}
Saved model to disk



2

Epoch 1/1

   64/15355 [..............................] - ETA: 0s - loss: 0.3234 - acc: 0.8594
  896/15355 [>.............................] - ETA: 0s - loss: 0.4695 - acc: 0.7868
 1664/15355 [==>...........................] - ETA: 0s - loss: 0.4491 - acc: 0.8023
 2496/15355 [===>..........................] - ETA: 0s - loss: 0.4498 - acc: 0.7965
 3328/15355 [=====>........................] - ETA: 0s - loss: 0.4502 - acc: 0.7927
 4160/15355 [=======>......................] - ETA: 0s - loss: 0.4453 - acc: 0.7950
 4992/15355 [========>.....................] - ETA: 0s - loss: 0.4506 - acc: 0.7943
 5824/15355 [==========>...................] - ETA: 0s - loss: 0.4531 - acc: 0.7917
 6656/15355 [============>.................] - ETA: 0s - loss: 0.4535 - acc: 0.7909
 7488/15355 [=============>................] - ETA: 0s - loss: 0.4531 - acc: 0.7905
 8256/15355 [===============>..............] - ETA: 0s - loss: 0.4532 - acc: 0.7917
 9024/15355 [================>.............] - ETA: 0s - loss: 0.4547 - acc: 0.7893
 9856/15355 [==================>...........] - ETA: 0s - loss: 0.4558 - acc: 0.7886
10688/15355 [===================>..........] - ETA: 0s - loss: 0.4561 - acc: 0.7875
11584/15355 [=====================>........] - ETA: 0s - loss: 0.4557 - acc: 0.7868
12416/15355 [=======================>......] - ETA: 0s - loss: 0.4543 - acc: 0.7875
13248/15355 [========================>.....] - ETA: 0s - loss: 0.4549 - acc: 0.7874
14080/15355 [==========================>...] - ETA: 0s - loss: 0.4567 - acc: 0.7856
14912/15355 [============================>.] - ETA: 0s - loss: 0.4554 - acc: 0.7870
15355/15355 [==============================] - 1s 63us/step - loss: 0.4555 - acc: 0.7860

Test accuracy: 79.63076923076923

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  810

choose_one :  815

F1score :  0.7965580823601721

AUC : 0.876358769745333

Confusion Matrix
[[646 167]
 [164 648]]
True label 0
0.7945879458794588  
0.2054120541205412  
True label 1
0.2019704433497537  
0.7980295566502463  

Train_result {'loss': [0.4555234123153587], 'acc': [0.7859980462661825]}
Saved model to disk



3

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.4270 - acc: 0.7656
  896/15355 [>.............................] - ETA: 0s - loss: 0.4359 - acc: 0.8013
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.4385 - acc: 0.7969
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.4435 - acc: 0.7922
 3392/15355 [=====>........................] - ETA: 0s - loss: 0.4507 - acc: 0.7886
 4224/15355 [=======>......................] - ETA: 0s - loss: 0.4459 - acc: 0.7945
 5056/15355 [========>.....................] - ETA: 0s - loss: 0.4468 - acc: 0.7935
 5888/15355 [==========>...................] - ETA: 0s - loss: 0.4441 - acc: 0.7957
 6720/15355 [============>.................] - ETA: 0s - loss: 0.4417 - acc: 0.7967
 7552/15355 [=============>................] - ETA: 0s - loss: 0.4412 - acc: 0.7973
 8384/15355 [===============>..............] - ETA: 0s - loss: 0.4409 - acc: 0.7964
 9216/15355 [=================>............] - ETA: 0s - loss: 0.4391 - acc: 0.7961
10048/15355 [==================>...........] - ETA: 0s - loss: 0.4403 - acc: 0.7954
10880/15355 [====================>.........] - ETA: 0s - loss: 0.4409 - acc: 0.7956
11712/15355 [=====================>........] - ETA: 0s - loss: 0.4417 - acc: 0.7958
12544/15355 [=======================>......] - ETA: 0s - loss: 0.4399 - acc: 0.7965
13376/15355 [=========================>....] - ETA: 0s - loss: 0.4405 - acc: 0.7965
14208/15355 [==========================>...] - ETA: 0s - loss: 0.4398 - acc: 0.7967
15040/15355 [============================>.] - ETA: 0s - loss: 0.4398 - acc: 0.7962
15355/15355 [==============================] - 1s 62us/step - loss: 0.4398 - acc: 0.7960

Test accuracy: 80.86153846153846

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  788

choose_one :  837

F1score :  0.8114008489993936

AUC : 0.889049709462612

Confusion Matrix
[[645 168]
 [143 669]]
True label 0
0.7933579335793358  
0.2066420664206642  
True label 1
0.17610837438423646  
0.8238916256157636  

Train_result {'loss': [0.43975805785204913], 'acc': [0.7959622273574004]}
Saved model to disk



4

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.4163 - acc: 0.8125
  896/15355 [>.............................] - ETA: 0s - loss: 0.4177 - acc: 0.8080
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.4190 - acc: 0.8079
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.4280 - acc: 0.8027
 3456/15355 [=====>........................] - ETA: 0s - loss: 0.4148 - acc: 0.8096
 4288/15355 [=======>......................] - ETA: 0s - loss: 0.4216 - acc: 0.8071
 5120/15355 [=========>....................] - ETA: 0s - loss: 0.4207 - acc: 0.8090
 5888/15355 [==========>...................] - ETA: 0s - loss: 0.4211 - acc: 0.8093
 6720/15355 [============>.................] - ETA: 0s - loss: 0.4195 - acc: 0.8089
 7552/15355 [=============>................] - ETA: 0s - loss: 0.4225 - acc: 0.8060
 8384/15355 [===============>..............] - ETA: 0s - loss: 0.4266 - acc: 0.8020
 9216/15355 [=================>............] - ETA: 0s - loss: 0.4241 - acc: 0.8040
10048/15355 [==================>...........] - ETA: 0s - loss: 0.4211 - acc: 0.8059
10944/15355 [====================>.........] - ETA: 0s - loss: 0.4222 - acc: 0.8063
11776/15355 [======================>.......] - ETA: 0s - loss: 0.4214 - acc: 0.8064
12608/15355 [=======================>......] - ETA: 0s - loss: 0.4184 - acc: 0.8082
13440/15355 [=========================>....] - ETA: 0s - loss: 0.4198 - acc: 0.8067
14272/15355 [==========================>...] - ETA: 0s - loss: 0.4196 - acc: 0.8076
15104/15355 [============================>.] - ETA: 0s - loss: 0.4182 - acc: 0.8086
15355/15355 [==============================] - 1s 62us/step - loss: 0.4176 - acc: 0.8092

Test accuracy: 78.58461538461539

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  945

choose_one :  680

F1score :  0.7667560321715817

AUC : 0.8909401717169881

Confusion Matrix
[[705 108]
 [240 572]]
True label 0
0.8671586715867159  
0.13284132841328414  
True label 1
0.2955665024630542  
0.7044334975369458  

Train_result {'loss': [0.4176493398512819], 'acc': [0.809182676637029]}
Saved model to disk



5

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.3400 - acc: 0.8125
  832/15355 [>.............................] - ETA: 0s - loss: 0.4027 - acc: 0.8173
 1600/15355 [==>...........................] - ETA: 0s - loss: 0.3855 - acc: 0.8225
 2432/15355 [===>..........................] - ETA: 0s - loss: 0.3965 - acc: 0.8183
 3264/15355 [=====>........................] - ETA: 0s - loss: 0.3962 - acc: 0.8217
 4096/15355 [=======>......................] - ETA: 0s - loss: 0.4049 - acc: 0.8203
 4928/15355 [========>.....................] - ETA: 0s - loss: 0.4079 - acc: 0.8147
 5696/15355 [==========>...................] - ETA: 0s - loss: 0.4090 - acc: 0.8134
 6528/15355 [===========>..................] - ETA: 0s - loss: 0.4146 - acc: 0.8122
 7296/15355 [=============>................] - ETA: 0s - loss: 0.4185 - acc: 0.8099
 8128/15355 [==============>...............] - ETA: 0s - loss: 0.4195 - acc: 0.8092
 8960/15355 [================>.............] - ETA: 0s - loss: 0.4157 - acc: 0.8109
 9792/15355 [==================>...........] - ETA: 0s - loss: 0.4165 - acc: 0.8113
10624/15355 [===================>..........] - ETA: 0s - loss: 0.4160 - acc: 0.8117
11456/15355 [=====================>........] - ETA: 0s - loss: 0.4137 - acc: 0.8126
12288/15355 [=======================>......] - ETA: 0s - loss: 0.4111 - acc: 0.8144
13120/15355 [========================>.....] - ETA: 0s - loss: 0.4111 - acc: 0.8135
13952/15355 [==========================>...] - ETA: 0s - loss: 0.4093 - acc: 0.8147
14784/15355 [===========================>..] - ETA: 0s - loss: 0.4110 - acc: 0.8136
15355/15355 [==============================] - 1s 64us/step - loss: 0.4102 - acc: 0.8141

Test accuracy: 78.46153846153847

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  997

choose_one :  628

F1score :  0.7569444444444444

AUC : 0.8961147062209539

Confusion Matrix
[[730  83]
 [267 545]]
True label 0
0.897908979089791  
0.10209102091020911  
True label 1
0.3288177339901478  
0.6711822660098522  

Train_result {'loss': [0.41023169167264595], 'acc': [0.8141322045635222]}
Saved model to disk



6

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.4742 - acc: 0.7969
  896/15355 [>.............................] - ETA: 0s - loss: 0.4055 - acc: 0.8036
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.3916 - acc: 0.8154
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.3891 - acc: 0.8223
 3392/15355 [=====>........................] - ETA: 0s - loss: 0.3985 - acc: 0.8190
 4224/15355 [=======>......................] - ETA: 0s - loss: 0.3980 - acc: 0.8158
 5056/15355 [========>.....................] - ETA: 0s - loss: 0.3973 - acc: 0.8170
 5888/15355 [==========>...................] - ETA: 0s - loss: 0.3938 - acc: 0.8193
 6784/15355 [============>.................] - ETA: 0s - loss: 0.3948 - acc: 0.8202
 7680/15355 [==============>...............] - ETA: 0s - loss: 0.3963 - acc: 0.8203
 8512/15355 [===============>..............] - ETA: 0s - loss: 0.3987 - acc: 0.8186
 9344/15355 [=================>............] - ETA: 0s - loss: 0.3974 - acc: 0.8207
10176/15355 [==================>...........] - ETA: 0s - loss: 0.3993 - acc: 0.8197
11008/15355 [====================>.........] - ETA: 0s - loss: 0.4014 - acc: 0.8178
11840/15355 [======================>.......] - ETA: 0s - loss: 0.4004 - acc: 0.8182
12672/15355 [=======================>......] - ETA: 0s - loss: 0.4012 - acc: 0.8181
13504/15355 [=========================>....] - ETA: 0s - loss: 0.4009 - acc: 0.8184
14336/15355 [===========================>..] - ETA: 0s - loss: 0.4016 - acc: 0.8188
15168/15355 [============================>.] - ETA: 0s - loss: 0.4014 - acc: 0.8192
15355/15355 [==============================] - 1s 63us/step - loss: 0.4019 - acc: 0.8189

Test accuracy: 82.0923076923077

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  688

choose_one :  937

F1score :  0.8336192109777016

AUC : 0.896014729851732

Confusion Matrix
[[605 208]
 [ 83 729]]
True label 0
0.7441574415744158  
0.25584255842558423  
True label 1
0.1022167487684729  
0.8977832512315271  

Train_result {'loss': [0.40187403472927097], 'acc': [0.8188863562124632]}
Saved model to disk



7

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.3773 - acc: 0.8594
  960/15355 [>.............................] - ETA: 0s - loss: 0.3761 - acc: 0.8271
 1920/15355 [==>...........................] - ETA: 0s - loss: 0.3897 - acc: 0.8156
 3008/15355 [====>.........................] - ETA: 0s - loss: 0.3813 - acc: 0.8268
 4288/15355 [=======>......................] - ETA: 0s - loss: 0.3908 - acc: 0.8200
 5568/15355 [=========>....................] - ETA: 0s - loss: 0.3921 - acc: 0.8208
 6464/15355 [===========>..................] - ETA: 0s - loss: 0.3899 - acc: 0.8222
 7360/15355 [=============>................] - ETA: 0s - loss: 0.3904 - acc: 0.8235
 8192/15355 [===============>..............] - ETA: 0s - loss: 0.3885 - acc: 0.8251
 9024/15355 [================>.............] - ETA: 0s - loss: 0.3913 - acc: 0.8241
 9856/15355 [==================>...........] - ETA: 0s - loss: 0.3929 - acc: 0.8238
10688/15355 [===================>..........] - ETA: 0s - loss: 0.3926 - acc: 0.8233
11520/15355 [=====================>........] - ETA: 0s - loss: 0.3923 - acc: 0.8234
12352/15355 [=======================>......] - ETA: 0s - loss: 0.3918 - acc: 0.8229
13184/15355 [========================>.....] - ETA: 0s - loss: 0.3923 - acc: 0.8226
14016/15355 [==========================>...] - ETA: 0s - loss: 0.3937 - acc: 0.8217
14848/15355 [============================>.] - ETA: 0s - loss: 0.3947 - acc: 0.8216
15355/15355 [==============================] - 1s 56us/step - loss: 0.3953 - acc: 0.8212

Test accuracy: 81.66153846153847

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  877

choose_one :  748

F1score :  0.808974358974359

AUC : 0.9018845545598312

Confusion Matrix
[[696 117]
 [181 631]]
True label 0
0.8560885608856088  
0.14391143911439114  
True label 1
0.2229064039408867  
0.7770935960591133  

Train_result {'loss': [0.3952661536388931], 'acc': [0.8211657439990837]}
Saved model to disk



8

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.3511 - acc: 0.8594
  896/15355 [>.............................] - ETA: 0s - loss: 0.3816 - acc: 0.8270
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.3812 - acc: 0.8339
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.3817 - acc: 0.8371
 3392/15355 [=====>........................] - ETA: 0s - loss: 0.3801 - acc: 0.8370
 4288/15355 [=======>......................] - ETA: 0s - loss: 0.3854 - acc: 0.8316
 5120/15355 [=========>....................] - ETA: 0s - loss: 0.3880 - acc: 0.8297
 5952/15355 [==========>...................] - ETA: 0s - loss: 0.3855 - acc: 0.8293
 6784/15355 [============>.................] - ETA: 0s - loss: 0.3857 - acc: 0.8308
 7616/15355 [=============>................] - ETA: 0s - loss: 0.3865 - acc: 0.8301
 8448/15355 [===============>..............] - ETA: 0s - loss: 0.3903 - acc: 0.8284
 9344/15355 [=================>............] - ETA: 0s - loss: 0.3888 - acc: 0.8308
10176/15355 [==================>...........] - ETA: 0s - loss: 0.3920 - acc: 0.8279
11008/15355 [====================>.........] - ETA: 0s - loss: 0.3893 - acc: 0.8299
11840/15355 [======================>.......] - ETA: 0s - loss: 0.3901 - acc: 0.8294
12672/15355 [=======================>......] - ETA: 0s - loss: 0.3904 - acc: 0.8276
13440/15355 [=========================>....] - ETA: 0s - loss: 0.3885 - acc: 0.8281
14208/15355 [==========================>...] - ETA: 0s - loss: 0.3892 - acc: 0.8278
15040/15355 [============================>.] - ETA: 0s - loss: 0.3898 - acc: 0.8274
15355/15355 [==============================] - 1s 63us/step - loss: 0.3905 - acc: 0.8266

Test accuracy: 82.21538461538461

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  858

choose_one :  767

F1score :  0.8169727675744142

AUC : 0.9044051708989996

Confusion Matrix
[[691 122]
 [167 645]]
True label 0
0.8499384993849939  
0.15006150061500614  
True label 1
0.20566502463054187  
0.7943349753694581  

Train_result {'loss': [0.39048087567391826], 'acc': [0.8266362748057553]}
Saved model to disk



9

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.3059 - acc: 0.8438
  896/15355 [>.............................] - ETA: 0s - loss: 0.3793 - acc: 0.8214
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.3708 - acc: 0.8264
 2496/15355 [===>..........................] - ETA: 0s - loss: 0.3719 - acc: 0.8297
 3328/15355 [=====>........................] - ETA: 0s - loss: 0.3738 - acc: 0.8269
 4096/15355 [=======>......................] - ETA: 0s - loss: 0.3690 - acc: 0.8293
 4928/15355 [========>.....................] - ETA: 0s - loss: 0.3670 - acc: 0.8312
 5760/15355 [==========>...................] - ETA: 0s - loss: 0.3686 - acc: 0.8306
 6528/15355 [===========>..................] - ETA: 0s - loss: 0.3709 - acc: 0.8315
 7360/15355 [=============>................] - ETA: 0s - loss: 0.3719 - acc: 0.8319
 8128/15355 [==============>...............] - ETA: 0s - loss: 0.3771 - acc: 0.8298
 8896/15355 [================>.............] - ETA: 0s - loss: 0.3770 - acc: 0.8292
 9728/15355 [==================>...........] - ETA: 0s - loss: 0.3785 - acc: 0.8298
10560/15355 [===================>..........] - ETA: 0s - loss: 0.3800 - acc: 0.8283
11392/15355 [=====================>........] - ETA: 0s - loss: 0.3808 - acc: 0.8281
12224/15355 [======================>.......] - ETA: 0s - loss: 0.3790 - acc: 0.8293
13120/15355 [========================>.....] - ETA: 0s - loss: 0.3799 - acc: 0.8280
14016/15355 [==========================>...] - ETA: 0s - loss: 0.3796 - acc: 0.8279
14912/15355 [============================>.] - ETA: 0s - loss: 0.3814 - acc: 0.8271
15355/15355 [==============================] - 1s 63us/step - loss: 0.3803 - acc: 0.8283

Test accuracy: 82.39999999999999

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  723

choose_one :  902

F1score :  0.8331388564760793

AUC : 0.9043612418882809

Confusion Matrix
[[625 188]
 [ 98 714]]
True label 0
0.7687576875768758  
0.23124231242312424  
True label 1
0.1206896551724138  
0.8793103448275862  

Train_result {'loss': [0.3803284106348517], 'acc': [0.8283295343885667]}
Saved model to disk



10

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.3513 - acc: 0.8438
 1024/15355 [=>............................] - ETA: 0s - loss: 0.3487 - acc: 0.8496
 1856/15355 [==>...........................] - ETA: 0s - loss: 0.3557 - acc: 0.8443
 2688/15355 [====>.........................] - ETA: 0s - loss: 0.3738 - acc: 0.8341
 3520/15355 [=====>........................] - ETA: 0s - loss: 0.3728 - acc: 0.8321
 4352/15355 [=======>......................] - ETA: 0s - loss: 0.3763 - acc: 0.8323
 5184/15355 [=========>....................] - ETA: 0s - loss: 0.3763 - acc: 0.8312
 6016/15355 [==========>...................] - ETA: 0s - loss: 0.3730 - acc: 0.8326
 6848/15355 [============>.................] - ETA: 0s - loss: 0.3757 - acc: 0.8294
 7680/15355 [==============>...............] - ETA: 0s - loss: 0.3758 - acc: 0.8297
 8512/15355 [===============>..............] - ETA: 0s - loss: 0.3771 - acc: 0.8293
 9344/15355 [=================>............] - ETA: 0s - loss: 0.3782 - acc: 0.8284
10176/15355 [==================>...........] - ETA: 0s - loss: 0.3764 - acc: 0.8295
11008/15355 [====================>.........] - ETA: 0s - loss: 0.3749 - acc: 0.8318
11840/15355 [======================>.......] - ETA: 0s - loss: 0.3749 - acc: 0.8316
12672/15355 [=======================>......] - ETA: 0s - loss: 0.3749 - acc: 0.8310
13504/15355 [=========================>....] - ETA: 0s - loss: 0.3750 - acc: 0.8314
14336/15355 [===========================>..] - ETA: 0s - loss: 0.3779 - acc: 0.8297
15168/15355 [============================>.] - ETA: 0s - loss: 0.3783 - acc: 0.8294
15355/15355 [==============================] - 1s 62us/step - loss: 0.3787 - acc: 0.8294

Test accuracy: 82.89230769230768

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  783

choose_one :  842

F1score :  0.8319226118500604

AUC : 0.90339480365247

Confusion Matrix
[[659 154]
 [124 688]]
True label 0
0.8105781057810578  
0.18942189421894218  
True label 1
0.15270935960591134  
0.8472906403940886  

Train_result {'loss': [0.37869957237902], 'acc': [0.8294366655230173]}
Saved model to disk



11

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.4219 - acc: 0.8594
  896/15355 [>.............................] - ETA: 0s - loss: 0.3628 - acc: 0.8527
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.3715 - acc: 0.8403
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.3779 - acc: 0.8379
 3328/15355 [=====>........................] - ETA: 0s - loss: 0.3748 - acc: 0.8374
 4096/15355 [=======>......................] - ETA: 0s - loss: 0.3741 - acc: 0.8369
 4864/15355 [========>.....................] - ETA: 0s - loss: 0.3763 - acc: 0.8357
 5632/15355 [==========>...................] - ETA: 0s - loss: 0.3754 - acc: 0.8361
 6464/15355 [===========>..................] - ETA: 0s - loss: 0.3697 - acc: 0.8399
 7296/15355 [=============>................] - ETA: 0s - loss: 0.3757 - acc: 0.8384
 8128/15355 [==============>...............] - ETA: 0s - loss: 0.3757 - acc: 0.8370
 8896/15355 [================>.............] - ETA: 0s - loss: 0.3743 - acc: 0.8370
 9728/15355 [==================>...........] - ETA: 0s - loss: 0.3746 - acc: 0.8370
10560/15355 [===================>..........] - ETA: 0s - loss: 0.3729 - acc: 0.8373
11456/15355 [=====================>........] - ETA: 0s - loss: 0.3738 - acc: 0.8362
12352/15355 [=======================>......] - ETA: 0s - loss: 0.3739 - acc: 0.8363
13184/15355 [========================>.....] - ETA: 0s - loss: 0.3720 - acc: 0.8367
14016/15355 [==========================>...] - ETA: 0s - loss: 0.3714 - acc: 0.8371
14848/15355 [============================>.] - ETA: 0s - loss: 0.3725 - acc: 0.8363
15355/15355 [==============================] - 1s 64us/step - loss: 0.3736 - acc: 0.8360

Test accuracy: 83.93846153846154

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  776

choose_one :  849

F1score :  0.8428657435279953

AUC : 0.9098614569889543

Confusion Matrix
[[664 149]
 [112 700]]
True label 0
0.8167281672816729  
0.18327183271832717  
True label 1
0.13793103448275862  
0.8620689655172413  

Train_result {'loss': [0.37357863280370235], 'acc': [0.8360143276077651]}
Saved model to disk



12

Epoch 1/1

   64/15355 [..............................] - ETA: 0s - loss: 0.2817 - acc: 0.8594
  960/15355 [>.............................] - ETA: 0s - loss: 0.3440 - acc: 0.8396
 1728/15355 [==>...........................] - ETA: 0s - loss: 0.3457 - acc: 0.8478
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.3508 - acc: 0.8461
 3392/15355 [=====>........................] - ETA: 0s - loss: 0.3564 - acc: 0.8429
 4224/15355 [=======>......................] - ETA: 0s - loss: 0.3606 - acc: 0.8393
 4992/15355 [========>.....................] - ETA: 0s - loss: 0.3677 - acc: 0.8361
 5824/15355 [==========>...................] - ETA: 0s - loss: 0.3636 - acc: 0.8362
 6656/15355 [============>.................] - ETA: 0s - loss: 0.3659 - acc: 0.8358
 7488/15355 [=============>................] - ETA: 0s - loss: 0.3667 - acc: 0.8359
 8320/15355 [===============>..............] - ETA: 0s - loss: 0.3636 - acc: 0.8393
 9216/15355 [=================>............] - ETA: 0s - loss: 0.3687 - acc: 0.8368
10048/15355 [==================>...........] - ETA: 0s - loss: 0.3681 - acc: 0.8374
10880/15355 [====================>.........] - ETA: 0s - loss: 0.3705 - acc: 0.8368
11712/15355 [=====================>........] - ETA: 0s - loss: 0.3709 - acc: 0.8362
12544/15355 [=======================>......] - ETA: 0s - loss: 0.3720 - acc: 0.8353
13440/15355 [=========================>....] - ETA: 0s - loss: 0.3714 - acc: 0.8353
14272/15355 [==========================>...] - ETA: 0s - loss: 0.3703 - acc: 0.8350
15104/15355 [============================>.] - ETA: 0s - loss: 0.3695 - acc: 0.8347
15355/15355 [==============================] - 1s 62us/step - loss: 0.3696 - acc: 0.8350

Test accuracy: 82.89230769230768

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  747

choose_one :  878

F1score :  0.8355029585798818

AUC : 0.9064789231636159

Confusion Matrix
[[641 172]
 [106 706]]
True label 0
0.7884378843788438  
0.2115621156211562  
True label 1
0.13054187192118227  
0.8694581280788177  

Train_result {'loss': [0.36960643661484116], 'acc': [0.8350374469847137]}
Saved model to disk



13

Epoch 1/1

   64/15355 [..............................] - ETA: 1s - loss: 0.4364 - acc: 0.7812
  960/15355 [>.............................] - ETA: 0s - loss: 0.3856 - acc: 0.8323
 1792/15355 [==>...........................] - ETA: 0s - loss: 0.3678 - acc: 0.8454
 2560/15355 [====>.........................] - ETA: 0s - loss: 0.3592 - acc: 0.8512
 3392/15355 [=====>........................] - ETA: 0s - loss: 0.3623 - acc: 0.8473
 4160/15355 [=======>......................] - ETA: 0s - loss: 0.3667 - acc: 0.8438
 4928/15355 [========>.....................] - ETA: 0s - loss: 0.3655 - acc: 0.8431
 5696/15355 [==========>...................] - ETA: 0s - loss: 0.3659 - acc: 0.8430
 6528/15355 [===========>..................] - ETA: 0s - loss: 0.3693 - acc: 0.8407
 7296/15355 [=============>................] - ETA: 0s - loss: 0.3694 - acc: 0.8403
 8128/15355 [==============>...............] - ETA: 0s - loss: 0.3670 - acc: 0.8418
 9024/15355 [================>.............] - ETA: 0s - loss: 0.3648 - acc: 0.8424
 9920/15355 [==================>...........] - ETA: 0s - loss: 0.3686 - acc: 0.8391
10752/15355 [====================>.........] - ETA: 0s - loss: 0.3670 - acc: 0.8396
11584/15355 [=====================>........] - ETA: 0s - loss: 0.3663 - acc: 0.8398
12416/15355 [=======================>......] - ETA: 0s - loss: 0.3666 - acc: 0.8409
13184/15355 [========================>.....] - ETA: 0s - loss: 0.3651 - acc: 0.8412
14016/15355 [==========================>...] - ETA: 0s - loss: 0.3649 - acc: 0.8416
14912/15355 [============================>.] - ETA: 0s - loss: 0.3667 - acc: 0.8405
15355/15355 [==============================] - 1s 63us/step - loss: 0.3672 - acc: 0.8398

Test accuracy: 83.13846153846154

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  671

choose_one :  954

F1score :  0.8448471121177803

AUC : 0.9113459545925509

Confusion Matrix
[[605 208]
 [ 66 746]]
True label 0
0.7441574415744158  
0.25584255842558423  
True label 1
0.0812807881773399  
0.9187192118226601  

Train_result {'loss': [0.3672383670774278], 'acc': [0.8397915988122163]}
Saved model to disk



14

Epoch 1/1

   64/15355 [..............................] - ETA: 2s - loss: 0.2565 - acc: 0.8750
  832/15355 [>.............................] - ETA: 1s - loss: 0.3717 - acc: 0.8365
 1664/15355 [==>...........................] - ETA: 0s - loss: 0.3552 - acc: 0.8486
 2496/15355 [===>..........................] - ETA: 0s - loss: 0.3490 - acc: 0.8490
 3264/15355 [=====>........................] - ETA: 0s - loss: 0.3558 - acc: 0.8416
 4096/15355 [=======>......................] - ETA: 0s - loss: 0.3585 - acc: 0.8389
 4928/15355 [========>.....................] - ETA: 0s - loss: 0.3579 - acc: 0.8411
 5760/15355 [==========>...................] - ETA: 0s - loss: 0.3566 - acc: 0.8429
 6592/15355 [===========>..................] - ETA: 0s - loss: 0.3624 - acc: 0.8404
 7424/15355 [=============>................] - ETA: 0s - loss: 0.3594 - acc: 0.8411
 8256/15355 [===============>..............] - ETA: 0s - loss: 0.3639 - acc: 0.8396
 9088/15355 [================>.............] - ETA: 0s - loss: 0.3653 - acc: 0.8378
 9920/15355 [==================>...........] - ETA: 0s - loss: 0.3660 - acc: 0.8362
10688/15355 [===================>..........] - ETA: 0s - loss: 0.3647 - acc: 0.8369
11456/15355 [=====================>........] - ETA: 0s - loss: 0.3649 - acc: 0.8367
12224/15355 [======================>.......] - ETA: 0s - loss: 0.3655 - acc: 0.8365
13056/15355 [========================>.....] - ETA: 0s - loss: 0.3663 - acc: 0.8374
13888/15355 [==========================>...] - ETA: 0s - loss: 0.3647 - acc: 0.8381
14720/15355 [===========================>..] - ETA: 0s - loss: 0.3624 - acc: 0.8396
15355/15355 [==============================] - 1s 65us/step - loss: 0.3630 - acc: 0.8393

Test accuracy: 82.46153846153847

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  860

choose_one :  765

F1score :  0.8192771084337349

AUC : 0.9112793036797363

Confusion Matrix
[[694 119]
 [166 646]]
True label 0
0.8536285362853628  
0.14637146371463713  
True label 1
0.2044334975369458  
0.7955665024630542  

Train_result {'loss': [0.362951049648252], 'acc': [0.8392705958311117]}
Saved model to disk



15

Epoch 1/1

   64/15355 [..............................] - ETA: 3s - loss: 0.4667 - acc: 0.7969
  960/15355 [>.............................] - ETA: 1s - loss: 0.3890 - acc: 0.8313
 1856/15355 [==>...........................] - ETA: 0s - loss: 0.3735 - acc: 0.8384
 2752/15355 [====>.........................] - ETA: 0s - loss: 0.3643 - acc: 0.8394
 3584/15355 [======>.......................] - ETA: 0s - loss: 0.3627 - acc: 0.8407
 4416/15355 [=======>......................] - ETA: 0s - loss: 0.3669 - acc: 0.8399
 5248/15355 [=========>....................] - ETA: 0s - loss: 0.3693 - acc: 0.8382
 6080/15355 [==========>...................] - ETA: 0s - loss: 0.3625 - acc: 0.8424
 6848/15355 [============>.................] - ETA: 0s - loss: 0.3612 - acc: 0.8435
 7680/15355 [==============>...............] - ETA: 0s - loss: 0.3635 - acc: 0.8428
 8576/15355 [===============>..............] - ETA: 0s - loss: 0.3636 - acc: 0.8420
 9408/15355 [=================>............] - ETA: 0s - loss: 0.3636 - acc: 0.8416
10240/15355 [===================>..........] - ETA: 0s - loss: 0.3619 - acc: 0.8424
11072/15355 [====================>.........] - ETA: 0s - loss: 0.3611 - acc: 0.8437
11904/15355 [======================>.......] - ETA: 0s - loss: 0.3602 - acc: 0.8437
12736/15355 [=======================>......] - ETA: 0s - loss: 0.3587 - acc: 0.8442
13504/15355 [=========================>....] - ETA: 0s - loss: 0.3581 - acc: 0.8446
14336/15355 [===========================>..] - ETA: 0s - loss: 0.3574 - acc: 0.8447
15104/15355 [============================>.] - ETA: 0s - loss: 0.3575 - acc: 0.8443
15355/15355 [==============================] - 1s 63us/step - loss: 0.3567 - acc: 0.8449

Test accuracy: 82.89230769230768

data size :  16980

zero :  8491

one :  8489

train_zero :  7678

train_one :  7677

test_zero :  813

test_one :  812

choose_zero :  767

choose_one :  858

F1score :  0.8335329341317365

AUC : 0.907086355346312

Confusion Matrix
[[651 162]
 [116 696]]
True label 0
0.8007380073800738  
0.1992619926199262  
True label 1
0.14285714285714285  
0.8571428571428571  

Train_result {'loss': [0.35670086138122675], 'acc': [0.8448713773937343]}
Saved model to disk



[[78.33846153846153, 1], [79.63076923076923, 2], [80.86153846153846, 3], [78.58461538461539, 4], [78.46153846153847, 5], [82.0923076923077, 6], [81.66153846153847, 7], [82.21538461538461, 8], [82.39999999999999, 9], [82.89230769230768, 10], [83.93846153846154, 11], [82.89230769230768, 12], [83.13846153846154, 13], [82.46153846153847, 14], [82.89230769230768, 15]]
max accuracy :  [83.93846153846154, 11]

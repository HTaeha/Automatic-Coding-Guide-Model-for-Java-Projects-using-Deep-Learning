Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_balanced_auto_logging.py:389: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-17 21:11:12.608851: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-17 21:11:12.619939: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-17 21:11:12.622406: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6661e70 executing computations on platform Host. Devices:
2019-08-17 21:11:12.622445: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-CAST
all data

Sentence length Average : 88

Under 10 : 7234
Over 10, Under 200 : 35282
Over 200, Under 400 : 3981
Over 400 : 1973

hbase-CAST
updated_train_data

Sentence length Average : 77

Under 10 : 0
Over 10, Under 200 : 30861
Over 200, Under 400 : 3677
Over 400 : 0


Test_zero:  2982
Train_zero:  26968
zero:  29950
Test_one:  804
Train_one:  7570
one:  8374

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 200)       0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 1, 200)       0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

   64/15141 [..............................] - ETA: 5:55 - loss: 0.7039 - acc: 0.5781
  640/15141 [>.............................] - ETA: 35s - loss: 0.6038 - acc: 0.6719 
 1216/15141 [=>............................] - ETA: 18s - loss: 0.5921 - acc: 0.6891
 1920/15141 [==>...........................] - ETA: 11s - loss: 0.5710 - acc: 0.7078
 2624/15141 [====>.........................] - ETA: 8s - loss: 0.5629 - acc: 0.7165 
 3392/15141 [=====>........................] - ETA: 6s - loss: 0.5554 - acc: 0.7152
 4160/15141 [=======>......................] - ETA: 4s - loss: 0.5523 - acc: 0.7204
 4928/15141 [========>.....................] - ETA: 3s - loss: 0.5503 - acc: 0.7232
 5632/15141 [==========>...................] - ETA: 3s - loss: 0.5432 - acc: 0.7292
 6336/15141 [===========>..................] - ETA: 2s - loss: 0.5412 - acc: 0.7318
 6976/15141 [============>.................] - ETA: 2s - loss: 0.5367 - acc: 0.7360
 7616/15141 [==============>...............] - ETA: 2s - loss: 0.5341 - acc: 0.7387
 8256/15141 [===============>..............] - ETA: 1s - loss: 0.5317 - acc: 0.7407
 8960/15141 [================>.............] - ETA: 1s - loss: 0.5281 - acc: 0.7432
 9664/15141 [==================>...........] - ETA: 1s - loss: 0.5259 - acc: 0.7458
10368/15141 [===================>..........] - ETA: 1s - loss: 0.5251 - acc: 0.7468
11072/15141 [====================>.........] - ETA: 0s - loss: 0.5229 - acc: 0.7477
11712/15141 [======================>.......] - ETA: 0s - loss: 0.5184 - acc: 0.7497
12352/15141 [=======================>......] - ETA: 0s - loss: 0.5167 - acc: 0.7509
12992/15141 [========================>.....] - ETA: 0s - loss: 0.5161 - acc: 0.7509
13632/15141 [==========================>...] - ETA: 0s - loss: 0.5154 - acc: 0.7506
14336/15141 [===========================>..] - ETA: 0s - loss: 0.5137 - acc: 0.7517
15040/15141 [============================>.] - ETA: 0s - loss: 0.5119 - acc: 0.7531
15141/15141 [==============================] - 3s 177us/step - loss: 0.5118 - acc: 0.7534

Test accuracy: 78.18520820385334

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  600

choose_one :  1009

F1score :  0.8063982349696637

AUC : 0.8692670189425543

Confusion Matrix
[[527 278]
 [ 73 731]]
True label 0
0.6546583850931676  
0.3453416149068323  
True label 1
0.09079601990049752  
0.9092039800995025  

Train_result {'acc': [0.7533848491482514], 'loss': [0.5117973641174235]}
Saved model to disk



2

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4205 - acc: 0.8281
  704/15141 [>.............................] - ETA: 1s - loss: 0.4823 - acc: 0.7528
 1344/15141 [=>............................] - ETA: 1s - loss: 0.4629 - acc: 0.7753
 2048/15141 [===>..........................] - ETA: 1s - loss: 0.4601 - acc: 0.7773
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4571 - acc: 0.7791
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.4676 - acc: 0.7731
 4096/15141 [=======>......................] - ETA: 0s - loss: 0.4737 - acc: 0.7686
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4776 - acc: 0.7696
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4737 - acc: 0.7740
 6016/15141 [==========>...................] - ETA: 0s - loss: 0.4712 - acc: 0.7751
 6720/15141 [============>.................] - ETA: 0s - loss: 0.4721 - acc: 0.7766
 7360/15141 [=============>................] - ETA: 0s - loss: 0.4725 - acc: 0.7773
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4762 - acc: 0.7764
 8768/15141 [================>.............] - ETA: 0s - loss: 0.4744 - acc: 0.7781
 9408/15141 [=================>............] - ETA: 0s - loss: 0.4715 - acc: 0.7793
10048/15141 [==================>...........] - ETA: 0s - loss: 0.4699 - acc: 0.7804
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4692 - acc: 0.7811
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4695 - acc: 0.7803
12160/15141 [=======================>......] - ETA: 0s - loss: 0.4699 - acc: 0.7801
12800/15141 [========================>.....] - ETA: 0s - loss: 0.4683 - acc: 0.7812
13504/15141 [=========================>....] - ETA: 0s - loss: 0.4683 - acc: 0.7806
14208/15141 [===========================>..] - ETA: 0s - loss: 0.4686 - acc: 0.7802
14848/15141 [============================>.] - ETA: 0s - loss: 0.4679 - acc: 0.7808
15141/15141 [==============================] - 1s 78us/step - loss: 0.4666 - acc: 0.7815

Test accuracy: 79.92541951522685

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  666

choose_one :  943

F1score :  0.8151116199198626

AUC : 0.8795641358425266

Confusion Matrix
[[574 231]
 [ 92 712]]
True label 0
0.7130434782608696  
0.28695652173913044  
True label 1
0.11442786069651742  
0.8855721393034826  

Train_result {'acc': [0.7814543292494244], 'loss': [0.4665774164296828]}
Saved model to disk



3

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3733 - acc: 0.7969
  704/15141 [>.............................] - ETA: 1s - loss: 0.4246 - acc: 0.7841
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4281 - acc: 0.7997
 2112/15141 [===>..........................] - ETA: 1s - loss: 0.4446 - acc: 0.7855
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4521 - acc: 0.7802
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4511 - acc: 0.7827
 4096/15141 [=======>......................] - ETA: 0s - loss: 0.4562 - acc: 0.7817
 4800/15141 [========>.....................] - ETA: 0s - loss: 0.4554 - acc: 0.7842
 5440/15141 [=========>....................] - ETA: 0s - loss: 0.4595 - acc: 0.7831
 6144/15141 [===========>..................] - ETA: 0s - loss: 0.4534 - acc: 0.7874
 6784/15141 [============>.................] - ETA: 0s - loss: 0.4522 - acc: 0.7899
 7488/15141 [=============>................] - ETA: 0s - loss: 0.4499 - acc: 0.7906
 8192/15141 [===============>..............] - ETA: 0s - loss: 0.4541 - acc: 0.7877
 8896/15141 [================>.............] - ETA: 0s - loss: 0.4564 - acc: 0.7869
 9600/15141 [==================>...........] - ETA: 0s - loss: 0.4557 - acc: 0.7876
10240/15141 [===================>..........] - ETA: 0s - loss: 0.4573 - acc: 0.7882
10880/15141 [====================>.........] - ETA: 0s - loss: 0.4583 - acc: 0.7879
11520/15141 [=====================>........] - ETA: 0s - loss: 0.4594 - acc: 0.7862
12160/15141 [=======================>......] - ETA: 0s - loss: 0.4612 - acc: 0.7850
12800/15141 [========================>.....] - ETA: 0s - loss: 0.4609 - acc: 0.7845
13376/15141 [=========================>....] - ETA: 0s - loss: 0.4621 - acc: 0.7842
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4602 - acc: 0.7859
14720/15141 [============================>.] - ETA: 0s - loss: 0.4596 - acc: 0.7864
15141/15141 [==============================] - 1s 79us/step - loss: 0.4596 - acc: 0.7865

Test accuracy: 80.11187072715973

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  633

choose_one :  976

F1score :  0.8202247191011236

AUC : 0.8808913506999168

Confusion Matrix
[[559 246]
 [ 74 730]]
True label 0
0.6944099378881987  
0.30559006211180123  
True label 1
0.09203980099502487  
0.9079601990049752  

Train_result {'acc': [0.7864738128221647], 'loss': [0.45958075664859255]}
Saved model to disk



4

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3580 - acc: 0.8750
  576/15141 [>.............................] - ETA: 1s - loss: 0.4075 - acc: 0.8090
 1216/15141 [=>............................] - ETA: 1s - loss: 0.4374 - acc: 0.7985
 1856/15141 [==>...........................] - ETA: 1s - loss: 0.4362 - acc: 0.8001
 2496/15141 [===>..........................] - ETA: 1s - loss: 0.4390 - acc: 0.8017
 3136/15141 [=====>........................] - ETA: 1s - loss: 0.4474 - acc: 0.7982
 3712/15141 [======>.......................] - ETA: 0s - loss: 0.4438 - acc: 0.7985
 4288/15141 [=======>......................] - ETA: 0s - loss: 0.4392 - acc: 0.8011
 4928/15141 [========>.....................] - ETA: 0s - loss: 0.4405 - acc: 0.8013
 5568/15141 [==========>...................] - ETA: 0s - loss: 0.4443 - acc: 0.7981
 6208/15141 [===========>..................] - ETA: 0s - loss: 0.4448 - acc: 0.7985
 6848/15141 [============>.................] - ETA: 0s - loss: 0.4427 - acc: 0.7998
 7488/15141 [=============>................] - ETA: 0s - loss: 0.4426 - acc: 0.7987
 8192/15141 [===============>..............] - ETA: 0s - loss: 0.4469 - acc: 0.7963
 8896/15141 [================>.............] - ETA: 0s - loss: 0.4461 - acc: 0.7959
 9600/15141 [==================>...........] - ETA: 0s - loss: 0.4471 - acc: 0.7959
10240/15141 [===================>..........] - ETA: 0s - loss: 0.4478 - acc: 0.7953
10880/15141 [====================>.........] - ETA: 0s - loss: 0.4453 - acc: 0.7970
11584/15141 [=====================>........] - ETA: 0s - loss: 0.4451 - acc: 0.7974
12288/15141 [=======================>......] - ETA: 0s - loss: 0.4441 - acc: 0.7974
12992/15141 [========================>.....] - ETA: 0s - loss: 0.4423 - acc: 0.7983
13632/15141 [==========================>...] - ETA: 0s - loss: 0.4422 - acc: 0.7991
14336/15141 [===========================>..] - ETA: 0s - loss: 0.4423 - acc: 0.7987
15040/15141 [============================>.] - ETA: 0s - loss: 0.4425 - acc: 0.7982
15141/15141 [==============================] - 1s 81us/step - loss: 0.4430 - acc: 0.7980

Test accuracy: 80.0497203231821

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  658

choose_one :  951

F1score :  0.8170940170940171

AUC : 0.8898017675597171

Confusion Matrix
[[571 234]
 [ 87 717]]
True label 0
0.7093167701863354  
0.2906832298136646  
True label 1
0.10820895522388059  
0.8917910447761194  

Train_result {'acc': [0.7979657881861909], 'loss': [0.4429839368178613]}
Saved model to disk



5

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3417 - acc: 0.8438
  640/15141 [>.............................] - ETA: 1s - loss: 0.4227 - acc: 0.8031
 1344/15141 [=>............................] - ETA: 1s - loss: 0.4425 - acc: 0.7939
 2048/15141 [===>..........................] - ETA: 1s - loss: 0.4408 - acc: 0.7925
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4429 - acc: 0.7892
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4448 - acc: 0.7895
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4486 - acc: 0.7899
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4430 - acc: 0.7941
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4409 - acc: 0.7954
 6016/15141 [==========>...................] - ETA: 0s - loss: 0.4416 - acc: 0.7954
 6720/15141 [============>.................] - ETA: 0s - loss: 0.4438 - acc: 0.7949
 7424/15141 [=============>................] - ETA: 0s - loss: 0.4461 - acc: 0.7928
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4449 - acc: 0.7944
 8704/15141 [================>.............] - ETA: 0s - loss: 0.4460 - acc: 0.7929
 9344/15141 [=================>............] - ETA: 0s - loss: 0.4440 - acc: 0.7948
 9984/15141 [==================>...........] - ETA: 0s - loss: 0.4431 - acc: 0.7959
10624/15141 [====================>.........] - ETA: 0s - loss: 0.4436 - acc: 0.7951
11328/15141 [=====================>........] - ETA: 0s - loss: 0.4424 - acc: 0.7960
12032/15141 [======================>.......] - ETA: 0s - loss: 0.4424 - acc: 0.7965
12672/15141 [========================>.....] - ETA: 0s - loss: 0.4439 - acc: 0.7958
13312/15141 [=========================>....] - ETA: 0s - loss: 0.4432 - acc: 0.7968
13952/15141 [==========================>...] - ETA: 0s - loss: 0.4428 - acc: 0.7964
14592/15141 [===========================>..] - ETA: 0s - loss: 0.4416 - acc: 0.7974
15141/15141 [==============================] - 1s 79us/step - loss: 0.4411 - acc: 0.7970

Test accuracy: 81.23057799875698

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  753

choose_one :  856

F1score :  0.8180722891566264

AUC : 0.8881918049504033

Confusion Matrix
[[628 177]
 [125 679]]
True label 0
0.7801242236024845  
0.21987577639751552  
True label 1
0.15547263681592038  
0.8445273631840796  

Train_result {'acc': [0.7970411465399632], 'loss': [0.4410553629458498]}
Saved model to disk



6

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4417 - acc: 0.8281
  704/15141 [>.............................] - ETA: 1s - loss: 0.4442 - acc: 0.7940
 1472/15141 [=>............................] - ETA: 1s - loss: 0.4419 - acc: 0.7901
 2240/15141 [===>..........................] - ETA: 0s - loss: 0.4343 - acc: 0.7969
 2944/15141 [====>.........................] - ETA: 0s - loss: 0.4338 - acc: 0.7965
 3712/15141 [======>.......................] - ETA: 0s - loss: 0.4375 - acc: 0.7947
 4544/15141 [========>.....................] - ETA: 0s - loss: 0.4389 - acc: 0.7942
 5248/15141 [=========>....................] - ETA: 0s - loss: 0.4373 - acc: 0.7959
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.4325 - acc: 0.7976
 6528/15141 [===========>..................] - ETA: 0s - loss: 0.4320 - acc: 0.7989
 7168/15141 [=============>................] - ETA: 0s - loss: 0.4283 - acc: 0.8012
 7808/15141 [==============>...............] - ETA: 0s - loss: 0.4291 - acc: 0.8011
 8448/15141 [===============>..............] - ETA: 0s - loss: 0.4312 - acc: 0.8000
 9088/15141 [=================>............] - ETA: 0s - loss: 0.4309 - acc: 0.8006
 9792/15141 [==================>...........] - ETA: 0s - loss: 0.4285 - acc: 0.8020
10496/15141 [===================>..........] - ETA: 0s - loss: 0.4300 - acc: 0.8009
11200/15141 [=====================>........] - ETA: 0s - loss: 0.4303 - acc: 0.8008
11904/15141 [======================>.......] - ETA: 0s - loss: 0.4291 - acc: 0.8011
12608/15141 [=======================>......] - ETA: 0s - loss: 0.4295 - acc: 0.8008
13312/15141 [=========================>....] - ETA: 0s - loss: 0.4300 - acc: 0.8006
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4316 - acc: 0.7992
14720/15141 [============================>.] - ETA: 0s - loss: 0.4321 - acc: 0.7986
15141/15141 [==============================] - 1s 75us/step - loss: 0.4327 - acc: 0.7982

Test accuracy: 80.85767557489125

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  679

choose_one :  930

F1score :  0.8223760092272202

AUC : 0.890878681128519

Confusion Matrix
[[588 217]
 [ 91 713]]
True label 0
0.7304347826086957  
0.26956521739130435  
True label 1
0.11318407960199005  
0.8868159203980099  

Train_result {'acc': [0.7981639258156569], 'loss': [0.4327206893181692]}
Saved model to disk



7

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4018 - acc: 0.8438
  704/15141 [>.............................] - ETA: 1s - loss: 0.4747 - acc: 0.7713
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4446 - acc: 0.7969
 2112/15141 [===>..........................] - ETA: 1s - loss: 0.4220 - acc: 0.8082
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4282 - acc: 0.8056
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4287 - acc: 0.8060
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4308 - acc: 0.8028
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4321 - acc: 0.8024
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4386 - acc: 0.7993
 6016/15141 [==========>...................] - ETA: 0s - loss: 0.4371 - acc: 0.8000
 6656/15141 [============>.................] - ETA: 0s - loss: 0.4395 - acc: 0.7993
 7296/15141 [=============>................] - ETA: 0s - loss: 0.4390 - acc: 0.7987
 7936/15141 [==============>...............] - ETA: 0s - loss: 0.4378 - acc: 0.7990
 8640/15141 [================>.............] - ETA: 0s - loss: 0.4371 - acc: 0.7992
 9344/15141 [=================>............] - ETA: 0s - loss: 0.4368 - acc: 0.7994
10048/15141 [==================>...........] - ETA: 0s - loss: 0.4369 - acc: 0.7998
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4378 - acc: 0.7999
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4383 - acc: 0.7991
12160/15141 [=======================>......] - ETA: 0s - loss: 0.4377 - acc: 0.7994
12864/15141 [========================>.....] - ETA: 0s - loss: 0.4359 - acc: 0.8007
13568/15141 [=========================>....] - ETA: 0s - loss: 0.4363 - acc: 0.8011
14208/15141 [===========================>..] - ETA: 0s - loss: 0.4386 - acc: 0.7995
14848/15141 [============================>.] - ETA: 0s - loss: 0.4381 - acc: 0.8000
15141/15141 [==============================] - 1s 78us/step - loss: 0.4384 - acc: 0.8000

Test accuracy: 81.29272840273461

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  750

choose_one :  859

F1score :  0.8190018039687311

AUC : 0.8873605574611415

Confusion Matrix
[[627 178]
 [123 681]]
True label 0
0.7788819875776397  
0.22111801242236026  
True label 1
0.15298507462686567  
0.8470149253731343  

Train_result {'acc': [0.8000132091907819], 'loss': [0.4384144999420979]}
Saved model to disk



8

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.5454 - acc: 0.7344
  704/15141 [>.............................] - ETA: 1s - loss: 0.4663 - acc: 0.7713
 1344/15141 [=>............................] - ETA: 1s - loss: 0.4382 - acc: 0.7917
 2048/15141 [===>..........................] - ETA: 1s - loss: 0.4378 - acc: 0.7925
 2688/15141 [====>.........................] - ETA: 0s - loss: 0.4328 - acc: 0.7972
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4337 - acc: 0.7989
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4340 - acc: 0.7984
 4672/15141 [========>.....................] - ETA: 0s - loss: 0.4347 - acc: 0.7975
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4352 - acc: 0.7972
 6080/15141 [===========>..................] - ETA: 0s - loss: 0.4321 - acc: 0.7997
 6784/15141 [============>.................] - ETA: 0s - loss: 0.4352 - acc: 0.7985
 7488/15141 [=============>................] - ETA: 0s - loss: 0.4352 - acc: 0.7991
 8192/15141 [===============>..............] - ETA: 0s - loss: 0.4347 - acc: 0.7999
 8896/15141 [================>.............] - ETA: 0s - loss: 0.4342 - acc: 0.7992
 9600/15141 [==================>...........] - ETA: 0s - loss: 0.4341 - acc: 0.7996
10304/15141 [===================>..........] - ETA: 0s - loss: 0.4331 - acc: 0.7997
11008/15141 [====================>.........] - ETA: 0s - loss: 0.4351 - acc: 0.7985
11648/15141 [======================>.......] - ETA: 0s - loss: 0.4362 - acc: 0.7979
12352/15141 [=======================>......] - ETA: 0s - loss: 0.4344 - acc: 0.7980
13056/15141 [========================>.....] - ETA: 0s - loss: 0.4338 - acc: 0.7985
13760/15141 [==========================>...] - ETA: 0s - loss: 0.4326 - acc: 0.7991
14464/15141 [===========================>..] - ETA: 0s - loss: 0.4326 - acc: 0.7992
15141/15141 [==============================] - 1s 76us/step - loss: 0.4350 - acc: 0.7974

Test accuracy: 80.73337476693598

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  655

choose_one :  954

F1score :  0.8236632536973834

AUC : 0.89029464478848

Confusion Matrix
[[575 230]
 [ 80 724]]
True label 0
0.7142857142857143  
0.2857142857142857  
True label 1
0.09950248756218906  
0.900497512437811  

Train_result {'acc': [0.7973713756914569], 'loss': [0.4349905744477438]}
Saved model to disk



9

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4422 - acc: 0.7969
  640/15141 [>.............................] - ETA: 1s - loss: 0.4232 - acc: 0.8156
 1280/15141 [=>............................] - ETA: 1s - loss: 0.4061 - acc: 0.8211
 1984/15141 [==>...........................] - ETA: 1s - loss: 0.4229 - acc: 0.8100
 2624/15141 [====>.........................] - ETA: 1s - loss: 0.4293 - acc: 0.8060
 3264/15141 [=====>........................] - ETA: 0s - loss: 0.4365 - acc: 0.8042
 3968/15141 [======>.......................] - ETA: 0s - loss: 0.4357 - acc: 0.8049
 4608/15141 [========>.....................] - ETA: 0s - loss: 0.4367 - acc: 0.8032
 5248/15141 [=========>....................] - ETA: 0s - loss: 0.4343 - acc: 0.8043
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.4303 - acc: 0.8064
 6528/15141 [===========>..................] - ETA: 0s - loss: 0.4318 - acc: 0.8059
 7168/15141 [=============>................] - ETA: 0s - loss: 0.4332 - acc: 0.8045
 7872/15141 [==============>...............] - ETA: 0s - loss: 0.4328 - acc: 0.8045
 8576/15141 [===============>..............] - ETA: 0s - loss: 0.4359 - acc: 0.8011
 9280/15141 [=================>............] - ETA: 0s - loss: 0.4353 - acc: 0.8016
 9984/15141 [==================>...........] - ETA: 0s - loss: 0.4336 - acc: 0.8021
10688/15141 [====================>.........] - ETA: 0s - loss: 0.4310 - acc: 0.8032
11328/15141 [=====================>........] - ETA: 0s - loss: 0.4302 - acc: 0.8039
11968/15141 [======================>.......] - ETA: 0s - loss: 0.4311 - acc: 0.8031
12608/15141 [=======================>......] - ETA: 0s - loss: 0.4317 - acc: 0.8026
13312/15141 [=========================>....] - ETA: 0s - loss: 0.4316 - acc: 0.8021
14016/15141 [==========================>...] - ETA: 0s - loss: 0.4312 - acc: 0.8018
14656/15141 [============================>.] - ETA: 0s - loss: 0.4301 - acc: 0.8023
15141/15141 [==============================] - 1s 79us/step - loss: 0.4300 - acc: 0.8027

Test accuracy: 80.67122436295836

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  662

choose_one :  947

F1score :  0.8223872073101085

AUC : 0.8856656160192825

Confusion Matrix
[[578 227]
 [ 84 720]]
True label 0
0.7180124223602484  
0.2819875776397516  
True label 1
0.1044776119402985  
0.8955223880597015  

Train_result {'acc': [0.8027210884196276], 'loss': [0.4299840552041099]}
Saved model to disk



10

Epoch 1/1

   64/15141 [..............................] - ETA: 3s - loss: 0.4500 - acc: 0.8125
  640/15141 [>.............................] - ETA: 1s - loss: 0.4327 - acc: 0.8047
 1344/15141 [=>............................] - ETA: 1s - loss: 0.4187 - acc: 0.8185
 1984/15141 [==>...........................] - ETA: 1s - loss: 0.4148 - acc: 0.8185
 2624/15141 [====>.........................] - ETA: 1s - loss: 0.4378 - acc: 0.7995
 3264/15141 [=====>........................] - ETA: 0s - loss: 0.4317 - acc: 0.8073
 3904/15141 [======>.......................] - ETA: 0s - loss: 0.4302 - acc: 0.8087
 4544/15141 [========>.....................] - ETA: 0s - loss: 0.4293 - acc: 0.8090
 5184/15141 [=========>....................] - ETA: 0s - loss: 0.4286 - acc: 0.8079
 5888/15141 [==========>...................] - ETA: 0s - loss: 0.4298 - acc: 0.8069
 6592/15141 [============>.................] - ETA: 0s - loss: 0.4309 - acc: 0.8066
 7296/15141 [=============>................] - ETA: 0s - loss: 0.4337 - acc: 0.8032
 7936/15141 [==============>...............] - ETA: 0s - loss: 0.4331 - acc: 0.8025
 8576/15141 [===============>..............] - ETA: 0s - loss: 0.4306 - acc: 0.8034
 9216/15141 [=================>............] - ETA: 0s - loss: 0.4311 - acc: 0.8033
 9856/15141 [==================>...........] - ETA: 0s - loss: 0.4295 - acc: 0.8035
10496/15141 [===================>..........] - ETA: 0s - loss: 0.4278 - acc: 0.8044
11136/15141 [=====================>........] - ETA: 0s - loss: 0.4252 - acc: 0.8060
11776/15141 [======================>.......] - ETA: 0s - loss: 0.4248 - acc: 0.8072
12416/15141 [=======================>......] - ETA: 0s - loss: 0.4266 - acc: 0.8069
13056/15141 [========================>.....] - ETA: 0s - loss: 0.4285 - acc: 0.8058
13696/15141 [==========================>...] - ETA: 0s - loss: 0.4294 - acc: 0.8055
14400/15141 [===========================>..] - ETA: 0s - loss: 0.4296 - acc: 0.8058
15104/15141 [============================>.] - ETA: 0s - loss: 0.4302 - acc: 0.8050
15141/15141 [==============================] - 1s 80us/step - loss: 0.4301 - acc: 0.8053

Test accuracy: 80.85767557489125

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  671

choose_one :  938

F1score :  0.8231917336394949

AUC : 0.8892532678223788

Confusion Matrix
[[584 221]
 [ 87 717]]
True label 0
0.7254658385093168  
0.2745341614906832  
True label 1
0.10820895522388059  
0.8917910447761194  

Train_result {'acc': [0.8052968760044097], 'loss': [0.43011132647950084]}
Saved model to disk



11

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4008 - acc: 0.8438
  704/15141 [>.............................] - ETA: 1s - loss: 0.4271 - acc: 0.8068
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4122 - acc: 0.8118
 2112/15141 [===>..........................] - ETA: 1s - loss: 0.4158 - acc: 0.8097
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4156 - acc: 0.8107
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.4193 - acc: 0.8087
 4224/15141 [=======>......................] - ETA: 0s - loss: 0.4263 - acc: 0.8073
 4992/15141 [========>.....................] - ETA: 0s - loss: 0.4307 - acc: 0.8055
 5760/15141 [==========>...................] - ETA: 0s - loss: 0.4321 - acc: 0.8047
 6528/15141 [===========>..................] - ETA: 0s - loss: 0.4269 - acc: 0.8058
 7296/15141 [=============>................] - ETA: 0s - loss: 0.4257 - acc: 0.8073
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4244 - acc: 0.8075
 8896/15141 [================>.............] - ETA: 0s - loss: 0.4254 - acc: 0.8068
 9664/15141 [==================>...........] - ETA: 0s - loss: 0.4269 - acc: 0.8064
10368/15141 [===================>..........] - ETA: 0s - loss: 0.4254 - acc: 0.8072
11008/15141 [====================>.........] - ETA: 0s - loss: 0.4253 - acc: 0.8064
11712/15141 [======================>.......] - ETA: 0s - loss: 0.4249 - acc: 0.8075
12352/15141 [=======================>......] - ETA: 0s - loss: 0.4243 - acc: 0.8083
12992/15141 [========================>.....] - ETA: 0s - loss: 0.4239 - acc: 0.8089
13632/15141 [==========================>...] - ETA: 0s - loss: 0.4224 - acc: 0.8092
14336/15141 [===========================>..] - ETA: 0s - loss: 0.4234 - acc: 0.8087
15040/15141 [============================>.] - ETA: 0s - loss: 0.4248 - acc: 0.8084
15141/15141 [==============================] - 1s 74us/step - loss: 0.4249 - acc: 0.8085

Test accuracy: 80.36047234307023

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  739

choose_one :  870

F1score :  0.8112305854241338

AUC : 0.8903525849015791

Confusion Matrix
[[614 191]
 [125 679]]
True label 0
0.7627329192546584  
0.2372670807453416  
True label 1
0.15547263681592038  
0.8445273631840796  

Train_result {'acc': [0.8084670761351022], 'loss': [0.42488515978956715]}
Saved model to disk



12

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.3751 - acc: 0.8438
  704/15141 [>.............................] - ETA: 1s - loss: 0.4284 - acc: 0.8097
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4179 - acc: 0.8210
 2112/15141 [===>..........................] - ETA: 1s - loss: 0.4208 - acc: 0.8130
 2752/15141 [====>.........................] - ETA: 1s - loss: 0.4168 - acc: 0.8161
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.4155 - acc: 0.8148
 4096/15141 [=======>......................] - ETA: 0s - loss: 0.4141 - acc: 0.8137
 4736/15141 [========>.....................] - ETA: 0s - loss: 0.4148 - acc: 0.8140
 5376/15141 [=========>....................] - ETA: 0s - loss: 0.4125 - acc: 0.8144
 6016/15141 [==========>...................] - ETA: 0s - loss: 0.4127 - acc: 0.8148
 6720/15141 [============>.................] - ETA: 0s - loss: 0.4125 - acc: 0.8137
 7424/15141 [=============>................] - ETA: 0s - loss: 0.4132 - acc: 0.8141
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4181 - acc: 0.8113
 8704/15141 [================>.............] - ETA: 0s - loss: 0.4180 - acc: 0.8120
 9344/15141 [=================>............] - ETA: 0s - loss: 0.4177 - acc: 0.8126
10048/15141 [==================>...........] - ETA: 0s - loss: 0.4168 - acc: 0.8137
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4187 - acc: 0.8125
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4190 - acc: 0.8120
12096/15141 [======================>.......] - ETA: 0s - loss: 0.4208 - acc: 0.8118
12800/15141 [========================>.....] - ETA: 0s - loss: 0.4220 - acc: 0.8102
13504/15141 [=========================>....] - ETA: 0s - loss: 0.4240 - acc: 0.8087
14144/15141 [===========================>..] - ETA: 0s - loss: 0.4242 - acc: 0.8085
14784/15141 [============================>.] - ETA: 0s - loss: 0.4239 - acc: 0.8086
15141/15141 [==============================] - 1s 79us/step - loss: 0.4235 - acc: 0.8091

Test accuracy: 80.98197638284648

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  651

choose_one :  958

F1score :  0.8263337116912599

AUC : 0.8982054015636105

Confusion Matrix
[[575 230]
 [ 76 728]]
True label 0
0.7142857142857143  
0.2857142857142857  
True label 1
0.0945273631840796  
0.9054726368159204  

Train_result {'acc': [0.8090614886573926], 'loss': [0.42350932720330897]}
Saved model to disk



13

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4193 - acc: 0.8125
  576/15141 [>.............................] - ETA: 1s - loss: 0.4254 - acc: 0.8194
 1280/15141 [=>............................] - ETA: 1s - loss: 0.4162 - acc: 0.8219
 1920/15141 [==>...........................] - ETA: 1s - loss: 0.4169 - acc: 0.8172
 2560/15141 [====>.........................] - ETA: 1s - loss: 0.4132 - acc: 0.8230
 3200/15141 [=====>........................] - ETA: 1s - loss: 0.4147 - acc: 0.8191
 3840/15141 [======>.......................] - ETA: 0s - loss: 0.4113 - acc: 0.8195
 4480/15141 [=======>......................] - ETA: 0s - loss: 0.4125 - acc: 0.8163
 5120/15141 [=========>....................] - ETA: 0s - loss: 0.4214 - acc: 0.8092
 5824/15141 [==========>...................] - ETA: 0s - loss: 0.4245 - acc: 0.8079
 6528/15141 [===========>..................] - ETA: 0s - loss: 0.4249 - acc: 0.8084
 7232/15141 [=============>................] - ETA: 0s - loss: 0.4222 - acc: 0.8085
 7872/15141 [==============>...............] - ETA: 0s - loss: 0.4205 - acc: 0.8095
 8576/15141 [===============>..............] - ETA: 0s - loss: 0.4206 - acc: 0.8077
 9280/15141 [=================>............] - ETA: 0s - loss: 0.4199 - acc: 0.8086
 9984/15141 [==================>...........] - ETA: 0s - loss: 0.4206 - acc: 0.8087
10688/15141 [====================>.........] - ETA: 0s - loss: 0.4198 - acc: 0.8096
11392/15141 [=====================>........] - ETA: 0s - loss: 0.4201 - acc: 0.8079
12032/15141 [======================>.......] - ETA: 0s - loss: 0.4211 - acc: 0.8074
12736/15141 [========================>.....] - ETA: 0s - loss: 0.4195 - acc: 0.8088
13440/15141 [=========================>....] - ETA: 0s - loss: 0.4212 - acc: 0.8082
14080/15141 [==========================>...] - ETA: 0s - loss: 0.4202 - acc: 0.8087
14784/15141 [============================>.] - ETA: 0s - loss: 0.4189 - acc: 0.8097
15141/15141 [==============================] - 1s 80us/step - loss: 0.4183 - acc: 0.8096

Test accuracy: 81.10627719080175

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  743

choose_one :  866

F1score :  0.8179640718562875

AUC : 0.8924793733197367

Confusion Matrix
[[622 183]
 [121 683]]
True label 0
0.7726708074534161  
0.22732919254658385  
True label 1
0.15049751243781095  
0.849502487562189  

Train_result {'acc': [0.809589855355683], 'loss': [0.4182522528930996]}
Saved model to disk



14

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.5119 - acc: 0.7031
  704/15141 [>.............................] - ETA: 1s - loss: 0.4264 - acc: 0.7969
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4260 - acc: 0.8068
 2112/15141 [===>..........................] - ETA: 1s - loss: 0.4272 - acc: 0.8101
 2816/15141 [====>.........................] - ETA: 0s - loss: 0.4264 - acc: 0.8125
 3392/15141 [=====>........................] - ETA: 0s - loss: 0.4230 - acc: 0.8137
 4032/15141 [======>.......................] - ETA: 0s - loss: 0.4201 - acc: 0.8127
 4672/15141 [========>.....................] - ETA: 0s - loss: 0.4204 - acc: 0.8136
 5312/15141 [=========>....................] - ETA: 0s - loss: 0.4203 - acc: 0.8129
 5952/15141 [==========>...................] - ETA: 0s - loss: 0.4247 - acc: 0.8108
 6656/15141 [============>.................] - ETA: 0s - loss: 0.4221 - acc: 0.8105
 7360/15141 [=============>................] - ETA: 0s - loss: 0.4218 - acc: 0.8101
 8064/15141 [==============>...............] - ETA: 0s - loss: 0.4247 - acc: 0.8074
 8768/15141 [================>.............] - ETA: 0s - loss: 0.4221 - acc: 0.8098
 9408/15141 [=================>............] - ETA: 0s - loss: 0.4209 - acc: 0.8102
10048/15141 [==================>...........] - ETA: 0s - loss: 0.4214 - acc: 0.8098
10752/15141 [====================>.........] - ETA: 0s - loss: 0.4230 - acc: 0.8083
11456/15141 [=====================>........] - ETA: 0s - loss: 0.4211 - acc: 0.8090
12160/15141 [=======================>......] - ETA: 0s - loss: 0.4218 - acc: 0.8086
12864/15141 [========================>.....] - ETA: 0s - loss: 0.4228 - acc: 0.8082
13568/15141 [=========================>....] - ETA: 0s - loss: 0.4213 - acc: 0.8095
14272/15141 [===========================>..] - ETA: 0s - loss: 0.4209 - acc: 0.8091
14976/15141 [============================>.] - ETA: 0s - loss: 0.4204 - acc: 0.8094
15141/15141 [==============================] - 1s 78us/step - loss: 0.4208 - acc: 0.8093

Test accuracy: 81.727781230578

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  743

choose_one :  866

F1score :  0.8239520958083832

AUC : 0.8969307190754303

Confusion Matrix
[[627 178]
 [116 688]]
True label 0
0.7788819875776397  
0.22111801242236026  
True label 1
0.14427860696517414  
0.8557213930348259  

Train_result {'acc': [0.8092596261766327], 'loss': [0.42079762626407596]}
Saved model to disk



15

Epoch 1/1

   64/15141 [..............................] - ETA: 1s - loss: 0.4585 - acc: 0.7812
  704/15141 [>.............................] - ETA: 1s - loss: 0.4319 - acc: 0.8111
 1408/15141 [=>............................] - ETA: 1s - loss: 0.4379 - acc: 0.7926
 2112/15141 [===>..........................] - ETA: 0s - loss: 0.4202 - acc: 0.8035
 2752/15141 [====>.........................] - ETA: 0s - loss: 0.4182 - acc: 0.8060
 3456/15141 [=====>........................] - ETA: 0s - loss: 0.4258 - acc: 0.8032
 4160/15141 [=======>......................] - ETA: 0s - loss: 0.4197 - acc: 0.8082
 4864/15141 [========>.....................] - ETA: 0s - loss: 0.4195 - acc: 0.8090
 5568/15141 [==========>...................] - ETA: 0s - loss: 0.4201 - acc: 0.8094
 6272/15141 [===========>..................] - ETA: 0s - loss: 0.4206 - acc: 0.8092
 6976/15141 [============>.................] - ETA: 0s - loss: 0.4185 - acc: 0.8093
 7616/15141 [==============>...............] - ETA: 0s - loss: 0.4171 - acc: 0.8103
 8256/15141 [===============>..............] - ETA: 0s - loss: 0.4184 - acc: 0.8098
 8960/15141 [================>.............] - ETA: 0s - loss: 0.4179 - acc: 0.8107
 9664/15141 [==================>...........] - ETA: 0s - loss: 0.4153 - acc: 0.8115
10304/15141 [===================>..........] - ETA: 0s - loss: 0.4184 - acc: 0.8106
10944/15141 [====================>.........] - ETA: 0s - loss: 0.4157 - acc: 0.8118
11584/15141 [=====================>........] - ETA: 0s - loss: 0.4161 - acc: 0.8111
12224/15141 [=======================>......] - ETA: 0s - loss: 0.4162 - acc: 0.8112
12864/15141 [========================>.....] - ETA: 0s - loss: 0.4152 - acc: 0.8119
13504/15141 [=========================>....] - ETA: 0s - loss: 0.4166 - acc: 0.8113
14080/15141 [==========================>...] - ETA: 0s - loss: 0.4174 - acc: 0.8111
14720/15141 [============================>.] - ETA: 0s - loss: 0.4190 - acc: 0.8097
15141/15141 [==============================] - 1s 80us/step - loss: 0.4183 - acc: 0.8095

Test accuracy: 82.41143567433188

data size :  16750

zero :  8376

one :  8374

train_zero :  7571

train_one :  7570

test_zero :  805

test_one :  804

choose_zero :  752

choose_one :  857

F1score :  0.8296207104154123

AUC : 0.8992467785297116

Confusion Matrix
[[637 168]
 [115 689]]
True label 0
0.7913043478260869  
0.20869565217391303  
True label 1
0.14303482587064675  
0.8569651741293532  

Train_result {'acc': [0.809523809508063], 'loss': [0.4183338439537003]}
Saved model to disk



[[78.18520820385334, 1], [79.92541951522685, 2], [80.11187072715973, 3], [80.0497203231821, 4], [81.23057799875698, 5], [80.85767557489125, 6], [81.29272840273461, 7], [80.73337476693598, 8], [80.67122436295836, 9], [80.85767557489125, 10], [80.36047234307023, 11], [80.98197638284648, 12], [81.10627719080175, 13], [81.727781230578, 14], [82.41143567433188, 15]]
max accuracy :  [82.41143567433188, 15]

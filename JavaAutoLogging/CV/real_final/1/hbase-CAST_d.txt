2019-08-06 16:58:39.696062: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22948
Over 200, Under 400 : 1160
Over 400 : 0


hbase-code

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 21966
Over 200, Under 400 : 2142
Over 400 : 0


Test_zero:  1868
Train_zero:  16871
zero:  18739
Test_one:  764
Train_one:  7237
one:  8001
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 680s - loss: 0.5189 - acc: 0.7526

Test accuracy: 74.23152387181165

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  1093

choose_one :  436

F1score :  0.6716666666666667

AUC : 0.9084377031790029

Confusion Matrix
[[732  33]
 [361 403]]
True label 0
0.9568627450980393  
0.043137254901960784  
True label 1
0.4725130890052356  
0.5274869109947644  

Train_result {'loss': [0.518923059728685], 'acc': [0.7526079447240616]}
2

Epoch 1/1
 - 684s - loss: 0.3735 - acc: 0.8382

Test accuracy: 85.80771746239371

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  700

choose_one :  829

F1score :  0.8637790332705586

AUC : 0.9361881052595559

Confusion Matrix
[[624 141]
 [ 76 688]]
True label 0
0.8156862745098039  
0.1843137254901961  
True label 1
0.09947643979057591  
0.900523560209424  

Train_result {'loss': [0.3735115450980956], 'acc': [0.838203799671048]}
3

Epoch 1/1
 - 685s - loss: 0.3227 - acc: 0.8633

Test accuracy: 86.00392413342054

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  707

choose_one :  822

F1score :  0.8650693568726355

AUC : 0.9434238442322829

Confusion Matrix
[[629 136]
 [ 78 686]]
True label 0
0.8222222222222222  
0.17777777777777778  
True label 1
0.10209424083769633  
0.8979057591623036  

Train_result {'loss': [0.322747835510753], 'acc': [0.8632815198824195]}
4

Epoch 1/1
 - 685s - loss: 0.2958 - acc: 0.8737

Test accuracy: 87.31196860693264

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  761

choose_one :  768

F1score :  0.8733681462140992

AUC : 0.9441800978681175

Confusion Matrix
[[666  99]
 [ 95 669]]
True label 0
0.8705882352941177  
0.12941176470588237  
True label 1
0.1243455497382199  
0.8756544502617801  

Train_result {'loss': [0.2957775249238253], 'acc': [0.8737132988116079]}
5

Epoch 1/1
 - 685s - loss: 0.2729 - acc: 0.8846

Test accuracy: 88.2275997383911

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  789

choose_one :  740

F1score :  0.8803191489361702

AUC : 0.9521515587037608

Confusion Matrix
[[687  78]
 [102 662]]
True label 0
0.8980392156862745  
0.10196078431372549  
True label 1
0.13350785340314136  
0.8664921465968587  

Train_result {'loss': [0.27288975783683267], 'acc': [0.8845595855128168]}
6

Epoch 1/1
 - 688s - loss: 0.2461 - acc: 0.8972

Test accuracy: 86.98495748855461

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  878

choose_one :  651

F1score :  0.8593639575971731

AUC : 0.9553493823358313

Confusion Matrix
[[722  43]
 [156 608]]
True label 0
0.9437908496732026  
0.05620915032679739  
True label 1
0.20418848167539266  
0.7958115183246073  

Train_result {'loss': [0.2460569625794373], 'acc': [0.897202072559449]}
7

Epoch 1/1
 - 690s - loss: 0.2248 - acc: 0.9096

Test accuracy: 88.29300196206671

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  754

choose_one :  775

F1score :  0.8836907082521118

AUC : 0.9558746535263319

Confusion Matrix
[[670  95]
 [ 84 680]]
True label 0
0.8758169934640523  
0.12418300653594772  
True label 1
0.1099476439790576  
0.8900523560209425  

Train_result {'loss': [0.22483430375758437], 'acc': [0.9095682210708117]}
8

Epoch 1/1
 - 690s - loss: 0.2064 - acc: 0.9143

Test accuracy: 89.14323086984957

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  729

choose_one :  800

F1score :  0.8938618925831202

AUC : 0.9556470930431509

Confusion Matrix
[[664 101]
 [ 65 699]]
True label 0
0.8679738562091504  
0.13202614379084968  
True label 1
0.08507853403141362  
0.9149214659685864  

Train_result {'loss': [0.2064047638438835], 'acc': [0.9143350604490501]}
9

Epoch 1/1
 - 690s - loss: 0.1820 - acc: 0.9270

Test accuracy: 88.68541530412034

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  762

choose_one :  767

F1score :  0.8870019595035924

AUC : 0.955104712041885

Confusion Matrix
[[677  88]
 [ 85 679]]
True label 0
0.8849673202614379  
0.11503267973856209  
True label 1
0.11125654450261781  
0.8887434554973822  

Train_result {'loss': [0.18196613328238637], 'acc': [0.9270466321243523]}
10

Epoch 1/1
 - 699s - loss: 0.1624 - acc: 0.9373

Test accuracy: 88.48920863309353

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  771

choose_one :  758

F1score :  0.8843626806833114

AUC : 0.9565393696745714

Confusion Matrix
[[680  85]
 [ 91 673]]
True label 0
0.8888888888888888  
0.1111111111111111  
True label 1
0.11910994764397906  
0.8808900523560209  

Train_result {'loss': [0.16242234691038135], 'acc': [0.9373402417962003]}
11

Epoch 1/1
 - 704s - loss: 0.1368 - acc: 0.9486

Test accuracy: 88.2275997383911

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  861

choose_one :  668

F1score :  0.8743016759776535

AUC : 0.9566428840297027

Confusion Matrix
[[723  42]
 [138 626]]
True label 0
0.9450980392156862  
0.054901960784313725  
True label 1
0.1806282722513089  
0.819371727748691  

Train_result {'loss': [0.13682637002492815], 'acc': [0.9486010362900189]}
12

Epoch 1/1
 - 720s - loss: 0.1153 - acc: 0.9545

Test accuracy: 89.27403531720078

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  755

choose_one :  774

F1score :  0.893368010403121

AUC : 0.9581348595284537

Confusion Matrix
[[678  87]
 [ 77 687]]
True label 0
0.8862745098039215  
0.11372549019607843  
True label 1
0.10078534031413612  
0.8992146596858639  

Train_result {'loss': [0.11528494363415838], 'acc': [0.9545423143556493]}
13

Epoch 1/1
 - 714s - loss: 0.1054 - acc: 0.9617

Test accuracy: 88.88162197514716

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  787

choose_one :  742

F1score :  0.8871181938911022

AUC : 0.9549755329706053

Confusion Matrix
[[691  74]
 [ 96 668]]
True label 0
0.9032679738562092  
0.09673202614379085  
True label 1
0.1256544502617801  
0.8743455497382199  

Train_result {'loss': [0.10541184928416177], 'acc': [0.9617271157167531]}
14

Epoch 1/1
 - 699s - loss: 0.0923 - acc: 0.9655

Test accuracy: 88.42380640941792

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  790

choose_one :  739

F1score :  0.8822355289421157

AUC : 0.9539130137220683

Confusion Matrix
[[689  76]
 [101 663]]
True label 0
0.9006535947712418  
0.09934640522875816  
True label 1
0.13219895287958114  
0.8678010471204188  

Train_result {'loss': [0.09226168464180821], 'acc': [0.9655267703141985]}
15

Epoch 1/1
 - 699s - loss: 0.0746 - acc: 0.9728
Using TensorFlow backend.
doc_product.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("ou...)`
  model = Model(input=input1, output=output)

Test accuracy: 88.55461085676913

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  800

choose_one :  729

F1score :  0.882786336235767

AUC : 0.954027649454197

Confusion Matrix
[[695  70]
 [105 659]]
True label 0
0.9084967320261438  
0.0915032679738562  
True label 1
0.13743455497382198  
0.862565445026178  

Train_result {'loss': [0.07456204727620196], 'acc': [0.9728497409326425]}
Saved model to disk




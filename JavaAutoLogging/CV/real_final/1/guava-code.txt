2019-08-06 02:11:18.857128: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
zero : 
44755

one : 
13975
guava-code
all data

Sentence length Average : 35

Under 10 : 6367
Over 10, Under 200 : 51771
Over 200, Under 400 : 538
Over 400 : 54

guava-code
updated_train_data

Sentence length Average : 38

Under 10 : 0
Over 10, Under 200 : 45881
Over 200, Under 400 : 474
Over 400 : 0


Test_zero:  4081
Train_zero:  36072
zero:  40153
Test_one:  1106
Train_one:  10283
one:  11389

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 466s - loss: 0.3021 - acc: 0.8827

Test accuracy: 91.82105738816087

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1068

choose_one :  1145

F1score :  0.9195912927587738

AUC : 0.973061448516836

Confusion Matrix
[[ 997  110]
 [  71 1035]]
True label 0
0.90063233965673  
0.0993676603432701  
True label 1
0.06419529837251356  
0.9358047016274864  

Train_result {'loss': [0.3021476952240531], 'acc': [0.8826761316672339]}
2

Epoch 1/1
 - 478s - loss: 0.1925 - acc: 0.9220

Test accuracy: 93.49299593312246

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1149

choose_one :  1064

F1score :  0.9336405529953916

AUC : 0.9863641041473705

Confusion Matrix
[[1056   51]
 [  93 1013]]
True label 0
0.9539295392953929  
0.04607046070460705  
True label 1
0.08408679927667269  
0.9159132007233273  

Train_result {'loss': [0.19247340042276828], 'acc': [0.9219623669216142]}
3

Epoch 1/1
 - 478s - loss: 0.1502 - acc: 0.9386

Test accuracy: 94.12562132851333

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1135

choose_one :  1078

F1score :  0.9404761904761905

AUC : 0.9871686179188495

Confusion Matrix
[[1056   51]
 [  79 1027]]
True label 0
0.9539295392953929  
0.04607046070460705  
True label 1
0.07142857142857142  
0.9285714285714286  

Train_result {'loss': [0.15016539817901545], 'acc': [0.9386395682085062]}
4

Epoch 1/1
 - 485s - loss: 0.1224 - acc: 0.9511

Test accuracy: 94.30637144148216

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1139

choose_one :  1074

F1score :  0.9422018348623853

AUC : 0.9907509503063686

Confusion Matrix
[[1060   47]
 [  79 1027]]
True label 0
0.957542908762421  
0.04245709123757904  
True label 1
0.07142857142857142  
0.9285714285714286  

Train_result {'loss': [0.1224139016794522], 'acc': [0.9511353138754722]}
5

Epoch 1/1
 - 493s - loss: 0.1007 - acc: 0.9603

Test accuracy: 95.25530953456845

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1092

choose_one :  1121

F1score :  0.9528513695554558

AUC : 0.9929848032657542

Confusion Matrix
[[1047   60]
 [  45 1061]]
True label 0
0.94579945799458  
0.05420054200542006  
True label 1
0.0406871609403255  
0.9593128390596745  

Train_result {'loss': [0.10072808603726198], 'acc': [0.9603247921543452]}
6

Epoch 1/1
 - 491s - loss: 0.0837 - acc: 0.9671

Test accuracy: 96.15906009941256

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1096

choose_one :  1117

F1score :  0.9617633828160144

AUC : 0.9941523691909613

Confusion Matrix
[[1059   48]
 [  37 1069]]
True label 0
0.9566395663956639  
0.04336043360433604  
True label 1
0.03345388788426763  
0.9665461121157324  

Train_result {'loss': [0.08368029057047763], 'acc': [0.9670831915203968]}
7

Epoch 1/1
 - 490s - loss: 0.0711 - acc: 0.9727

Test accuracy: 96.02349751468596

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1067

choose_one :  1146

F1score :  0.9609236234458258

AUC : 0.9950209990345835

Confusion Matrix
[[1043   64]
 [  24 1082]]
True label 0
0.9421860885275519  
0.057813911472448055  
True label 1
0.0216998191681736  
0.9783001808318263  

Train_result {'loss': [0.07110725014916594], 'acc': [0.9726746730314785]}
8

Epoch 1/1
 - 489s - loss: 0.0614 - acc: 0.9767

Test accuracy: 97.01762313601446

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1103

choose_one :  1110

F1score :  0.970216606498195

AUC : 0.9952668453749034

Confusion Matrix
[[1072   35]
 [  31 1075]]
True label 0
0.9683830171635049  
0.031616982836495035  
True label 1
0.02802893309222423  
0.9719710669077758  

Train_result {'loss': [0.06144481901365012], 'acc': [0.9766616424369136]}
9

Epoch 1/1
 - 492s - loss: 0.0526 - acc: 0.9801

Test accuracy: 96.61093538183462

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1096

choose_one :  1117

F1score :  0.9662618083670717

AUC : 0.995515142010974

Confusion Matrix
[[1064   43]
 [  32 1074]]
True label 0
0.9611562782294489  
0.03884372177055104  
True label 1
0.028933092224231464  
0.9710669077757685  

Train_result {'loss': [0.05262011302519015], 'acc': [0.9800651529148636]}
10

Epoch 1/1
 - 491s - loss: 0.0497 - acc: 0.9818

Test accuracy: 96.61093538183462

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1066

choose_one :  1147

F1score :  0.966711051930759

AUC : 0.9958810528430782

Confusion Matrix
[[1049   58]
 [  17 1089]]
True label 0
0.947606142728094  
0.052393857271906055  
True label 1
0.015370705244122965  
0.984629294755877  

Train_result {'loss': [0.04971024999091338], 'acc': [0.981766908165431]}
11

Epoch 1/1
 - 490s - loss: 0.0433 - acc: 0.9839

Test accuracy: 96.92724807953005

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1091

choose_one :  1122

F1score :  0.9694793536804309

AUC : 0.9956511334251378

Confusion Matrix
[[1065   42]
 [  26 1080]]
True label 0
0.962059620596206  
0.037940379403794036  
True label 1
0.023508137432188065  
0.976491862567812  

Train_result {'loss': [0.043293808652699245], 'acc': [0.9838576360304575]}
12

Epoch 1/1
 - 495s - loss: 0.0429 - acc: 0.9846

Test accuracy: 97.55987347492092

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1109

choose_one :  1104

F1score :  0.9755656108597286

AUC : 0.9967860287403356

Confusion Matrix
[[1081   26]
 [  28 1078]]
True label 0
0.976513098464318  
0.023486901535682024  
True label 1
0.02531645569620253  
0.9746835443037974  

Train_result {'loss': [0.04290271595926864], 'acc': [0.9846355812709681]}
13

Epoch 1/1
 - 489s - loss: 0.0376 - acc: 0.9866

Test accuracy: 96.65612291007682

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1127

choose_one :  1086

F1score :  0.9662408759124088

AUC : 0.9953542392566783

Confusion Matrix
[[1080   27]
 [  47 1059]]
True label 0
0.975609756097561  
0.024390243902439025  
True label 1
0.042495479204339964  
0.9575045207956601  

Train_result {'loss': [0.03756430263549234], 'acc': [0.9865804444012253]}
14

Epoch 1/1
 - 488s - loss: 0.0367 - acc: 0.9866

Test accuracy: 97.3339358337099

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1094

choose_one :  1119

F1score :  0.9734831460674157

AUC : 0.9960611495807544

Confusion Matrix
[[1071   36]
 [  23 1083]]
True label 0
0.967479674796748  
0.032520325203252036  
True label 1
0.020795660036166366  
0.9792043399638336  

Train_result {'loss': [0.036742914060002574], 'acc': [0.9866290659794817]}
15

Epoch 1/1
 - 484s - loss: 0.0359 - acc: 0.9875
Using TensorFlow backend.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)

Test accuracy: 97.83099864437416

data size :  22780

zero :  11391

one :  11389

train_zero :  10284

train_one :  10283

test_zero :  1107

test_one :  1106

choose_zero :  1077

choose_one :  1136

F1score :  0.9785905441570025

AUC : 0.9968015472800901

Confusion Matrix
[[1068   39]
 [   9 1097]]
True label 0
0.964769647696477  
0.03523035230352303  
True label 1
0.0081374321880651  
0.9918625678119349  

Train_result {'loss': [0.03591903281497321], 'acc': [0.987455632809841]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
sum_balanced_auto_logging.py:389: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-17 21:06:19.472384: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-17 21:06:19.482584: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-17 21:06:19.484507: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x579a1d0 executing computations on platform Host. Devices:
2019-08-17 21:06:19.484548: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22932
Over 200, Under 400 : 1156
Over 400 : 0


Test_zero:  1866
Train_zero:  16848
zero:  18714
Test_one:  764
Train_one:  7240
one:  8004

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 200)       0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 1, 200)       0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

   64/14481 [..............................] - ETA: 4:56 - loss: 0.7121 - acc: 0.6094
  576/14481 [>.............................] - ETA: 32s - loss: 0.6812 - acc: 0.6059 
 1152/14481 [=>............................] - ETA: 16s - loss: 0.6574 - acc: 0.6241
 1856/14481 [==>...........................] - ETA: 10s - loss: 0.6490 - acc: 0.6374
 2560/14481 [====>.........................] - ETA: 7s - loss: 0.6453 - acc: 0.6387 
 3264/14481 [=====>........................] - ETA: 5s - loss: 0.6333 - acc: 0.6471
 4032/14481 [=======>......................] - ETA: 4s - loss: 0.6262 - acc: 0.6530
 4736/14481 [========>.....................] - ETA: 3s - loss: 0.6205 - acc: 0.6577
 5440/14481 [==========>...................] - ETA: 2s - loss: 0.6166 - acc: 0.6605
 6144/14481 [===========>..................] - ETA: 2s - loss: 0.6105 - acc: 0.6644
 6848/14481 [=============>................] - ETA: 2s - loss: 0.6098 - acc: 0.6656
 7552/14481 [==============>...............] - ETA: 1s - loss: 0.6095 - acc: 0.6658
 8256/14481 [================>.............] - ETA: 1s - loss: 0.6101 - acc: 0.6647
 8960/14481 [=================>............] - ETA: 1s - loss: 0.6068 - acc: 0.6682
 9600/14481 [==================>...........] - ETA: 1s - loss: 0.6061 - acc: 0.6693
10240/14481 [====================>.........] - ETA: 0s - loss: 0.6067 - acc: 0.6687
10880/14481 [=====================>........] - ETA: 0s - loss: 0.6023 - acc: 0.6730
11520/14481 [======================>.......] - ETA: 0s - loss: 0.6018 - acc: 0.6739
12160/14481 [========================>.....] - ETA: 0s - loss: 0.5995 - acc: 0.6759
12800/14481 [=========================>....] - ETA: 0s - loss: 0.5977 - acc: 0.6779
13504/14481 [==========================>...] - ETA: 0s - loss: 0.5961 - acc: 0.6802
14208/14481 [============================>.] - ETA: 0s - loss: 0.5935 - acc: 0.6812
14481/14481 [==============================] - 2s 169us/step - loss: 0.5932 - acc: 0.6816

Test accuracy: 72.33485938521909

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  574

choose_one :  955

F1score :  0.7539267015706806

AUC : 0.8170148513157445

Confusion Matrix
[[458 307]
 [116 648]]
True label 0
0.5986928104575163  
0.4013071895424837  
True label 1
0.1518324607329843  
0.8481675392670157  

Train_result {'loss': [0.5931754702980384], 'acc': [0.6815827636459932]}
Saved model to disk



2

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.6571 - acc: 0.6719
  768/14481 [>.............................] - ETA: 1s - loss: 0.5765 - acc: 0.7135
 1536/14481 [==>...........................] - ETA: 0s - loss: 0.5803 - acc: 0.7090
 2176/14481 [===>..........................] - ETA: 0s - loss: 0.5665 - acc: 0.7137
 2816/14481 [====>.........................] - ETA: 0s - loss: 0.5616 - acc: 0.7188
 3520/14481 [======>.......................] - ETA: 0s - loss: 0.5699 - acc: 0.7102
 4160/14481 [=======>......................] - ETA: 0s - loss: 0.5669 - acc: 0.7120
 4800/14481 [========>.....................] - ETA: 0s - loss: 0.5645 - acc: 0.7127
 5440/14481 [==========>...................] - ETA: 0s - loss: 0.5593 - acc: 0.7153
 6144/14481 [===========>..................] - ETA: 0s - loss: 0.5591 - acc: 0.7140
 6848/14481 [=============>................] - ETA: 0s - loss: 0.5574 - acc: 0.7155
 7552/14481 [==============>...............] - ETA: 0s - loss: 0.5593 - acc: 0.7133
 8256/14481 [================>.............] - ETA: 0s - loss: 0.5593 - acc: 0.7133
 8960/14481 [=================>............] - ETA: 0s - loss: 0.5588 - acc: 0.7118
 9664/14481 [===================>..........] - ETA: 0s - loss: 0.5605 - acc: 0.7104
10368/14481 [====================>.........] - ETA: 0s - loss: 0.5643 - acc: 0.7087
11008/14481 [=====================>........] - ETA: 0s - loss: 0.5635 - acc: 0.7089
11712/14481 [=======================>......] - ETA: 0s - loss: 0.5616 - acc: 0.7086
12416/14481 [========================>.....] - ETA: 0s - loss: 0.5615 - acc: 0.7091
13056/14481 [==========================>...] - ETA: 0s - loss: 0.5596 - acc: 0.7100
13760/14481 [===========================>..] - ETA: 0s - loss: 0.5597 - acc: 0.7098
14464/14481 [============================>.] - ETA: 0s - loss: 0.5602 - acc: 0.7098
14481/14481 [==============================] - 1s 77us/step - loss: 0.5601 - acc: 0.7098

Test accuracy: 74.42773054283846

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  582

choose_one :  947

F1score :  0.7714786674459381

AUC : 0.8248939191732539

Confusion Matrix
[[478 287]
 [104 660]]
True label 0
0.6248366013071895  
0.37516339869281046  
True label 1
0.13612565445026178  
0.8638743455497382  

Train_result {'loss': [0.5601171154185938], 'acc': [0.7097576134450676]}
Saved model to disk



3

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5650 - acc: 0.7812
  704/14481 [>.............................] - ETA: 1s - loss: 0.5734 - acc: 0.6889
 1408/14481 [=>............................] - ETA: 1s - loss: 0.5634 - acc: 0.7003
 2112/14481 [===>..........................] - ETA: 0s - loss: 0.5475 - acc: 0.7183
 2816/14481 [====>.........................] - ETA: 0s - loss: 0.5461 - acc: 0.7177
 3520/14481 [======>.......................] - ETA: 0s - loss: 0.5512 - acc: 0.7170
 4224/14481 [=======>......................] - ETA: 0s - loss: 0.5514 - acc: 0.7133
 4992/14481 [=========>....................] - ETA: 0s - loss: 0.5492 - acc: 0.7183
 5696/14481 [==========>...................] - ETA: 0s - loss: 0.5454 - acc: 0.7230
 6336/14481 [============>.................] - ETA: 0s - loss: 0.5423 - acc: 0.7244
 6976/14481 [=============>................] - ETA: 0s - loss: 0.5439 - acc: 0.7229
 7616/14481 [==============>...............] - ETA: 0s - loss: 0.5425 - acc: 0.7243
 8256/14481 [================>.............] - ETA: 0s - loss: 0.5440 - acc: 0.7229
 8960/14481 [=================>............] - ETA: 0s - loss: 0.5483 - acc: 0.7209
 9664/14481 [===================>..........] - ETA: 0s - loss: 0.5494 - acc: 0.7210
10368/14481 [====================>.........] - ETA: 0s - loss: 0.5507 - acc: 0.7207
11008/14481 [=====================>........] - ETA: 0s - loss: 0.5506 - acc: 0.7214
11648/14481 [=======================>......] - ETA: 0s - loss: 0.5500 - acc: 0.7227
12352/14481 [========================>.....] - ETA: 0s - loss: 0.5499 - acc: 0.7233
13056/14481 [==========================>...] - ETA: 0s - loss: 0.5491 - acc: 0.7236
13760/14481 [===========================>..] - ETA: 0s - loss: 0.5483 - acc: 0.7238
14464/14481 [============================>.] - ETA: 0s - loss: 0.5482 - acc: 0.7228
14481/14481 [==============================] - 1s 77us/step - loss: 0.5484 - acc: 0.7225

Test accuracy: 75.60497056899933

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  766

choose_one :  763

F1score :  0.7557301899148657

AUC : 0.8395279403209801

Confusion Matrix
[[579 186]
 [187 577]]
True label 0
0.7568627450980392  
0.24313725490196078  
True label 1
0.24476439790575916  
0.7552356020942408  

Train_result {'loss': [0.548430833428137], 'acc': [0.7224639182397488]}
Saved model to disk



4

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5037 - acc: 0.7344
  640/14481 [>.............................] - ETA: 1s - loss: 0.5833 - acc: 0.6797
 1344/14481 [=>............................] - ETA: 1s - loss: 0.5738 - acc: 0.6853
 2048/14481 [===>..........................] - ETA: 1s - loss: 0.5591 - acc: 0.7051
 2752/14481 [====>.........................] - ETA: 0s - loss: 0.5569 - acc: 0.7093
 3456/14481 [======>.......................] - ETA: 0s - loss: 0.5460 - acc: 0.7196
 4224/14481 [=======>......................] - ETA: 0s - loss: 0.5422 - acc: 0.7263
 4864/14481 [=========>....................] - ETA: 0s - loss: 0.5401 - acc: 0.7262
 5504/14481 [==========>...................] - ETA: 0s - loss: 0.5371 - acc: 0.7280
 6208/14481 [===========>..................] - ETA: 0s - loss: 0.5389 - acc: 0.7271
 6912/14481 [=============>................] - ETA: 0s - loss: 0.5389 - acc: 0.7264
 7616/14481 [==============>...............] - ETA: 0s - loss: 0.5363 - acc: 0.7273
 8384/14481 [================>.............] - ETA: 0s - loss: 0.5384 - acc: 0.7252
 9088/14481 [=================>............] - ETA: 0s - loss: 0.5423 - acc: 0.7223
 9728/14481 [===================>..........] - ETA: 0s - loss: 0.5410 - acc: 0.7227
10432/14481 [====================>.........] - ETA: 0s - loss: 0.5423 - acc: 0.7220
11136/14481 [======================>.......] - ETA: 0s - loss: 0.5405 - acc: 0.7235
11840/14481 [=======================>......] - ETA: 0s - loss: 0.5378 - acc: 0.7257
12544/14481 [========================>.....] - ETA: 0s - loss: 0.5383 - acc: 0.7256
13248/14481 [==========================>...] - ETA: 0s - loss: 0.5363 - acc: 0.7275
13952/14481 [===========================>..] - ETA: 0s - loss: 0.5362 - acc: 0.7278
14481/14481 [==============================] - 1s 76us/step - loss: 0.5356 - acc: 0.7276

Test accuracy: 75.21255722694572

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  572

choose_one :  957

F1score :  0.779779198140616

AUC : 0.8411020429114054

Confusion Matrix
[[479 286]
 [ 93 671]]
True label 0
0.6261437908496732  
0.3738562091503268  
True label 1
0.12172774869109948  
0.8782722513089005  

Train_result {'loss': [0.5356237783520749], 'acc': [0.7276431185815078]}
Saved model to disk



5

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.6637 - acc: 0.6719
  576/14481 [>.............................] - ETA: 1s - loss: 0.5412 - acc: 0.7153
 1280/14481 [=>............................] - ETA: 1s - loss: 0.5409 - acc: 0.7203
 1984/14481 [===>..........................] - ETA: 1s - loss: 0.5369 - acc: 0.7203
 2752/14481 [====>.........................] - ETA: 0s - loss: 0.5445 - acc: 0.7148
 3456/14481 [======>.......................] - ETA: 0s - loss: 0.5369 - acc: 0.7208
 4160/14481 [=======>......................] - ETA: 0s - loss: 0.5360 - acc: 0.7238
 4928/14481 [=========>....................] - ETA: 0s - loss: 0.5408 - acc: 0.7202
 5632/14481 [==========>...................] - ETA: 0s - loss: 0.5402 - acc: 0.7196
 6400/14481 [============>.................] - ETA: 0s - loss: 0.5360 - acc: 0.7241
 7168/14481 [=============>................] - ETA: 0s - loss: 0.5328 - acc: 0.7267
 7936/14481 [===============>..............] - ETA: 0s - loss: 0.5315 - acc: 0.7296
 8704/14481 [=================>............] - ETA: 0s - loss: 0.5334 - acc: 0.7285
 9472/14481 [==================>...........] - ETA: 0s - loss: 0.5341 - acc: 0.7281
10240/14481 [====================>.........] - ETA: 0s - loss: 0.5338 - acc: 0.7292
10944/14481 [=====================>........] - ETA: 0s - loss: 0.5312 - acc: 0.7309
11712/14481 [=======================>......] - ETA: 0s - loss: 0.5301 - acc: 0.7327
12480/14481 [========================>.....] - ETA: 0s - loss: 0.5309 - acc: 0.7313
13312/14481 [==========================>...] - ETA: 0s - loss: 0.5293 - acc: 0.7341
14016/14481 [============================>.] - ETA: 0s - loss: 0.5300 - acc: 0.7334
14481/14481 [==============================] - 1s 72us/step - loss: 0.5310 - acc: 0.7332

Test accuracy: 75.40876389797253

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  601

choose_one :  928

F1score :  0.7777777777777779

AUC : 0.8434221332512063

Confusion Matrix
[[495 270]
 [106 658]]
True label 0
0.6470588235294118  
0.35294117647058826  
True label 1
0.1387434554973822  
0.8612565445026178  

Train_result {'loss': [0.5309886799012747], 'acc': [0.7332366549477262]}
Saved model to disk



6

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.6078 - acc: 0.6406
  768/14481 [>.............................] - ETA: 1s - loss: 0.5428 - acc: 0.7279
 1472/14481 [==>...........................] - ETA: 1s - loss: 0.5299 - acc: 0.7412
 2176/14481 [===>..........................] - ETA: 0s - loss: 0.5338 - acc: 0.7367
 2880/14481 [====>.........................] - ETA: 0s - loss: 0.5321 - acc: 0.7361
 3520/14481 [======>.......................] - ETA: 0s - loss: 0.5348 - acc: 0.7335
 4224/14481 [=======>......................] - ETA: 0s - loss: 0.5299 - acc: 0.7356
 4992/14481 [=========>....................] - ETA: 0s - loss: 0.5296 - acc: 0.7376
 5760/14481 [==========>...................] - ETA: 0s - loss: 0.5314 - acc: 0.7359
 6528/14481 [============>.................] - ETA: 0s - loss: 0.5331 - acc: 0.7356
 7232/14481 [=============>................] - ETA: 0s - loss: 0.5339 - acc: 0.7341
 7936/14481 [===============>..............] - ETA: 0s - loss: 0.5321 - acc: 0.7346
 8704/14481 [=================>............] - ETA: 0s - loss: 0.5323 - acc: 0.7333
 9408/14481 [==================>...........] - ETA: 0s - loss: 0.5350 - acc: 0.7319
10112/14481 [===================>..........] - ETA: 0s - loss: 0.5343 - acc: 0.7328
10816/14481 [=====================>........] - ETA: 0s - loss: 0.5323 - acc: 0.7341
11520/14481 [======================>.......] - ETA: 0s - loss: 0.5322 - acc: 0.7351
12224/14481 [========================>.....] - ETA: 0s - loss: 0.5331 - acc: 0.7333
12928/14481 [=========================>....] - ETA: 0s - loss: 0.5333 - acc: 0.7324
13568/14481 [===========================>..] - ETA: 0s - loss: 0.5330 - acc: 0.7316
14208/14481 [============================>.] - ETA: 0s - loss: 0.5322 - acc: 0.7328
14481/14481 [==============================] - 1s 75us/step - loss: 0.5319 - acc: 0.7330

Test accuracy: 76.2589928057554

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  654

choose_one :  875

F1score :  0.778523489932886

AUC : 0.854597406152688

Confusion Matrix
[[528 237]
 [126 638]]
True label 0
0.6901960784313725  
0.30980392156862746  
True label 1
0.1649214659685864  
0.8350785340314136  

Train_result {'loss': [0.5318675750272148], 'acc': [0.7330294869262354]}
Saved model to disk



7

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5675 - acc: 0.7031
  704/14481 [>.............................] - ETA: 1s - loss: 0.5568 - acc: 0.7045
 1408/14481 [=>............................] - ETA: 1s - loss: 0.5485 - acc: 0.7102
 2112/14481 [===>..........................] - ETA: 0s - loss: 0.5431 - acc: 0.7178
 2752/14481 [====>.........................] - ETA: 0s - loss: 0.5458 - acc: 0.7173
 3392/14481 [======>.......................] - ETA: 0s - loss: 0.5383 - acc: 0.7220
 4032/14481 [=======>......................] - ETA: 0s - loss: 0.5366 - acc: 0.7259
 4736/14481 [========>.....................] - ETA: 0s - loss: 0.5378 - acc: 0.7261
 5440/14481 [==========>...................] - ETA: 0s - loss: 0.5366 - acc: 0.7267
 6144/14481 [===========>..................] - ETA: 0s - loss: 0.5297 - acc: 0.7308
 6848/14481 [=============>................] - ETA: 0s - loss: 0.5280 - acc: 0.7328
 7616/14481 [==============>...............] - ETA: 0s - loss: 0.5226 - acc: 0.7354
 8320/14481 [================>.............] - ETA: 0s - loss: 0.5235 - acc: 0.7353
 9024/14481 [=================>............] - ETA: 0s - loss: 0.5222 - acc: 0.7368
 9728/14481 [===================>..........] - ETA: 0s - loss: 0.5219 - acc: 0.7369
10432/14481 [====================>.........] - ETA: 0s - loss: 0.5239 - acc: 0.7361
11072/14481 [=====================>........] - ETA: 0s - loss: 0.5243 - acc: 0.7361
11776/14481 [=======================>......] - ETA: 0s - loss: 0.5221 - acc: 0.7377
12480/14481 [========================>.....] - ETA: 0s - loss: 0.5211 - acc: 0.7390
13184/14481 [==========================>...] - ETA: 0s - loss: 0.5210 - acc: 0.7396
13888/14481 [===========================>..] - ETA: 0s - loss: 0.5200 - acc: 0.7394
14481/14481 [==============================] - 1s 76us/step - loss: 0.5200 - acc: 0.7395

Test accuracy: 75.14715500327011

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  853

choose_one :  676

F1score :  0.7361111111111112

AUC : 0.8442134619991103

Confusion Matrix
[[619 146]
 [234 530]]
True label 0
0.8091503267973856  
0.19084967320261437  
True label 1
0.306282722513089  
0.693717277486911  

Train_result {'loss': [0.5200468411959961], 'acc': [0.7394516953496049]}
Saved model to disk



8

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5374 - acc: 0.7656
  704/14481 [>.............................] - ETA: 1s - loss: 0.5673 - acc: 0.7230
 1472/14481 [==>...........................] - ETA: 0s - loss: 0.5440 - acc: 0.7337
 2304/14481 [===>..........................] - ETA: 0s - loss: 0.5334 - acc: 0.7361
 2944/14481 [=====>........................] - ETA: 0s - loss: 0.5369 - acc: 0.7327
 3648/14481 [======>.......................] - ETA: 0s - loss: 0.5348 - acc: 0.7316
 4288/14481 [=======>......................] - ETA: 0s - loss: 0.5338 - acc: 0.7302
 4928/14481 [=========>....................] - ETA: 0s - loss: 0.5328 - acc: 0.7301
 5568/14481 [==========>...................] - ETA: 0s - loss: 0.5324 - acc: 0.7315
 6272/14481 [===========>..................] - ETA: 0s - loss: 0.5291 - acc: 0.7341
 6912/14481 [=============>................] - ETA: 0s - loss: 0.5304 - acc: 0.7325
 7616/14481 [==============>...............] - ETA: 0s - loss: 0.5304 - acc: 0.7327
 8256/14481 [================>.............] - ETA: 0s - loss: 0.5288 - acc: 0.7347
 9024/14481 [=================>............] - ETA: 0s - loss: 0.5291 - acc: 0.7345
 9728/14481 [===================>..........] - ETA: 0s - loss: 0.5300 - acc: 0.7339
10368/14481 [====================>.........] - ETA: 0s - loss: 0.5274 - acc: 0.7355
11072/14481 [=====================>........] - ETA: 0s - loss: 0.5260 - acc: 0.7365
11776/14481 [=======================>......] - ETA: 0s - loss: 0.5247 - acc: 0.7373
12480/14481 [========================>.....] - ETA: 0s - loss: 0.5246 - acc: 0.7381
13184/14481 [==========================>...] - ETA: 0s - loss: 0.5243 - acc: 0.7375
13888/14481 [===========================>..] - ETA: 0s - loss: 0.5253 - acc: 0.7373
14481/14481 [==============================] - 1s 76us/step - loss: 0.5248 - acc: 0.7381

Test accuracy: 78.09025506867233

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  770

choose_one :  759

F1score :  0.7800393959290873

AUC : 0.8618776306334052

Confusion Matrix
[[600 165]
 [170 594]]
True label 0
0.7843137254901961  
0.21568627450980393  
True label 1
0.22251308900523561  
0.7774869109947644  

Train_result {'loss': [0.5248267635313091], 'acc': [0.7381396312450524]}
Saved model to disk



9

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5395 - acc: 0.7656
  640/14481 [>.............................] - ETA: 1s - loss: 0.5023 - acc: 0.7625
 1280/14481 [=>............................] - ETA: 1s - loss: 0.5042 - acc: 0.7516
 1984/14481 [===>..........................] - ETA: 1s - loss: 0.5146 - acc: 0.7440
 2688/14481 [====>.........................] - ETA: 0s - loss: 0.5178 - acc: 0.7433
 3392/14481 [======>.......................] - ETA: 0s - loss: 0.5184 - acc: 0.7450
 4160/14481 [=======>......................] - ETA: 0s - loss: 0.5167 - acc: 0.7466
 4864/14481 [=========>....................] - ETA: 0s - loss: 0.5180 - acc: 0.7465
 5504/14481 [==========>...................] - ETA: 0s - loss: 0.5178 - acc: 0.7465
 6208/14481 [===========>..................] - ETA: 0s - loss: 0.5184 - acc: 0.7444
 6912/14481 [=============>................] - ETA: 0s - loss: 0.5179 - acc: 0.7439
 7616/14481 [==============>...............] - ETA: 0s - loss: 0.5162 - acc: 0.7454
 8320/14481 [================>.............] - ETA: 0s - loss: 0.5175 - acc: 0.7453
 9024/14481 [=================>............] - ETA: 0s - loss: 0.5150 - acc: 0.7463
 9728/14481 [===================>..........] - ETA: 0s - loss: 0.5137 - acc: 0.7460
10432/14481 [====================>.........] - ETA: 0s - loss: 0.5131 - acc: 0.7474
11072/14481 [=====================>........] - ETA: 0s - loss: 0.5167 - acc: 0.7460
11776/14481 [=======================>......] - ETA: 0s - loss: 0.5191 - acc: 0.7441
12416/14481 [========================>.....] - ETA: 0s - loss: 0.5208 - acc: 0.7417
13120/14481 [==========================>...] - ETA: 0s - loss: 0.5209 - acc: 0.7430
13760/14481 [===========================>..] - ETA: 0s - loss: 0.5217 - acc: 0.7428
14464/14481 [============================>.] - ETA: 0s - loss: 0.5205 - acc: 0.7434
14481/14481 [==============================] - 1s 76us/step - loss: 0.5206 - acc: 0.7434

Test accuracy: 77.50163505559189

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  823

choose_one :  706

F1score :  0.7659863945578231

AUC : 0.8607808917633372

Confusion Matrix
[[622 143]
 [201 563]]
True label 0
0.8130718954248366  
0.1869281045751634  
True label 1
0.2630890052356021  
0.7369109947643979  

Train_result {'loss': [0.5205796943021392], 'acc': [0.743387887593289]}
Saved model to disk



10

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.6107 - acc: 0.6719
  704/14481 [>.............................] - ETA: 1s - loss: 0.5079 - acc: 0.7528
 1408/14481 [=>............................] - ETA: 0s - loss: 0.5206 - acc: 0.7443
 2048/14481 [===>..........................] - ETA: 0s - loss: 0.5200 - acc: 0.7500
 2688/14481 [====>.........................] - ETA: 0s - loss: 0.5291 - acc: 0.7403
 3392/14481 [======>.......................] - ETA: 0s - loss: 0.5214 - acc: 0.7432
 4032/14481 [=======>......................] - ETA: 0s - loss: 0.5202 - acc: 0.7443
 4736/14481 [========>.....................] - ETA: 0s - loss: 0.5203 - acc: 0.7422
 5440/14481 [==========>...................] - ETA: 0s - loss: 0.5158 - acc: 0.7458
 6144/14481 [===========>..................] - ETA: 0s - loss: 0.5132 - acc: 0.7463
 6848/14481 [=============>................] - ETA: 0s - loss: 0.5171 - acc: 0.7450
 7552/14481 [==============>...............] - ETA: 0s - loss: 0.5188 - acc: 0.7443
 8192/14481 [===============>..............] - ETA: 0s - loss: 0.5181 - acc: 0.7448
 8832/14481 [=================>............] - ETA: 0s - loss: 0.5174 - acc: 0.7456
 9472/14481 [==================>...........] - ETA: 0s - loss: 0.5157 - acc: 0.7462
10176/14481 [====================>.........] - ETA: 0s - loss: 0.5174 - acc: 0.7447
10880/14481 [=====================>........] - ETA: 0s - loss: 0.5147 - acc: 0.7470
11584/14481 [======================>.......] - ETA: 0s - loss: 0.5124 - acc: 0.7495
12288/14481 [========================>.....] - ETA: 0s - loss: 0.5128 - acc: 0.7489
12992/14481 [=========================>....] - ETA: 0s - loss: 0.5125 - acc: 0.7488
13632/14481 [===========================>..] - ETA: 0s - loss: 0.5123 - acc: 0.7491
14336/14481 [============================>.] - ETA: 0s - loss: 0.5114 - acc: 0.7503
14481/14481 [==============================] - 1s 76us/step - loss: 0.5114 - acc: 0.7504

Test accuracy: 76.91301504251145

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  674

choose_one :  855

F1score :  0.781964175416924

AUC : 0.8556590699106867

Confusion Matrix
[[543 222]
 [131 633]]
True label 0
0.7098039215686275  
0.2901960784313726  
True label 1
0.17146596858638743  
0.8285340314136126  

Train_result {'loss': [0.5114429681211058], 'acc': [0.7504316000482026]}
Saved model to disk



11

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5075 - acc: 0.7969
  704/14481 [>.............................] - ETA: 1s - loss: 0.4843 - acc: 0.7812
 1408/14481 [=>............................] - ETA: 1s - loss: 0.5041 - acc: 0.7685
 2176/14481 [===>..........................] - ETA: 0s - loss: 0.5100 - acc: 0.7597
 2880/14481 [====>.........................] - ETA: 0s - loss: 0.5034 - acc: 0.7618
 3584/14481 [======>.......................] - ETA: 0s - loss: 0.5036 - acc: 0.7575
 4288/14481 [=======>......................] - ETA: 0s - loss: 0.5001 - acc: 0.7591
 4992/14481 [=========>....................] - ETA: 0s - loss: 0.5011 - acc: 0.7594
 5760/14481 [==========>...................] - ETA: 0s - loss: 0.5031 - acc: 0.7599
 6464/14481 [============>.................] - ETA: 0s - loss: 0.5010 - acc: 0.7594
 7168/14481 [=============>................] - ETA: 0s - loss: 0.5014 - acc: 0.7591
 7872/14481 [===============>..............] - ETA: 0s - loss: 0.5024 - acc: 0.7590
 8512/14481 [================>.............] - ETA: 0s - loss: 0.5042 - acc: 0.7585
 9152/14481 [=================>............] - ETA: 0s - loss: 0.5059 - acc: 0.7557
 9792/14481 [===================>..........] - ETA: 0s - loss: 0.5082 - acc: 0.7534
10432/14481 [====================>.........] - ETA: 0s - loss: 0.5101 - acc: 0.7516
11136/14481 [======================>.......] - ETA: 0s - loss: 0.5101 - acc: 0.7518
11840/14481 [=======================>......] - ETA: 0s - loss: 0.5106 - acc: 0.7526
12544/14481 [========================>.....] - ETA: 0s - loss: 0.5130 - acc: 0.7510
13248/14481 [==========================>...] - ETA: 0s - loss: 0.5122 - acc: 0.7524
13952/14481 [===========================>..] - ETA: 0s - loss: 0.5126 - acc: 0.7516
14481/14481 [==============================] - 1s 75us/step - loss: 0.5131 - acc: 0.7507

Test accuracy: 77.6978417266187

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  648

choose_one :  881

F1score :  0.7927051671732522

AUC : 0.8574393457208364

Confusion Matrix
[[536 229]
 [112 652]]
True label 0
0.7006535947712418  
0.29934640522875816  
True label 1
0.14659685863874344  
0.8534031413612565  

Train_result {'loss': [0.5130798852325976], 'acc': [0.750707824065881]}
Saved model to disk



12

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.5063 - acc: 0.7344
  640/14481 [>.............................] - ETA: 1s - loss: 0.5155 - acc: 0.7281
 1344/14481 [=>............................] - ETA: 1s - loss: 0.5064 - acc: 0.7426
 2048/14481 [===>..........................] - ETA: 0s - loss: 0.4961 - acc: 0.7490
 2688/14481 [====>.........................] - ETA: 0s - loss: 0.5004 - acc: 0.7452
 3392/14481 [======>.......................] - ETA: 0s - loss: 0.5074 - acc: 0.7412
 4096/14481 [=======>......................] - ETA: 0s - loss: 0.5155 - acc: 0.7373
 4800/14481 [========>.....................] - ETA: 0s - loss: 0.5157 - acc: 0.7398
 5568/14481 [==========>...................] - ETA: 0s - loss: 0.5166 - acc: 0.7401
 6272/14481 [===========>..................] - ETA: 0s - loss: 0.5160 - acc: 0.7428
 6976/14481 [=============>................] - ETA: 0s - loss: 0.5155 - acc: 0.7428
 7680/14481 [==============>...............] - ETA: 0s - loss: 0.5127 - acc: 0.7440
 8384/14481 [================>.............] - ETA: 0s - loss: 0.5130 - acc: 0.7428
 9088/14481 [=================>............] - ETA: 0s - loss: 0.5136 - acc: 0.7431
 9792/14481 [===================>..........] - ETA: 0s - loss: 0.5150 - acc: 0.7427
10496/14481 [====================>.........] - ETA: 0s - loss: 0.5124 - acc: 0.7447
11200/14481 [======================>.......] - ETA: 0s - loss: 0.5121 - acc: 0.7456
11904/14481 [=======================>......] - ETA: 0s - loss: 0.5121 - acc: 0.7449
12544/14481 [========================>.....] - ETA: 0s - loss: 0.5127 - acc: 0.7443
13184/14481 [==========================>...] - ETA: 0s - loss: 0.5123 - acc: 0.7445
13824/14481 [===========================>..] - ETA: 0s - loss: 0.5118 - acc: 0.7455
14464/14481 [============================>.] - ETA: 0s - loss: 0.5121 - acc: 0.7459
14481/14481 [==============================] - 1s 76us/step - loss: 0.5124 - acc: 0.7457

Test accuracy: 77.82864617396991

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  710

choose_one :  819

F1score :  0.7858496525584333

AUC : 0.8547445505252711

Confusion Matrix
[[568 197]
 [142 622]]
True label 0
0.742483660130719  
0.257516339869281  
True label 1
0.18586387434554974  
0.8141361256544503  

Train_result {'loss': [0.5124496666652937], 'acc': [0.7457357917517871]}
Saved model to disk



13

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.4468 - acc: 0.7812
  640/14481 [>.............................] - ETA: 1s - loss: 0.5049 - acc: 0.7406
 1344/14481 [=>............................] - ETA: 1s - loss: 0.5248 - acc: 0.7254
 1984/14481 [===>..........................] - ETA: 1s - loss: 0.5138 - acc: 0.7349
 2624/14481 [====>.........................] - ETA: 0s - loss: 0.5060 - acc: 0.7458
 3264/14481 [=====>........................] - ETA: 0s - loss: 0.5085 - acc: 0.7506
 3968/14481 [=======>......................] - ETA: 0s - loss: 0.5078 - acc: 0.7477
 4672/14481 [========>.....................] - ETA: 0s - loss: 0.5086 - acc: 0.7474
 5376/14481 [==========>...................] - ETA: 0s - loss: 0.5088 - acc: 0.7467
 6080/14481 [===========>..................] - ETA: 0s - loss: 0.5096 - acc: 0.7472
 6784/14481 [=============>................] - ETA: 0s - loss: 0.5062 - acc: 0.7518
 7488/14481 [==============>...............] - ETA: 0s - loss: 0.5090 - acc: 0.7501
 8192/14481 [===============>..............] - ETA: 0s - loss: 0.5067 - acc: 0.7507
 8896/14481 [=================>............] - ETA: 0s - loss: 0.5071 - acc: 0.7507
 9600/14481 [==================>...........] - ETA: 0s - loss: 0.5090 - acc: 0.7511
10304/14481 [====================>.........] - ETA: 0s - loss: 0.5099 - acc: 0.7514
11008/14481 [=====================>........] - ETA: 0s - loss: 0.5079 - acc: 0.7535
11712/14481 [=======================>......] - ETA: 0s - loss: 0.5090 - acc: 0.7526
12416/14481 [========================>.....] - ETA: 0s - loss: 0.5078 - acc: 0.7534
13184/14481 [==========================>...] - ETA: 0s - loss: 0.5068 - acc: 0.7541
13888/14481 [===========================>..] - ETA: 0s - loss: 0.5074 - acc: 0.7537
14481/14481 [==============================] - 1s 76us/step - loss: 0.5072 - acc: 0.7544

Test accuracy: 76.45519947678221

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  605

choose_one :  924

F1score :  0.7867298578199052

AUC : 0.8576053108852616

Confusion Matrix
[[505 260]
 [100 664]]
True label 0
0.6601307189542484  
0.33986928104575165  
True label 1
0.13089005235602094  
0.8691099476439791  

Train_result {'loss': [0.5072180048494607], 'acc': [0.7544368482921904]}
Saved model to disk



14

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.4827 - acc: 0.7812
  704/14481 [>.............................] - ETA: 1s - loss: 0.5037 - acc: 0.7514
 1408/14481 [=>............................] - ETA: 1s - loss: 0.5170 - acc: 0.7422
 2112/14481 [===>..........................] - ETA: 0s - loss: 0.5115 - acc: 0.7533
 2816/14481 [====>.........................] - ETA: 0s - loss: 0.5169 - acc: 0.7528
 3520/14481 [======>.......................] - ETA: 0s - loss: 0.5124 - acc: 0.7545
 4224/14481 [=======>......................] - ETA: 0s - loss: 0.5082 - acc: 0.7571
 4992/14481 [=========>....................] - ETA: 0s - loss: 0.5042 - acc: 0.7580
 5696/14481 [==========>...................] - ETA: 0s - loss: 0.5063 - acc: 0.7570
 6400/14481 [============>.................] - ETA: 0s - loss: 0.5062 - acc: 0.7570
 7104/14481 [=============>................] - ETA: 0s - loss: 0.5116 - acc: 0.7527
 7808/14481 [===============>..............] - ETA: 0s - loss: 0.5121 - acc: 0.7519
 8576/14481 [================>.............] - ETA: 0s - loss: 0.5088 - acc: 0.7522
 9280/14481 [==================>...........] - ETA: 0s - loss: 0.5043 - acc: 0.7554
 9984/14481 [===================>..........] - ETA: 0s - loss: 0.5052 - acc: 0.7545
10688/14481 [=====================>........] - ETA: 0s - loss: 0.5064 - acc: 0.7532
11392/14481 [======================>.......] - ETA: 0s - loss: 0.5064 - acc: 0.7525
12032/14481 [=======================>......] - ETA: 0s - loss: 0.5073 - acc: 0.7513
12544/14481 [========================>.....] - ETA: 0s - loss: 0.5082 - acc: 0.7502
13184/14481 [==========================>...] - ETA: 0s - loss: 0.5091 - acc: 0.7493
13888/14481 [===========================>..] - ETA: 0s - loss: 0.5098 - acc: 0.7486
14481/14481 [==============================] - 1s 76us/step - loss: 0.5107 - acc: 0.7482

Test accuracy: 78.61347285807717

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  724

choose_one :  805

F1score :  0.7915869980879541

AUC : 0.8670952674263424

Confusion Matrix
[[581 184]
 [143 621]]
True label 0
0.7594771241830065  
0.24052287581699347  
True label 1
0.18717277486910994  
0.81282722513089  

Train_result {'loss': [0.5106751920768433], 'acc': [0.7481527519023564]}
Saved model to disk



15

Epoch 1/1

   64/14481 [..............................] - ETA: 1s - loss: 0.4667 - acc: 0.7812
  704/14481 [>.............................] - ETA: 1s - loss: 0.4997 - acc: 0.7614
 1408/14481 [=>............................] - ETA: 1s - loss: 0.5066 - acc: 0.7464
 2112/14481 [===>..........................] - ETA: 0s - loss: 0.5034 - acc: 0.7509
 2816/14481 [====>.........................] - ETA: 0s - loss: 0.5009 - acc: 0.7567
 3456/14481 [======>.......................] - ETA: 0s - loss: 0.5012 - acc: 0.7558
 4160/14481 [=======>......................] - ETA: 0s - loss: 0.5025 - acc: 0.7555
 4864/14481 [=========>....................] - ETA: 0s - loss: 0.5018 - acc: 0.7556
 5568/14481 [==========>...................] - ETA: 0s - loss: 0.4998 - acc: 0.7559
 6272/14481 [===========>..................] - ETA: 0s - loss: 0.5012 - acc: 0.7538
 6976/14481 [=============>................] - ETA: 0s - loss: 0.5033 - acc: 0.7519
 7680/14481 [==============>...............] - ETA: 0s - loss: 0.5030 - acc: 0.7530
 8384/14481 [================>.............] - ETA: 0s - loss: 0.5014 - acc: 0.7542
 9088/14481 [=================>............] - ETA: 0s - loss: 0.5017 - acc: 0.7531
 9792/14481 [===================>..........] - ETA: 0s - loss: 0.5033 - acc: 0.7516
10496/14481 [====================>.........] - ETA: 0s - loss: 0.5034 - acc: 0.7516
11200/14481 [======================>.......] - ETA: 0s - loss: 0.5053 - acc: 0.7512
11904/14481 [=======================>......] - ETA: 0s - loss: 0.5042 - acc: 0.7527
12608/14481 [=========================>....] - ETA: 0s - loss: 0.5027 - acc: 0.7539
13248/14481 [==========================>...] - ETA: 0s - loss: 0.5020 - acc: 0.7542
13952/14481 [===========================>..] - ETA: 0s - loss: 0.5035 - acc: 0.7539
14481/14481 [==============================] - 1s 76us/step - loss: 0.5036 - acc: 0.7535

Test accuracy: 78.67887508175278

data size :  16010

zero :  8006

one :  8004

train_zero :  7241

train_one :  7240

test_zero :  765

test_one :  764

choose_zero :  723

choose_one :  806

F1score :  0.7923566878980891

AUC : 0.8689508264038599

Confusion Matrix
[[581 184]
 [142 622]]
True label 0
0.7594771241830065  
0.24052287581699347  
True label 1
0.18586387434554974  
0.8141361256544503  

Train_result {'loss': [0.5035695674982316], 'acc': [0.7534700642385483]}
Saved model to disk



[[72.33485938521909, 1], [74.42773054283846, 2], [75.60497056899933, 3], [75.21255722694572, 4], [75.40876389797253, 5], [76.2589928057554, 6], [75.14715500327011, 7], [78.09025506867233, 8], [77.50163505559189, 9], [76.91301504251145, 10], [77.6978417266187, 11], [77.82864617396991, 12], [76.45519947678221, 13], [78.61347285807717, 14], [78.67887508175278, 15]]
max accuracy :  [78.67887508175278, 15]

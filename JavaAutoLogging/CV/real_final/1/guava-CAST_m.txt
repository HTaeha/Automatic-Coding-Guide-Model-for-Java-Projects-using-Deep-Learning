2019-08-06 05:30:48.347876: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
First data
zero : 
44755
one : 
13975

Second data
zero : 
44755
one : 
13975

guava-AST

Sentence length Average : 31

Under 10 : 0
Over 10, Under 200 : 31112
Over 200, Under 400 : 115
Over 400 : 0


guava-code

Sentence length Average : 48

Under 10 : 0
Over 10, Under 200 : 30774
Over 200, Under 400 : 453
Over 400 : 0


Test_zero:  2427
Train_zero:  21948
zero:  24375
Test_one:  1002
Train_one:  9279
one:  10281
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 740s - loss: 0.2822 - acc: 0.8833

Test accuracy: 91.72069825436408

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  885

choose_one :  1120

F1score :  0.9217719132893496

AUC : 0.9804329526390887

Confusion Matrix
[[861 142]
 [ 24 978]]
True label 0
0.8584247258225324  
0.1415752741774676  
True label 1
0.023952095808383235  
0.9760479041916168  

Train_result {'acc': [0.8833450078161326], 'loss': [0.28216690891078333]}
2

Epoch 1/1
 - 746s - loss: 0.1775 - acc: 0.9265

Test accuracy: 94.4139650872818

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  997

choose_one :  1008

F1score :  0.9442786069651741

AUC : 0.9870697289369417

Confusion Matrix
[[944  59]
 [ 53 949]]
True label 0
0.9411764705882353  
0.058823529411764705  
True label 1
0.05289421157684631  
0.9471057884231537  

Train_result {'acc': [0.9265046608146777], 'loss': [0.17748733877804884]}
3

Epoch 1/1
 - 747s - loss: 0.1379 - acc: 0.9473

Test accuracy: 95.41147132169576

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  969

choose_one :  1036

F1score :  0.9548577036310109

AUC : 0.9919672121360469

Confusion Matrix
[[940  63]
 [ 29 973]]
True label 0
0.9371884346959123  
0.06281156530408774  
True label 1
0.028942115768463075  
0.9710578842315369  

Train_result {'acc': [0.9473031951670849], 'loss': [0.1379054504030127]}
4

Epoch 1/1
 - 747s - loss: 0.1051 - acc: 0.9603

Test accuracy: 96.30922693266832

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  989

choose_one :  1016

F1score :  0.9633300297324083

AUC : 0.9937851117306762

Confusion Matrix
[[959  44]
 [ 30 972]]
True label 0
0.9561316051844466  
0.04386839481555334  
True label 1
0.029940119760479042  
0.9700598802395209  

Train_result {'acc': [0.9603426908295668], 'loss': [0.1050977371350028]}
5

Epoch 1/1
 - 758s - loss: 0.0834 - acc: 0.9690

Test accuracy: 96.9077306733167

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  985

choose_one :  1020

F1score :  0.9693372898120672

AUC : 0.9955960461927591

Confusion Matrix
[[963  40]
 [ 22 980]]
True label 0
0.9601196410767697  
0.03988035892323031  
True label 1
0.021956087824351298  
0.9780439121756487  

Train_result {'acc': [0.9689638450347541], 'loss': [0.08337652812897517]}
6

Epoch 1/1
 - 760s - loss: 0.0667 - acc: 0.9755

Test accuracy: 97.20698254364089

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  1001

choose_one :  1004

F1score :  0.9720837487537387

AUC : 0.9960617150544374

Confusion Matrix
[[974  29]
 [ 27 975]]
True label 0
0.9710867397806581  
0.028913260219341975  
True label 1
0.02694610778443114  
0.9730538922155688  

Train_result {'acc': [0.9754835928178205], 'loss': [0.06674968767582004]}
7

Epoch 1/1
 - 750s - loss: 0.0548 - acc: 0.9816

Test accuracy: 97.80548628428927

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  977

choose_one :  1028

F1score :  0.9783251231527094

AUC : 0.9973144438938674

Confusion Matrix
[[968  35]
 [  9 993]]
True label 0
0.9651046859421735  
0.03489531405782652  
True label 1
0.008982035928143712  
0.9910179640718563  

Train_result {'acc': [0.9816261652028665], 'loss': [0.054779221560164515]}
8

Epoch 1/1
 - 747s - loss: 0.0430 - acc: 0.9856

Test accuracy: 97.45635910224439

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  978

choose_one :  1027

F1score :  0.9748644652538195

AUC : 0.9974010105412306

Confusion Matrix
[[965  38]
 [ 13 989]]
True label 0
0.9621136590229312  
0.03788634097706879  
True label 1
0.012974051896207584  
0.9870259481037924  

Train_result {'acc': [0.9855595667870036], 'loss': [0.0429923232461056]}
9

Epoch 1/1
 - 748s - loss: 0.0407 - acc: 0.9884

Test accuracy: 97.75561097256858

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  988

choose_one :  1017

F1score :  0.9777117384843984

AUC : 0.9972920559678251

Confusion Matrix
[[973  30]
 [ 15 987]]
True label 0
0.9700897308075773  
0.02991026919242273  
True label 1
0.014970059880239521  
0.9850299401197605  

Train_result {'acc': [0.9884153241015141], 'loss': [0.0406525992316591]}
10

Epoch 1/1
 - 748s - loss: 0.0307 - acc: 0.9898

Test accuracy: 98.00498753117208

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  993

choose_one :  1012

F1score :  0.9801390268123138

AUC : 0.9972238971707631

Confusion Matrix
[[978  25]
 [ 15 987]]
True label 0
0.9750747756729811  
0.024925224327018942  
True label 1
0.014970059880239521  
0.9850299401197605  

Train_result {'acc': [0.9898162616520286], 'loss': [0.030657557430936445]}
11

Epoch 1/1
 - 748s - loss: 0.0269 - acc: 0.9914

Test accuracy: 98.25436408977556

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  1000

choose_one :  1005

F1score :  0.9825610363726955

AUC : 0.9973895678234757

Confusion Matrix
[[984  19]
 [ 16 986]]
True label 0
0.9810568295114656  
0.018943170488534396  
True label 1
0.015968063872255488  
0.9840319361277445  

Train_result {'acc': [0.9913788457948127], 'loss': [0.026927971409529402]}
12

Epoch 1/1
 - 756s - loss: 0.0268 - acc: 0.9923

Test accuracy: 98.20448877805487

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  989

choose_one :  1016

F1score :  0.9821605550049555

AUC : 0.9976716556916079

Confusion Matrix
[[978  25]
 [ 11 991]]
True label 0
0.9750747756729811  
0.024925224327018942  
True label 1
0.010978043912175649  
0.9890219560878244  

Train_result {'acc': [0.9922948434721698], 'loss': [0.026845567034889942]}
13

Epoch 1/1
 - 757s - loss: 0.0218 - acc: 0.9932

Test accuracy: 98.45386533665835

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  996

choose_one :  1009

F1score :  0.9845847836897066

AUC : 0.9983552337000974

Confusion Matrix
[[984  19]
 [ 12 990]]
True label 0
0.9810568295114656  
0.018943170488534396  
True label 1
0.011976047904191617  
0.9880239520958084  

Train_result {'acc': [0.9931569588878711], 'loss': [0.02182555046246129]}
14

Epoch 1/1
 - 755s - loss: 0.0195 - acc: 0.9945

Test accuracy: 98.35411471321696

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  992

choose_one :  1013

F1score :  0.9836228287841192

AUC : 0.9977114564490163

Confusion Matrix
[[981  22]
 [ 11 991]]
True label 0
0.9780658025922233  
0.02193419740777667  
True label 1
0.010978043912175649  
0.9890219560878244  

Train_result {'acc': [0.9944501320114231], 'loss': [0.019494813909843194]}
15

Epoch 1/1
 - 756s - loss: 0.0221 - acc: 0.9928
Using TensorFlow backend.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)

Test accuracy: 98.40399002493766

data size :  20564

zero :  10283

one :  10281

train_zero :  9280

train_one :  9279

test_zero :  1003

test_one :  1002

choose_zero :  979

choose_one :  1026

F1score :  0.9842209072978303

AUC : 0.9975925516862585

Confusion Matrix
[[975  28]
 [  4 998]]
True label 0
0.9720837487537388  
0.027916251246261216  
True label 1
0.003992015968063872  
0.9960079840319361  

Train_result {'acc': [0.9928336656069832], 'loss': [0.02213541580305988]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:359: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-06 01:05:03.258719: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-06 01:05:03.265250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-08-06 01:05:03.267764: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x788abc0 executing computations on platform Host. Devices:
2019-08-06 01:05:03.267803: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 22839
Over 200, Under 400 : 1085
Over 400 : 0


Test_zero:  1851
Train_zero:  16713
zero:  18564
Test_one:  763
Train_one:  7211
one:  7974

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 344s - loss: 0.5115 - acc: 0.7464

Test accuracy: 79.24034053700065

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  957

choose_one :  570

F1score :  0.7621905476369093

AUC : 0.9033600831657895

Confusion Matrix
[[702  62]
 [255 508]]
True label 0
0.918848167539267  
0.08115183246073299  
True label 1
0.33420707732634336  
0.6657929226736566  

Train_result {'loss': [0.51146620037275], 'acc': [0.7464466477319849]}
2

Epoch 1/1
 - 341s - loss: 0.4298 - acc: 0.8067

Test accuracy: 82.05631958087753

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  772

choose_one :  755

F1score :  0.8194993412384716

AUC : 0.9081050619969396

Confusion Matrix
[[631 133]
 [141 622]]
True label 0
0.8259162303664922  
0.17408376963350786  
True label 1
0.18479685452162517  
0.8152031454783748  

Train_result {'loss': [0.42975834405869356], 'acc': [0.8066976356752651]}
3

Epoch 1/1
 - 345s - loss: 0.3967 - acc: 0.8212

Test accuracy: 82.90766208251473

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  667

choose_one :  860

F1score :  0.8391866913123845

AUC : 0.9138381492180906

Confusion Matrix
[[585 179]
 [ 82 681]]
True label 0
0.7657068062827225  
0.2342931937172775  
True label 1
0.10747051114023591  
0.8925294888597641  

Train_result {'loss': [0.39671828158229233], 'acc': [0.8211883796589604]}
4

Epoch 1/1
 - 345s - loss: 0.3753 - acc: 0.8301

Test accuracy: 86.11656843483956

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  762

choose_one :  765

F1score :  0.8612565445026177

AUC : 0.9284436263577913

Confusion Matrix
[[657 107]
 [105 658]]
True label 0
0.8599476439790575  
0.1400523560209424  
True label 1
0.13761467889908258  
0.8623853211009175  

Train_result {'loss': [0.3752625850014115], 'acc': [0.8300630936698329]}
5

Epoch 1/1
 - 344s - loss: 0.3567 - acc: 0.8405

Test accuracy: 84.67583497053045

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  782

choose_one :  745

F1score :  0.8448275862068966

AUC : 0.925975070848744

Confusion Matrix
[[656 108]
 [126 637]]
True label 0
0.8586387434554974  
0.14136125654450263  
True label 1
0.1651376146788991  
0.8348623853211009  

Train_result {'loss': [0.35670694812346054], 'acc': [0.8405324828109803]}
6

Epoch 1/1
 - 345s - loss: 0.3396 - acc: 0.8498

Test accuracy: 85.13425016371971

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  691

choose_one :  836

F1score :  0.8580362726704189

AUC : 0.9312518441259015

Confusion Matrix
[[614 150]
 [ 77 686]]
True label 0
0.8036649214659686  
0.19633507853403143  
True label 1
0.10091743119266056  
0.8990825688073395  

Train_result {'loss': [0.3395753531123153], 'acc': [0.8497538653870095]}
7

Epoch 1/1
 - 346s - loss: 0.3260 - acc: 0.8593

Test accuracy: 85.26522593320236

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  829

choose_one :  698

F1score :  0.8459958932238194

AUC : 0.9298468775088689

Confusion Matrix
[[684  80]
 [145 618]]
True label 0
0.8952879581151832  
0.10471204188481675  
True label 1
0.19003931847968544  
0.8099606815203145  

Train_result {'loss': [0.32604376768293886], 'acc': [0.859321916342228]}
8

Epoch 1/1
 - 345s - loss: 0.3089 - acc: 0.8671

Test accuracy: 85.92010478061559

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  745

choose_one :  782

F1score :  0.86084142394822

AUC : 0.9333584363184728

Confusion Matrix
[[647 117]
 [ 98 665]]
True label 0
0.8468586387434555  
0.1531413612565445  
True label 1
0.12844036697247707  
0.8715596330275229  

Train_result {'loss': [0.30891929158868203], 'acc': [0.8670872911032911]}
9

Epoch 1/1
 - 344s - loss: 0.2909 - acc: 0.8765

Test accuracy: 84.93778650949574

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  784

choose_one :  743

F1score :  0.847277556440903

AUC : 0.9297302258239383

Confusion Matrix
[[659 105]
 [125 638]]
True label 0
0.862565445026178  
0.13743455497382198  
True label 1
0.16382699868938402  
0.836173001310616  

Train_result {'loss': [0.29085518857902637], 'acc': [0.8765166747101399]}
10

Epoch 1/1
 - 344s - loss: 0.2763 - acc: 0.8850

Test accuracy: 84.74132285527178

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  755

choose_one :  772

F1score :  0.8482084690553746

AUC : 0.9272925487020784

Confusion Matrix
[[643 121]
 [112 651]]
True label 0
0.8416230366492147  
0.15837696335078533  
True label 1
0.14678899082568808  
0.8532110091743119  

Train_result {'loss': [0.276274154720678], 'acc': [0.884975386522997]}
11

Epoch 1/1
 - 345s - loss: 0.2638 - acc: 0.8885

Test accuracy: 84.87229862475442

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  765

choose_one :  762

F1score :  0.8485245901639344

AUC : 0.9283647149238677

Confusion Matrix
[[649 115]
 [116 647]]
True label 0
0.849476439790576  
0.1505235602094241  
True label 1
0.15203145478374835  
0.8479685452162516  

Train_result {'loss': [0.26380343989270294], 'acc': [0.888511405427223]}
12

Epoch 1/1
 - 344s - loss: 0.2447 - acc: 0.8944

Test accuracy: 85.59266535690897

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  820

choose_one :  707

F1score :  0.8503401360544218

AUC : 0.9304627297866646

Confusion Matrix
[[682  82]
 [138 625]]
True label 0
0.8926701570680629  
0.10732984293193717  
True label 1
0.18086500655307994  
0.8191349934469201  

Train_result {'loss': [0.2446666795364954], 'acc': [0.8944047701753046]}
13

Epoch 1/1
 - 344s - loss: 0.2287 - acc: 0.9073

Test accuracy: 85.00327439423707

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  759

choose_one :  768

F1score :  0.8504245591116917

AUC : 0.9320083646119959

Confusion Matrix
[[647 117]
 [112 651]]
True label 0
0.8468586387434555  
0.1531413612565445  
True label 1
0.14678899082568808  
0.8532110091743119  

Train_result {'loss': [0.22873321436136365], 'acc': [0.9073008389543381]}
14

Epoch 1/1
 - 345s - loss: 0.2148 - acc: 0.9117

Test accuracy: 84.93778650949574

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  752

choose_one :  775

F1score :  0.8504551365409622

AUC : 0.93195690063335

Confusion Matrix
[[643 121]
 [109 654]]
True label 0
0.8416230366492147  
0.15837696335078533  
True label 1
0.14285714285714285  
0.8571428571428571  

Train_result {'loss': [0.21484071805433666], 'acc': [0.9117381959701059]}
15

Epoch 1/1
 - 345s - loss: 0.1994 - acc: 0.9170

Test accuracy: 83.43156516044532

data size :  15950

zero :  7976

one :  7974

train_zero :  7212

train_one :  7211

test_zero :  764

test_one :  763

choose_zero :  739

choose_one :  788

F1score :  0.8368794326241136

AUC : 0.9306720166331579

Confusion Matrix
[[625 139]
 [114 649]]
True label 0
0.8180628272251309  
0.18193717277486912  
True label 1
0.14941022280471822  
0.8505897771952818  

Train_result {'loss': [0.19938566058601379], 'acc': [0.9170075573736394]}
Saved model to disk




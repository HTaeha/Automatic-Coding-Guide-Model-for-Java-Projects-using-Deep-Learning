2019-08-06 08:45:52.258257: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
First data
zero : 
39451
one : 
9019

Second data
zero : 
39451
one : 
9019

hbase-AST

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22948
Over 200, Under 400 : 1160
Over 400 : 0


hbase-code

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 21966
Over 200, Under 400 : 2142
Over 400 : 0


Test_zero:  1868
Train_zero:  16871
zero:  18739
Test_one:  764
Train_one:  7237
one:  8001
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 577s - loss: 0.4708 - acc: 0.7816

Test accuracy: 82.99542184434272

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  679

choose_one :  850

F1score :  0.838909541511772

AUC : 0.9166110597816788

Confusion Matrix
[[592 173]
 [ 87 677]]
True label 0
0.7738562091503268  
0.2261437908496732  
True label 1
0.11387434554973822  
0.8861256544502618  

Train_result {'loss': [0.4708133698745095], 'acc': [0.7816234887696301]}
2

Epoch 1/1
 - 590s - loss: 0.3694 - acc: 0.8354

Test accuracy: 83.84565075212556

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  664

choose_one :  865

F1score :  0.8483732351135667

AUC : 0.9292911405399857

Confusion Matrix
[[591 174]
 [ 73 691]]
True label 0
0.7725490196078432  
0.22745098039215686  
True label 1
0.09554973821989529  
0.9044502617801047  

Train_result {'loss': [0.36940143256916286], 'acc': [0.8353713298996908]}
3

Epoch 1/1
 - 590s - loss: 0.3336 - acc: 0.8527

Test accuracy: 79.13669064748201

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  1018

choose_one :  511

F1score :  0.7498039215686274

AUC : 0.9339347431817402

Confusion Matrix
[[732  33]
 [286 478]]
True label 0
0.9568627450980393  
0.043137254901960784  
True label 1
0.3743455497382199  
0.6256544502617801  

Train_result {'loss': [0.3335923392414429], 'acc': [0.8527115716670667]}
4

Epoch 1/1
 - 590s - loss: 0.3029 - acc: 0.8696

Test accuracy: 85.08829300196207

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  625

choose_one :  904

F1score :  0.8633093525179857

AUC : 0.9401592923382267

Confusion Matrix
[[581 184]
 [ 44 720]]
True label 0
0.7594771241830065  
0.24052287581699347  
True label 1
0.05759162303664921  
0.9424083769633508  

Train_result {'loss': [0.30286212273984375], 'acc': [0.8696373056994818]}
5

Epoch 1/1
 - 590s - loss: 0.2749 - acc: 0.8884

Test accuracy: 85.08829300196207

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  653

choose_one :  876

F1score :  0.8609756097560975

AUC : 0.9402619512028197

Confusion Matrix
[[595 170]
 [ 58 706]]
True label 0
0.7777777777777778  
0.2222222222222222  
True label 1
0.07591623036649214  
0.9240837696335078  

Train_result {'loss': [0.27485065008023035], 'acc': [0.8884283246977548]}
6

Epoch 1/1
 - 590s - loss: 0.2460 - acc: 0.8995

Test accuracy: 87.24656638325703

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  684

choose_one :  845

F1score :  0.8788067122436296

AUC : 0.9498092256099647

Confusion Matrix
[[627 138]
 [ 57 707]]
True label 0
0.8196078431372549  
0.1803921568627451  
True label 1
0.07460732984293193  
0.925392670157068  

Train_result {'loss': [0.24595008377120903], 'acc': [0.8994818652849741]}
7

Epoch 1/1
 - 591s - loss: 0.2159 - acc: 0.9112

Test accuracy: 88.1621975147155

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  720

choose_one :  809

F1score :  0.8849332485696123

AUC : 0.9550773363446601

Confusion Matrix
[[652 113]
 [ 68 696]]
True label 0
0.8522875816993464  
0.1477124183006536  
True label 1
0.08900523560209424  
0.9109947643979057  

Train_result {'loss': [0.21592151032828297], 'acc': [0.9112262521547769]}
8

Epoch 1/1
 - 590s - loss: 0.1928 - acc: 0.9221

Test accuracy: 87.96599084368869

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  713

choose_one :  816

F1score :  0.8835443037974684

AUC : 0.9501360229955856

Confusion Matrix
[[647 118]
 [ 66 698]]
True label 0
0.8457516339869281  
0.1542483660130719  
True label 1
0.08638743455497382  
0.9136125654450262  

Train_result {'loss': [0.19282931035664416], 'acc': [0.9220725388806924]}
9

Epoch 1/1
 - 590s - loss: 0.1661 - acc: 0.9349

Test accuracy: 88.03139306736429

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  794

choose_one :  735

F1score :  0.8779186124082722

AUC : 0.9542218458063855

Confusion Matrix
[[688  77]
 [106 658]]
True label 0
0.8993464052287582  
0.10065359477124183  
True label 1
0.1387434554973822  
0.8612565445026178  

Train_result {'loss': [0.16614351804640035], 'acc': [0.934853195164076]}
10

Epoch 1/1
 - 590s - loss: 0.1393 - acc: 0.9476

Test accuracy: 86.65794637017659

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  675

choose_one :  854

F1score :  0.8739184177997529

AUC : 0.9458157957772986

Confusion Matrix
[[618 147]
 [ 57 707]]
True label 0
0.807843137254902  
0.19215686274509805  
True label 1
0.07460732984293193  
0.925392670157068  

Train_result {'loss': [0.1393091137637746], 'acc': [0.9475647668352605]}
11

Epoch 1/1
 - 591s - loss: 0.1165 - acc: 0.9550

Test accuracy: 88.29300196206671

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  774

choose_one :  755

F1score :  0.8821593153390387

AUC : 0.9514988194230571

Confusion Matrix
[[680  85]
 [ 94 670]]
True label 0
0.8888888888888888  
0.1111111111111111  
True label 1
0.12303664921465969  
0.8769633507853403  

Train_result {'loss': [0.11647516315825451], 'acc': [0.9549568221070812]}
12

Epoch 1/1
 - 591s - loss: 0.1024 - acc: 0.9606

Test accuracy: 88.35840418574232

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  767

choose_one :  762

F1score :  0.8833551769331585

AUC : 0.9533971529274886

Confusion Matrix
[[677  88]
 [ 90 674]]
True label 0
0.8849673202614379  
0.11503267973856209  
True label 1
0.11780104712041885  
0.8821989528795812  

Train_result {'loss': [0.10236999634634028], 'acc': [0.9605526770499498]}
13

Epoch 1/1
 - 590s - loss: 0.0847 - acc: 0.9683

Test accuracy: 87.57357750163506

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  689

choose_one :  840

F1score :  0.8815461346633415

AUC : 0.9521053622146939

Confusion Matrix
[[632 133]
 [ 57 707]]
True label 0
0.8261437908496732  
0.1738562091503268  
True label 1
0.07460732984293193  
0.925392670157068  

Train_result {'loss': [0.08467414835381075], 'acc': [0.9682901554404145]}
14

Epoch 1/1
 - 591s - loss: 0.0794 - acc: 0.9714

Test accuracy: 88.75081752779595

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  741

choose_one :  788

F1score :  0.8891752577319588

AUC : 0.9512062416589674

Confusion Matrix
[[667  98]
 [ 74 690]]
True label 0
0.8718954248366013  
0.12810457516339868  
True label 1
0.0968586387434555  
0.9031413612565445  

Train_result {'loss': [0.0794323440471307], 'acc': [0.97139896373057]}
15

Epoch 1/1
 - 592s - loss: 0.0694 - acc: 0.9758
Using TensorFlow backend.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)

Test accuracy: 87.90058862001308

data size :  16004

zero :  8003

one :  8001

train_zero :  7238

train_one :  7237

test_zero :  765

test_one :  764

choose_zero :  748

choose_one :  781

F1score :  0.8802588996763754

AUC : 0.9478800944461554

Confusion Matrix
[[664 101]
 [ 84 680]]
True label 0
0.8679738562091504  
0.13202614379084968  
True label 1
0.1099476439790576  
0.8900523560209425  

Train_result {'loss': [0.06937517182171242], 'acc': [0.9757512953573764]}
Saved model to disk




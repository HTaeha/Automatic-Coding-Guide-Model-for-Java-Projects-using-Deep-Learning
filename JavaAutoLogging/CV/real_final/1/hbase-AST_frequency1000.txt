Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:359: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-06 00:59:44.383388: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-06 00:59:44.394146: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-08-06 00:59:44.396574: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x76b74e0 executing computations on platform Host. Devices:
2019-08-06 00:59:44.396629: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019
hbase-AST
all data

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 200 : 25475
Over 200, Under 400 : 1121
Over 400 : 180

hbase-AST
updated_train_data

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 22907
Over 200, Under 400 : 1152
Over 400 : 0


Test_zero:  1862
Train_zero:  16819
zero:  18681
Test_one:  763
Train_one:  7240
one:  8003

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 334s - loss: 0.5014 - acc: 0.7582

Test accuracy: 81.27046496398165

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  730

choose_one :  797

F1score :  0.8166666666666667

AUC : 0.8975463690447599

Confusion Matrix
[[604 160]
 [126 637]]
True label 0
0.7905759162303665  
0.2094240837696335  
True label 1
0.1651376146788991  
0.8348623853211009  

Train_result {'loss': [0.5014260619041151], 'acc': [0.7582349285517318]}
2

Epoch 1/1
 - 335s - loss: 0.4121 - acc: 0.8150

Test accuracy: 83.23510150622135

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  812

choose_one :  715

F1score :  0.8267929634641408

AUC : 0.916118003472103

Confusion Matrix
[[660 104]
 [152 611]]
True label 0
0.8638743455497382  
0.13612565445026178  
True label 1
0.19921363040629095  
0.8007863695937091  

Train_result {'loss': [0.4121133557822887], 'acc': [0.814998964180514]}
3

Epoch 1/1
 - 334s - loss: 0.3864 - acc: 0.8286

Test accuracy: 83.30058939096267

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  635

choose_one :  892

F1score :  0.8459214501510575

AUC : 0.9178694942120178

Confusion Matrix
[[572 192]
 [ 63 700]]
True label 0
0.7486910994764397  
0.2513089005235602  
True label 1
0.08256880733944955  
0.9174311926605505  

Train_result {'loss': [0.38640047491160673], 'acc': [0.8286029970388239]}
4

Epoch 1/1
 - 335s - loss: 0.3654 - acc: 0.8366

Test accuracy: 83.62802881466929

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  724

choose_one :  803

F1score :  0.8403575989782887

AUC : 0.9184253051813933

Confusion Matrix
[[619 145]
 [105 658]]
True label 0
0.8102094240837696  
0.18979057591623036  
True label 1
0.13761467889908258  
0.8623853211009175  

Train_result {'loss': [0.36539352836632594], 'acc': [0.8366134935556118]}
5

Epoch 1/1
 - 334s - loss: 0.3408 - acc: 0.8517

Test accuracy: 85.26522593320236

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  775

choose_one :  752

F1score :  0.8514851485148514

AUC : 0.9301728160402929

Confusion Matrix
[[657 107]
 [118 645]]
True label 0
0.8599476439790575  
0.1400523560209424  
True label 1
0.15465268676277852  
0.8453473132372215  

Train_result {'loss': [0.3408387477883531], 'acc': [0.851667702514965]}
6

Epoch 1/1
 - 334s - loss: 0.3296 - acc: 0.8593

Test accuracy: 84.61034708578913

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  729

choose_one :  798

F1score :  0.8494554772581678

AUC : 0.9284659274152045

Confusion Matrix
[[629 135]
 [100 663]]
True label 0
0.8232984293193717  
0.17670157068062828  
True label 1
0.1310615989515072  
0.8689384010484927  

Train_result {'loss': [0.3295548268814507], 'acc': [0.8592638630093514]}
7

Epoch 1/1
 - 335s - loss: 0.3138 - acc: 0.8689

Test accuracy: 85.92010478061559

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  755

choose_one :  772

F1score :  0.8599348534201954

AUC : 0.9354770367727282

Confusion Matrix
[[652 112]
 [103 660]]
True label 0
0.8534031413612565  
0.14659685863874344  
True label 1
0.1349934469200524  
0.8650065530799476  

Train_result {'loss': [0.31382416729978596], 'acc': [0.8688626476113255]}
8

Epoch 1/1
 - 335s - loss: 0.2949 - acc: 0.8759

Test accuracy: 85.19973804846104

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  842

choose_one :  685

F1score :  0.8439226519337016

AUC : 0.9344117324147585

Confusion Matrix
[[690  74]
 [152 611]]
True label 0
0.9031413612565445  
0.0968586387434555  
True label 1
0.19921363040629095  
0.8007863695937091  

Train_result {'loss': [0.29493876727161944], 'acc': [0.8759063600703553]}
9

Epoch 1/1
 - 335s - loss: 0.2817 - acc: 0.8805

Test accuracy: 85.0687622789784

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  768

choose_one :  759

F1score :  0.8501971090670171

AUC : 0.934205876500175

Confusion Matrix
[[652 112]
 [116 647]]
True label 0
0.8534031413612565  
0.14659685863874344  
True label 1
0.15203145478374835  
0.8479685452162516  

Train_result {'loss': [0.2817214985108163], 'acc': [0.8805331123705834]}
10

Epoch 1/1
 - 335s - loss: 0.2645 - acc: 0.8869

Test accuracy: 85.52717747216765

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  777

choose_one :  750

F1score :  0.8539325842696628

AUC : 0.933758139885956

Confusion Matrix
[[660 104]
 [117 646]]
True label 0
0.8638743455497382  
0.13612565445026178  
True label 1
0.15334207077326342  
0.8466579292267365  

Train_result {'loss': [0.2645227598284549], 'acc': [0.8868862647771851]}
11

Epoch 1/1
 - 335s - loss: 0.2527 - acc: 0.8923

Test accuracy: 86.44400785854617

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  747

choose_one :  780

F1score :  0.8658457550226829

AUC : 0.932680827266302

Confusion Matrix
[[652 112]
 [ 95 668]]
True label 0
0.8534031413612565  
0.14659685863874344  
True label 1
0.12450851900393185  
0.8754914809960681  

Train_result {'loss': [0.25267098487189077], 'acc': [0.8922726331054485]}
12

Epoch 1/1
 - 335s - loss: 0.2327 - acc: 0.9026

Test accuracy: 86.11656843483956

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  770

choose_one :  757

F1score :  0.8605263157894738

AUC : 0.9334390632183514

Confusion Matrix
[[661 103]
 [109 654]]
True label 0
0.8651832460732984  
0.13481675392670156  
True label 1
0.14285714285714285  
0.8571428571428571  

Train_result {'loss': [0.23274968608655075], 'acc': [0.9025619777763147]}
13

Epoch 1/1
 - 334s - loss: 0.2218 - acc: 0.9102

Test accuracy: 85.85461689587426

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  770

choose_one :  757

F1score :  0.8578947368421054

AUC : 0.9354907605003671

Confusion Matrix
[[659 105]
 [111 652]]
True label 0
0.862565445026178  
0.13743455497382198  
True label 1
0.145478374836173  
0.854521625163827  

Train_result {'loss': [0.22178693228799923], 'acc': [0.910158138262469]}
14

Epoch 1/1
 - 333s - loss: 0.1985 - acc: 0.9196

Test accuracy: 85.19973804846104

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  764

choose_one :  763

F1score :  0.8519003931847968

AUC : 0.9288656309826875

Confusion Matrix
[[651 113]
 [113 650]]
True label 0
0.8520942408376964  
0.14790575916230367  
True label 1
0.14809960681520315  
0.8519003931847968  

Train_result {'loss': [0.19847858024509102], 'acc': [0.9196188108556039]}
15

Epoch 1/1
 - 334s - loss: 0.1878 - acc: 0.9242

Test accuracy: 86.57498362802882

data size :  16008

zero :  8005

one :  8003

train_zero :  7241

train_one :  7240

test_zero :  764

test_one :  763

choose_zero :  831

choose_one :  696

F1score :  0.8594928032899245

AUC : 0.9366315453603508

Confusion Matrix
[[695  69]
 [136 627]]
True label 0
0.9096858638743456  
0.09031413612565445  
True label 1
0.1782437745740498  
0.8217562254259502  

Train_result {'loss': [0.18779010516681088], 'acc': [0.924245563151716]}
Saved model to disk




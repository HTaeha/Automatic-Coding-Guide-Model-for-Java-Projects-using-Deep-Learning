Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:530: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 16:05:15.499329: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 16:05:15.511835: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-02 16:05:15.514833: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xe574d10 executing computations on platform Host. Devices:
2019-08-02 16:05:15.514897: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
44755
one : 
13975

Second data
zero : 
44755
one : 
13975

guava-AST

Sentence length Average : 31

Under 10 : 0
Over 10, Under 200 : 30960
Over 200, Under 400 : 119
Over 400 : 0


guava-code

Sentence length Average : 42

Under 10 : 0
Over 10, Under 200 : 30650
Over 200, Under 400 : 429
Over 400 : 0


Test_zero:  2436
Train_zero:  21897
zero:  24333
Test_one:  994
Train_one:  9182
one:  10176
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 742s - loss: 0.2912 - acc: 0.8757

Test accuracy: 89.79386626445451

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  936

choose_one :  1053

F1score :  0.9008304836345871

AUC : 0.9684559619020656

Confusion Matrix
[[864 131]
 [ 72 922]]
True label 0
0.8683417085427135  
0.13165829145728644  
True label 1
0.07243460764587525  
0.9275653923541247  

Train_result {'acc': [0.8757419003669163], 'loss': [0.29118902575830136]}
2

Epoch 1/1
 - 739s - loss: 0.1850 - acc: 0.9237

Test accuracy: 93.31322272498743

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  1000

choose_one :  989

F1score :  0.9329299041855775

AUC : 0.9838831986896251

Confusion Matrix
[[931  64]
 [ 69 925]]
True label 0
0.935678391959799  
0.06432160804020101  
True label 1
0.06941649899396378  
0.9305835010060363  

Train_result {'acc': [0.9237135855956198], 'loss': [0.18503383021936604]}
3

Epoch 1/1
 - 740s - loss: 0.1473 - acc: 0.9423

Test accuracy: 93.86626445449974

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  965

choose_one :  1024

F1score :  0.9395441030723489

AUC : 0.9879113879255432

Confusion Matrix
[[919  76]
 [ 46 948]]
True label 0
0.9236180904522613  
0.0763819095477387  
True label 1
0.04627766599597585  
0.9537223340040242  

Train_result {'acc': [0.9423359651218927], 'loss': [0.14730766492028863]}
4

Epoch 1/1
 - 739s - loss: 0.1161 - acc: 0.9586

Test accuracy: 95.67621920563097

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  995

choose_one :  994

F1score :  0.9567404426559356

AUC : 0.9892854615127954

Confusion Matrix
[[952  43]
 [ 43 951]]
True label 0
0.9567839195979899  
0.04321608040201005  
True label 1
0.043259557344064385  
0.9567404426559356  

Train_result {'acc': [0.9585624829839369], 'loss': [0.11605691707328168]}
5

Epoch 1/1
 - 739s - loss: 0.0934 - acc: 0.9659

Test accuracy: 95.82704876822524

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  968

choose_one :  1021

F1score :  0.9588089330024814

AUC : 0.989375954217769

Confusion Matrix
[[940  55]
 [ 28 966]]
True label 0
0.9447236180904522  
0.05527638190954774  
True label 1
0.028169014084507043  
0.971830985915493  

Train_result {'acc': [0.9659134223063246], 'loss': [0.09343238839361864]}
6

Epoch 1/1
 - 738s - loss: 0.0753 - acc: 0.9728

Test accuracy: 95.92760180995475

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  956

choose_one :  1033

F1score :  0.9600394671928959

AUC : 0.9913223056934573

Confusion Matrix
[[935  60]
 [ 21 973]]
True label 0
0.9396984924623115  
0.06030150753768844  
True label 1
0.02112676056338028  
0.9788732394366197  

Train_result {'acc': [0.9728287503111113], 'loss': [0.07533400615704115]}
7

Epoch 1/1
 - 739s - loss: 0.0622 - acc: 0.9783

Test accuracy: 96.53092006033182

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  960

choose_one :  1029

F1score :  0.9658922392486405

AUC : 0.9929355024620082

Confusion Matrix
[[943  52]
 [ 17 977]]
True label 0
0.9477386934673366  
0.05226130653266332  
True label 1
0.01710261569416499  
0.9828973843058351  

Train_result {'acc': [0.9782738905591728], 'loss': [0.06222030728983901]}
8

Epoch 1/1
 - 740s - loss: 0.0498 - acc: 0.9831

Test accuracy: 97.63700351935645

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  982

choose_one :  1007

F1score :  0.976511744127936

AUC : 0.9948823594835343

Confusion Matrix
[[965  30]
 [ 17 977]]
True label 0
0.9698492462311558  
0.03015075376884422  
True label 1
0.01710261569416499  
0.9828973843058351  

Train_result {'acc': [0.9831200653416825], 'loss': [0.04981072746125209]}
9

Epoch 1/1
 - 739s - loss: 0.0384 - acc: 0.9879

Test accuracy: 97.08396178984414

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  995

choose_one :  994

F1score :  0.9708249496981891

AUC : 0.9946336309313167

Confusion Matrix
[[966  29]
 [ 29 965]]
True label 0
0.9708542713567839  
0.02914572864321608  
True label 1
0.029175050301810865  
0.9708249496981891  

Train_result {'acc': [0.9878573372972261], 'loss': [0.0384270343866702]}
10

Epoch 1/1
 - 751s - loss: 0.0370 - acc: 0.9887

Test accuracy: 97.5867269984917

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  971

choose_one :  1018

F1score :  0.9761431411530814

AUC : 0.994810571974561

Confusion Matrix
[[959  36]
 [ 12 982]]
True label 0
0.963819095477387  
0.036180904522613064  
True label 1
0.012072434607645875  
0.9879275653923542  

Train_result {'acc': [0.9886741083582902], 'loss': [0.036983330324305175]}
11

Epoch 1/1
 - 751s - loss: 0.0290 - acc: 0.9905

Test accuracy: 97.2347913524384

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  996

choose_one :  993

F1score :  0.9723200805234021

AUC : 0.9956851662740261

Confusion Matrix
[[968  27]
 [ 28 966]]
True label 0
0.9728643216080402  
0.027135678391959798  
True label 1
0.028169014084507043  
0.971830985915493  

Train_result {'acc': [0.9905254560304928], 'loss': [0.029049522054445123]}
12

Epoch 1/1
 - 752s - loss: 0.0290 - acc: 0.9909

Test accuracy: 98.19004524886877

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  979

choose_one :  1010

F1score :  0.9820359281437127

AUC : 0.9954419987260246

Confusion Matrix
[[969  26]
 [ 10 984]]
True label 0
0.9738693467336683  
0.02613065326633166  
True label 1
0.01006036217303823  
0.9899396378269618  

Train_result {'acc': [0.9908521644432344], 'loss': [0.029019569157462823]}
13

Epoch 1/1
 - 752s - loss: 0.0247 - acc: 0.9923

Test accuracy: 98.0392156862745

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  974

choose_one :  1015

F1score :  0.9805873568939772

AUC : 0.9941205019059078

Confusion Matrix
[[965  30]
 [  9 985]]
True label 0
0.9698492462311558  
0.03015075376884422  
True label 1
0.009054325955734407  
0.9909456740442656  

Train_result {'acc': [0.9923223523005718], 'loss': [0.024687503474975725]}
14

Epoch 1/1
 - 751s - loss: 0.0224 - acc: 0.9939

Test accuracy: 97.83810960281548

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  966

choose_one :  1023

F1score :  0.9786812097174021

AUC : 0.9936917990354184

Confusion Matrix
[[959  36]
 [  7 987]]
True label 0
0.963819095477387  
0.036180904522613064  
True label 1
0.007042253521126761  
0.9929577464788732  

Train_result {'acc': [0.9939014429621563], 'loss': [0.02236214600644995]}
15

Epoch 1/1
 - 763s - loss: 0.0218 - acc: 0.9944

Test accuracy: 97.43589743589743

data size :  20354

zero :  10178

one :  10176

train_zero :  9183

train_one :  9182

test_zero :  995

test_one :  994

choose_zero :  956

choose_one :  1033

F1score :  0.9748396645288604

AUC : 0.9935204189963903

Confusion Matrix
[[950  45]
 [  6 988]]
True label 0
0.9547738693467337  
0.04522613065326633  
True label 1
0.006036217303822937  
0.993963782696177  

Train_result {'acc': [0.9944459569833923], 'loss': [0.021775836115207784]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 10:09:27.686184: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 10:09:27.696524: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-02 10:09:27.699156: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x720f080 executing computations on platform Host. Devices:
2019-08-02 10:09:27.699194: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
31687

one : 
7755
glassfish-CAST
all data

Sentence length Average : 71

Under 10 : 9739
Over 10, Under 200 : 26001
Over 200, Under 400 : 2683
Over 400 : 1019

glassfish-CAST
updated_train_data

Sentence length Average : 82

Under 10 : 0
Over 10, Under 200 : 23095
Over 200, Under 400 : 3182
Over 400 : 0


Test_zero:  2254
Train_zero:  20376
zero:  22630
Test_one:  664
Train_one:  5901
one:  6565

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 272s - loss: 0.4597 - acc: 0.7900

Test accuracy: 85.32731376975168

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  720

choose_one :  609

F1score :  0.8468185388845247

AUC : 0.9181334359996378

Confusion Matrix
[[595  70]
 [125 539]]
True label 0
0.8947368421052632  
0.10526315789473684  
True label 1
0.18825301204819278  
0.8117469879518072  

Train_result {'acc': [0.7899686520527675], 'loss': [0.45965567933122337]}
2

Epoch 1/1
 - 278s - loss: 0.3330 - acc: 0.8614

Test accuracy: 86.23024830699775

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  618

choose_one :  711

F1score :  0.8669090909090909

AUC : 0.9389641271854335

Confusion Matrix
[[550 115]
 [ 68 596]]
True label 0
0.8270676691729323  
0.17293233082706766  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.8613911717006496], 'loss': [0.3329700885395332]}
3

Epoch 1/1
 - 281s - loss: 0.2879 - acc: 0.8830

Test accuracy: 87.81038374717834

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  669

choose_one :  660

F1score :  0.877643504531722

AUC : 0.9445692544614549

Confusion Matrix
[[586  79]
 [ 83 581]]
True label 0
0.881203007518797  
0.11879699248120301  
True label 1
0.125  
0.875  

Train_result {'acc': [0.8829958485635895], 'loss': [0.2879359255748654]}
4

Epoch 1/1
 - 280s - loss: 0.2516 - acc: 0.8961

Test accuracy: 88.56282919488338

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  667

choose_one :  662

F1score :  0.8853695324283559

AUC : 0.9489401213878069

Confusion Matrix
[[590  75]
 [ 77 587]]
True label 0
0.8872180451127819  
0.11278195488721804  
True label 1
0.11596385542168675  
0.8840361445783133  

Train_result {'acc': [0.8961281030398046], 'loss': [0.2515936036221225]}
5

Epoch 1/1
 - 281s - loss: 0.2177 - acc: 0.9121

Test accuracy: 89.0142964635064

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  719

choose_one :  610

F1score :  0.8854003139717426

AUC : 0.9508469970105988

Confusion Matrix
[[619  46]
 [100 564]]
True label 0
0.9308270676691729  
0.06917293233082707  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'acc': [0.9121409810862985], 'loss': [0.21771946283030347]}
6

Epoch 1/1
 - 281s - loss: 0.1895 - acc: 0.9248

Test accuracy: 90.06772009029346

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  677

choose_one :  652

F1score :  0.8996960486322187

AUC : 0.9601866111060784

Confusion Matrix
[[605  60]
 [ 72 592]]
True label 0
0.9097744360902256  
0.09022556390977443  
True label 1
0.10843373493975904  
0.891566265060241  

Train_result {'acc': [0.9248496145552865], 'loss': [0.18948096326652306]}
7

Epoch 1/1
 - 281s - loss: 0.1637 - acc: 0.9374

Test accuracy: 86.38073739653875

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  594

choose_one :  735

F1score :  0.8706218727662617

AUC : 0.9453347223480387

Confusion Matrix
[[539 126]
 [ 55 609]]
True label 0
0.8105263157894737  
0.18947368421052632  
True label 1
0.08283132530120482  
0.9171686746987951  

Train_result {'acc': [0.9373887995234145], 'loss': [0.1637267994898856]}
8

Epoch 1/1
 - 281s - loss: 0.1476 - acc: 0.9450

Test accuracy: 89.91723100075244

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  711

choose_one :  618

F1score :  0.8954758190327614

AUC : 0.9609067850348764

Confusion Matrix
[[621  44]
 [ 90 574]]
True label 0
0.9338345864661655  
0.06616541353383458  
True label 1
0.1355421686746988  
0.8644578313253012  

Train_result {'acc': [0.9450139794613884], 'loss': [0.14764277065475948]}
9

Epoch 1/1
 - 282s - loss: 0.1253 - acc: 0.9535

Test accuracy: 90.59443190368698

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  682

choose_one :  647

F1score :  0.9046529366895499

AUC : 0.9609158438264337

Confusion Matrix
[[611  54]
 [ 71 593]]
True label 0
0.9187969924812031  
0.081203007518797  
True label 1
0.10692771084337349  
0.8930722891566265  

Train_result {'acc': [0.9534864018127635], 'loss': [0.12534498232765176]}
10

Epoch 1/1
 - 281s - loss: 0.1024 - acc: 0.9626

Test accuracy: 89.99247554552295

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  646

choose_one :  683

F1score :  0.9012620638455828

AUC : 0.9647137421867922

Confusion Matrix
[[589  76]
 [ 57 607]]
True label 0
0.8857142857142857  
0.11428571428571428  
True label 1
0.0858433734939759  
0.9141566265060241  

Train_result {'acc': [0.9625518936368759], 'loss': [0.10237716876477253]}
11

Epoch 1/1
 - 284s - loss: 0.0981 - acc: 0.9657

Test accuracy: 89.91723100075244

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  705

choose_one :  624

F1score :  0.8959627329192548

AUC : 0.9630559833318235

Confusion Matrix
[[618  47]
 [ 87 577]]
True label 0
0.9293233082706767  
0.07067669172932331  
True label 1
0.13102409638554216  
0.8689759036144579  

Train_result {'acc': [0.9656866898397707], 'loss': [0.09813355620958983]}
12

Epoch 1/1
 - 291s - loss: 0.0801 - acc: 0.9700

Test accuracy: 91.19638826185101

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  684

choose_one :  645

F1score :  0.9106187929717341

AUC : 0.9649719177461726

Confusion Matrix
[[616  49]
 [ 68 596]]
True label 0
0.9263157894736842  
0.07368421052631578  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.970007625180039], 'loss': [0.08005196938050649]}
13

Epoch 1/1
 - 290s - loss: 0.0699 - acc: 0.9762

Test accuracy: 90.51918735891647

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  667

choose_one :  662

F1score :  0.9049773755656108

AUC : 0.9670667632937765

Confusion Matrix
[[603  62]
 [ 64 600]]
True label 0
0.9067669172932331  
0.09323308270676692  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'acc': [0.9761924933985231], 'loss': [0.0698787488512323]}
14

Epoch 1/1
 - 290s - loss: 0.0598 - acc: 0.9798

Test accuracy: 90.44394281414597

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  714

choose_one :  615

F1score :  0.9007036747458953

AUC : 0.9665572062686838

Confusion Matrix
[[626  39]
 [ 88 576]]
True label 0
0.9413533834586466  
0.058646616541353384  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'acc': [0.9798356350080488], 'loss': [0.059787020387320054]}
15

Epoch 1/1
 - 291s - loss: 0.0565 - acc: 0.9806

Test accuracy: 90.59443190368698

data size :  13132

zero :  6567

one :  6565

train_zero :  5902

train_one :  5901

test_zero :  665

test_one :  664

choose_zero :  676

choose_one :  653

F1score :  0.9050873196659074

AUC : 0.9628997191774618

Confusion Matrix
[[608  57]
 [ 68 596]]
True label 0
0.9142857142857143  
0.08571428571428572  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.9805981529765964], 'loss': [0.05651756673869013]}
Saved model to disk




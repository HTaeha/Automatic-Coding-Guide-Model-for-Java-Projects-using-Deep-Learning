Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 12:56:11.304816: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 12:56:11.316421: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-02 12:56:11.318807: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9f17150 executing computations on platform Host. Devices:
2019-08-02 12:56:11.318847: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-code
all data

Sentence length Average : 29

Under 10 : 16024
Over 10, Under 200 : 42161
Over 200, Under 400 : 494
Over 400 : 51

guava-code
updated_train_data

Sentence length Average : 38

Under 10 : 0
Over 10, Under 200 : 37234
Over 200, Under 400 : 446
Over 400 : 0


Test_zero:  3120
Train_zero:  28028
zero:  31148
Test_one:  1064
Train_one:  9652
one:  10716

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 451s - loss: 0.2985 - acc: 0.8776

Test accuracy: 89.66651009863786

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  995

choose_one :  1134

F1score :  0.899909008189263

AUC : 0.9663816230717639

Confusion Matrix
[[920 145]
 [ 75 989]]
True label 0
0.863849765258216  
0.13615023474178403  
True label 1
0.07048872180451128  
0.9295112781954887  

Train_result {'loss': [0.2984872156529808], 'acc': [0.8775964775964776]}
2

Epoch 1/1
 - 458s - loss: 0.2007 - acc: 0.9205

Test accuracy: 92.48473461719117

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1101

choose_one :  1028

F1score :  0.9235181644359465

AUC : 0.9761234071093225

Confusion Matrix
[[1003   62]
 [  98  966]]
True label 0
0.9417840375586854  
0.05821596244131456  
True label 1
0.09210526315789473  
0.9078947368421053  

Train_result {'loss': [0.20070431676669864], 'acc': [0.9205387205387205]}
3

Epoch 1/1
 - 459s - loss: 0.1597 - acc: 0.9383

Test accuracy: 93.98778769375294

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1033

choose_one :  1096

F1score :  0.9407407407407407

AUC : 0.9836174944403261

Confusion Matrix
[[ 985   80]
 [  48 1016]]
True label 0
0.9248826291079812  
0.07511737089201878  
True label 1
0.045112781954887216  
0.9548872180451128  

Train_result {'loss': [0.15973943087531167], 'acc': [0.9382543382543382]}
4

Epoch 1/1
 - 458s - loss: 0.1269 - acc: 0.9513

Test accuracy: 94.50446218882105

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1058

choose_one :  1071

F1score :  0.94519906323185

AUC : 0.9852492145857602

Confusion Matrix
[[1003   62]
 [  55 1009]]
True label 0
0.9417840375586854  
0.05821596244131456  
True label 1
0.05169172932330827  
0.9483082706766918  

Train_result {'loss': [0.12691613792720868], 'acc': [0.9512561512561513]}
5

Epoch 1/1
 - 457s - loss: 0.1026 - acc: 0.9619

Test accuracy: 93.1892907468295

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1110

choose_one :  1019

F1score :  0.9303888622179548

AUC : 0.98645248685093

Confusion Matrix
[[1015   50]
 [  95  969]]
True label 0
0.9530516431924883  
0.046948356807511735  
True label 1
0.08928571428571429  
0.9107142857142857  

Train_result {'loss': [0.10262303615355084], 'acc': [0.9619269619269619]}
6

Epoch 1/1
 - 458s - loss: 0.0804 - acc: 0.9705

Test accuracy: 94.9741662752466

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1044

choose_one :  1085

F1score :  0.9502093997208004

AUC : 0.9908022697589043

Confusion Matrix
[[1001   64]
 [  43 1021]]
True label 0
0.939906103286385  
0.06009389671361502  
True label 1
0.040413533834586464  
0.9595864661654135  

Train_result {'loss': [0.08037437311562039], 'acc': [0.9704739704739704]}
7

Epoch 1/1
 - 458s - loss: 0.0664 - acc: 0.9756

Test accuracy: 95.63175199624237

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1032

choose_one :  1097

F1score :  0.9569643683479869

AUC : 0.9913917716827281

Confusion Matrix
[[1002   63]
 [  30 1034]]
True label 0
0.9408450704225352  
0.059154929577464786  
True label 1
0.02819548872180451  
0.9718045112781954  

Train_result {'loss': [0.06643744836695496], 'acc': [0.9755503755503756]}
8

Epoch 1/1
 - 459s - loss: 0.0569 - acc: 0.9807

Test accuracy: 96.14842649131047

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1089

choose_one :  1040

F1score :  0.9610266159695817

AUC : 0.9919662713120831

Confusion Matrix
[[1036   29]
 [  53 1011]]
True label 0
0.9727699530516432  
0.027230046948356807  
True label 1
0.04981203007518797  
0.950187969924812  

Train_result {'loss': [0.05693721278477484], 'acc': [0.9806785806785807]}
9

Epoch 1/1
 - 459s - loss: 0.0477 - acc: 0.9835

Test accuracy: 96.57116016909347

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1060

choose_one :  1069

F1score :  0.9657759024847634

AUC : 0.9922446962476614

Confusion Matrix
[[1026   39]
 [  34 1030]]
True label 0
0.9633802816901409  
0.036619718309859155  
True label 1
0.03195488721804511  
0.9680451127819549  

Train_result {'loss': [0.04769668379916409], 'acc': [0.9834757834757835]}
10

Epoch 1/1
 - 459s - loss: 0.0384 - acc: 0.9866

Test accuracy: 96.52418976045092

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1049

choose_one :  1080

F1score :  0.9654850746268657

AUC : 0.9917540329697483

Confusion Matrix
[[1020   45]
 [  29 1035]]
True label 0
0.9577464788732394  
0.04225352112676056  
True label 1
0.02725563909774436  
0.9727443609022557  

Train_result {'loss': [0.03843238933589715], 'acc': [0.9865837865837865]}
11

Epoch 1/1
 - 464s - loss: 0.0334 - acc: 0.9888

Test accuracy: 97.13480507280413

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1064

choose_one :  1065

F1score :  0.9713480507280413

AUC : 0.9916975537435138

Confusion Matrix
[[1034   31]
 [  30 1034]]
True label 0
0.9708920187793427  
0.02910798122065728  
True label 1
0.02819548872180451  
0.9718045112781954  

Train_result {'loss': [0.03338531684653937], 'acc': [0.9887593887593887]}
12

Epoch 1/1
 - 469s - loss: 0.0312 - acc: 0.9901

Test accuracy: 96.19539689995304

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1092

choose_one :  1037

F1score :  0.9614469300333175

AUC : 0.991905379646299

Confusion Matrix
[[1038   27]
 [  54 1010]]
True label 0
0.9746478873239437  
0.02535211267605634  
True label 1
0.05075187969924812  
0.9492481203007519  

Train_result {'loss': [0.031153834676079233], 'acc': [0.99005439005439]}
13

Epoch 1/1
 - 473s - loss: 0.0298 - acc: 0.9905

Test accuracy: 96.85298262094881

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1054

choose_one :  1075

F1score :  0.9686769518466573

AUC : 0.9935763705037242

Confusion Matrix
[[1026   39]
 [  28 1036]]
True label 0
0.9633802816901409  
0.036619718309859155  
True label 1
0.02631578947368421  
0.9736842105263158  

Train_result {'loss': [0.02983804492092153], 'acc': [0.9904687904687904]}
14

Epoch 1/1
 - 472s - loss: 0.0288 - acc: 0.9906

Test accuracy: 96.89995302959136

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1065

choose_one :  1064

F1score :  0.9689849624060151

AUC : 0.9919265593561368

Confusion Matrix
[[1032   33]
 [  33 1031]]
True label 0
0.9690140845070423  
0.030985915492957747  
True label 1
0.03101503759398496  
0.9689849624060151  

Train_result {'loss': [0.028768358035464726], 'acc': [0.9905723905723905]}
15

Epoch 1/1
 - 472s - loss: 0.0285 - acc: 0.9908

Test accuracy: 97.46359793330201

data size :  21434

zero :  10718

one :  10716

train_zero :  9653

train_one :  9652

test_zero :  1065

test_one :  1064

choose_zero :  1057

choose_one :  1072

F1score :  0.9747191011235956

AUC : 0.9929595114546931

Confusion Matrix
[[1034   31]
 [  23 1041]]
True label 0
0.9708920187793427  
0.02910798122065728  
True label 1
0.021616541353383457  
0.9783834586466166  

Train_result {'loss': [0.028485070196793555], 'acc': [0.9907795907795908]}
Saved model to disk




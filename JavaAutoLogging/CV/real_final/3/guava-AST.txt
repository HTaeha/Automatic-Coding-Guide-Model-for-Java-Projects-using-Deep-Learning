Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_logging.py:358: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-08-02 01:53:12.786638: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-08-02 01:53:12.798898: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-08-02 01:53:12.801031: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9b15cd0 executing computations on platform Host. Devices:
2019-08-02 01:53:12.801072: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
44755

one : 
13975
guava-AST
all data

Sentence length Average : 20

Under 10 : 24035
Over 10, Under 200 : 34563
Over 200, Under 400 : 122
Over 400 : 10

guava-AST
updated_train_data

Sentence length Average : 30

Under 10 : 0
Over 10, Under 200 : 31125
Over 200, Under 400 : 119
Over 400 : 0


Test_zero:  2442
Train_zero:  21946
zero:  24388
Test_one:  1008
Train_one:  9298
one:  10306

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 421s - loss: 0.3434 - acc: 0.8425

Test accuracy: 87.40704015865145

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  985

choose_one :  1032

F1score :  0.8754901960784314

AUC : 0.9545725376374534

Confusion Matrix
[[870 139]
 [115 893]]
True label 0
0.8622398414271556  
0.1377601585728444  
True label 1
0.11408730158730158  
0.8859126984126984  

Train_result {'acc': [0.8425014787363341], 'loss': [0.3434267393259513]}
2

Epoch 1/1
 - 418s - loss: 0.2344 - acc: 0.9000

Test accuracy: 91.27416955875061

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  1025

choose_one :  992

F1score :  0.912

AUC : 0.9707985275378733

Confusion Matrix
[[929  80]
 [ 96 912]]
True label 0
0.9207135777998018  
0.07928642220019821  
True label 1
0.09523809523809523  
0.9047619047619048  

Train_result {'acc': [0.9000376404828523], 'loss': [0.2343757656169667]}
3

Epoch 1/1
 - 432s - loss: 0.1959 - acc: 0.9193

Test accuracy: 89.93554784333168

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  882

choose_one :  1135

F1score :  0.9052729818012133

AUC : 0.973707859423915

Confusion Matrix
[[844 165]
 [ 38 970]]
True label 0
0.8364717542120912  
0.1635282457879088  
True label 1
0.037698412698412696  
0.9623015873015873  

Train_result {'acc': [0.919341829333721], 'loss': [0.19593641095894246]}
4

Epoch 1/1
 - 456s - loss: 0.1714 - acc: 0.9310

Test accuracy: 91.32374814080318

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  1100

choose_one :  917

F1score :  0.9090909090909092

AUC : 0.9804768000692183

Confusion Matrix
[[967  42]
 [133 875]]
True label 0
0.958374628344896  
0.04162537165510406  
True label 1
0.13194444444444445  
0.8680555555555556  

Train_result {'acc': [0.93101037802437], 'loss': [0.17137031269892702]}
5

Epoch 1/1
 - 455s - loss: 0.1530 - acc: 0.9409

Test accuracy: 93.25731284085275

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  985

choose_one :  1032

F1score :  0.9333333333333332

AUC : 0.9835754007582551

Confusion Matrix
[[929  80]
 [ 56 952]]
True label 0
0.9207135777998018  
0.07928642220019821  
True label 1
0.05555555555555555  
0.9444444444444444  

Train_result {'acc': [0.9408506748400279], 'loss': [0.15296835818303123]}
6

Epoch 1/1
 - 455s - loss: 0.1355 - acc: 0.9489

Test accuracy: 94.0505701536936

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  955

choose_one :  1062

F1score :  0.9420289855072465

AUC : 0.9866803923419383

Confusion Matrix
[[922  87]
 [ 33 975]]
True label 0
0.9137760158572844  
0.08622398414271557  
True label 1
0.03273809523809524  
0.9672619047619048  

Train_result {'acc': [0.9488627197935151], 'loss': [0.13547401155579564]}
7

Epoch 1/1
 - 455s - loss: 0.1140 - acc: 0.9578

Test accuracy: 94.74467030242934

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  999

choose_one :  1018

F1score :  0.9476801579466929

AUC : 0.9865663394528607

Confusion Matrix
[[951  58]
 [ 48 960]]
True label 0
0.9425173439048563  
0.057482656095143705  
True label 1
0.047619047619047616  
0.9523809523809523  

Train_result {'acc': [0.9578426627982796], 'loss': [0.11398708122920277]}
8

Epoch 1/1
 - 455s - loss: 0.1031 - acc: 0.9612

Test accuracy: 94.99256321269212

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  984

choose_one :  1033

F1score :  0.9505144536991672

AUC : 0.9876459090408546

Confusion Matrix
[[946  63]
 [ 38 970]]
True label 0
0.9375619425173439  
0.062438057482656094  
True label 1
0.037698412698412696  
0.9623015873015873  

Train_result {'acc': [0.9612303059633274], 'loss': [0.10314409048028839]}
9

Epoch 1/1
 - 455s - loss: 0.0939 - acc: 0.9664

Test accuracy: 94.89340604858701

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  966

choose_one :  1051

F1score :  0.9499757163671685

AUC : 0.9893045920052859

Confusion Matrix
[[936  73]
 [ 30 978]]
True label 0
0.9276511397423192  
0.07234886025768088  
True label 1
0.02976190476190476  
0.9702380952380952  

Train_result {'acc': [0.9664462010001613], 'loss': [0.09389082067606774]}
10

Epoch 1/1
 - 457s - loss: 0.0821 - acc: 0.9699

Test accuracy: 94.19930589985125

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  966

choose_one :  1051

F1score :  0.9431762991743564

AUC : 0.985620487045165

Confusion Matrix
[[929  80]
 [ 37 971]]
True label 0
0.9207135777998018  
0.07928642220019821  
True label 1
0.03670634920634921  
0.9632936507936508  

Train_result {'acc': [0.9698876162821961], 'loss': [0.08214348751702923]}
11

Epoch 1/1
 - 455s - loss: 0.0756 - acc: 0.9739

Test accuracy: 95.98413485374319

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  990

choose_one :  1027

F1score :  0.9601965601965602

AUC : 0.9911746661003351

Confusion Matrix
[[959  50]
 [ 31 977]]
True label 0
0.9504459861248761  
0.049554013875123884  
True label 1
0.030753968253968252  
0.9692460317460317  

Train_result {'acc': [0.9739205248158305], 'loss': [0.0755656233707082]}
12

Epoch 1/1
 - 453s - loss: 0.0708 - acc: 0.9751

Test accuracy: 95.5379276152702

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  1007

choose_one :  1010

F1score :  0.9554013875123885

AUC : 0.9914214529551497

Confusion Matrix
[[963  46]
 [ 44 964]]
True label 0
0.9544103072348861  
0.04558969276511397  
True label 1
0.04365079365079365  
0.9563492063492064  

Train_result {'acc': [0.97510351131903], 'loss': [0.07083358272574387]}
13

Epoch 1/1
 - 459s - loss: 0.0658 - acc: 0.9775

Test accuracy: 95.98413485374319

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  960

choose_one :  1057

F1score :  0.960774818401937

AUC : 0.9929670662450643

Confusion Matrix
[[944  65]
 [ 16 992]]
True label 0
0.9355797819623389  
0.06442021803766106  
True label 1
0.015873015873015872  
0.9841269841269841  

Train_result {'acc': [0.9775232564392107], 'loss': [0.06580299610628514]}
14

Epoch 1/1
 - 456s - loss: 0.0561 - acc: 0.9806

Test accuracy: 96.33118492811106

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  1019

choose_one :  998

F1score :  0.9631106679960119

AUC : 0.9926568620510642

Confusion Matrix
[[977  32]
 [ 42 966]]
True label 0
0.9682854311199207  
0.031714568880079286  
True label 1
0.041666666666666664  
0.9583333333333334  

Train_result {'acc': [0.9806420390385546], 'loss': [0.056101300888195274]}
15

Epoch 1/1
 - 456s - loss: 0.0585 - acc: 0.9796

Test accuracy: 95.88497768963808

data size :  20614

zero :  10308

one :  10306

train_zero :  9299

train_one :  9298

test_zero :  1009

test_one :  1008

choose_zero :  986

choose_one :  1031

F1score :  0.9592937714565963

AUC : 0.9909288624600815

Confusion Matrix
[[956  53]
 [ 30 978]]
True label 0
0.9474727452923687  
0.05252725470763132  
True label 1
0.02976190476190476  
0.9702380952380952  

Train_result {'acc': [0.9795665967629188], 'loss': [0.05850409203864391]}
Saved model to disk




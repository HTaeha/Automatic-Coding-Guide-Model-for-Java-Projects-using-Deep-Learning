Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:54:33.104526: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:54:33.115424: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:54:33.117768: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x745f7a0 executing computations on platform Host. Devices:
2019-09-07 15:54:33.117809: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 51

Under 10 : 9474
Over 10, Under 30 : 18298
Over 30, Under 100 : 13980
Over 100, Under 150 : 2960
Over 150, Under 200 : 1491
Over 200, Under 400 : 1892
Over 400 : 375

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 14

Under 10 : 916
Over 10, Under 30 : 2079
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0


Sentence length Average : 14

Under 10 : 108
Over 10, Under 30 : 225
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:06 - loss: 0.6926 - acc: 0.5469
 192/2995 [>.............................] - ETA: 22s - loss: 0.7098 - acc: 0.5573 
 320/2995 [==>...........................] - ETA: 13s - loss: 0.6881 - acc: 0.5781
 448/2995 [===>..........................] - ETA: 9s - loss: 0.6738 - acc: 0.6004 
 576/2995 [====>.........................] - ETA: 7s - loss: 0.6701 - acc: 0.6111
 704/2995 [======>.......................] - ETA: 5s - loss: 0.6552 - acc: 0.6278
 832/2995 [=======>......................] - ETA: 4s - loss: 0.6372 - acc: 0.6454
 960/2995 [========>.....................] - ETA: 4s - loss: 0.6179 - acc: 0.6615
1088/2995 [=========>....................] - ETA: 3s - loss: 0.6043 - acc: 0.6719
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5964 - acc: 0.6817
1344/2995 [============>.................] - ETA: 2s - loss: 0.5931 - acc: 0.6905
1472/2995 [=============>................] - ETA: 2s - loss: 0.5943 - acc: 0.6909
1600/2995 [===============>..............] - ETA: 1s - loss: 0.5888 - acc: 0.6963
1728/2995 [================>.............] - ETA: 1s - loss: 0.5797 - acc: 0.7043
1856/2995 [=================>............] - ETA: 1s - loss: 0.5721 - acc: 0.7112
1984/2995 [==================>...........] - ETA: 1s - loss: 0.5694 - acc: 0.7122
2112/2995 [====================>.........] - ETA: 1s - loss: 0.5632 - acc: 0.7164
2240/2995 [=====================>........] - ETA: 0s - loss: 0.5565 - acc: 0.7205
2368/2995 [======================>.......] - ETA: 0s - loss: 0.5577 - acc: 0.7183
2496/2995 [========================>.....] - ETA: 0s - loss: 0.5537 - acc: 0.7208
2624/2995 [=========================>....] - ETA: 0s - loss: 0.5510 - acc: 0.7245
2752/2995 [==========================>...] - ETA: 0s - loss: 0.5460 - acc: 0.7271
2880/2995 [===========================>..] - ETA: 0s - loss: 0.5447 - acc: 0.7295
2995/2995 [==============================] - 3s 990us/step - loss: 0.5430 - acc: 0.7299

Test accuracy: 80.48048048048048

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  162

choose_one :  171

F1score :  0.8071216617210683

AUC :  0.8911875045090543

Confusion Matrix
[[132  35]
 [ 30 136]]
True label 0
0.7904191616766467  
0.20958083832335328  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.542953447427893], 'acc': [0.7298831387632876]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4707 - acc: 0.7812
 192/2995 [>.............................] - ETA: 1s - loss: 0.4727 - acc: 0.7917
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4652 - acc: 0.7875
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4423 - acc: 0.8013
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4412 - acc: 0.8021
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4411 - acc: 0.8011
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4426 - acc: 0.8005
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4428 - acc: 0.8031
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4403 - acc: 0.8070
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4330 - acc: 0.8141
1344/2995 [============>.................] - ETA: 0s - loss: 0.4340 - acc: 0.8132
1472/2995 [=============>................] - ETA: 0s - loss: 0.4364 - acc: 0.8132
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4441 - acc: 0.8094
1728/2995 [================>.............] - ETA: 0s - loss: 0.4423 - acc: 0.8084
1856/2995 [=================>............] - ETA: 0s - loss: 0.4351 - acc: 0.8152
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4429 - acc: 0.8100
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4421 - acc: 0.8106
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4401 - acc: 0.8107
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4452 - acc: 0.8074
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4458 - acc: 0.8065
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4428 - acc: 0.8095
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4406 - acc: 0.8089
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4380 - acc: 0.8101
2995/2995 [==============================] - 2s 540us/step - loss: 0.4366 - acc: 0.8097

Test accuracy: 83.48348348348348

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.8286604361370716

AUC :  0.8994480917682707

Confusion Matrix
[[145  22]
 [ 33 133]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.4366316019195149], 'acc': [0.8096828048336685]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3679 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3540 - acc: 0.8542
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3580 - acc: 0.8656
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3871 - acc: 0.8393
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3770 - acc: 0.8472
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3835 - acc: 0.8423
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3878 - acc: 0.8341
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3871 - acc: 0.8333
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3905 - acc: 0.8364
1216/2995 [===========>..................] - ETA: 0s - loss: 0.4011 - acc: 0.8306
1344/2995 [============>.................] - ETA: 0s - loss: 0.4005 - acc: 0.8296
1472/2995 [=============>................] - ETA: 0s - loss: 0.4046 - acc: 0.8268
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4084 - acc: 0.8256
1728/2995 [================>.............] - ETA: 0s - loss: 0.4161 - acc: 0.8194
1856/2995 [=================>............] - ETA: 0s - loss: 0.4142 - acc: 0.8195
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4168 - acc: 0.8175
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4155 - acc: 0.8177
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4142 - acc: 0.8183
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4153 - acc: 0.8163
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4093 - acc: 0.8201
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4106 - acc: 0.8190
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4127 - acc: 0.8169
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4070 - acc: 0.8205
2995/2995 [==============================] - 2s 523us/step - loss: 0.4067 - acc: 0.8214

Test accuracy: 83.18318318318319

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  189

choose_one :  144

F1score :  0.8193548387096773

AUC :  0.9069150854916672

Confusion Matrix
[[150  17]
 [ 39 127]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.23493975903614459  
0.7650602409638554  

Train_result {'loss': [0.4067092735102658], 'acc': [0.8213689484659937]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4491 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3710 - acc: 0.8438
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3894 - acc: 0.8406
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4093 - acc: 0.8237
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3863 - acc: 0.8316
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3875 - acc: 0.8281
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3818 - acc: 0.8353
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3945 - acc: 0.8292
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3886 - acc: 0.8336
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3803 - acc: 0.8363
1344/2995 [============>.................] - ETA: 0s - loss: 0.3787 - acc: 0.8378
1472/2995 [=============>................] - ETA: 0s - loss: 0.3767 - acc: 0.8376
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3732 - acc: 0.8406
1728/2995 [================>.............] - ETA: 0s - loss: 0.3783 - acc: 0.8356
1856/2995 [=================>............] - ETA: 0s - loss: 0.3769 - acc: 0.8341
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3736 - acc: 0.8342
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3720 - acc: 0.8348
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3725 - acc: 0.8371
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3727 - acc: 0.8374
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3712 - acc: 0.8377
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3714 - acc: 0.8388
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3709 - acc: 0.8398
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3720 - acc: 0.8378
2995/2995 [==============================] - 2s 535us/step - loss: 0.3782 - acc: 0.8311

Test accuracy: 84.08408408408408

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  174

choose_one :  159

F1score :  0.8369230769230769

AUC :  0.9113519948055696

Confusion Matrix
[[144  23]
 [ 30 136]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.37817059759305593], 'acc': [0.8310517533195636]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4030 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3675 - acc: 0.8490
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3980 - acc: 0.8281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3960 - acc: 0.8259
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3882 - acc: 0.8351
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3981 - acc: 0.8253
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3963 - acc: 0.8185
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3938 - acc: 0.8219
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3856 - acc: 0.8263
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3825 - acc: 0.8257
1344/2995 [============>.................] - ETA: 0s - loss: 0.3832 - acc: 0.8274
1472/2995 [=============>................] - ETA: 0s - loss: 0.3740 - acc: 0.8329
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3689 - acc: 0.8369
1728/2995 [================>.............] - ETA: 0s - loss: 0.3686 - acc: 0.8385
1856/2995 [=================>............] - ETA: 0s - loss: 0.3690 - acc: 0.8367
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3656 - acc: 0.8367
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3681 - acc: 0.8348
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3663 - acc: 0.8353
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3647 - acc: 0.8370
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3672 - acc: 0.8373
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3648 - acc: 0.8380
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3617 - acc: 0.8390
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3617 - acc: 0.8396
2995/2995 [==============================] - 2s 531us/step - loss: 0.3607 - acc: 0.8404

Test accuracy: 84.38438438438438

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  169

choose_one :  164

F1score :  0.8424242424242424

AUC :  0.9162578457542746

Confusion Matrix
[[142  25]
 [ 27 139]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.3606831790011793], 'acc': [0.840400667899041]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3030 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2834 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3321 - acc: 0.8562
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3356 - acc: 0.8616
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3386 - acc: 0.8524
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3530 - acc: 0.8423
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3592 - acc: 0.8389
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3603 - acc: 0.8365
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3602 - acc: 0.8364
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3565 - acc: 0.8363
1344/2995 [============>.................] - ETA: 0s - loss: 0.3480 - acc: 0.8438
1472/2995 [=============>................] - ETA: 0s - loss: 0.3490 - acc: 0.8424
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3474 - acc: 0.8438
1728/2995 [================>.............] - ETA: 0s - loss: 0.3496 - acc: 0.8426
1856/2995 [=================>............] - ETA: 0s - loss: 0.3451 - acc: 0.8448
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3444 - acc: 0.8458
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3424 - acc: 0.8475
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3411 - acc: 0.8469
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3357 - acc: 0.8497
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3379 - acc: 0.8494
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3403 - acc: 0.8460
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3441 - acc: 0.8445
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3446 - acc: 0.8444
2995/2995 [==============================] - 2s 525us/step - loss: 0.3449 - acc: 0.8451

Test accuracy: 84.38438438438438

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  131

choose_one :  202

F1score :  0.858695652173913

AUC :  0.9295685736959816

Confusion Matrix
[[123  44]
 [  8 158]]
True label 0
0.7365269461077845  
0.2634730538922156  
True label 1
0.04819277108433735  
0.9518072289156626  

Train_result {'loss': [0.3448968743342589], 'acc': [0.8450751253081881]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2906 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3099 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2869 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3183 - acc: 0.8705
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3063 - acc: 0.8750
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3041 - acc: 0.8764
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3152 - acc: 0.8714
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3205 - acc: 0.8708
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3225 - acc: 0.8713
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3210 - acc: 0.8742
1344/2995 [============>.................] - ETA: 0s - loss: 0.3209 - acc: 0.8698
1472/2995 [=============>................] - ETA: 0s - loss: 0.3245 - acc: 0.8682
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3217 - acc: 0.8694
1728/2995 [================>.............] - ETA: 0s - loss: 0.3191 - acc: 0.8698
1856/2995 [=================>............] - ETA: 0s - loss: 0.3199 - acc: 0.8680
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3189 - acc: 0.8669
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3218 - acc: 0.8665
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3291 - acc: 0.8603
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3286 - acc: 0.8619
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3278 - acc: 0.8622
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3244 - acc: 0.8639
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3281 - acc: 0.8626
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3305 - acc: 0.8615
2995/2995 [==============================] - 2s 514us/step - loss: 0.3278 - acc: 0.8631

Test accuracy: 83.18318318318319

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.8205128205128205

AUC :  0.9182779020272708

Confusion Matrix
[[149  18]
 [ 38 128]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.2289156626506024  
0.7710843373493976  

Train_result {'loss': [0.32775157988568976], 'acc': [0.8631051753717591]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2586 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.3093 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2932 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2847 - acc: 0.8839
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3012 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3034 - acc: 0.8707
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2920 - acc: 0.8798
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3025 - acc: 0.8719
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2937 - acc: 0.8805
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2893 - acc: 0.8799
1344/2995 [============>.................] - ETA: 0s - loss: 0.2920 - acc: 0.8802
1472/2995 [=============>................] - ETA: 0s - loss: 0.2953 - acc: 0.8770
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2997 - acc: 0.8762
1728/2995 [================>.............] - ETA: 0s - loss: 0.3011 - acc: 0.8750
1856/2995 [=================>............] - ETA: 0s - loss: 0.3021 - acc: 0.8750
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3029 - acc: 0.8760
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3079 - acc: 0.8726
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3108 - acc: 0.8705
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3120 - acc: 0.8687
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3098 - acc: 0.8694
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3128 - acc: 0.8670
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3159 - acc: 0.8666
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3164 - acc: 0.8660
2995/2995 [==============================] - 2s 535us/step - loss: 0.3174 - acc: 0.8661

Test accuracy: 86.48648648648648

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  154

choose_one :  179

F1score :  0.8695652173913043

AUC :  0.9313721953682995

Confusion Matrix
[[138  29]
 [ 16 150]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.3174243473548921], 'acc': [0.8661101837787086]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2725 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3050 - acc: 0.8906
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3054 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3149 - acc: 0.8750
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3009 - acc: 0.8750
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3053 - acc: 0.8651
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3019 - acc: 0.8678
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3174 - acc: 0.8635
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3092 - acc: 0.8704
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3089 - acc: 0.8676
1344/2995 [============>.................] - ETA: 0s - loss: 0.3088 - acc: 0.8690
1472/2995 [=============>................] - ETA: 0s - loss: 0.3075 - acc: 0.8675
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3077 - acc: 0.8681
1728/2995 [================>.............] - ETA: 0s - loss: 0.3048 - acc: 0.8686
1856/2995 [=================>............] - ETA: 0s - loss: 0.3023 - acc: 0.8723
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2965 - acc: 0.8750
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2982 - acc: 0.8722
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3049 - acc: 0.8696
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3062 - acc: 0.8704
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3059 - acc: 0.8710
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3079 - acc: 0.8700
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3069 - acc: 0.8703
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3067 - acc: 0.8715
2995/2995 [==============================] - 2s 533us/step - loss: 0.3072 - acc: 0.8698

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  147

choose_one :  186

F1score :  0.8693181818181819

AUC :  0.9346908592453648

Confusion Matrix
[[134  33]
 [ 13 153]]
True label 0
0.8023952095808383  
0.19760479041916168  
True label 1
0.0783132530120482  
0.9216867469879518  

Train_result {'loss': [0.3071742067352957], 'acc': [0.8697829717586752]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2003 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.3000 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2993 - acc: 0.8625
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3204 - acc: 0.8571
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3165 - acc: 0.8576
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2961 - acc: 0.8750
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2936 - acc: 0.8822
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2980 - acc: 0.8812
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3104 - acc: 0.8722
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3143 - acc: 0.8676
1344/2995 [============>.................] - ETA: 0s - loss: 0.3064 - acc: 0.8698
1472/2995 [=============>................] - ETA: 0s - loss: 0.3021 - acc: 0.8716
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3027 - acc: 0.8712
1728/2995 [================>.............] - ETA: 0s - loss: 0.2979 - acc: 0.8744
1856/2995 [=================>............] - ETA: 0s - loss: 0.2970 - acc: 0.8755
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3032 - acc: 0.8735
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3045 - acc: 0.8722
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3041 - acc: 0.8714
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3037 - acc: 0.8716
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3014 - acc: 0.8738
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3025 - acc: 0.8727
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3030 - acc: 0.8728
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3037 - acc: 0.8715
2995/2995 [==============================] - 2s 536us/step - loss: 0.3037 - acc: 0.8708

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8343558282208589

AUC :  0.9189272058293052

Confusion Matrix
[[143  24]
 [ 30 136]]
True label 0
0.8562874251497006  
0.1437125748502994  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.3037249182520406], 'acc': [0.8707846412475598]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3937 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3609 - acc: 0.8229
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3494 - acc: 0.8469
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3266 - acc: 0.8683
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3142 - acc: 0.8715
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2962 - acc: 0.8793
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2922 - acc: 0.8798
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2769 - acc: 0.8854
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2835 - acc: 0.8796
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2904 - acc: 0.8709
1344/2995 [============>.................] - ETA: 0s - loss: 0.2864 - acc: 0.8705
1472/2995 [=============>................] - ETA: 0s - loss: 0.2796 - acc: 0.8743
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2792 - acc: 0.8750
1728/2995 [================>.............] - ETA: 0s - loss: 0.2795 - acc: 0.8779
1856/2995 [=================>............] - ETA: 0s - loss: 0.2858 - acc: 0.8745
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2838 - acc: 0.8765
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2828 - acc: 0.8774
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2800 - acc: 0.8795
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2818 - acc: 0.8775
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2797 - acc: 0.8802
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2806 - acc: 0.8800
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2849 - acc: 0.8786
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2868 - acc: 0.8774
2995/2995 [==============================] - 2s 541us/step - loss: 0.2843 - acc: 0.8778

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  169

choose_one :  164

F1score :  0.8666666666666666

AUC :  0.9331758170406176

Confusion Matrix
[[146  21]
 [ 23 143]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.13855421686746988  
0.8614457831325302  

Train_result {'loss': [0.2842575726107086], 'acc': [0.8777963273712311]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3187 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2731 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2633 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2499 - acc: 0.8929
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2354 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2486 - acc: 0.8977
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2573 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2667 - acc: 0.8896
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2612 - acc: 0.8925
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2671 - acc: 0.8882
1344/2995 [============>.................] - ETA: 0s - loss: 0.2675 - acc: 0.8914
1472/2995 [=============>................] - ETA: 0s - loss: 0.2677 - acc: 0.8886
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2743 - acc: 0.8850
1728/2995 [================>.............] - ETA: 0s - loss: 0.2694 - acc: 0.8877
1856/2995 [=================>............] - ETA: 0s - loss: 0.2655 - acc: 0.8895
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2654 - acc: 0.8901
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2646 - acc: 0.8906
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2640 - acc: 0.8915
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2666 - acc: 0.8902
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2678 - acc: 0.8874
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2669 - acc: 0.8887
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2654 - acc: 0.8895
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2727 - acc: 0.8861
2995/2995 [==============================] - 2s 530us/step - loss: 0.2712 - acc: 0.8881

Test accuracy: 84.68468468468468

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  134

choose_one :  199

F1score :  0.8602739726027397

AUC :  0.9362059014501118

Confusion Matrix
[[125  42]
 [  9 157]]
True label 0
0.7485029940119761  
0.25149700598802394  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.2711916075823502], 'acc': [0.8881469115988042]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2584 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2545 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2529 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2398 - acc: 0.8973
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2312 - acc: 0.9062
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2300 - acc: 0.9062
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2388 - acc: 0.9038
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2430 - acc: 0.8979
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2501 - acc: 0.8934
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2488 - acc: 0.8947
1344/2995 [============>.................] - ETA: 0s - loss: 0.2463 - acc: 0.8958
1472/2995 [=============>................] - ETA: 0s - loss: 0.2496 - acc: 0.8947
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2515 - acc: 0.8956
1728/2995 [================>.............] - ETA: 0s - loss: 0.2488 - acc: 0.8981
1856/2995 [=================>............] - ETA: 0s - loss: 0.2481 - acc: 0.8976
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2493 - acc: 0.8977
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2486 - acc: 0.8968
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2503 - acc: 0.8955
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2531 - acc: 0.8944
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2581 - acc: 0.8930
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2627 - acc: 0.8918
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2632 - acc: 0.8906
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2637 - acc: 0.8913
2995/2995 [==============================] - 2s 537us/step - loss: 0.2676 - acc: 0.8898

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  166

choose_one :  167

F1score :  0.8828828828828829

AUC :  0.9424103600028858

Confusion Matrix
[[147  20]
 [ 19 147]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.2675773886686971], 'acc': [0.8898163607204099]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2224 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.3045 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3009 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2928 - acc: 0.8862
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2671 - acc: 0.8993
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2483 - acc: 0.9034
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2541 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2576 - acc: 0.8938
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2549 - acc: 0.8961
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2515 - acc: 0.8972
1344/2995 [============>.................] - ETA: 0s - loss: 0.2500 - acc: 0.8973
1472/2995 [=============>................] - ETA: 0s - loss: 0.2479 - acc: 0.8974
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2540 - acc: 0.8919
1728/2995 [================>.............] - ETA: 0s - loss: 0.2593 - acc: 0.8900
1856/2995 [=================>............] - ETA: 0s - loss: 0.2574 - acc: 0.8917
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2534 - acc: 0.8942
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2519 - acc: 0.8935
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2503 - acc: 0.8946
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2518 - acc: 0.8940
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2578 - acc: 0.8922
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2537 - acc: 0.8941
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2560 - acc: 0.8924
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2547 - acc: 0.8931
2995/2995 [==============================] - 2s 522us/step - loss: 0.2527 - acc: 0.8932

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  160

choose_one :  173

F1score :  0.8908554572271385

AUC :  0.9434564605728303

Confusion Matrix
[[145  22]
 [ 15 151]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.2526763094586005], 'acc': [0.893155258884016]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1482 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.2199 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1966 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2156 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2217 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2217 - acc: 0.9148
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2120 - acc: 0.9207
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2396 - acc: 0.9115
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2456 - acc: 0.9062
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2387 - acc: 0.9104
1344/2995 [============>.................] - ETA: 0s - loss: 0.2503 - acc: 0.9025
1472/2995 [=============>................] - ETA: 0s - loss: 0.2468 - acc: 0.9035
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2479 - acc: 0.9031
1728/2995 [================>.............] - ETA: 0s - loss: 0.2467 - acc: 0.9022
1856/2995 [=================>............] - ETA: 0s - loss: 0.2494 - acc: 0.9036
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2507 - acc: 0.9017
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2478 - acc: 0.9034
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2481 - acc: 0.9027
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2504 - acc: 0.9016
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2467 - acc: 0.9034
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2461 - acc: 0.9028
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2468 - acc: 0.9030
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2447 - acc: 0.9035
2995/2995 [==============================] - 2s 536us/step - loss: 0.2423 - acc: 0.9048

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8753799392097266

AUC :  0.9386588269244643

Confusion Matrix
[[148  19]
 [ 22 144]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'loss': [0.24228762050900912], 'acc': [0.9048414023770315]}
Saved model to disk


[[80.48048048048048, 1], [83.48348348348348, 2], [83.18318318318319, 3], [84.08408408408408, 4], [84.38438438438438, 5], [84.38438438438438, 6], [83.18318318318319, 7], [86.48648648648648, 8], [86.18618618618619, 9], [83.78378378378379, 10], [86.78678678678679, 11], [84.68468468468468, 12], [88.28828828828829, 13], [88.88888888888889, 14], [87.68768768768768, 15]]
max accuracy :  [88.88888888888889, 14]

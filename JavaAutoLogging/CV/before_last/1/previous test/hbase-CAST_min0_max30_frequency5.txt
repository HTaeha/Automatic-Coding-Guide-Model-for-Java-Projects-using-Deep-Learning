Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:53:26.942920: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:53:26.955965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:53:26.958146: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x558e100 executing computations on platform Host. Devices:
2019-09-07 15:53:26.958184: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 85

Under 10 : 7243
Over 10, Under 30 : 16559
Over 30, Under 100 : 12738
Over 100, Under 150 : 3895
Over 150, Under 200 : 2319
Over 200, Under 400 : 3915
Over 400 : 1801

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 24

Under 10 : 817
Over 10, Under 30 : 1434
Over 30, Under 100 : 728
Over 100, Under 150 : 2
Over 150, Under 200 : 1
Over 200, Under 400 : 8
Over 400 : 5


Sentence length Average : 22

Under 10 : 104
Over 10, Under 30 : 144
Over 30, Under 100 : 84
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 1
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:15 - loss: 0.7352 - acc: 0.5156
 192/2995 [>.............................] - ETA: 25s - loss: 0.7409 - acc: 0.5729 
 320/2995 [==>...........................] - ETA: 15s - loss: 0.6488 - acc: 0.6281
 448/2995 [===>..........................] - ETA: 10s - loss: 0.6135 - acc: 0.6607
 576/2995 [====>.........................] - ETA: 8s - loss: 0.5941 - acc: 0.6753 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.5688 - acc: 0.6960
 832/2995 [=======>......................] - ETA: 5s - loss: 0.5451 - acc: 0.7248
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5296 - acc: 0.7354
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5143 - acc: 0.7463
1216/2995 [===========>..................] - ETA: 3s - loss: 0.4991 - acc: 0.7582
1344/2995 [============>.................] - ETA: 2s - loss: 0.4948 - acc: 0.7634
1472/2995 [=============>................] - ETA: 2s - loss: 0.4982 - acc: 0.7615
1600/2995 [===============>..............] - ETA: 2s - loss: 0.4871 - acc: 0.7712
1728/2995 [================>.............] - ETA: 1s - loss: 0.4788 - acc: 0.7778
1856/2995 [=================>............] - ETA: 1s - loss: 0.4711 - acc: 0.7829
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4641 - acc: 0.7888
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4564 - acc: 0.7940
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4518 - acc: 0.7951
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4491 - acc: 0.7960
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4423 - acc: 0.8009
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4406 - acc: 0.8014
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4376 - acc: 0.8034
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4347 - acc: 0.8038
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4291 - acc: 0.8060

Test accuracy: 87.38738738738738

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8711656441717791

AUC :  0.9311377245508982

Confusion Matrix
[[149  18]
 [ 24 142]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'loss': [0.4291005811329079], 'acc': [0.8060100168138992]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4257 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3765 - acc: 0.8333
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3753 - acc: 0.8344
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3484 - acc: 0.8482
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3286 - acc: 0.8576
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3206 - acc: 0.8608
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3210 - acc: 0.8654
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3187 - acc: 0.8698
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3176 - acc: 0.8713
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3165 - acc: 0.8692
1344/2995 [============>.................] - ETA: 0s - loss: 0.3087 - acc: 0.8735
1472/2995 [=============>................] - ETA: 0s - loss: 0.3105 - acc: 0.8743
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3162 - acc: 0.8719
1728/2995 [================>.............] - ETA: 0s - loss: 0.3138 - acc: 0.8727
1856/2995 [=================>............] - ETA: 0s - loss: 0.3091 - acc: 0.8734
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3115 - acc: 0.8730
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3124 - acc: 0.8722
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3126 - acc: 0.8714
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3175 - acc: 0.8704
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3166 - acc: 0.8706
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3177 - acc: 0.8689
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3155 - acc: 0.8706
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3125 - acc: 0.8708
2995/2995 [==============================] - 2s 544us/step - loss: 0.3090 - acc: 0.8728

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  175

choose_one :  158

F1score :  0.8888888888888888

AUC :  0.9406608469807374

Confusion Matrix
[[153  14]
 [ 22 144]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'loss': [0.30900915388471895], 'acc': [0.8727879800064138]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2890 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2962 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2772 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2769 - acc: 0.8839
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2618 - acc: 0.8906
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2724 - acc: 0.8878
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2697 - acc: 0.8870
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2699 - acc: 0.8885
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2689 - acc: 0.8906
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2856 - acc: 0.8865
1344/2995 [============>.................] - ETA: 0s - loss: 0.2861 - acc: 0.8884
1472/2995 [=============>................] - ETA: 0s - loss: 0.2875 - acc: 0.8872
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2876 - acc: 0.8856
1728/2995 [================>.............] - ETA: 0s - loss: 0.2919 - acc: 0.8831
1856/2995 [=================>............] - ETA: 0s - loss: 0.2931 - acc: 0.8820
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2908 - acc: 0.8826
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2890 - acc: 0.8845
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2915 - acc: 0.8835
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2917 - acc: 0.8822
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2842 - acc: 0.8866
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2860 - acc: 0.8876
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2854 - acc: 0.8874
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2840 - acc: 0.8892
2995/2995 [==============================] - 2s 534us/step - loss: 0.2849 - acc: 0.8881

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  169

choose_one :  164

F1score :  0.8909090909090909

AUC :  0.9442680903253734

Confusion Matrix
[[150  17]
 [ 19 147]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.2848798746557188], 'acc': [0.8881469117182125]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3724 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.2315 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2388 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2429 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2365 - acc: 0.9045
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2538 - acc: 0.9020
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2566 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2708 - acc: 0.8927
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2659 - acc: 0.8952
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2641 - acc: 0.8964
1344/2995 [============>.................] - ETA: 0s - loss: 0.2633 - acc: 0.8951
1472/2995 [=============>................] - ETA: 0s - loss: 0.2622 - acc: 0.8954
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2530 - acc: 0.8988
1728/2995 [================>.............] - ETA: 0s - loss: 0.2512 - acc: 0.8993
1856/2995 [=================>............] - ETA: 0s - loss: 0.2521 - acc: 0.8982
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2553 - acc: 0.8967
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2535 - acc: 0.8968
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2525 - acc: 0.8987
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2505 - acc: 0.8995
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2494 - acc: 0.9002
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2501 - acc: 0.9005
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2475 - acc: 0.9004
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2478 - acc: 0.9000
2995/2995 [==============================] - 2s 534us/step - loss: 0.2530 - acc: 0.8985

Test accuracy: 91.29129129129129

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  156

choose_one :  177

F1score :  0.9154518950437318

AUC :  0.9521318808166799

Confusion Matrix
[[147  20]
 [  9 157]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.2529645128520781], 'acc': [0.898497495965687]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2224 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2199 - acc: 0.9323
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2281 - acc: 0.9219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2236 - acc: 0.9263
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2395 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2422 - acc: 0.9077
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2406 - acc: 0.9087
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2394 - acc: 0.9083
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2395 - acc: 0.9099
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2396 - acc: 0.9087
1344/2995 [============>.................] - ETA: 0s - loss: 0.2506 - acc: 0.9033
1472/2995 [=============>................] - ETA: 0s - loss: 0.2482 - acc: 0.9015
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2415 - acc: 0.9038
1728/2995 [================>.............] - ETA: 0s - loss: 0.2444 - acc: 0.9010
1856/2995 [=================>............] - ETA: 0s - loss: 0.2428 - acc: 0.9019
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2408 - acc: 0.9042
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2408 - acc: 0.9025
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2394 - acc: 0.9040
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2430 - acc: 0.9016
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2422 - acc: 0.9026
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2407 - acc: 0.9043
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2369 - acc: 0.9059
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2397 - acc: 0.9056
2995/2995 [==============================] - 2s 537us/step - loss: 0.2383 - acc: 0.9062

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.8955223880597014

AUC :  0.9520236635163408

Confusion Matrix
[[148  19]
 [ 16 150]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.23826284455835123], 'acc': [0.9061769616424739]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1967 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2342 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2179 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2111 - acc: 0.9152
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2062 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2257 - acc: 0.9062
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2356 - acc: 0.9014
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2441 - acc: 0.8990
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2411 - acc: 0.8989
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2413 - acc: 0.8980
1344/2995 [============>.................] - ETA: 0s - loss: 0.2368 - acc: 0.9018
1472/2995 [=============>................] - ETA: 0s - loss: 0.2322 - acc: 0.9029
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2301 - acc: 0.9025
1728/2995 [================>.............] - ETA: 0s - loss: 0.2322 - acc: 0.9022
1856/2995 [=================>............] - ETA: 0s - loss: 0.2261 - acc: 0.9057
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2297 - acc: 0.9047
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2301 - acc: 0.9053
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2271 - acc: 0.9080
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2226 - acc: 0.9084
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2217 - acc: 0.9103
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2198 - acc: 0.9112
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2227 - acc: 0.9095
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2231 - acc: 0.9097
2995/2995 [==============================] - 2s 537us/step - loss: 0.2242 - acc: 0.9095

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  145

choose_one :  188

F1score :  0.8983050847457628

AUC :  0.9540076473558907

Confusion Matrix
[[138  29]
 [  7 159]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.04216867469879518  
0.9578313253012049  

Train_result {'loss': [0.22419392181955317], 'acc': [0.9095158598856854]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1380 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.1825 - acc: 0.9375
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1693 - acc: 0.9406
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1961 - acc: 0.9330
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1846 - acc: 0.9323
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1810 - acc: 0.9290
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2008 - acc: 0.9195
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2066 - acc: 0.9219
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2151 - acc: 0.9173
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2151 - acc: 0.9178
1344/2995 [============>.................] - ETA: 0s - loss: 0.2101 - acc: 0.9189
1472/2995 [=============>................] - ETA: 0s - loss: 0.2091 - acc: 0.9205
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2099 - acc: 0.9206
1728/2995 [================>.............] - ETA: 0s - loss: 0.2094 - acc: 0.9219
1856/2995 [=================>............] - ETA: 0s - loss: 0.2101 - acc: 0.9208
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2143 - acc: 0.9194
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2195 - acc: 0.9167
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2252 - acc: 0.9143
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2300 - acc: 0.9134
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2268 - acc: 0.9155
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2236 - acc: 0.9165
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2276 - acc: 0.9139
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2268 - acc: 0.9135
2995/2995 [==============================] - 2s 538us/step - loss: 0.2259 - acc: 0.9142

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  177

choose_one :  156

F1score :  0.8757763975155279

AUC :  0.9562080657961186

Confusion Matrix
[[152  15]
 [ 25 141]]
True label 0
0.9101796407185628  
0.08982035928143713  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'loss': [0.22593156000807607], 'acc': [0.914190317274931]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1480 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.1781 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1572 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1548 - acc: 0.9241
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1730 - acc: 0.9167
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1701 - acc: 0.9247
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1659 - acc: 0.9279
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1673 - acc: 0.9281
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1654 - acc: 0.9301
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1657 - acc: 0.9317
1344/2995 [============>.................] - ETA: 0s - loss: 0.1690 - acc: 0.9323
1472/2995 [=============>................] - ETA: 0s - loss: 0.1749 - acc: 0.9300
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1808 - acc: 0.9275
1728/2995 [================>.............] - ETA: 0s - loss: 0.1871 - acc: 0.9242
1856/2995 [=================>............] - ETA: 0s - loss: 0.1881 - acc: 0.9246
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1891 - acc: 0.9244
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1937 - acc: 0.9242
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1937 - acc: 0.9259
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1969 - acc: 0.9231
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1965 - acc: 0.9223
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1983 - acc: 0.9219
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2044 - acc: 0.9197
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2036 - acc: 0.9201
2995/2995 [==============================] - 2s 540us/step - loss: 0.2048 - acc: 0.9195

Test accuracy: 91.5915915915916

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.9171597633136095

AUC :  0.954656951157925

Confusion Matrix
[[150  17]
 [ 11 155]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.06626506024096386  
0.9337349397590361  

Train_result {'loss': [0.20476763056892783], 'acc': [0.9195325543167993]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1697 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2314 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2003 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2024 - acc: 0.9152
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2015 - acc: 0.9149
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1892 - acc: 0.9205
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1810 - acc: 0.9231
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1838 - acc: 0.9208
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1806 - acc: 0.9237
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1848 - acc: 0.9194
1344/2995 [============>.................] - ETA: 0s - loss: 0.1838 - acc: 0.9204
1472/2995 [=============>................] - ETA: 0s - loss: 0.1799 - acc: 0.9219
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1796 - acc: 0.9237
1728/2995 [================>.............] - ETA: 0s - loss: 0.1777 - acc: 0.9248
1856/2995 [=================>............] - ETA: 0s - loss: 0.1741 - acc: 0.9262
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1740 - acc: 0.9274
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1797 - acc: 0.9252
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1839 - acc: 0.9246
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1866 - acc: 0.9248
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1890 - acc: 0.9235
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1911 - acc: 0.9226
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1889 - acc: 0.9237
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1883 - acc: 0.9247
2995/2995 [==============================] - 2s 535us/step - loss: 0.1913 - acc: 0.9219

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  157

choose_one :  176

F1score :  0.9064327485380117

AUC :  0.9564245003967968

Confusion Matrix
[[146  21]
 [ 11 155]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.06626506024096386  
0.9337349397590361  

Train_result {'loss': [0.19131915591694476], 'acc': [0.9218697830711263]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1601 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.1953 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1890 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2018 - acc: 0.9196
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1873 - acc: 0.9253
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1774 - acc: 0.9304
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1876 - acc: 0.9315
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1857 - acc: 0.9302
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1897 - acc: 0.9256
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1882 - acc: 0.9260
1344/2995 [============>.................] - ETA: 0s - loss: 0.1873 - acc: 0.9249
1472/2995 [=============>................] - ETA: 0s - loss: 0.1880 - acc: 0.9253
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1919 - acc: 0.9237
1728/2995 [================>.............] - ETA: 0s - loss: 0.1896 - acc: 0.9265
1856/2995 [=================>............] - ETA: 0s - loss: 0.1895 - acc: 0.9273
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1932 - acc: 0.9249
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1878 - acc: 0.9276
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1864 - acc: 0.9286
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1861 - acc: 0.9303
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1820 - acc: 0.9323
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1850 - acc: 0.9303
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1841 - acc: 0.9302
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1861 - acc: 0.9292
2995/2995 [==============================] - 2s 541us/step - loss: 0.1876 - acc: 0.9282

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.9003021148036254

AUC :  0.959057788038381

Confusion Matrix
[[151  16]
 [ 17 149]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'loss': [0.18758264948708783], 'acc': [0.9282136895620763]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3233 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2807 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2505 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2298 - acc: 0.9018
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2118 - acc: 0.9062
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1958 - acc: 0.9119
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1870 - acc: 0.9171
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1765 - acc: 0.9250
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1729 - acc: 0.9256
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1735 - acc: 0.9276
1344/2995 [============>.................] - ETA: 0s - loss: 0.1728 - acc: 0.9271
1472/2995 [=============>................] - ETA: 0s - loss: 0.1732 - acc: 0.9273
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1731 - acc: 0.9287
1728/2995 [================>.............] - ETA: 0s - loss: 0.1758 - acc: 0.9288
1856/2995 [=================>............] - ETA: 0s - loss: 0.1772 - acc: 0.9283
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1761 - acc: 0.9294
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1789 - acc: 0.9280
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1765 - acc: 0.9295
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1763 - acc: 0.9299
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1745 - acc: 0.9299
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1726 - acc: 0.9303
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1751 - acc: 0.9288
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1775 - acc: 0.9278
2995/2995 [==============================] - 2s 529us/step - loss: 0.1766 - acc: 0.9272

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  171

choose_one :  162

F1score :  0.8963414634146342

AUC :  0.9589134983045956

Confusion Matrix
[[152  15]
 [ 19 147]]
True label 0
0.9101796407185628  
0.08982035928143713  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.17655325339413644], 'acc': [0.9272120201726987]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2553 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.1629 - acc: 0.9375
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1340 - acc: 0.9500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1189 - acc: 0.9576
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1167 - acc: 0.9618
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1240 - acc: 0.9560
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1256 - acc: 0.9555
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1297 - acc: 0.9510
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1253 - acc: 0.9531
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1341 - acc: 0.9515
1344/2995 [============>.................] - ETA: 0s - loss: 0.1341 - acc: 0.9509
1472/2995 [=============>................] - ETA: 0s - loss: 0.1367 - acc: 0.9504
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1442 - acc: 0.9463
1728/2995 [================>.............] - ETA: 0s - loss: 0.1435 - acc: 0.9468
1856/2995 [=================>............] - ETA: 0s - loss: 0.1426 - acc: 0.9467
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1451 - acc: 0.9471
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1477 - acc: 0.9460
2176/2995 [====================>.........] - ETA: 0s - loss: 0.1506 - acc: 0.9453
2304/2995 [======================>.......] - ETA: 0s - loss: 0.1522 - acc: 0.9462
2432/2995 [=======================>......] - ETA: 0s - loss: 0.1533 - acc: 0.9445
2560/2995 [========================>.....] - ETA: 0s - loss: 0.1573 - acc: 0.9418
2688/2995 [=========================>....] - ETA: 0s - loss: 0.1561 - acc: 0.9427
2816/2995 [===========================>..] - ETA: 0s - loss: 0.1556 - acc: 0.9421
2944/2995 [============================>.] - ETA: 0s - loss: 0.1593 - acc: 0.9416
2995/2995 [==============================] - 2s 565us/step - loss: 0.1594 - acc: 0.9409

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  146

choose_one :  187

F1score :  0.9065155807365439

AUC :  0.955450544693745

Confusion Matrix
[[140  27]
 [  6 160]]
True label 0
0.8383233532934131  
0.16167664670658682  
True label 1
0.03614457831325301  
0.963855421686747  

Train_result {'loss': [0.15940442778829342], 'acc': [0.9409015026036806]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1627 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.1521 - acc: 0.9271
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1399 - acc: 0.9375
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1373 - acc: 0.9420
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1272 - acc: 0.9462
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1175 - acc: 0.9517
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1293 - acc: 0.9471
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1327 - acc: 0.9458
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1408 - acc: 0.9449
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1416 - acc: 0.9424
1344/2995 [============>.................] - ETA: 0s - loss: 0.1395 - acc: 0.9420
1472/2995 [=============>................] - ETA: 0s - loss: 0.1383 - acc: 0.9416
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1427 - acc: 0.9400
1728/2995 [================>.............] - ETA: 0s - loss: 0.1464 - acc: 0.9398
1856/2995 [=================>............] - ETA: 0s - loss: 0.1516 - acc: 0.9386
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1558 - acc: 0.9375
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1557 - acc: 0.9384
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1559 - acc: 0.9384
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1559 - acc: 0.9392
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1564 - acc: 0.9387
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1614 - acc: 0.9367
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1607 - acc: 0.9364
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1585 - acc: 0.9372
2995/2995 [==============================] - 2s 542us/step - loss: 0.1606 - acc: 0.9366

Test accuracy: 92.1921921921922

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.923076923076923

AUC :  0.9626289589495708

Confusion Matrix
[[151  16]
 [ 10 156]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.16061238438040268], 'acc': [0.9365609349909927]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.0967 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1076 - acc: 0.9479
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1443 - acc: 0.9344
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1494 - acc: 0.9353
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1398 - acc: 0.9427
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1307 - acc: 0.9489
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1291 - acc: 0.9495
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1315 - acc: 0.9458
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1309 - acc: 0.9476
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1266 - acc: 0.9498
1344/2995 [============>.................] - ETA: 0s - loss: 0.1305 - acc: 0.9479
1472/2995 [=============>................] - ETA: 0s - loss: 0.1326 - acc: 0.9477
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1326 - acc: 0.9481
1728/2995 [================>.............] - ETA: 0s - loss: 0.1359 - acc: 0.9468
1856/2995 [=================>............] - ETA: 0s - loss: 0.1360 - acc: 0.9467
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1384 - acc: 0.9451
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1372 - acc: 0.9455
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1400 - acc: 0.9446
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1396 - acc: 0.9447
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1459 - acc: 0.9419
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1462 - acc: 0.9417
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1484 - acc: 0.9404
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1482 - acc: 0.9396
2995/2995 [==============================] - 2s 519us/step - loss: 0.1479 - acc: 0.9389

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  176

choose_one :  157

F1score :  0.8978328173374612

AUC :  0.9628453935502489

Confusion Matrix
[[155  12]
 [ 21 145]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.12650602409638553  
0.8734939759036144  

Train_result {'loss': [0.1479443517720361], 'acc': [0.9388981637254183]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1370 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1100 - acc: 0.9531
 320/2995 [==>...........................] - ETA: 1s - loss: 0.0911 - acc: 0.9594
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1066 - acc: 0.9554
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1213 - acc: 0.9514
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1205 - acc: 0.9517
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1150 - acc: 0.9543
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1317 - acc: 0.9479
1088/2995 [=========>....................] - ETA: 0s - loss: 0.1400 - acc: 0.9421
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1382 - acc: 0.9449
1344/2995 [============>.................] - ETA: 0s - loss: 0.1426 - acc: 0.9442
1472/2995 [=============>................] - ETA: 0s - loss: 0.1436 - acc: 0.9436
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1418 - acc: 0.9425
1728/2995 [================>.............] - ETA: 0s - loss: 0.1418 - acc: 0.9427
1856/2995 [=================>............] - ETA: 0s - loss: 0.1465 - acc: 0.9402
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1479 - acc: 0.9410
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1451 - acc: 0.9427
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1432 - acc: 0.9437
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1446 - acc: 0.9438
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1451 - acc: 0.9431
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1435 - acc: 0.9428
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1432 - acc: 0.9426
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1416 - acc: 0.9434
2995/2995 [==============================] - 2s 514us/step - loss: 0.1408 - acc: 0.9439

Test accuracy: 90.990990990991

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  169

choose_one :  164

F1score :  0.9090909090909091

AUC :  0.9635668422191761

Confusion Matrix
[[153  14]
 [ 16 150]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.14077594706505686], 'acc': [0.9439065108514191]}
Saved model to disk


[[87.38738738738738, 1], [89.1891891891892, 2], [89.1891891891892, 3], [91.29129129129129, 4], [89.4894894894895, 5], [89.1891891891892, 6], [87.98798798798799, 7], [91.5915915915916, 8], [90.39039039039038, 9], [90.09009009009009, 10], [89.7897897897898, 11], [90.09009009009009, 12], [92.1921921921922, 13], [90.09009009009009, 14], [90.990990990991, 15]]
max accuracy :  [92.1921921921922, 13]

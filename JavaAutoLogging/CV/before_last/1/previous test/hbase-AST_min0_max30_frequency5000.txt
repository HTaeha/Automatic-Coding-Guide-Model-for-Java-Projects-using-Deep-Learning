Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 16:00:18.723768: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 16:00:18.736795: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 16:00:18.739369: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x69157d0 executing computations on platform Host. Devices:
2019-09-07 16:00:18.739406: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 30 : 11721
Over 30, Under 100 : 10544
Over 100, Under 150 : 2139
Over 150, Under 200 : 1071
Over 200, Under 400 : 1121
Over 400 : 180

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 9

Under 10 : 1925
Over 10, Under 30 : 1038
Over 30, Under 100 : 23
Over 100, Under 150 : 3
Over 150, Under 200 : 1
Over 200, Under 400 : 3
Over 400 : 2


Sentence length Average : 8

Under 10 : 214
Over 10, Under 30 : 116
Over 30, Under 100 : 2
Over 100, Under 150 : 0
Over 150, Under 200 : 1
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:16 - loss: 0.7682 - acc: 0.3594
 128/2995 [>.............................] - ETA: 38s - loss: 0.7274 - acc: 0.4688 
 256/2995 [=>............................] - ETA: 19s - loss: 0.6702 - acc: 0.5742
 384/2995 [==>...........................] - ETA: 12s - loss: 0.6238 - acc: 0.6458
 512/2995 [====>.........................] - ETA: 9s - loss: 0.5974 - acc: 0.6777 
 640/2995 [=====>........................] - ETA: 7s - loss: 0.5985 - acc: 0.6891
 768/2995 [======>.......................] - ETA: 6s - loss: 0.5819 - acc: 0.7096
 896/2995 [=======>......................] - ETA: 5s - loss: 0.5710 - acc: 0.7221
1024/2995 [=========>....................] - ETA: 4s - loss: 0.5566 - acc: 0.7334
1152/2995 [==========>...................] - ETA: 3s - loss: 0.5437 - acc: 0.7465
1280/2995 [===========>..................] - ETA: 3s - loss: 0.5304 - acc: 0.7602
1408/2995 [=============>................] - ETA: 2s - loss: 0.5264 - acc: 0.7649
1536/2995 [==============>...............] - ETA: 2s - loss: 0.5248 - acc: 0.7676
1664/2995 [===============>..............] - ETA: 2s - loss: 0.5140 - acc: 0.7752
1792/2995 [================>.............] - ETA: 1s - loss: 0.5093 - acc: 0.7785
1920/2995 [==================>...........] - ETA: 1s - loss: 0.5051 - acc: 0.7812
2048/2995 [===================>..........] - ETA: 1s - loss: 0.4961 - acc: 0.7871
2176/2995 [====================>.........] - ETA: 1s - loss: 0.4852 - acc: 0.7941
2304/2995 [======================>.......] - ETA: 0s - loss: 0.4841 - acc: 0.7934
2432/2995 [=======================>......] - ETA: 0s - loss: 0.4797 - acc: 0.7944
2560/2995 [========================>.....] - ETA: 0s - loss: 0.4781 - acc: 0.7969
2688/2995 [=========================>....] - ETA: 0s - loss: 0.4740 - acc: 0.7980
2816/2995 [===========================>..] - ETA: 0s - loss: 0.4726 - acc: 0.7979
2944/2995 [============================>.] - ETA: 0s - loss: 0.4680 - acc: 0.7989
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4666 - acc: 0.7990

Test accuracy: 85.88588588588588

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.853582554517134

AUC :  0.932526513238583

Confusion Matrix
[[149  18]
 [ 29 137]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.1746987951807229  
0.8253012048192772  

Train_result {'loss': [0.46658556130971257], 'acc': [0.798998330749932]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4324 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3891 - acc: 0.8385
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3736 - acc: 0.8469
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3533 - acc: 0.8504
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3486 - acc: 0.8542
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3484 - acc: 0.8622
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3458 - acc: 0.8630
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3427 - acc: 0.8656
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3521 - acc: 0.8621
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3495 - acc: 0.8643
1344/2995 [============>.................] - ETA: 0s - loss: 0.3448 - acc: 0.8653
1472/2995 [=============>................] - ETA: 0s - loss: 0.3475 - acc: 0.8607
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3508 - acc: 0.8600
1728/2995 [================>.............] - ETA: 0s - loss: 0.3490 - acc: 0.8582
1856/2995 [=================>............] - ETA: 0s - loss: 0.3450 - acc: 0.8605
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3441 - acc: 0.8629
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3474 - acc: 0.8622
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3475 - acc: 0.8607
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3547 - acc: 0.8568
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3581 - acc: 0.8554
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3613 - acc: 0.8529
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3586 - acc: 0.8547
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3569 - acc: 0.8549
2995/2995 [==============================] - 2s 540us/step - loss: 0.3524 - acc: 0.8561

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8535031847133757

AUC :  0.9482901666546425

Confusion Matrix
[[153  14]
 [ 32 134]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.3524072908449651], 'acc': [0.8560934892679892]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2879 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.3699 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3484 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3542 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3336 - acc: 0.8715
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3334 - acc: 0.8722
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3402 - acc: 0.8666
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3379 - acc: 0.8656
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3347 - acc: 0.8676
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3432 - acc: 0.8627
1344/2995 [============>.................] - ETA: 0s - loss: 0.3431 - acc: 0.8601
1472/2995 [=============>................] - ETA: 0s - loss: 0.3443 - acc: 0.8607
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3435 - acc: 0.8606
1728/2995 [================>.............] - ETA: 0s - loss: 0.3453 - acc: 0.8600
1856/2995 [=================>............] - ETA: 0s - loss: 0.3433 - acc: 0.8621
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3406 - acc: 0.8639
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3393 - acc: 0.8641
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3399 - acc: 0.8625
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3374 - acc: 0.8628
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3308 - acc: 0.8658
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3299 - acc: 0.8670
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3309 - acc: 0.8645
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3312 - acc: 0.8639
2995/2995 [==============================] - 2s 538us/step - loss: 0.3306 - acc: 0.8641

Test accuracy: 87.08708708708708

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  174

choose_one :  159

F1score :  0.8676923076923078

AUC :  0.9498773537262823

Confusion Matrix
[[149  18]
 [ 25 141]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'loss': [0.33058225896601284], 'acc': [0.8641068449402493]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4645 - acc: 0.7812
 192/2995 [>.............................] - ETA: 1s - loss: 0.3092 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3071 - acc: 0.8656
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3250 - acc: 0.8594
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3130 - acc: 0.8681
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3197 - acc: 0.8608
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3287 - acc: 0.8594
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3361 - acc: 0.8573
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3257 - acc: 0.8603
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3224 - acc: 0.8627
1344/2995 [============>.................] - ETA: 0s - loss: 0.3238 - acc: 0.8601
1472/2995 [=============>................] - ETA: 0s - loss: 0.3267 - acc: 0.8587
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3193 - acc: 0.8638
1728/2995 [================>.............] - ETA: 0s - loss: 0.3198 - acc: 0.8628
1856/2995 [=================>............] - ETA: 0s - loss: 0.3154 - acc: 0.8642
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3172 - acc: 0.8634
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3181 - acc: 0.8627
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3127 - acc: 0.8661
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3117 - acc: 0.8666
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3129 - acc: 0.8662
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3118 - acc: 0.8659
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3062 - acc: 0.8688
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3050 - acc: 0.8691
2995/2995 [==============================] - 2s 540us/step - loss: 0.3076 - acc: 0.8671

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  149

choose_one :  184

F1score :  0.8914285714285715

AUC :  0.9528533294856072

Confusion Matrix
[[139  28]
 [ 10 156]]
True label 0
0.8323353293413174  
0.16766467065868262  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.3075699058518386], 'acc': [0.8671118532874946]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2683 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3001 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3134 - acc: 0.8688
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2885 - acc: 0.8817
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2999 - acc: 0.8750
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3130 - acc: 0.8679
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3083 - acc: 0.8750
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3127 - acc: 0.8760
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3156 - acc: 0.8704
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3179 - acc: 0.8701
1344/2995 [============>.................] - ETA: 0s - loss: 0.3213 - acc: 0.8676
1472/2995 [=============>................] - ETA: 0s - loss: 0.3214 - acc: 0.8689
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3153 - acc: 0.8712
1728/2995 [================>.............] - ETA: 0s - loss: 0.3170 - acc: 0.8698
1856/2995 [=================>............] - ETA: 0s - loss: 0.3154 - acc: 0.8707
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3144 - acc: 0.8710
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3152 - acc: 0.8693
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3143 - acc: 0.8701
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3157 - acc: 0.8678
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3142 - acc: 0.8698
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3135 - acc: 0.8708
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3106 - acc: 0.8725
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3114 - acc: 0.8719
2995/2995 [==============================] - 2s 528us/step - loss: 0.3087 - acc: 0.8731

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8714733542319748

AUC :  0.95054469374504

Confusion Matrix
[[153  14]
 [ 27 139]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.30872189347851453], 'acc': [0.8731218698824785]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2301 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3003 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2752 - acc: 0.8656
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3093 - acc: 0.8571
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3062 - acc: 0.8611
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3171 - acc: 0.8537
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3145 - acc: 0.8570
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3191 - acc: 0.8542
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3145 - acc: 0.8585
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3109 - acc: 0.8618
1344/2995 [============>.................] - ETA: 0s - loss: 0.3058 - acc: 0.8653
1472/2995 [=============>................] - ETA: 0s - loss: 0.3026 - acc: 0.8668
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3005 - acc: 0.8662
1728/2995 [================>.............] - ETA: 0s - loss: 0.3039 - acc: 0.8663
1856/2995 [=================>............] - ETA: 0s - loss: 0.3027 - acc: 0.8685
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3062 - acc: 0.8669
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3019 - acc: 0.8684
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2978 - acc: 0.8710
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2960 - acc: 0.8720
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2963 - acc: 0.8734
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2943 - acc: 0.8735
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2952 - acc: 0.8725
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2971 - acc: 0.8708
2995/2995 [==============================] - 2s 533us/step - loss: 0.2986 - acc: 0.8701

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  143

choose_one :  190

F1score :  0.8932584269662921

AUC :  0.9532320900367939

Confusion Matrix
[[136  31]
 [  7 159]]
True label 0
0.8143712574850299  
0.18562874251497005  
True label 1
0.04216867469879518  
0.9578313253012049  

Train_result {'loss': [0.29857984845944757], 'acc': [0.8701168615750359]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3069 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2868 - acc: 0.8906
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2754 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2822 - acc: 0.8817
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2785 - acc: 0.8854
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2745 - acc: 0.8878
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2729 - acc: 0.8834
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2797 - acc: 0.8812
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2826 - acc: 0.8824
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2884 - acc: 0.8816
1344/2995 [============>.................] - ETA: 0s - loss: 0.2859 - acc: 0.8839
1472/2995 [=============>................] - ETA: 0s - loss: 0.2905 - acc: 0.8804
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2860 - acc: 0.8819
1728/2995 [================>.............] - ETA: 0s - loss: 0.2846 - acc: 0.8814
1856/2995 [=================>............] - ETA: 0s - loss: 0.2832 - acc: 0.8825
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2827 - acc: 0.8805
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2866 - acc: 0.8788
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2894 - acc: 0.8772
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2906 - acc: 0.8750
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2898 - acc: 0.8754
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2870 - acc: 0.8761
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2915 - acc: 0.8732
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2911 - acc: 0.8729
2995/2995 [==============================] - 2s 529us/step - loss: 0.2934 - acc: 0.8738

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  184

choose_one :  149

F1score :  0.8698412698412697

AUC :  0.9522400981170189

Confusion Matrix
[[155  12]
 [ 29 137]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1746987951807229  
0.8253012048192772  

Train_result {'loss': [0.29336128662743033], 'acc': [0.8737896495351011]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2652 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2487 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2310 - acc: 0.8875
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2578 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2502 - acc: 0.8941
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2448 - acc: 0.8935
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2582 - acc: 0.8882
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2555 - acc: 0.8896
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2500 - acc: 0.8961
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2587 - acc: 0.8914
1344/2995 [============>.................] - ETA: 0s - loss: 0.2639 - acc: 0.8914
1472/2995 [=============>................] - ETA: 0s - loss: 0.2629 - acc: 0.8899
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2692 - acc: 0.8881
1728/2995 [================>.............] - ETA: 0s - loss: 0.2746 - acc: 0.8854
1856/2995 [=================>............] - ETA: 0s - loss: 0.2754 - acc: 0.8852
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2761 - acc: 0.8851
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2785 - acc: 0.8835
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2783 - acc: 0.8839
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2811 - acc: 0.8813
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2791 - acc: 0.8826
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2778 - acc: 0.8834
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2833 - acc: 0.8801
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2848 - acc: 0.8774
2995/2995 [==============================] - 2s 511us/step - loss: 0.2857 - acc: 0.8781

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8875379939209727

AUC :  0.9533944159873026

Confusion Matrix
[[150  17]
 [ 20 146]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.12048192771084337  
0.8795180722891566  

Train_result {'loss': [0.28567039026242863], 'acc': [0.8781302171079862]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2127 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.3009 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2646 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2764 - acc: 0.8862
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2785 - acc: 0.8854
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2737 - acc: 0.8906
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2748 - acc: 0.8882
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2881 - acc: 0.8812
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2814 - acc: 0.8842
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2791 - acc: 0.8840
1344/2995 [============>.................] - ETA: 0s - loss: 0.2794 - acc: 0.8810
1472/2995 [=============>................] - ETA: 0s - loss: 0.2788 - acc: 0.8818
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2712 - acc: 0.8850
1728/2995 [================>.............] - ETA: 0s - loss: 0.2735 - acc: 0.8843
1856/2995 [=================>............] - ETA: 0s - loss: 0.2727 - acc: 0.8858
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2703 - acc: 0.8871
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2731 - acc: 0.8859
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2781 - acc: 0.8844
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2805 - acc: 0.8834
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2817 - acc: 0.8842
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2807 - acc: 0.8841
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2791 - acc: 0.8841
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2791 - acc: 0.8861
2995/2995 [==============================] - 2s 522us/step - loss: 0.2799 - acc: 0.8845

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.8994082840236686

AUC :  0.9575066734001876

Confusion Matrix
[[147  20]
 [ 14 152]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.2798733338589262], 'acc': [0.8844741236586403]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2326 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2941 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2823 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2814 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2670 - acc: 0.8819
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2537 - acc: 0.8920
 768/2995 [======>.......................] - ETA: 1s - loss: 0.2856 - acc: 0.8841
 896/2995 [=======>......................] - ETA: 1s - loss: 0.2719 - acc: 0.8929
1024/2995 [=========>....................] - ETA: 1s - loss: 0.2925 - acc: 0.8828
1152/2995 [==========>...................] - ETA: 1s - loss: 0.2850 - acc: 0.8863
1280/2995 [===========>..................] - ETA: 0s - loss: 0.2875 - acc: 0.8812
1408/2995 [=============>................] - ETA: 0s - loss: 0.2839 - acc: 0.8814
1536/2995 [==============>...............] - ETA: 0s - loss: 0.2849 - acc: 0.8802
1664/2995 [===============>..............] - ETA: 0s - loss: 0.2807 - acc: 0.8840
1792/2995 [================>.............] - ETA: 0s - loss: 0.2829 - acc: 0.8834
1920/2995 [==================>...........] - ETA: 0s - loss: 0.2822 - acc: 0.8828
2048/2995 [===================>..........] - ETA: 0s - loss: 0.2807 - acc: 0.8838
2176/2995 [====================>.........] - ETA: 0s - loss: 0.2780 - acc: 0.8842
2304/2995 [======================>.......] - ETA: 0s - loss: 0.2756 - acc: 0.8859
2432/2995 [=======================>......] - ETA: 0s - loss: 0.2754 - acc: 0.8853
2560/2995 [========================>.....] - ETA: 0s - loss: 0.2746 - acc: 0.8855
2688/2995 [=========================>....] - ETA: 0s - loss: 0.2768 - acc: 0.8828
2816/2995 [===========================>..] - ETA: 0s - loss: 0.2748 - acc: 0.8849
2944/2995 [============================>.] - ETA: 0s - loss: 0.2761 - acc: 0.8855
2995/2995 [==============================] - 2s 533us/step - loss: 0.2752 - acc: 0.8861

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  193

choose_one :  140

F1score :  0.8496732026143791

AUC :  0.9557751965947623

Confusion Matrix
[[157  10]
 [ 36 130]]
True label 0
0.9401197604790419  
0.059880239520958084  
True label 1
0.21686746987951808  
0.7831325301204819  

Train_result {'loss': [0.2752416667486471], 'acc': [0.8861435727006406]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3398 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2948 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2990 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2821 - acc: 0.8728
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2771 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2633 - acc: 0.8849
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2628 - acc: 0.8846
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2547 - acc: 0.8885
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2580 - acc: 0.8842
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2615 - acc: 0.8808
1344/2995 [============>.................] - ETA: 0s - loss: 0.2559 - acc: 0.8847
1472/2995 [=============>................] - ETA: 0s - loss: 0.2578 - acc: 0.8845
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2599 - acc: 0.8844
1728/2995 [================>.............] - ETA: 0s - loss: 0.2692 - acc: 0.8831
1856/2995 [=================>............] - ETA: 0s - loss: 0.2665 - acc: 0.8863
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2691 - acc: 0.8841
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2708 - acc: 0.8821
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2680 - acc: 0.8835
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2672 - acc: 0.8830
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2677 - acc: 0.8838
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2684 - acc: 0.8845
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2715 - acc: 0.8834
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2728 - acc: 0.8830
2995/2995 [==============================] - 2s 538us/step - loss: 0.2708 - acc: 0.8828

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  189

choose_one :  144

F1score :  0.8580645161290323

AUC :  0.9572361301493398

Confusion Matrix
[[156  11]
 [ 33 133]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.2707818204751596], 'acc': [0.8828046746166401]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2742 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.2145 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2152 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2189 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2038 - acc: 0.9149
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2174 - acc: 0.9091
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2255 - acc: 0.9087
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2377 - acc: 0.9052
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2306 - acc: 0.9081
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2337 - acc: 0.9071
1344/2995 [============>.................] - ETA: 0s - loss: 0.2375 - acc: 0.9040
1472/2995 [=============>................] - ETA: 0s - loss: 0.2433 - acc: 0.9001
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2524 - acc: 0.8938
1728/2995 [================>.............] - ETA: 0s - loss: 0.2509 - acc: 0.8924
1856/2995 [=================>............] - ETA: 0s - loss: 0.2471 - acc: 0.8960
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2504 - acc: 0.8957
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2519 - acc: 0.8944
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2583 - acc: 0.8938
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2635 - acc: 0.8902
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2640 - acc: 0.8902
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2628 - acc: 0.8918
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2629 - acc: 0.8928
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2616 - acc: 0.8931
2995/2995 [==============================] - 2s 531us/step - loss: 0.2646 - acc: 0.8915

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  149

choose_one :  184

F1score :  0.897142857142857

AUC :  0.9526008224514826

Confusion Matrix
[[140  27]
 [  9 157]]
True label 0
0.8383233532934131  
0.16167664670658682  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.2646387435458538], 'acc': [0.8914858098022129]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2591 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2764 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2598 - acc: 0.9031
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2377 - acc: 0.9152
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2410 - acc: 0.9097
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2474 - acc: 0.9062
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2449 - acc: 0.9026
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2380 - acc: 0.9052
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2357 - acc: 0.9053
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2336 - acc: 0.9079
1344/2995 [============>.................] - ETA: 0s - loss: 0.2333 - acc: 0.9092
1472/2995 [=============>................] - ETA: 0s - loss: 0.2317 - acc: 0.9076
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2340 - acc: 0.9075
1728/2995 [================>.............] - ETA: 0s - loss: 0.2367 - acc: 0.9074
1856/2995 [=================>............] - ETA: 0s - loss: 0.2361 - acc: 0.9079
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2454 - acc: 0.9037
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2489 - acc: 0.9015
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2467 - acc: 0.9018
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2500 - acc: 0.8999
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2556 - acc: 0.8978
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2632 - acc: 0.8941
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2647 - acc: 0.8932
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2627 - acc: 0.8927
2995/2995 [==============================] - 2s 519us/step - loss: 0.2654 - acc: 0.8908

Test accuracy: 90.69069069069069

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  162

choose_one :  171

F1score :  0.9080118694362017

AUC :  0.9538994300555516

Confusion Matrix
[[149  18]
 [ 13 153]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.0783132530120482  
0.9216867469879518  

Train_result {'loss': [0.2654100511328804], 'acc': [0.8908180302490973]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1087 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.2509 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2711 - acc: 0.9062
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2813 - acc: 0.8929
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2681 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2646 - acc: 0.8991
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2792 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2731 - acc: 0.8948
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2766 - acc: 0.8934
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2697 - acc: 0.8972
1344/2995 [============>.................] - ETA: 0s - loss: 0.2729 - acc: 0.8951
1472/2995 [=============>................] - ETA: 0s - loss: 0.2745 - acc: 0.8940
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2706 - acc: 0.8938
1728/2995 [================>.............] - ETA: 0s - loss: 0.2690 - acc: 0.8953
1856/2995 [=================>............] - ETA: 0s - loss: 0.2673 - acc: 0.8966
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2636 - acc: 0.8972
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2594 - acc: 0.8977
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2563 - acc: 0.8987
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2546 - acc: 0.8986
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2578 - acc: 0.8974
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2586 - acc: 0.8960
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2608 - acc: 0.8939
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2581 - acc: 0.8938
2995/2995 [==============================] - 2s 523us/step - loss: 0.2601 - acc: 0.8932

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.8955223880597014

AUC :  0.9547651684582642

Confusion Matrix
[[148  19]
 [ 16 150]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.2600684815834281], 'acc': [0.8931552589039173]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2328 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2368 - acc: 0.9271
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2122 - acc: 0.9281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2364 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2665 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2679 - acc: 0.8991
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2587 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2675 - acc: 0.8958
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2608 - acc: 0.8989
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2573 - acc: 0.8988
1344/2995 [============>.................] - ETA: 0s - loss: 0.2583 - acc: 0.8988
1472/2995 [=============>................] - ETA: 0s - loss: 0.2514 - acc: 0.9022
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2619 - acc: 0.8962
1728/2995 [================>.............] - ETA: 0s - loss: 0.2602 - acc: 0.8976
1856/2995 [=================>............] - ETA: 0s - loss: 0.2630 - acc: 0.8933
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2643 - acc: 0.8931
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2645 - acc: 0.8916
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2613 - acc: 0.8924
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2596 - acc: 0.8923
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2586 - acc: 0.8926
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2576 - acc: 0.8921
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2565 - acc: 0.8924
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2606 - acc: 0.8910
2995/2995 [==============================] - 2s 538us/step - loss: 0.2623 - acc: 0.8902

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  183

choose_one :  150

F1score :  0.8734177215189873

AUC :  0.9554866171271914

Confusion Matrix
[[155  12]
 [ 28 138]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.2622950303833154], 'acc': [0.8901502505367705]}
Saved model to disk


[[85.88588588588588, 1], [86.18618618618619, 2], [87.08708708708708, 3], [88.58858858858859, 4], [87.68768768768768, 5], [88.58858858858859, 6], [87.68768768768768, 7], [88.88888888888889, 8], [89.7897897897898, 9], [86.18618618618619, 10], [86.78678678678679, 11], [89.1891891891892, 12], [90.69069069069069, 13], [89.4894894894895, 14], [87.98798798798799, 15]]
max accuracy :  [90.69069069069069, 13]

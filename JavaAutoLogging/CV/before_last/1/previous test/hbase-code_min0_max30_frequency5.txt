Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:50:14.175342: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:50:14.186879: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:50:14.188999: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x68881c0 executing computations on platform Host. Devices:
2019-09-07 15:50:14.189039: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 51

Under 10 : 9474
Over 10, Under 30 : 18298
Over 30, Under 100 : 13980
Over 100, Under 150 : 2960
Over 150, Under 200 : 1491
Over 200, Under 400 : 1892
Over 400 : 375

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 14

Under 10 : 916
Over 10, Under 30 : 2079
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0


Sentence length Average : 14

Under 10 : 108
Over 10, Under 30 : 225
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:12 - loss: 0.7281 - acc: 0.5156
 192/2995 [>.............................] - ETA: 24s - loss: 0.7250 - acc: 0.5260 
 320/2995 [==>...........................] - ETA: 14s - loss: 0.7222 - acc: 0.5594
 448/2995 [===>..........................] - ETA: 10s - loss: 0.6821 - acc: 0.6138
 576/2995 [====>.........................] - ETA: 8s - loss: 0.6601 - acc: 0.6372 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.6486 - acc: 0.6477
 832/2995 [=======>......................] - ETA: 5s - loss: 0.6264 - acc: 0.6635
 960/2995 [========>.....................] - ETA: 4s - loss: 0.6091 - acc: 0.6781
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5943 - acc: 0.6875
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5844 - acc: 0.6965
1344/2995 [============>.................] - ETA: 2s - loss: 0.5772 - acc: 0.7024
1472/2995 [=============>................] - ETA: 2s - loss: 0.5748 - acc: 0.7038
1600/2995 [===============>..............] - ETA: 2s - loss: 0.5686 - acc: 0.7113
1728/2995 [================>.............] - ETA: 1s - loss: 0.5601 - acc: 0.7182
1856/2995 [=================>............] - ETA: 1s - loss: 0.5496 - acc: 0.7252
1984/2995 [==================>...........] - ETA: 1s - loss: 0.5460 - acc: 0.7268
2112/2995 [====================>.........] - ETA: 1s - loss: 0.5379 - acc: 0.7330
2240/2995 [=====================>........] - ETA: 0s - loss: 0.5304 - acc: 0.7379
2368/2995 [======================>.......] - ETA: 0s - loss: 0.5291 - acc: 0.7382
2496/2995 [========================>.....] - ETA: 0s - loss: 0.5241 - acc: 0.7408
2624/2995 [=========================>....] - ETA: 0s - loss: 0.5245 - acc: 0.7428
2752/2995 [==========================>...] - ETA: 0s - loss: 0.5203 - acc: 0.7445
2880/2995 [===========================>..] - ETA: 0s - loss: 0.5178 - acc: 0.7448
2995/2995 [==============================] - 3s 1ms/step - loss: 0.5158 - acc: 0.7469

Test accuracy: 82.88288288288288

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  196

choose_one :  137

F1score :  0.8118811881188118

AUC :  0.8991775485174229

Confusion Matrix
[[153  14]
 [ 43 123]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.25903614457831325  
0.7409638554216867  

Train_result {'loss': [0.5158223868013423], 'acc': [0.7469115193379742]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4586 - acc: 0.7500
 192/2995 [>.............................] - ETA: 1s - loss: 0.4228 - acc: 0.8073
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4233 - acc: 0.8063
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4074 - acc: 0.8103
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4137 - acc: 0.8090
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4162 - acc: 0.8082
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4149 - acc: 0.8113
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4183 - acc: 0.8146
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4149 - acc: 0.8162
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4071 - acc: 0.8232
1344/2995 [============>.................] - ETA: 0s - loss: 0.4080 - acc: 0.8214
1472/2995 [=============>................] - ETA: 0s - loss: 0.4072 - acc: 0.8220
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4119 - acc: 0.8181
1728/2995 [================>.............] - ETA: 0s - loss: 0.4096 - acc: 0.8200
1856/2995 [=================>............] - ETA: 0s - loss: 0.4036 - acc: 0.8233
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4094 - acc: 0.8216
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4103 - acc: 0.8205
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4070 - acc: 0.8232
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4110 - acc: 0.8197
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4118 - acc: 0.8165
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4090 - acc: 0.8182
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4063 - acc: 0.8169
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4014 - acc: 0.8201
2995/2995 [==============================] - 2s 529us/step - loss: 0.3999 - acc: 0.8200

Test accuracy: 84.38438438438438

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8343949044585988

AUC :  0.9170334030733714

Confusion Matrix
[[150  17]
 [ 35 131]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.21084337349397592  
0.7891566265060241  

Train_result {'loss': [0.3998867085959159], 'acc': [0.8200333891209457]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3130 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3409 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3352 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3665 - acc: 0.8393
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3594 - acc: 0.8420
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3689 - acc: 0.8381
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3651 - acc: 0.8353
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3681 - acc: 0.8333
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3730 - acc: 0.8327
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3804 - acc: 0.8306
1344/2995 [============>.................] - ETA: 0s - loss: 0.3790 - acc: 0.8326
1472/2995 [=============>................] - ETA: 0s - loss: 0.3815 - acc: 0.8308
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3790 - acc: 0.8325
1728/2995 [================>.............] - ETA: 0s - loss: 0.3827 - acc: 0.8293
1856/2995 [=================>............] - ETA: 0s - loss: 0.3811 - acc: 0.8308
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3818 - acc: 0.8306
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3813 - acc: 0.8305
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3798 - acc: 0.8321
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3774 - acc: 0.8323
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3727 - acc: 0.8357
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3734 - acc: 0.8357
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3751 - acc: 0.8339
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3686 - acc: 0.8392
2995/2995 [==============================] - 2s 531us/step - loss: 0.3701 - acc: 0.8391

Test accuracy: 85.28528528528528

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  174

choose_one :  159

F1score :  0.8492307692307693

AUC :  0.9284683644758676

Confusion Matrix
[[146  21]
 [ 28 138]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.37005979425720065], 'acc': [0.8390651087530069]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3821 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3312 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3556 - acc: 0.8500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3581 - acc: 0.8438
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3385 - acc: 0.8559
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3411 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3367 - acc: 0.8558
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3439 - acc: 0.8479
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3408 - acc: 0.8502
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3337 - acc: 0.8528
1344/2995 [============>.................] - ETA: 0s - loss: 0.3303 - acc: 0.8549
1472/2995 [=============>................] - ETA: 0s - loss: 0.3332 - acc: 0.8533
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3290 - acc: 0.8575
1728/2995 [================>.............] - ETA: 0s - loss: 0.3326 - acc: 0.8565
1856/2995 [=================>............] - ETA: 0s - loss: 0.3317 - acc: 0.8578
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3305 - acc: 0.8584
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3276 - acc: 0.8603
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3269 - acc: 0.8612
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3290 - acc: 0.8594
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3264 - acc: 0.8590
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3261 - acc: 0.8586
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3238 - acc: 0.8594
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3229 - acc: 0.8587
2995/2995 [==============================] - 2s 537us/step - loss: 0.3260 - acc: 0.8578

Test accuracy: 85.28528528528528

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  138

choose_one :  195

F1score :  0.8642659279778395

AUC :  0.9345646057283025

Confusion Matrix
[[128  39]
 [ 10 156]]
True label 0
0.7664670658682635  
0.23353293413173654  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.32604782086779954], 'acc': [0.857762938389595]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3110 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2839 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3095 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3206 - acc: 0.8795
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3185 - acc: 0.8854
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3281 - acc: 0.8778
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3187 - acc: 0.8786
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3104 - acc: 0.8802
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3042 - acc: 0.8805
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3112 - acc: 0.8742
1344/2995 [============>.................] - ETA: 0s - loss: 0.3136 - acc: 0.8698
1472/2995 [=============>................] - ETA: 0s - loss: 0.3099 - acc: 0.8689
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3061 - acc: 0.8688
1728/2995 [================>.............] - ETA: 0s - loss: 0.3119 - acc: 0.8681
1856/2995 [=================>............] - ETA: 0s - loss: 0.3151 - acc: 0.8631
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3109 - acc: 0.8664
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3111 - acc: 0.8655
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3106 - acc: 0.8652
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3090 - acc: 0.8674
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3103 - acc: 0.8674
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3068 - acc: 0.8693
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3044 - acc: 0.8692
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3043 - acc: 0.8701
2995/2995 [==============================] - 2s 530us/step - loss: 0.3048 - acc: 0.8684

Test accuracy: 86.48648648648648

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.8656716417910448

AUC :  0.9374504004040112

Confusion Matrix
[[143  24]
 [ 21 145]]
True label 0
0.8562874251497006  
0.1437125748502994  
True label 1
0.12650602409638553  
0.8734939759036144  

Train_result {'loss': [0.30483064797266896], 'acc': [0.8684474124932329]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1932 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.2314 - acc: 0.9167
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2716 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2830 - acc: 0.8795
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2802 - acc: 0.8837
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2959 - acc: 0.8750
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3038 - acc: 0.8714
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3080 - acc: 0.8698
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3143 - acc: 0.8676
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3102 - acc: 0.8676
1344/2995 [============>.................] - ETA: 0s - loss: 0.3028 - acc: 0.8713
1472/2995 [=============>................] - ETA: 0s - loss: 0.3012 - acc: 0.8716
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2986 - acc: 0.8731
1728/2995 [================>.............] - ETA: 0s - loss: 0.3020 - acc: 0.8715
1856/2995 [=================>............] - ETA: 0s - loss: 0.2981 - acc: 0.8739
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2975 - acc: 0.8730
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2982 - acc: 0.8717
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2995 - acc: 0.8714
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2934 - acc: 0.8746
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2974 - acc: 0.8726
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2980 - acc: 0.8727
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2970 - acc: 0.8728
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2968 - acc: 0.8729
2995/2995 [==============================] - 2s 531us/step - loss: 0.2971 - acc: 0.8725

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  135

choose_one :  198

F1score :  0.8736263736263735

AUC :  0.9423923237861626

Confusion Matrix
[[128  39]
 [  7 159]]
True label 0
0.7664670658682635  
0.23353293413173654  
True label 1
0.04216867469879518  
0.9578313253012049  

Train_result {'loss': [0.29706538545468414], 'acc': [0.8724540903094615]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1775 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2255 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2013 - acc: 0.9125
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2430 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2301 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2299 - acc: 0.9034
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2597 - acc: 0.8942
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2632 - acc: 0.8938
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2696 - acc: 0.8943
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2682 - acc: 0.8980
1344/2995 [============>.................] - ETA: 0s - loss: 0.2659 - acc: 0.8973
1472/2995 [=============>................] - ETA: 0s - loss: 0.2696 - acc: 0.8961
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2649 - acc: 0.8988
1728/2995 [================>.............] - ETA: 0s - loss: 0.2644 - acc: 0.8958
1856/2995 [=================>............] - ETA: 0s - loss: 0.2620 - acc: 0.8960
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2642 - acc: 0.8931
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2667 - acc: 0.8920
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2721 - acc: 0.8897
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2739 - acc: 0.8889
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2716 - acc: 0.8894
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2686 - acc: 0.8902
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2732 - acc: 0.8866
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2754 - acc: 0.8865
2995/2995 [==============================] - 2s 504us/step - loss: 0.2760 - acc: 0.8851

Test accuracy: 84.08408408408408

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  192

choose_one :  141

F1score :  0.8273615635179153

AUC :  0.9423201789192699

Confusion Matrix
[[153  14]
 [ 39 127]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.23493975903614459  
0.7650602409638554  

Train_result {'loss': [0.27596320953711445], 'acc': [0.8851419033311644]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2753 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2689 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2500 - acc: 0.9156
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2582 - acc: 0.9018
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2688 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2633 - acc: 0.9020
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2539 - acc: 0.9038
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2616 - acc: 0.9010
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2573 - acc: 0.9044
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2542 - acc: 0.9054
1344/2995 [============>.................] - ETA: 0s - loss: 0.2555 - acc: 0.9055
1472/2995 [=============>................] - ETA: 0s - loss: 0.2609 - acc: 0.9035
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2637 - acc: 0.9025
1728/2995 [================>.............] - ETA: 0s - loss: 0.2696 - acc: 0.8970
1856/2995 [=================>............] - ETA: 0s - loss: 0.2711 - acc: 0.8944
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2675 - acc: 0.8952
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2711 - acc: 0.8925
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2685 - acc: 0.8938
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2707 - acc: 0.8927
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2705 - acc: 0.8918
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2716 - acc: 0.8914
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2744 - acc: 0.8892
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2738 - acc: 0.8892
2995/2995 [==============================] - 2s 531us/step - loss: 0.2741 - acc: 0.8888

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.9003021148036254

AUC :  0.9470456677007432

Confusion Matrix
[[151  16]
 [ 17 149]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'loss': [0.27413106475131144], 'acc': [0.8888146912713282]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2341 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2542 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2388 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2459 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2464 - acc: 0.8802
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2470 - acc: 0.8849
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2383 - acc: 0.8870
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2545 - acc: 0.8792
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2443 - acc: 0.8869
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2497 - acc: 0.8857
1344/2995 [============>.................] - ETA: 0s - loss: 0.2487 - acc: 0.8869
1472/2995 [=============>................] - ETA: 0s - loss: 0.2489 - acc: 0.8872
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2432 - acc: 0.8906
1728/2995 [================>.............] - ETA: 0s - loss: 0.2384 - acc: 0.8918
1856/2995 [=================>............] - ETA: 0s - loss: 0.2395 - acc: 0.8944
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2371 - acc: 0.8962
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2385 - acc: 0.8968
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2434 - acc: 0.8964
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2442 - acc: 0.8986
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2460 - acc: 0.8994
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2474 - acc: 0.8979
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2466 - acc: 0.8975
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2475 - acc: 0.8976
2995/2995 [==============================] - 2s 530us/step - loss: 0.2463 - acc: 0.8978

Test accuracy: 87.08708708708708

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  142

choose_one :  191

F1score :  0.8795518207282913

AUC :  0.9483082028713657

Confusion Matrix
[[133  34]
 [  9 157]]
True label 0
0.7964071856287425  
0.20359281437125748  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.24633646993983369], 'acc': [0.897829716293163]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1649 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.2249 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2079 - acc: 0.9156
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2329 - acc: 0.9085
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2297 - acc: 0.9080
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2204 - acc: 0.9134
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2204 - acc: 0.9123
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2301 - acc: 0.9094
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2377 - acc: 0.9007
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2412 - acc: 0.9005
1344/2995 [============>.................] - ETA: 0s - loss: 0.2356 - acc: 0.9040
1472/2995 [=============>................] - ETA: 0s - loss: 0.2308 - acc: 0.9042
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2301 - acc: 0.9050
1728/2995 [================>.............] - ETA: 0s - loss: 0.2266 - acc: 0.9057
1856/2995 [=================>............] - ETA: 0s - loss: 0.2258 - acc: 0.9057
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2287 - acc: 0.9037
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2269 - acc: 0.9044
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2245 - acc: 0.9071
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2243 - acc: 0.9067
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2218 - acc: 0.9083
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2253 - acc: 0.9074
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2276 - acc: 0.9062
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2303 - acc: 0.9059
2995/2995 [==============================] - 2s 534us/step - loss: 0.2316 - acc: 0.9055

Test accuracy: 84.68468468468468

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8449848024316109

AUC :  0.9405526296803982

Confusion Matrix
[[143  24]
 [ 27 139]]
True label 0
0.8562874251497006  
0.1437125748502994  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.23156067661331572], 'acc': [0.9055091820694569]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4103 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3290 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3023 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2724 - acc: 0.8973
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2551 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2432 - acc: 0.9034
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2438 - acc: 0.9014
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2294 - acc: 0.9115
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2296 - acc: 0.9072
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2328 - acc: 0.9062
1344/2995 [============>.................] - ETA: 0s - loss: 0.2336 - acc: 0.9048
1472/2995 [=============>................] - ETA: 0s - loss: 0.2263 - acc: 0.9083
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2227 - acc: 0.9094
1728/2995 [================>.............] - ETA: 0s - loss: 0.2249 - acc: 0.9091
1856/2995 [=================>............] - ETA: 0s - loss: 0.2273 - acc: 0.9095
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2232 - acc: 0.9118
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2240 - acc: 0.9115
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2218 - acc: 0.9121
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2212 - acc: 0.9113
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2209 - acc: 0.9119
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2227 - acc: 0.9108
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2265 - acc: 0.9110
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2285 - acc: 0.9097
2995/2995 [==============================] - 2s 512us/step - loss: 0.2270 - acc: 0.9098

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  167

choose_one :  166

F1score :  0.8614457831325302

AUC :  0.9416348026837891

Confusion Matrix
[[144  23]
 [ 23 143]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.13855421686746988  
0.8614457831325302  

Train_result {'loss': [0.22699266202959273], 'acc': [0.9098497496622433]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2581 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.1997 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1951 - acc: 0.9219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1862 - acc: 0.9241
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1718 - acc: 0.9288
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1751 - acc: 0.9261
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1780 - acc: 0.9219
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1891 - acc: 0.9167
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1832 - acc: 0.9191
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1942 - acc: 0.9128
1344/2995 [============>.................] - ETA: 0s - loss: 0.1939 - acc: 0.9144
1472/2995 [=============>................] - ETA: 0s - loss: 0.1942 - acc: 0.9164
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2024 - acc: 0.9144
1728/2995 [================>.............] - ETA: 0s - loss: 0.2018 - acc: 0.9161
1856/2995 [=================>............] - ETA: 0s - loss: 0.1992 - acc: 0.9165
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2013 - acc: 0.9168
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2019 - acc: 0.9176
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2025 - acc: 0.9187
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2072 - acc: 0.9160
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2070 - acc: 0.9163
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2058 - acc: 0.9177
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2049 - acc: 0.9172
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2134 - acc: 0.9135
2995/2995 [==============================] - 2s 523us/step - loss: 0.2129 - acc: 0.9139

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  144

choose_one :  189

F1score :  0.8845070422535211

AUC :  0.9419594545848063

Confusion Matrix
[[135  32]
 [  9 157]]
True label 0
0.8083832335329342  
0.19161676646706588  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.21290222907902204], 'acc': [0.9138564274585704]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1346 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1776 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1675 - acc: 0.9344
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1534 - acc: 0.9397
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1603 - acc: 0.9340
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1583 - acc: 0.9361
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1681 - acc: 0.9339
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1737 - acc: 0.9323
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1805 - acc: 0.9292
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1847 - acc: 0.9252
1344/2995 [============>.................] - ETA: 0s - loss: 0.1801 - acc: 0.9256
1472/2995 [=============>................] - ETA: 0s - loss: 0.1807 - acc: 0.9239
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1854 - acc: 0.9225
1728/2995 [================>.............] - ETA: 0s - loss: 0.1818 - acc: 0.9248
1856/2995 [=================>............] - ETA: 0s - loss: 0.1823 - acc: 0.9240
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1841 - acc: 0.9224
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1828 - acc: 0.9228
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1840 - acc: 0.9228
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1863 - acc: 0.9227
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1866 - acc: 0.9223
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1908 - acc: 0.9207
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1937 - acc: 0.9190
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1940 - acc: 0.9201
2995/2995 [==============================] - 2s 528us/step - loss: 0.1958 - acc: 0.9185

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  157

choose_one :  176

F1score :  0.8830409356725145

AUC :  0.9484164201717048

Confusion Matrix
[[142  25]
 [ 15 151]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.19580488059178416], 'acc': [0.9185308849075203]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1707 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2210 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2083 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1931 - acc: 0.9196
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1760 - acc: 0.9323
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1614 - acc: 0.9389
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1654 - acc: 0.9339
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1779 - acc: 0.9250
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1781 - acc: 0.9246
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1763 - acc: 0.9260
1344/2995 [============>.................] - ETA: 0s - loss: 0.1767 - acc: 0.9256
1472/2995 [=============>................] - ETA: 0s - loss: 0.1810 - acc: 0.9246
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1861 - acc: 0.9206
1728/2995 [================>.............] - ETA: 0s - loss: 0.1947 - acc: 0.9178
1856/2995 [=================>............] - ETA: 0s - loss: 0.1908 - acc: 0.9197
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1925 - acc: 0.9183
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1899 - acc: 0.9195
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1891 - acc: 0.9214
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1901 - acc: 0.9223
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1971 - acc: 0.9187
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1978 - acc: 0.9188
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1978 - acc: 0.9197
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1973 - acc: 0.9194
2995/2995 [==============================] - 2s 530us/step - loss: 0.1949 - acc: 0.9205

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  159

choose_one :  174

F1score :  0.8941176470588235

AUC :  0.95094149051295

Confusion Matrix
[[145  22]
 [ 14 152]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.19489223055529076], 'acc': [0.9205342237857825]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1266 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.1471 - acc: 0.9479
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1265 - acc: 0.9563
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1414 - acc: 0.9464
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1585 - acc: 0.9410
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1596 - acc: 0.9389
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1500 - acc: 0.9459
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1623 - acc: 0.9385
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1694 - acc: 0.9366
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1650 - acc: 0.9383
1344/2995 [============>.................] - ETA: 0s - loss: 0.1762 - acc: 0.9360
1472/2995 [=============>................] - ETA: 0s - loss: 0.1737 - acc: 0.9368
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1760 - acc: 0.9356
1728/2995 [================>.............] - ETA: 0s - loss: 0.1751 - acc: 0.9346
1856/2995 [=================>............] - ETA: 0s - loss: 0.1775 - acc: 0.9348
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1824 - acc: 0.9315
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1805 - acc: 0.9323
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1807 - acc: 0.9308
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1819 - acc: 0.9303
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1818 - acc: 0.9299
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1828 - acc: 0.9291
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1852 - acc: 0.9273
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1833 - acc: 0.9281
2995/2995 [==============================] - 2s 527us/step - loss: 0.1835 - acc: 0.9275

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.9014925373134328

AUC :  0.9450977562946397

Confusion Matrix
[[149  18]
 [ 15 151]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.18345889506336047], 'acc': [0.9275459099094537]}
Saved model to disk


[[82.88288288288288, 1], [84.38438438438438, 2], [85.28528528528528, 3], [85.28528528528528, 4], [86.48648648648648, 5], [86.18618618618619, 6], [84.08408408408408, 7], [90.09009009009009, 8], [87.08708708708708, 9], [84.68468468468468, 10], [86.18618618618619, 11], [87.68768768768768, 12], [87.98798798798799, 13], [89.1891891891892, 14], [90.09009009009009, 15]]
max accuracy :  [90.09009009009009, 15]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:57:47.177805: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:57:47.190643: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:57:47.193275: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa635150 executing computations on platform Host. Devices:
2019-09-07 15:57:47.193314: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 85

Under 10 : 7243
Over 10, Under 30 : 16559
Over 30, Under 100 : 12738
Over 100, Under 150 : 3895
Over 150, Under 200 : 2319
Over 200, Under 400 : 3915
Over 400 : 1801

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 24

Under 10 : 817
Over 10, Under 30 : 1434
Over 30, Under 100 : 728
Over 100, Under 150 : 2
Over 150, Under 200 : 1
Over 200, Under 400 : 8
Over 400 : 5


Sentence length Average : 22

Under 10 : 104
Over 10, Under 30 : 144
Over 30, Under 100 : 84
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 1
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:16 - loss: 0.7275 - acc: 0.5312
 192/2995 [>.............................] - ETA: 25s - loss: 0.7723 - acc: 0.5365 
 320/2995 [==>...........................] - ETA: 15s - loss: 0.6812 - acc: 0.6250
 448/2995 [===>..........................] - ETA: 10s - loss: 0.6430 - acc: 0.6429
 576/2995 [====>.........................] - ETA: 8s - loss: 0.6206 - acc: 0.6701 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.5954 - acc: 0.6903
 832/2995 [=======>......................] - ETA: 5s - loss: 0.5691 - acc: 0.7127
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5550 - acc: 0.7219
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5328 - acc: 0.7344
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5180 - acc: 0.7451
1344/2995 [============>.................] - ETA: 2s - loss: 0.5043 - acc: 0.7545
1472/2995 [=============>................] - ETA: 2s - loss: 0.5070 - acc: 0.7507
1600/2995 [===============>..............] - ETA: 2s - loss: 0.4952 - acc: 0.7612
1728/2995 [================>.............] - ETA: 1s - loss: 0.4843 - acc: 0.7685
1856/2995 [=================>............] - ETA: 1s - loss: 0.4767 - acc: 0.7742
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4699 - acc: 0.7787
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4589 - acc: 0.7850
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4531 - acc: 0.7888
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4528 - acc: 0.7901
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4456 - acc: 0.7933
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4429 - acc: 0.7957
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4399 - acc: 0.7972
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4362 - acc: 0.7986
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4346 - acc: 0.7993

Test accuracy: 85.58558558558559

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8471337579617835

AUC :  0.9426628670370104

Confusion Matrix
[[152  15]
 [ 33 133]]
True label 0
0.9101796407185628  
0.08982035928143713  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'acc': [0.7993322204866871], 'loss': [0.43461659518824597]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4086 - acc: 0.8125
 192/2995 [>.............................] - ETA: 2s - loss: 0.3579 - acc: 0.8281
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3445 - acc: 0.8438
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3270 - acc: 0.8504
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3151 - acc: 0.8576
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3045 - acc: 0.8651
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3035 - acc: 0.8690
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3070 - acc: 0.8698
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3037 - acc: 0.8722
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2978 - acc: 0.8742
1344/2995 [============>.................] - ETA: 1s - loss: 0.2931 - acc: 0.8757
1472/2995 [=============>................] - ETA: 0s - loss: 0.2987 - acc: 0.8743
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3072 - acc: 0.8725
1728/2995 [================>.............] - ETA: 0s - loss: 0.3039 - acc: 0.8704
1856/2995 [=================>............] - ETA: 0s - loss: 0.2982 - acc: 0.8728
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3005 - acc: 0.8755
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3012 - acc: 0.8750
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3003 - acc: 0.8737
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3066 - acc: 0.8704
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3073 - acc: 0.8698
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3068 - acc: 0.8720
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3035 - acc: 0.8739
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3026 - acc: 0.8740
2995/2995 [==============================] - 2s 565us/step - loss: 0.3013 - acc: 0.8741

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  183

choose_one :  150

F1score :  0.8607594936708859

AUC :  0.9511759613303513

Confusion Matrix
[[153  14]
 [ 30 136]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'acc': [0.8741235393315604], 'loss': [0.3013011460113207]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2757 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.2859 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2568 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2700 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2543 - acc: 0.8906
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2594 - acc: 0.8935
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2708 - acc: 0.8846
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2710 - acc: 0.8844
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2714 - acc: 0.8842
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2787 - acc: 0.8816
1344/2995 [============>.................] - ETA: 0s - loss: 0.2777 - acc: 0.8832
1472/2995 [=============>................] - ETA: 0s - loss: 0.2822 - acc: 0.8791
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2840 - acc: 0.8775
1728/2995 [================>.............] - ETA: 0s - loss: 0.2887 - acc: 0.8779
1856/2995 [=================>............] - ETA: 0s - loss: 0.2886 - acc: 0.8777
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2873 - acc: 0.8795
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2861 - acc: 0.8797
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2881 - acc: 0.8790
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2872 - acc: 0.8784
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2809 - acc: 0.8818
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2813 - acc: 0.8834
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2828 - acc: 0.8815
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2814 - acc: 0.8826
2995/2995 [==============================] - 2s 505us/step - loss: 0.2813 - acc: 0.8815

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.8882175226586103

AUC :  0.9539174662722747

Confusion Matrix
[[149  18]
 [ 19 147]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'acc': [0.8814691153710991], 'loss': [0.28134365592257604]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3564 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2388 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2466 - acc: 0.9031
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2543 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2515 - acc: 0.8993
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2632 - acc: 0.9006
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2635 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2708 - acc: 0.8927
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2689 - acc: 0.8925
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2689 - acc: 0.8931
1344/2995 [============>.................] - ETA: 0s - loss: 0.2649 - acc: 0.8958
1472/2995 [=============>................] - ETA: 0s - loss: 0.2649 - acc: 0.8967
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2535 - acc: 0.9025
1728/2995 [================>.............] - ETA: 0s - loss: 0.2525 - acc: 0.9016
1856/2995 [=================>............] - ETA: 0s - loss: 0.2525 - acc: 0.9003
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2543 - acc: 0.8982
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2524 - acc: 0.8982
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2509 - acc: 0.9000
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2514 - acc: 0.9012
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2523 - acc: 0.9014
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2529 - acc: 0.9002
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2490 - acc: 0.9015
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2488 - acc: 0.9010
2995/2995 [==============================] - 2s 531us/step - loss: 0.2535 - acc: 0.8985

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  155

choose_one :  178

F1score :  0.9069767441860466

AUC :  0.9578132890844816

Confusion Matrix
[[145  22]
 [ 10 156]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'acc': [0.8984974959855884], 'loss': [0.2535404773009241]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2228 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2210 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2226 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2081 - acc: 0.9174
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2236 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2317 - acc: 0.9077
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2311 - acc: 0.9099
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2420 - acc: 0.9062
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2442 - acc: 0.9026
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2426 - acc: 0.9030
1344/2995 [============>.................] - ETA: 0s - loss: 0.2475 - acc: 0.9010
1472/2995 [=============>................] - ETA: 0s - loss: 0.2452 - acc: 0.9022
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2402 - acc: 0.9038
1728/2995 [================>.............] - ETA: 0s - loss: 0.2404 - acc: 0.9045
1856/2995 [=================>............] - ETA: 0s - loss: 0.2393 - acc: 0.9041
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2380 - acc: 0.9057
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2380 - acc: 0.9044
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2374 - acc: 0.9040
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2401 - acc: 0.9012
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2399 - acc: 0.9014
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2373 - acc: 0.9032
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2330 - acc: 0.9044
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2346 - acc: 0.9042
2995/2995 [==============================] - 2s 550us/step - loss: 0.2343 - acc: 0.9038

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8957055214723926

AUC :  0.9578854339513744

Confusion Matrix
[[153  14]
 [ 20 146]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.12048192771084337  
0.8795180722891566  

Train_result {'acc': [0.9038397329279497], 'loss': [0.23431207975979043]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1743 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2108 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2061 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2210 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2193 - acc: 0.8924
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2313 - acc: 0.8906
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2296 - acc: 0.8930
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2437 - acc: 0.8865
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2401 - acc: 0.8915
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2357 - acc: 0.8947
1344/2995 [============>.................] - ETA: 0s - loss: 0.2264 - acc: 0.8988
1472/2995 [=============>................] - ETA: 0s - loss: 0.2254 - acc: 0.9008
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2223 - acc: 0.9031
1728/2995 [================>.............] - ETA: 0s - loss: 0.2265 - acc: 0.9034
1856/2995 [=================>............] - ETA: 0s - loss: 0.2209 - acc: 0.9068
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2212 - acc: 0.9068
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2190 - acc: 0.9072
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2179 - acc: 0.9098
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2152 - acc: 0.9105
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2176 - acc: 0.9099
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2159 - acc: 0.9104
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2176 - acc: 0.9102
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2201 - acc: 0.9094
2995/2995 [==============================] - 2s 540us/step - loss: 0.2208 - acc: 0.9082

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  141

choose_one :  192

F1score :  0.8994413407821229

AUC :  0.9584986653199624

Confusion Matrix
[[136  31]
 [  5 161]]
True label 0
0.8143712574850299  
0.18562874251497005  
True label 1
0.030120481927710843  
0.9698795180722891  

Train_result {'acc': [0.9081803006401444], 'loss': [0.22079007561895406]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1772 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.1984 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1951 - acc: 0.9313
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2085 - acc: 0.9174
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1923 - acc: 0.9236
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1980 - acc: 0.9190
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2060 - acc: 0.9171
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2026 - acc: 0.9177
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2179 - acc: 0.9127
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2135 - acc: 0.9178
1344/2995 [============>.................] - ETA: 0s - loss: 0.2092 - acc: 0.9189
1472/2995 [=============>................] - ETA: 0s - loss: 0.2101 - acc: 0.9178
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2082 - acc: 0.9181
1728/2995 [================>.............] - ETA: 0s - loss: 0.2073 - acc: 0.9178
1856/2995 [=================>............] - ETA: 0s - loss: 0.2096 - acc: 0.9154
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2109 - acc: 0.9168
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2145 - acc: 0.9157
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2154 - acc: 0.9152
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2195 - acc: 0.9139
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2166 - acc: 0.9143
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2140 - acc: 0.9158
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2187 - acc: 0.9128
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2187 - acc: 0.9122
2995/2995 [==============================] - 2s 532us/step - loss: 0.2189 - acc: 0.9122

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.8847352024922119

AUC :  0.9603383594257269

Confusion Matrix
[[154  13]
 [ 24 142]]
True label 0
0.9221556886227545  
0.07784431137724551  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'acc': [0.9121869783966688], 'loss': [0.21887043803084474]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1218 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1469 - acc: 0.9427
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1501 - acc: 0.9313
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1513 - acc: 0.9286
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1661 - acc: 0.9167
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1660 - acc: 0.9176
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1598 - acc: 0.9219
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1637 - acc: 0.9219
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1600 - acc: 0.9265
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1624 - acc: 0.9260
1344/2995 [============>.................] - ETA: 0s - loss: 0.1682 - acc: 0.9263
1472/2995 [=============>................] - ETA: 0s - loss: 0.1713 - acc: 0.9266
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1752 - acc: 0.9269
1728/2995 [================>.............] - ETA: 0s - loss: 0.1824 - acc: 0.9225
1856/2995 [=================>............] - ETA: 0s - loss: 0.1816 - acc: 0.9235
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1848 - acc: 0.9229
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1911 - acc: 0.9214
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1921 - acc: 0.9205
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1956 - acc: 0.9189
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1950 - acc: 0.9195
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1937 - acc: 0.9181
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1968 - acc: 0.9168
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1975 - acc: 0.9167
2995/2995 [==============================] - 2s 535us/step - loss: 0.2012 - acc: 0.9159

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  171

choose_one :  162

F1score :  0.9024390243902438

AUC :  0.9568393333814299

Confusion Matrix
[[153  14]
 [ 18 148]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.10843373493975904  
0.891566265060241  

Train_result {'acc': [0.915859766356734], 'loss': [0.20124977865382307]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1766 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2339 - acc: 0.9167
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2153 - acc: 0.9219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2123 - acc: 0.9196
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2092 - acc: 0.9201
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2047 - acc: 0.9233
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2023 - acc: 0.9243
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2036 - acc: 0.9208
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1973 - acc: 0.9210
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1972 - acc: 0.9178
1344/2995 [============>.................] - ETA: 0s - loss: 0.1971 - acc: 0.9167
1472/2995 [=============>................] - ETA: 0s - loss: 0.1930 - acc: 0.9192
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1879 - acc: 0.9231
1728/2995 [================>.............] - ETA: 0s - loss: 0.1836 - acc: 0.9248
1856/2995 [=================>............] - ETA: 0s - loss: 0.1795 - acc: 0.9262
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1769 - acc: 0.9284
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1825 - acc: 0.9271
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1851 - acc: 0.9263
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1893 - acc: 0.9248
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1907 - acc: 0.9243
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1910 - acc: 0.9226
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1910 - acc: 0.9226
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1900 - acc: 0.9233
2995/2995 [==============================] - 2s 531us/step - loss: 0.1918 - acc: 0.9225

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  154

choose_one :  179

F1score :  0.9043478260869566

AUC :  0.960663011326744

Confusion Matrix
[[144  23]
 [ 10 156]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'acc': [0.9225375626640447], 'loss': [0.19182104431528083]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.0830 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.1694 - acc: 0.9323
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1733 - acc: 0.9281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1877 - acc: 0.9241
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1763 - acc: 0.9288
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1714 - acc: 0.9276
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1833 - acc: 0.9267
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1805 - acc: 0.9271
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1928 - acc: 0.9237
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1930 - acc: 0.9227
1344/2995 [============>.................] - ETA: 0s - loss: 0.1872 - acc: 0.9234
1472/2995 [=============>................] - ETA: 0s - loss: 0.1833 - acc: 0.9266
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1844 - acc: 0.9263
1728/2995 [================>.............] - ETA: 0s - loss: 0.1810 - acc: 0.9282
1856/2995 [=================>............] - ETA: 0s - loss: 0.1811 - acc: 0.9289
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1864 - acc: 0.9269
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1826 - acc: 0.9285
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1843 - acc: 0.9281
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1833 - acc: 0.9274
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1776 - acc: 0.9295
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1808 - acc: 0.9276
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1819 - acc: 0.9266
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1836 - acc: 0.9264
2995/2995 [==============================] - 2s 533us/step - loss: 0.1853 - acc: 0.9262

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.8971962616822431

AUC :  0.9605187215929586

Confusion Matrix
[[156  11]
 [ 22 144]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'acc': [0.9262103507037155], 'loss': [0.18527174775608393]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4412 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.3059 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2608 - acc: 0.9000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2265 - acc: 0.9174
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2094 - acc: 0.9236
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1962 - acc: 0.9276
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1911 - acc: 0.9267
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1807 - acc: 0.9323
1088/2995 [=========>....................] - ETA: 0s - loss: 0.1790 - acc: 0.9301
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1768 - acc: 0.9301
1344/2995 [============>.................] - ETA: 0s - loss: 0.1725 - acc: 0.9308
1472/2995 [=============>................] - ETA: 0s - loss: 0.1755 - acc: 0.9293
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1776 - acc: 0.9294
1728/2995 [================>.............] - ETA: 0s - loss: 0.1775 - acc: 0.9300
1856/2995 [=================>............] - ETA: 0s - loss: 0.1779 - acc: 0.9300
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1781 - acc: 0.9304
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1792 - acc: 0.9299
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1760 - acc: 0.9313
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1750 - acc: 0.9307
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1726 - acc: 0.9315
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1723 - acc: 0.9310
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1748 - acc: 0.9306
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1766 - acc: 0.9292
2995/2995 [==============================] - 2s 514us/step - loss: 0.1741 - acc: 0.9302

Test accuracy: 90.990990990991

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  171

choose_one :  162

F1score :  0.9085365853658537

AUC :  0.960157997258495

Confusion Matrix
[[154  13]
 [ 17 149]]
True label 0
0.9221556886227545  
0.07784431137724551  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.9302170284403385], 'loss': [0.17414052861063228]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1967 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.1538 - acc: 0.9323
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1417 - acc: 0.9437
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1331 - acc: 0.9420
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1243 - acc: 0.9479
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1215 - acc: 0.9517
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1264 - acc: 0.9495
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1289 - acc: 0.9490
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1268 - acc: 0.9513
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1358 - acc: 0.9490
1344/2995 [============>.................] - ETA: 0s - loss: 0.1380 - acc: 0.9494
1472/2995 [=============>................] - ETA: 0s - loss: 0.1388 - acc: 0.9497
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1476 - acc: 0.9450
1728/2995 [================>.............] - ETA: 0s - loss: 0.1492 - acc: 0.9439
1856/2995 [=================>............] - ETA: 0s - loss: 0.1490 - acc: 0.9440
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1521 - acc: 0.9441
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1517 - acc: 0.9441
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1559 - acc: 0.9442
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1571 - acc: 0.9434
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1577 - acc: 0.9423
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1564 - acc: 0.9436
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1556 - acc: 0.9437
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1583 - acc: 0.9431
2995/2995 [==============================] - 2s 536us/step - loss: 0.1581 - acc: 0.9422

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  155

choose_one :  178

F1score :  0.8953488372093023

AUC :  0.9578493615179281

Confusion Matrix
[[143  24]
 [ 12 154]]
True label 0
0.8562874251497006  
0.1437125748502994  
True label 1
0.07228915662650602  
0.927710843373494  

Train_result {'acc': [0.9422370618094188], 'loss': [0.15808648553634924]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1384 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.1656 - acc: 0.9323
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1466 - acc: 0.9437
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1338 - acc: 0.9487
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1351 - acc: 0.9497
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1277 - acc: 0.9545
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1336 - acc: 0.9507
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1374 - acc: 0.9490
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1420 - acc: 0.9485
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1447 - acc: 0.9449
1344/2995 [============>.................] - ETA: 0s - loss: 0.1403 - acc: 0.9457
1472/2995 [=============>................] - ETA: 0s - loss: 0.1373 - acc: 0.9463
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1475 - acc: 0.9431
1728/2995 [================>.............] - ETA: 0s - loss: 0.1534 - acc: 0.9410
1856/2995 [=================>............] - ETA: 0s - loss: 0.1511 - acc: 0.9418
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1543 - acc: 0.9400
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1568 - acc: 0.9375
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1553 - acc: 0.9371
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1572 - acc: 0.9375
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1576 - acc: 0.9379
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1643 - acc: 0.9337
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1640 - acc: 0.9328
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1614 - acc: 0.9351
2995/2995 [==============================] - 2s 537us/step - loss: 0.1643 - acc: 0.9342

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  165

choose_one :  168

F1score :  0.8982035928143712

AUC :  0.9595447658899069

Confusion Matrix
[[149  18]
 [ 16 150]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'acc': [0.9342237062565671], 'loss': [0.164313686635339]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.0670 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1243 - acc: 0.9531
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1669 - acc: 0.9313
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1819 - acc: 0.9241
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1723 - acc: 0.9306
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1624 - acc: 0.9361
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1520 - acc: 0.9411
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1488 - acc: 0.9385
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1436 - acc: 0.9421
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1388 - acc: 0.9441
1344/2995 [============>.................] - ETA: 0s - loss: 0.1409 - acc: 0.9435
1472/2995 [=============>................] - ETA: 0s - loss: 0.1412 - acc: 0.9436
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1405 - acc: 0.9444
1728/2995 [================>.............] - ETA: 0s - loss: 0.1424 - acc: 0.9444
1856/2995 [=================>............] - ETA: 0s - loss: 0.1402 - acc: 0.9456
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1393 - acc: 0.9451
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1351 - acc: 0.9470
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1372 - acc: 0.9464
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1397 - acc: 0.9451
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1448 - acc: 0.9435
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1476 - acc: 0.9421
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1490 - acc: 0.9415
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1505 - acc: 0.9410
2995/2995 [==============================] - 2s 536us/step - loss: 0.1510 - acc: 0.9406

Test accuracy: 90.990990990991

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  167

choose_one :  166

F1score :  0.9096385542168675

AUC :  0.9603022869922805

Confusion Matrix
[[152  15]
 [ 15 151]]
True label 0
0.9101796407185628  
0.08982035928143713  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'acc': [0.9405676127475172], 'loss': [0.15097194601080455]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.0809 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.0875 - acc: 0.9688
 320/2995 [==>...........................] - ETA: 1s - loss: 0.0840 - acc: 0.9719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.0999 - acc: 0.9665
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1111 - acc: 0.9635
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1112 - acc: 0.9616
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1070 - acc: 0.9627
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1274 - acc: 0.9573
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1347 - acc: 0.9522
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1333 - acc: 0.9523
1344/2995 [============>.................] - ETA: 0s - loss: 0.1410 - acc: 0.9494
1472/2995 [=============>................] - ETA: 0s - loss: 0.1359 - acc: 0.9511
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1391 - acc: 0.9506
1728/2995 [================>.............] - ETA: 0s - loss: 0.1379 - acc: 0.9502
1856/2995 [=================>............] - ETA: 0s - loss: 0.1445 - acc: 0.9472
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1447 - acc: 0.9461
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1418 - acc: 0.9474
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1396 - acc: 0.9482
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1391 - acc: 0.9485
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1407 - acc: 0.9483
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1386 - acc: 0.9482
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1414 - acc: 0.9480
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1413 - acc: 0.9479
2995/2995 [==============================] - 2s 535us/step - loss: 0.1418 - acc: 0.9476

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  181

choose_one :  152

F1score :  0.8930817610062893

AUC :  0.9597612004905851

Confusion Matrix
[[157  10]
 [ 24 142]]
True label 0
0.9401197604790419  
0.059880239520958084  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'acc': [0.9475792988910898], 'loss': [0.14176246259666245]}
Saved model to disk


[[85.58558558558559, 1], [86.78678678678679, 2], [88.88888888888889, 3], [90.39039039039038, 4], [89.7897897897898, 5], [89.1891891891892, 6], [88.88888888888889, 7], [90.39039039039038, 8], [90.09009009009009, 9], [90.09009009009009, 10], [90.990990990991, 11], [89.1891891891892, 12], [89.7897897897898, 13], [90.990990990991, 14], [89.7897897897898, 15]]
max accuracy :  [90.990990990991, 14]

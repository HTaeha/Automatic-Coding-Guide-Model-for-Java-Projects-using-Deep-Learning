Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 16:06:23.538929: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 16:06:23.551305: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 16:06:23.553861: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x81540f0 executing computations on platform Host. Devices:
2019-09-07 16:06:23.553902: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 85

Under 10 : 7243
Over 10, Under 30 : 16559
Over 30, Under 100 : 12738
Over 100, Under 150 : 3895
Over 150, Under 200 : 2319
Over 200, Under 400 : 3915
Over 400 : 1801

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 24

Under 10 : 817
Over 10, Under 30 : 1434
Over 30, Under 100 : 728
Over 100, Under 150 : 2
Over 150, Under 200 : 1
Over 200, Under 400 : 8
Over 400 : 5


Sentence length Average : 22

Under 10 : 104
Over 10, Under 30 : 144
Over 30, Under 100 : 84
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 1
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:12 - loss: 0.7293 - acc: 0.5000
 192/2995 [>.............................] - ETA: 24s - loss: 0.6634 - acc: 0.5885 
 320/2995 [==>...........................] - ETA: 14s - loss: 0.6260 - acc: 0.6344
 448/2995 [===>..........................] - ETA: 10s - loss: 0.5996 - acc: 0.6562
 576/2995 [====>.........................] - ETA: 7s - loss: 0.5835 - acc: 0.6719 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.5717 - acc: 0.6832
 832/2995 [=======>......................] - ETA: 5s - loss: 0.5507 - acc: 0.7067
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5413 - acc: 0.7167
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5243 - acc: 0.7289
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5126 - acc: 0.7401
1344/2995 [============>.................] - ETA: 2s - loss: 0.5015 - acc: 0.7500
1472/2995 [=============>................] - ETA: 2s - loss: 0.5016 - acc: 0.7514
1600/2995 [===============>..............] - ETA: 2s - loss: 0.4952 - acc: 0.7594
1728/2995 [================>.............] - ETA: 1s - loss: 0.4834 - acc: 0.7685
1856/2995 [=================>............] - ETA: 1s - loss: 0.4782 - acc: 0.7732
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4753 - acc: 0.7767
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4670 - acc: 0.7841
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4604 - acc: 0.7888
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4619 - acc: 0.7893
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4550 - acc: 0.7937
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4519 - acc: 0.7946
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4496 - acc: 0.7940
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4458 - acc: 0.7955
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4423 - acc: 0.7970

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  183

choose_one :  150

F1score :  0.8544303797468354

AUC :  0.9428251929875189

Confusion Matrix
[[152  15]
 [ 31 135]]
True label 0
0.9101796407185628  
0.08982035928143713  
True label 1
0.18674698795180722  
0.8132530120481928  

Train_result {'acc': [0.7969949918318671], 'loss': [0.4422604051874158]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3959 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.3744 - acc: 0.8490
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3453 - acc: 0.8562
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3305 - acc: 0.8571
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3260 - acc: 0.8611
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3164 - acc: 0.8722
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3210 - acc: 0.8714
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3256 - acc: 0.8708
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3272 - acc: 0.8695
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3287 - acc: 0.8701
1344/2995 [============>.................] - ETA: 0s - loss: 0.3213 - acc: 0.8720
1472/2995 [=============>................] - ETA: 0s - loss: 0.3252 - acc: 0.8709
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3313 - acc: 0.8688
1728/2995 [================>.............] - ETA: 0s - loss: 0.3288 - acc: 0.8681
1856/2995 [=================>............] - ETA: 0s - loss: 0.3225 - acc: 0.8718
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3245 - acc: 0.8720
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3267 - acc: 0.8703
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3265 - acc: 0.8692
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3304 - acc: 0.8674
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3305 - acc: 0.8666
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3311 - acc: 0.8659
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3274 - acc: 0.8688
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3262 - acc: 0.8681
2995/2995 [==============================] - 2s 554us/step - loss: 0.3240 - acc: 0.8698

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  191

choose_one :  142

F1score :  0.8506493506493508

AUC :  0.9506529110453792

Confusion Matrix
[[156  11]
 [ 35 131]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.21084337349397592  
0.7891566265060241  

Train_result {'acc': [0.8697829716989711], 'loss': [0.3240219461251181]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3141 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3503 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3086 - acc: 0.8656
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3103 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2925 - acc: 0.8767
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2946 - acc: 0.8807
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3078 - acc: 0.8714
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3063 - acc: 0.8719
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3075 - acc: 0.8713
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3131 - acc: 0.8660
1344/2995 [============>.................] - ETA: 0s - loss: 0.3122 - acc: 0.8683
1472/2995 [=============>................] - ETA: 0s - loss: 0.3195 - acc: 0.8662
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3170 - acc: 0.8662
1728/2995 [================>.............] - ETA: 0s - loss: 0.3196 - acc: 0.8669
1856/2995 [=================>............] - ETA: 0s - loss: 0.3177 - acc: 0.8685
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3146 - acc: 0.8715
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3121 - acc: 0.8717
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3121 - acc: 0.8714
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3107 - acc: 0.8716
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3032 - acc: 0.8762
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3028 - acc: 0.8773
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3036 - acc: 0.8757
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3033 - acc: 0.8760
2995/2995 [==============================] - 2s 532us/step - loss: 0.3028 - acc: 0.8751

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  175

choose_one :  158

F1score :  0.8765432098765433

AUC :  0.9517711564822163

Confusion Matrix
[[151  16]
 [ 24 142]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'acc': [0.8751252088801491], 'loss': [0.3027924021416793]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3983 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.2613 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2545 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2694 - acc: 0.8839
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2735 - acc: 0.8819
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2829 - acc: 0.8750
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2950 - acc: 0.8714
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3101 - acc: 0.8646
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3031 - acc: 0.8667
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2991 - acc: 0.8684
1344/2995 [============>.................] - ETA: 0s - loss: 0.2960 - acc: 0.8698
1472/2995 [=============>................] - ETA: 0s - loss: 0.2950 - acc: 0.8702
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2861 - acc: 0.8762
1728/2995 [================>.............] - ETA: 0s - loss: 0.2835 - acc: 0.8762
1856/2995 [=================>............] - ETA: 0s - loss: 0.2807 - acc: 0.8788
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2829 - acc: 0.8790
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2841 - acc: 0.8783
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2812 - acc: 0.8799
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2813 - acc: 0.8796
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2785 - acc: 0.8806
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2773 - acc: 0.8819
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2729 - acc: 0.8819
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2734 - acc: 0.8816
2995/2995 [==============================] - 2s 537us/step - loss: 0.2773 - acc: 0.8798

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  163

choose_one :  170

F1score :  0.8869047619047619

AUC :  0.9542962268234615

Confusion Matrix
[[146  21]
 [ 17 149]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.8797996662693948], 'loss': [0.2772773772627364]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2450 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2345 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2503 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2341 - acc: 0.8862
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2500 - acc: 0.8854
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2594 - acc: 0.8835
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2527 - acc: 0.8894
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2666 - acc: 0.8844
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2710 - acc: 0.8814
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2768 - acc: 0.8758
1344/2995 [============>.................] - ETA: 0s - loss: 0.2820 - acc: 0.8728
1472/2995 [=============>................] - ETA: 0s - loss: 0.2823 - acc: 0.8743
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2764 - acc: 0.8781
1728/2995 [================>.............] - ETA: 0s - loss: 0.2778 - acc: 0.8802
1856/2995 [=================>............] - ETA: 0s - loss: 0.2752 - acc: 0.8815
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2739 - acc: 0.8826
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2742 - acc: 0.8812
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2744 - acc: 0.8799
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2764 - acc: 0.8784
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2746 - acc: 0.8790
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2714 - acc: 0.8803
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2680 - acc: 0.8819
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2717 - acc: 0.8812
2995/2995 [==============================] - 2s 526us/step - loss: 0.2697 - acc: 0.8825

Test accuracy: 87.08708708708708

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  182

choose_one :  151

F1score :  0.8643533123028392

AUC :  0.9554144722602987

Confusion Matrix
[[153  14]
 [ 29 137]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.1746987951807229  
0.8253012048192772  

Train_result {'acc': [0.882470784720674], 'loss': [0.2696819871465033]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2870 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.2522 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2392 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2556 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2553 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2773 - acc: 0.8707
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2746 - acc: 0.8726
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2933 - acc: 0.8677
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2868 - acc: 0.8713
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2814 - acc: 0.8725
1344/2995 [============>.................] - ETA: 0s - loss: 0.2747 - acc: 0.8765
1472/2995 [=============>................] - ETA: 0s - loss: 0.2717 - acc: 0.8791
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2678 - acc: 0.8775
1728/2995 [================>.............] - ETA: 0s - loss: 0.2691 - acc: 0.8802
1856/2995 [=================>............] - ETA: 0s - loss: 0.2644 - acc: 0.8815
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2667 - acc: 0.8821
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2638 - acc: 0.8830
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2608 - acc: 0.8853
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2574 - acc: 0.8856
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2554 - acc: 0.8870
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2533 - acc: 0.8883
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2550 - acc: 0.8870
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2556 - acc: 0.8865
2995/2995 [==============================] - 2s 545us/step - loss: 0.2569 - acc: 0.8865

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  144

choose_one :  189

F1score :  0.8845070422535211

AUC :  0.9544405165572469

Confusion Matrix
[[135  32]
 [  9 157]]
True label 0
0.8083832335329342  
0.19161676646706588  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'acc': [0.8864774625767053], 'loss': [0.25686372227979226]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2414 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2487 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2400 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2578 - acc: 0.8862
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2435 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2350 - acc: 0.9020
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2400 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2468 - acc: 0.8938
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2553 - acc: 0.8934
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2550 - acc: 0.8923
1344/2995 [============>.................] - ETA: 0s - loss: 0.2462 - acc: 0.8936
1472/2995 [=============>................] - ETA: 0s - loss: 0.2467 - acc: 0.8913
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2435 - acc: 0.8925
1728/2995 [================>.............] - ETA: 0s - loss: 0.2406 - acc: 0.8953
1856/2995 [=================>............] - ETA: 0s - loss: 0.2433 - acc: 0.8928
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2420 - acc: 0.8957
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2474 - acc: 0.8930
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2489 - acc: 0.8929
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2523 - acc: 0.8915
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2506 - acc: 0.8926
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2491 - acc: 0.8925
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2525 - acc: 0.8906
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2520 - acc: 0.8910
2995/2995 [==============================] - 2s 538us/step - loss: 0.2538 - acc: 0.8902

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.858974358974359

AUC :  0.9547290960248178

Confusion Matrix
[[155  12]
 [ 32 134]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'acc': [0.8901502505765734], 'loss': [0.2538081998021057]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1836 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.1858 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1770 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1993 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2056 - acc: 0.9062
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2033 - acc: 0.9091
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2022 - acc: 0.9111
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2058 - acc: 0.9073
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2061 - acc: 0.9127
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2113 - acc: 0.9087
1344/2995 [============>.................] - ETA: 0s - loss: 0.2181 - acc: 0.9077
1472/2995 [=============>................] - ETA: 0s - loss: 0.2228 - acc: 0.9056
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2285 - acc: 0.9044
1728/2995 [================>.............] - ETA: 0s - loss: 0.2335 - acc: 0.9028
1856/2995 [=================>............] - ETA: 0s - loss: 0.2328 - acc: 0.9019
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2324 - acc: 0.9022
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2365 - acc: 0.9006
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2358 - acc: 0.9013
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2389 - acc: 0.8986
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2389 - acc: 0.9002
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2382 - acc: 0.9005
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2435 - acc: 0.8975
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2440 - acc: 0.8962
2995/2995 [==============================] - 2s 542us/step - loss: 0.2482 - acc: 0.8952

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  166

choose_one :  167

F1score :  0.8948948948948949

AUC :  0.9537912127552125

Confusion Matrix
[[149  18]
 [ 17 149]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'acc': [0.8951585977423768], 'loss': [0.2481676849578577]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2241 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2719 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2466 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2510 - acc: 0.8817
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2514 - acc: 0.8802
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2438 - acc: 0.8864
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2408 - acc: 0.8870
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2437 - acc: 0.8812
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2359 - acc: 0.8860
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2327 - acc: 0.8865
1344/2995 [============>.................] - ETA: 0s - loss: 0.2392 - acc: 0.8869
1472/2995 [=============>................] - ETA: 0s - loss: 0.2366 - acc: 0.8899
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2351 - acc: 0.8919
1728/2995 [================>.............] - ETA: 0s - loss: 0.2353 - acc: 0.8912
1856/2995 [=================>............] - ETA: 0s - loss: 0.2353 - acc: 0.8928
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2326 - acc: 0.8957
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2369 - acc: 0.8944
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2371 - acc: 0.8942
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2398 - acc: 0.8944
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2403 - acc: 0.8942
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2395 - acc: 0.8944
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2376 - acc: 0.8953
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2353 - acc: 0.8965
2995/2995 [==============================] - 2s 538us/step - loss: 0.2362 - acc: 0.8962

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  154

choose_one :  179

F1score :  0.8927536231884058

AUC :  0.9533222711204098

Confusion Matrix
[[142  25]
 [ 12 154]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.07228915662650602  
0.927710843373494  

Train_result {'acc': [0.8961602671715573], 'loss': [0.2362031612899745]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1319 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.2167 - acc: 0.9323
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2157 - acc: 0.9187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2254 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2231 - acc: 0.9080
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2103 - acc: 0.9148
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2178 - acc: 0.9159
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2198 - acc: 0.9156
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2336 - acc: 0.9072
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2306 - acc: 0.9062
1344/2995 [============>.................] - ETA: 0s - loss: 0.2298 - acc: 0.9048
1472/2995 [=============>................] - ETA: 0s - loss: 0.2268 - acc: 0.9062
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2278 - acc: 0.9050
1728/2995 [================>.............] - ETA: 0s - loss: 0.2234 - acc: 0.9068
1856/2995 [=================>............] - ETA: 0s - loss: 0.2276 - acc: 0.9062
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2298 - acc: 0.9052
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2287 - acc: 0.9048
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2288 - acc: 0.9040
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2292 - acc: 0.9029
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2255 - acc: 0.9046
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2290 - acc: 0.9040
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2284 - acc: 0.9041
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2289 - acc: 0.9021
2995/2995 [==============================] - 2s 523us/step - loss: 0.2272 - acc: 0.9035

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8834355828220859

AUC :  0.9583724118029002

Confusion Matrix
[[151  16]
 [ 22 144]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'acc': [0.9035058431513918], 'loss': [0.2272086859346431]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3280 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2617 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2556 - acc: 0.9000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2411 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2401 - acc: 0.8993
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2251 - acc: 0.9048
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2223 - acc: 0.9038
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2133 - acc: 0.9094
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2095 - acc: 0.9108
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2172 - acc: 0.9062
1344/2995 [============>.................] - ETA: 0s - loss: 0.2133 - acc: 0.9077
1472/2995 [=============>................] - ETA: 0s - loss: 0.2198 - acc: 0.9062
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2198 - acc: 0.9062
1728/2995 [================>.............] - ETA: 0s - loss: 0.2237 - acc: 0.9057
1856/2995 [=================>............] - ETA: 0s - loss: 0.2260 - acc: 0.9057
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2294 - acc: 0.9042
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2299 - acc: 0.9025
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2275 - acc: 0.9045
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2275 - acc: 0.9046
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2263 - acc: 0.9054
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2249 - acc: 0.9066
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2270 - acc: 0.9055
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2295 - acc: 0.9038
2995/2995 [==============================] - 2s 524us/step - loss: 0.2271 - acc: 0.9055

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  176

choose_one :  157

F1score :  0.8854489164086687

AUC :  0.9556309068609767

Confusion Matrix
[[153  14]
 [ 23 143]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.13855421686746988  
0.8614457831325302  

Train_result {'acc': [0.905509182029654], 'loss': [0.2271199792524013]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2270 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.1916 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1894 - acc: 0.9281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1889 - acc: 0.9286
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1751 - acc: 0.9340
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1800 - acc: 0.9332
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1822 - acc: 0.9327
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1843 - acc: 0.9323
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1839 - acc: 0.9329
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1932 - acc: 0.9301
1344/2995 [============>.................] - ETA: 0s - loss: 0.1975 - acc: 0.9256
1472/2995 [=============>................] - ETA: 0s - loss: 0.2006 - acc: 0.9232
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2106 - acc: 0.9175
1728/2995 [================>.............] - ETA: 0s - loss: 0.2111 - acc: 0.9161
1856/2995 [=================>............] - ETA: 0s - loss: 0.2088 - acc: 0.9192
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2102 - acc: 0.9194
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2104 - acc: 0.9209
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2137 - acc: 0.9201
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2149 - acc: 0.9189
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2138 - acc: 0.9179
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2123 - acc: 0.9184
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2127 - acc: 0.9186
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2159 - acc: 0.9174
2995/2995 [==============================] - 2s 535us/step - loss: 0.2185 - acc: 0.9142

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  162

choose_one :  171

F1score :  0.9020771513353115

AUC :  0.9522761705504653

Confusion Matrix
[[148  19]
 [ 14 152]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'acc': [0.9141903172948325], 'loss': [0.21849794208704928]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1725 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2082 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1859 - acc: 0.9281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1815 - acc: 0.9375
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1831 - acc: 0.9358
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1873 - acc: 0.9261
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1826 - acc: 0.9243
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1822 - acc: 0.9229
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1862 - acc: 0.9256
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1847 - acc: 0.9243
1344/2995 [============>.................] - ETA: 0s - loss: 0.1856 - acc: 0.9249
1472/2995 [=============>................] - ETA: 0s - loss: 0.1834 - acc: 0.9260
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1838 - acc: 0.9263
1728/2995 [================>.............] - ETA: 0s - loss: 0.1868 - acc: 0.9253
1856/2995 [=================>............] - ETA: 0s - loss: 0.1881 - acc: 0.9235
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1933 - acc: 0.9214
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1963 - acc: 0.9190
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1953 - acc: 0.9201
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1983 - acc: 0.9202
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2038 - acc: 0.9175
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2102 - acc: 0.9139
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2115 - acc: 0.9132
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2087 - acc: 0.9149
2995/2995 [==============================] - 2s 544us/step - loss: 0.2104 - acc: 0.9145

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  162

choose_one :  171

F1score :  0.9020771513353115

AUC :  0.9547290960248178

Confusion Matrix
[[148  19]
 [ 14 152]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'acc': [0.9145242070912917], 'loss': [0.21036133400983922]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.0953 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.2222 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2137 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2253 - acc: 0.9085
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2150 - acc: 0.9167
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2096 - acc: 0.9162
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2099 - acc: 0.9147
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2033 - acc: 0.9135
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2109 - acc: 0.9099
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2048 - acc: 0.9145
1344/2995 [============>.................] - ETA: 0s - loss: 0.2026 - acc: 0.9167
1472/2995 [=============>................] - ETA: 0s - loss: 0.2028 - acc: 0.9158
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1997 - acc: 0.9150
1728/2995 [================>.............] - ETA: 0s - loss: 0.2028 - acc: 0.9149
1856/2995 [=================>............] - ETA: 0s - loss: 0.1999 - acc: 0.9159
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1973 - acc: 0.9173
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1950 - acc: 0.9195
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1943 - acc: 0.9196
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1955 - acc: 0.9202
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2008 - acc: 0.9183
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2009 - acc: 0.9181
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2020 - acc: 0.9164
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2021 - acc: 0.9167
2995/2995 [==============================] - 2s 527us/step - loss: 0.2027 - acc: 0.9165

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.8785046728971964

AUC :  0.9520958083832335

Confusion Matrix
[[153  14]
 [ 25 141]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'acc': [0.9165275459894553], 'loss': [0.20267851462646796]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1264 - acc: 0.9531
 192/2995 [>.............................] - ETA: 1s - loss: 0.1652 - acc: 0.9479
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1463 - acc: 0.9500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1721 - acc: 0.9464
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1854 - acc: 0.9340
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1856 - acc: 0.9332
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1770 - acc: 0.9351
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1883 - acc: 0.9281
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1919 - acc: 0.9265
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1887 - acc: 0.9252
1344/2995 [============>.................] - ETA: 0s - loss: 0.1985 - acc: 0.9204
1472/2995 [=============>................] - ETA: 0s - loss: 0.1932 - acc: 0.9219
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1982 - acc: 0.9206
1728/2995 [================>.............] - ETA: 0s - loss: 0.1956 - acc: 0.9225
1856/2995 [=================>............] - ETA: 0s - loss: 0.1997 - acc: 0.9192
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2015 - acc: 0.9189
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2012 - acc: 0.9186
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2005 - acc: 0.9187
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1994 - acc: 0.9193
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1966 - acc: 0.9207
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1952 - acc: 0.9207
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1948 - acc: 0.9211
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1966 - acc: 0.9205
2995/2995 [==============================] - 2s 531us/step - loss: 0.1990 - acc: 0.9189

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  167

choose_one :  166

F1score :  0.9036144578313253

AUC :  0.9526729673183753

Confusion Matrix
[[151  16]
 [ 16 150]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'acc': [0.9188647747437823], 'loss': [0.19900550786063748]}
Saved model to disk


[[86.18618618618619, 1], [86.18618618618619, 2], [87.98798798798799, 3], [88.58858858858859, 4], [87.08708708708708, 5], [87.68768768768768, 6], [86.78678678678679, 7], [89.4894894894895, 8], [88.88888888888889, 9], [88.58858858858859, 10], [88.88888888888889, 11], [90.09009009009009, 12], [90.09009009009009, 13], [88.28828828828829, 14], [90.39039039039038, 15]]
max accuracy :  [90.39039039039038, 15]

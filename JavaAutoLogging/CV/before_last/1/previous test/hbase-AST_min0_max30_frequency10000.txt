Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 16:04:37.070804: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 16:04:37.083121: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 16:04:37.084966: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6042760 executing computations on platform Host. Devices:
2019-09-07 16:04:37.084990: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 30 : 11721
Over 30, Under 100 : 10544
Over 100, Under 150 : 2139
Over 150, Under 200 : 1071
Over 200, Under 400 : 1121
Over 400 : 180

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 9

Under 10 : 1925
Over 10, Under 30 : 1038
Over 30, Under 100 : 23
Over 100, Under 150 : 3
Over 150, Under 200 : 1
Over 200, Under 400 : 3
Over 400 : 2


Sentence length Average : 8

Under 10 : 214
Over 10, Under 30 : 116
Over 30, Under 100 : 2
Over 100, Under 150 : 0
Over 150, Under 200 : 1
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:16 - loss: 0.6814 - acc: 0.5625
 128/2995 [>.............................] - ETA: 38s - loss: 0.6593 - acc: 0.5781 
 256/2995 [=>............................] - ETA: 19s - loss: 0.6388 - acc: 0.6289
 384/2995 [==>...........................] - ETA: 12s - loss: 0.6133 - acc: 0.6641
 512/2995 [====>.........................] - ETA: 9s - loss: 0.5948 - acc: 0.6934 
 640/2995 [=====>........................] - ETA: 7s - loss: 0.5956 - acc: 0.6984
 768/2995 [======>.......................] - ETA: 6s - loss: 0.5871 - acc: 0.7044
 896/2995 [=======>......................] - ETA: 5s - loss: 0.5807 - acc: 0.7098
1024/2995 [=========>....................] - ETA: 4s - loss: 0.5696 - acc: 0.7217
1152/2995 [==========>...................] - ETA: 3s - loss: 0.5615 - acc: 0.7309
1280/2995 [===========>..................] - ETA: 3s - loss: 0.5503 - acc: 0.7438
1408/2995 [=============>................] - ETA: 2s - loss: 0.5475 - acc: 0.7486
1536/2995 [==============>...............] - ETA: 2s - loss: 0.5474 - acc: 0.7487
1664/2995 [===============>..............] - ETA: 2s - loss: 0.5390 - acc: 0.7560
1792/2995 [================>.............] - ETA: 1s - loss: 0.5343 - acc: 0.7584
1920/2995 [==================>...........] - ETA: 1s - loss: 0.5304 - acc: 0.7625
2048/2995 [===================>..........] - ETA: 1s - loss: 0.5221 - acc: 0.7705
2176/2995 [====================>.........] - ETA: 1s - loss: 0.5112 - acc: 0.7780
2304/2995 [======================>.......] - ETA: 0s - loss: 0.5087 - acc: 0.7799
2432/2995 [=======================>......] - ETA: 0s - loss: 0.5054 - acc: 0.7812
2560/2995 [========================>.....] - ETA: 0s - loss: 0.5041 - acc: 0.7820
2688/2995 [=========================>....] - ETA: 0s - loss: 0.5003 - acc: 0.7842
2816/2995 [===========================>..] - ETA: 0s - loss: 0.4983 - acc: 0.7862
2944/2995 [============================>.] - ETA: 0s - loss: 0.4936 - acc: 0.7877
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4915 - acc: 0.7890

Test accuracy: 85.88588588588588

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  176

choose_one :  157

F1score :  0.8544891640866874

AUC :  0.9181155760767622

Confusion Matrix
[[148  19]
 [ 28 138]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.4914500841612808], 'acc': [0.7889816361994099]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3723 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.4016 - acc: 0.8490
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3895 - acc: 0.8500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3692 - acc: 0.8482
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3666 - acc: 0.8438
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3680 - acc: 0.8466
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3669 - acc: 0.8474
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3677 - acc: 0.8510
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3765 - acc: 0.8483
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3723 - acc: 0.8503
1344/2995 [============>.................] - ETA: 0s - loss: 0.3676 - acc: 0.8519
1472/2995 [=============>................] - ETA: 0s - loss: 0.3698 - acc: 0.8478
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3718 - acc: 0.8462
1728/2995 [================>.............] - ETA: 0s - loss: 0.3715 - acc: 0.8461
1856/2995 [=================>............] - ETA: 0s - loss: 0.3660 - acc: 0.8491
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3644 - acc: 0.8508
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3667 - acc: 0.8499
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3676 - acc: 0.8487
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3733 - acc: 0.8467
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3772 - acc: 0.8454
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3810 - acc: 0.8445
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3771 - acc: 0.8467
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3743 - acc: 0.8479
2995/2995 [==============================] - 2s 539us/step - loss: 0.3695 - acc: 0.8504

Test accuracy: 85.28528528528528

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  194

choose_one :  139

F1score :  0.839344262295082

AUC :  0.9415446216001732

Confusion Matrix
[[156  11]
 [ 38 128]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.2289156626506024  
0.7710843373493976  

Train_result {'loss': [0.3694729922410841], 'acc': [0.8504173623500563]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3312 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3676 - acc: 0.8385
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3464 - acc: 0.8438
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3562 - acc: 0.8438
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3396 - acc: 0.8559
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3398 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3488 - acc: 0.8486
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3453 - acc: 0.8500
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3455 - acc: 0.8511
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3532 - acc: 0.8479
1344/2995 [============>.................] - ETA: 0s - loss: 0.3515 - acc: 0.8482
1472/2995 [=============>................] - ETA: 0s - loss: 0.3545 - acc: 0.8485
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3542 - acc: 0.8481
1728/2995 [================>.............] - ETA: 0s - loss: 0.3561 - acc: 0.8466
1856/2995 [=================>............] - ETA: 0s - loss: 0.3546 - acc: 0.8470
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3544 - acc: 0.8473
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3531 - acc: 0.8499
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3539 - acc: 0.8500
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3517 - acc: 0.8514
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3450 - acc: 0.8558
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3438 - acc: 0.8567
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3448 - acc: 0.8554
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3453 - acc: 0.8556
2995/2995 [==============================] - 2s 539us/step - loss: 0.3441 - acc: 0.8554

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.8882175226586103

AUC :  0.9491919774908016

Confusion Matrix
[[149  18]
 [ 19 147]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.34414264306003145], 'acc': [0.8554257097347749]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4545 - acc: 0.7656
 192/2995 [>.............................] - ETA: 1s - loss: 0.3233 - acc: 0.8542
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3222 - acc: 0.8500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3326 - acc: 0.8549
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3186 - acc: 0.8628
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3264 - acc: 0.8523
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3379 - acc: 0.8510
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3420 - acc: 0.8500
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3324 - acc: 0.8548
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3291 - acc: 0.8561
1344/2995 [============>.................] - ETA: 0s - loss: 0.3306 - acc: 0.8534
1472/2995 [=============>................] - ETA: 0s - loss: 0.3352 - acc: 0.8505
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3284 - acc: 0.8544
1728/2995 [================>.............] - ETA: 0s - loss: 0.3276 - acc: 0.8547
1856/2995 [=================>............] - ETA: 0s - loss: 0.3211 - acc: 0.8588
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3214 - acc: 0.8604
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3206 - acc: 0.8598
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3154 - acc: 0.8629
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3147 - acc: 0.8632
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3153 - acc: 0.8638
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3147 - acc: 0.8647
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3099 - acc: 0.8666
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3096 - acc: 0.8667
2995/2995 [==============================] - 2s 547us/step - loss: 0.3145 - acc: 0.8638

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  147

choose_one :  186

F1score :  0.8920454545454547

AUC :  0.9534665608541952

Confusion Matrix
[[138  29]
 [  9 157]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.31449409517302535], 'acc': [0.8637729551039872]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2786 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2989 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3086 - acc: 0.8500
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2953 - acc: 0.8571
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3056 - acc: 0.8576
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3164 - acc: 0.8551
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3123 - acc: 0.8618
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3160 - acc: 0.8635
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3213 - acc: 0.8612
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3238 - acc: 0.8610
1344/2995 [============>.................] - ETA: 0s - loss: 0.3282 - acc: 0.8594
1472/2995 [=============>................] - ETA: 0s - loss: 0.3282 - acc: 0.8594
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3220 - acc: 0.8631
1728/2995 [================>.............] - ETA: 0s - loss: 0.3238 - acc: 0.8634
1856/2995 [=================>............] - ETA: 0s - loss: 0.3225 - acc: 0.8637
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3211 - acc: 0.8639
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3214 - acc: 0.8632
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3182 - acc: 0.8647
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3204 - acc: 0.8628
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3190 - acc: 0.8634
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3181 - acc: 0.8647
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3148 - acc: 0.8659
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3160 - acc: 0.8656
2995/2995 [==============================] - 2s 535us/step - loss: 0.3137 - acc: 0.8661

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  189

choose_one :  144

F1score :  0.8516129032258064

AUC :  0.9470817401341896

Confusion Matrix
[[155  12]
 [ 34 132]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.20481927710843373  
0.7951807228915663  

Train_result {'loss': [0.31367692484182985], 'acc': [0.8661101837588073]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2612 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3055 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2795 - acc: 0.8812
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3198 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3180 - acc: 0.8663
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3223 - acc: 0.8651
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3200 - acc: 0.8654
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3250 - acc: 0.8646
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3183 - acc: 0.8667
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3162 - acc: 0.8701
1344/2995 [============>.................] - ETA: 0s - loss: 0.3099 - acc: 0.8735
1472/2995 [=============>................] - ETA: 0s - loss: 0.3041 - acc: 0.8750
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3022 - acc: 0.8738
1728/2995 [================>.............] - ETA: 0s - loss: 0.3044 - acc: 0.8727
1856/2995 [=================>............] - ETA: 0s - loss: 0.2997 - acc: 0.8750
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3034 - acc: 0.8745
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2995 - acc: 0.8755
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2959 - acc: 0.8786
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2946 - acc: 0.8792
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2963 - acc: 0.8790
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2945 - acc: 0.8780
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2958 - acc: 0.8772
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2973 - acc: 0.8757
2995/2995 [==============================] - 2s 527us/step - loss: 0.2978 - acc: 0.8755

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  143

choose_one :  190

F1score :  0.898876404494382

AUC :  0.9526008224514827

Confusion Matrix
[[137  30]
 [  6 160]]
True label 0
0.8203592814371258  
0.17964071856287425  
True label 1
0.03614457831325301  
0.963855421686747  

Train_result {'loss': [0.29779719455612325], 'acc': [0.8754590986368055]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2898 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2714 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2594 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2818 - acc: 0.8951
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2719 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2688 - acc: 0.8977
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2676 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2744 - acc: 0.8906
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2766 - acc: 0.8879
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2837 - acc: 0.8873
1344/2995 [============>.................] - ETA: 0s - loss: 0.2812 - acc: 0.8906
1472/2995 [=============>................] - ETA: 0s - loss: 0.2886 - acc: 0.8859
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2858 - acc: 0.8869
1728/2995 [================>.............] - ETA: 0s - loss: 0.2843 - acc: 0.8877
1856/2995 [=================>............] - ETA: 0s - loss: 0.2824 - acc: 0.8879
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2815 - acc: 0.8876
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2854 - acc: 0.8849
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2883 - acc: 0.8826
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2882 - acc: 0.8822
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2877 - acc: 0.8826
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2851 - acc: 0.8834
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2899 - acc: 0.8808
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2881 - acc: 0.8816
2995/2995 [==============================] - 2s 541us/step - loss: 0.2906 - acc: 0.8811

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  183

choose_one :  150

F1score :  0.8734177215189873

AUC :  0.9515006132313687

Confusion Matrix
[[155  12]
 [ 28 138]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.2906420172255903], 'acc': [0.8811352255547384]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2499 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2599 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2308 - acc: 0.8906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2532 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2522 - acc: 0.8906
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2515 - acc: 0.8906
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2631 - acc: 0.8858
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2582 - acc: 0.8896
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2511 - acc: 0.8971
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2610 - acc: 0.8947
1344/2995 [============>.................] - ETA: 0s - loss: 0.2639 - acc: 0.8943
1472/2995 [=============>................] - ETA: 0s - loss: 0.2622 - acc: 0.8954
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2689 - acc: 0.8950
1728/2995 [================>.............] - ETA: 0s - loss: 0.2741 - acc: 0.8906
1856/2995 [=================>............] - ETA: 0s - loss: 0.2749 - acc: 0.8912
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2761 - acc: 0.8896
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2784 - acc: 0.8878
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2788 - acc: 0.8871
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2818 - acc: 0.8851
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2804 - acc: 0.8870
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2801 - acc: 0.8872
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2860 - acc: 0.8830
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2863 - acc: 0.8823
2995/2995 [==============================] - 2s 551us/step - loss: 0.2886 - acc: 0.8811

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.8882175226586103

AUC :  0.9505266575283169

Confusion Matrix
[[149  18]
 [ 19 147]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.2885793413761661], 'acc': [0.881135225475133]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1880 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2921 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2667 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2712 - acc: 0.8951
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2747 - acc: 0.8906
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2774 - acc: 0.8920
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2751 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2860 - acc: 0.8885
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2787 - acc: 0.8906
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2778 - acc: 0.8898
1344/2995 [============>.................] - ETA: 0s - loss: 0.2798 - acc: 0.8869
1472/2995 [=============>................] - ETA: 0s - loss: 0.2787 - acc: 0.8893
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2706 - acc: 0.8919
1728/2995 [================>.............] - ETA: 0s - loss: 0.2754 - acc: 0.8895
1856/2995 [=================>............] - ETA: 0s - loss: 0.2743 - acc: 0.8917
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2706 - acc: 0.8921
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2749 - acc: 0.8902
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2792 - acc: 0.8888
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2820 - acc: 0.8877
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2833 - acc: 0.8882
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2819 - acc: 0.8891
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2818 - acc: 0.8884
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2819 - acc: 0.8885
2995/2995 [==============================] - 2s 536us/step - loss: 0.2840 - acc: 0.8858

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  158

choose_one :  175

F1score :  0.9032258064516129

AUC :  0.9535026332876416

Confusion Matrix
[[146  21]
 [ 12 154]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.07228915662650602  
0.927710843373494  

Train_result {'loss': [0.2839527314115247], 'acc': [0.8858096829837869]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2385 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2975 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2860 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2872 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2683 - acc: 0.8854
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2528 - acc: 0.8935
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2741 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2722 - acc: 0.8917
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2878 - acc: 0.8824
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2860 - acc: 0.8816
1344/2995 [============>.................] - ETA: 0s - loss: 0.2814 - acc: 0.8817
1472/2995 [=============>................] - ETA: 0s - loss: 0.2782 - acc: 0.8818
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2798 - acc: 0.8788
1728/2995 [================>.............] - ETA: 0s - loss: 0.2733 - acc: 0.8825
1856/2995 [=================>............] - ETA: 0s - loss: 0.2779 - acc: 0.8809
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2795 - acc: 0.8816
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2764 - acc: 0.8821
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2747 - acc: 0.8835
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2732 - acc: 0.8830
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2700 - acc: 0.8850
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2740 - acc: 0.8830
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2731 - acc: 0.8841
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2741 - acc: 0.8851
2995/2995 [==============================] - 2s 530us/step - loss: 0.2735 - acc: 0.8861

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  193

choose_one :  140

F1score :  0.8496732026143791

AUC :  0.9519515186494482

Confusion Matrix
[[157  10]
 [ 36 130]]
True label 0
0.9401197604790419  
0.059880239520958084  
True label 1
0.21686746987951808  
0.7831325301204819  

Train_result {'loss': [0.27350705782937285], 'acc': [0.886143572720542]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3921 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2975 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2933 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2770 - acc: 0.8750
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2775 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2705 - acc: 0.8849
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2677 - acc: 0.8834
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2600 - acc: 0.8896
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2640 - acc: 0.8869
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2659 - acc: 0.8865
1344/2995 [============>.................] - ETA: 0s - loss: 0.2605 - acc: 0.8906
1472/2995 [=============>................] - ETA: 0s - loss: 0.2644 - acc: 0.8886
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2639 - acc: 0.8881
1728/2995 [================>.............] - ETA: 0s - loss: 0.2721 - acc: 0.8866
1856/2995 [=================>............] - ETA: 0s - loss: 0.2705 - acc: 0.8885
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2732 - acc: 0.8861
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2737 - acc: 0.8864
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2698 - acc: 0.8879
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2690 - acc: 0.8877
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2685 - acc: 0.8878
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2680 - acc: 0.8891
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2710 - acc: 0.8874
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2725 - acc: 0.8872
2995/2995 [==============================] - 2s 519us/step - loss: 0.2703 - acc: 0.8871

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8714733542319748

AUC :  0.9536649592381502

Confusion Matrix
[[153  14]
 [ 27 139]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.27026276176481295], 'acc': [0.8871452422094266]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2828 - acc: 0.8750
 192/2995 [>.............................] - ETA: 2s - loss: 0.2348 - acc: 0.8906
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2297 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2240 - acc: 0.8973
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2094 - acc: 0.9045
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2219 - acc: 0.8991
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2267 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2385 - acc: 0.8958
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2310 - acc: 0.8998
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2332 - acc: 0.9005
1344/2995 [============>.................] - ETA: 0s - loss: 0.2362 - acc: 0.8981
1472/2995 [=============>................] - ETA: 0s - loss: 0.2430 - acc: 0.8954
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2524 - acc: 0.8888
1728/2995 [================>.............] - ETA: 0s - loss: 0.2503 - acc: 0.8900
1856/2995 [=================>............] - ETA: 0s - loss: 0.2473 - acc: 0.8933
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2497 - acc: 0.8942
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2502 - acc: 0.8930
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2572 - acc: 0.8920
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2628 - acc: 0.8898
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2623 - acc: 0.8898
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2613 - acc: 0.8906
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2626 - acc: 0.8917
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2619 - acc: 0.8920
2995/2995 [==============================] - 2s 527us/step - loss: 0.2642 - acc: 0.8902

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  140

choose_one :  193

F1score :  0.8913649025069638

AUC :  0.9502200418440228

Confusion Matrix
[[134  33]
 [  6 160]]
True label 0
0.8023952095808383  
0.19760479041916168  
True label 1
0.03614457831325301  
0.963855421686747  

Train_result {'loss': [0.2642354498821029], 'acc': [0.8901502504969678]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2562 - acc: 0.8750
 192/2995 [>.............................] - ETA: 2s - loss: 0.2891 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2599 - acc: 0.8844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2482 - acc: 0.8973
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2472 - acc: 0.8941
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2483 - acc: 0.8920
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2471 - acc: 0.8894
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2418 - acc: 0.8917
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2400 - acc: 0.8943
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2401 - acc: 0.8939
1344/2995 [============>.................] - ETA: 1s - loss: 0.2377 - acc: 0.8951
1472/2995 [=============>................] - ETA: 0s - loss: 0.2340 - acc: 0.8961
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2364 - acc: 0.8969
1728/2995 [================>.............] - ETA: 0s - loss: 0.2376 - acc: 0.8970
1856/2995 [=================>............] - ETA: 0s - loss: 0.2379 - acc: 0.8960
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2448 - acc: 0.8931
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2488 - acc: 0.8902
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2484 - acc: 0.8897
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2516 - acc: 0.8881
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2569 - acc: 0.8862
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2661 - acc: 0.8815
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2666 - acc: 0.8823
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2644 - acc: 0.8830
2995/2995 [==============================] - 2s 562us/step - loss: 0.2677 - acc: 0.8811

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  158

choose_one :  175

F1score :  0.9032258064516129

AUC :  0.9501478969771301

Confusion Matrix
[[146  21]
 [ 12 154]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.07228915662650602  
0.927710843373494  

Train_result {'loss': [0.2677150941949854], 'acc': [0.8811352255547384]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1235 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.2858 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2895 - acc: 0.8781
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2993 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2802 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2777 - acc: 0.8793
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2910 - acc: 0.8726
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2825 - acc: 0.8771
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2861 - acc: 0.8778
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2804 - acc: 0.8849
1344/2995 [============>.................] - ETA: 0s - loss: 0.2838 - acc: 0.8824
1472/2995 [=============>................] - ETA: 0s - loss: 0.2829 - acc: 0.8818
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2775 - acc: 0.8844
1728/2995 [================>.............] - ETA: 0s - loss: 0.2756 - acc: 0.8866
1856/2995 [=================>............] - ETA: 0s - loss: 0.2740 - acc: 0.8874
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2692 - acc: 0.8886
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2650 - acc: 0.8897
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2622 - acc: 0.8920
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2611 - acc: 0.8927
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2639 - acc: 0.8918
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2648 - acc: 0.8902
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2666 - acc: 0.8884
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2650 - acc: 0.8882
2995/2995 [==============================] - 2s 532us/step - loss: 0.2647 - acc: 0.8895

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.9053254437869822

AUC :  0.9488673255897844

Confusion Matrix
[[148  19]
 [ 13 153]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.0783132530120482  
0.9216867469879518  

Train_result {'loss': [0.2647025103959098], 'acc': [0.889482470884148]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2529 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2500 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2283 - acc: 0.9000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2390 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2637 - acc: 0.8924
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2591 - acc: 0.8977
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2519 - acc: 0.8966
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2613 - acc: 0.8958
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2568 - acc: 0.8980
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2534 - acc: 0.8980
1344/2995 [============>.................] - ETA: 0s - loss: 0.2580 - acc: 0.8966
1472/2995 [=============>................] - ETA: 0s - loss: 0.2513 - acc: 0.8974
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2612 - acc: 0.8944
1728/2995 [================>.............] - ETA: 0s - loss: 0.2587 - acc: 0.8964
1856/2995 [=================>............] - ETA: 0s - loss: 0.2618 - acc: 0.8928
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2634 - acc: 0.8931
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2644 - acc: 0.8911
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2610 - acc: 0.8924
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2610 - acc: 0.8919
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2598 - acc: 0.8926
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2595 - acc: 0.8925
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2576 - acc: 0.8928
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2626 - acc: 0.8913
2995/2995 [==============================] - 2s 548us/step - loss: 0.2641 - acc: 0.8908

Test accuracy: 87.08708708708708

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  182

choose_one :  151

F1score :  0.8643533123028392

AUC :  0.951951518649448

Confusion Matrix
[[153  14]
 [ 29 137]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.1746987951807229  
0.8253012048192772  

Train_result {'loss': [0.2641088682641967], 'acc': [0.8908180301694918]}
Saved model to disk


[[85.88588588588588, 1], [85.28528528528528, 2], [88.88888888888889, 3], [88.58858858858859, 4], [86.18618618618619, 5], [89.1891891891892, 6], [87.98798798798799, 7], [88.88888888888889, 8], [90.09009009009009, 9], [86.18618618618619, 10], [87.68768768768768, 11], [88.28828828828829, 12], [90.09009009009009, 13], [90.39039039039038, 14], [87.08708708708708, 15]]
max accuracy :  [90.39039039039038, 14]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 16:03:09.127954: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 16:03:09.139044: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 16:03:09.141415: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6c43b30 executing computations on platform Host. Devices:
2019-09-07 16:03:09.141483: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 51

Under 10 : 9474
Over 10, Under 30 : 18298
Over 30, Under 100 : 13980
Over 100, Under 150 : 2960
Over 150, Under 200 : 1491
Over 200, Under 400 : 1892
Over 400 : 375

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 14

Under 10 : 916
Over 10, Under 30 : 2079
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0


Sentence length Average : 14

Under 10 : 108
Over 10, Under 30 : 225
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:05 - loss: 0.7151 - acc: 0.5156
 192/2995 [>.............................] - ETA: 22s - loss: 0.7014 - acc: 0.5677 
 320/2995 [==>...........................] - ETA: 13s - loss: 0.6982 - acc: 0.5625
 448/2995 [===>..........................] - ETA: 9s - loss: 0.6818 - acc: 0.6049 
 576/2995 [====>.........................] - ETA: 7s - loss: 0.6686 - acc: 0.6163
 704/2995 [======>.......................] - ETA: 5s - loss: 0.6583 - acc: 0.6321
 832/2995 [=======>......................] - ETA: 4s - loss: 0.6450 - acc: 0.6442
 960/2995 [========>.....................] - ETA: 4s - loss: 0.6380 - acc: 0.6562
1088/2995 [=========>....................] - ETA: 3s - loss: 0.6284 - acc: 0.6618
1216/2995 [===========>..................] - ETA: 2s - loss: 0.6256 - acc: 0.6628
1344/2995 [============>.................] - ETA: 2s - loss: 0.6249 - acc: 0.6652
1472/2995 [=============>................] - ETA: 2s - loss: 0.6266 - acc: 0.6624
1600/2995 [===============>..............] - ETA: 1s - loss: 0.6200 - acc: 0.6700
1728/2995 [================>.............] - ETA: 1s - loss: 0.6125 - acc: 0.6788
1856/2995 [=================>............] - ETA: 1s - loss: 0.6044 - acc: 0.6864
1984/2995 [==================>...........] - ETA: 1s - loss: 0.6027 - acc: 0.6870
2112/2995 [====================>.........] - ETA: 1s - loss: 0.5966 - acc: 0.6918
2240/2995 [=====================>........] - ETA: 0s - loss: 0.5932 - acc: 0.6946
2368/2995 [======================>.......] - ETA: 0s - loss: 0.5932 - acc: 0.6947
2496/2995 [========================>.....] - ETA: 0s - loss: 0.5924 - acc: 0.6955
2624/2995 [=========================>....] - ETA: 0s - loss: 0.5920 - acc: 0.6974
2752/2995 [==========================>...] - ETA: 0s - loss: 0.5892 - acc: 0.7006
2880/2995 [===========================>..] - ETA: 0s - loss: 0.5892 - acc: 0.7017
2995/2995 [==============================] - 3s 973us/step - loss: 0.5880 - acc: 0.7028

Test accuracy: 78.97897897897897

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  151

choose_one :  182

F1score :  0.7988505747126436

AUC :  0.8682634730538922

Confusion Matrix
[[124  43]
 [ 27 139]]
True label 0
0.7425149700598802  
0.25748502994011974  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.5880220347732454], 'acc': [0.7028380636181776]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.5607 - acc: 0.7656
 192/2995 [>.............................] - ETA: 1s - loss: 0.5626 - acc: 0.7083
 320/2995 [==>...........................] - ETA: 1s - loss: 0.5598 - acc: 0.7188
 448/2995 [===>..........................] - ETA: 1s - loss: 0.5432 - acc: 0.7411
 576/2995 [====>.........................] - ETA: 1s - loss: 0.5360 - acc: 0.7500
 704/2995 [======>.......................] - ETA: 1s - loss: 0.5278 - acc: 0.7500
 832/2995 [=======>......................] - ETA: 1s - loss: 0.5270 - acc: 0.7500
 960/2995 [========>.....................] - ETA: 1s - loss: 0.5270 - acc: 0.7479
1088/2995 [=========>....................] - ETA: 1s - loss: 0.5234 - acc: 0.7436
1216/2995 [===========>..................] - ETA: 1s - loss: 0.5176 - acc: 0.7500
1344/2995 [============>.................] - ETA: 0s - loss: 0.5174 - acc: 0.7530
1472/2995 [=============>................] - ETA: 0s - loss: 0.5195 - acc: 0.7514
1600/2995 [===============>..............] - ETA: 0s - loss: 0.5204 - acc: 0.7538
1728/2995 [================>.............] - ETA: 0s - loss: 0.5182 - acc: 0.7569
1856/2995 [=================>............] - ETA: 0s - loss: 0.5114 - acc: 0.7592
1984/2995 [==================>...........] - ETA: 0s - loss: 0.5149 - acc: 0.7576
2112/2995 [====================>.........] - ETA: 0s - loss: 0.5171 - acc: 0.7543
2240/2995 [=====================>........] - ETA: 0s - loss: 0.5154 - acc: 0.7549
2368/2995 [======================>.......] - ETA: 0s - loss: 0.5183 - acc: 0.7546
2496/2995 [========================>.....] - ETA: 0s - loss: 0.5179 - acc: 0.7540
2624/2995 [=========================>....] - ETA: 0s - loss: 0.5142 - acc: 0.7569
2752/2995 [==========================>...] - ETA: 0s - loss: 0.5125 - acc: 0.7587
2880/2995 [===========================>..] - ETA: 0s - loss: 0.5091 - acc: 0.7590
2995/2995 [==============================] - 2s 548us/step - loss: 0.5074 - acc: 0.7606

Test accuracy: 81.08108108108108

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  172

choose_one :  161

F1score :  0.8073394495412844

AUC :  0.884550176754924

Confusion Matrix
[[138  29]
 [ 34 132]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.20481927710843373  
0.7951807228915663  

Train_result {'loss': [0.5073677032837685], 'acc': [0.7606010018485615]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.5075 - acc: 0.7344
 192/2995 [>.............................] - ETA: 1s - loss: 0.4886 - acc: 0.7656
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4694 - acc: 0.7844
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4842 - acc: 0.7768
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4712 - acc: 0.7865
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4809 - acc: 0.7827
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4944 - acc: 0.7668
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4874 - acc: 0.7688
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4905 - acc: 0.7730
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4931 - acc: 0.7681
1344/2995 [============>.................] - ETA: 0s - loss: 0.4861 - acc: 0.7738
1472/2995 [=============>................] - ETA: 0s - loss: 0.4930 - acc: 0.7677
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4889 - acc: 0.7706
1728/2995 [================>.............] - ETA: 0s - loss: 0.4903 - acc: 0.7691
1856/2995 [=================>............] - ETA: 0s - loss: 0.4879 - acc: 0.7705
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4897 - acc: 0.7707
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4899 - acc: 0.7689
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4883 - acc: 0.7701
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4857 - acc: 0.7724
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4812 - acc: 0.7756
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4851 - acc: 0.7732
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4868 - acc: 0.7703
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4808 - acc: 0.7750
2995/2995 [==============================] - 2s 552us/step - loss: 0.4810 - acc: 0.7750

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  177

choose_one :  156

F1score :  0.8322981366459627

AUC :  0.895462087872448

Confusion Matrix
[[145  22]
 [ 32 134]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.48097437124618503], 'acc': [0.7749582640316729]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.5067 - acc: 0.7188
 192/2995 [>.............................] - ETA: 1s - loss: 0.4261 - acc: 0.7812
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4517 - acc: 0.7906
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4590 - acc: 0.7857
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4455 - acc: 0.7986
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4522 - acc: 0.7912
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4529 - acc: 0.7897
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4612 - acc: 0.7854
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4584 - acc: 0.7877
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4506 - acc: 0.7928
1344/2995 [============>.................] - ETA: 0s - loss: 0.4503 - acc: 0.7969
1472/2995 [=============>................] - ETA: 0s - loss: 0.4524 - acc: 0.7942
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4511 - acc: 0.7981
1728/2995 [================>.............] - ETA: 0s - loss: 0.4497 - acc: 0.7963
1856/2995 [=================>............] - ETA: 0s - loss: 0.4449 - acc: 0.8006
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4467 - acc: 0.8019
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4487 - acc: 0.8011
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4496 - acc: 0.8009
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4508 - acc: 0.8007
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4486 - acc: 0.8017
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4481 - acc: 0.8026
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4489 - acc: 0.8016
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4496 - acc: 0.7993
2995/2995 [==============================] - 2s 530us/step - loss: 0.4526 - acc: 0.7970

Test accuracy: 84.68468468468468

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  168

choose_one :  165

F1score :  0.8459214501510575

AUC :  0.8976444700959528

Confusion Matrix
[[142  25]
 [ 26 140]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.1566265060240964  
0.8433734939759037  

Train_result {'loss': [0.4526304259324114], 'acc': [0.7969949918517685]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.5052 - acc: 0.7344
 192/2995 [>.............................] - ETA: 1s - loss: 0.4584 - acc: 0.7500
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4992 - acc: 0.7375
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4798 - acc: 0.7567
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4743 - acc: 0.7708
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4904 - acc: 0.7571
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4880 - acc: 0.7620
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4769 - acc: 0.7750
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4687 - acc: 0.7822
1216/2995 [===========>..................] - ETA: 0s - loss: 0.4653 - acc: 0.7829
1344/2995 [============>.................] - ETA: 0s - loss: 0.4614 - acc: 0.7857
1472/2995 [=============>................] - ETA: 0s - loss: 0.4579 - acc: 0.7894
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4541 - acc: 0.7913
1728/2995 [================>.............] - ETA: 0s - loss: 0.4530 - acc: 0.7928
1856/2995 [=================>............] - ETA: 0s - loss: 0.4551 - acc: 0.7931
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4540 - acc: 0.7913
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4549 - acc: 0.7921
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4531 - acc: 0.7933
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4515 - acc: 0.7948
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4520 - acc: 0.7945
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4483 - acc: 0.7976
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4455 - acc: 0.7994
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4469 - acc: 0.7983
2995/2995 [==============================] - 2s 526us/step - loss: 0.4454 - acc: 0.7973

Test accuracy: 82.28228228228228

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  176

choose_one :  157

F1score :  0.8173374613003096

AUC :  0.9004040112545995

Confusion Matrix
[[142  25]
 [ 34 132]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.20481927710843373  
0.7951807228915663  

Train_result {'loss': [0.4453628692981198], 'acc': [0.7973288815885234]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4377 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.3792 - acc: 0.8229
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4199 - acc: 0.8031
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4276 - acc: 0.8080
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4371 - acc: 0.7899
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4477 - acc: 0.7812
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4543 - acc: 0.7800
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4543 - acc: 0.7812
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4482 - acc: 0.7831
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4423 - acc: 0.7845
1344/2995 [============>.................] - ETA: 0s - loss: 0.4368 - acc: 0.7894
1472/2995 [=============>................] - ETA: 0s - loss: 0.4333 - acc: 0.7942
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4301 - acc: 0.7963
1728/2995 [================>.............] - ETA: 0s - loss: 0.4367 - acc: 0.7951
1856/2995 [=================>............] - ETA: 0s - loss: 0.4304 - acc: 0.8017
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4301 - acc: 0.8029
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4300 - acc: 0.8026
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4287 - acc: 0.8018
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4225 - acc: 0.8049
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4248 - acc: 0.8049
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4254 - acc: 0.8037
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4292 - acc: 0.8016
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4294 - acc: 0.8031
2995/2995 [==============================] - 2s 529us/step - loss: 0.4301 - acc: 0.8030

Test accuracy: 80.18018018018019

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  139

choose_one :  194

F1score :  0.8166666666666668

AUC :  0.9083219103960752

Confusion Matrix
[[120  47]
 [ 19 147]]
True label 0
0.718562874251497  
0.281437125748503  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.4301101354505861], 'acc': [0.8030050085263578]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3350 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3896 - acc: 0.8073
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3740 - acc: 0.8281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3962 - acc: 0.8170
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3803 - acc: 0.8247
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3738 - acc: 0.8295
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3847 - acc: 0.8173
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4051 - acc: 0.8094
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4115 - acc: 0.8097
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4084 - acc: 0.8133
1344/2995 [============>.................] - ETA: 0s - loss: 0.4053 - acc: 0.8162
1472/2995 [=============>................] - ETA: 0s - loss: 0.4116 - acc: 0.8125
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4108 - acc: 0.8131
1728/2995 [================>.............] - ETA: 0s - loss: 0.4074 - acc: 0.8148
1856/2995 [=================>............] - ETA: 0s - loss: 0.4081 - acc: 0.8147
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4063 - acc: 0.8140
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4101 - acc: 0.8116
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4144 - acc: 0.8085
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4146 - acc: 0.8087
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4149 - acc: 0.8101
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4132 - acc: 0.8114
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4157 - acc: 0.8100
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4183 - acc: 0.8083
2995/2995 [==============================] - 2s 531us/step - loss: 0.4192 - acc: 0.8080

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  189

choose_one :  144

F1score :  0.8258064516129032

AUC :  0.9030914075463531

Confusion Matrix
[[151  16]
 [ 38 128]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.2289156626506024  
0.7710843373493976  

Train_result {'loss': [0.4192207970782393], 'acc': [0.808013355831471]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4257 - acc: 0.7500
 192/2995 [>.............................] - ETA: 1s - loss: 0.4114 - acc: 0.8073
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4018 - acc: 0.8219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3951 - acc: 0.8170
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3979 - acc: 0.8142
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3968 - acc: 0.8182
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3869 - acc: 0.8269
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3904 - acc: 0.8260
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3911 - acc: 0.8254
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3910 - acc: 0.8265
1344/2995 [============>.................] - ETA: 0s - loss: 0.3921 - acc: 0.8244
1472/2995 [=============>................] - ETA: 0s - loss: 0.3953 - acc: 0.8213
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3942 - acc: 0.8231
1728/2995 [================>.............] - ETA: 0s - loss: 0.3973 - acc: 0.8206
1856/2995 [=================>............] - ETA: 0s - loss: 0.3991 - acc: 0.8200
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3974 - acc: 0.8226
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4041 - acc: 0.8210
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4041 - acc: 0.8192
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4042 - acc: 0.8205
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4022 - acc: 0.8213
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4054 - acc: 0.8201
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4095 - acc: 0.8172
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4112 - acc: 0.8156
2995/2995 [==============================] - 2s 535us/step - loss: 0.4116 - acc: 0.8160

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  179

choose_one :  154

F1score :  0.83125

AUC :  0.9041375081162976

Confusion Matrix
[[146  21]
 [ 33 133]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.4116264682878835], 'acc': [0.8160267112848157]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3674 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3711 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3742 - acc: 0.8438
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3822 - acc: 0.8304
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3708 - acc: 0.8385
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3811 - acc: 0.8267
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3808 - acc: 0.8233
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3923 - acc: 0.8115
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3942 - acc: 0.8116
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3939 - acc: 0.8150
1344/2995 [============>.................] - ETA: 0s - loss: 0.3895 - acc: 0.8192
1472/2995 [=============>................] - ETA: 0s - loss: 0.3914 - acc: 0.8186
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3911 - acc: 0.8169
1728/2995 [================>.............] - ETA: 0s - loss: 0.3905 - acc: 0.8171
1856/2995 [=================>............] - ETA: 0s - loss: 0.3942 - acc: 0.8173
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3883 - acc: 0.8226
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3917 - acc: 0.8205
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3923 - acc: 0.8210
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3925 - acc: 0.8197
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3936 - acc: 0.8205
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3949 - acc: 0.8194
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3938 - acc: 0.8209
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3943 - acc: 0.8215
2995/2995 [==============================] - 2s 529us/step - loss: 0.3946 - acc: 0.8210

Test accuracy: 81.98198198198197

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  139

choose_one :  194

F1score :  0.8333333333333334

AUC :  0.9091335401486185

Confusion Matrix
[[123  44]
 [ 16 150]]
True label 0
0.7365269461077845  
0.2634730538922156  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.394645214518641], 'acc': [0.8210350586695345]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3199 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.3653 - acc: 0.8021
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3824 - acc: 0.8000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3892 - acc: 0.8058
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3931 - acc: 0.8108
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3846 - acc: 0.8224
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3831 - acc: 0.8281
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3872 - acc: 0.8281
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3933 - acc: 0.8254
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3942 - acc: 0.8207
1344/2995 [============>.................] - ETA: 0s - loss: 0.3854 - acc: 0.8259
1472/2995 [=============>................] - ETA: 0s - loss: 0.3857 - acc: 0.8281
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3840 - acc: 0.8256
1728/2995 [================>.............] - ETA: 0s - loss: 0.3777 - acc: 0.8293
1856/2995 [=================>............] - ETA: 0s - loss: 0.3788 - acc: 0.8303
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3851 - acc: 0.8281
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3886 - acc: 0.8262
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3909 - acc: 0.8232
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3897 - acc: 0.8247
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3879 - acc: 0.8257
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3908 - acc: 0.8251
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3914 - acc: 0.8249
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3925 - acc: 0.8236
2995/2995 [==============================] - 2s 531us/step - loss: 0.3920 - acc: 0.8247

Test accuracy: 78.97897897897897

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  195

choose_one :  138

F1score :  0.769736842105263

AUC :  0.8756943943438426

Confusion Matrix
[[146  21]
 [ 49 117]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.29518072289156627  
0.7048192771084337  

Train_result {'loss': [0.39196930770483956], 'acc': [0.8247078465499942]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4521 - acc: 0.7812
 192/2995 [>.............................] - ETA: 1s - loss: 0.4202 - acc: 0.8073
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4280 - acc: 0.8000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4155 - acc: 0.8147
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4127 - acc: 0.8125
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3949 - acc: 0.8295
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3961 - acc: 0.8257
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3857 - acc: 0.8333
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3946 - acc: 0.8254
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4027 - acc: 0.8183
1344/2995 [============>.................] - ETA: 0s - loss: 0.3943 - acc: 0.8207
1472/2995 [=============>................] - ETA: 0s - loss: 0.3882 - acc: 0.8227
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3836 - acc: 0.8263
1728/2995 [================>.............] - ETA: 0s - loss: 0.3839 - acc: 0.8299
1856/2995 [=================>............] - ETA: 0s - loss: 0.3848 - acc: 0.8297
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3866 - acc: 0.8286
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3861 - acc: 0.8281
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3840 - acc: 0.8290
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3863 - acc: 0.8277
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3852 - acc: 0.8273
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3866 - acc: 0.8255
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3909 - acc: 0.8230
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3917 - acc: 0.8233
2995/2995 [==============================] - 2s 537us/step - loss: 0.3888 - acc: 0.8250

Test accuracy: 82.28228228228228

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  184

choose_one :  149

F1score :  0.8126984126984127

AUC :  0.902189596710194

Confusion Matrix
[[146  21]
 [ 38 128]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.2289156626506024  
0.7710843373493976  

Train_result {'loss': [0.38879759611191855], 'acc': [0.8250417363862561]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3707 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3590 - acc: 0.8542
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3608 - acc: 0.8594
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3542 - acc: 0.8482
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3326 - acc: 0.8559
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3317 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3437 - acc: 0.8522
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3591 - acc: 0.8479
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3578 - acc: 0.8502
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3658 - acc: 0.8454
1344/2995 [============>.................] - ETA: 0s - loss: 0.3637 - acc: 0.8438
1472/2995 [=============>................] - ETA: 0s - loss: 0.3642 - acc: 0.8390
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3702 - acc: 0.8356
1728/2995 [================>.............] - ETA: 0s - loss: 0.3654 - acc: 0.8403
1856/2995 [=================>............] - ETA: 0s - loss: 0.3615 - acc: 0.8421
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3655 - acc: 0.8407
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3677 - acc: 0.8400
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3683 - acc: 0.8388
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3725 - acc: 0.8370
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3762 - acc: 0.8321
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3749 - acc: 0.8327
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3737 - acc: 0.8328
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3761 - acc: 0.8299
2995/2995 [==============================] - 2s 539us/step - loss: 0.3749 - acc: 0.8307

Test accuracy: 82.88288288288288

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  138

choose_one :  195

F1score :  0.8421052631578947

AUC :  0.9137147391963062

Confusion Matrix
[[124  43]
 [ 14 152]]
True label 0
0.7425149700598802  
0.25748502994011974  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.37486830631361184], 'acc': [0.8307178632444849]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3340 - acc: 0.8125
 192/2995 [>.............................] - ETA: 1s - loss: 0.3929 - acc: 0.8021
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3686 - acc: 0.8281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3560 - acc: 0.8438
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3636 - acc: 0.8299
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3668 - acc: 0.8338
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3617 - acc: 0.8329
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3597 - acc: 0.8344
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3601 - acc: 0.8382
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3558 - acc: 0.8413
1344/2995 [============>.................] - ETA: 0s - loss: 0.3581 - acc: 0.8378
1472/2995 [=============>................] - ETA: 0s - loss: 0.3589 - acc: 0.8370
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3616 - acc: 0.8375
1728/2995 [================>.............] - ETA: 0s - loss: 0.3549 - acc: 0.8409
1856/2995 [=================>............] - ETA: 0s - loss: 0.3543 - acc: 0.8405
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3586 - acc: 0.8397
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3592 - acc: 0.8371
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3590 - acc: 0.8375
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3614 - acc: 0.8378
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3659 - acc: 0.8365
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3674 - acc: 0.8357
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3708 - acc: 0.8325
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3697 - acc: 0.8347
2995/2995 [==============================] - 2s 518us/step - loss: 0.3684 - acc: 0.8357

Test accuracy: 84.08408408408408

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8338557993730408

AUC :  0.917502344708174

Confusion Matrix
[[147  20]
 [ 33 133]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.3683907101468769], 'acc': [0.8357262104699926]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3297 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.4005 - acc: 0.8125
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3746 - acc: 0.8313
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3860 - acc: 0.8304
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3607 - acc: 0.8507
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3455 - acc: 0.8551
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3532 - acc: 0.8462
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3620 - acc: 0.8365
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3636 - acc: 0.8364
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3610 - acc: 0.8405
1344/2995 [============>.................] - ETA: 0s - loss: 0.3604 - acc: 0.8408
1472/2995 [=============>................] - ETA: 0s - loss: 0.3621 - acc: 0.8397
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3652 - acc: 0.8363
1728/2995 [================>.............] - ETA: 0s - loss: 0.3733 - acc: 0.8328
1856/2995 [=================>............] - ETA: 0s - loss: 0.3715 - acc: 0.8351
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3681 - acc: 0.8372
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3692 - acc: 0.8381
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3670 - acc: 0.8393
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3648 - acc: 0.8395
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3684 - acc: 0.8385
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3649 - acc: 0.8392
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3691 - acc: 0.8350
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3677 - acc: 0.8365
2995/2995 [==============================] - 2s 521us/step - loss: 0.3664 - acc: 0.8367

Test accuracy: 84.08408408408408

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  174

choose_one :  159

F1score :  0.8369230769230769

AUC :  0.9112618137219537

Confusion Matrix
[[144  23]
 [ 30 136]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.3663809407035974], 'acc': [0.8367278799588772]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2948 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.3649 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3554 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3637 - acc: 0.8616
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3674 - acc: 0.8542
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3623 - acc: 0.8608
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3481 - acc: 0.8570
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3628 - acc: 0.8542
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3655 - acc: 0.8557
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3627 - acc: 0.8544
1344/2995 [============>.................] - ETA: 0s - loss: 0.3749 - acc: 0.8452
1472/2995 [=============>................] - ETA: 0s - loss: 0.3737 - acc: 0.8451
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3721 - acc: 0.8425
1728/2995 [================>.............] - ETA: 0s - loss: 0.3692 - acc: 0.8455
1856/2995 [=================>............] - ETA: 0s - loss: 0.3709 - acc: 0.8443
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3718 - acc: 0.8443
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3727 - acc: 0.8428
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3758 - acc: 0.8411
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3770 - acc: 0.8412
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3715 - acc: 0.8442
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3697 - acc: 0.8445
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3688 - acc: 0.8448
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3665 - acc: 0.8455
2995/2995 [==============================] - 2s 544us/step - loss: 0.3680 - acc: 0.8441

Test accuracy: 84.08408408408408

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8338557993730408

AUC :  0.9120734434744967

Confusion Matrix
[[147  20]
 [ 33 133]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.3679722971828633], 'acc': [0.8440734559188104]}
Saved model to disk


[[78.97897897897897, 1], [81.08108108108108, 2], [83.78378378378379, 3], [84.68468468468468, 4], [82.28228228228228, 5], [80.18018018018019, 6], [83.78378378378379, 7], [83.78378378378379, 8], [81.98198198198197, 9], [78.97897897897897, 10], [82.28228228228228, 11], [82.88288288288288, 12], [84.08408408408408, 13], [84.08408408408408, 14], [84.08408408408408, 15]]
max accuracy :  [84.68468468468468, 4]

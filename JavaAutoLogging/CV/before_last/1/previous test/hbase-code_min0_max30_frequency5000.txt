Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:58:52.340096: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:58:52.350410: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:58:52.352948: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x73cb120 executing computations on platform Host. Devices:
2019-09-07 15:58:52.352986: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 51

Under 10 : 9474
Over 10, Under 30 : 18298
Over 30, Under 100 : 13980
Over 100, Under 150 : 2960
Over 150, Under 200 : 1491
Over 200, Under 400 : 1892
Over 400 : 375

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 14

Under 10 : 916
Over 10, Under 30 : 2079
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0


Sentence length Average : 14

Under 10 : 108
Over 10, Under 30 : 225
Over 30, Under 100 : 0
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:11 - loss: 0.6630 - acc: 0.6406
 192/2995 [>.............................] - ETA: 23s - loss: 0.6742 - acc: 0.6042 
 320/2995 [==>...........................] - ETA: 14s - loss: 0.6843 - acc: 0.5844
 448/2995 [===>..........................] - ETA: 10s - loss: 0.6705 - acc: 0.6004
 576/2995 [====>.........................] - ETA: 7s - loss: 0.6571 - acc: 0.6076 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.6438 - acc: 0.6250
 832/2995 [=======>......................] - ETA: 5s - loss: 0.6296 - acc: 0.6406
 960/2995 [========>.....................] - ETA: 4s - loss: 0.6171 - acc: 0.6562
1088/2995 [=========>....................] - ETA: 3s - loss: 0.6055 - acc: 0.6691
1216/2995 [===========>..................] - ETA: 3s - loss: 0.6029 - acc: 0.6711
1344/2995 [============>.................] - ETA: 2s - loss: 0.5985 - acc: 0.6734
1472/2995 [=============>................] - ETA: 2s - loss: 0.6004 - acc: 0.6739
1600/2995 [===============>..............] - ETA: 2s - loss: 0.5937 - acc: 0.6806
1728/2995 [================>.............] - ETA: 1s - loss: 0.5849 - acc: 0.6887
1856/2995 [=================>............] - ETA: 1s - loss: 0.5766 - acc: 0.6945
1984/2995 [==================>...........] - ETA: 1s - loss: 0.5759 - acc: 0.6966
2112/2995 [====================>.........] - ETA: 1s - loss: 0.5694 - acc: 0.7031
2240/2995 [=====================>........] - ETA: 0s - loss: 0.5662 - acc: 0.7036
2368/2995 [======================>.......] - ETA: 0s - loss: 0.5655 - acc: 0.7052
2496/2995 [========================>.....] - ETA: 0s - loss: 0.5643 - acc: 0.7047
2624/2995 [=========================>....] - ETA: 0s - loss: 0.5643 - acc: 0.7062
2752/2995 [==========================>...] - ETA: 0s - loss: 0.5614 - acc: 0.7078
2880/2995 [===========================>..] - ETA: 0s - loss: 0.5599 - acc: 0.7101
2995/2995 [==============================] - 3s 1ms/step - loss: 0.5585 - acc: 0.7105

Test accuracy: 81.68168168168168

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8145896656534956

AUC :  0.886858812495491

Confusion Matrix
[[138  29]
 [ 32 134]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.5584812838963554], 'acc': [0.7105175294342742]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.5105 - acc: 0.7656
 128/2995 [>.............................] - ETA: 2s - loss: 0.5224 - acc: 0.7266
 256/2995 [=>............................] - ETA: 1s - loss: 0.5107 - acc: 0.7188
 384/2995 [==>...........................] - ETA: 1s - loss: 0.4937 - acc: 0.7474
 512/2995 [====>.........................] - ETA: 1s - loss: 0.4859 - acc: 0.7578
 640/2995 [=====>........................] - ETA: 1s - loss: 0.4773 - acc: 0.7594
 768/2995 [======>.......................] - ETA: 1s - loss: 0.4792 - acc: 0.7526
 896/2995 [=======>......................] - ETA: 1s - loss: 0.4853 - acc: 0.7522
1024/2995 [=========>....................] - ETA: 1s - loss: 0.4806 - acc: 0.7588
1152/2995 [==========>...................] - ETA: 1s - loss: 0.4744 - acc: 0.7613
1280/2995 [===========>..................] - ETA: 1s - loss: 0.4740 - acc: 0.7680
1408/2995 [=============>................] - ETA: 0s - loss: 0.4739 - acc: 0.7706
1536/2995 [==============>...............] - ETA: 0s - loss: 0.4770 - acc: 0.7708
1664/2995 [===============>..............] - ETA: 0s - loss: 0.4783 - acc: 0.7704
1792/2995 [================>.............] - ETA: 0s - loss: 0.4710 - acc: 0.7790
1920/2995 [==================>...........] - ETA: 0s - loss: 0.4737 - acc: 0.7797
2048/2995 [===================>..........] - ETA: 0s - loss: 0.4740 - acc: 0.7808
2176/2995 [====================>.........] - ETA: 0s - loss: 0.4728 - acc: 0.7780
2304/2995 [======================>.......] - ETA: 0s - loss: 0.4708 - acc: 0.7791
2432/2995 [=======================>......] - ETA: 0s - loss: 0.4748 - acc: 0.7759
2560/2995 [========================>.....] - ETA: 0s - loss: 0.4727 - acc: 0.7770
2688/2995 [=========================>....] - ETA: 0s - loss: 0.4699 - acc: 0.7790
2816/2995 [===========================>..] - ETA: 0s - loss: 0.4669 - acc: 0.7809
2944/2995 [============================>.] - ETA: 0s - loss: 0.4651 - acc: 0.7809
2995/2995 [==============================] - 2s 539us/step - loss: 0.4642 - acc: 0.7816

Test accuracy: 81.68168168168168

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  196

choose_one :  137

F1score :  0.7986798679867987

AUC :  0.9013238583074815

Confusion Matrix
[[151  16]
 [ 45 121]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.2710843373493976  
0.7289156626506024  

Train_result {'loss': [0.464187998534841], 'acc': [0.7816360602792795]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4268 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.4284 - acc: 0.8125
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4108 - acc: 0.8438
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4385 - acc: 0.8103
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4239 - acc: 0.8090
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4380 - acc: 0.7969
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4430 - acc: 0.7873
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4401 - acc: 0.7906
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4422 - acc: 0.7923
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4512 - acc: 0.7870
1344/2995 [============>.................] - ETA: 0s - loss: 0.4449 - acc: 0.7909
1472/2995 [=============>................] - ETA: 0s - loss: 0.4535 - acc: 0.7846
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4528 - acc: 0.7856
1728/2995 [================>.............] - ETA: 0s - loss: 0.4547 - acc: 0.7824
1856/2995 [=================>............] - ETA: 0s - loss: 0.4517 - acc: 0.7834
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4513 - acc: 0.7853
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4505 - acc: 0.7841
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4491 - acc: 0.7844
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4478 - acc: 0.7842
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4408 - acc: 0.7885
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4435 - acc: 0.7870
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4466 - acc: 0.7834
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4419 - acc: 0.7878
2995/2995 [==============================] - 2s 528us/step - loss: 0.4417 - acc: 0.7890

Test accuracy: 83.48348348348348

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  190

choose_one :  143

F1score :  0.8220064724919094

AUC :  0.9089171055479403

Confusion Matrix
[[151  16]
 [ 39 127]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.23493975903614459  
0.7650602409638554  

Train_result {'loss': [0.44168939168544763], 'acc': [0.7889816362790154]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4446 - acc: 0.7656
 192/2995 [>.............................] - ETA: 1s - loss: 0.3845 - acc: 0.8073
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4177 - acc: 0.8063
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4384 - acc: 0.7879
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4184 - acc: 0.7986
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4306 - acc: 0.7855
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4260 - acc: 0.7921
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4354 - acc: 0.7896
1088/2995 [=========>....................] - ETA: 0s - loss: 0.4266 - acc: 0.7923
1216/2995 [===========>..................] - ETA: 0s - loss: 0.4191 - acc: 0.7969
1344/2995 [============>.................] - ETA: 0s - loss: 0.4174 - acc: 0.7999
1472/2995 [=============>................] - ETA: 0s - loss: 0.4157 - acc: 0.8016
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4157 - acc: 0.8037
1728/2995 [================>.............] - ETA: 0s - loss: 0.4198 - acc: 0.8009
1856/2995 [=================>............] - ETA: 0s - loss: 0.4138 - acc: 0.8033
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4142 - acc: 0.8054
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4127 - acc: 0.8078
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4133 - acc: 0.8085
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4153 - acc: 0.8087
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4137 - acc: 0.8089
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4143 - acc: 0.8098
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4136 - acc: 0.8100
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4139 - acc: 0.8111
2995/2995 [==============================] - 2s 502us/step - loss: 0.4179 - acc: 0.8077

Test accuracy: 83.48348348348348

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.8358208955223881

AUC :  0.9122177332082823

Confusion Matrix
[[138  29]
 [ 26 140]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.1566265060240964  
0.8433734939759037  

Train_result {'loss': [0.41788570738595], 'acc': [0.8076794660549131]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4383 - acc: 0.7656
 192/2995 [>.............................] - ETA: 1s - loss: 0.4115 - acc: 0.7812
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4423 - acc: 0.7625
 448/2995 [===>..........................] - ETA: 1s - loss: 0.4316 - acc: 0.7835
 576/2995 [====>.........................] - ETA: 1s - loss: 0.4280 - acc: 0.7917
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4433 - acc: 0.7798
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4359 - acc: 0.7825
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4327 - acc: 0.7896
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4274 - acc: 0.7950
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4247 - acc: 0.7969
1344/2995 [============>.................] - ETA: 0s - loss: 0.4190 - acc: 0.8006
1472/2995 [=============>................] - ETA: 0s - loss: 0.4111 - acc: 0.8084
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4057 - acc: 0.8125
1728/2995 [================>.............] - ETA: 0s - loss: 0.4050 - acc: 0.8166
1856/2995 [=================>............] - ETA: 0s - loss: 0.4087 - acc: 0.8136
1984/2995 [==================>...........] - ETA: 0s - loss: 0.4064 - acc: 0.8145
2112/2995 [====================>.........] - ETA: 0s - loss: 0.4089 - acc: 0.8144
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4069 - acc: 0.8143
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4078 - acc: 0.8125
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4077 - acc: 0.8125
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4038 - acc: 0.8152
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4014 - acc: 0.8158
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4030 - acc: 0.8149
2995/2995 [==============================] - 2s 527us/step - loss: 0.4016 - acc: 0.8167

Test accuracy: 85.58558558558559

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.846153846153846

AUC :  0.9199011615323571

Confusion Matrix
[[153  14]
 [ 34 132]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.20481927710843373  
0.7951807228915663  

Train_result {'loss': [0.40163164013415226], 'acc': [0.8166944908976356]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3614 - acc: 0.8281
 192/2995 [>.............................] - ETA: 2s - loss: 0.3249 - acc: 0.8438
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3864 - acc: 0.8187
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3764 - acc: 0.8348
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3817 - acc: 0.8264
 704/2995 [======>.......................] - ETA: 1s - loss: 0.4005 - acc: 0.8125
 832/2995 [=======>......................] - ETA: 1s - loss: 0.4067 - acc: 0.8065
 960/2995 [========>.....................] - ETA: 1s - loss: 0.4140 - acc: 0.8000
1088/2995 [=========>....................] - ETA: 1s - loss: 0.4126 - acc: 0.8015
1216/2995 [===========>..................] - ETA: 1s - loss: 0.4065 - acc: 0.8067
1344/2995 [============>.................] - ETA: 1s - loss: 0.4020 - acc: 0.8103
1472/2995 [=============>................] - ETA: 0s - loss: 0.4016 - acc: 0.8111
1600/2995 [===============>..............] - ETA: 0s - loss: 0.4006 - acc: 0.8100
1728/2995 [================>.............] - ETA: 0s - loss: 0.4047 - acc: 0.8084
1856/2995 [=================>............] - ETA: 0s - loss: 0.4015 - acc: 0.8120
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3975 - acc: 0.8130
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3979 - acc: 0.8125
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3972 - acc: 0.8134
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3912 - acc: 0.8163
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3902 - acc: 0.8173
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3900 - acc: 0.8182
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3952 - acc: 0.8147
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3931 - acc: 0.8170
2995/2995 [==============================] - 2s 555us/step - loss: 0.3927 - acc: 0.8174

Test accuracy: 84.68468468468468

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  146

choose_one :  187

F1score :  0.8555240793201133

AUC :  0.9244282519298752

Confusion Matrix
[[131  36]
 [ 15 151]]
True label 0
0.7844311377245509  
0.2155688622754491  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.392685748032218], 'acc': [0.8173622706497651]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3381 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.3515 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3325 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3566 - acc: 0.8460
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3447 - acc: 0.8472
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3417 - acc: 0.8509
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3480 - acc: 0.8474
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3705 - acc: 0.8406
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3730 - acc: 0.8428
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3716 - acc: 0.8462
1344/2995 [============>.................] - ETA: 0s - loss: 0.3664 - acc: 0.8482
1472/2995 [=============>................] - ETA: 0s - loss: 0.3724 - acc: 0.8424
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3709 - acc: 0.8419
1728/2995 [================>.............] - ETA: 0s - loss: 0.3688 - acc: 0.8414
1856/2995 [=================>............] - ETA: 0s - loss: 0.3679 - acc: 0.8394
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3652 - acc: 0.8407
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3690 - acc: 0.8385
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3782 - acc: 0.8321
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3793 - acc: 0.8311
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3785 - acc: 0.8313
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3762 - acc: 0.8319
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3785 - acc: 0.8314
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3824 - acc: 0.8295
2995/2995 [==============================] - 2s 545us/step - loss: 0.3817 - acc: 0.8304

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  197

choose_one :  136

F1score :  0.8211920529801324

AUC :  0.9190895317798139

Confusion Matrix
[[155  12]
 [ 42 124]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.25301204819277107  
0.7469879518072289  

Train_result {'loss': [0.381742518284484], 'acc': [0.8303839734480257]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3863 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.3741 - acc: 0.8281
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3490 - acc: 0.8406
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3573 - acc: 0.8326
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3774 - acc: 0.8247
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3722 - acc: 0.8295
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3605 - acc: 0.8341
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3654 - acc: 0.8323
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3630 - acc: 0.8364
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3591 - acc: 0.8355
1344/2995 [============>.................] - ETA: 0s - loss: 0.3609 - acc: 0.8371
1472/2995 [=============>................] - ETA: 0s - loss: 0.3636 - acc: 0.8349
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3649 - acc: 0.8350
1728/2995 [================>.............] - ETA: 0s - loss: 0.3714 - acc: 0.8287
1856/2995 [=================>............] - ETA: 0s - loss: 0.3706 - acc: 0.8308
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3677 - acc: 0.8342
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3730 - acc: 0.8310
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3750 - acc: 0.8277
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3742 - acc: 0.8290
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3713 - acc: 0.8305
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3736 - acc: 0.8304
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3775 - acc: 0.8299
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3789 - acc: 0.8302
2995/2995 [==============================] - 2s 529us/step - loss: 0.3787 - acc: 0.8314

Test accuracy: 85.88588588588588

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  172

choose_one :  161

F1score :  0.856269113149847

AUC :  0.9272599379554144

Confusion Matrix
[[146  21]
 [ 26 140]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.1566265060240964  
0.8433734939759037  

Train_result {'loss': [0.3787423595761218], 'acc': [0.8313856428772062]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3095 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3301 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3352 - acc: 0.8406
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3479 - acc: 0.8348
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3391 - acc: 0.8438
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3394 - acc: 0.8466
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3413 - acc: 0.8450
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3591 - acc: 0.8365
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3565 - acc: 0.8373
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3507 - acc: 0.8438
1344/2995 [============>.................] - ETA: 0s - loss: 0.3461 - acc: 0.8467
1472/2995 [=============>................] - ETA: 0s - loss: 0.3472 - acc: 0.8451
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3505 - acc: 0.8438
1728/2995 [================>.............] - ETA: 0s - loss: 0.3492 - acc: 0.8432
1856/2995 [=================>............] - ETA: 0s - loss: 0.3517 - acc: 0.8416
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3490 - acc: 0.8448
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3486 - acc: 0.8452
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3533 - acc: 0.8429
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3530 - acc: 0.8433
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3526 - acc: 0.8425
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3547 - acc: 0.8415
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3546 - acc: 0.8412
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3555 - acc: 0.8410
2995/2995 [==============================] - 2s 544us/step - loss: 0.3552 - acc: 0.8404

Test accuracy: 85.28528528528528

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  152

choose_one :  181

F1score :  0.8587896253602305

AUC :  0.9243921794964288

Confusion Matrix
[[135  32]
 [ 17 149]]
True label 0
0.8083832335329342  
0.19161676646706588  
True label 1
0.10240963855421686  
0.8975903614457831  

Train_result {'loss': [0.35515417712359676], 'acc': [0.8404006679189424]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2427 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3480 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3474 - acc: 0.8375
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3540 - acc: 0.8393
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3487 - acc: 0.8420
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3409 - acc: 0.8480
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3340 - acc: 0.8546
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3382 - acc: 0.8500
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3482 - acc: 0.8428
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3487 - acc: 0.8396
1344/2995 [============>.................] - ETA: 0s - loss: 0.3452 - acc: 0.8423
1472/2995 [=============>................] - ETA: 0s - loss: 0.3440 - acc: 0.8431
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3432 - acc: 0.8438
1728/2995 [================>.............] - ETA: 0s - loss: 0.3381 - acc: 0.8472
1856/2995 [=================>............] - ETA: 0s - loss: 0.3397 - acc: 0.8475
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3464 - acc: 0.8443
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3488 - acc: 0.8423
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3501 - acc: 0.8415
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3485 - acc: 0.8433
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3467 - acc: 0.8442
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3515 - acc: 0.8403
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3524 - acc: 0.8405
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3525 - acc: 0.8406
2995/2995 [==============================] - 2s 533us/step - loss: 0.3541 - acc: 0.8414

Test accuracy: 83.78378378378379

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8280254777070063

AUC :  0.9157889041194719

Confusion Matrix
[[149  18]
 [ 36 130]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.21686746987951808  
0.7831325301204819  

Train_result {'loss': [0.3541264948343395], 'acc': [0.8414023373481229]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4264 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3931 - acc: 0.8385
 320/2995 [==>...........................] - ETA: 1s - loss: 0.4008 - acc: 0.8406
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3739 - acc: 0.8482
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3640 - acc: 0.8490
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3515 - acc: 0.8537
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3552 - acc: 0.8462
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3461 - acc: 0.8500
1088/2995 [=========>....................] - ETA: 0s - loss: 0.3488 - acc: 0.8502
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3578 - acc: 0.8438
1344/2995 [============>.................] - ETA: 0s - loss: 0.3523 - acc: 0.8438
1472/2995 [=============>................] - ETA: 0s - loss: 0.3464 - acc: 0.8471
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3442 - acc: 0.8481
1728/2995 [================>.............] - ETA: 0s - loss: 0.3438 - acc: 0.8495
1856/2995 [=================>............] - ETA: 0s - loss: 0.3459 - acc: 0.8508
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3466 - acc: 0.8523
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3467 - acc: 0.8518
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3468 - acc: 0.8527
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3470 - acc: 0.8509
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3446 - acc: 0.8530
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3446 - acc: 0.8533
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3495 - acc: 0.8507
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3505 - acc: 0.8490
2995/2995 [==============================] - 2s 503us/step - loss: 0.3485 - acc: 0.8508

Test accuracy: 84.68468468468468

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  172

choose_one :  161

F1score :  0.8440366972477064

AUC :  0.9221917610562008

Confusion Matrix
[[144  23]
 [ 28 138]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.34853323633364325], 'acc': [0.850751252226121]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3917 - acc: 0.8125
 192/2995 [>.............................] - ETA: 1s - loss: 0.3231 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3178 - acc: 0.8656
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3210 - acc: 0.8683
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3103 - acc: 0.8698
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3099 - acc: 0.8651
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3187 - acc: 0.8570
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3316 - acc: 0.8542
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3262 - acc: 0.8557
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3310 - acc: 0.8553
1344/2995 [============>.................] - ETA: 0s - loss: 0.3285 - acc: 0.8579
1472/2995 [=============>................] - ETA: 0s - loss: 0.3339 - acc: 0.8546
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3434 - acc: 0.8506
1728/2995 [================>.............] - ETA: 0s - loss: 0.3404 - acc: 0.8507
1856/2995 [=================>............] - ETA: 0s - loss: 0.3367 - acc: 0.8545
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3378 - acc: 0.8543
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3374 - acc: 0.8546
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3380 - acc: 0.8536
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3411 - acc: 0.8522
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3404 - acc: 0.8510
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3394 - acc: 0.8518
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3372 - acc: 0.8539
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3409 - acc: 0.8517
2995/2995 [==============================] - 2s 532us/step - loss: 0.3403 - acc: 0.8551

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.8698224852071005

AUC :  0.9295685736959816

Confusion Matrix
[[142  25]
 [ 19 147]]
True label 0
0.8502994011976048  
0.1497005988023952  
True label 1
0.1144578313253012  
0.8855421686746988  

Train_result {'loss': [0.340267415048682], 'acc': [0.8550918197791048]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2788 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.3349 - acc: 0.8490
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3078 - acc: 0.8688
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2983 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3059 - acc: 0.8715
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3098 - acc: 0.8693
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3073 - acc: 0.8654
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3148 - acc: 0.8583
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3188 - acc: 0.8557
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3151 - acc: 0.8544
1344/2995 [============>.................] - ETA: 0s - loss: 0.3197 - acc: 0.8497
1472/2995 [=============>................] - ETA: 0s - loss: 0.3219 - acc: 0.8485
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3229 - acc: 0.8512
1728/2995 [================>.............] - ETA: 0s - loss: 0.3195 - acc: 0.8542
1856/2995 [=================>............] - ETA: 0s - loss: 0.3195 - acc: 0.8551
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3217 - acc: 0.8548
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3203 - acc: 0.8546
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3204 - acc: 0.8549
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3214 - acc: 0.8556
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3273 - acc: 0.8530
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3281 - acc: 0.8525
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3322 - acc: 0.8503
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3310 - acc: 0.8528
2995/2995 [==============================] - 2s 532us/step - loss: 0.3307 - acc: 0.8534

Test accuracy: 86.48648648648648

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8632218844984803

AUC :  0.931624702402424

Confusion Matrix
[[146  21]
 [ 24 142]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'loss': [0.33070148059442167], 'acc': [0.8534223707769072]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2326 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.3647 - acc: 0.8333
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3536 - acc: 0.8438
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3606 - acc: 0.8371
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3336 - acc: 0.8576
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3158 - acc: 0.8665
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3259 - acc: 0.8618
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3297 - acc: 0.8542
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3220 - acc: 0.8603
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3214 - acc: 0.8610
1344/2995 [============>.................] - ETA: 0s - loss: 0.3207 - acc: 0.8609
1472/2995 [=============>................] - ETA: 0s - loss: 0.3237 - acc: 0.8573
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3260 - acc: 0.8550
1728/2995 [================>.............] - ETA: 0s - loss: 0.3281 - acc: 0.8565
1856/2995 [=================>............] - ETA: 0s - loss: 0.3280 - acc: 0.8594
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3250 - acc: 0.8624
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3220 - acc: 0.8636
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3213 - acc: 0.8652
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3206 - acc: 0.8649
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3255 - acc: 0.8634
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3213 - acc: 0.8655
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3245 - acc: 0.8623
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3253 - acc: 0.8604
2995/2995 [==============================] - 2s 532us/step - loss: 0.3253 - acc: 0.8601

Test accuracy: 85.28528528528528

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.8473520249221184

AUC :  0.9301998412812928

Confusion Matrix
[[148  19]
 [ 30 136]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.32528225141694034], 'acc': [0.8601001671240206]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2855 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3411 - acc: 0.8594
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3071 - acc: 0.8656
 384/2995 [==>...........................] - ETA: 2s - loss: 0.3245 - acc: 0.8516
 512/2995 [====>.........................] - ETA: 2s - loss: 0.3119 - acc: 0.8613
 640/2995 [=====>........................] - ETA: 2s - loss: 0.3180 - acc: 0.8594
 768/2995 [======>.......................] - ETA: 1s - loss: 0.3103 - acc: 0.8620
 896/2995 [=======>......................] - ETA: 1s - loss: 0.3016 - acc: 0.8683
1024/2995 [=========>....................] - ETA: 1s - loss: 0.3149 - acc: 0.8633
1152/2995 [==========>...................] - ETA: 1s - loss: 0.3138 - acc: 0.8646
1280/2995 [===========>..................] - ETA: 1s - loss: 0.3232 - acc: 0.8641
1408/2995 [=============>................] - ETA: 1s - loss: 0.3278 - acc: 0.8608
1536/2995 [==============>...............] - ETA: 1s - loss: 0.3283 - acc: 0.8594
1664/2995 [===============>..............] - ETA: 0s - loss: 0.3246 - acc: 0.8612
1792/2995 [================>.............] - ETA: 0s - loss: 0.3230 - acc: 0.8622
1920/2995 [==================>...........] - ETA: 0s - loss: 0.3282 - acc: 0.8609
2048/2995 [===================>..........] - ETA: 0s - loss: 0.3282 - acc: 0.8608
2176/2995 [====================>.........] - ETA: 0s - loss: 0.3317 - acc: 0.8571
2304/2995 [======================>.......] - ETA: 0s - loss: 0.3320 - acc: 0.8581
2432/2995 [=======================>......] - ETA: 0s - loss: 0.3274 - acc: 0.8606
2560/2995 [========================>.....] - ETA: 0s - loss: 0.3274 - acc: 0.8594
2688/2995 [=========================>....] - ETA: 0s - loss: 0.3252 - acc: 0.8616
2816/2995 [===========================>..] - ETA: 0s - loss: 0.3267 - acc: 0.8615
2944/2995 [============================>.] - ETA: 0s - loss: 0.3284 - acc: 0.8607
2995/2995 [==============================] - 2s 605us/step - loss: 0.3272 - acc: 0.8618

Test accuracy: 85.58558558558559

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  179

choose_one :  154

F1score :  0.85

AUC :  0.9285405093427604

Confusion Matrix
[[149  18]
 [ 30 136]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.32722116323663714], 'acc': [0.8617696161063167]}
Saved model to disk


[[81.68168168168168, 1], [81.68168168168168, 2], [83.48348348348348, 3], [83.48348348348348, 4], [85.58558558558559, 5], [84.68468468468468, 6], [83.78378378378379, 7], [85.88588588588588, 8], [85.28528528528528, 9], [83.78378378378379, 10], [84.68468468468468, 11], [86.78678678678679, 12], [86.48648648648648, 13], [85.28528528528528, 14], [85.58558558558559, 15]]
max accuracy :  [86.78678678678679, 12]

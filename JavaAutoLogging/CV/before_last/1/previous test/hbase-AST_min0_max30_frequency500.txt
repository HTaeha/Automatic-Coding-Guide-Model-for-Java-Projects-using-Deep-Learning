Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:56:00.436484: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:56:00.447967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:56:00.449525: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5df9870 executing computations on platform Host. Devices:
2019-09-07 15:56:00.449564: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 30 : 11721
Over 30, Under 100 : 10544
Over 100, Under 150 : 2139
Over 150, Under 200 : 1071
Over 200, Under 400 : 1121
Over 400 : 180

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 9

Under 10 : 1925
Over 10, Under 30 : 1038
Over 30, Under 100 : 23
Over 100, Under 150 : 3
Over 150, Under 200 : 1
Over 200, Under 400 : 3
Over 400 : 2


Sentence length Average : 8

Under 10 : 214
Over 10, Under 30 : 116
Over 30, Under 100 : 2
Over 100, Under 150 : 0
Over 150, Under 200 : 1
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:04 - loss: 0.7589 - acc: 0.3750
 192/2995 [>.............................] - ETA: 21s - loss: 0.6799 - acc: 0.5573 
 320/2995 [==>...........................] - ETA: 13s - loss: 0.6299 - acc: 0.6281
 448/2995 [===>..........................] - ETA: 9s - loss: 0.5990 - acc: 0.6652 
 576/2995 [====>.........................] - ETA: 7s - loss: 0.5989 - acc: 0.6788
 704/2995 [======>.......................] - ETA: 5s - loss: 0.5788 - acc: 0.7074
 832/2995 [=======>......................] - ETA: 4s - loss: 0.5575 - acc: 0.7320
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5455 - acc: 0.7406
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5253 - acc: 0.7555
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5147 - acc: 0.7632
1344/2995 [============>.................] - ETA: 2s - loss: 0.5031 - acc: 0.7731
1472/2995 [=============>................] - ETA: 2s - loss: 0.5024 - acc: 0.7738
1600/2995 [===============>..............] - ETA: 1s - loss: 0.4951 - acc: 0.7800
1728/2995 [================>.............] - ETA: 1s - loss: 0.4881 - acc: 0.7836
1856/2995 [=================>............] - ETA: 1s - loss: 0.4776 - acc: 0.7883
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4730 - acc: 0.7918
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4617 - acc: 0.7997
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4572 - acc: 0.8013
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4538 - acc: 0.8036
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4475 - acc: 0.8061
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4455 - acc: 0.8083
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4458 - acc: 0.8078
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4409 - acc: 0.8104
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4372 - acc: 0.8110

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8650306748466258

AUC :  0.9327790202727076

Confusion Matrix
[[148  19]
 [ 25 141]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'loss': [0.43720835196553964], 'acc': [0.8110183640792096]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3993 - acc: 0.8125
 192/2995 [>.............................] - ETA: 1s - loss: 0.3818 - acc: 0.8021
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3741 - acc: 0.8250
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3483 - acc: 0.8393
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3334 - acc: 0.8524
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3326 - acc: 0.8622
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3336 - acc: 0.8642
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3280 - acc: 0.8698
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3297 - acc: 0.8713
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3306 - acc: 0.8717
1344/2995 [============>.................] - ETA: 0s - loss: 0.3289 - acc: 0.8728
1472/2995 [=============>................] - ETA: 0s - loss: 0.3341 - acc: 0.8682
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3364 - acc: 0.8675
1728/2995 [================>.............] - ETA: 0s - loss: 0.3372 - acc: 0.8669
1856/2995 [=================>............] - ETA: 0s - loss: 0.3328 - acc: 0.8685
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3339 - acc: 0.8690
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3376 - acc: 0.8679
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3389 - acc: 0.8661
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3449 - acc: 0.8628
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3478 - acc: 0.8614
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3510 - acc: 0.8594
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3474 - acc: 0.8616
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3448 - acc: 0.8615
2995/2995 [==============================] - 2s 527us/step - loss: 0.3405 - acc: 0.8634

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  191

choose_one :  142

F1score :  0.8506493506493508

AUC :  0.945242046028425

Confusion Matrix
[[156  11]
 [ 35 131]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.21084337349397592  
0.7891566265060241  

Train_result {'loss': [0.3404850347362496], 'acc': [0.8634390652080212]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2604 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3489 - acc: 0.8438
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3298 - acc: 0.8469
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3385 - acc: 0.8460
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3195 - acc: 0.8594
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3278 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3391 - acc: 0.8498
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3346 - acc: 0.8510
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3325 - acc: 0.8539
1216/2995 [===========>..................] - ETA: 0s - loss: 0.3394 - acc: 0.8503
1344/2995 [============>.................] - ETA: 0s - loss: 0.3404 - acc: 0.8512
1472/2995 [=============>................] - ETA: 0s - loss: 0.3425 - acc: 0.8512
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3419 - acc: 0.8519
1728/2995 [================>.............] - ETA: 0s - loss: 0.3425 - acc: 0.8524
1856/2995 [=================>............] - ETA: 0s - loss: 0.3415 - acc: 0.8529
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3375 - acc: 0.8558
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3366 - acc: 0.8570
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3372 - acc: 0.8562
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3350 - acc: 0.8577
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3278 - acc: 0.8614
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3277 - acc: 0.8624
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3278 - acc: 0.8608
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3275 - acc: 0.8615
2995/2995 [==============================] - 2s 525us/step - loss: 0.3274 - acc: 0.8618

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  172

choose_one :  161

F1score :  0.8807339449541285

AUC :  0.9494985931750957

Confusion Matrix
[[150  17]
 [ 22 144]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.13253012048192772  
0.8674698795180723  

Train_result {'loss': [0.32740134003763405], 'acc': [0.8617696162058236]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4300 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.2992 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2972 - acc: 0.8688
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3135 - acc: 0.8594
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3091 - acc: 0.8698
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3160 - acc: 0.8665
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3272 - acc: 0.8606
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3323 - acc: 0.8594
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3247 - acc: 0.8612
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3194 - acc: 0.8651
1344/2995 [============>.................] - ETA: 0s - loss: 0.3192 - acc: 0.8653
1472/2995 [=============>................] - ETA: 0s - loss: 0.3231 - acc: 0.8648
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3160 - acc: 0.8694
1728/2995 [================>.............] - ETA: 0s - loss: 0.3149 - acc: 0.8681
1856/2995 [=================>............] - ETA: 0s - loss: 0.3090 - acc: 0.8707
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3107 - acc: 0.8710
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3107 - acc: 0.8712
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3058 - acc: 0.8746
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3047 - acc: 0.8754
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3054 - acc: 0.8754
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3041 - acc: 0.8746
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2996 - acc: 0.8757
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2989 - acc: 0.8760
2995/2995 [==============================] - 2s 541us/step - loss: 0.3021 - acc: 0.8735

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  151

choose_one :  182

F1score :  0.896551724137931

AUC :  0.9513563234975831

Confusion Matrix
[[141  26]
 [ 10 156]]
True label 0
0.844311377245509  
0.15568862275449102  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.3021278144521188], 'acc': [0.8734557597585433]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2986 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.3028 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3062 - acc: 0.8688
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2880 - acc: 0.8728
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2997 - acc: 0.8698
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3108 - acc: 0.8679
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3082 - acc: 0.8726
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3097 - acc: 0.8750
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3116 - acc: 0.8686
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3120 - acc: 0.8651
1344/2995 [============>.................] - ETA: 0s - loss: 0.3158 - acc: 0.8631
1472/2995 [=============>................] - ETA: 0s - loss: 0.3178 - acc: 0.8635
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3128 - acc: 0.8656
1728/2995 [================>.............] - ETA: 0s - loss: 0.3164 - acc: 0.8657
1856/2995 [=================>............] - ETA: 0s - loss: 0.3139 - acc: 0.8675
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3120 - acc: 0.8684
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3108 - acc: 0.8655
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3103 - acc: 0.8647
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3136 - acc: 0.8628
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3130 - acc: 0.8634
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3120 - acc: 0.8643
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3085 - acc: 0.8659
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3082 - acc: 0.8660
2995/2995 [==============================] - 2s 525us/step - loss: 0.3056 - acc: 0.8668

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  175

choose_one :  158

F1score :  0.8765432098765433

AUC :  0.9509054180795037

Confusion Matrix
[[151  16]
 [ 24 142]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'loss': [0.30561920062627934], 'acc': [0.8667779633716272]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2095 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2926 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2649 - acc: 0.8781
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3039 - acc: 0.8571
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2996 - acc: 0.8611
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3055 - acc: 0.8551
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3036 - acc: 0.8594
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3081 - acc: 0.8604
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3024 - acc: 0.8658
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3005 - acc: 0.8676
1344/2995 [============>.................] - ETA: 0s - loss: 0.2942 - acc: 0.8720
1472/2995 [=============>................] - ETA: 0s - loss: 0.2928 - acc: 0.8723
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2912 - acc: 0.8719
1728/2995 [================>.............] - ETA: 0s - loss: 0.2950 - acc: 0.8733
1856/2995 [=================>............] - ETA: 0s - loss: 0.2943 - acc: 0.8739
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2969 - acc: 0.8745
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2942 - acc: 0.8750
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2905 - acc: 0.8777
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2890 - acc: 0.8792
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2898 - acc: 0.8782
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2888 - acc: 0.8777
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2909 - acc: 0.8754
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2928 - acc: 0.8743
2995/2995 [==============================] - 2s 536us/step - loss: 0.2945 - acc: 0.8748

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  147

choose_one :  186

F1score :  0.8977272727272727

AUC :  0.9540256835726139

Confusion Matrix
[[139  28]
 [  8 158]]
True label 0
0.8323353293413174  
0.16766467065868262  
True label 1
0.04819277108433735  
0.9518072289156626  

Train_result {'loss': [0.29447964347264605], 'acc': [0.8747913190040844]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2789 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2680 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2512 - acc: 0.9094
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2725 - acc: 0.8951
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2687 - acc: 0.8958
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2608 - acc: 0.8963
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2589 - acc: 0.8942
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2677 - acc: 0.8906
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2721 - acc: 0.8915
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2790 - acc: 0.8906
1344/2995 [============>.................] - ETA: 0s - loss: 0.2779 - acc: 0.8914
1472/2995 [=============>................] - ETA: 0s - loss: 0.2820 - acc: 0.8886
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2787 - acc: 0.8900
1728/2995 [================>.............] - ETA: 0s - loss: 0.2760 - acc: 0.8912
1856/2995 [=================>............] - ETA: 0s - loss: 0.2735 - acc: 0.8922
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2718 - acc: 0.8921
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2776 - acc: 0.8883
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2797 - acc: 0.8875
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2806 - acc: 0.8868
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2804 - acc: 0.8862
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2776 - acc: 0.8872
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2818 - acc: 0.8844
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2817 - acc: 0.8840
2995/2995 [==============================] - 2s 544us/step - loss: 0.2856 - acc: 0.8825

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.8525641025641025

AUC :  0.9514825770146454

Confusion Matrix
[[154  13]
 [ 33 133]]
True label 0
0.9221556886227545  
0.07784431137724551  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.28556479396724543], 'acc': [0.8824707848002795]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2715 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2419 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2251 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2488 - acc: 0.8951
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2450 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2408 - acc: 0.8963
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2549 - acc: 0.8906
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2495 - acc: 0.8938
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2425 - acc: 0.8989
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2532 - acc: 0.8947
1344/2995 [============>.................] - ETA: 0s - loss: 0.2585 - acc: 0.8943
1472/2995 [=============>................] - ETA: 0s - loss: 0.2563 - acc: 0.8954
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2611 - acc: 0.8938
1728/2995 [================>.............] - ETA: 0s - loss: 0.2673 - acc: 0.8895
1856/2995 [=================>............] - ETA: 0s - loss: 0.2669 - acc: 0.8901
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2685 - acc: 0.8891
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2724 - acc: 0.8868
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2727 - acc: 0.8871
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2760 - acc: 0.8851
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2736 - acc: 0.8858
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2718 - acc: 0.8861
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2777 - acc: 0.8823
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2788 - acc: 0.8799
2995/2995 [==============================] - 2s 542us/step - loss: 0.2813 - acc: 0.8795

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8814589665653495

AUC :  0.9538633576221052

Confusion Matrix
[[149  18]
 [ 21 145]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.12650602409638553  
0.8734939759036144  

Train_result {'loss': [0.28129449645943555], 'acc': [0.87946577639333]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2077 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2931 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2677 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2734 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2738 - acc: 0.8698
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2753 - acc: 0.8707
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2719 - acc: 0.8702
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2794 - acc: 0.8656
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2718 - acc: 0.8695
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2720 - acc: 0.8676
1344/2995 [============>.................] - ETA: 0s - loss: 0.2746 - acc: 0.8661
1472/2995 [=============>................] - ETA: 0s - loss: 0.2746 - acc: 0.8682
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2686 - acc: 0.8719
1728/2995 [================>.............] - ETA: 0s - loss: 0.2707 - acc: 0.8715
1856/2995 [=================>............] - ETA: 0s - loss: 0.2701 - acc: 0.8739
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2670 - acc: 0.8760
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2710 - acc: 0.8750
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2747 - acc: 0.8737
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2762 - acc: 0.8733
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2776 - acc: 0.8742
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2766 - acc: 0.8754
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2751 - acc: 0.8757
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2748 - acc: 0.8767
2995/2995 [==============================] - 2s 531us/step - loss: 0.2765 - acc: 0.8758

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  165

choose_one :  168

F1score :  0.9041916167664671

AUC :  0.9554866171271915

Confusion Matrix
[[150  17]
 [ 15 151]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.276536248562133], 'acc': [0.8757929884332647]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2523 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.3049 - acc: 0.8750
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2925 - acc: 0.8812
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2854 - acc: 0.8817
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2681 - acc: 0.8872
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2541 - acc: 0.8920
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2762 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2767 - acc: 0.8906
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2892 - acc: 0.8842
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2859 - acc: 0.8849
1344/2995 [============>.................] - ETA: 0s - loss: 0.2797 - acc: 0.8854
1472/2995 [=============>................] - ETA: 0s - loss: 0.2755 - acc: 0.8865
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2774 - acc: 0.8869
1728/2995 [================>.............] - ETA: 0s - loss: 0.2722 - acc: 0.8895
1856/2995 [=================>............] - ETA: 0s - loss: 0.2761 - acc: 0.8869
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2793 - acc: 0.8856
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2763 - acc: 0.8849
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2739 - acc: 0.8866
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2723 - acc: 0.8872
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2698 - acc: 0.8882
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2745 - acc: 0.8872
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2750 - acc: 0.8877
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2748 - acc: 0.8872
2995/2995 [==============================] - 2s 546us/step - loss: 0.2734 - acc: 0.8878

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8535031847133757

AUC :  0.9555046533439145

Confusion Matrix
[[153  14]
 [ 32 134]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.27344546159838196], 'acc': [0.8878130217824436]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3558 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.2990 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2893 - acc: 0.8719
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2755 - acc: 0.8728
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2655 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2576 - acc: 0.8849
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2608 - acc: 0.8882
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2576 - acc: 0.8927
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2607 - acc: 0.8897
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2647 - acc: 0.8865
1344/2995 [============>.................] - ETA: 0s - loss: 0.2589 - acc: 0.8899
1472/2995 [=============>................] - ETA: 0s - loss: 0.2659 - acc: 0.8859
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2685 - acc: 0.8856
1728/2995 [================>.............] - ETA: 0s - loss: 0.2759 - acc: 0.8837
1856/2995 [=================>............] - ETA: 0s - loss: 0.2738 - acc: 0.8863
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2761 - acc: 0.8856
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2750 - acc: 0.8854
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2706 - acc: 0.8871
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2692 - acc: 0.8877
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2687 - acc: 0.8870
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2677 - acc: 0.8883
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2701 - acc: 0.8863
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2709 - acc: 0.8861
2995/2995 [==============================] - 2s 549us/step - loss: 0.2681 - acc: 0.8861

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  182

choose_one :  151

F1score :  0.8706624605678234

AUC :  0.954945530625496

Confusion Matrix
[[154  13]
 [ 28 138]]
True label 0
0.9221556886227545  
0.07784431137724551  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.26807149263574603], 'acc': [0.8861435727404433]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2884 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2386 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2293 - acc: 0.9031
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2258 - acc: 0.9062
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2084 - acc: 0.9149
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2199 - acc: 0.9134
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2274 - acc: 0.9099
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2349 - acc: 0.9083
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2279 - acc: 0.9090
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2321 - acc: 0.9095
1344/2995 [============>.................] - ETA: 0s - loss: 0.2345 - acc: 0.9062
1472/2995 [=============>................] - ETA: 0s - loss: 0.2410 - acc: 0.9029
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2502 - acc: 0.8975
1728/2995 [================>.............] - ETA: 0s - loss: 0.2495 - acc: 0.8970
1856/2995 [=================>............] - ETA: 0s - loss: 0.2452 - acc: 0.9014
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2481 - acc: 0.9012
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2484 - acc: 0.9010
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2522 - acc: 0.9009
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2580 - acc: 0.8982
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2574 - acc: 0.8974
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2565 - acc: 0.8967
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2586 - acc: 0.8972
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2585 - acc: 0.8976
2995/2995 [==============================] - 2s 542us/step - loss: 0.2616 - acc: 0.8962

Test accuracy: 88.58858858858859

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  147

choose_one :  186

F1score :  0.8920454545454547

AUC :  0.9497871726426664

Confusion Matrix
[[138  29]
 [  9 157]]
True label 0
0.8263473053892215  
0.17365269461077845  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.2616024025493552], 'acc': [0.89616026721136]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2702 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2568 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2488 - acc: 0.8875
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2360 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2378 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2425 - acc: 0.9020
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2367 - acc: 0.9002
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2306 - acc: 0.9042
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2298 - acc: 0.9035
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2315 - acc: 0.9021
1344/2995 [============>.................] - ETA: 0s - loss: 0.2305 - acc: 0.9025
1472/2995 [=============>................] - ETA: 0s - loss: 0.2302 - acc: 0.9022
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2318 - acc: 0.9031
1728/2995 [================>.............] - ETA: 0s - loss: 0.2334 - acc: 0.9039
1856/2995 [=================>............] - ETA: 0s - loss: 0.2326 - acc: 0.9025
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2395 - acc: 0.8997
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2437 - acc: 0.8963
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2426 - acc: 0.8969
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2461 - acc: 0.8953
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2514 - acc: 0.8938
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2591 - acc: 0.8899
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2599 - acc: 0.8895
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2587 - acc: 0.8896
2995/2995 [==============================] - 2s 538us/step - loss: 0.2602 - acc: 0.8885

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  161

choose_one :  172

F1score :  0.8994082840236686

AUC :  0.9523122429839117

Confusion Matrix
[[147  20]
 [ 14 152]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.2601691141749463], 'acc': [0.888480801474869]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1181 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.2490 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2649 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2808 - acc: 0.8817
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2662 - acc: 0.8889
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2636 - acc: 0.8892
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2731 - acc: 0.8834
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2673 - acc: 0.8875
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2717 - acc: 0.8869
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2657 - acc: 0.8906
1344/2995 [============>.................] - ETA: 0s - loss: 0.2699 - acc: 0.8869
1472/2995 [=============>................] - ETA: 0s - loss: 0.2714 - acc: 0.8872
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2660 - acc: 0.8900
1728/2995 [================>.............] - ETA: 0s - loss: 0.2663 - acc: 0.8912
1856/2995 [=================>............] - ETA: 0s - loss: 0.2654 - acc: 0.8922
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2632 - acc: 0.8926
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2589 - acc: 0.8939
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2551 - acc: 0.8960
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2540 - acc: 0.8957
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2553 - acc: 0.8950
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2548 - acc: 0.8948
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2577 - acc: 0.8921
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2555 - acc: 0.8927
2995/2995 [==============================] - 2s 546us/step - loss: 0.2567 - acc: 0.8932

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  159

choose_one :  174

F1score :  0.9

AUC :  0.9522581343337423

Confusion Matrix
[[146  21]
 [ 13 153]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.0783132530120482  
0.9216867469879518  

Train_result {'loss': [0.2567163287498716], 'acc': [0.893155258884016]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2651 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2388 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2125 - acc: 0.9156
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2275 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2576 - acc: 0.8993
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2571 - acc: 0.9006
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2486 - acc: 0.8978
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2610 - acc: 0.8948
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2558 - acc: 0.8989
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2505 - acc: 0.8997
1344/2995 [============>.................] - ETA: 0s - loss: 0.2519 - acc: 0.8996
1472/2995 [=============>................] - ETA: 0s - loss: 0.2448 - acc: 0.9022
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2558 - acc: 0.8981
1728/2995 [================>.............] - ETA: 0s - loss: 0.2537 - acc: 0.8993
1856/2995 [=================>............] - ETA: 0s - loss: 0.2564 - acc: 0.8960
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2563 - acc: 0.8962
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2571 - acc: 0.8944
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2534 - acc: 0.8955
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2532 - acc: 0.8944
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2520 - acc: 0.8950
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2515 - acc: 0.8948
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2503 - acc: 0.8961
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2553 - acc: 0.8951
2995/2995 [==============================] - 2s 539us/step - loss: 0.2565 - acc: 0.8945

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8714733542319748

AUC :  0.9530697640862853

Confusion Matrix
[[153  14]
 [ 27 139]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.2564705189360999], 'acc': [0.8944908181494584]}
Saved model to disk


[[86.78678678678679, 1], [86.18618618618619, 2], [88.28828828828829, 3], [89.1891891891892, 4], [87.98798798798799, 5], [89.1891891891892, 6], [86.18618618618619, 7], [88.28828828828829, 8], [90.39039039039038, 9], [86.18618618618619, 10], [87.68768768768768, 11], [88.58858858858859, 12], [89.7897897897898, 13], [89.7897897897898, 14], [87.68768768768768, 15]]
max accuracy :  [90.39039039039038, 9]

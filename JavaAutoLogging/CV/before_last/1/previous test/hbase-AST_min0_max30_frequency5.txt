Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 15:51:41.260187: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 15:51:41.272592: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 15:51:41.274865: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55e36b0 executing computations on platform Host. Devices:
2019-09-07 15:51:41.274923: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 35

Under 10 : 21694
Over 10, Under 30 : 11721
Over 30, Under 100 : 10544
Over 100, Under 150 : 2139
Over 150, Under 200 : 1071
Over 200, Under 400 : 1121
Over 400 : 180

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 9

Under 10 : 1925
Over 10, Under 30 : 1038
Over 30, Under 100 : 23
Over 100, Under 150 : 3
Over 150, Under 200 : 1
Over 200, Under 400 : 3
Over 400 : 2


Sentence length Average : 8

Under 10 : 214
Over 10, Under 30 : 116
Over 30, Under 100 : 2
Over 100, Under 150 : 0
Over 150, Under 200 : 1
Over 200, Under 400 : 0
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:14 - loss: 0.7286 - acc: 0.4688
 192/2995 [>.............................] - ETA: 24s - loss: 0.6670 - acc: 0.5833 
 320/2995 [==>...........................] - ETA: 14s - loss: 0.6131 - acc: 0.6813
 448/2995 [===>..........................] - ETA: 10s - loss: 0.5920 - acc: 0.7143
 576/2995 [====>.........................] - ETA: 8s - loss: 0.5863 - acc: 0.7188 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.5713 - acc: 0.7386
 832/2995 [=======>......................] - ETA: 5s - loss: 0.5523 - acc: 0.7512
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5438 - acc: 0.7552
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5218 - acc: 0.7684
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5086 - acc: 0.7788
1344/2995 [============>.................] - ETA: 2s - loss: 0.4962 - acc: 0.7887
1472/2995 [=============>................] - ETA: 2s - loss: 0.4949 - acc: 0.7853
1600/2995 [===============>..............] - ETA: 2s - loss: 0.4881 - acc: 0.7913
1728/2995 [================>.............] - ETA: 1s - loss: 0.4813 - acc: 0.7934
1856/2995 [=================>............] - ETA: 1s - loss: 0.4727 - acc: 0.7974
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4692 - acc: 0.8004
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4574 - acc: 0.8073
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4515 - acc: 0.8098
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4480 - acc: 0.8104
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4423 - acc: 0.8133
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4408 - acc: 0.8155
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4403 - acc: 0.8143
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4359 - acc: 0.8160
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4330 - acc: 0.8170

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8588957055214724

AUC :  0.9398852896616406

Confusion Matrix
[[147  20]
 [ 26 140]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.1566265060240964  
0.8433734939759037  

Train_result {'loss': [0.4330243403008068], 'acc': [0.8170283807936017]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4119 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.3879 - acc: 0.7969
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3707 - acc: 0.8219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3423 - acc: 0.8438
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3325 - acc: 0.8472
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3264 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3223 - acc: 0.8630
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3188 - acc: 0.8667
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3240 - acc: 0.8603
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3240 - acc: 0.8610
1344/2995 [============>.................] - ETA: 0s - loss: 0.3218 - acc: 0.8638
1472/2995 [=============>................] - ETA: 0s - loss: 0.3267 - acc: 0.8607
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3318 - acc: 0.8588
1728/2995 [================>.............] - ETA: 0s - loss: 0.3320 - acc: 0.8571
1856/2995 [=================>............] - ETA: 0s - loss: 0.3269 - acc: 0.8599
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3287 - acc: 0.8599
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3336 - acc: 0.8570
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3337 - acc: 0.8558
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3396 - acc: 0.8518
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3426 - acc: 0.8506
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3446 - acc: 0.8495
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3416 - acc: 0.8521
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3392 - acc: 0.8545
2995/2995 [==============================] - 2s 534us/step - loss: 0.3358 - acc: 0.8561

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.858974358974359

AUC :  0.9461979655147535

Confusion Matrix
[[155  12]
 [ 32 134]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.3357563906450303], 'acc': [0.8560934892679892]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2841 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.3433 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3205 - acc: 0.8688
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3312 - acc: 0.8638
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3100 - acc: 0.8698
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3150 - acc: 0.8707
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3287 - acc: 0.8630
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3272 - acc: 0.8646
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3264 - acc: 0.8658
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3345 - acc: 0.8635
1344/2995 [============>.................] - ETA: 0s - loss: 0.3324 - acc: 0.8631
1472/2995 [=============>................] - ETA: 0s - loss: 0.3317 - acc: 0.8628
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3325 - acc: 0.8606
1728/2995 [================>.............] - ETA: 0s - loss: 0.3336 - acc: 0.8594
1856/2995 [=================>............] - ETA: 0s - loss: 0.3325 - acc: 0.8610
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3304 - acc: 0.8624
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3305 - acc: 0.8617
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3305 - acc: 0.8612
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3282 - acc: 0.8623
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3211 - acc: 0.8658
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3204 - acc: 0.8666
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3208 - acc: 0.8648
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3209 - acc: 0.8653
2995/2995 [==============================] - 2s 535us/step - loss: 0.3204 - acc: 0.8658

Test accuracy: 87.08708708708708

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  178

choose_one :  155

F1score :  0.866043613707165

AUC :  0.9495527018252652

Confusion Matrix
[[151  16]
 [ 27 139]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.16265060240963855  
0.8373493975903614  

Train_result {'loss': [0.3203693843544624], 'acc': [0.8657762940021508]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.4478 - acc: 0.7969
 192/2995 [>.............................] - ETA: 1s - loss: 0.3036 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3021 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3090 - acc: 0.8705
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3093 - acc: 0.8715
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3126 - acc: 0.8679
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3222 - acc: 0.8618
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3282 - acc: 0.8625
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3178 - acc: 0.8658
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3143 - acc: 0.8668
1344/2995 [============>.................] - ETA: 0s - loss: 0.3143 - acc: 0.8668
1472/2995 [=============>................] - ETA: 0s - loss: 0.3181 - acc: 0.8655
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3101 - acc: 0.8694
1728/2995 [================>.............] - ETA: 0s - loss: 0.3112 - acc: 0.8669
1856/2995 [=================>............] - ETA: 0s - loss: 0.3071 - acc: 0.8691
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3084 - acc: 0.8695
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3086 - acc: 0.8688
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3034 - acc: 0.8714
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3032 - acc: 0.8720
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3059 - acc: 0.8722
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3049 - acc: 0.8716
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3000 - acc: 0.8735
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2988 - acc: 0.8736
2995/2995 [==============================] - 2s 524us/step - loss: 0.3016 - acc: 0.8725

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  156

choose_one :  177

F1score :  0.8979591836734694

AUC :  0.9529795830026694

Confusion Matrix
[[144  23]
 [ 12 154]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.07228915662650602  
0.927710843373494  

Train_result {'loss': [0.301645293727343], 'acc': [0.8724540903094615]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2794 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2948 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3025 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2819 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2932 - acc: 0.8733
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3048 - acc: 0.8764
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3027 - acc: 0.8750
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3057 - acc: 0.8740
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3070 - acc: 0.8722
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3069 - acc: 0.8717
1344/2995 [============>.................] - ETA: 0s - loss: 0.3114 - acc: 0.8690
1472/2995 [=============>................] - ETA: 0s - loss: 0.3130 - acc: 0.8662
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3069 - acc: 0.8681
1728/2995 [================>.............] - ETA: 0s - loss: 0.3090 - acc: 0.8681
1856/2995 [=================>............] - ETA: 0s - loss: 0.3077 - acc: 0.8691
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3064 - acc: 0.8684
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3066 - acc: 0.8670
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3067 - acc: 0.8656
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3080 - acc: 0.8653
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3074 - acc: 0.8654
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3070 - acc: 0.8674
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3042 - acc: 0.8692
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3051 - acc: 0.8694
2995/2995 [==============================] - 2s 527us/step - loss: 0.3028 - acc: 0.8708

Test accuracy: 87.38738738738738

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  175

choose_one :  158

F1score :  0.8703703703703705

AUC :  0.9537010316715966

Confusion Matrix
[[150  17]
 [ 25 141]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.15060240963855423  
0.8493975903614458  

Train_result {'loss': [0.3028273341402984], 'acc': [0.8707846411679543]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2172 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2982 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2658 - acc: 0.8812
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3044 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3007 - acc: 0.8663
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3116 - acc: 0.8580
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3093 - acc: 0.8630
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3132 - acc: 0.8615
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3076 - acc: 0.8676
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3073 - acc: 0.8668
1344/2995 [============>.................] - ETA: 0s - loss: 0.3000 - acc: 0.8705
1472/2995 [=============>................] - ETA: 0s - loss: 0.2968 - acc: 0.8716
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2950 - acc: 0.8712
1728/2995 [================>.............] - ETA: 0s - loss: 0.3004 - acc: 0.8709
1856/2995 [=================>............] - ETA: 0s - loss: 0.3003 - acc: 0.8718
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3019 - acc: 0.8710
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2974 - acc: 0.8731
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2926 - acc: 0.8763
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2913 - acc: 0.8767
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2927 - acc: 0.8758
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2900 - acc: 0.8758
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2912 - acc: 0.8743
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2927 - acc: 0.8733
2995/2995 [==============================] - 2s 524us/step - loss: 0.2938 - acc: 0.8735

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  147

choose_one :  186

F1score :  0.8977272727272727

AUC :  0.9546930235913715

Confusion Matrix
[[139  28]
 [  8 158]]
True label 0
0.8323353293413174  
0.16766467065868262  
True label 1
0.04819277108433735  
0.9518072289156626  

Train_result {'loss': [0.29383985717626965], 'acc': [0.8734557597187406]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2818 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2716 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2511 - acc: 0.9125
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2706 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2678 - acc: 0.8976
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2583 - acc: 0.8977
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2586 - acc: 0.8942
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2688 - acc: 0.8906
1088/2995 [=========>....................] - ETA: 0s - loss: 0.2742 - acc: 0.8897
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2790 - acc: 0.8898
1344/2995 [============>.................] - ETA: 0s - loss: 0.2772 - acc: 0.8899
1472/2995 [=============>................] - ETA: 0s - loss: 0.2832 - acc: 0.8865
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2804 - acc: 0.8875
1728/2995 [================>.............] - ETA: 0s - loss: 0.2790 - acc: 0.8883
1856/2995 [=================>............] - ETA: 0s - loss: 0.2785 - acc: 0.8869
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2775 - acc: 0.8861
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2824 - acc: 0.8845
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2849 - acc: 0.8835
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2853 - acc: 0.8839
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2842 - acc: 0.8834
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2812 - acc: 0.8849
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2856 - acc: 0.8826
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2855 - acc: 0.8823
2995/2995 [==============================] - 2s 503us/step - loss: 0.2886 - acc: 0.8811

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  189

choose_one :  144

F1score :  0.8580645161290323

AUC :  0.9548733857586033

Confusion Matrix
[[156  11]
 [ 33 133]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.19879518072289157  
0.8012048192771084  

Train_result {'loss': [0.288550445432456], 'acc': [0.8811352255348371]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2660 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2391 - acc: 0.8906
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2131 - acc: 0.9062
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2416 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2392 - acc: 0.9010
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2317 - acc: 0.9077
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2473 - acc: 0.9002
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2458 - acc: 0.9010
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2428 - acc: 0.9026
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2552 - acc: 0.8972
1344/2995 [============>.................] - ETA: 0s - loss: 0.2606 - acc: 0.8958
1472/2995 [=============>................] - ETA: 0s - loss: 0.2593 - acc: 0.8940
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2651 - acc: 0.8919
1728/2995 [================>.............] - ETA: 0s - loss: 0.2680 - acc: 0.8883
1856/2995 [=================>............] - ETA: 0s - loss: 0.2683 - acc: 0.8906
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2687 - acc: 0.8911
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2710 - acc: 0.8887
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2713 - acc: 0.8893
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2746 - acc: 0.8877
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2734 - acc: 0.8886
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2721 - acc: 0.8883
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2785 - acc: 0.8844
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2789 - acc: 0.8840
2995/2995 [==============================] - 2s 528us/step - loss: 0.2799 - acc: 0.8848

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  173

choose_one :  160

F1score :  0.8773006134969326

AUC :  0.9555046533439145

Confusion Matrix
[[150  17]
 [ 23 143]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.13855421686746988  
0.8614457831325302  

Train_result {'loss': [0.27993462124531576], 'acc': [0.8848080134152968]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2129 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2936 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2547 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2691 - acc: 0.8839
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2753 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2714 - acc: 0.8849
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2670 - acc: 0.8846
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2797 - acc: 0.8823
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2735 - acc: 0.8833
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2702 - acc: 0.8824
1344/2995 [============>.................] - ETA: 0s - loss: 0.2724 - acc: 0.8795
1472/2995 [=============>................] - ETA: 0s - loss: 0.2736 - acc: 0.8825
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2669 - acc: 0.8875
1728/2995 [================>.............] - ETA: 0s - loss: 0.2696 - acc: 0.8860
1856/2995 [=================>............] - ETA: 0s - loss: 0.2683 - acc: 0.8879
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2661 - acc: 0.8886
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2705 - acc: 0.8873
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2731 - acc: 0.8862
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2765 - acc: 0.8843
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2774 - acc: 0.8858
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2760 - acc: 0.8857
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2753 - acc: 0.8844
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2757 - acc: 0.8861
2995/2995 [==============================] - 2s 537us/step - loss: 0.2768 - acc: 0.8851

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  166

choose_one :  167

F1score :  0.9009009009009009

AUC :  0.9573984560998485

Confusion Matrix
[[150  17]
 [ 16 150]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.2768074412775756], 'acc': [0.8851419032714601]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2463 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2926 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2822 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2816 - acc: 0.8705
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2654 - acc: 0.8785
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2529 - acc: 0.8864
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2720 - acc: 0.8870
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2744 - acc: 0.8875
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2876 - acc: 0.8778
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2842 - acc: 0.8791
1344/2995 [============>.................] - ETA: 0s - loss: 0.2792 - acc: 0.8795
1472/2995 [=============>................] - ETA: 0s - loss: 0.2776 - acc: 0.8777
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2776 - acc: 0.8775
1728/2995 [================>.............] - ETA: 0s - loss: 0.2719 - acc: 0.8796
1856/2995 [=================>............] - ETA: 0s - loss: 0.2753 - acc: 0.8777
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2772 - acc: 0.8760
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2735 - acc: 0.8774
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2709 - acc: 0.8781
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2694 - acc: 0.8788
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2663 - acc: 0.8798
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2706 - acc: 0.8788
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2704 - acc: 0.8797
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2709 - acc: 0.8799
2995/2995 [==============================] - 2s 525us/step - loss: 0.2705 - acc: 0.8805

Test accuracy: 86.18618618618619

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  191

choose_one :  142

F1score :  0.8506493506493508

AUC :  0.9561539571459491

Confusion Matrix
[[156  11]
 [ 35 131]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.21084337349397592  
0.7891566265060241  

Train_result {'loss': [0.2705361772409465], 'acc': [0.8804674458225104]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.3660 - acc: 0.8438
 192/2995 [>.............................] - ETA: 1s - loss: 0.3023 - acc: 0.8646
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2987 - acc: 0.8594
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2784 - acc: 0.8661
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2725 - acc: 0.8733
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2647 - acc: 0.8807
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2662 - acc: 0.8810
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2589 - acc: 0.8885
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2616 - acc: 0.8888
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2657 - acc: 0.8849
1344/2995 [============>.................] - ETA: 0s - loss: 0.2609 - acc: 0.8884
1472/2995 [=============>................] - ETA: 0s - loss: 0.2651 - acc: 0.8852
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2655 - acc: 0.8869
1728/2995 [================>.............] - ETA: 0s - loss: 0.2744 - acc: 0.8854
1856/2995 [=================>............] - ETA: 0s - loss: 0.2713 - acc: 0.8890
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2740 - acc: 0.8886
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2747 - acc: 0.8868
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2694 - acc: 0.8888
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2689 - acc: 0.8881
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2684 - acc: 0.8882
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2685 - acc: 0.8887
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2708 - acc: 0.8870
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2724 - acc: 0.8865
2995/2995 [==============================] - 2s 537us/step - loss: 0.2695 - acc: 0.8865

Test accuracy: 86.78678678678679

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  187

choose_one :  146

F1score :  0.858974358974359

AUC :  0.9586249188370248

Confusion Matrix
[[155  12]
 [ 32 134]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1927710843373494  
0.8072289156626506  

Train_result {'loss': [0.2694999748408695], 'acc': [0.8864774625568039]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2875 - acc: 0.8750
 192/2995 [>.............................] - ETA: 1s - loss: 0.2275 - acc: 0.8958
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2227 - acc: 0.9062
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2238 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2059 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2201 - acc: 0.9077
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2285 - acc: 0.9038
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2344 - acc: 0.9031
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2271 - acc: 0.9053
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2310 - acc: 0.9054
1344/2995 [============>.................] - ETA: 0s - loss: 0.2347 - acc: 0.9025
1472/2995 [=============>................] - ETA: 0s - loss: 0.2394 - acc: 0.8995
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2461 - acc: 0.8962
1728/2995 [================>.............] - ETA: 0s - loss: 0.2434 - acc: 0.8964
1856/2995 [=================>............] - ETA: 0s - loss: 0.2406 - acc: 0.9009
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2434 - acc: 0.9002
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2444 - acc: 0.8991
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2505 - acc: 0.8982
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2562 - acc: 0.8953
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2565 - acc: 0.8958
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2556 - acc: 0.8967
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2563 - acc: 0.8964
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2567 - acc: 0.8955
2995/2995 [==============================] - 2s 529us/step - loss: 0.2589 - acc: 0.8955

Test accuracy: 89.1891891891892

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  143

choose_one :  190

F1score :  0.898876404494382

AUC :  0.9554325084770218

Confusion Matrix
[[137  30]
 [  6 160]]
True label 0
0.8203592814371258  
0.17964071856287425  
True label 1
0.03614457831325301  
0.963855421686747  

Train_result {'loss': [0.25894707281123813], 'acc': [0.8954924875786388]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2682 - acc: 0.8906
 192/2995 [>.............................] - ETA: 1s - loss: 0.2673 - acc: 0.8906
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2422 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2282 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2296 - acc: 0.9028
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2357 - acc: 0.9006
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2356 - acc: 0.8990
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2297 - acc: 0.9010
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2301 - acc: 0.9026
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2307 - acc: 0.9021
1344/2995 [============>.................] - ETA: 0s - loss: 0.2290 - acc: 0.9025
1472/2995 [=============>................] - ETA: 0s - loss: 0.2279 - acc: 0.9029
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2304 - acc: 0.9025
1728/2995 [================>.............] - ETA: 0s - loss: 0.2351 - acc: 0.9016
1856/2995 [=================>............] - ETA: 0s - loss: 0.2351 - acc: 0.8987
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2415 - acc: 0.8972
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2458 - acc: 0.8944
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2447 - acc: 0.8938
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2483 - acc: 0.8932
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2538 - acc: 0.8914
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2623 - acc: 0.8864
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2618 - acc: 0.8870
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2596 - acc: 0.8875
2995/2995 [==============================] - 2s 521us/step - loss: 0.2620 - acc: 0.8858

Test accuracy: 90.69069069069069

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.9074626865671641

AUC :  0.9573263112329558

Confusion Matrix
[[150  17]
 [ 14 152]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.26196999191640813], 'acc': [0.8858096829837869]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1171 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2627 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2688 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2789 - acc: 0.8772
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2638 - acc: 0.8819
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2595 - acc: 0.8878
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2709 - acc: 0.8834
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2659 - acc: 0.8865
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2709 - acc: 0.8842
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2657 - acc: 0.8882
1344/2995 [============>.................] - ETA: 0s - loss: 0.2714 - acc: 0.8847
1472/2995 [=============>................] - ETA: 0s - loss: 0.2732 - acc: 0.8845
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2698 - acc: 0.8838
1728/2995 [================>.............] - ETA: 0s - loss: 0.2712 - acc: 0.8819
1856/2995 [=================>............] - ETA: 0s - loss: 0.2701 - acc: 0.8847
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2658 - acc: 0.8871
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2614 - acc: 0.8897
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2591 - acc: 0.8897
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2582 - acc: 0.8910
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2599 - acc: 0.8902
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2592 - acc: 0.8906
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2617 - acc: 0.8881
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2594 - acc: 0.8885
2995/2995 [==============================] - 2s 524us/step - loss: 0.2611 - acc: 0.8885

Test accuracy: 90.69069069069069

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  158

choose_one :  175

F1score :  0.909090909090909

AUC :  0.9542240819565688

Confusion Matrix
[[147  20]
 [ 11 155]]
True label 0
0.8802395209580839  
0.11976047904191617  
True label 1
0.06626506024096386  
0.9337349397590361  

Train_result {'loss': [0.26111371372896364], 'acc': [0.8884808014549676]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2613 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2366 - acc: 0.8802
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2168 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2377 - acc: 0.8951
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2706 - acc: 0.8819
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2629 - acc: 0.8892
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2524 - acc: 0.8918
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2660 - acc: 0.8896
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2615 - acc: 0.8925
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2574 - acc: 0.8947
1344/2995 [============>.................] - ETA: 0s - loss: 0.2588 - acc: 0.8936
1472/2995 [=============>................] - ETA: 0s - loss: 0.2511 - acc: 0.8954
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2600 - acc: 0.8906
1728/2995 [================>.............] - ETA: 0s - loss: 0.2596 - acc: 0.8912
1856/2995 [=================>............] - ETA: 0s - loss: 0.2611 - acc: 0.8890
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2607 - acc: 0.8896
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2618 - acc: 0.8883
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2593 - acc: 0.8897
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2577 - acc: 0.8889
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2564 - acc: 0.8894
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2561 - acc: 0.8891
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2551 - acc: 0.8899
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2594 - acc: 0.8896
2995/2995 [==============================] - 2s 537us/step - loss: 0.2606 - acc: 0.8885

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  185

choose_one :  148

F1score :  0.8726114649681529

AUC :  0.9571279128490009

Confusion Matrix
[[156  11]
 [ 29 137]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.1746987951807229  
0.8253012048192772  

Train_result {'loss': [0.2605731485085018], 'acc': [0.8884808014549676]}
Saved model to disk


[[86.18618618618619, 1], [86.78678678678679, 2], [87.08708708708708, 3], [89.4894894894895, 4], [87.38738738738738, 5], [89.1891891891892, 6], [86.78678678678679, 7], [87.98798798798799, 8], [90.09009009009009, 9], [86.18618618618619, 10], [86.78678678678679, 11], [89.1891891891892, 12], [90.69069069069069, 13], [90.69069069069069, 14], [87.98798798798799, 15]]
max accuracy :  [90.69069069069069, 14]

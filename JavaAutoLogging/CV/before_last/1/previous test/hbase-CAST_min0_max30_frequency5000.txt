Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoLogging/model.py:22: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-09-07 16:02:02.868631: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-09-07 16:02:02.878087: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-09-07 16:02:02.880485: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xaceda30 executing computations on platform Host. Devices:
2019-09-07 16:02:02.880507: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
39451

one : 
9019

Sentence length Average : 85

Under 10 : 7243
Over 10, Under 30 : 16559
Over 30, Under 100 : 12738
Over 100, Under 150 : 3895
Over 150, Under 200 : 2319
Over 200, Under 400 : 3915
Over 400 : 1801

After set document size of train data, the number of zero and one label data :  23498 1497
After set document size of test data, the number of zero and one label data :  2610 166
After balance out data.

Sentence length Average : 24

Under 10 : 817
Over 10, Under 30 : 1434
Over 30, Under 100 : 728
Over 100, Under 150 : 2
Over 150, Under 200 : 1
Over 200, Under 400 : 8
Over 400 : 5


Sentence length Average : 22

Under 10 : 104
Over 10, Under 30 : 144
Over 30, Under 100 : 84
Over 100, Under 150 : 0
Over 150, Under 200 : 0
Over 200, Under 400 : 1
Over 400 : 0

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 30, 200)      0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 30, 200)      0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/2995 [..............................] - ETA: 1:14 - loss: 0.6939 - acc: 0.5469
 192/2995 [>.............................] - ETA: 24s - loss: 0.6789 - acc: 0.6146 
 320/2995 [==>...........................] - ETA: 14s - loss: 0.6584 - acc: 0.6406
 448/2995 [===>..........................] - ETA: 10s - loss: 0.6180 - acc: 0.6696
 576/2995 [====>.........................] - ETA: 7s - loss: 0.6082 - acc: 0.6788 
 704/2995 [======>.......................] - ETA: 6s - loss: 0.5851 - acc: 0.6932
 832/2995 [=======>......................] - ETA: 5s - loss: 0.5678 - acc: 0.7091
 960/2995 [========>.....................] - ETA: 4s - loss: 0.5529 - acc: 0.7229
1088/2995 [=========>....................] - ETA: 3s - loss: 0.5345 - acc: 0.7316
1216/2995 [===========>..................] - ETA: 3s - loss: 0.5199 - acc: 0.7442
1344/2995 [============>.................] - ETA: 2s - loss: 0.5073 - acc: 0.7500
1472/2995 [=============>................] - ETA: 2s - loss: 0.5060 - acc: 0.7507
1600/2995 [===============>..............] - ETA: 2s - loss: 0.4984 - acc: 0.7612
1728/2995 [================>.............] - ETA: 1s - loss: 0.4891 - acc: 0.7679
1856/2995 [=================>............] - ETA: 1s - loss: 0.4796 - acc: 0.7753
1984/2995 [==================>...........] - ETA: 1s - loss: 0.4747 - acc: 0.7812
2112/2995 [====================>.........] - ETA: 1s - loss: 0.4649 - acc: 0.7869
2240/2995 [=====================>........] - ETA: 0s - loss: 0.4579 - acc: 0.7893
2368/2995 [======================>.......] - ETA: 0s - loss: 0.4574 - acc: 0.7910
2496/2995 [========================>.....] - ETA: 0s - loss: 0.4489 - acc: 0.7961
2624/2995 [=========================>....] - ETA: 0s - loss: 0.4446 - acc: 0.7976
2752/2995 [==========================>...] - ETA: 0s - loss: 0.4430 - acc: 0.7972
2880/2995 [===========================>..] - ETA: 0s - loss: 0.4383 - acc: 0.8000
2995/2995 [==============================] - 3s 1ms/step - loss: 0.4354 - acc: 0.8017

Test accuracy: 86.48648648648648

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  184

choose_one :  149

F1score :  0.8571428571428572

AUC :  0.9484524926051512

Confusion Matrix
[[153  14]
 [ 31 135]]
True label 0
0.9161676646706587  
0.08383233532934131  
True label 1
0.18674698795180722  
0.8132530120481928  

Train_result {'loss': [0.43538753479868425], 'acc': [0.8016694491813099]}
Saved model to disk


2

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3689 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.3514 - acc: 0.8333
 320/2995 [==>...........................] - ETA: 1s - loss: 0.3478 - acc: 0.8313
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3278 - acc: 0.8460
 576/2995 [====>.........................] - ETA: 1s - loss: 0.3199 - acc: 0.8507
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3090 - acc: 0.8608
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3064 - acc: 0.8642
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3080 - acc: 0.8667
1088/2995 [=========>....................] - ETA: 1s - loss: 0.3091 - acc: 0.8686
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3086 - acc: 0.8684
1344/2995 [============>.................] - ETA: 0s - loss: 0.3035 - acc: 0.8713
1472/2995 [=============>................] - ETA: 0s - loss: 0.3071 - acc: 0.8702
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3149 - acc: 0.8675
1728/2995 [================>.............] - ETA: 0s - loss: 0.3145 - acc: 0.8675
1856/2995 [=================>............] - ETA: 0s - loss: 0.3115 - acc: 0.8691
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3126 - acc: 0.8710
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3156 - acc: 0.8707
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3142 - acc: 0.8719
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3195 - acc: 0.8687
2496/2995 [========================>.....] - ETA: 0s - loss: 0.3198 - acc: 0.8682
2624/2995 [=========================>....] - ETA: 0s - loss: 0.3202 - acc: 0.8678
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3172 - acc: 0.8692
2880/2995 [===========================>..] - ETA: 0s - loss: 0.3186 - acc: 0.8681
2995/2995 [==============================] - 2s 536us/step - loss: 0.3166 - acc: 0.8684

Test accuracy: 87.68768768768768

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  186

choose_one :  147

F1score :  0.8690095846645367

AUC :  0.9549094581920495

Confusion Matrix
[[156  11]
 [ 30 136]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.18072289156626506  
0.8192771084337349  

Train_result {'loss': [0.3166390865195375], 'acc': [0.8684474124534302]}
Saved model to disk


3

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.2826 - acc: 0.8750
 192/2995 [>.............................] - ETA: 2s - loss: 0.3041 - acc: 0.8698
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2854 - acc: 0.8750
 448/2995 [===>..........................] - ETA: 1s - loss: 0.3182 - acc: 0.8616
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2991 - acc: 0.8733
 704/2995 [======>.......................] - ETA: 1s - loss: 0.3034 - acc: 0.8750
 832/2995 [=======>......................] - ETA: 1s - loss: 0.3094 - acc: 0.8654
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3025 - acc: 0.8667
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2981 - acc: 0.8695
1216/2995 [===========>..................] - ETA: 1s - loss: 0.3068 - acc: 0.8651
1344/2995 [============>.................] - ETA: 0s - loss: 0.3079 - acc: 0.8661
1472/2995 [=============>................] - ETA: 0s - loss: 0.3083 - acc: 0.8675
1600/2995 [===============>..............] - ETA: 0s - loss: 0.3058 - acc: 0.8675
1728/2995 [================>.............] - ETA: 0s - loss: 0.3090 - acc: 0.8646
1856/2995 [=================>............] - ETA: 0s - loss: 0.3096 - acc: 0.8626
1984/2995 [==================>...........] - ETA: 0s - loss: 0.3085 - acc: 0.8639
2112/2995 [====================>.........] - ETA: 0s - loss: 0.3070 - acc: 0.8632
2240/2995 [=====================>........] - ETA: 0s - loss: 0.3067 - acc: 0.8647
2368/2995 [======================>.......] - ETA: 0s - loss: 0.3049 - acc: 0.8661
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2975 - acc: 0.8710
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2981 - acc: 0.8720
2752/2995 [==========================>...] - ETA: 0s - loss: 0.3008 - acc: 0.8685
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2986 - acc: 0.8701
2995/2995 [==============================] - 2s 552us/step - loss: 0.2977 - acc: 0.8701

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8814589665653495

AUC :  0.9555226895606378

Confusion Matrix
[[149  18]
 [ 21 145]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.12650602409638553  
0.8734939759036144  

Train_result {'loss': [0.29767089181630957], 'acc': [0.87011686163474]}
Saved model to disk


4

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.4486 - acc: 0.8281
 192/2995 [>.............................] - ETA: 1s - loss: 0.2770 - acc: 0.9010
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2830 - acc: 0.8938
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2832 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2802 - acc: 0.8906
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2955 - acc: 0.8821
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2993 - acc: 0.8810
 960/2995 [========>.....................] - ETA: 1s - loss: 0.3061 - acc: 0.8729
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2990 - acc: 0.8750
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2951 - acc: 0.8766
1344/2995 [============>.................] - ETA: 0s - loss: 0.2899 - acc: 0.8780
1472/2995 [=============>................] - ETA: 0s - loss: 0.2876 - acc: 0.8777
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2775 - acc: 0.8838
1728/2995 [================>.............] - ETA: 0s - loss: 0.2768 - acc: 0.8831
1856/2995 [=================>............] - ETA: 0s - loss: 0.2744 - acc: 0.8836
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2767 - acc: 0.8816
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2758 - acc: 0.8807
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2732 - acc: 0.8835
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2758 - acc: 0.8826
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2748 - acc: 0.8838
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2743 - acc: 0.8845
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2692 - acc: 0.8866
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2705 - acc: 0.8851
2995/2995 [==============================] - 2s 547us/step - loss: 0.2754 - acc: 0.8838

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  155

choose_one :  178

F1score :  0.9069767441860466

AUC :  0.9584084842363466

Confusion Matrix
[[145  22]
 [ 10 156]]
True label 0
0.8682634730538922  
0.1317365269461078  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.2753869636727494], 'acc': [0.8838063440856233]}
Saved model to disk


5

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2652 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.2483 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2570 - acc: 0.8875
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2401 - acc: 0.8906
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2547 - acc: 0.8958
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2603 - acc: 0.8977
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2582 - acc: 0.8966
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2646 - acc: 0.8948
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2694 - acc: 0.8925
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2674 - acc: 0.8923
1344/2995 [============>.................] - ETA: 0s - loss: 0.2719 - acc: 0.8862
1472/2995 [=============>................] - ETA: 0s - loss: 0.2718 - acc: 0.8859
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2653 - acc: 0.8900
1728/2995 [================>.............] - ETA: 0s - loss: 0.2674 - acc: 0.8906
1856/2995 [=================>............] - ETA: 0s - loss: 0.2660 - acc: 0.8917
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2646 - acc: 0.8931
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2658 - acc: 0.8906
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2637 - acc: 0.8915
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2663 - acc: 0.8902
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2657 - acc: 0.8902
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2640 - acc: 0.8910
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2608 - acc: 0.8924
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2639 - acc: 0.8910
2995/2995 [==============================] - 2s 547us/step - loss: 0.2619 - acc: 0.8925

Test accuracy: 88.28828828828829

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8777429467084639

AUC :  0.9602842507755573

Confusion Matrix
[[154  13]
 [ 26 140]]
True label 0
0.9221556886227545  
0.07784431137724551  
True label 1
0.1566265060240964  
0.8433734939759037  

Train_result {'loss': [0.26193731300321366], 'acc': [0.8924874791716892]}
Saved model to disk


6

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2087 - acc: 0.8594
 192/2995 [>.............................] - ETA: 1s - loss: 0.2392 - acc: 0.8854
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2239 - acc: 0.8969
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2391 - acc: 0.8884
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2472 - acc: 0.8872
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2639 - acc: 0.8835
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2636 - acc: 0.8822
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2755 - acc: 0.8771
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2739 - acc: 0.8787
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2676 - acc: 0.8832
1344/2995 [============>.................] - ETA: 0s - loss: 0.2600 - acc: 0.8869
1472/2995 [=============>................] - ETA: 0s - loss: 0.2580 - acc: 0.8879
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2532 - acc: 0.8888
1728/2995 [================>.............] - ETA: 0s - loss: 0.2558 - acc: 0.8895
1856/2995 [=================>............] - ETA: 0s - loss: 0.2519 - acc: 0.8906
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2511 - acc: 0.8921
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2485 - acc: 0.8930
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2470 - acc: 0.8960
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2434 - acc: 0.8982
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2435 - acc: 0.8974
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2424 - acc: 0.8971
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2443 - acc: 0.8961
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2450 - acc: 0.8958
2995/2995 [==============================] - 2s 527us/step - loss: 0.2463 - acc: 0.8948

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  148

choose_one :  185

F1score :  0.8945868945868947

AUC :  0.9607171199769137

Confusion Matrix
[[139  28]
 [  9 157]]
True label 0
0.8323353293413174  
0.16766467065868262  
True label 1
0.05421686746987952  
0.9457831325301205  

Train_result {'loss': [0.246334146358732], 'acc': [0.8948247080056217]}
Saved model to disk


7

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2057 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2274 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2251 - acc: 0.9000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2286 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2217 - acc: 0.9062
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2256 - acc: 0.9048
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2293 - acc: 0.9002
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2324 - acc: 0.8990
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2412 - acc: 0.8989
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2389 - acc: 0.9013
1344/2995 [============>.................] - ETA: 0s - loss: 0.2304 - acc: 0.9055
1472/2995 [=============>................] - ETA: 0s - loss: 0.2317 - acc: 0.9015
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2301 - acc: 0.9025
1728/2995 [================>.............] - ETA: 0s - loss: 0.2304 - acc: 0.9034
1856/2995 [=================>............] - ETA: 0s - loss: 0.2330 - acc: 0.8998
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2335 - acc: 0.8997
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2368 - acc: 0.8982
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2396 - acc: 0.8982
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2417 - acc: 0.8974
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2388 - acc: 0.8986
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2360 - acc: 0.8994
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2424 - acc: 0.8968
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2419 - acc: 0.8965
2995/2995 [==============================] - 2s 524us/step - loss: 0.2429 - acc: 0.8965

Test accuracy: 87.98798798798799

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  183

choose_one :  150

F1score :  0.8734177215189873

AUC :  0.9601760334752182

Confusion Matrix
[[155  12]
 [ 28 138]]
True label 0
0.9281437125748503  
0.0718562874251497  
True label 1
0.1686746987951807  
0.8313253012048193  

Train_result {'loss': [0.24290126918353303], 'acc': [0.896494157047622]}
Saved model to disk


8

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.1742 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.1871 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1769 - acc: 0.9219
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1901 - acc: 0.9174
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1968 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1952 - acc: 0.9162
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1894 - acc: 0.9195
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1936 - acc: 0.9177
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1932 - acc: 0.9219
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1992 - acc: 0.9169
1344/2995 [============>.................] - ETA: 0s - loss: 0.2040 - acc: 0.9167
1472/2995 [=============>................] - ETA: 0s - loss: 0.2083 - acc: 0.9137
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2133 - acc: 0.9106
1728/2995 [================>.............] - ETA: 0s - loss: 0.2205 - acc: 0.9068
1856/2995 [=================>............] - ETA: 0s - loss: 0.2182 - acc: 0.9084
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2197 - acc: 0.9078
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2244 - acc: 0.9072
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2238 - acc: 0.9071
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2281 - acc: 0.9054
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2272 - acc: 0.9058
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2272 - acc: 0.9043
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2315 - acc: 0.9026
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2319 - acc: 0.9021
2995/2995 [==============================] - 2s 545us/step - loss: 0.2351 - acc: 0.9015

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  166

choose_one :  167

F1score :  0.888888888888889

AUC :  0.9575066734001876

Confusion Matrix
[[148  19]
 [ 18 148]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.10843373493975904  
0.891566265060241  

Train_result {'loss': [0.23514662015318671], 'acc': [0.9015025042532282]}
Saved model to disk


9

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.2035 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2541 - acc: 0.9062
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2506 - acc: 0.9062
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2367 - acc: 0.9062
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2393 - acc: 0.8993
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2297 - acc: 0.9062
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2256 - acc: 0.9099
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2303 - acc: 0.9042
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2281 - acc: 0.9035
1216/2995 [===========>..................] - ETA: 0s - loss: 0.2243 - acc: 0.9038
1344/2995 [============>.................] - ETA: 0s - loss: 0.2289 - acc: 0.9025
1472/2995 [=============>................] - ETA: 0s - loss: 0.2261 - acc: 0.9042
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2238 - acc: 0.9069
1728/2995 [================>.............] - ETA: 0s - loss: 0.2206 - acc: 0.9080
1856/2995 [=================>............] - ETA: 0s - loss: 0.2180 - acc: 0.9079
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2160 - acc: 0.9093
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2223 - acc: 0.9062
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2237 - acc: 0.9062
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2256 - acc: 0.9050
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2265 - acc: 0.9038
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2267 - acc: 0.9040
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2257 - acc: 0.9033
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2243 - acc: 0.9049
2995/2995 [==============================] - 2s 528us/step - loss: 0.2257 - acc: 0.9045

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  160

choose_one :  173

F1score :  0.896755162241888

AUC :  0.9573623836664021

Confusion Matrix
[[146  21]
 [ 14 152]]
True label 0
0.874251497005988  
0.12574850299401197  
True label 1
0.08433734939759036  
0.9156626506024096  

Train_result {'loss': [0.22569543677001247], 'acc': [0.9045075125805723]}
Saved model to disk


10

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1753 - acc: 0.9219
 192/2995 [>.............................] - ETA: 1s - loss: 0.2304 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2218 - acc: 0.9000
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2225 - acc: 0.9040
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2155 - acc: 0.9062
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2005 - acc: 0.9148
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2107 - acc: 0.9171
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2131 - acc: 0.9156
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2285 - acc: 0.9072
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2264 - acc: 0.9054
1344/2995 [============>.................] - ETA: 0s - loss: 0.2256 - acc: 0.9040
1472/2995 [=============>................] - ETA: 0s - loss: 0.2210 - acc: 0.9056
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2196 - acc: 0.9050
1728/2995 [================>.............] - ETA: 0s - loss: 0.2151 - acc: 0.9062
1856/2995 [=================>............] - ETA: 0s - loss: 0.2188 - acc: 0.9052
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2220 - acc: 0.9042
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2197 - acc: 0.9058
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2192 - acc: 0.9054
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2179 - acc: 0.9062
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2134 - acc: 0.9087
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2160 - acc: 0.9089
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2171 - acc: 0.9070
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2169 - acc: 0.9069
2995/2995 [==============================] - 2s 538us/step - loss: 0.2158 - acc: 0.9082

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  180

choose_one :  153

F1score :  0.8902821316614421

AUC :  0.9607531924103601

Confusion Matrix
[[156  11]
 [ 24 142]]
True label 0
0.9341317365269461  
0.0658682634730539  
True label 1
0.14457831325301204  
0.8554216867469879  

Train_result {'loss': [0.21583366136320048], 'acc': [0.9081803005804403]}
Saved model to disk


11

Epoch 1/1

  64/2995 [..............................] - ETA: 2s - loss: 0.3538 - acc: 0.9062
 192/2995 [>.............................] - ETA: 1s - loss: 0.2690 - acc: 0.9167
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2790 - acc: 0.9062
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2563 - acc: 0.9129
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2449 - acc: 0.9132
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2247 - acc: 0.9190
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2220 - acc: 0.9171
 960/2995 [========>.....................] - ETA: 1s - loss: 0.2119 - acc: 0.9198
1088/2995 [=========>....................] - ETA: 1s - loss: 0.2098 - acc: 0.9191
1216/2995 [===========>..................] - ETA: 1s - loss: 0.2092 - acc: 0.9153
1344/2995 [============>.................] - ETA: 0s - loss: 0.2051 - acc: 0.9159
1472/2995 [=============>................] - ETA: 0s - loss: 0.2074 - acc: 0.9164
1600/2995 [===============>..............] - ETA: 0s - loss: 0.2097 - acc: 0.9169
1728/2995 [================>.............] - ETA: 0s - loss: 0.2142 - acc: 0.9161
1856/2995 [=================>............] - ETA: 0s - loss: 0.2154 - acc: 0.9159
1984/2995 [==================>...........] - ETA: 0s - loss: 0.2168 - acc: 0.9153
2112/2995 [====================>.........] - ETA: 0s - loss: 0.2184 - acc: 0.9152
2240/2995 [=====================>........] - ETA: 0s - loss: 0.2141 - acc: 0.9174
2368/2995 [======================>.......] - ETA: 0s - loss: 0.2143 - acc: 0.9160
2496/2995 [========================>.....] - ETA: 0s - loss: 0.2113 - acc: 0.9163
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2090 - acc: 0.9173
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2113 - acc: 0.9153
2880/2995 [===========================>..] - ETA: 0s - loss: 0.2135 - acc: 0.9132
2995/2995 [==============================] - 2s 538us/step - loss: 0.2113 - acc: 0.9135

Test accuracy: 88.88888888888889

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  170

choose_one :  163

F1score :  0.8875379939209727

AUC :  0.9589134983045956

Confusion Matrix
[[150  17]
 [ 20 146]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.12048192771084337  
0.8795180722891566  

Train_result {'loss': [0.21130621314347287], 'acc': [0.9135225376621112]}
Saved model to disk


12

Epoch 1/1

  64/2995 [..............................] - ETA: 3s - loss: 0.2164 - acc: 0.9062
 192/2995 [>.............................] - ETA: 2s - loss: 0.1758 - acc: 0.9375
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1672 - acc: 0.9375
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1715 - acc: 0.9420
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1630 - acc: 0.9427
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1682 - acc: 0.9347
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1654 - acc: 0.9339
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1742 - acc: 0.9313
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1717 - acc: 0.9320
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1782 - acc: 0.9317
1344/2995 [============>.................] - ETA: 1s - loss: 0.1782 - acc: 0.9301
1472/2995 [=============>................] - ETA: 0s - loss: 0.1822 - acc: 0.9266
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1892 - acc: 0.9225
1728/2995 [================>.............] - ETA: 0s - loss: 0.1905 - acc: 0.9207
1856/2995 [=================>............] - ETA: 0s - loss: 0.1876 - acc: 0.9219
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1880 - acc: 0.9234
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1911 - acc: 0.9223
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1934 - acc: 0.9219
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1947 - acc: 0.9215
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1927 - acc: 0.9207
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1926 - acc: 0.9211
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1921 - acc: 0.9215
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1943 - acc: 0.9201
2995/2995 [==============================] - 2s 560us/step - loss: 0.1960 - acc: 0.9189

Test accuracy: 90.09009009009009

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  154

choose_one :  179

F1score :  0.9043478260869566

AUC :  0.9569295144650458

Confusion Matrix
[[144  23]
 [ 10 156]]
True label 0
0.8622754491017964  
0.1377245508982036  
True label 1
0.060240963855421686  
0.9397590361445783  

Train_result {'loss': [0.1960322261901451], 'acc': [0.9188647747238808]}
Saved model to disk


13

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1652 - acc: 0.9375
 192/2995 [>.............................] - ETA: 1s - loss: 0.1858 - acc: 0.9219
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1688 - acc: 0.9281
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1745 - acc: 0.9330
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1739 - acc: 0.9323
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1761 - acc: 0.9304
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1724 - acc: 0.9315
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1769 - acc: 0.9313
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1829 - acc: 0.9292
1216/2995 [===========>..................] - ETA: 0s - loss: 0.1793 - acc: 0.9309
1344/2995 [============>.................] - ETA: 0s - loss: 0.1809 - acc: 0.9301
1472/2995 [=============>................] - ETA: 0s - loss: 0.1758 - acc: 0.9334
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1768 - acc: 0.9325
1728/2995 [================>.............] - ETA: 0s - loss: 0.1829 - acc: 0.9306
1856/2995 [=================>............] - ETA: 0s - loss: 0.1839 - acc: 0.9300
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1893 - acc: 0.9269
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1897 - acc: 0.9266
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1892 - acc: 0.9272
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1931 - acc: 0.9261
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1957 - acc: 0.9251
2624/2995 [=========================>....] - ETA: 0s - loss: 0.2020 - acc: 0.9211
2752/2995 [==========================>...] - ETA: 0s - loss: 0.2012 - acc: 0.9201
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1991 - acc: 0.9208
2995/2995 [==============================] - 2s 526us/step - loss: 0.2011 - acc: 0.9199

Test accuracy: 89.4894894894895

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  164

choose_one :  169

F1score :  0.8955223880597014

AUC :  0.9606089026765746

Confusion Matrix
[[148  19]
 [ 16 150]]
True label 0
0.8862275449101796  
0.11377245508982035  
True label 1
0.0963855421686747  
0.9036144578313253  

Train_result {'loss': [0.20108953770592136], 'acc': [0.9198664441530613]}
Saved model to disk


14

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.0672 - acc: 0.9844
 192/2995 [>.............................] - ETA: 1s - loss: 0.1876 - acc: 0.9115
 320/2995 [==>...........................] - ETA: 1s - loss: 0.2145 - acc: 0.9031
 448/2995 [===>..........................] - ETA: 1s - loss: 0.2228 - acc: 0.8996
 576/2995 [====>.........................] - ETA: 1s - loss: 0.2106 - acc: 0.9097
 704/2995 [======>.......................] - ETA: 1s - loss: 0.2023 - acc: 0.9119
 832/2995 [=======>......................] - ETA: 1s - loss: 0.2005 - acc: 0.9147
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1930 - acc: 0.9156
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1962 - acc: 0.9118
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1911 - acc: 0.9153
1344/2995 [============>.................] - ETA: 0s - loss: 0.1870 - acc: 0.9174
1472/2995 [=============>................] - ETA: 0s - loss: 0.1849 - acc: 0.9198
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1836 - acc: 0.9231
1728/2995 [================>.............] - ETA: 0s - loss: 0.1840 - acc: 0.9248
1856/2995 [=================>............] - ETA: 0s - loss: 0.1837 - acc: 0.9256
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1817 - acc: 0.9264
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1781 - acc: 0.9290
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1794 - acc: 0.9281
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1801 - acc: 0.9278
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1826 - acc: 0.9279
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1836 - acc: 0.9272
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1855 - acc: 0.9244
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1886 - acc: 0.9229
2995/2995 [==============================] - 2s 556us/step - loss: 0.1894 - acc: 0.9232

Test accuracy: 90.39039039039038

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  165

choose_one :  168

F1score :  0.9041916167664671

AUC :  0.9591299329052737

Confusion Matrix
[[150  17]
 [ 15 151]]
True label 0
0.8982035928143712  
0.10179640718562874  
True label 1
0.09036144578313253  
0.9096385542168675  

Train_result {'loss': [0.18935596207545477], 'acc': [0.9232053423166673]}
Saved model to disk


15

Epoch 1/1

  64/2995 [..............................] - ETA: 1s - loss: 0.1179 - acc: 0.9688
 192/2995 [>.............................] - ETA: 1s - loss: 0.1633 - acc: 0.9479
 320/2995 [==>...........................] - ETA: 1s - loss: 0.1460 - acc: 0.9437
 448/2995 [===>..........................] - ETA: 1s - loss: 0.1586 - acc: 0.9442
 576/2995 [====>.........................] - ETA: 1s - loss: 0.1669 - acc: 0.9427
 704/2995 [======>.......................] - ETA: 1s - loss: 0.1662 - acc: 0.9446
 832/2995 [=======>......................] - ETA: 1s - loss: 0.1572 - acc: 0.9459
 960/2995 [========>.....................] - ETA: 1s - loss: 0.1657 - acc: 0.9417
1088/2995 [=========>....................] - ETA: 1s - loss: 0.1724 - acc: 0.9366
1216/2995 [===========>..................] - ETA: 1s - loss: 0.1696 - acc: 0.9375
1344/2995 [============>.................] - ETA: 0s - loss: 0.1790 - acc: 0.9338
1472/2995 [=============>................] - ETA: 0s - loss: 0.1753 - acc: 0.9334
1600/2995 [===============>..............] - ETA: 0s - loss: 0.1760 - acc: 0.9313
1728/2995 [================>.............] - ETA: 0s - loss: 0.1772 - acc: 0.9300
1856/2995 [=================>............] - ETA: 0s - loss: 0.1833 - acc: 0.9273
1984/2995 [==================>...........] - ETA: 0s - loss: 0.1858 - acc: 0.9274
2112/2995 [====================>.........] - ETA: 0s - loss: 0.1862 - acc: 0.9276
2240/2995 [=====================>........] - ETA: 0s - loss: 0.1851 - acc: 0.9268
2368/2995 [======================>.......] - ETA: 0s - loss: 0.1844 - acc: 0.9265
2496/2995 [========================>.....] - ETA: 0s - loss: 0.1830 - acc: 0.9267
2624/2995 [=========================>....] - ETA: 0s - loss: 0.1825 - acc: 0.9276
2752/2995 [==========================>...] - ETA: 0s - loss: 0.1835 - acc: 0.9270
2880/2995 [===========================>..] - ETA: 0s - loss: 0.1853 - acc: 0.9264
2995/2995 [==============================] - 2s 538us/step - loss: 0.1853 - acc: 0.9255

Test accuracy: 89.7897897897898

data size :  3328

zero :  1665

one :  1663

train_zero :  1498

train_one :  1497

test_zero :  167

test_one :  166

choose_zero :  169

choose_one :  164

F1score :  0.896969696969697

AUC :  0.9560637760623332

Confusion Matrix
[[151  16]
 [ 18 148]]
True label 0
0.9041916167664671  
0.09580838323353294  
True label 1
0.10843373493975904  
0.891566265060241  

Train_result {'loss': [0.18526384651859934], 'acc': [0.9255425710112901]}
Saved model to disk


[[86.48648648648648, 1], [87.68768768768768, 2], [88.28828828828829, 3], [90.39039039039038, 4], [88.28828828828829, 5], [88.88888888888889, 6], [87.98798798798799, 7], [88.88888888888889, 8], [89.4894894894895, 9], [89.4894894894895, 10], [88.88888888888889, 11], [90.09009009009009, 12], [89.4894894894895, 13], [90.39039039039038, 14], [89.7897897897898, 15]]
max accuracy :  [90.39039039039038, 14]

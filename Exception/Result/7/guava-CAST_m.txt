Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 07:19:13.206861: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 07:19:13.215785: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-05 07:19:13.218273: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7d46d70 executing computations on platform Host. Devices:
2019-07-05 07:19:13.218351: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34860
Over 200, Under 400 : 313
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34269
Over 200, Under 400 : 904
Over 400 : 0


Test_zero:  2404
Train_zero:  21789
zero:  24193
Test_one:  1557
Train_one:  13384
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1101s - loss: 0.2692 - acc: 0.8921

Test accuracy: 92.10272873194222

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1664

choose_one :  1451

F1score :  0.918218085106383

AUC : 0.9769280808110788

Confusion Matrix
[[1488   70]
 [ 176 1381]]
True label 0
0.9550706033376123  
0.044929396662387676  
True label 1
0.11303789338471419  
0.8869621066152859  

Train_result {'loss': [0.26924445358172466], 'acc': [0.8920766558332399]}
Saved model to disk



2

Epoch 1/1
 - 1111s - loss: 0.1761 - acc: 0.9343

Test accuracy: 94.44622792937399

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1631

choose_one :  1484

F1score :  0.9431108188096021

AUC : 0.9844196114610978

Confusion Matrix
[[1508   50]
 [ 123 1434]]
True label 0
0.9679075738125802  
0.03209242618741977  
True label 1
0.0789980732177264  
0.9210019267822736  

Train_result {'loss': [0.17614048460964027], 'acc': [0.9342523067727595]}
Saved model to disk



3

Epoch 1/1
 - 1111s - loss: 0.1307 - acc: 0.9528

Test accuracy: 95.53772070626003

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1557

choose_one :  1558

F1score :  0.9553772070626004

AUC : 0.9908978706458803

Confusion Matrix
[[1488   70]
 [  69 1488]]
True label 0
0.9550706033376123  
0.044929396662387676  
True label 1
0.04431599229287091  
0.9556840077071291  

Train_result {'loss': [0.1306762512213278], 'acc': [0.9527812021368001]}
Saved model to disk



4

Epoch 1/1
 - 1110s - loss: 0.1001 - acc: 0.9644

Test accuracy: 95.79454253611557

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1525

choose_one :  1590

F1score :  0.9583730537019384

AUC : 0.9922607166442824

Confusion Matrix
[[1476   82]
 [  49 1508]]
True label 0
0.9473684210526315  
0.05263157894736842  
True label 1
0.03147077713551702  
0.968529222864483  

Train_result {'loss': [0.10014681367432449], 'acc': [0.9643991183854311]}
Saved model to disk



5

Epoch 1/1
 - 1111s - loss: 0.0759 - acc: 0.9725

Test accuracy: 97.20706260032102

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1579

choose_one :  1536

F1score :  0.9718719689621726

AUC : 0.9944521532224754

Confusion Matrix
[[1525   33]
 [  54 1503]]
True label 0
0.978818998716303  
0.021181001283697046  
True label 1
0.03468208092485549  
0.9653179190751445  

Train_result {'loss': [0.07588345973775297], 'acc': [0.9725428667488513]}
Saved model to disk



6

Epoch 1/1
 - 1112s - loss: 0.0565 - acc: 0.9814

Test accuracy: 97.68860353130016

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1556

choose_one :  1559

F1score :  0.9768934531450578

AUC : 0.9952642544374943

Confusion Matrix
[[1521   37]
 [  35 1522]]
True label 0
0.9762516046213093  
0.02374839537869063  
True label 1
0.0224791265253693  
0.9775208734746307  

Train_result {'loss': [0.05654718151795016], 'acc': [0.9814337479920804]}
Saved model to disk



7

Epoch 1/1
 - 1112s - loss: 0.0469 - acc: 0.9848

Test accuracy: 97.65650080256822

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1593

choose_one :  1522

F1score :  0.9762910035725885

AUC : 0.995236634751501

Confusion Matrix
[[1539   19]
 [  54 1503]]
True label 0
0.9878048780487805  
0.012195121951219513  
True label 1
0.03468208092485549  
0.9653179190751445  

Train_result {'loss': [0.046936328967473684], 'acc': [0.9847584892973216]}
Saved model to disk



8

Epoch 1/1
 - 1111s - loss: 0.0408 - acc: 0.9864

Test accuracy: 97.65650080256822

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1537

choose_one :  1578

F1score :  0.9767145135566188

AUC : 0.9956136228536002

Confusion Matrix
[[1511   47]
 [  26 1531]]
True label 0
0.9698331193838254  
0.030166880616174584  
True label 1
0.016698779704560053  
0.98330122029544  

Train_result {'loss': [0.040828796092459194], 'acc': [0.9864395382741082]}
Saved model to disk



9

Epoch 1/1
 - 1111s - loss: 0.0337 - acc: 0.9897

Test accuracy: 98.3948635634029

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1560

choose_one :  1555

F1score :  0.9839331619537275

AUC : 0.9967610765246686

Confusion Matrix
[[1534   24]
 [  26 1531]]
True label 0
0.9845956354300385  
0.01540436456996149  
True label 1
0.016698779704560053  
0.98330122029544  

Train_result {'loss': [0.03365998023529572], 'acc': [0.9897269229332437]}
Saved model to disk



10

Epoch 1/1
 - 1111s - loss: 0.0281 - acc: 0.9911

Test accuracy: 98.23434991974318

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1563

choose_one :  1552

F1score :  0.982309424252171

AUC : 0.9958368476292003

Confusion Matrix
[[1533   25]
 [  30 1527]]
True label 0
0.9839537869062901  
0.016046213093709884  
True label 1
0.019267822736030827  
0.9807321772639692  

Train_result {'loss': [0.028078783500060024], 'acc': [0.9911464754028766]}
Saved model to disk



11

Epoch 1/1
 - 1122s - loss: 0.0250 - acc: 0.9918

Test accuracy: 98.61958266452649

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1549

choose_one :  1566

F1score :  0.9862311879602945

AUC : 0.9964405644969136

Confusion Matrix
[[1532   26]
 [  17 1540]]
True label 0
0.9833119383825417  
0.01668806161745828  
True label 1
0.010918432883750802  
0.9890815671162492  

Train_result {'loss': [0.025000662393833348], 'acc': [0.991781538346595]}
Saved model to disk



12

Epoch 1/1
 - 1122s - loss: 0.0228 - acc: 0.9935

Test accuracy: 98.23434991974318

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1549

choose_one :  1566

F1score :  0.9823887287864234

AUC : 0.9963500791077275

Confusion Matrix
[[1526   32]
 [  23 1534]]
True label 0
0.9794608472400513  
0.02053915275994865  
True label 1
0.014771997430956968  
0.9852280025690431  

Train_result {'loss': [0.02283750554361986], 'acc': [0.9934999439650342]}
Saved model to disk



13

Epoch 1/1
 - 1122s - loss: 0.0212 - acc: 0.9939

Test accuracy: 98.20224719101124

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1568

choose_one :  1547

F1score :  0.981958762886598

AUC : 0.9969692547549145

Confusion Matrix
[[1535   23]
 [  33 1524]]
True label 0
0.9852374839537869  
0.014762516046213094  
True label 1
0.02119460500963391  
0.9788053949903661  

Train_result {'loss': [0.021153772992713975], 'acc': [0.9939482236938102]}
Saved model to disk



14

Epoch 1/1
 - 1122s - loss: 0.0210 - acc: 0.9941

Test accuracy: 98.49117174959872

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1537

choose_one :  1578

F1score :  0.9850079744816587

AUC : 0.9959188822189409

Confusion Matrix
[[1524   34]
 [  13 1544]]
True label 0
0.9781771501925546  
0.021822849807445442  
True label 1
0.008349389852280027  
0.9916506101477199  

Train_result {'loss': [0.020956398918633545], 'acc': [0.9941350069109791]}
Saved model to disk



15

Epoch 1/1
 - 1123s - loss: 0.0174 - acc: 0.9954

Test accuracy: 98.36276083467095

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1537

choose_one :  1578

F1score :  0.9837320574162679

AUC : 0.9938548259836112

Confusion Matrix
[[1522   36]
 [  15 1542]]
True label 0
0.9768934531450578  
0.023106546854942234  
True label 1
0.009633911368015413  
0.9903660886319846  

Train_result {'loss': [0.017442881587275166], 'acc': [0.9953677761589899]}
Saved model to disk




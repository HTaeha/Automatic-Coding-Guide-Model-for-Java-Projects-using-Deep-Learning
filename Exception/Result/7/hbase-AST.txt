Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 11:03:14.249095: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 11:03:14.256272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-04 11:03:14.259160: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6865e30 executing computations on platform Host. Devices:
2019-07-04 11:03:14.259228: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-AST
all data

Sentence length Average : 43

Under 10 : 19700
Over 10, Under 200 : 27623
Over 200, Under 400 : 1629
Over 400 : 301

hbase-AST
updated_train_data

Sentence length Average : 66

Under 10 : 0
Over 10, Under 200 : 24868
Over 200, Under 400 : 1702
Over 400 : 0


Test_zero:  1160
Train_zero:  10389
zero:  11549
Test_one:  1821
Train_one:  16181
one:  18002

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 496s - loss: 0.5017 - acc: 0.7524

Test accuracy: 80.31021111589833

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1411

choose_one :  910

F1score :  0.779333655239015

AUC : 0.9056119872880097

Confusion Matrix
[[1057  103]
 [ 354  807]]
True label 0
0.9112068965517242  
0.08879310344827586  
True label 1
0.3049095607235142  
0.6950904392764858  

Train_result {'loss': [0.5016702456816], 'acc': [0.7524423696973096]}
Saved model to disk



2

Epoch 1/1
 - 494s - loss: 0.4189 - acc: 0.7984

Test accuracy: 80.78414476518742

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1334

choose_one :  987

F1score :  0.792364990689013

AUC : 0.9090572930588969

Confusion Matrix
[[1024  136]
 [ 310  851]]
True label 0
0.8827586206896552  
0.11724137931034483  
True label 1
0.2670111972437554  
0.7329888027562446  

Train_result {'loss': [0.41892957388192964], 'acc': [0.7983541075238664]}
Saved model to disk



3

Epoch 1/1
 - 494s - loss: 0.3913 - acc: 0.8090

Test accuracy: 81.81818181818183

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1244

choose_one :  1077

F1score :  0.8114387846291331

AUC : 0.9099386676170957

Confusion Matrix
[[991 169]
 [253 908]]
True label 0
0.8543103448275862  
0.1456896551724138  
True label 1
0.21791559000861327  
0.7820844099913867  

Train_result {'loss': [0.39130507714709717], 'acc': [0.8089898455113717]}
Saved model to disk



4

Epoch 1/1
 - 499s - loss: 0.3668 - acc: 0.8271

Test accuracy: 83.23998276604911

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1155

choose_one :  1166

F1score :  0.832831972496777

AUC : 0.9212331818586831

Confusion Matrix
[[963 197]
 [192 969]]
True label 0
0.8301724137931035  
0.16982758620689656  
True label 1
0.165374677002584  
0.834625322997416  

Train_result {'loss': [0.36681493484708283], 'acc': [0.8270850377871319]}
Saved model to disk



5

Epoch 1/1
 - 499s - loss: 0.3483 - acc: 0.8387

Test accuracy: 82.98147350280051

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1257

choose_one :  1064

F1score :  0.8224719101123595

AUC : 0.9247052184502064

Confusion Matrix
[[1011  149]
 [ 246  915]]
True label 0
0.871551724137931  
0.12844827586206897  
True label 1
0.21188630490956073  
0.7881136950904393  

Train_result {'loss': [0.34834154851426635], 'acc': [0.8387314115355899]}
Saved model to disk



6

Epoch 1/1
 - 499s - loss: 0.3317 - acc: 0.8461

Test accuracy: 82.80913399396812

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1409

choose_one :  912

F1score :  0.8075253256150506

AUC : 0.9282960586890017

Confusion Matrix
[[1085   75]
 [ 324  837]]
True label 0
0.9353448275862069  
0.06465517241379311  
True label 1
0.27906976744186046  
0.7209302325581395  

Train_result {'loss': [0.3316763471757329], 'acc': [0.8460946147495447]}
Saved model to disk



7

Epoch 1/1
 - 500s - loss: 0.3135 - acc: 0.8559

Test accuracy: 83.28306764325721

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1080

choose_one :  1241

F1score :  0.8384679433805163

AUC : 0.9282656152543882

Confusion Matrix
[[ 926  234]
 [ 154 1007]]
True label 0
0.7982758620689655  
0.20172413793103447  
True label 1
0.1326442721791559  
0.8673557278208441  

Train_result {'loss': [0.31347256887262565], 'acc': [0.8558640935531255]}
Saved model to disk



8

Epoch 1/1
 - 497s - loss: 0.2935 - acc: 0.8657

Test accuracy: 83.88625592417061

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1286

choose_one :  1035

F1score :  0.8296903460837887

AUC : 0.9312275386854376

Confusion Matrix
[[1036  124]
 [ 250  911]]
True label 0
0.8931034482758621  
0.10689655172413794  
True label 1
0.2153316106804479  
0.7846683893195521  

Train_result {'loss': [0.2934913492244639], 'acc': [0.865729823376505]}
Saved model to disk



9

Epoch 1/1
 - 498s - loss: 0.2782 - acc: 0.8726

Test accuracy: 84.44635932787592

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1265

choose_one :  1056

F1score :  0.8371673432566531

AUC : 0.9324482461611573

Confusion Matrix
[[1032  128]
 [ 233  928]]
True label 0
0.8896551724137931  
0.1103448275862069  
True label 1
0.20068906115417742  
0.7993109388458226  

Train_result {'loss': [0.2781813440957274], 'acc': [0.8726117714972037]}
Saved model to disk



10

Epoch 1/1
 - 499s - loss: 0.2578 - acc: 0.8854

Test accuracy: 84.40327445066782

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1176

choose_one :  1145

F1score :  0.8430182133564614

AUC : 0.9322611304167039

Confusion Matrix
[[987 173]
 [189 972]]
True label 0
0.8508620689655172  
0.14913793103448275  
True label 1
0.16279069767441862  
0.8372093023255814  

Train_result {'loss': [0.25777823555038665], 'acc': [0.8854131575119301]}
Saved model to disk



11

Epoch 1/1
 - 500s - loss: 0.2373 - acc: 0.8949

Test accuracy: 85.26497199482982

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1248

choose_one :  1073

F1score :  0.846911369740376

AUC : 0.9327979743978141

Confusion Matrix
[[1033  127]
 [ 215  946]]
True label 0
0.8905172413793103  
0.10948275862068965  
True label 1
0.18518518518518517  
0.8148148148148148  

Train_result {'loss': [0.23728285314023734], 'acc': [0.894942008770317]}
Saved model to disk



12

Epoch 1/1
 - 497s - loss: 0.2221 - acc: 0.9058

Test accuracy: 85.17880224041362

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1134

choose_one :  1187

F1score :  0.8534923339011924

AUC : 0.9342629718732365

Confusion Matrix
[[ 975  185]
 [ 159 1002]]
True label 0
0.8405172413793104  
0.15948275862068967  
True label 1
0.13695090439276486  
0.8630490956072352  

Train_result {'loss': [0.2220957725514068], 'acc': [0.9057702488088936]}
Saved model to disk



13

Epoch 1/1
 - 499s - loss: 0.2092 - acc: 0.9114

Test accuracy: 83.88625592417061

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1002

choose_one :  1319

F1score :  0.8491935483870967

AUC : 0.9348477085746533

Confusion Matrix
[[ 894  266]
 [ 108 1053]]
True label 0
0.7706896551724138  
0.2293103448275862  
True label 1
0.09302325581395349  
0.9069767441860465  

Train_result {'loss': [0.20920061427456071], 'acc': [0.9114490591433849]}
Saved model to disk



14

Epoch 1/1
 - 500s - loss: 0.1945 - acc: 0.9172

Test accuracy: 83.84317104696251

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1299

choose_one :  1022

F1score :  0.8282180485570315

AUC : 0.9277929994950844

Confusion Matrix
[[1042  118]
 [ 257  904]]
True label 0
0.8982758620689655  
0.10172413793103448  
True label 1
0.22136089577950044  
0.7786391042204995  

Train_result {'loss': [0.19447041277282134], 'acc': [0.9172241205206229]}
Saved model to disk



15

Epoch 1/1
 - 501s - loss: 0.1802 - acc: 0.9261

Test accuracy: 84.83412322274881

data size :  23100

zero :  11549

one :  11551

train_zero :  10389

train_one :  10390

test_zero :  1160

test_one :  1161

choose_zero :  1174

choose_one :  1147

F1score :  0.8474870017331022

AUC : 0.9312598384270396

Confusion Matrix
[[991 169]
 [183 978]]
True label 0
0.8543103448275862  
0.1456896551724138  
True label 1
0.15762273901808785  
0.8423772609819121  

Train_result {'loss': [0.180233364698087], 'acc': [0.9261273401173311]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 07:44:17.655436: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 07:44:17.666307: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-05 07:44:17.668670: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6d373a0 executing computations on platform Host. Devices:
2019-07-05 07:44:17.668706: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34990
Over 200, Under 400 : 308
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34390
Over 200, Under 400 : 908
Over 400 : 0


Test_zero:  2396
Train_zero:  21797
zero:  24193
Test_one:  1440
Train_one:  13501
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1092s - loss: 0.2673 - acc: 0.8900

Test accuracy: 90.80180492884415

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1362

choose_one :  1519

F1score :  0.9104427171341669

AUC : 0.9713263358778627

Confusion Matrix
[[1269  172]
 [  93 1347]]
True label 0
0.8806384455239417  
0.1193615544760583  
True label 1
0.06458333333333334  
0.9354166666666667  

Train_result {'loss': [0.26725757541433287], 'acc': [0.8900122208488971]}
Saved model to disk



2

Epoch 1/1
 - 1091s - loss: 0.1737 - acc: 0.9337

Test accuracy: 94.61992363762583

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1550

choose_one :  1331

F1score :  0.9440635149765427

AUC : 0.9842422314750561

Confusion Matrix
[[1418   23]
 [ 132 1308]]
True label 0
0.9840388619014573  
0.015961138098542677  
True label 1
0.09166666666666666  
0.9083333333333333  

Train_result {'loss': [0.17367802218247824], 'acc': [0.9337110691250146]}
Saved model to disk



3

Epoch 1/1
 - 1091s - loss: 0.1299 - acc: 0.9516

Test accuracy: 95.80006942034017

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1504

choose_one :  1377

F1score :  0.9570465033723821

AUC : 0.990844995759118

Confusion Matrix
[[1412   29]
 [  92 1348]]
True label 0
0.9798750867453158  
0.020124913254684247  
True label 1
0.06388888888888888  
0.9361111111111111  

Train_result {'loss': [0.12988951386391964], 'acc': [0.9515609376802139]}
Saved model to disk



4

Epoch 1/1
 - 1116s - loss: 0.0962 - acc: 0.9659

Test accuracy: 96.87608469281498

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1455

choose_one :  1426

F1score :  0.9685973482205164

AUC : 0.9940846923432802

Confusion Matrix
[[1403   38]
 [  52 1388]]
True label 0
0.9736294240111034  
0.0263705759888966  
True label 1
0.03611111111111111  
0.9638888888888889  

Train_result {'loss': [0.09619836958668583], 'acc': [0.9658926785978896]}
Saved model to disk



5

Epoch 1/1
 - 1104s - loss: 0.0746 - acc: 0.9740

Test accuracy: 97.57028809441167

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1451

choose_one :  1430

F1score :  0.975609756097561

AUC : 0.996475730588326

Confusion Matrix
[[1411   30]
 [  40 1400]]
True label 0
0.9791811242192922  
0.020818875780707843  
True label 1
0.027777777777777776  
0.9722222222222222  

Train_result {'loss': [0.0745664742851035], 'acc': [0.9739658556302176]}
Saved model to disk



6

Epoch 1/1
 - 1091s - loss: 0.0566 - acc: 0.9814

Test accuracy: 98.09094064560917

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1452

choose_one :  1429

F1score :  0.9808295573370512

AUC : 0.9974130619168786

Confusion Matrix
[[1419   22]
 [  33 1407]]
True label 0
0.9847328244274809  
0.015267175572519083  
True label 1
0.022916666666666665  
0.9770833333333333  

Train_result {'loss': [0.056591718186378544], 'acc': [0.981446505943784]}
Saved model to disk



7

Epoch 1/1
 - 1098s - loss: 0.0458 - acc: 0.9852

Test accuracy: 98.0215203054495

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1454

choose_one :  1427

F1score :  0.9801185908615277

AUC : 0.9972841487393013

Confusion Matrix
[[1419   22]
 [  35 1405]]
True label 0
0.9847328244274809  
0.015267175572519083  
True label 1
0.024305555555555556  
0.9756944444444444  

Train_result {'loss': [0.045808779617439684], 'acc': [0.9852238640371828]}
Saved model to disk



8

Epoch 1/1
 - 1102s - loss: 0.0394 - acc: 0.9879

Test accuracy: 98.78514404720583

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1434

choose_one :  1447

F1score :  0.9878766886040873

AUC : 0.9983270202020201

Confusion Matrix
[[1420   21]
 [  14 1426]]
True label 0
0.9854267869535045  
0.01457321304649549  
True label 1
0.009722222222222222  
0.9902777777777778  

Train_result {'loss': [0.039439395085977845], 'acc': [0.9878532014961301]}
Saved model to disk



9

Epoch 1/1
 - 1104s - loss: 0.0325 - acc: 0.9895

Test accuracy: 98.4380423464075

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1436

choose_one :  1445

F1score :  0.9844020797227037

AUC : 0.9979426902613925

Confusion Matrix
[[1416   25]
 [  20 1420]]
True label 0
0.9826509368494102  
0.01734906315058987  
True label 1
0.013888888888888888  
0.9861111111111112  

Train_result {'loss': [0.03247527263179914], 'acc': [0.9894826500759175]}
Saved model to disk



10

Epoch 1/1
 - 1102s - loss: 0.0312 - acc: 0.9913

Test accuracy: 98.88927455744533

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1437

choose_one :  1444

F1score :  0.9889042995839112

AUC : 0.998361477369111

Confusion Matrix
[[1423   18]
 [  14 1426]]
True label 0
0.9875086745315753  
0.012491325468424705  
True label 1
0.009722222222222222  
0.9902777777777778  

Train_result {'loss': [0.03117558965787117], 'acc': [0.9912602303447765]}
Saved model to disk



11

Epoch 1/1
 - 1101s - loss: 0.0227 - acc: 0.9934

Test accuracy: 98.61159319680667

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1415

choose_one :  1466

F1score :  0.9862353750860288

AUC : 0.9981595535507749

Confusion Matrix
[[1408   33]
 [   7 1433]]
True label 0
0.9770992366412213  
0.022900763358778626  
True label 1
0.004861111111111111  
0.9951388888888889  

Train_result {'loss': [0.022721833141585105], 'acc': [0.9933711069140466]}
Saved model to disk



12

Epoch 1/1
 - 1103s - loss: 0.0218 - acc: 0.9942

Test accuracy: 98.29920166608817

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1432

choose_one :  1449

F1score :  0.9830391138802353

AUC : 0.9974976385997378

Confusion Matrix
[[1412   29]
 [  20 1420]]
True label 0
0.9798750867453158  
0.020124913254684247  
True label 1
0.013888888888888888  
0.9861111111111112  

Train_result {'loss': [0.02177200538476108], 'acc': [0.9941858312039403]}
Saved model to disk



13

Epoch 1/1
 - 1102s - loss: 0.0214 - acc: 0.9943

Test accuracy: 99.20166608816383

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1426

choose_one :  1455

F1score :  0.9920552677029361

AUC : 0.9986236409900532

Confusion Matrix
[[1422   19]
 [   4 1436]]
True label 0
0.9868147120055517  
0.0131852879944483  
True label 1
0.002777777777777778  
0.9972222222222222  

Train_result {'loss': [0.021411569046014003], 'acc': [0.994296929970744]}
Saved model to disk



14

Epoch 1/1
 - 1102s - loss: 0.0239 - acc: 0.9947

Test accuracy: 99.02811523776467

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1429

choose_one :  1452

F1score :  0.9903181189488244

AUC : 0.9976619727812477

Confusion Matrix
[[1421   20]
 [   8 1432]]
True label 0
0.9861207494795281  
0.013879250520471894  
True label 1
0.005555555555555556  
0.9944444444444445  

Train_result {'loss': [0.023929522707162525], 'acc': [0.9946672591934229]}
Saved model to disk



15

Epoch 1/1
 - 1102s - loss: 0.0189 - acc: 0.9950

Test accuracy: 98.8545643873655

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1438

choose_one :  1443

F1score :  0.9885535900104059

AUC : 0.9976195639602128

Confusion Matrix
[[1423   18]
 [  15 1425]]
True label 0
0.9875086745315753  
0.012491325468424705  
True label 1
0.010416666666666666  
0.9895833333333334  

Train_result {'loss': [0.018893417188255636], 'acc': [0.995000555493834]}
Saved model to disk




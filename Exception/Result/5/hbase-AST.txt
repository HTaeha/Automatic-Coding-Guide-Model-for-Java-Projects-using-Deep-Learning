Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 11:19:27.489856: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 11:19:27.496009: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-04 11:19:27.499057: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6d4cb00 executing computations on platform Host. Devices:
2019-07-04 11:19:27.499104: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-AST
all data

Sentence length Average : 43

Under 10 : 19700
Over 10, Under 200 : 27623
Over 200, Under 400 : 1629
Over 400 : 301

hbase-AST
updated_train_data

Sentence length Average : 66

Under 10 : 0
Over 10, Under 200 : 24881
Over 200, Under 400 : 1734
Over 400 : 0


Test_zero:  1144
Train_zero:  10406
zero:  11550
Test_one:  1793
Train_one:  16209
one:  18002

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 503s - loss: 0.5029 - acc: 0.7520

Test accuracy: 73.52555701179554

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1644

choose_one :  645

F1score :  0.6614525139664805

AUC : 0.8815116651907045

Confusion Matrix
[[1091   53]
 [ 553  592]]
True label 0
0.9536713286713286  
0.04632867132867133  
True label 1
0.4829694323144105  
0.5170305676855895  

Train_result {'loss': [0.5028558358358912], 'acc': [0.7519819343765346]}
Saved model to disk



2

Epoch 1/1
 - 500s - loss: 0.4211 - acc: 0.7933

Test accuracy: 80.07863695937091

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1320

choose_one :  969

F1score :  0.7842951750236519

AUC : 0.8974627446789019

Confusion Matrix
[[1004  140]
 [ 316  829]]
True label 0
0.8776223776223776  
0.12237762237762238  
True label 1
0.2759825327510917  
0.7240174672489083  

Train_result {'loss': [0.4211432051436398], 'acc': [0.7932542161235197]}
Saved model to disk



3

Epoch 1/1
 - 501s - loss: 0.3941 - acc: 0.8112

Test accuracy: 80.82131935342944

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1383

choose_one :  906

F1score :  0.7859580692345196

AUC : 0.9096432497633372

Confusion Matrix
[[1044  100]
 [ 339  806]]
True label 0
0.9125874125874126  
0.08741258741258741  
True label 1
0.2960698689956332  
0.7039301310043669  

Train_result {'loss': [0.3940591212163911], 'acc': [0.811175707501966]}
Saved model to disk



4

Epoch 1/1
 - 500s - loss: 0.3715 - acc: 0.8241

Test accuracy: 82.69986893840104

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1128

choose_one :  1161

F1score :  0.8282740676496096

AUC : 0.9150964210462026

Confusion Matrix
[[938 206]
 [190 955]]
True label 0
0.8199300699300699  
0.18006993006993008  
True label 1
0.16593886462882096  
0.834061135371179  

Train_result {'loss': [0.3714764886900617], 'acc': [0.824052275034739]}
Saved model to disk



5

Epoch 1/1
 - 500s - loss: 0.3518 - acc: 0.8365

Test accuracy: 82.52512013979903

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  962

choose_one :  1327

F1score :  0.8381877022653722

AUC : 0.9209706232631997

Confusion Matrix
[[ 853  291]
 [ 109 1036]]
True label 0
0.7456293706293706  
0.2543706293706294  
True label 1
0.09519650655021834  
0.9048034934497816  

Train_result {'loss': [0.3517510879376549], 'acc': [0.8364964205121419]}
Saved model to disk



6

Epoch 1/1
 - 497s - loss: 0.3335 - acc: 0.8452

Test accuracy: 83.09305373525558

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1315

choose_one :  974

F1score :  0.8173666823973573

AUC : 0.9195861452957523

Confusion Matrix
[[1036  108]
 [ 279  866]]
True label 0
0.9055944055944056  
0.0944055944055944  
True label 1
0.24366812227074236  
0.7563318777292577  

Train_result {'loss': [0.3335163075556893], 'acc': [0.8452409551808395]}
Saved model to disk



7

Epoch 1/1
 - 499s - loss: 0.3140 - acc: 0.8561

Test accuracy: 84.05417212756662

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1137

choose_one :  1152

F1score :  0.8410970831519373

AUC : 0.9246889028002565

Confusion Matrix
[[958 186]
 [179 966]]
True label 0
0.8374125874125874  
0.16258741258741258  
True label 1
0.15633187772925763  
0.8436681222707424  

Train_result {'loss': [0.31396850561961615], 'acc': [0.8561476000662477]}
Saved model to disk



8

Epoch 1/1
 - 501s - loss: 0.2991 - acc: 0.8659

Test accuracy: 84.40366972477065

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1173

choose_one :  1116

F1score :  0.8421052631578946

AUC : 0.9271318746755428

Confusion Matrix
[[980 164]
 [193 952]]
True label 0
0.8566433566433567  
0.14335664335664336  
True label 1
0.1685589519650655  
0.8314410480349345  

Train_result {'loss': [0.2991255570151338], 'acc': [0.8659491663892569]}
Saved model to disk



9

Epoch 1/1
 - 501s - loss: 0.2802 - acc: 0.8745

Test accuracy: 84.53473132372214

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1174

choose_one :  1115

F1score :  0.8433628318584071

AUC : 0.9278441536629309

Confusion Matrix
[[982 162]
 [192 953]]
True label 0
0.8583916083916084  
0.14160839160839161  
True label 1
0.16768558951965065  
0.8323144104803494  

Train_result {'loss': [0.28021771584595895], 'acc': [0.8745015134857451]}
Saved model to disk



10

Epoch 1/1
 - 497s - loss: 0.2654 - acc: 0.8844

Test accuracy: 84.84054172127567

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1173

choose_one :  1116

F1score :  0.8465280849181779

AUC : 0.9310177268146701

Confusion Matrix
[[985 159]
 [188 957]]
True label 0
0.861013986013986  
0.13898601398601398  
True label 1
0.16419213973799127  
0.8358078602620087  

Train_result {'loss': [0.26544800152172443], 'acc': [0.8843511266996589]}
Saved model to disk



11

Epoch 1/1
 - 498s - loss: 0.2509 - acc: 0.8886

Test accuracy: 84.22892092616864

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1139

choose_one :  1150

F1score :  0.8427015250544662

AUC : 0.9267051180260787

Confusion Matrix
[[961 183]
 [178 967]]
True label 0
0.840034965034965  
0.15996503496503497  
True label 1
0.1554585152838428  
0.8445414847161572  

Train_result {'loss': [0.2509281097317996], 'acc': [0.8886273002450391]}
Saved model to disk



12

Epoch 1/1
 - 500s - loss: 0.2300 - acc: 0.9005

Test accuracy: 83.96679772826562

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1091

choose_one :  1198

F1score :  0.8433632095603926

AUC : 0.9283609949002962

Confusion Matrix
[[934 210]
 [157 988]]
True label 0
0.8164335664335665  
0.18356643356643357  
True label 1
0.137117903930131  
0.862882096069869  

Train_result {'loss': [0.22998002988671098], 'acc': [0.900542929899582]}
Saved model to disk



13

Epoch 1/1
 - 501s - loss: 0.2158 - acc: 0.9063

Test accuracy: 84.40366972477065

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1223

choose_one :  1066

F1score :  0.8385345997286295

AUC : 0.9244217027513971

Confusion Matrix
[[1005  139]
 [ 218  927]]
True label 0
0.8784965034965035  
0.1215034965034965  
True label 1
0.1903930131004367  
0.8096069868995633  

Train_result {'loss': [0.215827168405918], 'acc': [0.9063085571575078]}
Saved model to disk



14

Epoch 1/1
 - 497s - loss: 0.1960 - acc: 0.9168

Test accuracy: 84.57841852337266

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1151

choose_one :  1138

F1score :  0.8453788874288217

AUC : 0.9281899868690262

Confusion Matrix
[[971 173]
 [180 965]]
True label 0
0.8487762237762237  
0.15122377622377622  
True label 1
0.1572052401746725  
0.8427947598253275  

Train_result {'loss': [0.19598480251764097], 'acc': [0.9167827800018649]}
Saved model to disk



15

Epoch 1/1
 - 498s - loss: 0.1808 - acc: 0.9244

Test accuracy: 84.62210572302315

data size :  23102

zero :  11550

one :  11552

train_zero :  10406

train_one :  10407

test_zero :  1144

test_one :  1145

choose_zero :  1164

choose_one :  1125

F1score :  0.8449339207048459

AUC : 0.9307535804806547

Confusion Matrix
[[978 166]
 [186 959]]
True label 0
0.8548951048951049  
0.1451048951048951  
True label 1
0.16244541484716157  
0.8375545851528384  

Train_result {'loss': [0.1807874235125571], 'acc': [0.9243741892086677]}
Saved model to disk




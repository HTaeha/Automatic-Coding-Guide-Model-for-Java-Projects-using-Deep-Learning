Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 23:02:53.771501: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 23:02:53.780435: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-04 23:02:53.782428: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6c958b0 executing computations on platform Host. Devices:
2019-07-04 23:02:53.782463: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-code
all data

Sentence length Average : 60

Under 10 : 8815
Over 10, Under 200 : 37126
Over 200, Under 400 : 2541
Over 400 : 771

hbase-code
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 31855
Over 200, Under 400 : 2755
Over 400 : 0


Test_zero:  1709
Train_zero:  15732
zero:  17441
Test_one:  2106
Train_one:  18878
one:  20984

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 782s - loss: 0.3780 - acc: 0.8292

Test accuracy: 87.45247148288973

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1738

choose_one :  1681

F1score :  0.8734886464169862

AUC : 0.950652034807127

Confusion Matrix
[[1509  200]
 [ 229 1481]]
True label 0
0.8829724985371562  
0.11702750146284377  
True label 1
0.13391812865497077  
0.8660818713450292  

Train_result {'loss': [0.3779866337109622], 'acc': [0.8292070554584459]}
Saved model to disk



2

Epoch 1/1
 - 785s - loss: 0.2735 - acc: 0.8817

Test accuracy: 88.97338403041825

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1862

choose_one :  1557

F1score :  0.8846036118763393

AUC : 0.9599483641813721

Confusion Matrix
[[1597  112]
 [ 265 1445]]
True label 0
0.9344645991808075  
0.06553540081919251  
True label 1
0.15497076023391812  
0.8450292397660819  

Train_result {'loss': [0.27349362465936733], 'acc': [0.881709836327971]}
Saved model to disk



3

Epoch 1/1
 - 755s - loss: 0.2363 - acc: 0.9005

Test accuracy: 89.587598713074

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1671

choose_one :  1748

F1score :  0.8970503181029498

AUC : 0.9656498619280793

Confusion Matrix
[[1512  197]
 [ 159 1551]]
True label 0
0.8847279110590989  
0.11527208894090112  
True label 1
0.09298245614035087  
0.9070175438596492  

Train_result {'loss': [0.23629440714165761], 'acc': [0.9005243921836836]}
Saved model to disk



4

Epoch 1/1
 - 756s - loss: 0.2107 - acc: 0.9148

Test accuracy: 91.0207663059374

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1750

choose_one :  1669

F1score :  0.9091447173720035

AUC : 0.9701845065169262

Confusion Matrix
[[1576  133]
 [ 174 1536]]
True label 0
0.9221767115272089  
0.0778232884727911  
True label 1
0.10175438596491228  
0.8982456140350877  

Train_result {'loss': [0.21068957799401247], 'acc': [0.9147624344509773]}
Saved model to disk



5

Epoch 1/1
 - 759s - loss: 0.1827 - acc: 0.9259

Test accuracy: 91.40099444281954

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1741

choose_one :  1678

F1score :  0.9132231404958677

AUC : 0.973339458456948

Confusion Matrix
[[1578  131]
 [ 163 1547]]
True label 0
0.9233469865418373  
0.07665301345816267  
True label 1
0.09532163742690059  
0.9046783625730994  

Train_result {'loss': [0.18273472538599428], 'acc': [0.9258541236313238]}
Saved model to disk



6

Epoch 1/1
 - 753s - loss: 0.1638 - acc: 0.9359

Test accuracy: 91.22550453348933

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1727

choose_one :  1692

F1score :  0.9118165784832452

AUC : 0.9700459213178255

Confusion Matrix
[[1568  141]
 [ 159 1551]]
True label 0
0.9174956114686952  
0.08250438853130486  
True label 1
0.09298245614035087  
0.9070175438596492  

Train_result {'loss': [0.16384657025005714], 'acc': [0.9358970284461975]}
Saved model to disk



7

Epoch 1/1
 - 753s - loss: 0.1450 - acc: 0.9443

Test accuracy: 92.24919567124891

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1830

choose_one :  1589

F1score :  0.9196726280691118

AUC : 0.9730622880587465

Confusion Matrix
[[1637   72]
 [ 193 1517]]
True label 0
0.9578700994733762  
0.042129900526623756  
True label 1
0.11286549707602339  
0.8871345029239766  

Train_result {'loss': [0.14501387705973454], 'acc': [0.944255522008581]}
Saved model to disk



8

Epoch 1/1
 - 754s - loss: 0.1275 - acc: 0.9515

Test accuracy: 91.78122257970168

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1826

choose_one :  1593

F1score :  0.9149258250075689

AUC : 0.9726910165994272

Confusion Matrix
[[1627   82]
 [ 199 1511]]
True label 0
0.952018724400234  
0.04798127559976594  
True label 1
0.11637426900584795  
0.8836257309941521  

Train_result {'loss': [0.12748112834459616], 'acc': [0.9515016685205784]}
Saved model to disk



9

Epoch 1/1
 - 753s - loss: 0.1156 - acc: 0.9574

Test accuracy: 92.01520912547528

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1720

choose_one :  1699

F1score :  0.919917864476386

AUC : 0.9714475138499653

Confusion Matrix
[[1578  131]
 [ 142 1568]]
True label 0
0.9233469865418373  
0.07665301345816267  
True label 1
0.08304093567251462  
0.9169590643274854  

Train_result {'loss': [0.1155544632317369], 'acc': [0.9574447799141904]}
Saved model to disk



10

Epoch 1/1
 - 754s - loss: 0.0949 - acc: 0.9651

Test accuracy: 92.2199473530272

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1731

choose_one :  1688

F1score :  0.9217186580341377

AUC : 0.9751527003582684

Confusion Matrix
[[1587  122]
 [ 144 1566]]
True label 0
0.9286132241076653  
0.07138677589233469  
True label 1
0.08421052631578947  
0.9157894736842105  

Train_result {'loss': [0.09492726524888963], 'acc': [0.9651358652470999]}
Saved model to disk



11

Epoch 1/1
 - 752s - loss: 0.0846 - acc: 0.9706

Test accuracy: 92.10295408014039

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1745

choose_one :  1674

F1score :  0.9202127659574468

AUC : 0.9733100304887439

Confusion Matrix
[[1592  117]
 [ 153 1557]]
True label 0
0.9315389116442364  
0.0684610883557636  
True label 1
0.08947368421052632  
0.9105263157894737  

Train_result {'loss': [0.08464437032584027], 'acc': [0.9705704751310981]}
Saved model to disk



12

Epoch 1/1
 - 752s - loss: 0.0731 - acc: 0.9739

Test accuracy: 90.9037730330506

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1580

choose_one :  1839

F1score :  0.9123696816004507

AUC : 0.9731770913533102

Confusion Matrix
[[1489  220]
 [  91 1619]]
True label 0
0.8712697483908719  
0.12873025160912815  
True label 1
0.05321637426900585  
0.9467836257309942  

Train_result {'loss': [0.07314207023924257], 'acc': [0.9739392976360784]}
Saved model to disk



13

Epoch 1/1
 - 751s - loss: 0.0657 - acc: 0.9767

Test accuracy: 92.1906990348055

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1712

choose_one :  1707

F1score :  0.9218612818261632

AUC : 0.9729498800639204

Confusion Matrix
[[1577  132]
 [ 135 1575]]
True label 0
0.9227618490345231  
0.07723815096547688  
True label 1
0.07894736842105263  
0.9210526315789473  

Train_result {'loss': [0.06569090997874967], 'acc': [0.9767360559351661]}
Saved model to disk



14

Epoch 1/1
 - 752s - loss: 0.0610 - acc: 0.9805

Test accuracy: 92.10295408014039

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1805

choose_one :  1614

F1score :  0.9187725631768953

AUC : 0.9739346904417274

Confusion Matrix
[[1622   87]
 [ 183 1527]]
True label 0
0.949093036863663  
0.05090696313633704  
True label 1
0.10701754385964912  
0.8929824561403509  

Train_result {'loss': [0.06100592363505372], 'acc': [0.9805180359129191]}
Saved model to disk



15

Epoch 1/1
 - 755s - loss: 0.0544 - acc: 0.9817

Test accuracy: 92.62942380813102

data size :  34884

zero :  17441

one :  17443

train_zero :  15732

train_one :  15733

test_zero :  1709

test_one :  1710

choose_zero :  1741

choose_one :  1678

F1score :  0.9256198347107438

AUC : 0.975128405175216

Confusion Matrix
[[1599  110]
 [ 142 1568]]
True label 0
0.9356348741954359  
0.06436512580456408  
True label 1
0.08304093567251462  
0.9169590643274854  

Train_result {'loss': [0.05442157681680759], 'acc': [0.9816621643095503]}
Saved model to disk




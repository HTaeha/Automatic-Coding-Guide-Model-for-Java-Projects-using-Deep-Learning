Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:515: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 18:59:55.645163: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 18:59:55.920776: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-05 18:59:55.923372: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x69c88f0 executing computations on platform Host. Devices:
2019-07-05 18:59:55.923412: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34990
Over 200, Under 400 : 308
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34390
Over 200, Under 400 : 908
Over 400 : 0


Test_zero:  2396
Train_zero:  21797
zero:  24193
Test_one:  1440
Train_one:  13501
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1788s - loss: 0.3023 - acc: 0.8733

Test accuracy: 91.63484901076015

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1592

choose_one :  1289

F1score :  0.9116892634664713

AUC : 0.970812128922816

Confusion Matrix
[[1396   45]
 [ 196 1244]]
True label 0
0.9687716863289383  
0.031228313671061762  
True label 1
0.1361111111111111  
0.8638888888888889  

Train_result {'acc': [0.8733103729436006], 'loss': [0.3022886507895458]}
Saved model to disk



2

Epoch 1/1
 - 1792s - loss: 0.1923 - acc: 0.9257

Test accuracy: 93.92572023602915

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1476

choose_one :  1405

F1score :  0.9384885764499122

AUC : 0.9825709383915492

Confusion Matrix
[[1371   70]
 [ 105 1335]]
True label 0
0.9514226231783484  
0.048577376821651634  
True label 1
0.07291666666666667  
0.9270833333333334  

Train_result {'acc': [0.9257489908374169], 'loss': [0.1922620515113618]}
Saved model to disk



3

Epoch 1/1
 - 1787s - loss: 0.1486 - acc: 0.9460

Test accuracy: 94.51579312738633

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1543

choose_one :  1338

F1score :  0.9431245500359972

AUC : 0.9877009599814943

Confusion Matrix
[[1413   28]
 [ 130 1310]]
True label 0
0.9805690492713394  
0.01943095072866065  
True label 1
0.09027777777777778  
0.9097222222222222  

Train_result {'acc': [0.9460430322622972], 'loss': [0.14864917533327393]}
Saved model to disk



4

Epoch 1/1
 - 1787s - loss: 0.1161 - acc: 0.9587

Test accuracy: 95.45296771954183

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1522

choose_one :  1359

F1score :  0.9531975705609147

AUC : 0.9903756072172102

Confusion Matrix
[[1416   25]
 [ 106 1334]]
True label 0
0.9826509368494102  
0.01734906315058987  
True label 1
0.07361111111111111  
0.9263888888888889  

Train_result {'acc': [0.9586712587335765], 'loss': [0.11607997202450084]}
Saved model to disk



5

Epoch 1/1
 - 1785s - loss: 0.0910 - acc: 0.9682

Test accuracy: 96.42485248177715

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1452

choose_one :  1429

F1score :  0.9640989891948415

AUC : 0.9943201094918653

Confusion Matrix
[[1395   46]
 [  57 1383]]
True label 0
0.9680777238029147  
0.031922276197085354  
True label 1
0.03958333333333333  
0.9604166666666667  

Train_result {'acc': [0.9681516868496093], 'loss': [0.09097919255607231]}
Saved model to disk



6

Epoch 1/1
 - 1485s - loss: 0.0691 - acc: 0.9756

Test accuracy: 97.32731690385283

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1448

choose_one :  1433

F1score :  0.9731987469544031

AUC : 0.9958952598504125

Confusion Matrix
[[1406   35]
 [  42 1398]]
True label 0
0.9757113115891742  
0.024288688410825817  
True label 1
0.029166666666666667  
0.9708333333333333  

Train_result {'acc': [0.9755582712877372], 'loss': [0.06912630308061533]}
Saved model to disk



7

Epoch 1/1
 - 1342s - loss: 0.0558 - acc: 0.9817

Test accuracy: 97.77854911489067

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1441

choose_one :  1440

F1score :  0.9777777777777777

AUC : 0.9964595863212276

Confusion Matrix
[[1409   32]
 [  32 1408]]
True label 0
0.9777931991672449  
0.02220680083275503  
True label 1
0.022222222222222223  
0.9777777777777777  

Train_result {'acc': [0.9817057364217326], 'loss': [0.05577678979526119]}
Saved model to disk



8

Epoch 1/1
 - 1465s - loss: 0.0444 - acc: 0.9856

Test accuracy: 97.70912877473098

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1437

choose_one :  1444

F1score :  0.9771151178918169

AUC : 0.9971441514380445

Confusion Matrix
[[1406   35]
 [  31 1409]]
True label 0
0.9757113115891742  
0.024288688410825817  
True label 1
0.021527777777777778  
0.9784722222222222  

Train_result {'acc': [0.9855941932377884], 'loss': [0.044401520134604223]}
Saved model to disk



9

Epoch 1/1
 - 1440s - loss: 0.0391 - acc: 0.9878

Test accuracy: 97.91738979521

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1437

choose_one :  1444

F1score :  0.9791955617198337

AUC : 0.9969431914565502

Confusion Matrix
[[1409   32]
 [  28 1412]]
True label 0
0.9777931991672449  
0.02220680083275503  
True label 1
0.019444444444444445  
0.9805555555555555  

Train_result {'acc': [0.9877791356515943], 'loss': [0.03912688660595902]}
Saved model to disk



10

Epoch 1/1
 - 1490s - loss: 0.0358 - acc: 0.9898

Test accuracy: 98.12565081568899

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1415

choose_one :  1466

F1score :  0.9814177563661391

AUC : 0.9973364368879636

Confusion Matrix
[[1401   40]
 [  14 1426]]
True label 0
0.9722414989590562  
0.027758501040943788  
True label 1
0.009722222222222222  
0.9902777777777778  

Train_result {'acc': [0.9897789134540607], 'loss': [0.03583226612521433]}
Saved model to disk



11

Epoch 1/1
 - 1431s - loss: 0.0286 - acc: 0.9918

Test accuracy: 97.98681013536967

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1399

choose_one :  1482

F1score :  0.9801505817932923

AUC : 0.9975369149510371

Confusion Matrix
[[1391   50]
 [   8 1432]]
True label 0
0.9653018736988203  
0.03469812630117974  
True label 1
0.005555555555555556  
0.9944444444444445  

Train_result {'acc': [0.9917786912565271], 'loss': [0.028562810234488895]}
Saved model to disk



12

Epoch 1/1
 - 1466s - loss: 0.0248 - acc: 0.9928

Test accuracy: 98.50746268656717

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1444

choose_one :  1437

F1score :  0.9850538755648245

AUC : 0.997689442131236

Confusion Matrix
[[1421   20]
 [  23 1417]]
True label 0
0.9861207494795281  
0.013879250520471894  
True label 1
0.01597222222222222  
0.9840277777777777  

Train_result {'acc': [0.9928156130800282], 'loss': [0.024765719312925608]}
Saved model to disk



13

Epoch 1/1
 - 1447s - loss: 0.0241 - acc: 0.9927

Test accuracy: 98.71572370704617

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1440

choose_one :  1441

F1score :  0.9871572370704617

AUC : 0.9986631583005628

Confusion Matrix
[[1422   19]
 [  18 1422]]
True label 0
0.9868147120055517  
0.0131852879944483  
True label 1
0.0125  
0.9875  

Train_result {'acc': [0.9927045143132245], 'loss': [0.024136546907959404]}
Saved model to disk



14

Epoch 1/1
 - 1400s - loss: 0.0239 - acc: 0.9933

Test accuracy: 98.71572370704617

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1414

choose_one :  1467

F1score :  0.9872721018231854

AUC : 0.9977000443364947

Confusion Matrix
[[1409   32]
 [   5 1435]]
True label 0
0.9777931991672449  
0.02220680083275503  
True label 1
0.003472222222222222  
0.9965277777777778  

Train_result {'acc': [0.9932970410695108], 'loss': [0.023876324581157536]}
Saved model to disk



15

Epoch 1/1
 - 1427s - loss: 0.0192 - acc: 0.9946

Test accuracy: 98.50746268656717

data size :  29884

zero :  14943

one :  14941

train_zero :  13502

train_one :  13501

test_zero :  1441

test_one :  1440

choose_zero :  1418

choose_one :  1463

F1score :  0.9851877368239753

AUC : 0.9979161847482458

Confusion Matrix
[[1408   33]
 [  10 1430]]
True label 0
0.9770992366412213  
0.022900763358778626  
True label 1
0.006944444444444444  
0.9930555555555556  

Train_result {'acc': [0.9945561604486927], 'loss': [0.019213853987273297]}
Saved model to disk




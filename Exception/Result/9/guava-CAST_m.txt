Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-13 01:56:32.299084: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-13 01:56:32.307335: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-13 01:56:32.309423: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7b1f190 executing computations on platform Host. Devices:
2019-07-13 01:56:32.309459: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34901
Over 200, Under 400 : 299
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34305
Over 200, Under 400 : 895
Over 400 : 0


Test_zero:  2449
Train_zero:  21745
zero:  24194
Test_one:  1486
Train_one:  13455
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1086s - loss: 0.2732 - acc: 0.8890

Test accuracy: 91.92734611503532

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1575

choose_one :  1398

F1score :  0.9167822468793343

AUC : 0.9707478270628986

Confusion Matrix
[[1411   76]
 [ 164 1322]]
True label 0
0.948890383322125  
0.05110961667787491  
True label 1
0.11036339165545088  
0.8896366083445492  

Train_result {'loss': [0.27319437562162396], 'acc': [0.8889673367767827]}
Saved model to disk



2

Epoch 1/1
 - 1095s - loss: 0.1757 - acc: 0.9318

Test accuracy: 94.18096199125463

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1558

choose_one :  1415

F1score :  0.9403653912443984

AUC : 0.9807718938743222

Confusion Matrix
[[1436   51]
 [ 122 1364]]
True label 0
0.9657027572293208  
0.03429724277067922  
True label 1
0.08209959623149395  
0.917900403768506  

Train_result {'loss': [0.17569462251053672], 'acc': [0.931849429568055]}
Saved model to disk



3

Epoch 1/1
 - 1094s - loss: 0.1307 - acc: 0.9527

Test accuracy: 94.95459132189707

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1533

choose_one :  1440

F1score :  0.9487354750512645

AUC : 0.9873144642532274

Confusion Matrix
[[1435   52]
 [  98 1388]]
True label 0
0.9650302622730329  
0.03496973772696705  
True label 1
0.06594885598923284  
0.9340511440107672  

Train_result {'loss': [0.1307306288555029], 'acc': [0.9526959236000149]}
Saved model to disk



4

Epoch 1/1
 - 1118s - loss: 0.1012 - acc: 0.9661

Test accuracy: 96.3673057517659

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1527

choose_one :  1446

F1score :  0.9631650750341064

AUC : 0.9915990174151755

Confusion Matrix
[[1453   34]
 [  74 1412]]
True label 0
0.9771351714862139  
0.022864828513786146  
True label 1
0.04979811574697174  
0.9502018842530283  

Train_result {'loss': [0.10120299538786214], 'acc': [0.966073352904017]}
Saved model to disk



5

Epoch 1/1
 - 1125s - loss: 0.0743 - acc: 0.9742

Test accuracy: 96.7373023881601

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1508

choose_one :  1465

F1score :  0.9671297865130464

AUC : 0.9937692391936938

Confusion Matrix
[[1449   38]
 [  59 1427]]
True label 0
0.9744451916610626  
0.025554808338937456  
True label 1
0.039703903095558546  
0.9602960969044414  

Train_result {'loss': [0.07428187388669404], 'acc': [0.974248448589796]}
Saved model to disk



6

Epoch 1/1
 - 1121s - loss: 0.0616 - acc: 0.9800

Test accuracy: 97.37638748738647

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1509

choose_one :  1464

F1score :  0.9735593220338982

AUC : 0.9951626523635528

Confusion Matrix
[[1459   28]
 [  50 1436]]
True label 0
0.9811701412239409  
0.01882985877605918  
True label 1
0.033647375504710635  
0.9663526244952894  

Train_result {'loss': [0.06162142781875406], 'acc': [0.9799710155720562]}
Saved model to disk



7

Epoch 1/1
 - 1121s - loss: 0.0470 - acc: 0.9852

Test accuracy: 97.78002018163471

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1477

choose_one :  1496

F1score :  0.977867203219316

AUC : 0.9962795551577104

Confusion Matrix
[[1449   38]
 [  28 1458]]
True label 0
0.9744451916610626  
0.025554808338937456  
True label 1
0.018842530282637954  
0.9811574697173621  

Train_result {'loss': [0.0469544150645106], 'acc': [0.9851733491880643]}
Saved model to disk



8

Epoch 1/1
 - 1122s - loss: 0.0398 - acc: 0.9874

Test accuracy: 97.71274806592668

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1481

choose_one :  1492

F1score :  0.977165883143049

AUC : 0.9961768254436612

Confusion Matrix
[[1450   37]
 [  31 1455]]
True label 0
0.9751176866173503  
0.02488231338264963  
True label 1
0.02086137281292059  
0.9791386271870794  

Train_result {'loss': [0.03976168125556882], 'acc': [0.9874029207387314]}
Saved model to disk



9

Epoch 1/1
 - 1120s - loss: 0.0328 - acc: 0.9906

Test accuracy: 98.15001681802893

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1474

choose_one :  1499

F1score :  0.9815745393634842

AUC : 0.9965603647945723

Confusion Matrix
[[1453   34]
 [  21 1465]]
True label 0
0.9771351714862139  
0.022864828513786146  
True label 1
0.014131897711978465  
0.9858681022880216  

Train_result {'loss': [0.03281503907091472], 'acc': [0.9905986399281309]}
Saved model to disk



10

Epoch 1/1
 - 1117s - loss: 0.0288 - acc: 0.9915

Test accuracy: 98.25092499159098

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1481

choose_one :  1492

F1score :  0.9825386165211552

AUC : 0.9969796558961879

Confusion Matrix
[[1458   29]
 [  23 1463]]
True label 0
0.980497646267653  
0.019502353732347006  
True label 1
0.01547779273216689  
0.9845222072678331  

Train_result {'loss': [0.028834434449095343], 'acc': [0.9915276281074653]}
Saved model to disk



11

Epoch 1/1
 - 1118s - loss: 0.0255 - acc: 0.9930

Test accuracy: 98.4527413387151

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1477

choose_one :  1496

F1score :  0.9845741113346748

AUC : 0.9978182380994187

Confusion Matrix
[[1459   28]
 [  18 1468]]
True label 0
0.9811701412239409  
0.01882985877605918  
True label 1
0.012113055181695828  
0.9878869448183042  

Train_result {'loss': [0.025496316108120497], 'acc': [0.9930140091412434]}
Saved model to disk



12

Epoch 1/1
 - 1116s - loss: 0.0247 - acc: 0.9930

Test accuracy: 97.81365623948874

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1454

choose_one :  1519

F1score :  0.978369384359401

AUC : 0.995348651977977

Confusion Matrix
[[1438   49]
 [  16 1470]]
True label 0
0.9670477471418965  
0.03295225285810356  
True label 1
0.010767160161507403  
0.9892328398384926  

Train_result {'loss': [0.024700947408309606], 'acc': [0.9930140091412434]}
Saved model to disk



13

Epoch 1/1
 - 1116s - loss: 0.0222 - acc: 0.9933

Test accuracy: 98.0827447023209

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1490

choose_one :  1483

F1score :  0.9808016167059616

AUC : 0.9957878554470734

Confusion Matrix
[[1460   27]
 [  30 1456]]
True label 0
0.9818426361802286  
0.01815736381977135  
True label 1
0.020188425302826378  
0.9798115746971736  

Train_result {'loss': [0.02223742587759341], 'acc': [0.9933484448738434]}
Saved model to disk



14

Epoch 1/1
 - 1114s - loss: 0.0203 - acc: 0.9952

Test accuracy: 98.31819710729903

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1479

choose_one :  1494

F1score :  0.9832214765100671

AUC : 0.9966026785754691

Confusion Matrix
[[1458   29]
 [  21 1465]]
True label 0
0.980497646267653  
0.019502353732347006  
True label 1
0.014131897711978465  
0.9858681022880216  

Train_result {'loss': [0.020294222870342278], 'acc': [0.9951692616402215]}
Saved model to disk



15

Epoch 1/1
 - 1114s - loss: 0.0193 - acc: 0.9946

Test accuracy: 98.35183316515305

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1472

choose_one :  1501

F1score :  0.9835955808503515

AUC : 0.9958776873776407

Confusion Matrix
[[1455   32]
 [  17 1469]]
True label 0
0.9784801613987895  
0.02151983860121049  
True label 1
0.011440107671601614  
0.9885598923283984  

Train_result {'loss': [0.019309657557308173], 'acc': [0.994649028245176]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-12 00:31:59.703356: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-12 00:31:59.713062: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-12 00:31:59.715467: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x57b4830 executing computations on platform Host. Devices:
2019-07-12 00:31:59.715505: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41586

one : 
17568
guava-AST
all data

Sentence length Average : 26

Under 10 : 19371
Over 10, Under 200 : 39434
Over 200, Under 400 : 325
Over 400 : 24

guava-AST
updated_train_data

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 35478
Over 200, Under 400 : 303
Over 400 : 0


Test_zero:  2491
Train_zero:  22139
zero:  24630
Test_one:  1510
Train_one:  13642
one:  15152

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 644s - loss: 0.3378 - acc: 0.8523

Test accuracy: 87.22277391592188

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1797

choose_one :  1224

F1score :  0.858814923189466

AUC : 0.9410059124916177

Confusion Matrix
[[1461   50]
 [ 336 1174]]
True label 0
0.9669093315684977  
0.03309066843150232  
True label 1
0.22251655629139072  
0.7774834437086092  

Train_result {'acc': [0.8522997984284115], 'loss': [0.33779824916065143]}
Saved model to disk



2

Epoch 1/1
 - 648s - loss: 0.2690 - acc: 0.8876

Test accuracy: 88.31512744124463

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1748

choose_one :  1273

F1score :  0.8731584620912684

AUC : 0.9521848606904774

Confusion Matrix
[[1453   58]
 [ 295 1215]]
True label 0
0.9616148246194574  
0.03838517538054269  
True label 1
0.19536423841059603  
0.804635761589404  

Train_result {'acc': [0.8875939160776549], 'loss': [0.26899170610785417]}
Saved model to disk



3

Epoch 1/1
 - 651s - loss: 0.2343 - acc: 0.9045

Test accuracy: 89.87090367428004

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1687

choose_one :  1334

F1score :  0.8924050632911392

AUC : 0.9603803892865126

Confusion Matrix
[[1446   65]
 [ 241 1269]]
True label 0
0.956982131039047  
0.04301786896095301  
True label 1
0.15960264900662252  
0.8403973509933775  

Train_result {'acc': [0.9045262965020929], 'loss': [0.2342786145118516]}
Saved model to disk



4

Epoch 1/1
 - 655s - loss: 0.2078 - acc: 0.9158

Test accuracy: 90.66534260178749

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1639

choose_one :  1382

F1score :  0.9024896265560166

AUC : 0.9679373337248698

Confusion Matrix
[[1434   77]
 [ 205 1305]]
True label 0
0.9490403706154864  
0.050959629384513566  
True label 1
0.1357615894039735  
0.8642384105960265  

Train_result {'acc': [0.9157778999472093], 'loss': [0.20779690144917062]}
Saved model to disk



5

Epoch 1/1
 - 655s - loss: 0.1815 - acc: 0.9285

Test accuracy: 91.29427341939756

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1666

choose_one :  1355

F1score :  0.9082024432809773

AUC : 0.9735750193941997

Confusion Matrix
[[1457   54]
 [ 209 1301]]
True label 0
0.9642620780939775  
0.0357379219060225  
True label 1
0.13841059602649006  
0.8615894039735099  

Train_result {'acc': [0.9285321605277626], 'loss': [0.1814642573958879]}
Saved model to disk



6

Epoch 1/1
 - 654s - loss: 0.1595 - acc: 0.9386

Test accuracy: 92.88315127441244

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1566

choose_one :  1455

F1score :  0.9274873524451939

AUC : 0.9776155872388358

Confusion Matrix
[[1431   80]
 [ 135 1375]]
True label 0
0.9470549305095963  
0.05294506949040371  
True label 1
0.08940397350993377  
0.9105960264900662  

Train_result {'acc': [0.9386476085761407], 'loss': [0.15952039469734575]}
Saved model to disk



7

Epoch 1/1
 - 654s - loss: 0.1393 - acc: 0.9476

Test accuracy: 93.61138695796095

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1542

choose_one :  1479

F1score :  0.9354299096687855

AUC : 0.9828732780799523

Confusion Matrix
[[1430   81]
 [ 112 1398]]
True label 0
0.9463931171409663  
0.053606882859033755  
True label 1
0.07417218543046358  
0.9258278145695364  

Train_result {'acc': [0.9475536008796042], 'loss': [0.13929509678580768]}
Saved model to disk



8

Epoch 1/1
 - 649s - loss: 0.1207 - acc: 0.9540

Test accuracy: 93.31347236014564

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1573

choose_one :  1448

F1score :  0.9317106152805951

AUC : 0.9829267490938415

Confusion Matrix
[[1441   70]
 [ 132 1378]]
True label 0
0.9536730641958967  
0.04632693580410324  
True label 1
0.08741721854304636  
0.9125827814569536  

Train_result {'acc': [0.9540406816954226], 'loss': [0.12067753485932507]}
Saved model to disk



9

Epoch 1/1
 - 651s - loss: 0.1101 - acc: 0.9603

Test accuracy: 93.74379344587885

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1532

choose_one :  1489

F1score :  0.9369789929976658

AUC : 0.9843389098049184

Confusion Matrix
[[1427   84]
 [ 105 1405]]
True label 0
0.9444076770350761  
0.05559232296492389  
True label 1
0.0695364238410596  
0.9304635761589404  

Train_result {'acc': [0.9602712112926226], 'loss': [0.11011444208810721]}
Saved model to disk



10

Epoch 1/1
 - 656s - loss: 0.0983 - acc: 0.9644

Test accuracy: 94.40582588546839

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1556

choose_one :  1465

F1score :  0.9431932773109244

AUC : 0.9857975289378991

Confusion Matrix
[[1449   62]
 [ 107 1403]]
True label 0
0.9589675711449371  
0.04103242885506287  
True label 1
0.07086092715231788  
0.9291390728476822  

Train_result {'acc': [0.9643760307883308], 'loss': [0.09834820240287498]}
Saved model to disk



11

Epoch 1/1
 - 654s - loss: 0.0858 - acc: 0.9691

Test accuracy: 94.27341939755048

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1536

choose_one :  1485

F1score :  0.942237061769616

AUC : 0.9859202492976451

Confusion Matrix
[[1437   74]
 [  99 1411]]
True label 0
0.9510258107213766  
0.04897418927862343  
True label 1
0.06556291390728476  
0.9344370860927153  

Train_result {'acc': [0.9691405534198132], 'loss': [0.0858027042936761]}
Saved model to disk



12

Epoch 1/1
 - 651s - loss: 0.0825 - acc: 0.9700

Test accuracy: 94.50513075140682

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1609

choose_one :  1412

F1score :  0.9431895961670088

AUC : 0.9881243946160825

Confusion Matrix
[[1477   34]
 [ 132 1378]]
True label 0
0.9774983454665784  
0.022501654533421574  
True label 1
0.08741721854304636  
0.9125827814569536  

Train_result {'acc': [0.9699835074238448], 'loss': [0.08253994990431697]}
Saved model to disk



13

Epoch 1/1
 - 652s - loss: 0.0747 - acc: 0.9727

Test accuracy: 94.6706388613042

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1590

choose_one :  1431

F1score :  0.9452567154029242

AUC : 0.9884531098654021

Confusion Matrix
[[1470   41]
 [ 120 1390]]
True label 0
0.9728656518861681  
0.027134348113831898  
True label 1
0.07947019867549669  
0.9205298013245033  

Train_result {'acc': [0.9726589701301082], 'loss': [0.07471512309249968]}
Saved model to disk



14

Epoch 1/1
 - 654s - loss: 0.0751 - acc: 0.9749

Test accuracy: 94.63753723932473

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1503

choose_one :  1518

F1score :  0.9464993394980186

AUC : 0.9886858402619203

Confusion Matrix
[[1426   85]
 [  77 1433]]
True label 0
0.9437458636664461  
0.05625413633355394  
True label 1
0.05099337748344371  
0.9490066225165563  

Train_result {'acc': [0.974894630749496], 'loss': [0.07508114683058674]}
Saved model to disk



15

Epoch 1/1
 - 654s - loss: 0.0707 - acc: 0.9755

Test accuracy: 95.36577292287322

data size :  30306

zero :  15154

one :  15152

train_zero :  13643

train_one :  13642

test_zero :  1511

test_one :  1510

choose_zero :  1547

choose_one :  1474

F1score :  0.9530831099195711

AUC : 0.9892957166211579

Confusion Matrix
[[1459   52]
 [  88 1422]]
True label 0
0.9655857048312376  
0.03441429516876241  
True label 1
0.05827814569536424  
0.9417218543046357  

Train_result {'acc': [0.9754810335349093], 'loss': [0.07066046975134734]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 01:16:01.139181: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 01:16:01.147996: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-02 01:16:01.150145: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x677c280 executing computations on platform Host. Devices:
2019-07-02 01:16:01.150184: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST
all data

Sentence length Average : 100

Under 10 : 6634
Over 10, Under 200 : 35615
Over 200, Under 400 : 4427
Over 400 : 2577

hbase-CAST
updated_train_data

Sentence length Average : 97

Under 10 : 0
Over 10, Under 200 : 31946
Over 200, Under 400 : 6116
Over 400 : 0


Test_zero:  1982
Train_zero:  18349
zero:  20331
Test_one:  2172
Train_one:  19713
one:  21885

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 826s - loss: 0.3843 - acc: 0.8269

Test accuracy: 86.27994955863808

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2032

choose_one :  1933

F1score :  0.8610827374872319

AUC : 0.9428105597884745

Confusion Matrix
[[1735  247]
 [ 297 1686]]
True label 0
0.8753784056508577  
0.12462159434914229  
True label 1
0.14977307110438728  
0.8502269288956127  

Train_result {'acc': [0.82686176733924], 'loss': [0.3843474038617871]}
Saved model to disk



2

Epoch 1/1
 - 820s - loss: 0.2879 - acc: 0.8720

Test accuracy: 86.75914249684742

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1793

choose_one :  2172

F1score :  0.8736462093862816

AUC : 0.9524314391805625

Confusion Matrix
[[1625  357]
 [ 168 1815]]
True label 0
0.8198789101917255  
0.18012108980827446  
True label 1
0.08472012102874432  
0.9152798789712556  

Train_result {'acc': [0.8719856127081081], 'loss': [0.28787758009203573]}
Saved model to disk



3

Epoch 1/1
 - 824s - loss: 0.2520 - acc: 0.8919

Test accuracy: 89.33165195460278

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2013

choose_one :  1952

F1score :  0.8925031766200763

AUC : 0.9615103760368785

Confusion Matrix
[[1786  196]
 [ 227 1756]]
True label 0
0.9011099899091827  
0.09889001009081735  
True label 1
0.11447302067574382  
0.8855269793242562  

Train_result {'acc': [0.8919316602843363], 'loss': [0.2519510012132088]}
Saved model to disk



4

Epoch 1/1
 - 824s - loss: 0.2228 - acc: 0.9063

Test accuracy: 89.40731399747793

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1962

choose_one :  2003

F1score :  0.8946312092323131

AUC : 0.963964383434776

Confusion Matrix
[[1762  220]
 [ 200 1783]]
True label 0
0.8890010090817356  
0.11099899091826437  
True label 1
0.10085728693898134  
0.8991427130610187  

Train_result {'acc': [0.9062644758761496], 'loss': [0.222847549487724]}
Saved model to disk



5

Epoch 1/1
 - 823s - loss: 0.1997 - acc: 0.9186

Test accuracy: 90.64312736443884

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2061

choose_one :  1904

F1score :  0.9045536403395935

AUC : 0.9688319433652239

Confusion Matrix
[[1836  146]
 [ 225 1758]]
True label 0
0.9263370332996973  
0.07366296670030273  
True label 1
0.11346444780635401  
0.886535552193646  

Train_result {'acc': [0.9185536390799762], 'loss': [0.19971421095664801]}
Saved model to disk



6

Epoch 1/1
 - 822s - loss: 0.1759 - acc: 0.9293

Test accuracy: 90.51702395964692

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2000

choose_one :  1965

F1score :  0.9047619047619048

AUC : 0.9678083589420263

Confusion Matrix
[[1803  179]
 [ 197 1786]]
True label 0
0.9096871846619576  
0.09031281533804238  
True label 1
0.09934442763489662  
0.9006555723651034  

Train_result {'acc': [0.9292896264203384], 'loss': [0.17590318481482298]}
Saved model to disk



7

Epoch 1/1
 - 824s - loss: 0.1550 - acc: 0.9394

Test accuracy: 90.71878940731399

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1986

choose_one :  1979

F1score :  0.9071176173649672

AUC : 0.9691354820718794

Confusion Matrix
[[1800  182]
 [ 186 1797]]
True label 0
0.9081735620585267  
0.09182643794147326  
True label 1
0.09379727685325265  
0.9062027231467473  

Train_result {'acc': [0.9394261424017003], 'loss': [0.15495704051247555]}
Saved model to disk



8

Epoch 1/1
 - 893s - loss: 0.1413 - acc: 0.9457

Test accuracy: 90.64312736443884

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1999

choose_one :  1966

F1score :  0.90605216510509

AUC : 0.9699724398049414

Confusion Matrix
[[1805  177]
 [ 194 1789]]
True label 0
0.9106962663975782  
0.08930373360242179  
True label 1
0.0978315683308119  
0.9021684316691881  

Train_result {'acc': [0.9457478405568557], 'loss': [0.14132927468105372]}
Saved model to disk



9

Epoch 1/1
 - 969s - loss: 0.1252 - acc: 0.9517

Test accuracy: 91.39974779319041

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2049

choose_one :  1916

F1score :  0.9125416773531675

AUC : 0.9726411887522244

Confusion Matrix
[[1845  137]
 [ 204 1779]]
True label 0
0.9308779011099899  
0.06912209889001009  
True label 1
0.10287443267776097  
0.897125567322239  

Train_result {'acc': [0.9516608082126501], 'loss': [0.12518510305652333]}
Saved model to disk



10

Epoch 1/1
 - 970s - loss: 0.1119 - acc: 0.9578

Test accuracy: 91.6015132408575

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2025

choose_one :  1940

F1score :  0.9151159826663269

AUC : 0.9714402644476028

Confusion Matrix
[[1837  145]
 [ 188 1795]]
True label 0
0.9268415741675076  
0.07315842583249244  
True label 1
0.09480584972264246  
0.9051941502773575  

Train_result {'acc': [0.9578190141631886], 'loss': [0.11188143299780733]}
Saved model to disk



11

Epoch 1/1
 - 972s - loss: 0.1040 - acc: 0.9634

Test accuracy: 91.55107187894073

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1959

choose_one :  2006

F1score :  0.9160190523940838

AUC : 0.9728811191800333

Confusion Matrix
[[1803  179]
 [ 156 1827]]
True label 0
0.9096871846619576  
0.09031281533804238  
True label 1
0.07866868381240545  
0.9213313161875946  

Train_result {'acc': [0.9634322460988792], 'loss': [0.10400530367385405]}
Saved model to disk



12

Epoch 1/1
 - 973s - loss: 0.0921 - acc: 0.9674

Test accuracy: 91.72761664564943

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1952

choose_one :  2013

F1score :  0.917917917917918

AUC : 0.9705660322631369

Confusion Matrix
[[1803  179]
 [ 149 1834]]
True label 0
0.9096871846619576  
0.09031281533804238  
True label 1
0.0751386787695411  
0.9248613212304589  

Train_result {'acc': [0.9674105561621855], 'loss': [0.09209057034310444]}
Saved model to disk



13

Epoch 1/1
 - 961s - loss: 0.0843 - acc: 0.9705

Test accuracy: 91.67717528373267

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  1968

choose_one :  1997

F1score :  0.9170854271356785

AUC : 0.9712834064319674

Confusion Matrix
[[1810  172]
 [ 158 1825]]
True label 0
0.9132189707366297  
0.08678102926337034  
True label 1
0.07967725668179526  
0.9203227433182047  

Train_result {'acc': [0.9704624104361439], 'loss': [0.08426034546525826]}
Saved model to disk



14

Epoch 1/1
 - 867s - loss: 0.0818 - acc: 0.9720

Test accuracy: 92.156368221942

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2015

choose_one :  1950

F1score :  0.9209255021612001

AUC : 0.9699802000149607

Confusion Matrix
[[1843  139]
 [ 172 1811]]
True label 0
0.9298688193743693  
0.07013118062563067  
True label 1
0.08673726676752395  
0.9132627332324761  

Train_result {'acc': [0.972042834954631], 'loss': [0.0818499472646983]}
Saved model to disk



15

Epoch 1/1
 - 868s - loss: 0.0770 - acc: 0.9744

Test accuracy: 91.67717528373267

data size :  40664

zero :  20331

one :  20333

train_zero :  18349

train_one :  18350

test_zero :  1982

test_one :  1983

choose_zero :  2000

choose_one :  1965

F1score :  0.9164133738601824

AUC : 0.971134817492582

Confusion Matrix
[[1826  156]
 [ 174 1809]]
True label 0
0.9212916246215943  
0.07870837537840565  
True label 1
0.08774583963691376  
0.9122541603630863  

Train_result {'acc': [0.9744134717453545], 'loss': [0.07704127551304356]}
Saved model to disk




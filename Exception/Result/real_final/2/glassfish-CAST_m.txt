Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 19:44:16.572429: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 19:44:16.583572: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-19 19:44:16.586217: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xc573580 executing computations on platform Host. Devices:
2019-07-19 19:44:16.586261: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
25926
one : 
13545

Second data
zero : 
25926
one : 
13545

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15808
Over 200, Under 400 : 698
Over 400 : 0


glassfish-code

Sentence length Average : 80

Under 10 : 0
Over 10, Under 200 : 15049
Over 200, Under 400 : 1457
Over 400 : 0


Test_zero:  948
Train_zero:  8638
zero:  9586
Test_one:  858
Train_one:  7868
one:  8726
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 612s - loss: 0.4349 - acc: 0.7986

Test accuracy: 86.66278392545136

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  1010

choose_one :  707

F1score :  0.8536741214057508

AUC : 0.941588582159013

Confusion Matrix
[[820  39]
 [190 668]]
True label 0
0.9545983701979045  
0.04540162980209546  
True label 1
0.22144522144522144  
0.7785547785547785  

Train_result {'acc': [0.7986274384790207], 'loss': [0.43494523319415096]}
Saved model to disk



2

Epoch 1/1
 - 609s - loss: 0.3098 - acc: 0.8647

Test accuracy: 86.72102504368084

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  785

choose_one :  932

F1score :  0.8726256983240224

AUC : 0.9499478984345106

Confusion Matrix
[[708 151]
 [ 77 781]]
True label 0
0.8242142025611175  
0.17578579743888242  
True label 1
0.08974358974358974  
0.9102564102564102  

Train_result {'acc': [0.8646501874146502], 'loss': [0.3098196371913509]}
Saved model to disk



3

Epoch 1/1
 - 608s - loss: 0.2670 - acc: 0.8870

Test accuracy: 90.27373325567851

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  922

choose_one :  795

F1score :  0.8989715668481549

AUC : 0.965609574748108

Confusion Matrix
[[807  52]
 [115 743]]
True label 0
0.9394644935972061  
0.06053550640279395  
True label 1
0.13403263403263405  
0.865967365967366  

Train_result {'acc': [0.8869543114876273], 'loss': [0.2670431855336649]}
Saved model to disk



4

Epoch 1/1
 - 629s - loss: 0.2369 - acc: 0.9009

Test accuracy: 90.33197437390797

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  933

choose_one :  784

F1score :  0.8989037758830695

AUC : 0.9647018677868503

Confusion Matrix
[[813  46]
 [120 738]]
True label 0
0.9464493597206054  
0.05355064027939464  
True label 1
0.13986013986013987  
0.8601398601398601  

Train_result {'acc': [0.9008705598536718], 'loss': [0.236914749759886]}
Saved model to disk



5

Epoch 1/1
 - 628s - loss: 0.2142 - acc: 0.9117

Test accuracy: 91.38031450203844

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  929

choose_one :  788

F1score :  0.9100850546780074

AUC : 0.9724533324649738

Confusion Matrix
[[820  39]
 [109 749]]
True label 0
0.9545983701979045  
0.04540162980209546  
True label 1
0.12703962703962704  
0.872960372960373  

Train_result {'acc': [0.9117366714967496], 'loss': [0.21417845247123174]}
Saved model to disk



6

Epoch 1/1
 - 618s - loss: 0.1898 - acc: 0.9232

Test accuracy: 91.43855562026792

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  950

choose_one :  767

F1score :  0.9095384615384615

AUC : 0.9724261962329482

Confusion Matrix
[[831  28]
 [119 739]]
True label 0
0.9674039580908033  
0.03259604190919674  
True label 1
0.1386946386946387  
0.8613053613053613  

Train_result {'acc': [0.9232382283714043], 'loss': [0.1897868670240521]}
Saved model to disk



7

Epoch 1/1
 - 617s - loss: 0.1722 - acc: 0.9314

Test accuracy: 92.13744903902155

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  924

choose_one :  793

F1score :  0.9182313749242882

AUC : 0.9728590191337573

Confusion Matrix
[[824  35]
 [100 758]]
True label 0
0.959254947613504  
0.04074505238649592  
True label 1
0.11655011655011654  
0.8834498834498834  

Train_result {'acc': [0.9313719259925239], 'loss': [0.17224706814015936]}
Saved model to disk



8

Epoch 1/1
 - 619s - loss: 0.1443 - acc: 0.9444

Test accuracy: 91.38031450203844

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  893

choose_one :  824

F1score :  0.9120095124851367

AUC : 0.9709947599935959

Confusion Matrix
[[802  57]
 [ 91 767]]
True label 0
0.9336437718277066  
0.06635622817229336  
True label 1
0.10606060606060606  
0.8939393939393939  

Train_result {'acc': [0.9443985511510172], 'loss': [0.14434180051313691]}
Saved model to disk



9

Epoch 1/1
 - 617s - loss: 0.1247 - acc: 0.9536

Test accuracy: 92.77810133954571

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  901

choose_one :  816

F1score :  0.9259259259259259

AUC : 0.9720272936221714

Confusion Matrix
[[818  41]
 [ 83 775]]
True label 0
0.9522700814901047  
0.047729918509895226  
True label 1
0.09673659673659674  
0.9032634032634033  

Train_result {'acc': [0.9536125055260569], 'loss': [0.12467584031219592]}
Saved model to disk



10

Epoch 1/1
 - 617s - loss: 0.1064 - acc: 0.9603

Test accuracy: 92.54513686662784

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  857

choose_one :  860

F1score :  0.9254947613504074

AUC : 0.9747259918971211

Confusion Matrix
[[794  65]
 [ 63 795]]
True label 0
0.9243306169965075  
0.07566938300349244  
True label 1
0.07342657342657342  
0.9265734265734266  

Train_result {'acc': [0.9602846794103571], 'loss': [0.10644530699834963]}
Saved model to disk



11

Epoch 1/1
 - 618s - loss: 0.0893 - acc: 0.9683

Test accuracy: 92.31217239370996

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  847

choose_one :  870

F1score :  0.923611111111111

AUC : 0.9737545147906033

Confusion Matrix
[[787  72]
 [ 60 798]]
True label 0
0.9161816065192084  
0.08381839348079162  
True label 1
0.06993006993006994  
0.9300699300699301  

Train_result {'acc': [0.96829128807379], 'loss': [0.08925873895517285]}
Saved model to disk



12

Epoch 1/1
 - 619s - loss: 0.0738 - acc: 0.9736

Test accuracy: 92.02096680256261

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  890

choose_one :  827

F1score :  0.9186943620178042

AUC : 0.9714458998510221

Confusion Matrix
[[806  53]
 [ 84 774]]
True label 0
0.9383003492433062  
0.06169965075669383  
True label 1
0.0979020979020979  
0.9020979020979021  

Train_result {'acc': [0.9735654825864878], 'loss': [0.07383289548531795]}
Saved model to disk



13

Epoch 1/1
 - 619s - loss: 0.0668 - acc: 0.9768

Test accuracy: 93.0110658124636

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  935

choose_one :  782

F1score :  0.9268292682926828

AUC : 0.9719791268103258

Confusion Matrix
[[837  22]
 [ 98 760]]
True label 0
0.9743888242142026  
0.025611175785797437  
True label 1
0.11421911421911422  
0.8857808857808858  

Train_result {'acc': [0.9768062527800725], 'loss': [0.06677848851022858]}
Saved model to disk



14

Epoch 1/1
 - 618s - loss: 0.0517 - acc: 0.9813

Test accuracy: 92.77810133954571

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  885

choose_one :  832

F1score :  0.9266272189349113

AUC : 0.9712240611542127

Confusion Matrix
[[810  49]
 [ 75 783]]
True label 0
0.9429569266589057  
0.0570430733410943  
True label 1
0.08741258741258741  
0.9125874125874126  

Train_result {'acc': [0.9813179131981954], 'loss': [0.051722863818610965]}
Saved model to disk



15

Epoch 1/1
 - 619s - loss: 0.0510 - acc: 0.9835

Test accuracy: 92.66161910308678

data size :  17454

zero :  8728

one :  8726

train_zero :  7869

train_one :  7868

test_zero :  859

test_one :  858

choose_zero :  909

choose_one :  808

F1score :  0.9243697478991596

AUC : 0.974095074502525

Confusion Matrix
[[821  38]
 [ 88 770]]
True label 0
0.9557625145518044  
0.04423748544819558  
True label 1
0.10256410256410256  
0.8974358974358975  

Train_result {'acc': [0.9834784266378598], 'loss': [0.05101291741591411]}
Saved model to disk




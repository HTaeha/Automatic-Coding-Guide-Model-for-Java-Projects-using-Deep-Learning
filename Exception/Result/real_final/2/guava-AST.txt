Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 12:31:32.492685: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 12:31:32.508050: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-18 12:31:32.517403: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7393880 executing computations on platform Host. Devices:
2019-07-18 12:31:32.517433: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-AST
all data

Sentence length Average : 23

Under 10 : 22297
Over 10, Under 200 : 36558
Over 200, Under 400 : 283
Over 400 : 16

guava-AST
updated_train_data

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32864
Over 200, Under 400 : 270
Over 400 : 0


Test_zero:  2329
Train_zero:  20356
zero:  22685
Test_one:  1393
Train_one:  12778
one:  14171

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 599s - loss: 0.4125 - acc: 0.8053

Test accuracy: 84.46358091137424

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1677

choose_one :  1110

F1score :  0.8270075908909309

AUC : 0.9181812938436804

Confusion Matrix
[[1319   75]
 [ 358 1035]]
True label 0
0.9461979913916786  
0.05380200860832138  
True label 1
0.25699928212491024  
0.7430007178750897  

Train_result {'loss': [0.41250367315879855], 'acc': [0.8052588331987168]}
Saved model to disk



2

Epoch 1/1
 - 616s - loss: 0.3171 - acc: 0.8610

Test accuracy: 87.1546465733764

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1484

choose_one :  1303

F1score :  0.8672106824925816

AUC : 0.9418768365294397

Confusion Matrix
[[1260  134]
 [ 224 1169]]
True label 0
0.9038737446197992  
0.09612625538020086  
True label 1
0.16080402010050251  
0.8391959798994975  

Train_result {'loss': [0.31707623005076585], 'acc': [0.8610165512454049]}
Saved model to disk



3

Epoch 1/1
 - 616s - loss: 0.2685 - acc: 0.8886

Test accuracy: 89.27161822748475

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1553

choose_one :  1234

F1score :  0.8861819566044918

AUC : 0.9518210029446268

Confusion Matrix
[[1324   70]
 [ 229 1164]]
True label 0
0.9497847919655668  
0.05021520803443329  
True label 1
0.16439339554917445  
0.8356066044508256  

Train_result {'loss': [0.2684842333534017], 'acc': [0.8885628203669917]}
Saved model to disk



4

Epoch 1/1
 - 615s - loss: 0.2336 - acc: 0.9036

Test accuracy: 90.85037674919269

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1475

choose_one :  1312

F1score :  0.9057301293900185

AUC : 0.9668289181097123

Confusion Matrix
[[1307   87]
 [ 168 1225]]
True label 0
0.9375896700143472  
0.062410329985652796  
True label 1
0.12060301507537688  
0.8793969849246231  

Train_result {'loss': [0.2336013873740019], 'acc': [0.9035880580732799]}
Saved model to disk



5

Epoch 1/1
 - 615s - loss: 0.2046 - acc: 0.9176

Test accuracy: 90.27628274129889

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1491

choose_one :  1296

F1score :  0.899219040535515

AUC : 0.9625958239650805

Confusion Matrix
[[1307   87]
 [ 184 1209]]
True label 0
0.9375896700143472  
0.062410329985652796  
True label 1
0.13208901651112706  
0.867910983488873  

Train_result {'loss': [0.20456609645502086], 'acc': [0.9176350901952189]}
Saved model to disk



6

Epoch 1/1
 - 616s - loss: 0.1785 - acc: 0.9306

Test accuracy: 91.74739863652674

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1424

choose_one :  1363

F1score :  0.9165457184325109

AUC : 0.9744183615350787

Confusion Matrix
[[1294  100]
 [ 130 1263]]
True label 0
0.9282639885222381  
0.07173601147776183  
True label 1
0.09332376166547021  
0.9066762383345298  

Train_result {'loss': [0.1785280014055083], 'acc': [0.9305865320679111]}
Saved model to disk



7

Epoch 1/1
 - 618s - loss: 0.1630 - acc: 0.9371

Test accuracy: 92.89558665231432

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1436

choose_one :  1351

F1score :  0.9278425655976678

AUC : 0.9742414676374288

Confusion Matrix
[[1316   78]
 [ 120 1273]]
True label 0
0.9440459110473458  
0.05595408895265423  
True label 1
0.08614501076812635  
0.9138549892318737  

Train_result {'loss': [0.162993934259274], 'acc': [0.937081817117017]}
Saved model to disk



8

Epoch 1/1
 - 615s - loss: 0.1415 - acc: 0.9452

Test accuracy: 92.68030139935415

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1440

choose_one :  1347

F1score :  0.9255474452554744

AUC : 0.9775633135960599

Confusion Matrix
[[1315   79]
 [ 125 1268]]
True label 0
0.9433285509325682  
0.05667144906743185  
True label 1
0.08973438621679827  
0.9102656137832017  

Train_result {'loss': [0.14151698270575838], 'acc': [0.9451813593144736]}
Saved model to disk



9

Epoch 1/1
 - 613s - loss: 0.1259 - acc: 0.9527

Test accuracy: 93.68496591316828

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1460

choose_one :  1327

F1score :  0.9352941176470587

AUC : 0.980706205757214

Confusion Matrix
[[1339   55]
 [ 121 1272]]
True label 0
0.960545193687231  
0.03945480631276901  
True label 1
0.08686288585786073  
0.9131371141421393  

Train_result {'loss': [0.12588296380476638], 'acc': [0.9526939781687837]}
Saved model to disk



10

Epoch 1/1
 - 618s - loss: 0.1147 - acc: 0.9560

Test accuracy: 93.8643702906351

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1421

choose_one :  1366

F1score :  0.93802102210946

AUC : 0.9807649129022856

Confusion Matrix
[[1322   72]
 [  99 1294]]
True label 0
0.9483500717360115  
0.05164992826398852  
True label 1
0.07106963388370424  
0.9289303661162958  

Train_result {'loss': [0.11469068293579494], 'acc': [0.9559807489165241]}
Saved model to disk



11

Epoch 1/1
 - 618s - loss: 0.1046 - acc: 0.9613

Test accuracy: 93.54144241119484

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1396

choose_one :  1391

F1score :  0.9353448275862069

AUC : 0.981104023911317

Confusion Matrix
[[1305   89]
 [  91 1302]]
True label 0
0.936154949784792  
0.06384505021520803  
True label 1
0.06532663316582915  
0.9346733668341709  

Train_result {'loss': [0.10461857336401921], 'acc': [0.961263059046821]}
Saved model to disk



12

Epoch 1/1
 - 618s - loss: 0.1009 - acc: 0.9645

Test accuracy: 94.72551130247578

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1417

choose_one :  1370

F1score :  0.9467969598262759

AUC : 0.9856721092653264

Confusion Matrix
[[1332   62]
 [  85 1308]]
True label 0
0.9555236728837877  
0.04447632711621234  
True label 1
0.061019382627422826  
0.9389806173725772  

Train_result {'loss': [0.10087556493843451], 'acc': [0.9645498297922291]}
Saved model to disk



13

Epoch 1/1
 - 613s - loss: 0.0863 - acc: 0.9686

Test accuracy: 93.90025116612846

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1398

choose_one :  1389

F1score :  0.9388928828181164

AUC : 0.982660535718148

Confusion Matrix
[[1311   83]
 [  87 1306]]
True label 0
0.9404591104734576  
0.05954088952654232  
True label 1
0.0624551328068916  
0.9375448671931084  

Train_result {'loss': [0.08634701708075378], 'acc': [0.9686191650060494]}
Saved model to disk



14

Epoch 1/1
 - 617s - loss: 0.0835 - acc: 0.9707

Test accuracy: 94.58198780050233

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1405

choose_one :  1382

F1score :  0.9455855855855855

AUC : 0.9854117894246803

Confusion Matrix
[[1324   70]
 [  81 1312]]
True label 0
0.9497847919655668  
0.05021520803443329  
True label 1
0.05814788226848528  
0.9418521177315147  

Train_result {'loss': [0.08346942779684415], 'acc': [0.9706929608349808]}
Saved model to disk



15

Epoch 1/1
 - 615s - loss: 0.0786 - acc: 0.9740

Test accuracy: 94.86903480444923

data size :  28344

zero :  14173

one :  14171

train_zero :  12779

train_one :  12778

test_zero :  1394

test_one :  1393

choose_zero :  1405

choose_one :  1382

F1score :  0.9484684684684684

AUC : 0.9846349497023961

Confusion Matrix
[[1328   66]
 [  77 1316]]
True label 0
0.9526542324246772  
0.047345767575322814  
True label 1
0.05527638190954774  
0.9447236180904522  

Train_result {'loss': [0.07857456674235071], 'acc': [0.973979731580389]}
Saved model to disk




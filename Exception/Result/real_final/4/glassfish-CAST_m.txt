Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 19:09:48.762434: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 19:09:48.772682: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-19 19:09:48.775730: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xcf055b0 executing computations on platform Host. Devices:
2019-07-19 19:09:48.775767: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
25926
one : 
13545

Second data
zero : 
25926
one : 
13545

glassfish-AST

Sentence length Average : 59

Under 10 : 0
Over 10, Under 200 : 15669
Over 200, Under 400 : 712
Over 400 : 0


glassfish-code

Sentence length Average : 80

Under 10 : 0
Over 10, Under 200 : 14918
Over 200, Under 400 : 1463
Over 400 : 0


Test_zero:  994
Train_zero:  8592
zero:  9586
Test_one:  937
Train_one:  7789
one:  8726
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 633s - loss: 0.4283 - acc: 0.7991

Test accuracy: 86.08

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1107

choose_one :  768

F1score :  0.8469208211143695

AUC : 0.9271412414979532

Confusion Matrix
[[892  46]
 [215 722]]
True label 0
0.9509594882729211  
0.04904051172707889  
True label 1
0.2294557097118463  
0.7705442902881536  

Train_result {'acc': [0.7990885165660676], 'loss': [0.42830249166731976]}
Saved model to disk



2

Epoch 1/1
 - 630s - loss: 0.3041 - acc: 0.8676

Test accuracy: 86.88

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  920

choose_one :  955

F1score :  0.8699788583509515

AUC : 0.9451158599440669

Confusion Matrix
[[806 132]
 [114 823]]
True label 0
0.8592750533049041  
0.14072494669509594  
True label 1
0.12166488794023479  
0.8783351120597652  

Train_result {'acc': [0.8676423390576298], 'loss': [0.30414571066295715]}
Saved model to disk



3

Epoch 1/1
 - 641s - loss: 0.2556 - acc: 0.8934

Test accuracy: 88.90666666666667

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1048

choose_one :  827

F1score :  0.8820861678004535

AUC : 0.9557904940915183

Confusion Matrix
[[889  49]
 [159 778]]
True label 0
0.9477611940298507  
0.05223880597014925  
True label 1
0.16969050160085378  
0.8303094983991463  

Train_result {'acc': [0.8933821169905672], 'loss': [0.25557125565658156]}
Saved model to disk



4

Epoch 1/1
 - 640s - loss: 0.2292 - acc: 0.9056

Test accuracy: 89.60000000000001

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1063

choose_one :  812

F1score :  0.8885077186963979

AUC : 0.9662569148464114

Confusion Matrix
[[903  35]
 [160 777]]
True label 0
0.9626865671641791  
0.03731343283582089  
True label 1
0.17075773745997866  
0.8292422625400213  

Train_result {'acc': [0.9056422106529034], 'loss': [0.22916037465780886]}
Saved model to disk



5

Epoch 1/1
 - 640s - loss: 0.2013 - acc: 0.9164

Test accuracy: 90.98666666666666

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  973

choose_one :  902

F1score :  0.9081022294725394

AUC : 0.966170443710704

Confusion Matrix
[[871  67]
 [102 835]]
True label 0
0.9285714285714286  
0.07142857142857142  
True label 1
0.10885805763073639  
0.8911419423692636  

Train_result {'acc': [0.9163617690595555], 'loss': [0.20132017303866748]}
Saved model to disk



6

Epoch 1/1
 - 641s - loss: 0.1811 - acc: 0.9286

Test accuracy: 90.77333333333333

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  961

choose_one :  914

F1score :  0.9065370070232308

AUC : 0.9695894669054483

Confusion Matrix
[[863  75]
 [ 98 839]]
True label 0
0.920042643923241  
0.07995735607675906  
True label 1
0.10458911419423693  
0.8954108858057631  

Train_result {'acc': [0.9285576738413801], 'loss': [0.181120665924365]}
Saved model to disk



7

Epoch 1/1
 - 641s - loss: 0.1571 - acc: 0.9390

Test accuracy: 90.45333333333333

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1055

choose_one :  820

F1score :  0.8981217985202049

AUC : 0.9699182847767565

Confusion Matrix
[[907  31]
 [148 789]]
True label 0
0.9669509594882729  
0.03304904051172708  
True label 1
0.15795090715048027  
0.8420490928495198  

Train_result {'acc': [0.9390204762821748], 'loss': [0.1571360620937778]}
Saved model to disk



8

Epoch 1/1
 - 640s - loss: 0.1432 - acc: 0.9456

Test accuracy: 92.16

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  989

choose_one :  886

F1score :  0.9193636862314865

AUC : 0.9729789078695561

Confusion Matrix
[[890  48]
 [ 99 838]]
True label 0
0.9488272921108742  
0.0511727078891258  
True label 1
0.1056563500533618  
0.8943436499466382  

Train_result {'acc': [0.9455677514985588], 'loss': [0.14317486695675055]}
Saved model to disk



9

Epoch 1/1
 - 641s - loss: 0.1167 - acc: 0.9574

Test accuracy: 90.56

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  929

choose_one :  946

F1score :  0.9060010621348913

AUC : 0.9714269785392294

Confusion Matrix
[[845  93]
 [ 84 853]]
True label 0
0.9008528784648188  
0.09914712153518124  
True label 1
0.08964781216648879  
0.9103521878335112  

Train_result {'acc': [0.9574427113421914], 'loss': [0.1167240936944388]}
Saved model to disk



10

Epoch 1/1
 - 641s - loss: 0.1014 - acc: 0.9623

Test accuracy: 90.93333333333334

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  980

choose_one :  895

F1score :  0.9072052401746725

AUC : 0.9668110127817992

Confusion Matrix
[[874  64]
 [106 831]]
True label 0
0.9317697228144989  
0.06823027718550106  
True label 1
0.11312700106723586  
0.8868729989327642  

Train_result {'acc': [0.9623210732778771], 'loss': [0.10143953425303638]}
Saved model to disk



11

Epoch 1/1
 - 642s - loss: 0.0834 - acc: 0.9700

Test accuracy: 91.46666666666667

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  974

choose_one :  901

F1score :  0.9129488574537541

AUC : 0.9700240981401879

Confusion Matrix
[[876  62]
 [ 98 839]]
True label 0
0.9339019189765458  
0.06609808102345416  
True label 1
0.10458911419423693  
0.8954108858057631  

Train_result {'acc': [0.9700237499197638], 'loss': [0.0834117602744416]}
Saved model to disk



12

Epoch 1/1
 - 642s - loss: 0.0744 - acc: 0.9727

Test accuracy: 91.78666666666668

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1022

choose_one :  853

F1score :  0.9139664804469274

AUC : 0.9697214491652122

Confusion Matrix
[[903  35]
 [119 818]]
True label 0
0.9626865671641791  
0.03731343283582089  
True label 1
0.12700106723585913  
0.8729989327641409  

Train_result {'acc': [0.9726554977854804], 'loss': [0.07437906305654958]}
Saved model to disk



13

Epoch 1/1
 - 641s - loss: 0.0577 - acc: 0.9793

Test accuracy: 91.78666666666668

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  996

choose_one :  879

F1score :  0.9151982378854626

AUC : 0.965734674697863

Confusion Matrix
[[890  48]
 [106 831]]
True label 0
0.9488272921108742  
0.0511727078891258  
True label 1
0.11312700106723586  
0.8868729989327642  

Train_result {'acc': [0.9793311509465336], 'loss': [0.05772545206923892]}
Saved model to disk



14

Epoch 1/1
 - 640s - loss: 0.0572 - acc: 0.9809

Test accuracy: 92.16

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  1011

choose_one :  864

F1score :  0.9183786785119378

AUC : 0.9705679560726631

Confusion Matrix
[[901  37]
 [110 827]]
True label 0
0.9605543710021321  
0.039445628997867806  
True label 1
0.11739594450373532  
0.8826040554962646  

Train_result {'acc': [0.9809358752166378], 'loss': [0.05722800959911339]}
Saved model to disk



15

Epoch 1/1
 - 639s - loss: 0.0476 - acc: 0.9844

Test accuracy: 91.73333333333333

data size :  17454

zero :  8728

one :  8726

train_zero :  7790

train_one :  7789

test_zero :  938

test_one :  937

choose_zero :  951

choose_one :  924

F1score :  0.9167114454594304

AUC : 0.9693255023859209

Confusion Matrix
[[867  71]
 [ 84 853]]
True label 0
0.9243070362473348  
0.07569296375266525  
True label 1
0.08964781216648879  
0.9103521878335112  

Train_result {'acc': [0.9844020797227037], 'loss': [0.04764479044991552]}
Saved model to disk




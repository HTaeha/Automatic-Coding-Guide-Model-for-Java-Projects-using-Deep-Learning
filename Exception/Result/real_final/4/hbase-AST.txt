Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 15:44:50.864459: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 15:44:50.875144: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-18 15:44:50.877116: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7932f30 executing computations on platform Host. Devices:
2019-07-18 15:44:50.877155: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26276

one : 
22977
hbase-AST
all data

Sentence length Average : 39

Under 10 : 21502
Over 10, Under 200 : 26045
Over 200, Under 400 : 1441
Over 400 : 265

hbase-AST
updated_train_data

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23463
Over 200, Under 400 : 1535
Over 400 : 0


Test_zero:  1033
Train_zero:  9375
zero:  10408
Test_one:  1720
Train_one:  15623
one:  17343

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 448s - loss: 0.5420 - acc: 0.7251

Test accuracy: 77.01983551040155

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  940

choose_one :  1127

F1score :  0.7801943544655252

AUC : 0.8583186190341552

Confusion Matrix
[[749 284]
 [191 843]]
True label 0
0.7250726040658277  
0.2749273959341723  
True label 1
0.18471953578336556  
0.8152804642166345  

Train_result {'loss': [0.5419925131926084], 'acc': [0.7250813289544632]}
Saved model to disk



2

Epoch 1/1
 - 447s - loss: 0.4622 - acc: 0.7770

Test accuracy: 78.3744557329463

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  866

choose_one :  1201

F1score :  0.8

AUC : 0.8757698090667546

Confusion Matrix
[[726 307]
 [140 894]]
True label 0
0.7028073572120038  
0.2971926427879961  
True label 1
0.13539651837524178  
0.8646034816247582  

Train_result {'loss': [0.4622353199360994], 'acc': [0.7770252252768137]}
Saved model to disk



3

Epoch 1/1
 - 443s - loss: 0.4291 - acc: 0.7920

Test accuracy: 79.9225931301403

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  948

choose_one :  1119

F1score :  0.8072457036692986

AUC : 0.8852631066488661

Confusion Matrix
[[783 250]
 [165 869]]
True label 0
0.7579864472410455  
0.2420135527589545  
True label 1
0.1595744680851064  
0.8404255319148937  

Train_result {'loss': [0.4291460895295474], 'acc': [0.7920110927544354]}
Saved model to disk



4

Epoch 1/1
 - 446s - loss: 0.4027 - acc: 0.8087

Test accuracy: 80.93855829704887

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  871

choose_one :  1196

F1score :  0.8233183856502242

AUC : 0.8984175028695224

Confusion Matrix
[[755 278]
 [116 918]]
True label 0
0.7308809293320426  
0.2691190706679574  
True label 1
0.11218568665377177  
0.8878143133462283  

Train_result {'loss': [0.4027491324847873], 'acc': [0.8086502052810591]}
Saved model to disk



5

Epoch 1/1
 - 446s - loss: 0.3779 - acc: 0.8222

Test accuracy: 81.4707305273343

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  902

choose_one :  1165

F1score :  0.8258299226921327

AUC : 0.8987287968977327

Confusion Matrix
[[776 257]
 [126 908]]
True label 0
0.7512100677637947  
0.24878993223620524  
True label 1
0.1218568665377176  
0.8781431334622823  

Train_result {'loss': [0.37792495000833487], 'acc': [0.8222494799864082]}
Saved model to disk



6

Epoch 1/1
 - 447s - loss: 0.3590 - acc: 0.8335

Test accuracy: 81.4707305273343

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1068

choose_one :  999

F1score :  0.8116084604033449

AUC : 0.8994581143352538

Confusion Matrix
[[859 174]
 [209 825]]
True label 0
0.8315585672797676  
0.16844143272023232  
True label 1
0.20212765957446807  
0.7978723404255319  

Train_result {'loss': [0.3590309041658088], 'acc': [0.8335022131739716]}
Saved model to disk



7

Epoch 1/1
 - 452s - loss: 0.3397 - acc: 0.8451

Test accuracy: 80.50314465408806

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  868

choose_one :  1199

F1score :  0.8195253022839231

AUC : 0.9018660789685073

Confusion Matrix
[[749 284]
 [119 915]]
True label 0
0.7250726040658277  
0.2749273959341723  
True label 1
0.11508704061895551  
0.8849129593810445  

Train_result {'loss': [0.3397400989007215], 'acc': [0.8451282597848189]}
Saved model to disk



8

Epoch 1/1
 - 449s - loss: 0.3162 - acc: 0.8558

Test accuracy: 81.56748911465893

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1130

choose_one :  937

F1score :  0.806697108066971

AUC : 0.9058796654314769

Confusion Matrix
[[891 142]
 [239 795]]
True label 0
0.8625363020329139  
0.13746369796708616  
True label 1
0.2311411992263056  
0.7688588007736944  

Train_result {'loss': [0.3161565641134073], 'acc': [0.8558476881296576]}
Saved model to disk



9

Epoch 1/1
 - 451s - loss: 0.2992 - acc: 0.8683

Test accuracy: 82.5834542815675

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1037

choose_one :  1030

F1score :  0.8255813953488372

AUC : 0.9043994974356864

Confusion Matrix
[[855 178]
 [182 852]]
True label 0
0.8276863504356244  
0.17231364956437561  
True label 1
0.1760154738878143  
0.8239845261121856  

Train_result {'loss': [0.2991979978483942], 'acc': [0.8682736920316113]}
Saved model to disk



10

Epoch 1/1
 - 453s - loss: 0.2788 - acc: 0.8752

Test accuracy: 83.01886792452831

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1036

choose_one :  1031

F1score :  0.8300242130750606

AUC : 0.9127066009313543

Confusion Matrix
[[859 174]
 [177 857]]
True label 0
0.8315585672797676  
0.16844143272023232  
True label 1
0.17117988394584138  
0.8288201160541586  

Train_result {'loss': [0.27877398881776944], 'acc': [0.8751533251623491]}
Saved model to disk



11

Epoch 1/1
 - 453s - loss: 0.2579 - acc: 0.8869

Test accuracy: 81.37397194000967

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1216

choose_one :  851

F1score :  0.7957559681697612

AUC : 0.910960545705453

Confusion Matrix
[[932 101]
 [284 750]]
True label 0
0.9022265246853823  
0.09777347531461762  
True label 1
0.2746615087040619  
0.7253384912959381  

Train_result {'loss': [0.2578887395855967], 'acc': [0.8869393632403183]}
Saved model to disk



12

Epoch 1/1
 - 450s - loss: 0.2435 - acc: 0.8935

Test accuracy: 83.21238509917755

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1034

choose_one :  1033

F1score :  0.8321238509917755

AUC : 0.9122281911616837

Confusion Matrix
[[860 173]
 [174 860]]
True label 0
0.8325266214908035  
0.16747337850919652  
True label 1
0.16827852998065765  
0.8317214700193424  

Train_result {'loss': [0.24347320241290063], 'acc': [0.8934990133891315]}
Saved model to disk



13

Epoch 1/1
 - 451s - loss: 0.2251 - acc: 0.9054

Test accuracy: 82.87373004354136

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  995

choose_one :  1072

F1score :  0.8319088319088319

AUC : 0.9126036164408187

Confusion Matrix
[[837 196]
 [158 876]]
True label 0
0.8102613746369797  
0.18973862536302033  
True label 1
0.1528046421663443  
0.8471953578336557  

Train_result {'loss': [0.22507096460044088], 'acc': [0.9054450428833625]}
Saved model to disk



14

Epoch 1/1
 - 452s - loss: 0.2049 - acc: 0.9133

Test accuracy: 83.59941944847606

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  1066

choose_one :  1001

F1score :  0.8334152334152335

AUC : 0.9133525945538057

Confusion Matrix
[[880 153]
 [186 848]]
True label 0
0.8518877057115198  
0.14811229428848016  
True label 1
0.17988394584139264  
0.8201160541586073  

Train_result {'loss': [0.2048523713883308], 'acc': [0.9132846247755072]}
Saved model to disk



15

Epoch 1/1
 - 452s - loss: 0.1901 - acc: 0.9199

Test accuracy: 83.59941944847606

data size :  20818

zero :  10408

one :  10410

train_zero :  9375

train_one :  9376

test_zero :  1033

test_one :  1034

choose_zero :  954

choose_one :  1113

F1score :  0.8421052631578947

AUC : 0.911401974680795

Confusion Matrix
[[824 209]
 [130 904]]
True label 0
0.797676669893514  
0.20232333010648595  
True label 1
0.12572533849129594  
0.874274661508704  

Train_result {'loss': [0.19008267020061553], 'acc': [0.9198976054197184]}
Saved model to disk




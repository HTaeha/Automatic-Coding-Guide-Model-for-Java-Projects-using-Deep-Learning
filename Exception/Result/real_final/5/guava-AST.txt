Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 11:50:37.547848: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 11:50:37.557863: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-18 11:50:37.560213: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7495b30 executing computations on platform Host. Devices:
2019-07-18 11:50:37.560267: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-AST
all data

Sentence length Average : 23

Under 10 : 22297
Over 10, Under 200 : 36558
Over 200, Under 400 : 283
Over 400 : 16

guava-AST
updated_train_data

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32947
Over 200, Under 400 : 266
Over 400 : 0


Test_zero:  2258
Train_zero:  20427
zero:  22685
Test_one:  1385
Train_one:  12786
one:  14171

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 578s - loss: 0.4172 - acc: 0.8025

Test accuracy: 82.82208588957054

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1184

choose_one :  1587

F1score :  0.8398384925975775

AUC : 0.9327553513474092

Confusion Matrix
[[1047  339]
 [ 137 1248]]
True label 0
0.7554112554112554  
0.24458874458874458  
True label 1
0.09891696750902527  
0.9010830324909748  

Train_result {'loss': [0.41715417579046576], 'acc': [0.8025261017479373]}
Saved model to disk



2

Epoch 1/1
 - 636s - loss: 0.3218 - acc: 0.8617

Test accuracy: 88.12702995308554

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1427

choose_one :  1344

F1score :  0.8794430194210334

AUC : 0.9475396043988102

Confusion Matrix
[[1242  144]
 [ 185 1200]]
True label 0
0.8961038961038961  
0.1038961038961039  
True label 1
0.13357400722021662  
0.8664259927797834  

Train_result {'loss': [0.32182475635302255], 'acc': [0.8616509599968717]}
Saved model to disk



3

Epoch 1/1
 - 643s - loss: 0.2727 - acc: 0.8863

Test accuracy: 89.42619992782389

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1527

choose_one :  1244

F1score :  0.8885507797641689

AUC : 0.9599879663056559

Confusion Matrix
[[1310   76]
 [ 217 1168]]
True label 0
0.9451659451659452  
0.05483405483405483  
True label 1
0.15667870036101084  
0.8433212996389892  

Train_result {'loss': [0.2727411508149966], 'acc': [0.8862863176052559]}
Saved model to disk



4

Epoch 1/1
 - 644s - loss: 0.2338 - acc: 0.9055

Test accuracy: 91.12233850595453

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1546

choose_one :  1225

F1score :  0.9057471264367816

AUC : 0.9647097587530801

Confusion Matrix
[[1343   43]
 [ 203 1182]]
True label 0
0.9689754689754689  
0.031024531024531024  
True label 1
0.14657039711191336  
0.8534296028880867  

Train_result {'loss': [0.2338162174538178], 'acc': [0.9055253587768349]}
Saved model to disk



5

Epoch 1/1
 - 643s - loss: 0.2041 - acc: 0.9188

Test accuracy: 92.20498015156983

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1468

choose_one :  1303

F1score :  0.9196428571428572

AUC : 0.9700400081266506

Confusion Matrix
[[1319   67]
 [ 149 1236]]
True label 0
0.9516594516594516  
0.048340548340548344  
True label 1
0.10758122743682311  
0.8924187725631769  

Train_result {'loss': [0.2040674717369144], 'acc': [0.9187815273921714]}
Saved model to disk



6

Epoch 1/1
 - 640s - loss: 0.1782 - acc: 0.9291

Test accuracy: 92.49368459040058

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1416

choose_one :  1355

F1score :  0.9240875912408759

AUC : 0.9751519839967494

Confusion Matrix
[[1297   89]
 [ 119 1266]]
True label 0
0.9357864357864358  
0.06421356421356421  
True label 1
0.08592057761732852  
0.9140794223826715  

Train_result {'loss': [0.17822944408953678], 'acc': [0.9291440190826262]}
Saved model to disk



7

Epoch 1/1
 - 645s - loss: 0.1569 - acc: 0.9388

Test accuracy: 93.28762179718512

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1470

choose_one :  1301

F1score :  0.9307520476545048

AUC : 0.9763621256401039

Confusion Matrix
[[1335   51]
 [ 135 1250]]
True label 0
0.9632034632034632  
0.0367965367965368  
True label 1
0.09747292418772563  
0.9025270758122743  

Train_result {'loss': [0.15688937324661284], 'acc': [0.9388026434129746]}
Saved model to disk



8

Epoch 1/1
 - 643s - loss: 0.1403 - acc: 0.9475

Test accuracy: 93.93720678455432

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1446

choose_one :  1325

F1score :  0.9380073800738008

AUC : 0.9821211079333823

Confusion Matrix
[[1332   54]
 [ 114 1271]]
True label 0
0.961038961038961  
0.03896103896103896  
True label 1
0.08231046931407943  
0.9176895306859206  

Train_result {'loss': [0.14034965015986858], 'acc': [0.9474836741876198]}
Saved model to disk



9

Epoch 1/1
 - 643s - loss: 0.1271 - acc: 0.9524

Test accuracy: 93.86503067484662

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1470

choose_one :  1301

F1score :  0.9367088607594937

AUC : 0.982300311000672

Confusion Matrix
[[1343   43]
 [ 127 1258]]
True label 0
0.9689754689754689  
0.031024531024531024  
True label 1
0.09169675090252707  
0.908303249097473  

Train_result {'loss': [0.12713641496975012], 'acc': [0.9523716419684669]}
Saved model to disk



10

Epoch 1/1
 - 641s - loss: 0.1125 - acc: 0.9587

Test accuracy: 94.11764705882352

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1411

choose_one :  1360

F1score :  0.9406193078324226

AUC : 0.9853738519803502

Confusion Matrix
[[1317   69]
 [  94 1291]]
True label 0
0.9502164502164502  
0.049783549783549784  
True label 1
0.06787003610108304  
0.932129963898917  

Train_result {'loss': [0.11252419449948933], 'acc': [0.9587455519493215]}
Saved model to disk



11

Epoch 1/1
 - 643s - loss: 0.1024 - acc: 0.9610

Test accuracy: 94.5146156622158

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1424

choose_one :  1347

F1score :  0.9443631039531478

AUC : 0.9858992191122156

Confusion Matrix
[[1329   57]
 [  95 1290]]
True label 0
0.9588744588744589  
0.04112554112554113  
True label 1
0.06859205776173286  
0.9314079422382672  

Train_result {'loss': [0.10236497749617456], 'acc': [0.960974465256325]}
Saved model to disk



12

Epoch 1/1
 - 643s - loss: 0.0952 - acc: 0.9659

Test accuracy: 94.29808733309275

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1362

choose_one :  1409

F1score :  0.9434502505368647

AUC : 0.9856405728246882

Confusion Matrix
[[1295   91]
 [  67 1318]]
True label 0
0.9343434343434344  
0.06565656565656566  
True label 1
0.04837545126353791  
0.9516245487364621  

Train_result {'loss': [0.09524773152801697], 'acc': [0.9659015367794004]}
Saved model to disk



13

Epoch 1/1
 - 644s - loss: 0.0858 - acc: 0.9685

Test accuracy: 94.73114399133887

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1388

choose_one :  1383

F1score :  0.9472543352601155

AUC : 0.9882223472476179

Confusion Matrix
[[1314   72]
 [  74 1311]]
True label 0
0.948051948051948  
0.05194805194805195  
True label 1
0.053429602888086646  
0.9465703971119134  

Train_result {'loss': [0.0858266661653236], 'acc': [0.9684823837641262]}
Saved model to disk



14

Epoch 1/1
 - 642s - loss: 0.0827 - acc: 0.9699

Test accuracy: 94.65896788163118

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1400

choose_one :  1371

F1score :  0.946298984034833

AUC : 0.9883554472002125

Confusion Matrix
[[1319   67]
 [  81 1304]]
True label 0
0.9516594516594516  
0.048340548340548344  
True label 1
0.05848375451263538  
0.9415162454873646  

Train_result {'loss': [0.08265560419122699], 'acc': [0.9698510147421108]}
Saved model to disk



15

Epoch 1/1
 - 643s - loss: 0.0759 - acc: 0.9722

Test accuracy: 95.0920245398773

data size :  28344

zero :  14173

one :  14171

train_zero :  12787

train_one :  12786

test_zero :  1386

test_one :  1385

choose_zero :  1376

choose_one :  1395

F1score :  0.9510791366906475

AUC : 0.9883682102093654

Confusion Matrix
[[1313   73]
 [  63 1322]]
True label 0
0.9473304473304474  
0.05266955266955267  
True label 1
0.04548736462093863  
0.9545126353790614  

Train_result {'loss': [0.07591786303374308], 'acc': [0.9722363430180269]}
Saved model to disk




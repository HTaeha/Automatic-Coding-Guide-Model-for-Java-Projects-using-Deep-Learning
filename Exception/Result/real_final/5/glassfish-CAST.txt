Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 01:01:22.888487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 01:01:22.899581: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-19 01:01:22.902103: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7318850 executing computations on platform Host. Devices:
2019-07-19 01:01:22.902168: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-CAST
all data

Sentence length Average : 73

Under 10 : 9491
Over 10, Under 200 : 26126
Over 200, Under 400 : 2656
Over 400 : 1198

glassfish-CAST
updated_train_data

Sentence length Average : 83

Under 10 : 0
Over 10, Under 200 : 23093
Over 200, Under 400 : 3299
Over 400 : 0


Test_zero:  1766
Train_zero:  16089
zero:  17855
Test_one:  1176
Train_one:  10303
one:  11479

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 470s - loss: 0.5000 - acc: 0.7504

Test accuracy: 83.42541436464089

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1277

choose_one :  1076

F1score :  0.8268206039076378

AUC : 0.9114204942809749

Confusion Matrix
[[1032  145]
 [ 245  931]]
True label 0
0.8768054375531011  
0.1231945624468989  
True label 1
0.20833333333333334  
0.7916666666666666  

Train_result {'acc': [0.7503760857584869], 'loss': [0.5000225544516718]}
Saved model to disk



2

Epoch 1/1
 - 466s - loss: 0.3695 - acc: 0.8297

Test accuracy: 85.93285167870803

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1142

choose_one :  1211

F1score :  0.8613322161709258

AUC : 0.9381986226946174

Confusion Matrix
[[ 994  183]
 [ 148 1028]]
True label 0
0.8445199660152931  
0.1554800339847069  
True label 1
0.12585034013605442  
0.8741496598639455  

Train_result {'acc': [0.8297180569796095], 'loss': [0.36954280488204244]}
Saved model to disk



3

Epoch 1/1
 - 466s - loss: 0.3085 - acc: 0.8626

Test accuracy: 86.74033149171271

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1133

choose_one :  1220

F1score :  0.8697829716193656

AUC : 0.9452614308255164

Confusion Matrix
[[ 999  178]
 [ 134 1042]]
True label 0
0.848768054375531  
0.15123194562446898  
True label 1
0.11394557823129252  
0.8860544217687075  

Train_result {'acc': [0.8625709710379392], 'loss': [0.3085452700992359]}
Saved model to disk



4

Epoch 1/1
 - 508s - loss: 0.2697 - acc: 0.8816

Test accuracy: 87.7603059923502

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1123

choose_one :  1230

F1score :  0.8802992518703243

AUC : 0.9532750015894209

Confusion Matrix
[[1006  171]
 [ 117 1059]]
True label 0
0.8547153780798641  
0.14528462192013594  
True label 1
0.09948979591836735  
0.9005102040816326  

Train_result {'acc': [0.8815936332401035], 'loss': [0.2697241356083936]}
Saved model to disk



5

Epoch 1/1
 - 510s - loss: 0.2360 - acc: 0.8990

Test accuracy: 88.61028474288143

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1107

choose_one :  1246

F1score :  0.8893476465730802

AUC : 0.959447734063889

Confusion Matrix
[[1008  169]
 [  99 1077]]
True label 0
0.8564146134239592  
0.14358538657604078  
True label 1
0.08418367346938775  
0.9158163265306123  

Train_result {'acc': [0.8990148978618149], 'loss': [0.23603510119777676]}
Saved model to disk



6

Epoch 1/1
 - 511s - loss: 0.2030 - acc: 0.9126

Test accuracy: 89.54526136846579

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1237

choose_one :  1116

F1score :  0.8926701570680627

AUC : 0.9610263179188412

Confusion Matrix
[[1084   93]
 [ 153 1023]]
True label 0
0.9209855564995751  
0.0790144435004248  
True label 1
0.13010204081632654  
0.8698979591836735  

Train_result {'acc': [0.9125539864660518], 'loss': [0.20297168361924878]}
Saved model to disk



7

Epoch 1/1
 - 510s - loss: 0.1777 - acc: 0.9260

Test accuracy: 89.0777730556736

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1148

choose_one :  1205

F1score :  0.8920621587568249

AUC : 0.9622949647148578

Confusion Matrix
[[1034  143]
 [ 114 1062]]
True label 0
0.8785046728971962  
0.12149532710280374  
True label 1
0.09693877551020408  
0.9030612244897959  

Train_result {'acc': [0.9259960207696414], 'loss': [0.1777020444145423]}
Saved model to disk



8

Epoch 1/1
 - 509s - loss: 0.1519 - acc: 0.9405

Test accuracy: 89.12027199320018

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1191

choose_one :  1162

F1score :  0.8905047048759624

AUC : 0.9619470982955629

Confusion Matrix
[[1056  121]
 [ 135 1041]]
True label 0
0.897196261682243  
0.102803738317757  
True label 1
0.11479591836734694  
0.8852040816326531  

Train_result {'acc': [0.9405056533753545], 'loss': [0.15186599694174693]}
Saved model to disk



9

Epoch 1/1
 - 511s - loss: 0.1354 - acc: 0.9473

Test accuracy: 89.33276668083298

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1120

choose_one :  1233

F1score :  0.895807388958074

AUC : 0.9637857691929788

Confusion Matrix
[[1023  154]
 [  97 1079]]
True label 0
0.8691588785046729  
0.1308411214953271  
True label 1
0.0824829931972789  
0.9175170068027211  

Train_result {'acc': [0.9472994613480856], 'loss': [0.13543409315030674]}
Saved model to disk



10

Epoch 1/1
 - 511s - loss: 0.1150 - acc: 0.9562

Test accuracy: 90.01274968125796

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1236

choose_one :  1117

F1score :  0.8975141735717401

AUC : 0.9639801120108197

Confusion Matrix
[[1089   88]
 [ 147 1029]]
True label 0
0.9252336448598131  
0.07476635514018691  
True label 1
0.125  
0.875  

Train_result {'acc': [0.9562284660118373], 'loss': [0.11499277279977686]}
Saved model to disk



11

Epoch 1/1
 - 509s - loss: 0.0992 - acc: 0.9609

Test accuracy: 89.0777730556736

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1304

choose_one :  1049

F1score :  0.8844943820224719

AUC : 0.960378267704703

Confusion Matrix
[[1112   65]
 [ 192  984]]
True label 0
0.9447748513169074  
0.055225148683092605  
True label 1
0.16326530612244897  
0.8367346938775511  

Train_result {'acc': [0.9608870771633877], 'loss': [0.09915452847303265]}
Saved model to disk



12

Epoch 1/1
 - 507s - loss: 0.0893 - acc: 0.9652

Test accuracy: 89.80025499362516

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1169

choose_one :  1184

F1score :  0.8983050847457626

AUC : 0.9639996185390044

Confusion Matrix
[[1053  124]
 [ 116 1060]]
True label 0
0.8946474086661003  
0.10535259133389975  
True label 1
0.09863945578231292  
0.9013605442176871  

Train_result {'acc': [0.9651574707189756], 'loss': [0.08925750047793168]}
Saved model to disk



13

Epoch 1/1
 - 509s - loss: 0.0839 - acc: 0.9683

Test accuracy: 90.14024649383765

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1163

choose_one :  1190

F1score :  0.9019442096365172

AUC : 0.9651273848536867

Confusion Matrix
[[1054  123]
 [ 109 1067]]
True label 0
0.8954970263381479  
0.10450297366185217  
True label 1
0.09268707482993198  
0.907312925170068  

Train_result {'acc': [0.9682632114866759], 'loss': [0.08391526519251441]}
Saved model to disk



14

Epoch 1/1
 - 511s - loss: 0.0728 - acc: 0.9732

Test accuracy: 89.67275818104548

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1154

choose_one :  1199

F1score :  0.8976842105263158

AUC : 0.9615410735237169

Confusion Matrix
[[1044  133]
 [ 110 1066]]
True label 0
0.887000849617672  
0.11299915038232795  
True label 1
0.0935374149659864  
0.9064625850340136  

Train_result {'acc': [0.973212985878585], 'loss': [0.07278142807347046]}
Saved model to disk



15

Epoch 1/1
 - 509s - loss: 0.0694 - acc: 0.9769

Test accuracy: 90.01274968125796

data size :  22960

zero :  11481

one :  11479

train_zero :  10304

train_one :  10303

test_zero :  1177

test_one :  1176

choose_zero :  1208

choose_one :  1145

F1score :  0.8987505385609651

AUC : 0.9640364642033534

Confusion Matrix
[[1075  102]
 [ 133 1043]]
True label 0
0.913338997451147  
0.08666100254885302  
True label 1
0.1130952380952381  
0.8869047619047619  

Train_result {'acc': [0.9769495801963377], 'loss': [0.06943275516833483]}
Saved model to disk




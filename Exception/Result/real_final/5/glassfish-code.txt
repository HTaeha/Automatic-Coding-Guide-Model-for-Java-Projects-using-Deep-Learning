Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 09:41:05.798009: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 09:41:05.808561: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-19 09:41:05.811464: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xafdb590 executing computations on platform Host. Devices:
2019-07-19 09:41:05.811532: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-code
all data

Sentence length Average : 47

Under 10 : 10042
Over 10, Under 200 : 27631
Over 200, Under 400 : 1427
Over 400 : 371

glassfish-code
updated_train_data

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 23541
Over 200, Under 400 : 1458
Over 400 : 0


Test_zero:  1642
Train_zero:  14899
zero:  16541
Test_one:  1165
Train_one:  10100
one:  11265

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 460s - loss: 0.4085 - acc: 0.8079

Test accuracy: 86.82968682968682

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1193

choose_one :  1138

F1score :  0.8666956144159791

AUC : 0.9403735304294055

Confusion Matrix
[[1026  140]
 [ 167  998]]
True label 0
0.8799313893653516  
0.12006861063464837  
True label 1
0.14334763948497853  
0.8566523605150215  

Train_result {'acc': [0.8078807979861992], 'loss': [0.40846792923732]}
Saved model to disk



2

Epoch 1/1
 - 458s - loss: 0.2875 - acc: 0.8717

Test accuracy: 89.1033891033891

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1254

choose_one :  1077

F1score :  0.8867082961641392

AUC : 0.9585229573244798

Confusion Matrix
[[1083   83]
 [ 171  994]]
True label 0
0.9288164665523156  
0.0711835334476844  
True label 1
0.14678111587982834  
0.8532188841201717  

Train_result {'acc': [0.8716895203207762], 'loss': [0.28754894781619283]}
Saved model to disk



3

Epoch 1/1
 - 458s - loss: 0.2392 - acc: 0.8982

Test accuracy: 90.69069069069069

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1237

choose_one :  1094

F1score :  0.9039397963700752

AUC : 0.9691553971981538

Confusion Matrix
[[1093   73]
 [ 144 1021]]
True label 0
0.9373927958833619  
0.06260720411663807  
True label 1
0.12360515021459227  
0.8763948497854077  

Train_result {'acc': [0.8981733577545666], 'loss': [0.23922647762405394]}
Saved model to disk



4

Epoch 1/1
 - 458s - loss: 0.2056 - acc: 0.9141

Test accuracy: 90.04719004719006

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1358

choose_one :  973

F1score :  0.891487371375117

AUC : 0.9740133540441257

Confusion Matrix
[[1146   20]
 [ 212  953]]
True label 0
0.9828473413379074  
0.017152658662092625  
True label 1
0.18197424892703862  
0.8180257510729614  

Train_result {'acc': [0.9141131627206183], 'loss': [0.20557210833818262]}
Saved model to disk



5

Epoch 1/1
 - 458s - loss: 0.1796 - acc: 0.9280

Test accuracy: 92.74989274989275

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1231

choose_one :  1100

F1score :  0.9253863134657836

AUC : 0.9770603434948726

Confusion Matrix
[[1114   52]
 [ 117 1048]]
True label 0
0.9554030874785592  
0.044596912521440824  
True label 1
0.10042918454935622  
0.8995708154506438  

Train_result {'acc': [0.9280233651799416], 'loss': [0.1795763431803778]}
Saved model to disk



6

Epoch 1/1
 - 458s - loss: 0.1581 - acc: 0.9371

Test accuracy: 93.30759330759331

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1200

choose_one :  1131

F1score :  0.93205574912892

AUC : 0.9752670440742348

Confusion Matrix
[[1105   61]
 [  95 1070]]
True label 0
0.9476843910806175  
0.05231560891938251  
True label 1
0.0815450643776824  
0.9184549356223176  

Train_result {'acc': [0.9370823226661459], 'loss': [0.1580981388020519]}
Saved model to disk



7

Epoch 1/1
 - 459s - loss: 0.1387 - acc: 0.9454

Test accuracy: 92.66409266409266

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1283

choose_one :  1048

F1score :  0.9227293267058293

AUC : 0.9767614602580997

Confusion Matrix
[[1139   27]
 [ 144 1021]]
True label 0
0.9768439108061749  
0.023156089193825044  
True label 1
0.12360515021459227  
0.8763948497854077  

Train_result {'acc': [0.94544824513933], 'loss': [0.13874467583828223]}
Saved model to disk



8

Epoch 1/1
 - 459s - loss: 0.1178 - acc: 0.9551

Test accuracy: 93.69369369369369

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1169

choose_one :  1162

F1score :  0.9368285345938977

AUC : 0.980523634596839

Confusion Matrix
[[1094   72]
 [  75 1090]]
True label 0
0.9382504288164666  
0.06174957118353345  
True label 1
0.06437768240343347  
0.9356223175965666  

Train_result {'acc': [0.9550517301123707], 'loss': [0.11778631477688326]}
Saved model to disk



9

Epoch 1/1
 - 458s - loss: 0.1004 - acc: 0.9633

Test accuracy: 93.30759330759331

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1178

choose_one :  1153

F1score :  0.9327006039689387

AUC : 0.9778815362303904

Confusion Matrix
[[1094   72]
 [  84 1081]]
True label 0
0.9382504288164666  
0.06174957118353345  
True label 1
0.07210300429184549  
0.9278969957081545  

Train_result {'acc': [0.9632691450947777], 'loss': [0.10035307451947645]}
Saved model to disk



10

Epoch 1/1
 - 458s - loss: 0.0852 - acc: 0.9677

Test accuracy: 93.69369369369369

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1193

choose_one :  1138

F1score :  0.9361702127659574

AUC : 0.9786983119722614

Confusion Matrix
[[1106   60]
 [  87 1078]]
True label 0
0.9485420240137221  
0.051457975986277875  
True label 1
0.07467811158798283  
0.9253218884120171  

Train_result {'acc': [0.9676748675808128], 'loss': [0.08517805795889212]}
Saved model to disk



11

Epoch 1/1
 - 458s - loss: 0.0762 - acc: 0.9721

Test accuracy: 93.65079365079364

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1218

choose_one :  1113

F1score :  0.9350307287093942

AUC : 0.9786615036918705

Confusion Matrix
[[1118   48]
 [ 100 1065]]
True label 0
0.9588336192109777  
0.0411663807890223  
True label 1
0.08583690987124463  
0.9141630901287554  

Train_result {'acc': [0.9721300925696748], 'loss': [0.07624658690655775]}
Saved model to disk



12

Epoch 1/1
 - 458s - loss: 0.0657 - acc: 0.9767

Test accuracy: 93.22179322179322

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1178

choose_one :  1153

F1score :  0.9318377911993098

AUC : 0.980161441117794

Confusion Matrix
[[1093   73]
 [  85 1080]]
True label 0
0.9373927958833619  
0.06260720411663807  
True label 1
0.07296137339055794  
0.927038626609442  

Train_result {'acc': [0.9767338250581654], 'loss': [0.065725300378599]}
Saved model to disk



13

Epoch 1/1
 - 457s - loss: 0.0585 - acc: 0.9789

Test accuracy: 93.82239382239382

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1186

choose_one :  1145

F1score :  0.9376623376623376

AUC : 0.9806005639028557

Confusion Matrix
[[1104   62]
 [  82 1083]]
True label 0
0.9468267581475128  
0.05317324185248713  
True label 1
0.0703862660944206  
0.9296137339055794  

Train_result {'acc': [0.9789119350556708], 'loss': [0.05849378324747653]}
Saved model to disk



14

Epoch 1/1
 - 457s - loss: 0.0528 - acc: 0.9829

Test accuracy: 93.3933933933934

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1148

choose_one :  1183

F1score :  0.934412265758092

AUC : 0.979770537180044

Confusion Matrix
[[1080   86]
 [  68 1097]]
True label 0
0.9262435677530018  
0.07375643224699828  
True label 1
0.05836909871244635  
0.9416309012875537  

Train_result {'acc': [0.9828721350428197], 'loss': [0.05284642220121569]}
Saved model to disk



15

Epoch 1/1
 - 459s - loss: 0.0482 - acc: 0.9836

Test accuracy: 93.60789360789362

data size :  22532

zero :  11267

one :  11265

train_zero :  10101

train_one :  10100

test_zero :  1166

test_one :  1165

choose_zero :  1197

choose_one :  1134

F1score :  0.9351892127011745

AUC : 0.9785047004174059

Confusion Matrix
[[1107   59]
 [  90 1075]]
True label 0
0.9493996569468267  
0.05060034305317324  
True label 1
0.07725321888412018  
0.9227467811158798  

Train_result {'acc': [0.9836146725409634], 'loss': [0.04821374737719634]}
Saved model to disk




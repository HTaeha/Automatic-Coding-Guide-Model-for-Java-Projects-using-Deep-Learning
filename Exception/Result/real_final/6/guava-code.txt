Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 23:01:02.705075: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 23:01:02.714780: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-21 23:01:02.717679: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xb829c40 executing computations on platform Host. Devices:
2019-07-21 23:01:02.717718: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-code
all data

Sentence length Average : 42

Under 10 : 4899
Over 10, Under 200 : 53186
Over 200, Under 400 : 937
Over 400 : 132

guava-code
updated_train_data

Sentence length Average : 44

Under 10 : 0
Over 10, Under 200 : 47249
Over 200, Under 400 : 916
Over 400 : 0


Test_zero:  3679
Train_zero:  33653
zero:  37332
Test_one:  1683
Train_one:  14512
one:  16195

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 688s - loss: 0.2594 - acc: 0.8948

Test accuracy: 92.39679239679239

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1782

choose_one :  1585

F1score :  0.9216646266829867

AUC : 0.9783518784322193

Confusion Matrix
[[1605   79]
 [ 177 1506]]
True label 0
0.9530878859857482  
0.04691211401425178  
True label 1
0.1051693404634581  
0.8948306595365418  

Train_result {'acc': [0.894780361757106], 'loss': [0.25937289213731207]}
Saved model to disk



2

Epoch 1/1
 - 705s - loss: 0.1658 - acc: 0.9344

Test accuracy: 94.38669438669439

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1763

choose_one :  1604

F1score :  0.9425007605719502

AUC : 0.987641540456966

Confusion Matrix
[[1629   55]
 [ 134 1549]]
True label 0
0.9673396674584323  
0.032660332541567694  
True label 1
0.0796197266785502  
0.9203802733214498  

Train_result {'acc': [0.9344013781223084], 'loss': [0.16577852159915019]}
Saved model to disk



3

Epoch 1/1
 - 706s - loss: 0.1257 - acc: 0.9515

Test accuracy: 95.51529551529552

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1725

choose_one :  1642

F1score :  0.9545864661654136

AUC : 0.9915377401230412

Confusion Matrix
[[1629   55]
 [  96 1587]]
True label 0
0.9673396674584323  
0.032660332541567694  
True label 1
0.0570409982174688  
0.9429590017825312  

Train_result {'acc': [0.9514556416881998], 'loss': [0.12566368857754392]}
Saved model to disk



4

Epoch 1/1
 - 706s - loss: 0.0963 - acc: 0.9637

Test accuracy: 96.31719631719632

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1704

choose_one :  1663

F1score :  0.9629408248655111

AUC : 0.993607656839458

Confusion Matrix
[[1632   52]
 [  72 1611]]
True label 0
0.9691211401425178  
0.030878859857482184  
True label 1
0.0427807486631016  
0.9572192513368984  

Train_result {'acc': [0.9637209302325581], 'loss': [0.09631300992435879]}
Saved model to disk



5

Epoch 1/1
 - 706s - loss: 0.0749 - acc: 0.9740

Test accuracy: 96.37659637659638

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1716

choose_one :  1651

F1score :  0.9634073185362929

AUC : 0.994008655790827

Confusion Matrix
[[1639   45]
 [  77 1606]]
True label 0
0.9732779097387173  
0.02672209026128266  
True label 1
0.0457516339869281  
0.954248366013072  

Train_result {'acc': [0.9740223944875107], 'loss': [0.07488905764074995]}
Saved model to disk



6

Epoch 1/1
 - 747s - loss: 0.0598 - acc: 0.9790

Test accuracy: 97.02999702999703

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1690

choose_one :  1677

F1score :  0.9702380952380952

AUC : 0.994754199815678

Confusion Matrix
[[1637   47]
 [  53 1630]]
True label 0
0.9720902612826603  
0.027909738717339667  
True label 1
0.0314913844325609  
0.9685086155674391  

Train_result {'acc': [0.9789836347975883], 'loss': [0.05984106369780234]}
Saved model to disk



7

Epoch 1/1
 - 795s - loss: 0.0481 - acc: 0.9835

Test accuracy: 97.23789723789724

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1629

choose_one :  1738

F1score :  0.9728149663840983

AUC : 0.99576066660739

Confusion Matrix
[[1610   74]
 [  19 1664]]
True label 0
0.9560570071258907  
0.043942992874109264  
True label 1
0.0112893642305407  
0.9887106357694593  

Train_result {'acc': [0.9834969853574504], 'loss': [0.04809665025837966]}
Saved model to disk



8

Epoch 1/1
 - 797s - loss: 0.0428 - acc: 0.9858

Test accuracy: 97.68339768339769

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1682

choose_one :  1685

F1score :  0.9768408551068882

AUC : 0.9957440832807606

Confusion Matrix
[[1644   40]
 [  38 1645]]
True label 0
0.9762470308788599  
0.023752969121140142  
True label 1
0.0225787284610814  
0.9774212715389186  

Train_result {'acc': [0.9858397932816537], 'loss': [0.04284474192026829]}
Saved model to disk



9

Epoch 1/1
 - 797s - loss: 0.0345 - acc: 0.9886

Test accuracy: 97.92099792099792

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1696

choose_one :  1671

F1score :  0.9791293977340488

AUC : 0.9961284989055004

Confusion Matrix
[[1655   29]
 [  41 1642]]
True label 0
0.9827790973871734  
0.0172209026128266  
True label 1
0.0243612596553773  
0.9756387403446227  

Train_result {'acc': [0.9886304909560724], 'loss': [0.03451970350147389]}
Saved model to disk



10

Epoch 1/1
 - 782s - loss: 0.0320 - acc: 0.9893

Test accuracy: 97.8021978021978

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1712

choose_one :  1655

F1score :  0.9778310365488315

AUC : 0.996030410292671

Confusion Matrix
[[1661   23]
 [  51 1632]]
True label 0
0.9863420427553444  
0.013657957244655582  
True label 1
0.030303030303030304  
0.9696969696969697  

Train_result {'acc': [0.989250645994832], 'loss': [0.031974277658593626]}
Saved model to disk



11

Epoch 1/1
 - 690s - loss: 0.0275 - acc: 0.9914

Test accuracy: 97.77249777249777

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1647

choose_one :  1720

F1score :  0.9779606229797237

AUC : 0.9964864517749805

Confusion Matrix
[[1628   56]
 [  19 1664]]
True label 0
0.9667458432304038  
0.0332541567695962  
True label 1
0.0112893642305407  
0.9887106357694593  

Train_result {'acc': [0.9913522825150732], 'loss': [0.027453250436618507]}
Saved model to disk



12

Epoch 1/1
 - 700s - loss: 0.0289 - acc: 0.9920

Test accuracy: 97.5942975942976

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1645

choose_one :  1722

F1score :  0.9762114537444934

AUC : 0.9954468183300097

Confusion Matrix
[[1624   60]
 [  21 1662]]
True label 0
0.9643705463182898  
0.035629453681710214  
True label 1
0.012477718360071301  
0.9875222816399287  

Train_result {'acc': [0.9919724375538329], 'loss': [0.02885706412632908]}
Saved model to disk



13

Epoch 1/1
 - 701s - loss: 0.0234 - acc: 0.9926

Test accuracy: 98.06949806949807

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1671

choose_one :  1696

F1score :  0.9807635395087304

AUC : 0.99652614590787

Confusion Matrix
[[1645   39]
 [  26 1657]]
True label 0
0.9768408551068883  
0.02315914489311164  
True label 1
0.015448603683897801  
0.9845513963161022  

Train_result {'acc': [0.9926270456503015], 'loss': [0.023398455770047275]}
Saved model to disk



14

Epoch 1/1
 - 698s - loss: 0.0231 - acc: 0.9936

Test accuracy: 98.33679833679834

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1692

choose_one :  1675

F1score :  0.9833234067897558

AUC : 0.996236819783697

Confusion Matrix
[[1660   24]
 [  32 1651]]
True label 0
0.9857482185273159  
0.014251781472684086  
True label 1
0.019013666072489603  
0.9809863339275104  

Train_result {'acc': [0.993557278208441], 'loss': [0.023062034532533655]}
Saved model to disk



15

Epoch 1/1
 - 702s - loss: 0.0213 - acc: 0.9940

Test accuracy: 98.12889812889813

data size :  32392

zero :  16197

one :  16195

train_zero :  14513

train_one :  14512

test_zero :  1684

test_one :  1683

choose_zero :  1671

choose_one :  1696

F1score :  0.9813554306007695

AUC : 0.995331793553814

Confusion Matrix
[[1646   38]
 [  25 1658]]
True label 0
0.9774346793349169  
0.022565320665083134  
True label 1
0.014854426619132501  
0.9851455733808675  

Train_result {'acc': [0.9940396210163652], 'loss': [0.021263077620705808]}
Saved model to disk




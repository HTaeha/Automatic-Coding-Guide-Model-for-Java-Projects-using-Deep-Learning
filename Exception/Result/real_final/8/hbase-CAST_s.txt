Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-20 20:34:34.513962: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-20 20:34:34.523771: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-20 20:34:34.526313: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6214f40 executing computations on platform Host. Devices:
2019-07-20 20:34:34.526335: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26255

one : 
22998
hbase-CAST_s
all data

Sentence length Average : 66

Under 10 : 9405
Over 10, Under 200 : 35846
Over 200, Under 400 : 2894
Over 400 : 1108

hbase-CAST_s
updated_train_data

Sentence length Average : 73

Under 10 : 0
Over 10, Under 200 : 31188
Over 200, Under 400 : 3370
Over 400 : 0


Test_zero:  1792
Train_zero:  15844
zero:  17636
Test_one:  2097
Train_one:  18714
one:  20811

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 712s - loss: 0.4084 - acc: 0.8145

Test accuracy: 84.74198047419804

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1997

choose_one :  1588

F1score :  0.8382135462880804

AUC : 0.9388336213249941

Confusion Matrix
[[1621  171]
 [ 376 1417]]
True label 0
0.9045758928571429  
0.09542410714285714  
True label 1
0.20970440602342444  
0.7902955939765756  

Train_result {'loss': [0.4083897366406448], 'acc': [0.8144782101044526]}
Saved model to disk



2

Epoch 1/1
 - 710s - loss: 0.3108 - acc: 0.8635

Test accuracy: 86.66666666666667

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1786

choose_one :  1799

F1score :  0.8669265033407573

AUC : 0.9483507290255757

Confusion Matrix
[[1550  242]
 [ 236 1557]]
True label 0
0.8649553571428571  
0.13504464285714285  
True label 1
0.1316229782487451  
0.8683770217512549  

Train_result {'loss': [0.31084396121361907], 'acc': [0.8634857521556252]}
Saved model to disk



3

Epoch 1/1
 - 709s - loss: 0.2650 - acc: 0.8862

Test accuracy: 86.16457461645746

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1584

choose_one :  2001

F1score :  0.8692672641012124

AUC : 0.9534384087921282

Confusion Matrix
[[1440  352]
 [ 144 1649]]
True label 0
0.8035714285714286  
0.19642857142857142  
True label 1
0.08031232571109871  
0.9196876742889013  

Train_result {'loss': [0.2649693253733322], 'acc': [0.8861750134153558]}
Saved model to disk



4

Epoch 1/1
 - 710s - loss: 0.2319 - acc: 0.9021

Test accuracy: 89.6234309623431

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1888

choose_one :  1697

F1score :  0.8934097421203437

AUC : 0.9645415454943829

Confusion Matrix
[[1654  138]
 [ 234 1559]]
True label 0
0.9229910714285714  
0.07700892857142858  
True label 1
0.1305075292805354  
0.8694924707194646  

Train_result {'loss': [0.23187018184937008], 'acc': [0.9021111426678027]}
Saved model to disk



5

Epoch 1/1
 - 712s - loss: 0.2044 - acc: 0.9160

Test accuracy: 87.97768479776849

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  2019

choose_one :  1566

F1score :  0.8716880023816611

AUC : 0.962197048541949

Confusion Matrix
[[1690  102]
 [ 329 1464]]
True label 0
0.9430803571428571  
0.056919642857142856  
True label 1
0.18349135527049637  
0.8165086447295036  

Train_result {'loss': [0.20439660976180907], 'acc': [0.915996086972123]}
Saved model to disk



6

Epoch 1/1
 - 709s - loss: 0.1783 - acc: 0.9265

Test accuracy: 89.9860529986053

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1907

choose_one :  1678

F1score :  0.8965715932008067

AUC : 0.9656296062066767

Confusion Matrix
[[1670  122]
 [ 237 1556]]
True label 0
0.9319196428571429  
0.06808035714285714  
True label 1
0.13218070273284996  
0.86781929726715  

Train_result {'loss': [0.178271765128237], 'acc': [0.9265044652718609]}
Saved model to disk



7

Epoch 1/1
 - 709s - loss: 0.1544 - acc: 0.9382

Test accuracy: 89.9302649930265

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1799

choose_one :  1786

F1score :  0.8991338362671139

AUC : 0.9670447698390567

Confusion Matrix
[[1615  177]
 [ 184 1609]]
True label 0
0.9012276785714286  
0.09877232142857142  
True label 1
0.10262130507529281  
0.8973786949247072  

Train_result {'loss': [0.1543543262159335], 'acc': [0.9382435545457414]}
Saved model to disk



8

Epoch 1/1
 - 805s - loss: 0.1341 - acc: 0.9478

Test accuracy: 90.12552301255229

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1866

choose_one :  1719

F1score :  0.8992027334851936

AUC : 0.9695290091426977

Confusion Matrix
[[1652  140]
 [ 214 1579]]
True label 0
0.921875  
0.078125  
True label 1
0.11935303959843838  
0.8806469604015617  

Train_result {'loss': [0.13409028880580512], 'acc': [0.9477736754078703]}
Saved model to disk



9

Epoch 1/1
 - 815s - loss: 0.1162 - acc: 0.9556

Test accuracy: 90.6276150627615

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1732

choose_one :  1853

F1score :  0.9078442128359845

AUC : 0.9701119432714524

Confusion Matrix
[[1594  198]
 [ 138 1655]]
True label 0
0.8895089285714286  
0.11049107142857142  
True label 1
0.0769659788064696  
0.9230340211935304  

Train_result {'loss': [0.11621757832275562], 'acc': [0.9555997349237906]}
Saved model to disk



10

Epoch 1/1
 - 818s - loss: 0.1044 - acc: 0.9594

Test accuracy: 90.0139470013947

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1668

choose_one :  1917

F1score :  0.9035040431266848

AUC : 0.9695630888475022

Confusion Matrix
[[1551  241]
 [ 117 1676]]
True label 0
0.8655133928571429  
0.13448660714285715  
True label 1
0.0652537646402677  
0.9347462353597323  

Train_result {'loss': [0.10439876910323632], 'acc': [0.9593549812275304]}
Saved model to disk



11

Epoch 1/1
 - 816s - loss: 0.0924 - acc: 0.9645

Test accuracy: 90.68340306834031

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1826

choose_one :  1759

F1score :  0.9059684684684685

AUC : 0.9674699102661143

Confusion Matrix
[[1642  150]
 [ 184 1609]]
True label 0
0.9162946428571429  
0.08370535714285714  
True label 1
0.10262130507529281  
0.8973786949247072  

Train_result {'loss': [0.09239694475210673], 'acc': [0.9645302786474678]}
Saved model to disk



12

Epoch 1/1
 - 815s - loss: 0.0820 - acc: 0.9703

Test accuracy: 90.5439330543933

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1713

choose_one :  1872

F1score :  0.9075034106412005

AUC : 0.967695085301968

Confusion Matrix
[[1583  209]
 [ 130 1663]]
True label 0
0.8833705357142857  
0.11662946428571429  
True label 1
0.07250418293363078  
0.9274958170663692  

Train_result {'loss': [0.08195787143614545], 'acc': [0.9703051532077377]}
Saved model to disk



13

Epoch 1/1
 - 815s - loss: 0.0786 - acc: 0.9725

Test accuracy: 90.59972105997211

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1851

choose_one :  1734

F1score :  0.9044513751063226

AUC : 0.9680259229842243

Confusion Matrix
[[1653  139]
 [ 198 1595]]
True label 0
0.9224330357142857  
0.07756696428571429  
True label 1
0.11042944785276074  
0.8895705521472392  

Train_result {'loss': [0.07863886759057186], 'acc': [0.9724510082362965]}
Saved model to disk



14

Epoch 1/1
 - 817s - loss: 0.0707 - acc: 0.9756

Test accuracy: 90.59972105997211

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1761

choose_one :  1824

F1score :  0.9068288636991982

AUC : 0.967018937734045

Confusion Matrix
[[1608  184]
 [ 153 1640]]
True label 0
0.8973214285714286  
0.10267857142857142  
True label 1
0.08533184606804238  
0.9146681539319577  

Train_result {'loss': [0.07066735580783143], 'acc': [0.9756066773978227]}
Saved model to disk



15

Epoch 1/1
 - 818s - loss: 0.0635 - acc: 0.9781

Test accuracy: 89.9860529986053

data size :  35274

zero :  17636

one :  17638

train_zero :  15844

train_one :  15845

test_zero :  1792

test_one :  1793

choose_zero :  1743

choose_one :  1842

F1score :  0.9012379642365888

AUC : 0.9662081831128995

Confusion Matrix
[[1588  204]
 [ 155 1638]]
True label 0
0.8861607142857143  
0.11383928571428571  
True label 1
0.08644729503625209  
0.913552704963748  

Train_result {'loss': [0.06351004383550725], 'acc': [0.9780680993404651]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-24 10:33:13.574296: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-24 10:33:13.585414: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-24 10:33:13.587612: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6e36620 executing computations on platform Host. Devices:
2019-07-24 10:33:13.587651: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-CAST
all data

Sentence length Average : 73

Under 10 : 9491
Over 10, Under 200 : 26126
Over 200, Under 400 : 2656
Over 400 : 1198

glassfish-CAST
updated_train_data

Sentence length Average : 83

Under 10 : 0
Over 10, Under 200 : 23101
Over 200, Under 400 : 3309
Over 400 : 0


Test_zero:  1775
Train_zero:  16081
zero:  17856
Test_one:  1150
Train_one:  10329
one:  11479

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 470s - loss: 0.5061 - acc: 0.7493

Test accuracy: 79.2264232942199

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1393

choose_one :  908

F1score :  0.7677356656948494

AUC : 0.8962323877157858

Confusion Matrix
[[1033  118]
 [ 360  790]]
True label 0
0.89748045178106  
0.10251954821894005  
True label 1
0.3130434782608696  
0.6869565217391305  

Train_result {'loss': [0.5060532262811265], 'acc': [0.7492618229545105]}
Saved model to disk



2

Epoch 1/1
 - 501s - loss: 0.3666 - acc: 0.8314

Test accuracy: 80.7909604519774

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  867

choose_one :  1434

F1score :  0.8289473684210528

AUC : 0.9275140709402032

Confusion Matrix
[[ 788  363]
 [  79 1071]]
True label 0
0.684622067767159  
0.315377932232841  
True label 1
0.06869565217391305  
0.931304347826087  

Train_result {'loss': [0.36663740068952505], 'acc': [0.8314051987085149]}
Saved model to disk



3

Epoch 1/1
 - 511s - loss: 0.3123 - acc: 0.8593

Test accuracy: 85.74532811820947

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1129

choose_one :  1172

F1score :  0.8587424633936261

AUC : 0.9375899973557964

Confusion Matrix
[[976 175]
 [153 997]]
True label 0
0.8479582971329279  
0.1520417028670721  
True label 1
0.13304347826086957  
0.8669565217391304  

Train_result {'loss': [0.31226525428051743], 'acc': [0.8593349145852768]}
Saved model to disk



4

Epoch 1/1
 - 512s - loss: 0.2745 - acc: 0.8822

Test accuracy: 85.48457192524988

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1077

choose_one :  1224

F1score :  0.8593091828138164

AUC : 0.9410047973406868

Confusion Matrix
[[ 947  204]
 [ 130 1020]]
True label 0
0.8227628149435273  
0.17723718505647262  
True label 1
0.11304347826086956  
0.8869565217391304  

Train_result {'loss': [0.2744709998419707], 'acc': [0.8822305048704782]}
Saved model to disk



5

Epoch 1/1
 - 511s - loss: 0.2398 - acc: 0.8957

Test accuracy: 87.78791829639287

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1184

choose_one :  1117

F1score :  0.8760476400529333

AUC : 0.9502300457069468

Confusion Matrix
[[1027  124]
 [ 157  993]]
True label 0
0.8922675933970461  
0.10773240660295395  
True label 1
0.13652173913043478  
0.8634782608695653  

Train_result {'loss': [0.23981191581574499], 'acc': [0.8956871097544524]}
Saved model to disk



6

Epoch 1/1
 - 512s - loss: 0.2089 - acc: 0.9128

Test accuracy: 88.87440243372447

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1143

choose_one :  1158

F1score :  0.8890814558058926

AUC : 0.9575170928870925

Confusion Matrix
[[1019  132]
 [ 124 1026]]
True label 0
0.8853171155516942  
0.11468288444830582  
True label 1
0.10782608695652174  
0.8921739130434783  

Train_result {'loss': [0.2089133046434362], 'acc': [0.9127740936009476]}
Saved model to disk



7

Epoch 1/1
 - 508s - loss: 0.1832 - acc: 0.9234

Test accuracy: 88.17905258583225

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1093

choose_one :  1208

F1score :  0.8846480067854113

AUC : 0.9553888867903149

Confusion Matrix
[[ 986  165]
 [ 107 1043]]
True label 0
0.8566463944396178  
0.14335360556038226  
True label 1
0.09304347826086956  
0.9069565217391304  

Train_result {'loss': [0.1831667986441714], 'acc': [0.923423205382642]}
Saved model to disk



8

Epoch 1/1
 - 509s - loss: 0.1621 - acc: 0.9353

Test accuracy: 88.65710560625814

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1240

choose_one :  1061

F1score :  0.8819538670284939

AUC : 0.9597903524345559

Confusion Matrix
[[1065   86]
 [ 175  975]]
True label 0
0.9252823631624674  
0.07471763683753258  
True label 1
0.15217391304347827  
0.8478260869565217  

Train_result {'loss': [0.16214589005206964], 'acc': [0.9352824434928704]}
Saved model to disk



9

Epoch 1/1
 - 510s - loss: 0.1367 - acc: 0.9461

Test accuracy: 88.43980877879183

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1119

choose_one :  1182

F1score :  0.8859348198970841

AUC : 0.9587285158463341

Confusion Matrix
[[1002  149]
 [ 117 1033]]
True label 0
0.8705473501303215  
0.12945264986967853  
True label 1
0.10173913043478261  
0.8982608695652174  

Train_result {'loss': [0.13670356975669717], 'acc': [0.9461251754740893]}
Saved model to disk



10

Epoch 1/1
 - 510s - loss: 0.1234 - acc: 0.9528

Test accuracy: 89.13515862668405

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1199

choose_one :  1102

F1score :  0.88898756660746

AUC : 0.9571329278887925

Confusion Matrix
[[1050  101]
 [ 149 1001]]
True label 0
0.9122502172024327  
0.08774978279756733  
True label 1
0.12956521739130436  
0.8704347826086957  

Train_result {'loss': [0.12344655156167296], 'acc': [0.9528050728351797]}
Saved model to disk



11

Epoch 1/1
 - 508s - loss: 0.1054 - acc: 0.9597

Test accuracy: 89.61321164710995

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1126

choose_one :  1175

F1score :  0.8972043010752687

AUC : 0.9610025308805198

Confusion Matrix
[[1019  132]
 [ 107 1043]]
True label 0
0.8853171155516942  
0.11468288444830582  
True label 1
0.09304347826086956  
0.9069565217391304  

Train_result {'loss': [0.10541260911279705], 'acc': [0.9597269954983301]}
Saved model to disk



12

Epoch 1/1
 - 510s - loss: 0.0959 - acc: 0.9638

Test accuracy: 90.17818339852238

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1153

choose_one :  1148

F1score :  0.9016536118363795

AUC : 0.9618509424696859

Confusion Matrix
[[1039  112]
 [ 114 1036]]
True label 0
0.9026933101650738  
0.09730668983492616  
True label 1
0.09913043478260869  
0.9008695652173913  

Train_result {'loss': [0.09592527909563837], 'acc': [0.9638414250649708]}
Saved model to disk



13

Epoch 1/1
 - 511s - loss: 0.0863 - acc: 0.9688

Test accuracy: 89.4393741851369

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1242

choose_one :  1059

F1score :  0.8899954730647353

AUC : 0.9624496656971253

Confusion Matrix
[[1075   76]
 [ 167  983]]
True label 0
0.9339704604691572  
0.06602953953084274  
True label 1
0.14521739130434783  
0.8547826086956521  

Train_result {'loss': [0.08628454433361073], 'acc': [0.9687787404860824]}
Saved model to disk



14

Epoch 1/1
 - 511s - loss: 0.0757 - acc: 0.9725

Test accuracy: 90.09126466753585

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1171

choose_one :  1130

F1score :  0.9

AUC : 0.9626313602538435

Confusion Matrix
[[1047  104]
 [ 124 1026]]
True label 0
0.9096437880104257  
0.09035621198957429  
True label 1
0.10782608695652174  
0.8921739130434783  

Train_result {'loss': [0.07574043849026825], 'acc': [0.9725059296190522]}
Saved model to disk



15

Epoch 1/1
 - 509s - loss: 0.0710 - acc: 0.9748

Test accuracy: 89.70013037809647

data size :  22960

zero :  11481

one :  11479

train_zero :  10330

train_one :  10329

test_zero :  1151

test_one :  1150

choose_zero :  1054

choose_one :  1247

F1score :  0.9011264080100125

AUC : 0.9653919087372039

Confusion Matrix
[[ 984  167]
 [  70 1080]]
True label 0
0.8549087749782798  
0.14509122502172025  
True label 1
0.06086956521739131  
0.9391304347826087  

Train_result {'loss': [0.07096710842779157], 'acc': [0.9747809671185429]}
Saved model to disk




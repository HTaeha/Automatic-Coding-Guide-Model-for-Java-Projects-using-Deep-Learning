Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 06:38:30.063865: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 06:38:30.074628: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-18 06:38:30.077490: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x4e37570 executing computations on platform Host. Devices:
2019-07-18 06:38:30.077537: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41834

one : 
17320
guava-CAST_s
all data

Sentence length Average : 47

Under 10 : 5998
Over 10, Under 200 : 51675
Over 200, Under 400 : 1254
Over 400 : 227

guava-CAST_s
updated_train_data

Sentence length Average : 51

Under 10 : 0
Over 10, Under 200 : 46097
Over 200, Under 400 : 1291
Over 400 : 0


Test_zero:  3650
Train_zero:  32966
zero:  36616
Test_one:  1618
Train_one:  14422
one:  16040

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 649s - loss: 0.3149 - acc: 0.8616

Test accuracy: 91.53537225826382

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1595

choose_one :  1642

F1score :  0.9159509202453988

AUC : 0.9735835501015063

Confusion Matrix
[[1470  149]
 [ 125 1493]]
True label 0
0.9079678814082767  
0.09203211859172329  
True label 1
0.07725587144622992  
0.9227441285537701  

Train_result {'acc': [0.8616051308719015], 'loss': [0.31493689136243525]}
Saved model to disk



2

Epoch 1/1
 - 646s - loss: 0.2157 - acc: 0.9101

Test accuracy: 92.89465554525795

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1667

choose_one :  1570

F1score :  0.9278544542032623

AUC : 0.9822243735737011

Confusion Matrix
[[1528   91]
 [ 139 1479]]
True label 0
0.9437924644842496  
0.056207535515750466  
True label 1
0.08590852904820766  
0.9140914709517923  

Train_result {'acc': [0.9101057375669686], 'loss': [0.21566460260507614]}
Saved model to disk



3

Epoch 1/1
 - 646s - loss: 0.1651 - acc: 0.9336

Test accuracy: 94.40840284213779

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1652

choose_one :  1585

F1score :  0.9434904776771778

AUC : 0.9881231146513397

Confusion Matrix
[[1545   74]
 [ 107 1511]]
True label 0
0.9542927733168622  
0.04570722668313774  
True label 1
0.06613102595797281  
0.9338689740420272  

Train_result {'acc': [0.9335760097070549], 'loss': [0.16508838122887842]}
Saved model to disk



4

Epoch 1/1
 - 733s - loss: 0.1288 - acc: 0.9493

Test accuracy: 94.53197405004634

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1730

choose_one :  1507

F1score :  0.94336

AUC : 0.9917462670955457

Confusion Matrix
[[1586   33]
 [ 144 1474]]
True label 0
0.9796170475602224  
0.02038295243977764  
True label 1
0.08899876390605686  
0.9110012360939431  

Train_result {'acc': [0.9493153059455711], 'loss': [0.12875514310838074]}
Saved model to disk



5

Epoch 1/1
 - 734s - loss: 0.1003 - acc: 0.9613

Test accuracy: 96.50911337658326

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1638

choose_one :  1599

F1score :  0.9648741063102269

AUC : 0.9943249621498719

Confusion Matrix
[[1572   47]
 [  66 1552]]
True label 0
0.9709697344039531  
0.029030265596046944  
True label 1
0.0407911001236094  
0.9592088998763906  

Train_result {'acc': [0.9613104524222295], 'loss': [0.1002646214702107]}
Saved model to disk



6

Epoch 1/1
 - 730s - loss: 0.0794 - acc: 0.9704

Test accuracy: 96.16929255483473

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1571

choose_one :  1666

F1score :  0.9622411693057247

AUC : 0.9944942665549932

Confusion Matrix
[[1533   86]
 [  38 1580]]
True label 0
0.9468807906114886  
0.053119209388511425  
True label 1
0.023485784919653894  
0.9765142150803461  

Train_result {'acc': [0.9703588143525741], 'loss': [0.07943874307591542]}
Saved model to disk



7

Epoch 1/1
 - 734s - loss: 0.0655 - acc: 0.9766

Test accuracy: 97.09607661414891

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1623

choose_one :  1614

F1score :  0.9709158415841584

AUC : 0.9968357063944765

Confusion Matrix
[[1574   45]
 [  49 1569]]
True label 0
0.9722050648548487  
0.027794935145151328  
True label 1
0.030284301606922127  
0.9697156983930779  

Train_result {'acc': [0.9765643959112361], 'loss': [0.06554860884273186]}
Saved model to disk



8

Epoch 1/1
 - 733s - loss: 0.0567 - acc: 0.9808

Test accuracy: 97.28143342601174

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1613

choose_one :  1624

F1score :  0.9728562615669339

AUC : 0.9955858695909438

Confusion Matrix
[[1572   47]
 [  41 1577]]
True label 0
0.9709697344039531  
0.029030265596046944  
True label 1
0.02533992583436341  
0.9746600741656366  

Train_result {'acc': [0.9807592303692148], 'loss': [0.05674982613119999]}
Saved model to disk



9

Epoch 1/1
 - 731s - loss: 0.0492 - acc: 0.9834

Test accuracy: 97.52857584182885

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1609

choose_one :  1628

F1score :  0.975354282193469

AUC : 0.9960271681080126

Confusion Matrix
[[1574   45]
 [  35 1583]]
True label 0
0.9722050648548487  
0.027794935145151328  
True label 1
0.021631644004944377  
0.9783683559950557  

Train_result {'acc': [0.9834286704801526], 'loss': [0.049160977474827575]}
Saved model to disk



10

Epoch 1/1
 - 730s - loss: 0.0432 - acc: 0.9856

Test accuracy: 97.2505406240346

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1622

choose_one :  1615

F1score :  0.9724713888029695

AUC : 0.9955349064836525

Confusion Matrix
[[1576   43]
 [  46 1572]]
True label 0
0.9734403953057443  
0.026559604694255712  
True label 1
0.02843016069221261  
0.9715698393077874  

Train_result {'acc': [0.9855780897902583], 'loss': [0.04318738561994252]}
Saved model to disk



11

Epoch 1/1
 - 736s - loss: 0.0416 - acc: 0.9865

Test accuracy: 97.96107506950881

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1599

choose_one :  1638

F1score :  0.9797297297297297

AUC : 0.9966366257918369

Confusion Matrix
[[1576   43]
 [  23 1595]]
True label 0
0.9734403953057443  
0.026559604694255712  
True label 1
0.014215080346106305  
0.9857849196538937  

Train_result {'acc': [0.9864794591783671], 'loss': [0.04158144028799576]}
Saved model to disk



12

Epoch 1/1
 - 706s - loss: 0.0379 - acc: 0.9882

Test accuracy: 97.74482545566883

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1604

choose_one :  1633

F1score :  0.977545370655183

AUC : 0.99676870995006

Confusion Matrix
[[1575   44]
 [  29 1589]]
True label 0
0.9728227300802965  
0.027177269919703522  
True label 1
0.01792336217552534  
0.9820766378244746  

Train_result {'acc': [0.9881781937944184], 'loss': [0.037932287916843145]}
Saved model to disk



13

Epoch 1/1
 - 685s - loss: 0.0360 - acc: 0.9886

Test accuracy: 97.55946864380599

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1566

choose_one :  1671

F1score :  0.9759805411979325

AUC : 0.9971327048774175

Confusion Matrix
[[1553   66]
 [  13 1605]]
True label 0
0.9592340951204448  
0.04076590487955528  
True label 1
0.008034610630407911  
0.9919653893695921  

Train_result {'acc': [0.9886288784884729], 'loss': [0.036009758443348874]}
Saved model to disk



14

Epoch 1/1
 - 689s - loss: 0.0344 - acc: 0.9894

Test accuracy: 98.08464627741736

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1601

choose_one :  1636

F1score :  0.9809465273509528

AUC : 0.9960628613704227

Confusion Matrix
[[1579   40]
 [  22 1596]]
True label 0
0.9752933909820877  
0.02470660901791229  
True label 1
0.013597033374536464  
0.9864029666254636  

Train_result {'acc': [0.9894262437164153], 'loss': [0.034443422409221644]}
Saved model to disk



15

Epoch 1/1
 - 694s - loss: 0.0299 - acc: 0.9911

Test accuracy: 97.83750386160025

data size :  32082

zero :  16042

one :  16040

train_zero :  14423

train_one :  14422

test_zero :  1619

test_one :  1618

choose_zero :  1621

choose_one :  1616

F1score :  0.9783549783549783

AUC : 0.9972720422119593

Confusion Matrix
[[1585   34]
 [  36 1582]]
True label 0
0.9789993823347746  
0.021000617665225447  
True label 1
0.022249690976514216  
0.9777503090234858  

Train_result {'acc': [0.9910903102790778], 'loss': [0.029923073742041117]}
Saved model to disk




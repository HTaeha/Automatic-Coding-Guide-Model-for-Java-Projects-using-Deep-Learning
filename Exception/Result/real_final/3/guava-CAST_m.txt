Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 12:11:59.014709: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 12:11:59.024223: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-19 12:11:59.026797: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xf91f210 executing computations on platform Host. Devices:
2019-07-19 12:11:59.026855: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41860
one : 
17294

Second data
zero : 
41860
one : 
17294

guava-AST

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32766
Over 200, Under 400 : 265
Over 400 : 0


guava-code

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 32134
Over 200, Under 400 : 897
Over 400 : 0


Test_zero:  2264
Train_zero:  20398
zero:  22662
Test_one:  1430
Train_one:  12633
one:  14063
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 971s - loss: 0.2728 - acc: 0.8886

Test accuracy: 92.76476756378888

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1570

choose_one :  1291

F1score :  0.9239250275633957

AUC : 0.9807015486260768

Confusion Matrix
[[1397   34]
 [ 173 1257]]
True label 0
0.976240391334731  
0.023759608665269043  
True label 1
0.12097902097902098  
0.879020979020979  

Train_result {'acc': [0.8885898602920805], 'loss': [0.2727682449082967]}
Saved model to disk



2

Epoch 1/1
 - 1033s - loss: 0.1705 - acc: 0.9346

Test accuracy: 94.092974484446

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1562

choose_one :  1299

F1score :  0.9380725540491023

AUC : 0.9901819354649543

Confusion Matrix
[[1412   19]
 [ 150 1280]]
True label 0
0.986722571628232  
0.013277428371767994  
True label 1
0.1048951048951049  
0.8951048951048951  

Train_result {'acc': [0.934618276820249], 'loss': [0.17045632596314012]}
Saved model to disk



3

Epoch 1/1
 - 1142s - loss: 0.1246 - acc: 0.9551

Test accuracy: 96.5396714435512

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1490

choose_one :  1371

F1score :  0.9646554801856478

AUC : 0.9939237561879072

Confusion Matrix
[[1411   20]
 [  79 1351]]
True label 0
0.9860237596086653  
0.013976240391334731  
True label 1
0.05524475524475524  
0.9447552447552447  

Train_result {'acc': [0.9550797482929991], 'loss': [0.12455897723809406]}
Saved model to disk



4

Epoch 1/1
 - 1144s - loss: 0.0915 - acc: 0.9673

Test accuracy: 96.26004893393917

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1502

choose_one :  1359

F1score :  0.9616349946217282

AUC : 0.9959840299462941

Confusion Matrix
[[1413   18]
 [  89 1341]]
True label 0
0.9874213836477987  
0.012578616352201259  
True label 1
0.062237762237762236  
0.9377622377622378  

Train_result {'acc': [0.967309138401868], 'loss': [0.09149081173707889]}
Saved model to disk



5

Epoch 1/1
 - 1144s - loss: 0.0712 - acc: 0.9753

Test accuracy: 97.5882558545963

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1440

choose_one :  1421

F1score :  0.9757979656260962

AUC : 0.9969369554275214

Confusion Matrix
[[1401   30]
 [  39 1391]]
True label 0
0.9790356394129979  
0.020964360587002098  
True label 1
0.02727272727272727  
0.9727272727272728  

Train_result {'acc': [0.975343333189614], 'loss': [0.07119936195579647]}
Saved model to disk



6

Epoch 1/1
 - 1146s - loss: 0.0560 - acc: 0.9812

Test accuracy: 97.51835022719328

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1480

choose_one :  1381

F1score :  0.9747420846673781

AUC : 0.997545850376039

Confusion Matrix
[[1420   11]
 [  60 1370]]
True label 0
0.9923130677847659  
0.007686932215234102  
True label 1
0.04195804195804196  
0.958041958041958  

Train_result {'acc': [0.9812403530461563], 'loss': [0.056014152645876995]}
Saved model to disk



7

Epoch 1/1
 - 1149s - loss: 0.0454 - acc: 0.9853

Test accuracy: 98.28731212862635

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1438

choose_one :  1423

F1score :  0.9828250963897652

AUC : 0.99850415133434

Confusion Matrix
[[1410   21]
 [  28 1402]]
True label 0
0.9853249475890985  
0.014675052410901468  
True label 1
0.019580419580419582  
0.9804195804195804  

Train_result {'acc': [0.9852772390865556], 'loss': [0.04540149115686298]}
Saved model to disk



8

Epoch 1/1
 - 1147s - loss: 0.0369 - acc: 0.9884

Test accuracy: 98.53198182453687

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1409

choose_one :  1452

F1score :  0.9854267869535045

AUC : 0.9982402642780003

Confusion Matrix
[[1399   32]
 [  10 1420]]
True label 0
0.9776380153738644  
0.02236198462613557  
True label 1
0.006993006993006993  
0.993006993006993  

Train_result {'acc': [0.9884434242292318], 'loss': [0.03685223353364909]}
Saved model to disk



9

Epoch 1/1
 - 1145s - loss: 0.0367 - acc: 0.9899

Test accuracy: 98.8465571478504

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1446

choose_one :  1415

F1score :  0.9884007029876977

AUC : 0.998950315931448

Confusion Matrix
[[1422    9]
 [  24 1406]]
True label 0
0.9937106918238994  
0.006289308176100629  
True label 1
0.016783216783216783  
0.9832167832167832  

Train_result {'acc': [0.9899077848577196], 'loss': [0.03674463712830389]}
Saved model to disk



10

Epoch 1/1
 - 1145s - loss: 0.0280 - acc: 0.9920

Test accuracy: 98.91646277525341

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1428

choose_one :  1433

F1score :  0.9891721969961578

AUC : 0.999016287695533

Confusion Matrix
[[1414   17]
 [  14 1416]]
True label 0
0.9881201956673655  
0.011879804332634521  
True label 1
0.009790209790209791  
0.9902097902097902  

Train_result {'acc': [0.992044959845539], 'loss': [0.027994449164553153]}
Saved model to disk



11

Epoch 1/1
 - 1145s - loss: 0.0222 - acc: 0.9936

Test accuracy: 98.8465571478504

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1438

choose_one :  1423

F1score :  0.9884332281808622

AUC : 0.9985723221572278

Confusion Matrix
[[1418   13]
 [  20 1410]]
True label 0
0.9909154437456325  
0.009084556254367574  
True label 1
0.013986013986013986  
0.986013986013986  

Train_result {'acc': [0.9935884750860806], 'loss': [0.02222542827638341]}
Saved model to disk



12

Epoch 1/1
 - 1097s - loss: 0.0241 - acc: 0.9930

Test accuracy: 99.12617965746242

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1424

choose_one :  1437

F1score :  0.9912800837111965

AUC : 0.999160448217052

Confusion Matrix
[[1415   16]
 [   9 1421]]
True label 0
0.9888190076869322  
0.011180992313067784  
True label 1
0.006293706293706294  
0.9937062937062937  

Train_result {'acc': [0.9930343926861123], 'loss': [0.02409827368762161]}
Saved model to disk



13

Epoch 1/1
 - 1033s - loss: 0.0225 - acc: 0.9936

Test accuracy: 98.91646277525341

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1414

choose_one :  1447

F1score :  0.989224887035106

AUC : 0.9990614905709245

Confusion Matrix
[[1407   24]
 [   7 1423]]
True label 0
0.9832285115303984  
0.016771488469601678  
True label 1
0.0048951048951048955  
0.9951048951048951  

Train_result {'acc': [0.9936280524003641], 'loss': [0.02246483304811162]}
Saved model to disk



14

Epoch 1/1
 - 1033s - loss: 0.0188 - acc: 0.9953

Test accuracy: 98.70674589304438

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1406

choose_one :  1455

F1score :  0.9871750433275562

AUC : 0.9991682670927955

Confusion Matrix
[[1400   31]
 [   6 1424]]
True label 0
0.9783368273934312  
0.02166317260656883  
True label 1
0.004195804195804196  
0.9958041958041958  

Train_result {'acc': [0.9952902996002692], 'loss': [0.018846064448009892]}
Saved model to disk



15

Epoch 1/1
 - 1032s - loss: 0.0198 - acc: 0.9953

Test accuracy: 99.12617965746242

data size :  28128

zero :  14065

one :  14063

train_zero :  12634

train_one :  12633

test_zero :  1431

test_one :  1430

choose_zero :  1412

choose_one :  1449

F1score :  0.9913164293157347

AUC : 0.9988181280634111

Confusion Matrix
[[1409   22]
 [   3 1427]]
True label 0
0.9846261355695318  
0.015373864430468204  
True label 1
0.002097902097902098  
0.9979020979020979  

Train_result {'acc': [0.9952902996002692], 'loss': [0.0198169842026431]}
Saved model to disk




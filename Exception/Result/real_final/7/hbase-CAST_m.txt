Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 11:04:08.210151: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 11:04:08.220076: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-22 11:04:08.222533: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6f6d870 executing computations on platform Host. Devices:
2019-07-22 11:04:08.222580: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
26276
one : 
22977

Second data
zero : 
26276
one : 
22977

hbase-AST

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23395
Over 200, Under 400 : 1507
Over 400 : 0


hbase-code

Sentence length Average : 88

Under 10 : 0
Over 10, Under 200 : 22199
Over 200, Under 400 : 2703
Over 400 : 0


Test_zero:  1050
Train_zero:  9335
zero:  10385
Test_one:  1745
Train_one:  15567
one:  17312
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 757s - loss: 0.4420 - acc: 0.7947

Test accuracy: 85.29271775345075

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1265

choose_one :  836

F1score :  0.8362480127186008

AUC : 0.9478736803950886

Confusion Matrix
[[1003   47]
 [ 262  789]]
True label 0
0.9552380952380952  
0.04476190476190476  
True label 1
0.24928639391056137  
0.7507136060894386  

Train_result {'acc': [0.7946548122852988], 'loss': [0.44195476347859586]}
Saved model to disk



2

Epoch 1/1
 - 754s - loss: 0.3137 - acc: 0.8591

Test accuracy: 88.29128986197048

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  958

choose_one :  1143

F1score :  0.8878760255241568

AUC : 0.9609686919487109

Confusion Matrix
[[881 169]
 [ 77 974]]
True label 0
0.839047619047619  
0.16095238095238096  
True label 1
0.07326355851569934  
0.9267364414843007  

Train_result {'acc': [0.8591398425397464], 'loss': [0.3136817137862138]}
Saved model to disk



3

Epoch 1/1
 - 756s - loss: 0.2650 - acc: 0.8833

Test accuracy: 87.62494050452165

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  886

choose_one :  1215

F1score :  0.8852603706972638

AUC : 0.9684046939422772

Confusion Matrix
[[ 838  212]
 [  48 1003]]
True label 0
0.7980952380952381  
0.2019047619047619  
True label 1
0.04567078972407231  
0.9543292102759277  

Train_result {'acc': [0.8832949493931342], 'loss': [0.2650289209949128]}
Saved model to disk



4

Epoch 1/1
 - 764s - loss: 0.2279 - acc: 0.9036

Test accuracy: 90.76630176106616

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  978

choose_one :  1123

F1score :  0.9107635694572217

AUC : 0.9718100675094016

Confusion Matrix
[[917 133]
 [ 61 990]]
True label 0
0.8733333333333333  
0.12666666666666668  
True label 1
0.058039961941008564  
0.9419600380589914  

Train_result {'acc': [0.9036473675753843], 'loss': [0.227878331521137]}
Saved model to disk



5

Epoch 1/1
 - 764s - loss: 0.1986 - acc: 0.9186

Test accuracy: 90.48072346501665

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  968

choose_one :  1133

F1score :  0.9084249084249084

AUC : 0.9755489103348286

Confusion Matrix
[[909 141]
 [ 59 992]]
True label 0
0.8657142857142858  
0.13428571428571429  
True label 1
0.056137012369172214  
0.9438629876308278  

Train_result {'acc': [0.9185903272518456], 'loss': [0.1985941980450916]}
Saved model to disk



6

Epoch 1/1
 - 764s - loss: 0.1754 - acc: 0.9299

Test accuracy: 91.81342217991433

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1130

choose_one :  971

F1score :  0.9149357072205736

AUC : 0.9763381813239093

Confusion Matrix
[[1004   46]
 [ 126  925]]
True label 0
0.9561904761904761  
0.04380952380952381  
True label 1
0.11988582302568981  
0.8801141769743102  

Train_result {'acc': [0.9298912752396765], 'loss': [0.1754209177956527]}
Saved model to disk



7

Epoch 1/1
 - 764s - loss: 0.1510 - acc: 0.9418

Test accuracy: 92.3369823893384

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1105

choose_one :  996

F1score :  0.9213483146067416

AUC : 0.979141860359748

Confusion Matrix
[[997  53]
 [108 943]]
True label 0
0.9495238095238095  
0.05047619047619047  
True label 1
0.1027592768791627  
0.8972407231208372  

Train_result {'acc': [0.9417813721846502], 'loss': [0.15098967427634943]}
Saved model to disk



8

Epoch 1/1
 - 766s - loss: 0.1290 - acc: 0.9497

Test accuracy: 92.19419324131366

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1022

choose_one :  1079

F1score :  0.9230046948356808

AUC : 0.9793076888224367

Confusion Matrix
[[954  96]
 [ 68 983]]
True label 0
0.9085714285714286  
0.09142857142857143  
True label 1
0.06470028544243578  
0.9352997145575642  

Train_result {'acc': [0.9497081034759788], 'loss': [0.12899509483774665]}
Saved model to disk



9

Epoch 1/1
 - 764s - loss: 0.1118 - acc: 0.9573

Test accuracy: 92.38457877201333

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1110

choose_one :  991

F1score :  0.9216454456415278

AUC : 0.9782298038149609

Confusion Matrix
[[1000   50]
 [ 110  941]]
True label 0
0.9523809523809523  
0.047619047619047616  
True label 1
0.10466222645099905  
0.8953377735490009  

Train_result {'acc': [0.9572599218102517], 'loss': [0.11180273513792253]}
Saved model to disk



10

Epoch 1/1
 - 765s - loss: 0.0950 - acc: 0.9665

Test accuracy: 92.14659685863874

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1009

choose_one :  1092

F1score :  0.9230051329911338

AUC : 0.9787440532825881

Confusion Matrix
[[947 103]
 [ 62 989]]
True label 0
0.9019047619047619  
0.0980952380952381  
True label 1
0.058991436726926735  
0.9410085632730733  

Train_result {'acc': [0.9665256279824115], 'loss': [0.09500001196045044]}
Saved model to disk



11

Epoch 1/1
 - 764s - loss: 0.0763 - acc: 0.9721

Test accuracy: 92.86054259876249

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1072

choose_one :  1029

F1score :  0.9278846153846153

AUC : 0.9775841602102306

Confusion Matrix
[[986  64]
 [ 86 965]]
True label 0
0.939047619047619  
0.06095238095238095  
True label 1
0.0818268315889629  
0.9181731684110371  

Train_result {'acc': [0.972095763483477], 'loss': [0.07634745005010013]}
Saved model to disk



12

Epoch 1/1
 - 765s - loss: 0.0662 - acc: 0.9779

Test accuracy: 91.86101856258925

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1065

choose_one :  1036

F1score :  0.9180642069956877

AUC : 0.9762946853336959

Confusion Matrix
[[972  78]
 [ 93 958]]
True label 0
0.9257142857142857  
0.07428571428571429  
True label 1
0.08848715509039011  
0.9115128449096099  

Train_result {'acc': [0.977880134968668], 'loss': [0.0662395839236748]}
Saved model to disk



13

Epoch 1/1
 - 765s - loss: 0.0598 - acc: 0.9788

Test accuracy: 92.14659685863874

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1085

choose_one :  1016

F1score :  0.9201741654571844

AUC : 0.9790702732091886

Confusion Matrix
[[985  65]
 [100 951]]
True label 0
0.9380952380952381  
0.06190476190476191  
True label 1
0.09514747859181731  
0.9048525214081827  

Train_result {'acc': [0.9788441968828665], 'loss': [0.05981660083417478]}
Saved model to disk



14

Epoch 1/1
 - 764s - loss: 0.0482 - acc: 0.9839

Test accuracy: 92.47977153736316

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1064

choose_one :  1037

F1score :  0.9243295019157087

AUC : 0.9797562412215124

Confusion Matrix
[[978  72]
 [ 86 965]]
True label 0
0.9314285714285714  
0.06857142857142857  
True label 1
0.0818268315889629  
0.9181731684110371  

Train_result {'acc': [0.9839323014300252], 'loss': [0.04815196417285733]}
Saved model to disk



15

Epoch 1/1
 - 764s - loss: 0.0475 - acc: 0.9855

Test accuracy: 91.90861494526416

data size :  20772

zero :  10385

one :  10387

train_zero :  9335

train_one :  9336

test_zero :  1050

test_one :  1051

choose_zero :  1080

choose_one :  1021

F1score :  0.9179536679536681

AUC : 0.9742825427030946

Confusion Matrix
[[980  70]
 [100 951]]
True label 0
0.9333333333333333  
0.06666666666666667  
True label 1
0.09514747859181731  
0.9048525214081827  

Train_result {'acc': [0.9854855122949818], 'loss': [0.04746611578969666]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 03:49:33.718668: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 03:49:33.724152: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-21 03:49:33.725702: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x57783a0 executing computations on platform Host. Devices:
2019-07-21 03:49:33.725719: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25899

one : 
13572
glassfish-CAST_s
all data

Sentence length Average : 53

Under 10 : 10931
Over 10, Under 200 : 26175
Over 200, Under 400 : 1822
Over 400 : 543

glassfish-CAST_s
updated_train_data

Sentence length Average : 65

Under 10 : 0
Over 10, Under 200 : 22918
Over 200, Under 400 : 1955
Over 400 : 0


Test_zero:  1655
Train_zero:  14938
zero:  16593
Test_one:  1122
Train_one:  9935
one:  11057

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 460s - loss: 0.5019 - acc: 0.7518

Test accuracy: 82.85077951002228

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1212

choose_one :  1033

F1score :  0.8213457076566125

AUC : 0.9172884891024329

Confusion Matrix
[[975 148]
 [237 885]]
True label 0
0.8682101513802315  
0.13178984861976847  
True label 1
0.21122994652406418  
0.7887700534759359  

Train_result {'loss': [0.5018527327552247], 'acc': [0.751849428782867]}
Saved model to disk



2

Epoch 1/1
 - 449s - loss: 0.3724 - acc: 0.8298

Test accuracy: 85.56792873051225

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1161

choose_one :  1084

F1score :  0.8531278331822303

AUC : 0.9378685498323023

Confusion Matrix
[[980 143]
 [181 941]]
True label 0
0.8726625111308994  
0.12733748886910062  
True label 1
0.16131907308377896  
0.838680926916221  

Train_result {'loss': [0.37237302507453596], 'acc': [0.8298022243530375]}
Saved model to disk



3

Epoch 1/1
 - 448s - loss: 0.3157 - acc: 0.8578

Test accuracy: 85.30066815144765

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  951

choose_one :  1294

F1score :  0.86341059602649

AUC : 0.9493645268355865

Confusion Matrix
[[ 872  251]
 [  79 1043]]
True label 0
0.7764915405164737  
0.22350845948352627  
True label 1
0.07040998217468805  
0.9295900178253119  

Train_result {'loss': [0.31570701281450625], 'acc': [0.8577826983627163]}
Saved model to disk



4

Epoch 1/1
 - 449s - loss: 0.2754 - acc: 0.8782

Test accuracy: 88.06236080178174

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1127

choose_one :  1118

F1score :  0.8803571428571428

AUC : 0.9527010188840371

Confusion Matrix
[[991 132]
 [136 986]]
True label 0
0.8824577025823687  
0.11754229741763135  
True label 1
0.12121212121212122  
0.8787878787878788  

Train_result {'loss': [0.275374694530092], 'acc': [0.8782144833730527]}
Saved model to disk



5

Epoch 1/1
 - 451s - loss: 0.2396 - acc: 0.8972

Test accuracy: 86.8596881959911

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  954

choose_one :  1291

F1score :  0.8777455449647742

AUC : 0.9572986160383363

Confusion Matrix
[[ 891  232]
 [  63 1059]]
True label 0
0.7934105075690115  
0.20658949243098843  
True label 1
0.05614973262032086  
0.9438502673796791  

Train_result {'loss': [0.23955957819276735], 'acc': [0.8971868552191438]}
Saved model to disk



6

Epoch 1/1
 - 486s - loss: 0.2098 - acc: 0.9101

Test accuracy: 88.15144766146993

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1075

choose_one :  1170

F1score :  0.8839441535776615

AUC : 0.9561454469264432

Confusion Matrix
[[ 966  157]
 [ 109 1013]]
True label 0
0.8601959038290294  
0.13980409617097062  
True label 1
0.09714795008912656  
0.9028520499108734  

Train_result {'loss': [0.20984266318013758], 'acc': [0.91006995114315]}
Saved model to disk



7

Epoch 1/1
 - 486s - loss: 0.1847 - acc: 0.9235

Test accuracy: 89.22048997772829

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1125

choose_one :  1120

F1score :  0.8920606601248885

AUC : 0.9618843084874199

Confusion Matrix
[[1003  120]
 [ 122 1000]]
True label 0
0.8931433659839715  
0.10685663401602849  
True label 1
0.10873440285204991  
0.8912655971479501  

Train_result {'loss': [0.18465135263725363], 'acc': [0.9235066176870618]}
Saved model to disk



8

Epoch 1/1
 - 486s - loss: 0.1566 - acc: 0.9361

Test accuracy: 88.24053452115812

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1041

choose_one :  1204

F1score :  0.8865004299226139

AUC : 0.9596529699064926

Confusion Matrix
[[ 950  173]
 [  91 1031]]
True label 0
0.8459483526268923  
0.15405164737310775  
True label 1
0.08110516934046345  
0.9188948306595366  

Train_result {'loss': [0.15662008736011312], 'acc': [0.9361380906429236]}
Saved model to disk



9

Epoch 1/1
 - 485s - loss: 0.1371 - acc: 0.9451

Test accuracy: 89.75501113585747

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1123

choose_one :  1122

F1score :  0.8975044563279857

AUC : 0.9607362980811203

Confusion Matrix
[[1008  115]
 [ 115 1007]]
True label 0
0.8975957257346393  
0.10240427426536064  
True label 1
0.10249554367201426  
0.8975044563279857  

Train_result {'loss': [0.13706825569082318], 'acc': [0.9450958683538626]}
Saved model to disk



10

Epoch 1/1
 - 483s - loss: 0.1188 - acc: 0.9546

Test accuracy: 89.84409799554565

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1091

choose_one :  1154

F1score :  0.899824253075571

AUC : 0.9630239856000684

Confusion Matrix
[[ 993  130]
 [  98 1024]]
True label 0
0.8842386464826358  
0.1157613535173642  
True label 1
0.0873440285204991  
0.9126559714795008  

Train_result {'loss': [0.11880135595829239], 'acc': [0.9546072165017327]}
Saved model to disk



11

Epoch 1/1
 - 484s - loss: 0.1007 - acc: 0.9621

Test accuracy: 89.62138084632517

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1118

choose_one :  1127

F1score :  0.8963983992885728

AUC : 0.9614942309798525

Confusion Matrix
[[1004  119]
 [ 114 1008]]
True label 0
0.8940338379341051  
0.10596616206589493  
True label 1
0.10160427807486631  
0.8983957219251337  

Train_result {'loss': [0.10069809972626485], 'acc': [0.9620552564098037]}
Saved model to disk



12

Epoch 1/1
 - 484s - loss: 0.0873 - acc: 0.9674

Test accuracy: 89.22048997772829

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1217

choose_one :  1028

F1score :  0.8874418604651162

AUC : 0.9616847062633035

Confusion Matrix
[[1049   74]
 [ 168  954]]
True label 0
0.9341050756901158  
0.06589492430988424  
True label 1
0.1497326203208556  
0.8502673796791443  

Train_result {'loss': [0.08727036250185177], 'acc': [0.9674399879250971]}
Saved model to disk



13

Epoch 1/1
 - 487s - loss: 0.0779 - acc: 0.9716

Test accuracy: 88.99777282850779

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1110

choose_one :  1135

F1score :  0.8905626938413824

AUC : 0.9604398709212495

Confusion Matrix
[[ 993  130]
 [ 117 1005]]
True label 0
0.8842386464826358  
0.1157613535173642  
True label 1
0.10427807486631016  
0.8957219251336899  

Train_result {'loss': [0.07794148868471865], 'acc': [0.9716169291513026]}
Saved model to disk



14

Epoch 1/1
 - 483s - loss: 0.0701 - acc: 0.9748

Test accuracy: 90.51224944320712

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1080

choose_one :  1165

F1score :  0.9068648885002186

AUC : 0.962012085656735

Confusion Matrix
[[ 995  128]
 [  85 1037]]
True label 0
0.8860195903829029  
0.11398040961709706  
True label 1
0.07575757575757576  
0.9242424242424242  

Train_result {'loss': [0.07008018532170694], 'acc': [0.9747873785919179]}
Saved model to disk



15

Epoch 1/1
 - 486s - loss: 0.0655 - acc: 0.9762

Test accuracy: 89.30957683741649

data size :  22116

zero :  11059

one :  11057

train_zero :  9936

train_one :  9935

test_zero :  1123

test_one :  1122

choose_zero :  1233

choose_one :  1012

F1score :  0.887535145267104

AUC : 0.9589664652390545

Confusion Matrix
[[1058   65]
 [ 175  947]]
True label 0
0.9421193232413179  
0.0578806767586821  
True label 1
0.15597147950089127  
0.8440285204991087  

Train_result {'loss': [0.06549737399813213], 'acc': [0.9762467917681616]}
Saved model to disk




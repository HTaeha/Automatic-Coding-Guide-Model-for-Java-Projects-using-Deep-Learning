Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 10:13:28.361471: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 10:13:28.373257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-22 10:13:28.375321: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x788d940 executing computations on platform Host. Devices:
2019-07-22 10:13:28.375361: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
26276
one : 
22977

Second data
zero : 
26276
one : 
22977

hbase-AST

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23374
Over 200, Under 400 : 1531
Over 400 : 0


hbase-code

Sentence length Average : 88

Under 10 : 0
Over 10, Under 200 : 22168
Over 200, Under 400 : 2737
Over 400 : 0


Test_zero:  1080
Train_zero:  9306
zero:  10386
Test_one:  1712
Train_one:  15599
one:  17311
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 754s - loss: 0.4231 - acc: 0.8040

Test accuracy: 86.11753817677001

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1272

choose_one :  889

F1score :  0.8477157360406091

AUC : 0.9460590331311886

Confusion Matrix
[[1026   54]
 [ 246  835]]
True label 0
0.95  
0.05  
True label 1
0.22756706753006475  
0.7724329324699353  

Train_result {'loss': [0.4231075038791683], 'acc': [0.8040079514381996]}
Saved model to disk



2

Epoch 1/1
 - 753s - loss: 0.3126 - acc: 0.8606

Test accuracy: 87.6446089773253

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1251

choose_one :  910

F1score :  0.8658965344048216

AUC : 0.9582605269469284

Confusion Matrix
[[1032   48]
 [ 219  862]]
True label 0
0.9555555555555556  
0.044444444444444446  
True label 1
0.20259019426456984  
0.7974098057354302  

Train_result {'loss': [0.3125837984256343], 'acc': [0.8605813141448887]}
Saved model to disk



3

Epoch 1/1
 - 757s - loss: 0.2686 - acc: 0.8827

Test accuracy: 85.19204072188802

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  850

choose_one :  1311

F1score :  0.8662207357859532

AUC : 0.9638657621543839

Confusion Matrix
[[ 805  275]
 [  45 1036]]
True label 0
0.7453703703703703  
0.25462962962962965  
True label 1
0.041628122109158186  
0.9583718778908418  

Train_result {'loss': [0.2685878371453289], 'acc': [0.8827163810336224]}
Saved model to disk



4

Epoch 1/1
 - 764s - loss: 0.2326 - acc: 0.9015

Test accuracy: 91.2540490513651

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1127

choose_one :  1034

F1score :  0.9106382978723404

AUC : 0.972238496590948

Confusion Matrix
[[1009   71]
 [ 118  963]]
True label 0
0.9342592592592592  
0.06574074074074074  
True label 1
0.1091581868640148  
0.8908418131359852  

Train_result {'loss': [0.23258275112655272], 'acc': [0.9015204427077425]}
Saved model to disk



5

Epoch 1/1
 - 763s - loss: 0.2013 - acc: 0.9175

Test accuracy: 90.37482646922722

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1024

choose_one :  1137

F1score :  0.9062218214607756

AUC : 0.9745653030458765

Confusion Matrix
[[ 948  132]
 [  76 1005]]
True label 0
0.8777777777777778  
0.12222222222222222  
True label 1
0.07030527289546716  
0.9296947271045328  

Train_result {'loss': [0.20127976956958255], 'acc': [0.9174770321946176]}
Saved model to disk



6

Epoch 1/1
 - 764s - loss: 0.1775 - acc: 0.9289

Test accuracy: 91.06894956038872

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1041

choose_one :  1120

F1score :  0.9123125851885507

AUC : 0.9746445335251995

Confusion Matrix
[[ 964  116]
 [  77 1004]]
True label 0
0.8925925925925926  
0.10740740740740741  
True label 1
0.07123034227567067  
0.9287696577243293  

Train_result {'loss': [0.17753138735210697], 'acc': [0.9288669209724174]}
Saved model to disk



7

Epoch 1/1
 - 766s - loss: 0.1505 - acc: 0.9385

Test accuracy: 91.99444701527071

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1161

choose_one :  1000

F1score :  0.9168668909178279

AUC : 0.9753648884777469

Confusion Matrix
[[1034   46]
 [ 127  954]]
True label 0
0.9574074074074074  
0.04259259259259259  
True label 1
0.11748381128584644  
0.8825161887141536  

Train_result {'loss': [0.15053528837656685], 'acc': [0.9384838553731051]}
Saved model to disk



8

Epoch 1/1
 - 764s - loss: 0.1365 - acc: 0.9479

Test accuracy: 92.3646459972235

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1109

choose_one :  1052

F1score :  0.9226441631504921

AUC : 0.9777692123205537

Confusion Matrix
[[1012   68]
 [  97  984]]
True label 0
0.937037037037037  
0.06296296296296296  
True label 1
0.08973172987974098  
0.910268270120259  

Train_result {'loss': [0.13652316278128598], 'acc': [0.9478858862149685]}
Saved model to disk



9

Epoch 1/1
 - 763s - loss: 0.1142 - acc: 0.9580

Test accuracy: 91.80934752429431

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1143

choose_one :  1018

F1score :  0.9156741305383514

AUC : 0.977632165004968

Confusion Matrix
[[1023   57]
 [ 120  961]]
True label 0
0.9472222222222222  
0.05277777777777778  
True label 1
0.11100832562442182  
0.8889916743755781  

Train_result {'loss': [0.11422693420617641], 'acc': [0.9579863536302159]}
Saved model to disk



10

Epoch 1/1
 - 772s - loss: 0.0961 - acc: 0.9651

Test accuracy: 92.41092086996761

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1120

choose_one :  1041

F1score :  0.9227144203581528

AUC : 0.9754094288553123

Confusion Matrix
[[1018   62]
 [ 102  979]]
True label 0
0.9425925925925925  
0.05740740740740741  
True label 1
0.09435707678075855  
0.9056429232192414  

Train_result {'loss': [0.09605375265129491], 'acc': [0.9651318970611938]}
Saved model to disk



11

Epoch 1/1
 - 782s - loss: 0.0856 - acc: 0.9699

Test accuracy: 92.50347061545581

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1166

choose_one :  995

F1score :  0.9219653179190751

AUC : 0.9773525028266008

Confusion Matrix
[[1042   38]
 [ 124  957]]
True label 0
0.9648148148148148  
0.03518518518518519  
True label 1
0.1147086031452359  
0.8852913968547641  

Train_result {'loss': [0.08563251807149493], 'acc': [0.9699135013194866]}
Saved model to disk



12

Epoch 1/1
 - 781s - loss: 0.0727 - acc: 0.9744

Test accuracy: 91.67052290606202

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1080

choose_one :  1081

F1score :  0.9167437557816837

AUC : 0.9753995785795045

Confusion Matrix
[[990  90]
 [ 90 991]]
True label 0
0.9166666666666666  
0.08333333333333333  
True label 1
0.08325624421831637  
0.9167437557816837  

Train_result {'loss': [0.07266941618738522], 'acc': [0.974426476122044]}
Saved model to disk



13

Epoch 1/1
 - 781s - loss: 0.0652 - acc: 0.9770

Test accuracy: 92.08699676075891

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1079

choose_one :  1082

F1score :  0.9209431345353676

AUC : 0.9771238051187172

Confusion Matrix
[[994  86]
 [ 85 996]]
True label 0
0.9203703703703704  
0.07962962962962963  
True label 1
0.0786308973172988  
0.9213691026827012  

Train_result {'loss': [0.06517165677258899], 'acc': [0.9770053188663624]}
Saved model to disk



14

Epoch 1/1
 - 780s - loss: 0.0539 - acc: 0.9817

Test accuracy: 91.99444701527071

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1145

choose_one :  1016

F1score :  0.9175011921793037

AUC : 0.976551632576147

Confusion Matrix
[[1026   54]
 [ 119  962]]
True label 0
0.95  
0.05  
True label 1
0.11008325624421832  
0.8899167437557817  

Train_result {'loss': [0.053939566018713477], 'acc': [0.9817331972277441]}
Saved model to disk



15

Epoch 1/1
 - 783s - loss: 0.0497 - acc: 0.9831

Test accuracy: 92.1795465062471

data size :  20774

zero :  10386

one :  10388

train_zero :  9306

train_one :  9307

test_zero :  1080

test_one :  1081

choose_zero :  1113

choose_one :  1048

F1score :  0.9206200093940817

AUC : 0.9751974337890159

Confusion Matrix
[[1012   68]
 [ 101  980]]
True label 0
0.937037037037037  
0.06296296296296296  
True label 1
0.09343200740055504  
0.906567992599445  

Train_result {'loss': [0.049735529946354884], 'acc': [0.9831300703809166]}
Saved model to disk




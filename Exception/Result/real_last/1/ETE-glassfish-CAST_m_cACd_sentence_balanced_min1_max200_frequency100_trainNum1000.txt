Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:139: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 20:01:54.990263: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 20:01:55.001591: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 20:01:55.003995: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xd9fa250 executing computations on platform Host. Devices:
2019-10-14 20:01:55.004036: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10792
one :  10820

Second data
zero :  10792
one :  10820

Third data
zero :  10792
one :  10820

4th data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

180
glassfish-AST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-AST

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 821
Over 150, Under 200 : 164
Over 200, Under 400 : 4
Over 400 : 0

253
glassfish-CAST
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-CAST

Sentence length Average : 50

Under 10 : 4320
Over 10, Under 30 : 6874
Over 30, Under 100 : 7059
Over 100, Under 150 : 1787
Over 150, Under 200 : 894
Over 200, Under 400 : 678
Over 400 : 0

344
glassfish-depth_num
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324
After balance out data.
glassfish-depth_num

Sentence length Average : 27

Under 10 : 9172
Over 10, Under 30 : 5625
Over 30, Under 100 : 5826
Over 100, Under 150 : 822
Over 150, Under 200 : 163
Over 200, Under 400 : 4
Over 400 : 0

253
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 180, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 180, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 253, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 344, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 344, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 253, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 253, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          196992      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            514         dense_3[0][0]                    
==================================================================================================
Total params: 1,068,674
Trainable params: 1,068,674
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:49 - loss: 0.7132 - acc: 0.5312
 128/1000 [==>...........................] - ETA: 55s - loss: 0.7608 - acc: 0.5000 
 192/1000 [====>.........................] - ETA: 37s - loss: 0.7397 - acc: 0.5104
 256/1000 [======>.......................] - ETA: 27s - loss: 0.7235 - acc: 0.5312
 320/1000 [========>.....................] - ETA: 21s - loss: 0.7201 - acc: 0.5250
 384/1000 [==========>...................] - ETA: 16s - loss: 0.7220 - acc: 0.5130
 448/1000 [============>.................] - ETA: 13s - loss: 0.7146 - acc: 0.5201
 512/1000 [==============>...............] - ETA: 11s - loss: 0.7130 - acc: 0.5273
 576/1000 [================>.............] - ETA: 9s - loss: 0.7138 - acc: 0.5243 
 640/1000 [==================>...........] - ETA: 7s - loss: 0.7119 - acc: 0.5219
 704/1000 [====================>.........] - ETA: 5s - loss: 0.7116 - acc: 0.5227
 768/1000 [======================>.......] - ETA: 4s - loss: 0.7052 - acc: 0.5326
 832/1000 [=======================>......] - ETA: 2s - loss: 0.7039 - acc: 0.5349
 896/1000 [=========================>....] - ETA: 1s - loss: 0.7030 - acc: 0.5312
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7017 - acc: 0.5375
1000/1000 [==============================] - 16s 16ms/step - loss: 0.7023 - acc: 0.5370

Test accuracy: 66.02464583737628

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10849

choose_one :  9763

F1score :  0.6513665554836462

AUC :  0.7287397176730539

Confusion Matrix
[[7067 3221]
 [3782 6542]]
True label 0
0.6869167962674961  
0.31308320373250387  
True label 1
0.3663308795040682  
0.6336691204959318  

Train_result {'acc': [0.5369999990463257], 'loss': [0.7023492398262023]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.6461 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 8s - loss: 0.6439 - acc: 0.6172
 192/1000 [====>.........................] - ETA: 7s - loss: 0.6549 - acc: 0.5938
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6682 - acc: 0.5742
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6641 - acc: 0.5875
 384/1000 [==========>...................] - ETA: 5s - loss: 0.6664 - acc: 0.5911
 448/1000 [============>.................] - ETA: 5s - loss: 0.6849 - acc: 0.5625
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6760 - acc: 0.5684
 576/1000 [================>.............] - ETA: 4s - loss: 0.6702 - acc: 0.5764
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6708 - acc: 0.5703
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6673 - acc: 0.5767
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6679 - acc: 0.5781
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6695 - acc: 0.5793
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6674 - acc: 0.5826
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6657 - acc: 0.5875
1000/1000 [==============================] - 9s 9ms/step - loss: 0.6697 - acc: 0.5850

Test accuracy: 61.464195614205316

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  4413

choose_one :  16199

F1score :  0.7005240734456887

AUC :  0.743423950474306

Confusion Matrix
[[3379 6909]
 [1034 9290]]
True label 0
0.32844090202177295  
0.6715590979782271  
True label 1
0.10015497869043007  
0.8998450213095699  

Train_result {'acc': [0.5849999990463257], 'loss': [0.6696942944526673]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.6710 - acc: 0.5156
 128/1000 [==>...........................] - ETA: 8s - loss: 0.6423 - acc: 0.6250 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.6504 - acc: 0.6094
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6407 - acc: 0.6133
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6190 - acc: 0.6469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.6443 - acc: 0.6224
 448/1000 [============>.................] - ETA: 5s - loss: 0.6309 - acc: 0.6451
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6192 - acc: 0.6582
 576/1000 [================>.............] - ETA: 4s - loss: 0.6120 - acc: 0.6684
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6158 - acc: 0.6625
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6214 - acc: 0.6562
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6154 - acc: 0.6667
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6154 - acc: 0.6659
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6129 - acc: 0.6663
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6141 - acc: 0.6635
1000/1000 [==============================] - 10s 10ms/step - loss: 0.6111 - acc: 0.6670

Test accuracy: 67.51892101688337

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  15141

choose_one :  5471

F1score :  0.5761316872427983

AUC :  0.7750584926680377

Confusion Matrix
[[9367  921]
 [5774 4550]]
True label 0
0.9104782270606532  
0.08952177293934681  
True label 1
0.5592793490895002  
0.44072065091049983  

Train_result {'acc': [0.667], 'loss': [0.6110820612907409]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5939 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 8s - loss: 0.6296 - acc: 0.6406
 192/1000 [====>.........................] - ETA: 7s - loss: 0.6245 - acc: 0.6823
 256/1000 [======>.......................] - ETA: 7s - loss: 0.6007 - acc: 0.6914
 320/1000 [========>.....................] - ETA: 6s - loss: 0.6101 - acc: 0.6813
 384/1000 [==========>...................] - ETA: 5s - loss: 0.6069 - acc: 0.6771
 448/1000 [============>.................] - ETA: 5s - loss: 0.6081 - acc: 0.6696
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5857 - acc: 0.6934
 576/1000 [================>.............] - ETA: 4s - loss: 0.5873 - acc: 0.6944
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5765 - acc: 0.7031
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5706 - acc: 0.7116
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5652 - acc: 0.7188
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5652 - acc: 0.7151
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5577 - acc: 0.7176
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5527 - acc: 0.7188
1000/1000 [==============================] - 10s 10ms/step - loss: 0.5501 - acc: 0.7210

Test accuracy: 66.84455656898893

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  5980

choose_one :  14632

F1score :  0.726158038147139

AUC :  0.7870683525997194

Confusion Matrix
[[4717 5571]
 [1263 9061]]
True label 0
0.45849533437013995  
0.54150466562986  
True label 1
0.12233630375823325  
0.8776636962417668  

Train_result {'acc': [0.7209999990463257], 'loss': [0.5500626451969147]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5135 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 8s - loss: 0.5555 - acc: 0.7266
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5367 - acc: 0.7500
 256/1000 [======>.......................] - ETA: 7s - loss: 0.5040 - acc: 0.7656
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4667 - acc: 0.7906
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4843 - acc: 0.7786
 448/1000 [============>.................] - ETA: 5s - loss: 0.4983 - acc: 0.7656
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4997 - acc: 0.7598
 576/1000 [================>.............] - ETA: 4s - loss: 0.5169 - acc: 0.7517
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5076 - acc: 0.7578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5186 - acc: 0.7500
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5193 - acc: 0.7487
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5138 - acc: 0.7500
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5110 - acc: 0.7522
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5162 - acc: 0.7510
1000/1000 [==============================] - 10s 10ms/step - loss: 0.5142 - acc: 0.7540

Test accuracy: 73.69008344653601

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11829

choose_one :  8783

F1score :  0.7161773172135865

AUC :  0.8177457172223385

Confusion Matrix
[[8347 1941]
 [3482 6842]]
True label 0
0.8113335925349923  
0.18866640746500776  
True label 1
0.33727237504843083  
0.6627276249515691  

Train_result {'acc': [0.7539999995231629], 'loss': [0.5142209877967835]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4967 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4774 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4650 - acc: 0.7812
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4667 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4710 - acc: 0.7937
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4806 - acc: 0.7891
 448/1000 [============>.................] - ETA: 5s - loss: 0.4884 - acc: 0.7790
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4855 - acc: 0.7793
 576/1000 [================>.............] - ETA: 3s - loss: 0.4665 - acc: 0.7951
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4719 - acc: 0.7922
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4849 - acc: 0.7798
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4891 - acc: 0.7773
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4823 - acc: 0.7812
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4819 - acc: 0.7801
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4914 - acc: 0.7760
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4960 - acc: 0.7760

Test accuracy: 75.28138948185523

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10821

choose_one :  9791

F1score :  0.7467064379816057

AUC :  0.8338810157807715

Confusion Matrix
[[8007 2281]
 [2814 7510]]
True label 0
0.7782853810264385  
0.22171461897356143  
True label 1
0.27256877179387834  
0.7274312282061216  

Train_result {'acc': [0.7759999990463257], 'loss': [0.4959642734527588]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4690 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4134 - acc: 0.8359 
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3981 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4613 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4634 - acc: 0.7906
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4534 - acc: 0.7969
 448/1000 [============>.................] - ETA: 5s - loss: 0.4532 - acc: 0.8013
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4531 - acc: 0.8008
 576/1000 [================>.............] - ETA: 4s - loss: 0.4533 - acc: 0.7986
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4603 - acc: 0.7937
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4680 - acc: 0.7855
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4646 - acc: 0.7852
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4589 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4569 - acc: 0.7913
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4584 - acc: 0.7885
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4638 - acc: 0.7860

Test accuracy: 74.51969726372987

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9466

choose_one :  11146

F1score :  0.7553795994410806

AUC :  0.8356429606488498

Confusion Matrix
[[7251 3037]
 [2215 8109]]
True label 0
0.7048017107309487  
0.29519828926905134  
True label 1
0.21454862456412244  
0.7854513754358776  

Train_result {'acc': [0.7860000009536743], 'loss': [0.46378143215179446]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4603 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4593 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4413 - acc: 0.8125
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4254 - acc: 0.8008
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3919 - acc: 0.8250
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4136 - acc: 0.8125
 448/1000 [============>.................] - ETA: 5s - loss: 0.4271 - acc: 0.8036
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4277 - acc: 0.8066
 576/1000 [================>.............] - ETA: 4s - loss: 0.4184 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4166 - acc: 0.8094
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4077 - acc: 0.8139
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4095 - acc: 0.8138
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4067 - acc: 0.8137
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4152 - acc: 0.8136
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4205 - acc: 0.8125
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4162 - acc: 0.8170

Test accuracy: 75.55792742091985

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12340

choose_one :  8272

F1score :  0.7290815229081523

AUC :  0.8444614456613497

Confusion Matrix
[[8795 1493]
 [3545 6779]]
True label 0
0.8548794712286159  
0.14512052877138415  
True label 1
0.3433746609841147  
0.6566253390158853  

Train_result {'acc': [0.8170000004768372], 'loss': [0.4161524739265442]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3918 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3492 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3550 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3518 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3497 - acc: 0.8500
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3714 - acc: 0.8359
 448/1000 [============>.................] - ETA: 5s - loss: 0.3797 - acc: 0.8259
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3743 - acc: 0.8301
 576/1000 [================>.............] - ETA: 4s - loss: 0.3696 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3694 - acc: 0.8344
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3605 - acc: 0.8409
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3636 - acc: 0.8424
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3586 - acc: 0.8474
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3575 - acc: 0.8471
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3695 - acc: 0.8427
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3693 - acc: 0.8420

Test accuracy: 75.12128856976518

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  8396

choose_one :  12216

F1score :  0.7724933451641527

AUC :  0.8538131312579726

Confusion Matrix
[[6778 3510]
 [1618 8706]]
True label 0
0.6588258164852255  
0.3411741835147745  
True label 1
0.1567222006974041  
0.8432777993025959  

Train_result {'acc': [0.8419999995231628], 'loss': [0.3692820980548859]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.5210 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3595 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3287 - acc: 0.8542
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3199 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3554 - acc: 0.8438
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3408 - acc: 0.8516
 448/1000 [============>.................] - ETA: 5s - loss: 0.3325 - acc: 0.8549
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3301 - acc: 0.8535
 576/1000 [================>.............] - ETA: 3s - loss: 0.3351 - acc: 0.8576
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3405 - acc: 0.8547
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3367 - acc: 0.8551
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3248 - acc: 0.8620
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3249 - acc: 0.8630
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3325 - acc: 0.8594
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3389 - acc: 0.8552
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3388 - acc: 0.8540

Test accuracy: 76.56704832136619

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  13012

choose_one :  7600

F1score :  0.730528899799152

AUC :  0.8529510688829665

Confusion Matrix
[[9235 1053]
 [3777 6547]]
True label 0
0.8976477449455676  
0.10235225505443235  
True label 1
0.3658465710964742  
0.6341534289035258  

Train_result {'acc': [0.8539999995231629], 'loss': [0.3387865169048309]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2773 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2917 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2976 - acc: 0.8646
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2923 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3134 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3148 - acc: 0.8646
 448/1000 [============>.................] - ETA: 5s - loss: 0.3093 - acc: 0.8728
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3158 - acc: 0.8633
 576/1000 [================>.............] - ETA: 3s - loss: 0.3155 - acc: 0.8646
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3101 - acc: 0.8672
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3217 - acc: 0.8594
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3351 - acc: 0.8555
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3324 - acc: 0.8546
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3401 - acc: 0.8504
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3364 - acc: 0.8542
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3397 - acc: 0.8520

Test accuracy: 75.38812342324859

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  8539

choose_one :  12073

F1score :  0.7734964504174666

AUC :  0.8587728532559082

Confusion Matrix
[[6877 3411]
 [1662 8662]]
True label 0
0.6684486780715396  
0.3315513219284603  
True label 1
0.1609841146842309  
0.8390158853157691  

Train_result {'acc': [0.8520000004768371], 'loss': [0.33973199796676634]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3300 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3022 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2885 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2846 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2789 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2859 - acc: 0.8802
 448/1000 [============>.................] - ETA: 5s - loss: 0.2885 - acc: 0.8795
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2901 - acc: 0.8789
 576/1000 [================>.............] - ETA: 3s - loss: 0.3115 - acc: 0.8715
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3109 - acc: 0.8719
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3180 - acc: 0.8651
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3182 - acc: 0.8633
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3129 - acc: 0.8690
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3068 - acc: 0.8717
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3086 - acc: 0.8688
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3007 - acc: 0.8740

Test accuracy: 76.40209586648554

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12580

choose_one :  8032

F1score :  0.7350185225539333

AUC :  0.8518150295510981

Confusion Matrix
[[9002 1286]
 [3578 6746]]
True label 0
0.875  
0.125  
True label 1
0.3465710964742348  
0.6534289035257652  

Train_result {'acc': [0.874], 'loss': [0.30074542862176895]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4101 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3130 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2928 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2927 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2983 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3038 - acc: 0.8698
 448/1000 [============>.................] - ETA: 5s - loss: 0.2872 - acc: 0.8839
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2915 - acc: 0.8848
 576/1000 [================>.............] - ETA: 3s - loss: 0.2866 - acc: 0.8889
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2869 - acc: 0.8859
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2852 - acc: 0.8849
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2824 - acc: 0.8841
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2787 - acc: 0.8846
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2768 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2787 - acc: 0.8833
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2757 - acc: 0.8860

Test accuracy: 77.89151950320202

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  11679

choose_one :  8933

F1score :  0.7633587786259541

AUC :  0.8576210014051723

Confusion Matrix
[[8705 1583]
 [2974 7350]]
True label 0
0.8461314152410575  
0.15386858475894247  
True label 1
0.28806664083688494  
0.7119333591631151  

Train_result {'acc': [0.8859999995231629], 'loss': [0.27565918338298795]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2627 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2242 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2017 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2094 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2203 - acc: 0.8938
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2213 - acc: 0.8958
 448/1000 [============>.................] - ETA: 5s - loss: 0.2424 - acc: 0.8817
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2494 - acc: 0.8828
 576/1000 [================>.............] - ETA: 4s - loss: 0.2556 - acc: 0.8854
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2450 - acc: 0.8922
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2490 - acc: 0.8892
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2442 - acc: 0.8932
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2582 - acc: 0.8870
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2629 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2660 - acc: 0.8833
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2631 - acc: 0.8870

Test accuracy: 77.91092567436445

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10707

choose_one :  9905

F1score :  0.7749270848781452

AUC :  0.861278396063951

Confusion Matrix
[[8221 2067]
 [2486 7838]]
True label 0
0.7990863141524106  
0.20091368584758942  
True label 1
0.24079814025571483  
0.7592018597442851  

Train_result {'acc': [0.8870000009536743], 'loss': [0.26306246304512027]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.2924 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.2867 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2656 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2611 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2540 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2476 - acc: 0.8802
 448/1000 [============>.................] - ETA: 5s - loss: 0.2303 - acc: 0.8906
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2433 - acc: 0.8867
 576/1000 [================>.............] - ETA: 4s - loss: 0.2490 - acc: 0.8819
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2576 - acc: 0.8797
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2544 - acc: 0.8821
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2489 - acc: 0.8828
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2482 - acc: 0.8834
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2410 - acc: 0.8873
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2468 - acc: 0.8854
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2482 - acc: 0.8840

Test accuracy: 76.65922763438773

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9187

choose_one :  11425

F1score :  0.7787944273299923

AUC :  0.8571771399050243

Confusion Matrix
[[7332 2956]
 [1855 8469]]
True label 0
0.7126749611197511  
0.28732503888024885  
True label 1
0.1796784192173576  
0.8203215807826424  

Train_result {'acc': [0.8840000009536744], 'loss': [0.24823355913162232]}
Saved model to disk


[[66.02464583737628, 1], [61.464195614205316, 2], [67.51892101688337, 3], [66.84455656898893, 4], [73.69008344653601, 5], [75.28138948185523, 6], [74.51969726372987, 7], [75.55792742091985, 8], [75.12128856976518, 9], [76.56704832136619, 10], [75.38812342324859, 11], [76.40209586648554, 12], [77.89151950320202, 13], [77.91092567436445, 14], [76.65922763438773, 15]]
max accuracy :  [77.91092567436445, 14]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-10 13:23:00.661360: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-10 13:23:00.673080: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099865000 Hz
2019-10-10 13:23:00.675869: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x78e0170 executing computations on platform Host. Devices:
2019-10-10 13:23:00.675925: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

hbase-CAST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 58

Under 10 : 2623
Over 10, Under 30 : 6973
Over 30, Under 100 : 7189
Over 100, Under 150 : 1638
Over 150, Under 200 : 765
Over 200, Under 400 : 1052
Over 400 : 88

After balance out data.
hbase-CAST

Sentence length Average : 58

Under 10 : 2623
Over 10, Under 30 : 6973
Over 30, Under 100 : 7189
Over 100, Under 150 : 1638
Over 150, Under 200 : 765
Over 200, Under 400 : 1052
Over 400 : 88

679
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 679, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 679, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 39s - loss: 0.7784 - acc: 0.4844
 128/1000 [==>...........................] - ETA: 25s - loss: 0.8501 - acc: 0.4766
 192/1000 [====>.........................] - ETA: 20s - loss: 0.8649 - acc: 0.4896
 256/1000 [======>.......................] - ETA: 16s - loss: 0.8055 - acc: 0.5078
 320/1000 [========>.....................] - ETA: 14s - loss: 0.7710 - acc: 0.5344
 384/1000 [==========>...................] - ETA: 12s - loss: 0.7573 - acc: 0.5391
 448/1000 [============>.................] - ETA: 11s - loss: 0.7609 - acc: 0.5357
 512/1000 [==============>...............] - ETA: 9s - loss: 0.7413 - acc: 0.5508 
 576/1000 [================>.............] - ETA: 8s - loss: 0.7285 - acc: 0.5625
 640/1000 [==================>...........] - ETA: 6s - loss: 0.7328 - acc: 0.5516
 704/1000 [====================>.........] - ETA: 5s - loss: 0.7219 - acc: 0.5639
 768/1000 [======================>.......] - ETA: 4s - loss: 0.7180 - acc: 0.5664
 832/1000 [=======================>......] - ETA: 3s - loss: 0.7088 - acc: 0.5733
 896/1000 [=========================>....] - ETA: 1s - loss: 0.7066 - acc: 0.5792
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7053 - acc: 0.5833
1000/1000 [==============================] - 18s 18ms/step - loss: 0.6987 - acc: 0.5860

Test accuracy: 70.93853476821192

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8777

choose_one :  10551

F1score :  0.7236952137340744

AUC :  0.7714062983575696

Confusion Matrix
[[6355 3195]
 [2422 7356]]
True label 0
0.6654450261780105  
0.3345549738219895  
True label 1
0.24769891593372878  
0.7523010840662713  

Train_result {'loss': [0.6986679348945618], 'acc': [0.5859999990463257]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.6151 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 13s - loss: 0.5991 - acc: 0.6641
 192/1000 [====>.........................] - ETA: 12s - loss: 0.6200 - acc: 0.6667
 256/1000 [======>.......................] - ETA: 11s - loss: 0.6068 - acc: 0.6875
 320/1000 [========>.....................] - ETA: 10s - loss: 0.5884 - acc: 0.6969
 384/1000 [==========>...................] - ETA: 9s - loss: 0.5749 - acc: 0.6979 
 448/1000 [============>.................] - ETA: 8s - loss: 0.5704 - acc: 0.7031
 512/1000 [==============>...............] - ETA: 7s - loss: 0.5787 - acc: 0.6934
 576/1000 [================>.............] - ETA: 6s - loss: 0.5827 - acc: 0.6927
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5931 - acc: 0.6859
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5930 - acc: 0.6861
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5943 - acc: 0.6784
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5956 - acc: 0.6767
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5999 - acc: 0.6719
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5956 - acc: 0.6771
1000/1000 [==============================] - 15s 15ms/step - loss: 0.5899 - acc: 0.6820

Test accuracy: 72.00434602649007

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8843

choose_one :  10485

F1score :  0.7329615555445886

AUC :  0.7926198785820074

Confusion Matrix
[[6491 3059]
 [2352 7426]]
True label 0
0.6796858638743456  
0.32031413612565446  
True label 1
0.24053998772755164  
0.7594600122724483  

Train_result {'loss': [0.5898792912960052], 'acc': [0.6820000004768372]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.5291 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 13s - loss: 0.5532 - acc: 0.6719
 192/1000 [====>.........................] - ETA: 12s - loss: 0.5830 - acc: 0.6823
 256/1000 [======>.......................] - ETA: 11s - loss: 0.5784 - acc: 0.6797
 320/1000 [========>.....................] - ETA: 10s - loss: 0.5607 - acc: 0.7125
 384/1000 [==========>...................] - ETA: 9s - loss: 0.5573 - acc: 0.7161 
 448/1000 [============>.................] - ETA: 8s - loss: 0.5595 - acc: 0.7188
 512/1000 [==============>...............] - ETA: 7s - loss: 0.5557 - acc: 0.7148
 576/1000 [================>.............] - ETA: 6s - loss: 0.5599 - acc: 0.7135
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5602 - acc: 0.7094
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5567 - acc: 0.7173
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5638 - acc: 0.7109
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5651 - acc: 0.7103
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5653 - acc: 0.7132
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5619 - acc: 0.7177
1000/1000 [==============================] - 15s 15ms/step - loss: 0.5573 - acc: 0.7220

Test accuracy: 66.24586092715232

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  4648

choose_one :  14680

F1score :  0.7332570120206067

AUC :  0.7990897505780151

Confusion Matrix
[[3837 5713]
 [ 811 8967]]
True label 0
0.4017801047120419  
0.5982198952879582  
True label 1
0.08294129678870935  
0.9170587032112907  

Train_result {'loss': [0.5572681369781494], 'acc': [0.7219999995231628]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.6168 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 13s - loss: 0.5186 - acc: 0.7578
 192/1000 [====>.........................] - ETA: 12s - loss: 0.5307 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 11s - loss: 0.5296 - acc: 0.7422
 320/1000 [========>.....................] - ETA: 10s - loss: 0.5156 - acc: 0.7469
 384/1000 [==========>...................] - ETA: 9s - loss: 0.5199 - acc: 0.7396 
 448/1000 [============>.................] - ETA: 8s - loss: 0.5224 - acc: 0.7411
 512/1000 [==============>...............] - ETA: 7s - loss: 0.5342 - acc: 0.7324
 576/1000 [================>.............] - ETA: 6s - loss: 0.5323 - acc: 0.7361
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5280 - acc: 0.7391
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5214 - acc: 0.7443
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5200 - acc: 0.7422
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5206 - acc: 0.7392
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5171 - acc: 0.7400
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5115 - acc: 0.7458
1000/1000 [==============================] - 15s 15ms/step - loss: 0.5198 - acc: 0.7380

Test accuracy: 70.78331953642383

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  6401

choose_one :  12927

F1score :  0.7512882624972472

AUC :  0.808791902754233

Confusion Matrix
[[5152 4398]
 [1249 8529]]
True label 0
0.5394764397905759  
0.4605235602094241  
True label 1
0.12773573327878912  
0.8722642667212109  

Train_result {'loss': [0.5197923922538757], 'acc': [0.7380000004768371]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.5901 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 13s - loss: 0.5356 - acc: 0.7578
 192/1000 [====>.........................] - ETA: 12s - loss: 0.5167 - acc: 0.7500
 256/1000 [======>.......................] - ETA: 11s - loss: 0.5244 - acc: 0.7344
 320/1000 [========>.....................] - ETA: 10s - loss: 0.5305 - acc: 0.7406
 384/1000 [==========>...................] - ETA: 9s - loss: 0.5215 - acc: 0.7526 
 448/1000 [============>.................] - ETA: 8s - loss: 0.5202 - acc: 0.7567
 512/1000 [==============>...............] - ETA: 7s - loss: 0.5240 - acc: 0.7539
 576/1000 [================>.............] - ETA: 6s - loss: 0.5171 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5221 - acc: 0.7578
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5184 - acc: 0.7614
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5154 - acc: 0.7656
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5070 - acc: 0.7716
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5133 - acc: 0.7690
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5100 - acc: 0.7698
1000/1000 [==============================] - 15s 15ms/step - loss: 0.5125 - acc: 0.7660

Test accuracy: 67.92218543046357

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14522

choose_one :  4806

F1score :  0.5748765770707625

AUC :  0.8143508720827501

Confusion Matrix
[[8936  614]
 [5586 4192]]
True label 0
0.9357068062827225  
0.06429319371727749  
True label 1
0.5712824708529352  
0.42871752914706485  

Train_result {'loss': [0.5124819283485412], 'acc': [0.7660000004768371]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5146 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4829 - acc: 0.7734
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4755 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 11s - loss: 0.4673 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 10s - loss: 0.4821 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4840 - acc: 0.7656 
 448/1000 [============>.................] - ETA: 8s - loss: 0.4957 - acc: 0.7589
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4993 - acc: 0.7441
 576/1000 [================>.............] - ETA: 6s - loss: 0.4921 - acc: 0.7483
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4888 - acc: 0.7516
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4940 - acc: 0.7443
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4969 - acc: 0.7396
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4940 - acc: 0.7428
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4927 - acc: 0.7422
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4952 - acc: 0.7396
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4960 - acc: 0.7390

Test accuracy: 74.74648178807946

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10147

choose_one :  9181

F1score :  0.7425497125375812

AUC :  0.8214442401416151

Confusion Matrix
[[7408 2142]
 [2739 7039]]
True label 0
0.7757068062827225  
0.2242931937172775  
True label 1
0.2801186336674166  
0.7198813663325834  

Train_result {'loss': [0.4959841208457947], 'acc': [0.7390000009536744]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.4593 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4247 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 12s - loss: 0.4375 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 11s - loss: 0.4516 - acc: 0.8086
 320/1000 [========>.....................] - ETA: 10s - loss: 0.4591 - acc: 0.8063
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4661 - acc: 0.7995 
 448/1000 [============>.................] - ETA: 8s - loss: 0.4619 - acc: 0.7946
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4750 - acc: 0.7832
 576/1000 [================>.............] - ETA: 6s - loss: 0.4697 - acc: 0.7847
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4762 - acc: 0.7781
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4643 - acc: 0.7855
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4689 - acc: 0.7812
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4732 - acc: 0.7764
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4806 - acc: 0.7623
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4840 - acc: 0.7646
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4813 - acc: 0.7670

Test accuracy: 75.08278145695364

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9700

choose_one :  9628

F1score :  0.7518293311347005

AUC :  0.8235964859675369

Confusion Matrix
[[7217 2333]
 [2483 7295]]
True label 0
0.7557068062827225  
0.24429319371727748  
True label 1
0.2539374105133974  
0.7460625894866025  

Train_result {'loss': [0.4812746789455414], 'acc': [0.7669999995231629]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.3915 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3927 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4262 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4118 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4009 - acc: 0.8000 
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4167 - acc: 0.7917
 448/1000 [============>.................] - ETA: 8s - loss: 0.4225 - acc: 0.7924
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4319 - acc: 0.7891
 576/1000 [================>.............] - ETA: 6s - loss: 0.4306 - acc: 0.7865
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4253 - acc: 0.7953
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4348 - acc: 0.7912
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4347 - acc: 0.7930
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4311 - acc: 0.7957
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4498 - acc: 0.7857
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4520 - acc: 0.7823
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4560 - acc: 0.7810

Test accuracy: 74.85513245033113

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8580

choose_one :  10748

F1score :  0.7632271265711781

AUC :  0.8275446536138934

Confusion Matrix
[[6635 2915]
 [1945 7833]]
True label 0
0.6947643979057592  
0.30523560209424083  
True label 1
0.1989159337287789  
0.8010840662712211  

Train_result {'loss': [0.45601276969909665], 'acc': [0.781]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.4284 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4835 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4817 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4639 - acc: 0.7773
 320/1000 [========>.....................] - ETA: 10s - loss: 0.4618 - acc: 0.7750
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4749 - acc: 0.7630 
 448/1000 [============>.................] - ETA: 8s - loss: 0.4617 - acc: 0.7746
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4564 - acc: 0.7754
 576/1000 [================>.............] - ETA: 6s - loss: 0.4563 - acc: 0.7760
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4536 - acc: 0.7781
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4584 - acc: 0.7727
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4457 - acc: 0.7812
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4434 - acc: 0.7849
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4354 - acc: 0.7902
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4393 - acc: 0.7875
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4383 - acc: 0.7880

Test accuracy: 64.60575331125827

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  15555

choose_one :  3773

F1score :  0.4951664083831452

AUC :  0.8206848101143821

Confusion Matrix
[[9132  418]
 [6423 3355]]
True label 0
0.9562303664921465  
0.0437696335078534  
True label 1
0.6568827981182246  
0.3431172018817754  

Train_result {'loss': [0.43827777457237244], 'acc': [0.7880000004768372]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5995 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 13s - loss: 0.4609 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 12s - loss: 0.4670 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 11s - loss: 0.4680 - acc: 0.7695
 320/1000 [========>.....................] - ETA: 10s - loss: 0.4500 - acc: 0.7875
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4376 - acc: 0.7917 
 448/1000 [============>.................] - ETA: 8s - loss: 0.4284 - acc: 0.7969
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4263 - acc: 0.7949
 576/1000 [================>.............] - ETA: 6s - loss: 0.4291 - acc: 0.7934
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4228 - acc: 0.7984
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4201 - acc: 0.7983
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4199 - acc: 0.8008
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4115 - acc: 0.8017
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4105 - acc: 0.8025
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4182 - acc: 0.7979
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4235 - acc: 0.7930

Test accuracy: 73.11672185430463

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7020

choose_one :  12308

F1score :  0.7647378429774518

AUC :  0.8293110669426719

Confusion Matrix
[[5687 3863]
 [1333 8445]]
True label 0
0.5954973821989529  
0.4045026178010471  
True label 1
0.13632644712620168  
0.8636735528737983  

Train_result {'loss': [0.4234616823196411], 'acc': [0.7930000004768372]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.3705 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3656 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3602 - acc: 0.8333
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3664 - acc: 0.8398
 320/1000 [========>.....................] - ETA: 9s - loss: 0.3819 - acc: 0.8281 
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3807 - acc: 0.8255
 448/1000 [============>.................] - ETA: 8s - loss: 0.4010 - acc: 0.8147
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3973 - acc: 0.8184
 576/1000 [================>.............] - ETA: 6s - loss: 0.3985 - acc: 0.8142
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4000 - acc: 0.8125
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4092 - acc: 0.8125
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4098 - acc: 0.8164
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4030 - acc: 0.8185
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4049 - acc: 0.8181
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4057 - acc: 0.8208
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4073 - acc: 0.8190

Test accuracy: 73.48923841059603

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7200

choose_one :  12128

F1score :  0.7660914817858121

AUC :  0.8312988341174066

Confusion Matrix
[[5813 3737]
 [1387 8391]]
True label 0
0.6086910994764398  
0.3913089005235602  
True label 1
0.1418490488852526  
0.8581509511147474  

Train_result {'loss': [0.40726863145828246], 'acc': [0.8189999990463257]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.3158 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3432 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3341 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3284 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 10s - loss: 0.3284 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3583 - acc: 0.8542 
 448/1000 [============>.................] - ETA: 8s - loss: 0.3629 - acc: 0.8549
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3566 - acc: 0.8574
 576/1000 [================>.............] - ETA: 6s - loss: 0.3631 - acc: 0.8507
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3582 - acc: 0.8516
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3576 - acc: 0.8494
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3723 - acc: 0.8438
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3725 - acc: 0.8450
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3724 - acc: 0.8438
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3704 - acc: 0.8438
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3666 - acc: 0.8480

Test accuracy: 75.59499172185431

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8885

choose_one :  10443

F1score :  0.7667276593640274

AUC :  0.8348723601117586

Confusion Matrix
[[6859 2691]
 [2026 7752]]
True label 0
0.7182198952879582  
0.2817801047120419  
True label 1
0.20719983636735528  
0.7928001636326447  

Train_result {'loss': [0.36664693570137025], 'acc': [0.8479999995231629]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.2634 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 13s - loss: 0.2890 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 12s - loss: 0.3075 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 11s - loss: 0.3359 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 10s - loss: 0.3479 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3510 - acc: 0.8359 
 448/1000 [============>.................] - ETA: 8s - loss: 0.3474 - acc: 0.8326
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3619 - acc: 0.8281
 576/1000 [================>.............] - ETA: 6s - loss: 0.3596 - acc: 0.8299
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3558 - acc: 0.8344
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3473 - acc: 0.8395
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3572 - acc: 0.8346
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3576 - acc: 0.8353
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3639 - acc: 0.8337
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3645 - acc: 0.8333
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3654 - acc: 0.8350

Test accuracy: 74.00662251655629

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12358

choose_one :  6970

F1score :  0.7000238834487702

AUC :  0.8320363322299553

Confusion Matrix
[[8442 1108]
 [3916 5862]]
True label 0
0.883979057591623  
0.11602094240837696  
True label 1
0.40049089793413784  
0.5995091020658622  

Train_result {'loss': [0.36537105989456176], 'acc': [0.835]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 14s - loss: 0.2799 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3177 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3065 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 11s - loss: 0.3441 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 10s - loss: 0.3341 - acc: 0.8594
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3170 - acc: 0.8646 
 448/1000 [============>.................] - ETA: 8s - loss: 0.3152 - acc: 0.8705
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3099 - acc: 0.8730
 576/1000 [================>.............] - ETA: 6s - loss: 0.3115 - acc: 0.8750
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3316 - acc: 0.8672
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3296 - acc: 0.8651
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3348 - acc: 0.8594
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3295 - acc: 0.8618
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3341 - acc: 0.8627
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3351 - acc: 0.8594
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3362 - acc: 0.8600

Test accuracy: 74.38431291390728

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12045

choose_one :  7283

F1score :  0.7098059902702069

AUC :  0.8344755188215023

Confusion Matrix
[[8322 1228]
 [3723 6055]]
True label 0
0.871413612565445  
0.12858638743455497  
True label 1
0.3807527101656781  
0.619247289834322  

Train_result {'loss': [0.33624040746688844], 'acc': [0.86]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.2831 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 12s - loss: 0.3224 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3344 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 10s - loss: 0.3085 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 9s - loss: 0.3107 - acc: 0.8812 
 384/1000 [==========>...................] - ETA: 9s - loss: 0.3113 - acc: 0.8802
 448/1000 [============>.................] - ETA: 8s - loss: 0.3120 - acc: 0.8728
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3143 - acc: 0.8672
 576/1000 [================>.............] - ETA: 6s - loss: 0.3197 - acc: 0.8663
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3153 - acc: 0.8703
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3135 - acc: 0.8722
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3153 - acc: 0.8750
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3130 - acc: 0.8750
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3133 - acc: 0.8761
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3085 - acc: 0.8802
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3073 - acc: 0.8790

Test accuracy: 69.35533940397352

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14075

choose_one :  5253

F1score :  0.6059477080699887

AUC :  0.8298709304679058

Confusion Matrix
[[8851  699]
 [5224 4554]]
True label 0
0.9268062827225131  
0.07319371727748691  
True label 1
0.5342605849867048  
0.46573941501329513  

Train_result {'loss': [0.3072886333465576], 'acc': [0.8790000009536744]}
Saved model to disk


[[70.93853476821192, 1], [72.00434602649007, 2], [66.24586092715232, 3], [70.78331953642383, 4], [67.92218543046357, 5], [74.74648178807946, 6], [75.08278145695364, 7], [74.85513245033113, 8], [64.60575331125827, 9], [73.11672185430463, 10], [73.48923841059603, 11], [75.59499172185431, 12], [74.00662251655629, 13], [74.38431291390728, 14], [69.35533940397352, 15]]
max accuracy :  [75.59499172185431, 12]

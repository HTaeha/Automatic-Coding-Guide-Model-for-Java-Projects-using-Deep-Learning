Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-10 08:09:16.431980: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-10 08:09:16.457874: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-10-10 08:09:16.476376: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x9c9e250 executing computations on platform Host. Devices:
2019-10-10 08:09:16.476411: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

hbase-CAST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

After balance out data.
hbase-CAST

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

697
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 697, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 697, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 38s - loss: 0.8742 - acc: 0.4062
 128/1000 [==>...........................] - ETA: 25s - loss: 0.8693 - acc: 0.4688
 192/1000 [====>.........................] - ETA: 20s - loss: 0.9055 - acc: 0.4740
 256/1000 [======>.......................] - ETA: 16s - loss: 0.8604 - acc: 0.5000
 320/1000 [========>.....................] - ETA: 14s - loss: 0.8138 - acc: 0.5312
 384/1000 [==========>...................] - ETA: 12s - loss: 0.7979 - acc: 0.5339
 448/1000 [============>.................] - ETA: 10s - loss: 0.7910 - acc: 0.5402
 512/1000 [==============>...............] - ETA: 9s - loss: 0.7587 - acc: 0.5664 
 576/1000 [================>.............] - ETA: 8s - loss: 0.7542 - acc: 0.5625
 640/1000 [==================>...........] - ETA: 6s - loss: 0.7552 - acc: 0.5625
 704/1000 [====================>.........] - ETA: 5s - loss: 0.7361 - acc: 0.5781
 768/1000 [======================>.......] - ETA: 4s - loss: 0.7302 - acc: 0.5820
 832/1000 [=======================>......] - ETA: 3s - loss: 0.7233 - acc: 0.5853
 896/1000 [=========================>....] - ETA: 1s - loss: 0.7167 - acc: 0.5893
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7166 - acc: 0.5885
1000/1000 [==============================] - 18s 18ms/step - loss: 0.7129 - acc: 0.5870

Test accuracy: 71.00579470198676

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9904

choose_one :  9424

F1score :  0.7081554004791166

AUC :  0.7717787339673741

Confusion Matrix
[[6925 2625]
 [2979 6799]]
True label 0
0.725130890052356  
0.27486910994764396  
True label 1
0.30466353037430965  
0.6953364696256903  

Train_result {'loss': [0.7128611993789673], 'acc': [0.5870000004768372]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.6182 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5645 - acc: 0.6953
 192/1000 [====>.........................] - ETA: 10s - loss: 0.6074 - acc: 0.6667
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5967 - acc: 0.6719 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5909 - acc: 0.6844
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5744 - acc: 0.6953
 448/1000 [============>.................] - ETA: 6s - loss: 0.5754 - acc: 0.6942
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5781 - acc: 0.6934
 576/1000 [================>.............] - ETA: 5s - loss: 0.5835 - acc: 0.6927
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5844 - acc: 0.6969
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5846 - acc: 0.7003
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5849 - acc: 0.6979
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5924 - acc: 0.6935
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6015 - acc: 0.6875
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6024 - acc: 0.6854
1000/1000 [==============================] - 13s 13ms/step - loss: 0.5980 - acc: 0.6900

Test accuracy: 72.33547185430463

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10159

choose_one :  9169

F1score :  0.7177917348392885

AUC :  0.7913821229193864

Confusion Matrix
[[7181 2369]
 [2978 6800]]
True label 0
0.7519371727748692  
0.2480628272251309  
True label 1
0.3045612599713643  
0.6954387400286357  

Train_result {'loss': [0.5979625954627991], 'acc': [0.6900000004768372]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.6040 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5670 - acc: 0.6719
 192/1000 [====>.........................] - ETA: 10s - loss: 0.5654 - acc: 0.7188
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5477 - acc: 0.7188 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5457 - acc: 0.7094
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5617 - acc: 0.6979
 448/1000 [============>.................] - ETA: 6s - loss: 0.5637 - acc: 0.7031
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5579 - acc: 0.7012
 576/1000 [================>.............] - ETA: 5s - loss: 0.5622 - acc: 0.6910
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5633 - acc: 0.6922
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5659 - acc: 0.6932
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5714 - acc: 0.6875
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5678 - acc: 0.6935
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5699 - acc: 0.6920
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5685 - acc: 0.6906
1000/1000 [==============================] - 13s 13ms/step - loss: 0.5662 - acc: 0.6910

Test accuracy: 67.27545529801324

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  5007

choose_one :  14321

F1score :  0.7375409768040168

AUC :  0.7990389098724672

Confusion Matrix
[[4116 5434]
 [ 891 8887]]
True label 0
0.43099476439790574  
0.5690052356020943  
True label 1
0.09112292902434035  
0.9088770709756596  

Train_result {'loss': [0.5661971278190613], 'acc': [0.6909999995231628]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.6061 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5369 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5657 - acc: 0.7135 
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5482 - acc: 0.7305
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5294 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5335 - acc: 0.7344
 448/1000 [============>.................] - ETA: 6s - loss: 0.5338 - acc: 0.7344
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5459 - acc: 0.7305
 576/1000 [================>.............] - ETA: 5s - loss: 0.5422 - acc: 0.7274
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5422 - acc: 0.7266
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5384 - acc: 0.7244
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5344 - acc: 0.7331
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5374 - acc: 0.7320
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5357 - acc: 0.7288
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5339 - acc: 0.7292
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5405 - acc: 0.7250

Test accuracy: 69.86754966887418

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  6034

choose_one :  13294

F1score :  0.7475728155339806

AUC :  0.8065707555908712

Confusion Matrix
[[4880 4670]
 [1154 8624]]
True label 0
0.5109947643979058  
0.48900523560209425  
True label 1
0.1180200449989773  
0.8819799550010227  

Train_result {'loss': [0.5405031118392944], 'acc': [0.725]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5944 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5267 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 10s - loss: 0.5350 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5461 - acc: 0.7422 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5558 - acc: 0.7344
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5416 - acc: 0.7474
 448/1000 [============>.................] - ETA: 6s - loss: 0.5408 - acc: 0.7411
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5403 - acc: 0.7383
 576/1000 [================>.............] - ETA: 5s - loss: 0.5317 - acc: 0.7431
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5409 - acc: 0.7344
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5340 - acc: 0.7415
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5257 - acc: 0.7474
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5196 - acc: 0.7536
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5202 - acc: 0.7511
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5213 - acc: 0.7469
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5213 - acc: 0.7430

Test accuracy: 67.11506622516556

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14724

choose_one :  4604

F1score :  0.5580586844666945

AUC :  0.8106097297169947

Confusion Matrix
[[8959  591]
 [5765 4013]]
True label 0
0.9381151832460733  
0.0618848167539267  
True label 1
0.5895888729801595  
0.41041112701984045  

Train_result {'loss': [0.521333990097046], 'acc': [0.7429999990463256]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5166 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5152 - acc: 0.7344
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5171 - acc: 0.7396 
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5150 - acc: 0.7305
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5290 - acc: 0.7125
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5255 - acc: 0.7240
 448/1000 [============>.................] - ETA: 6s - loss: 0.5295 - acc: 0.7210
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5264 - acc: 0.7168
 576/1000 [================>.............] - ETA: 5s - loss: 0.5199 - acc: 0.7205
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5183 - acc: 0.7188
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5179 - acc: 0.7202
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5232 - acc: 0.7188
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5192 - acc: 0.7212
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5201 - acc: 0.7210
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5231 - acc: 0.7229
1000/1000 [==============================] - 13s 13ms/step - loss: 0.5219 - acc: 0.7260

Test accuracy: 74.66370033112582

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9223

choose_one :  10105

F1score :  0.7537091988130564

AUC :  0.8219284396320836

Confusion Matrix
[[6938 2612]
 [2285 7493]]
True label 0
0.7264921465968587  
0.2735078534031414  
True label 1
0.2336878707302107  
0.7663121292697893  

Train_result {'loss': [0.5219337327480316], 'acc': [0.7260000004768371]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5055 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 11s - loss: 0.4598 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 10s - loss: 0.4548 - acc: 0.7917
 256/1000 [======>.......................] - ETA: 9s - loss: 0.4385 - acc: 0.8086 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.4515 - acc: 0.7969
 384/1000 [==========>...................] - ETA: 7s - loss: 0.4690 - acc: 0.7812
 448/1000 [============>.................] - ETA: 6s - loss: 0.4743 - acc: 0.7768
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4816 - acc: 0.7754
 576/1000 [================>.............] - ETA: 5s - loss: 0.4854 - acc: 0.7726
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4893 - acc: 0.7688
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4772 - acc: 0.7756
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4795 - acc: 0.7721
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4812 - acc: 0.7656
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4929 - acc: 0.7589
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4889 - acc: 0.7656
1000/1000 [==============================] - 13s 13ms/step - loss: 0.4883 - acc: 0.7650

Test accuracy: 74.83961092715232

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9127

choose_one :  10201

F1score :  0.7565944241453527

AUC :  0.8261630768505857

Confusion Matrix
[[6907 2643]
 [2220 7558]]
True label 0
0.7232460732984293  
0.2767539267015707  
True label 1
0.22704029453876048  
0.7729597054612395  

Train_result {'loss': [0.4882939703464508], 'acc': [0.765]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.3925 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4111 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4407 - acc: 0.7917
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4289 - acc: 0.8008
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4244 - acc: 0.8000 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4287 - acc: 0.7917
 448/1000 [============>.................] - ETA: 7s - loss: 0.4350 - acc: 0.7857
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4420 - acc: 0.7812
 576/1000 [================>.............] - ETA: 5s - loss: 0.4441 - acc: 0.7830
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4453 - acc: 0.7828
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4582 - acc: 0.7756
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4590 - acc: 0.7760
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4528 - acc: 0.7776
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4643 - acc: 0.7734
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4644 - acc: 0.7729
1000/1000 [==============================] - 14s 14ms/step - loss: 0.4670 - acc: 0.7720

Test accuracy: 74.30670529801324

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8036

choose_one :  11292

F1score :  0.7643094447081159

AUC :  0.8283274398451916

Confusion Matrix
[[6310 3240]
 [1726 8052]]
True label 0
0.6607329842931937  
0.3392670157068063  
True label 1
0.176518715483739  
0.823481284516261  

Train_result {'loss': [0.4669803009033203], 'acc': [0.772]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4239 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 11s - loss: 0.4724 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 10s - loss: 0.5002 - acc: 0.7500
 256/1000 [======>.......................] - ETA: 9s - loss: 0.4736 - acc: 0.7773 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4609 - acc: 0.7844
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4721 - acc: 0.7734
 448/1000 [============>.................] - ETA: 7s - loss: 0.4645 - acc: 0.7746
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4498 - acc: 0.7871
 576/1000 [================>.............] - ETA: 5s - loss: 0.4567 - acc: 0.7882
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4548 - acc: 0.7906
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4666 - acc: 0.7798
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4614 - acc: 0.7865
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4575 - acc: 0.7897
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4510 - acc: 0.7902
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4556 - acc: 0.7906
1000/1000 [==============================] - 14s 14ms/step - loss: 0.4532 - acc: 0.7940

Test accuracy: 69.09147350993378

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14326

choose_one :  5002

F1score :  0.5958051420838971

AUC :  0.8257027315300188

Confusion Matrix
[[8951  599]
 [5375 4403]]
True label 0
0.9372774869109948  
0.06272251308900524  
True label 1
0.5497034158314584  
0.4502965841685416  

Train_result {'loss': [0.45317132520675657], 'acc': [0.794]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5117 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4569 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 12s - loss: 0.4648 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 11s - loss: 0.4743 - acc: 0.7812
 320/1000 [========>.....................] - ETA: 10s - loss: 0.4623 - acc: 0.7906
 384/1000 [==========>...................] - ETA: 9s - loss: 0.4593 - acc: 0.7917 
 448/1000 [============>.................] - ETA: 8s - loss: 0.4482 - acc: 0.8013
 512/1000 [==============>...............] - ETA: 7s - loss: 0.4432 - acc: 0.8066
 576/1000 [================>.............] - ETA: 6s - loss: 0.4459 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4398 - acc: 0.8094
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4406 - acc: 0.8082
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4349 - acc: 0.8125
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4301 - acc: 0.8137
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4295 - acc: 0.8114
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4324 - acc: 0.8094
1000/1000 [==============================] - 15s 15ms/step - loss: 0.4307 - acc: 0.8090

Test accuracy: 72.6407284768212

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  6486

choose_one :  12842

F1score :  0.7662245800176836

AUC :  0.8320590780242858

Confusion Matrix
[[5374 4176]
 [1112 8666]]
True label 0
0.5627225130890052  
0.4372774869109948  
True label 1
0.11372468807527102  
0.886275311924729  

Train_result {'loss': [0.43067360639572144], 'acc': [0.8090000004768372]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.3888 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4141 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 11s - loss: 0.3849 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4204 - acc: 0.7812
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4276 - acc: 0.7875 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4231 - acc: 0.7917
 448/1000 [============>.................] - ETA: 7s - loss: 0.4426 - acc: 0.7746
 512/1000 [==============>...............] - ETA: 6s - loss: 0.4359 - acc: 0.7852
 576/1000 [================>.............] - ETA: 6s - loss: 0.4329 - acc: 0.7899
 640/1000 [==================>...........] - ETA: 5s - loss: 0.4265 - acc: 0.7969
 704/1000 [====================>.........] - ETA: 4s - loss: 0.4334 - acc: 0.7926
 768/1000 [======================>.......] - ETA: 3s - loss: 0.4316 - acc: 0.7943
 832/1000 [=======================>......] - ETA: 2s - loss: 0.4251 - acc: 0.7969
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4309 - acc: 0.7913
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4317 - acc: 0.7927
1000/1000 [==============================] - 14s 14ms/step - loss: 0.4315 - acc: 0.7940

Test accuracy: 75.5794701986755

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8888

choose_one :  10440

F1score :  0.7665446631714313

AUC :  0.8405517782734828

Confusion Matrix
[[6859 2691]
 [2029 7749]]
True label 0
0.7182198952879582  
0.2817801047120419  
True label 1
0.20750664757619144  
0.7924933524238086  

Train_result {'loss': [0.4315126569271088], 'acc': [0.7939999995231628]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.3217 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 11s - loss: 0.3708 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 10s - loss: 0.3612 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 9s - loss: 0.3487 - acc: 0.8438 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.3615 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3817 - acc: 0.8229
 448/1000 [============>.................] - ETA: 7s - loss: 0.3796 - acc: 0.8214
 512/1000 [==============>...............] - ETA: 6s - loss: 0.3736 - acc: 0.8281
 576/1000 [================>.............] - ETA: 5s - loss: 0.3872 - acc: 0.8177
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3857 - acc: 0.8203
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3853 - acc: 0.8210
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3933 - acc: 0.8190
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3905 - acc: 0.8233
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3914 - acc: 0.8237
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3862 - acc: 0.8260
1000/1000 [==============================] - 13s 13ms/step - loss: 0.3844 - acc: 0.8240

Test accuracy: 72.74420529801324

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  6262

choose_one :  13066

F1score :  0.7693924006303625

AUC :  0.8404717128632607

Confusion Matrix
[[5272 4278]
 [ 990 8788]]
True label 0
0.552041884816754  
0.4479581151832461  
True label 1
0.10124769891593373  
0.8987523010840662  

Train_result {'loss': [0.3843906781673431], 'acc': [0.8239999990463257]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4880 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4557 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4366 - acc: 0.7917
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4284 - acc: 0.8008
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4157 - acc: 0.8187 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4076 - acc: 0.8203
 448/1000 [============>.................] - ETA: 7s - loss: 0.3939 - acc: 0.8237
 512/1000 [==============>...............] - ETA: 7s - loss: 0.3979 - acc: 0.8203
 576/1000 [================>.............] - ETA: 6s - loss: 0.3920 - acc: 0.8229
 640/1000 [==================>...........] - ETA: 5s - loss: 0.3828 - acc: 0.8281
 704/1000 [====================>.........] - ETA: 4s - loss: 0.3720 - acc: 0.8366
 768/1000 [======================>.......] - ETA: 3s - loss: 0.3711 - acc: 0.8346
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3676 - acc: 0.8365
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3806 - acc: 0.8337
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3870 - acc: 0.8323
1000/1000 [==============================] - 15s 15ms/step - loss: 0.3838 - acc: 0.8350

Test accuracy: 73.56167218543047

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12618

choose_one :  6710

F1score :  0.6900776322173703

AUC :  0.8357464989789023

Confusion Matrix
[[8529 1021]
 [4089 5689]]
True label 0
0.8930890052356021  
0.1069109947643979  
True label 1
0.4181836776436899  
0.5818163223563101  

Train_result {'loss': [0.3837743229866028], 'acc': [0.8349999990463257]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.4066 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 10s - loss: 0.3712 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 9s - loss: 0.3311 - acc: 0.8854 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.3689 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 7s - loss: 0.3650 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3457 - acc: 0.8568
 448/1000 [============>.................] - ETA: 6s - loss: 0.3349 - acc: 0.8616
 512/1000 [==============>...............] - ETA: 5s - loss: 0.3377 - acc: 0.8613
 576/1000 [================>.............] - ETA: 5s - loss: 0.3412 - acc: 0.8576
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3516 - acc: 0.8484
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3476 - acc: 0.8494
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3511 - acc: 0.8464
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3497 - acc: 0.8486
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3471 - acc: 0.8471
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3460 - acc: 0.8469
1000/1000 [==============================] - 12s 12ms/step - loss: 0.3458 - acc: 0.8450

Test accuracy: 74.7982201986755

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11605

choose_one :  7723

F1score :  0.7216730472544426

AUC :  0.8361777481021075

Confusion Matrix
[[8142 1408]
 [3463 6315]]
True label 0
0.852565445026178  
0.147434554973822  
True label 1
0.35416240539987726  
0.6458375946001227  

Train_result {'loss': [0.34578895998001097], 'acc': [0.8450000004768372]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.3067 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 10s - loss: 0.3513 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 9s - loss: 0.3654 - acc: 0.8438 
 256/1000 [======>.......................] - ETA: 9s - loss: 0.3362 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 8s - loss: 0.3268 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3464 - acc: 0.8490
 448/1000 [============>.................] - ETA: 6s - loss: 0.3544 - acc: 0.8438
 512/1000 [==============>...............] - ETA: 5s - loss: 0.3578 - acc: 0.8398
 576/1000 [================>.............] - ETA: 5s - loss: 0.3615 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3478 - acc: 0.8438
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3425 - acc: 0.8509
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3421 - acc: 0.8503
 832/1000 [=======================>......] - ETA: 2s - loss: 0.3432 - acc: 0.8498
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3403 - acc: 0.8516
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3342 - acc: 0.8531
1000/1000 [==============================] - 12s 12ms/step - loss: 0.3337 - acc: 0.8510

Test accuracy: 75.23282284768213

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11807

choose_one :  7521

F1score :  0.7232788022429043

AUC :  0.8412785995701431

Confusion Matrix
[[8285 1265]
 [3522 6256]]
True label 0
0.8675392670157068  
0.1324607329842932  
True label 1
0.36019635917365517  
0.6398036408263449  

Train_result {'loss': [0.3337020215988159], 'acc': [0.8510000004768371]}
Saved model to disk


[[71.00579470198676, 1], [72.33547185430463, 2], [67.27545529801324, 3], [69.86754966887418, 4], [67.11506622516556, 5], [74.66370033112582, 6], [74.83961092715232, 7], [74.30670529801324, 8], [69.09147350993378, 9], [72.6407284768212, 10], [75.5794701986755, 11], [72.74420529801324, 12], [73.56167218543047, 13], [74.7982201986755, 14], [75.23282284768213, 15]]
max accuracy :  [75.5794701986755, 11]

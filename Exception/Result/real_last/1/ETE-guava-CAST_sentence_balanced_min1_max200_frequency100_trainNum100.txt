Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 23:49:17.311835: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 23:49:17.318055: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100005000 Hz
2019-10-14 23:49:17.320094: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x898a8b0 executing computations on platform Host. Devices:
2019-10-14 23:49:17.320159: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  9884
one :  9718

guava-CAST
After set document size of train data, the number of zero and one label data :  55 45
After set document size of test data, the number of zero and one label data :  9829 9673

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

After balance out data.
guava-CAST

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

401
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 401, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 401, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

 64/100 [==================>...........] - ETA: 1s - loss: 0.8490 - acc: 0.3281
100/100 [==============================] - 3s 33ms/step - loss: 0.7775 - acc: 0.4300

Test accuracy: 52.456158342734085

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  18921

choose_one :  581

F1score :  0.09576750536376048

AUC :  0.7456972568563289

Confusion Matrix
[[9739   90]
 [9182  491]]
True label 0
0.9908434225251805  
0.009156577474819412  
True label 1
0.9492401530032047  
0.050759846996795206  

Train_result {'loss': [0.7775122046470642], 'acc': [0.4299999976158142]}
Saved model to disk


2

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.7507 - acc: 0.5781
100/100 [==============================] - 1s 13ms/step - loss: 0.6721 - acc: 0.6400

Test accuracy: 64.53184288790894

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  14428

choose_one :  5074

F1score :  0.53095544856581

AUC :  0.7710465784936894

Confusion Matrix
[[8670 1159]
 [5758 3915]]
True label 0
0.88208363007427  
0.11791636992572999  
True label 1
0.5952651710947999  
0.4047348289052  

Train_result {'loss': [0.6721121406555176], 'acc': [0.64]}
Saved model to disk


3

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.5453 - acc: 0.7656
100/100 [==============================] - 1s 13ms/step - loss: 0.5523 - acc: 0.7600

Test accuracy: 71.42344374935904

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  10068

choose_one :  9434

F1score :  0.7083267912283456

AUC :  0.7809549341501487

Confusion Matrix
[[7162 2667]
 [2906 6767]]
True label 0
0.7286600874961847  
0.27133991250381523  
True label 1
0.3004238602295048  
0.6995761397704952  

Train_result {'loss': [0.552286081314087], 'acc': [0.76]}
Saved model to disk


4

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.4687 - acc: 0.7656
100/100 [==============================] - 1s 13ms/step - loss: 0.4933 - acc: 0.7300

Test accuracy: 71.66957235155368

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  9692

choose_one :  9810

F1score :  0.7164194425909767

AUC :  0.7867760717995493

Confusion Matrix
[[6998 2831]
 [2694 6979]]
True label 0
0.7119747685420694  
0.28802523145793063  
True label 1
0.2785071849477928  
0.7214928150522072  

Train_result {'loss': [0.4933401346206665], 'acc': [0.7300000071525574]}
Saved model to disk


5

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.5378 - acc: 0.7188
100/100 [==============================] - 1s 12ms/step - loss: 0.4916 - acc: 0.7700

Test accuracy: 71.25423033535021

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  7979

choose_one :  11523

F1score :  0.7355161351198339

AUC :  0.7870260089103323

Confusion Matrix
[[6101 3728]
 [1878 7795]]
True label 0
0.6207142130430359  
0.3792857869569641  
True label 1
0.19414866122195804  
0.8058513387780419  

Train_result {'loss': [0.49163601160049436], 'acc': [0.7699999976158142]}
Saved model to disk


6

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.4304 - acc: 0.7969
100/100 [==============================] - 1s 14ms/step - loss: 0.4352 - acc: 0.7800

Test accuracy: 72.00799917957133

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  10492

choose_one :  9010

F1score :  0.7078092383450195

AUC :  0.7945756705139116

Confusion Matrix
[[7431 2398]
 [3061 6612]]
True label 0
0.7560280801709228  
0.24397191982907723  
True label 1
0.31644784451566216  
0.6835521554843379  

Train_result {'loss': [0.4351628661155701], 'acc': [0.78]}
Saved model to disk


7

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.4831 - acc: 0.7344
100/100 [==============================] - 1s 13ms/step - loss: 0.4525 - acc: 0.7500

Test accuracy: 72.4233411957748

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  9609

choose_one :  9893

F1score :  0.7251354390268833

AUC :  0.7983738563363002

Confusion Matrix
[[7030 2799]
 [2579 7094]]
True label 0
0.7152304405331162  
0.2847695594668837  
True label 1
0.2666184224129019  
0.7333815775870981  

Train_result {'loss': [0.45252588152885437], 'acc': [0.7500000047683716]}
Saved model to disk


8

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.3884 - acc: 0.8281
100/100 [==============================] - 1s 12ms/step - loss: 0.3903 - acc: 0.8200

Test accuracy: 71.49523125833248

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  7282

choose_one :  12220

F1score :  0.7460832229479741

AUC :  0.7940286970884541

Confusion Matrix
[[5776 4053]
 [1506 8167]]
True label 0
0.5876487943839658  
0.41235120561603417  
True label 1
0.1556910989351804  
0.8443089010648196  

Train_result {'loss': [0.39029700875282286], 'acc': [0.8200000095367431]}
Saved model to disk


9

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.4375 - acc: 0.7969
100/100 [==============================] - 1s 13ms/step - loss: 0.4193 - acc: 0.8100

Test accuracy: 70.30048200184596

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  6447

choose_one :  13055

F1score :  0.7451601548750441

AUC :  0.7907588679896718

Confusion Matrix
[[5242 4587]
 [1205 8468]]
True label 0
0.5333197680333707  
0.4666802319666294  
True label 1
0.12457355525690066  
0.8754264447430994  

Train_result {'loss': [0.4192590296268463], 'acc': [0.8099999928474426]}
Saved model to disk


10

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.3892 - acc: 0.8438
100/100 [==============================] - 2s 18ms/step - loss: 0.4042 - acc: 0.7800

Test accuracy: 73.0848118141729

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  9500

choose_one :  10002

F1score :  0.7332147395171538

AUC :  0.7968839522210446

Confusion Matrix
[[7040 2789]
 [2460 7213]]
True label 0
0.7162478380303184  
0.28375216196968156  
True label 1
0.2543161377028843  
0.7456838622971157  

Train_result {'loss': [0.4041901063919067], 'acc': [0.7800000071525574]}
Saved model to disk


11

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.4116 - acc: 0.7969
100/100 [==============================] - 2s 23ms/step - loss: 0.3370 - acc: 0.8500

Test accuracy: 73.00789662598707

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  9995

choose_one :  9507

F1score :  0.7255474452554745

AUC :  0.8055345761219427

Confusion Matrix
[[7280 2549]
 [2715 6958]]
True label 0
0.7406653779631702  
0.2593346220368298  
True label 1
0.2806781763672077  
0.7193218236327923  

Train_result {'loss': [0.3370264035463333], 'acc': [0.8499999904632568]}
Saved model to disk


12

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.3399 - acc: 0.8594
100/100 [==============================] - 3s 28ms/step - loss: 0.3439 - acc: 0.8500

Test accuracy: 72.95149215465081

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  8064

choose_one :  11438

F1score :  0.750130263843494

AUC :  0.8083655243630203

Confusion Matrix
[[6309 3520]
 [1755 7918]]
True label 0
0.6418760809848407  
0.3581239190151592  
True label 1
0.1814328543368138  
0.8185671456631862  

Train_result {'loss': [0.3438676404953003], 'acc': [0.8499999928474427]}
Saved model to disk


13

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.3730 - acc: 0.8125
100/100 [==============================] - 2s 23ms/step - loss: 0.3348 - acc: 0.8500

Test accuracy: 73.5309199056507

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  9685

choose_one :  9817

F1score :  0.7351462288353001

AUC :  0.8041936266573164

Confusion Matrix
[[7176 2653]
 [2509 7164]]
True label 0
0.7300844439922678  
0.2699155560077322  
True label 1
0.25938178434818565  
0.7406182156518143  

Train_result {'loss': [0.33476610779762267], 'acc': [0.8500000071525574]}
Saved model to disk


14

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.2353 - acc: 0.9531
100/100 [==============================] - 1s 12ms/step - loss: 0.2659 - acc: 0.9300

Test accuracy: 72.32078761152702

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  6989

choose_one :  12513

F1score :  0.7566934102587216

AUC :  0.7972757917233657

Confusion Matrix
[[5710 4119]
 [1279 8394]]
True label 0
0.5809339709024316  
0.4190660290975684  
True label 1
0.1322237154967435  
0.8677762845032565  

Train_result {'loss': [0.26585891485214236], 'acc': [0.9300000023841858]}
Saved model to disk


15

Epoch 1/1

 64/100 [==================>...........] - ETA: 0s - loss: 0.3289 - acc: 0.8125
100/100 [==============================] - 2s 18ms/step - loss: 0.3026 - acc: 0.8500

Test accuracy: 72.41308583735001

data size :  19602

zero :  9884

one :  9718

train_zero :  55

train_one :  45

test_zero :  9829

test_one :  9673

choose_zero :  7057

choose_one :  12445

F1score :  0.7567592006510535

AUC :  0.79858727000235

Confusion Matrix
[[5753 4076]
 [1304 8369]]
True label 0
0.5853087801404009  
0.41469121985959917  
True label 1
0.134808229091285  
0.865191770908715  

Train_result {'loss': [0.3026378583908081], 'acc': [0.8500000071525574]}
Saved model to disk


[[52.456158342734085, 1], [64.53184288790894, 2], [71.42344374935904, 3], [71.66957235155368, 4], [71.25423033535021, 5], [72.00799917957133, 6], [72.4233411957748, 7], [71.49523125833248, 8], [70.30048200184596, 9], [73.0848118141729, 10], [73.00789662598707, 11], [72.95149215465081, 12], [73.5309199056507, 13], [72.32078761152702, 14], [72.41308583735001, 15]]
max accuracy :  [73.5309199056507, 13]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:44: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-11 03:37:18.926221: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-11 03:37:18.938105: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-11 03:37:18.940776: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xb04b420 executing computations on platform Host. Devices:
2019-10-11 03:37:18.940820: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

Second data
zero :  10049
one :  10279

hbase-code
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

300
hbase-AST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778
After balance out data.
hbase-AST

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 300, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 300, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 621, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            258         dense_1[0][0]                    
==================================================================================================
Total params: 304,514
Trainable params: 304,514
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 59s - loss: 0.8837 - acc: 0.4219
 128/1000 [==>...........................] - ETA: 32s - loss: 0.8118 - acc: 0.4844
 192/1000 [====>.........................] - ETA: 23s - loss: 0.8656 - acc: 0.4479
 256/1000 [======>.......................] - ETA: 18s - loss: 0.8348 - acc: 0.4609
 320/1000 [========>.....................] - ETA: 15s - loss: 0.8130 - acc: 0.4656
 384/1000 [==========>...................] - ETA: 12s - loss: 0.7921 - acc: 0.4844
 448/1000 [============>.................] - ETA: 10s - loss: 0.7711 - acc: 0.5045
 512/1000 [==============>...............] - ETA: 9s - loss: 0.7712 - acc: 0.5078 
 576/1000 [================>.............] - ETA: 7s - loss: 0.7562 - acc: 0.5260
 640/1000 [==================>...........] - ETA: 6s - loss: 0.7556 - acc: 0.5312
 704/1000 [====================>.........] - ETA: 4s - loss: 0.7522 - acc: 0.5312
 768/1000 [======================>.......] - ETA: 3s - loss: 0.7455 - acc: 0.5339
 832/1000 [=======================>......] - ETA: 2s - loss: 0.7410 - acc: 0.5349
 896/1000 [=========================>....] - ETA: 1s - loss: 0.7338 - acc: 0.5379
 960/1000 [===========================>..] - ETA: 0s - loss: 0.7261 - acc: 0.5469
1000/1000 [==============================] - 15s 15ms/step - loss: 0.7215 - acc: 0.5500

Test accuracy: 67.25993377483444

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7282

choose_one :  12046

F1score :  0.7100439882697948

AUC :  0.7457741869502966

Confusion Matrix
[[5252 4298]
 [2030 7748]]
True label 0
0.5499476439790576  
0.4500523560209424  
True label 1
0.20760891797913683  
0.7923910820208632  

Train_result {'acc': [0.55], 'loss': [0.7214656381607055]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.6623 - acc: 0.5781
 128/1000 [==>...........................] - ETA: 10s - loss: 0.6203 - acc: 0.6641
 192/1000 [====>.........................] - ETA: 9s - loss: 0.6215 - acc: 0.6510 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.6211 - acc: 0.6680
 320/1000 [========>.....................] - ETA: 7s - loss: 0.6388 - acc: 0.6375
 384/1000 [==========>...................] - ETA: 7s - loss: 0.6384 - acc: 0.6432
 448/1000 [============>.................] - ETA: 6s - loss: 0.6367 - acc: 0.6384
 512/1000 [==============>...............] - ETA: 5s - loss: 0.6451 - acc: 0.6406
 576/1000 [================>.............] - ETA: 4s - loss: 0.6452 - acc: 0.6476
 640/1000 [==================>...........] - ETA: 4s - loss: 0.6361 - acc: 0.6516
 704/1000 [====================>.........] - ETA: 3s - loss: 0.6391 - acc: 0.6477
 768/1000 [======================>.......] - ETA: 2s - loss: 0.6339 - acc: 0.6549
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6233 - acc: 0.6647
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6255 - acc: 0.6629
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6274 - acc: 0.6625
1000/1000 [==============================] - 11s 11ms/step - loss: 0.6211 - acc: 0.6680

Test accuracy: 69.97102649006622

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11610

choose_one :  7718

F1score :  0.6682670324645633

AUC :  0.776557021371837

Confusion Matrix
[[7678 1872]
 [3932 5846]]
True label 0
0.803979057591623  
0.19602094240837697  
True label 1
0.4021272243812641  
0.597872775618736  

Train_result {'acc': [0.6680000004768372], 'loss': [0.6211008474826812]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5340 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5316 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5492 - acc: 0.7083 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.5467 - acc: 0.7188
 320/1000 [========>.....................] - ETA: 7s - loss: 0.5758 - acc: 0.7031
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5661 - acc: 0.7109
 448/1000 [============>.................] - ETA: 6s - loss: 0.5615 - acc: 0.7143
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5665 - acc: 0.7090
 576/1000 [================>.............] - ETA: 4s - loss: 0.5746 - acc: 0.7049
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5741 - acc: 0.7063
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5804 - acc: 0.7031
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5877 - acc: 0.6979
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5921 - acc: 0.6899
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5981 - acc: 0.6853
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5905 - acc: 0.6927
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5943 - acc: 0.6910

Test accuracy: 72.06125827814569

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8616

choose_one :  10712

F1score :  0.7364568081991214

AUC :  0.7971842602101736

Confusion Matrix
[[6383 3167]
 [2233 7545]]
True label 0
0.6683769633507853  
0.33162303664921466  
True label 1
0.22836980977705051  
0.7716301902229494  

Train_result {'acc': [0.6909999990463257], 'loss': [0.594347092628479]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5644 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 10s - loss: 0.6118 - acc: 0.6250
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5720 - acc: 0.6927 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.5660 - acc: 0.6836
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5548 - acc: 0.7000
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5564 - acc: 0.6901
 448/1000 [============>.................] - ETA: 6s - loss: 0.5552 - acc: 0.6853
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5489 - acc: 0.6973
 576/1000 [================>.............] - ETA: 4s - loss: 0.5679 - acc: 0.6858
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5637 - acc: 0.6906
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5605 - acc: 0.6974
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5601 - acc: 0.6927
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5537 - acc: 0.6971
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5535 - acc: 0.6987
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5566 - acc: 0.6990
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5583 - acc: 0.6960

Test accuracy: 71.8905215231788

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11673

choose_one :  7655

F1score :  0.6883496816382724

AUC :  0.8044815907920227

Confusion Matrix
[[7895 1655]
 [3778 6000]]
True label 0
0.8267015706806282  
0.17329842931937173  
True label 1
0.3863775823276744  
0.6136224176723256  

Train_result {'acc': [0.696], 'loss': [0.5582949485778809]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5424 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5311 - acc: 0.7109
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5797 - acc: 0.6719 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.5980 - acc: 0.6602
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5933 - acc: 0.6562
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5815 - acc: 0.6745
 448/1000 [============>.................] - ETA: 6s - loss: 0.5649 - acc: 0.6920
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5639 - acc: 0.6973
 576/1000 [================>.............] - ETA: 5s - loss: 0.5689 - acc: 0.6944
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5697 - acc: 0.6953
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5620 - acc: 0.6989
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5589 - acc: 0.7031
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5564 - acc: 0.7067
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5576 - acc: 0.7065
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5578 - acc: 0.7063
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5547 - acc: 0.7090

Test accuracy: 73.37541390728477

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9222

choose_one :  10106

F1score :  0.7411989539328103

AUC :  0.8079594912823852

Confusion Matrix
[[6813 2737]
 [2409 7369]]
True label 0
0.7134031413612566  
0.28659685863874346  
True label 1
0.24636940069543875  
0.7536305993045612  

Train_result {'acc': [0.7089999990463257], 'loss': [0.5546525342464447]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.6436 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 10s - loss: 0.6041 - acc: 0.6797
 192/1000 [====>.........................] - ETA: 9s - loss: 0.6107 - acc: 0.7083 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.5954 - acc: 0.6992
 320/1000 [========>.....................] - ETA: 8s - loss: 0.5728 - acc: 0.7031
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5747 - acc: 0.7031
 448/1000 [============>.................] - ETA: 6s - loss: 0.5815 - acc: 0.6964
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5597 - acc: 0.7188
 576/1000 [================>.............] - ETA: 4s - loss: 0.5627 - acc: 0.7170
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5554 - acc: 0.7188
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5441 - acc: 0.7301
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5371 - acc: 0.7409
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5372 - acc: 0.7404
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5398 - acc: 0.7344
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5409 - acc: 0.7312
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5362 - acc: 0.7320

Test accuracy: 72.89942052980133

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11660

choose_one :  7668

F1score :  0.6997592571363064

AUC :  0.8167826373769944

Confusion Matrix
[[7986 1564]
 [3674 6104]]
True label 0
0.8362303664921465  
0.1637696335078534  
True label 1
0.37574146042135403  
0.624258539578646  

Train_result {'acc': [0.732], 'loss': [0.5361811578273773]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.5870 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 10s - loss: 0.5540 - acc: 0.7266
 192/1000 [====>.........................] - ETA: 9s - loss: 0.5549 - acc: 0.7396 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.5232 - acc: 0.7578
 320/1000 [========>.....................] - ETA: 7s - loss: 0.5088 - acc: 0.7750
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5306 - acc: 0.7396
 448/1000 [============>.................] - ETA: 6s - loss: 0.5236 - acc: 0.7478
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5245 - acc: 0.7422
 576/1000 [================>.............] - ETA: 4s - loss: 0.5158 - acc: 0.7448
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5134 - acc: 0.7469
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5027 - acc: 0.7599
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5075 - acc: 0.7539
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5035 - acc: 0.7560
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5041 - acc: 0.7545
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5008 - acc: 0.7510
1000/1000 [==============================] - 12s 12ms/step - loss: 0.5040 - acc: 0.7490

Test accuracy: 72.72350993377484

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12550

choose_one :  6778

F1score :  0.6815655955544818

AUC :  0.8207175687701529

Confusion Matrix
[[8414 1136]
 [4136 5642]]
True label 0
0.8810471204188481  
0.11895287958115183  
True label 1
0.4229903865821231  
0.5770096134178768  

Train_result {'acc': [0.7489999995231629], 'loss': [0.5039724564552307]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.4676 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 10s - loss: 0.4901 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 9s - loss: 0.4763 - acc: 0.7656 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.4702 - acc: 0.7773
 320/1000 [========>.....................] - ETA: 7s - loss: 0.5025 - acc: 0.7594
 384/1000 [==========>...................] - ETA: 7s - loss: 0.5073 - acc: 0.7370
 448/1000 [============>.................] - ETA: 6s - loss: 0.5020 - acc: 0.7388
 512/1000 [==============>...............] - ETA: 5s - loss: 0.5011 - acc: 0.7402
 576/1000 [================>.............] - ETA: 4s - loss: 0.5039 - acc: 0.7326
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4886 - acc: 0.7469
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4879 - acc: 0.7443
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4891 - acc: 0.7461
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4880 - acc: 0.7476
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4872 - acc: 0.7467
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4897 - acc: 0.7469
1000/1000 [==============================] - 12s 12ms/step - loss: 0.4893 - acc: 0.7470

Test accuracy: 74.24979304635761

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9485

choose_one :  9843

F1score :  0.7463432037103104

AUC :  0.8221770691551393

Confusion Matrix
[[7029 2521]
 [2456 7322]]
True label 0
0.736020942408377  
0.26397905759162305  
True label 1
0.25117610963387194  
0.7488238903661281  

Train_result {'acc': [0.747], 'loss': [0.4892920117378235]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5136 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 10s - loss: 0.4791 - acc: 0.7266
 192/1000 [====>.........................] - ETA: 9s - loss: 0.4644 - acc: 0.7604 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.4993 - acc: 0.7461
 320/1000 [========>.....................] - ETA: 8s - loss: 0.4820 - acc: 0.7688
 384/1000 [==========>...................] - ETA: 7s - loss: 0.4878 - acc: 0.7604
 448/1000 [============>.................] - ETA: 6s - loss: 0.4791 - acc: 0.7679
 512/1000 [==============>...............] - ETA: 5s - loss: 0.4656 - acc: 0.7812
 576/1000 [================>.............] - ETA: 5s - loss: 0.4689 - acc: 0.7691
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4734 - acc: 0.7719
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4798 - acc: 0.7670
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4840 - acc: 0.7617
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4768 - acc: 0.7620
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4778 - acc: 0.7600
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4750 - acc: 0.7615
1000/1000 [==============================] - 12s 12ms/step - loss: 0.4734 - acc: 0.7630

Test accuracy: 74.93791390728477

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9900

choose_one :  9428

F1score :  0.7477871498490055

AUC :  0.8273354597723921

Confusion Matrix
[[7303 2247]
 [2597 7181]]
True label 0
0.7647120418848168  
0.23528795811518324  
True label 1
0.26559623644917163  
0.7344037635508284  

Train_result {'acc': [0.7630000004768371], 'loss': [0.4733790531158447]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4495 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 10s - loss: 0.4343 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 9s - loss: 0.4763 - acc: 0.7656 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.4631 - acc: 0.7812
 320/1000 [========>.....................] - ETA: 8s - loss: 0.4626 - acc: 0.7812
 384/1000 [==========>...................] - ETA: 7s - loss: 0.4484 - acc: 0.7943
 448/1000 [============>.................] - ETA: 6s - loss: 0.4503 - acc: 0.7857
 512/1000 [==============>...............] - ETA: 5s - loss: 0.4453 - acc: 0.7852
 576/1000 [================>.............] - ETA: 4s - loss: 0.4448 - acc: 0.7865
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4428 - acc: 0.7844
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4409 - acc: 0.7898
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4323 - acc: 0.7943
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4329 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4297 - acc: 0.7913
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4277 - acc: 0.7927
1000/1000 [==============================] - 12s 12ms/step - loss: 0.4300 - acc: 0.7920

Test accuracy: 75.31560430463577

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10203

choose_one :  9125

F1score :  0.7476062000740623

AUC :  0.8282432675554376

Confusion Matrix
[[7491 2059]
 [2712 7066]]
True label 0
0.7843979057591624  
0.2156020942408377  
True label 1
0.2773573327878912  
0.7226426672121088  

Train_result {'acc': [0.7919999990463257], 'loss': [0.42997618675231936]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.4538 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 10s - loss: 0.4407 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 9s - loss: 0.4226 - acc: 0.8125 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.4187 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 7s - loss: 0.4311 - acc: 0.8094
 384/1000 [==========>...................] - ETA: 7s - loss: 0.4211 - acc: 0.8125
 448/1000 [============>.................] - ETA: 6s - loss: 0.4133 - acc: 0.8214
 512/1000 [==============>...............] - ETA: 5s - loss: 0.4110 - acc: 0.8203
 576/1000 [================>.............] - ETA: 4s - loss: 0.4248 - acc: 0.8090
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4236 - acc: 0.8094
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4272 - acc: 0.8026
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4325 - acc: 0.7995
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4335 - acc: 0.7993
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4305 - acc: 0.7991
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4274 - acc: 0.7979
1000/1000 [==============================] - 12s 12ms/step - loss: 0.4225 - acc: 0.8010

Test accuracy: 75.52255794701986

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10539

choose_one :  8789

F1score :  0.7451930845047665

AUC :  0.8300722478820389

Confusion Matrix
[[7679 1871]
 [2860 6918]]
True label 0
0.8040837696335078  
0.19591623036649214  
True label 1
0.29249335242380853  
0.7075066475761914  

Train_result {'acc': [0.801], 'loss': [0.4224943242073059]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.3945 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 10s - loss: 0.3569 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 9s - loss: 0.3451 - acc: 0.8594 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.3745 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 7s - loss: 0.3919 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3917 - acc: 0.8385
 448/1000 [============>.................] - ETA: 6s - loss: 0.3982 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 5s - loss: 0.4029 - acc: 0.8262
 576/1000 [================>.............] - ETA: 4s - loss: 0.4065 - acc: 0.8212
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4047 - acc: 0.8187
 704/1000 [====================>.........] - ETA: 3s - loss: 0.4027 - acc: 0.8196
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4095 - acc: 0.8125
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4087 - acc: 0.8149
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3984 - acc: 0.8214
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3984 - acc: 0.8198
1000/1000 [==============================] - 12s 12ms/step - loss: 0.3970 - acc: 0.8230

Test accuracy: 75.04139072847681

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10634

choose_one :  8694

F1score :  0.7388479861411867

AUC :  0.8281056737049407

Confusion Matrix
[[7680 1870]
 [2954 6824]]
True label 0
0.8041884816753927  
0.19581151832460733  
True label 1
0.302106770300675  
0.697893229699325  

Train_result {'acc': [0.8229999990463257], 'loss': [0.39702239966392516]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4168 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 10s - loss: 0.3973 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 9s - loss: 0.3902 - acc: 0.8125 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.3669 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 7s - loss: 0.3722 - acc: 0.8250
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3540 - acc: 0.8411
 448/1000 [============>.................] - ETA: 6s - loss: 0.3580 - acc: 0.8371
 512/1000 [==============>...............] - ETA: 5s - loss: 0.3675 - acc: 0.8203
 576/1000 [================>.............] - ETA: 4s - loss: 0.3753 - acc: 0.8194
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3790 - acc: 0.8203
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3640 - acc: 0.8310
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3805 - acc: 0.8229
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3712 - acc: 0.8269
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3831 - acc: 0.8248
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3832 - acc: 0.8219
1000/1000 [==============================] - 12s 12ms/step - loss: 0.3832 - acc: 0.8220

Test accuracy: 72.81146523178808

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  13057

choose_one :  6271

F1score :  0.6725652688641036

AUC :  0.834400770401339

Confusion Matrix
[[8676  874]
 [4381 5397]]
True label 0
0.9084816753926701  
0.09151832460732984  
True label 1
0.4480466353037431  
0.5519533646962569  

Train_result {'acc': [0.8219999995231628], 'loss': [0.383173743724823]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.4229 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 10s - loss: 0.4816 - acc: 0.7656
 192/1000 [====>.........................] - ETA: 9s - loss: 0.4659 - acc: 0.7760 
 256/1000 [======>.......................] - ETA: 8s - loss: 0.4415 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 8s - loss: 0.4304 - acc: 0.7969
 384/1000 [==========>...................] - ETA: 7s - loss: 0.4177 - acc: 0.8021
 448/1000 [============>.................] - ETA: 6s - loss: 0.4309 - acc: 0.7991
 512/1000 [==============>...............] - ETA: 5s - loss: 0.4260 - acc: 0.8008
 576/1000 [================>.............] - ETA: 4s - loss: 0.4062 - acc: 0.8108
 640/1000 [==================>...........] - ETA: 4s - loss: 0.4000 - acc: 0.8172
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3877 - acc: 0.8253
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3992 - acc: 0.8164
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3939 - acc: 0.8209
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4024 - acc: 0.8192
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4078 - acc: 0.8177
1000/1000 [==============================] - 12s 12ms/step - loss: 0.4051 - acc: 0.8180

Test accuracy: 75.99855132450331

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9699

choose_one :  9629

F1score :  0.7609625392899468

AUC :  0.8351674503827912

Confusion Matrix
[[7305 2245]
 [2394 7384]]
True label 0
0.7649214659685863  
0.2350785340314136  
True label 1
0.24483534465125792  
0.7551646553487421  

Train_result {'acc': [0.8179999995231628], 'loss': [0.405120016336441]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.2983 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 11s - loss: 0.2933 - acc: 0.9141
 192/1000 [====>.........................] - ETA: 10s - loss: 0.3297 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 9s - loss: 0.3500 - acc: 0.8477 
 320/1000 [========>.....................] - ETA: 8s - loss: 0.3431 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 7s - loss: 0.3293 - acc: 0.8542
 448/1000 [============>.................] - ETA: 6s - loss: 0.3351 - acc: 0.8460
 512/1000 [==============>...............] - ETA: 5s - loss: 0.3438 - acc: 0.8398
 576/1000 [================>.............] - ETA: 4s - loss: 0.3341 - acc: 0.8490
 640/1000 [==================>...........] - ETA: 4s - loss: 0.3319 - acc: 0.8484
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3299 - acc: 0.8466
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3291 - acc: 0.8438
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3288 - acc: 0.8425
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3246 - acc: 0.8482
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3382 - acc: 0.8458
1000/1000 [==============================] - 12s 12ms/step - loss: 0.3450 - acc: 0.8420

Test accuracy: 76.30380794701986

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9064

choose_one :  10264

F1score :  0.7714798922263247

AUC :  0.8405647628665269

Confusion Matrix
[[7017 2533]
 [2047 7731]]
True label 0
0.7347643979057592  
0.26523560209424085  
True label 1
0.20934751482920844  
0.7906524851707916  

Train_result {'acc': [0.842], 'loss': [0.3449661583900452]}
Saved model to disk


[[67.25993377483444, 1], [69.97102649006622, 2], [72.06125827814569, 3], [71.8905215231788, 4], [73.37541390728477, 5], [72.89942052980133, 6], [72.72350993377484, 7], [74.24979304635761, 8], [74.93791390728477, 9], [75.31560430463577, 10], [75.52255794701986, 11], [75.04139072847681, 12], [72.81146523178808, 13], [75.99855132450331, 14], [76.30380794701986, 15]]
max accuracy :  [76.30380794701986, 15]

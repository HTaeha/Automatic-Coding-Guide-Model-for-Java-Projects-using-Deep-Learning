Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-10 12:22:53.780158: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-10 12:22:53.792338: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099865000 Hz
2019-10-10 12:22:53.794899: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8435230 executing computations on platform Host. Devices:
2019-10-10 12:22:53.794934: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

hbase-code
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 36

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 866
Over 150, Under 200 : 416
Over 200, Under 400 : 238
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 36

Under 10 : 4078
Over 10, Under 30 : 8257
Over 30, Under 100 : 6473
Over 100, Under 150 : 866
Over 150, Under 200 : 416
Over 200, Under 400 : 238
Over 400 : 0

281
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 281, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 281, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 28s - loss: 0.7028 - acc: 0.5312
 128/1000 [==>...........................] - ETA: 16s - loss: 0.6849 - acc: 0.5703
 192/1000 [====>.........................] - ETA: 11s - loss: 0.7065 - acc: 0.5365
 256/1000 [======>.......................] - ETA: 9s - loss: 0.7031 - acc: 0.5391 
 320/1000 [========>.....................] - ETA: 7s - loss: 0.6859 - acc: 0.5563
 384/1000 [==========>...................] - ETA: 6s - loss: 0.6748 - acc: 0.5703
 448/1000 [============>.................] - ETA: 5s - loss: 0.6795 - acc: 0.5759
 512/1000 [==============>...............] - ETA: 4s - loss: 0.6659 - acc: 0.5840
 576/1000 [================>.............] - ETA: 3s - loss: 0.6676 - acc: 0.5885
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6725 - acc: 0.5859
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6673 - acc: 0.5909
 768/1000 [======================>.......] - ETA: 1s - loss: 0.6708 - acc: 0.5911
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6636 - acc: 0.5986
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6642 - acc: 0.5971
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6677 - acc: 0.5979
1000/1000 [==============================] - 8s 8ms/step - loss: 0.6637 - acc: 0.6030

Test accuracy: 69.5105546357616

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8555

choose_one :  10773

F1score :  0.7132499635054256

AUC :  0.7711131785319967

Confusion Matrix
[[6106 3444]
 [2449 7329]]
True label 0
0.6393717277486911  
0.3606282722513089  
True label 1
0.25046021681325426  
0.7495397831867457  

Train_result {'loss': [0.6637142186164856], 'acc': [0.6030000009536743]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.6101 - acc: 0.6094
 128/1000 [==>...........................] - ETA: 5s - loss: 0.5801 - acc: 0.6641
 192/1000 [====>.........................] - ETA: 5s - loss: 0.5889 - acc: 0.6667
 256/1000 [======>.......................] - ETA: 4s - loss: 0.5746 - acc: 0.6953
 320/1000 [========>.....................] - ETA: 4s - loss: 0.5699 - acc: 0.7063
 384/1000 [==========>...................] - ETA: 3s - loss: 0.5554 - acc: 0.7083
 448/1000 [============>.................] - ETA: 3s - loss: 0.5598 - acc: 0.7098
 512/1000 [==============>...............] - ETA: 3s - loss: 0.5608 - acc: 0.7051
 576/1000 [================>.............] - ETA: 2s - loss: 0.5665 - acc: 0.6962
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5763 - acc: 0.6891
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5743 - acc: 0.6946
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5719 - acc: 0.6979
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5713 - acc: 0.6947
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5762 - acc: 0.6897
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5772 - acc: 0.6906
1000/1000 [==============================] - 7s 7ms/step - loss: 0.5717 - acc: 0.6950

Test accuracy: 71.69391556291392

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10207

choose_one :  9121

F1score :  0.7105137837980844

AUC :  0.7908776460458835

Confusion Matrix
[[7143 2407]
 [3064 6714]]
True label 0
0.7479581151832461  
0.25204188481675394  
True label 1
0.3133565146246676  
0.6866434853753324  

Train_result {'loss': [0.5717152578830719], 'acc': [0.6950000004768372]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.5281 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 5s - loss: 0.5141 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 5s - loss: 0.5186 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 5s - loss: 0.5162 - acc: 0.7461
 320/1000 [========>.....................] - ETA: 4s - loss: 0.5064 - acc: 0.7562
 384/1000 [==========>...................] - ETA: 4s - loss: 0.5126 - acc: 0.7448
 448/1000 [============>.................] - ETA: 3s - loss: 0.5081 - acc: 0.7455
 512/1000 [==============>...............] - ETA: 3s - loss: 0.5016 - acc: 0.7520
 576/1000 [================>.............] - ETA: 2s - loss: 0.5131 - acc: 0.7431
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5197 - acc: 0.7406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5232 - acc: 0.7358
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5322 - acc: 0.7253
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5336 - acc: 0.7236
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5352 - acc: 0.7221
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5335 - acc: 0.7240
1000/1000 [==============================] - 7s 7ms/step - loss: 0.5279 - acc: 0.7300

Test accuracy: 67.50310430463577

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  5279

choose_one :  14049

F1score :  0.7363914886473328

AUC :  0.793002664384948

Confusion Matrix
[[4274 5276]
 [1005 8773]]
True label 0
0.4475392670157068  
0.5524607329842932  
True label 1
0.10278175496011455  
0.8972182450398855  

Train_result {'loss': [0.5279311158657074], 'acc': [0.73]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.5675 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 5s - loss: 0.4965 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 5s - loss: 0.5190 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 4s - loss: 0.5184 - acc: 0.7383
 320/1000 [========>.....................] - ETA: 4s - loss: 0.5160 - acc: 0.7312
 384/1000 [==========>...................] - ETA: 3s - loss: 0.5249 - acc: 0.7214
 448/1000 [============>.................] - ETA: 3s - loss: 0.5227 - acc: 0.7344
 512/1000 [==============>...............] - ETA: 3s - loss: 0.5299 - acc: 0.7246
 576/1000 [================>.............] - ETA: 2s - loss: 0.5269 - acc: 0.7240
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5230 - acc: 0.7266
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5191 - acc: 0.7287
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5126 - acc: 0.7305
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5176 - acc: 0.7296
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5169 - acc: 0.7299
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5226 - acc: 0.7281
1000/1000 [==============================] - 7s 7ms/step - loss: 0.5398 - acc: 0.7190

Test accuracy: 72.40790562913907

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7797

choose_one :  11531

F1score :  0.7497301609648505

AUC :  0.805637492650988

Confusion Matrix
[[6007 3543]
 [1790 7988]]
True label 0
0.6290052356020942  
0.37099476439790574  
True label 1
0.1830640212722438  
0.8169359787277561  

Train_result {'loss': [0.5398399171829223], 'acc': [0.719]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.5502 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 5s - loss: 0.5370 - acc: 0.7109
 192/1000 [====>.........................] - ETA: 5s - loss: 0.5421 - acc: 0.6875
 256/1000 [======>.......................] - ETA: 4s - loss: 0.5398 - acc: 0.7070
 320/1000 [========>.....................] - ETA: 4s - loss: 0.5473 - acc: 0.7188
 384/1000 [==========>...................] - ETA: 4s - loss: 0.5268 - acc: 0.7370
 448/1000 [============>.................] - ETA: 3s - loss: 0.5294 - acc: 0.7366
 512/1000 [==============>...............] - ETA: 3s - loss: 0.5272 - acc: 0.7402
 576/1000 [================>.............] - ETA: 2s - loss: 0.5289 - acc: 0.7396
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5274 - acc: 0.7391
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5221 - acc: 0.7401
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5177 - acc: 0.7409
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5065 - acc: 0.7488
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5072 - acc: 0.7545
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5075 - acc: 0.7552
1000/1000 [==============================] - 7s 7ms/step - loss: 0.5093 - acc: 0.7520

Test accuracy: 65.40252483443709

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  15319

choose_one :  4009

F1score :  0.5149778777108871

AUC :  0.7933721978712764

Confusion Matrix
[[9091  459]
 [6228 3550]]
True label 0
0.9519371727748691  
0.04806282722513089  
True label 1
0.636940069543874  
0.363059930456126  

Train_result {'loss': [0.5092919030189514], 'acc': [0.7520000004768371]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.5261 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 6s - loss: 0.4836 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 5s - loss: 0.4785 - acc: 0.7500
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4958 - acc: 0.7500
 320/1000 [========>.....................] - ETA: 4s - loss: 0.4984 - acc: 0.7438
 384/1000 [==========>...................] - ETA: 4s - loss: 0.5012 - acc: 0.7448
 448/1000 [============>.................] - ETA: 3s - loss: 0.5076 - acc: 0.7455
 512/1000 [==============>...............] - ETA: 3s - loss: 0.5098 - acc: 0.7402
 576/1000 [================>.............] - ETA: 2s - loss: 0.5080 - acc: 0.7413
 640/1000 [==================>...........] - ETA: 2s - loss: 0.5012 - acc: 0.7406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4991 - acc: 0.7415
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4978 - acc: 0.7422
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4969 - acc: 0.7428
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4940 - acc: 0.7455
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4943 - acc: 0.7458
1000/1000 [==============================] - 7s 7ms/step - loss: 0.4919 - acc: 0.7480

Test accuracy: 73.69101821192054

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9397

choose_one :  9931

F1score :  0.7419960424171699

AUC :  0.8150466856357739

Confusion Matrix
[[6931 2619]
 [2466 7312]]
True label 0
0.7257591623036649  
0.27424083769633506  
True label 1
0.25219881366332586  
0.7478011863366741  

Train_result {'loss': [0.49190887475013734], 'acc': [0.7480000004768371]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.3549 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3614 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 5s - loss: 0.4077 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4303 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 4s - loss: 0.4413 - acc: 0.8125
 384/1000 [==========>...................] - ETA: 4s - loss: 0.4502 - acc: 0.8073
 448/1000 [============>.................] - ETA: 3s - loss: 0.4639 - acc: 0.7879
 512/1000 [==============>...............] - ETA: 3s - loss: 0.4700 - acc: 0.7871
 576/1000 [================>.............] - ETA: 2s - loss: 0.4656 - acc: 0.7934
 640/1000 [==================>...........] - ETA: 2s - loss: 0.4689 - acc: 0.7922
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4638 - acc: 0.7940
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4671 - acc: 0.7865
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4715 - acc: 0.7873
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4789 - acc: 0.7790
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4857 - acc: 0.7771
1000/1000 [==============================] - 7s 7ms/step - loss: 0.4839 - acc: 0.7770

Test accuracy: 73.71171357615894

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11053

choose_one :  8275

F1score :  0.718550933362876

AUC :  0.8183169932715713

Confusion Matrix
[[7761 1789]
 [3292 6486]]
True label 0
0.8126701570680628  
0.18732984293193716  
True label 1
0.336674166496216  
0.663325833503784  

Train_result {'loss': [0.4838640503883362], 'acc': [0.7769999990463257]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.4076 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 5s - loss: 0.4067 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 5s - loss: 0.4762 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4645 - acc: 0.7695
 320/1000 [========>.....................] - ETA: 4s - loss: 0.4610 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 3s - loss: 0.4529 - acc: 0.7604
 448/1000 [============>.................] - ETA: 3s - loss: 0.4579 - acc: 0.7634
 512/1000 [==============>...............] - ETA: 3s - loss: 0.4687 - acc: 0.7637
 576/1000 [================>.............] - ETA: 2s - loss: 0.4707 - acc: 0.7639
 640/1000 [==================>...........] - ETA: 2s - loss: 0.4628 - acc: 0.7719
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4706 - acc: 0.7656
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4630 - acc: 0.7734
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4607 - acc: 0.7764
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4655 - acc: 0.7723
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4674 - acc: 0.7698
1000/1000 [==============================] - 7s 7ms/step - loss: 0.4693 - acc: 0.7680

Test accuracy: 74.2239238410596

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8876

choose_one :  10452

F1score :  0.7537320810677212

AUC :  0.8205391203031916

Confusion Matrix
[[6722 2828]
 [2154 7624]]
True label 0
0.7038743455497383  
0.2961256544502618  
True label 1
0.2202904479443649  
0.7797095520556351  

Train_result {'loss': [0.46932435274124146], 'acc': [0.7680000009536743]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.4463 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 5s - loss: 0.4462 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 5s - loss: 0.4735 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4572 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 4s - loss: 0.4408 - acc: 0.8063
 384/1000 [==========>...................] - ETA: 3s - loss: 0.4776 - acc: 0.7812
 448/1000 [============>.................] - ETA: 3s - loss: 0.4775 - acc: 0.7790
 512/1000 [==============>...............] - ETA: 3s - loss: 0.4610 - acc: 0.7910
 576/1000 [================>.............] - ETA: 2s - loss: 0.4569 - acc: 0.7865
 640/1000 [==================>...........] - ETA: 2s - loss: 0.4575 - acc: 0.7844
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4556 - acc: 0.7812
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4544 - acc: 0.7799
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4514 - acc: 0.7800
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4475 - acc: 0.7835
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4469 - acc: 0.7865
1000/1000 [==============================] - 6s 6ms/step - loss: 0.4469 - acc: 0.7870

Test accuracy: 68.66204470198676

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14247

choose_one :  5081

F1score :  0.5923682616596002

AUC :  0.8100013011365401

Confusion Matrix
[[8870  680]
 [5377 4401]]
True label 0
0.9287958115183246  
0.0712041884816754  
True label 1
0.5499079566373491  
0.45009204336265085  

Train_result {'loss': [0.4468616290092468], 'acc': [0.7870000004768372]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.5512 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 5s - loss: 0.4133 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 5s - loss: 0.4136 - acc: 0.8281
 256/1000 [======>.......................] - ETA: 4s - loss: 0.4218 - acc: 0.8086
 320/1000 [========>.....................] - ETA: 4s - loss: 0.4007 - acc: 0.8219
 384/1000 [==========>...................] - ETA: 3s - loss: 0.4021 - acc: 0.8229
 448/1000 [============>.................] - ETA: 3s - loss: 0.3973 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3918 - acc: 0.8301
 576/1000 [================>.............] - ETA: 2s - loss: 0.3947 - acc: 0.8212
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3993 - acc: 0.8203
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4009 - acc: 0.8182
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4134 - acc: 0.8086
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4072 - acc: 0.8125
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4042 - acc: 0.8114
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4073 - acc: 0.8094
1000/1000 [==============================] - 7s 7ms/step - loss: 0.4055 - acc: 0.8070

Test accuracy: 74.15149006622516

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8046

choose_one :  11282

F1score :  0.7627730294396962

AUC :  0.8221504734959022

Confusion Matrix
[[6300 3250]
 [1746 8032]]
True label 0
0.6596858638743456  
0.3403141361256545  
True label 1
0.17856412354264675  
0.8214358764573533  

Train_result {'loss': [0.4054593749046326], 'acc': [0.807]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 6s - loss: 0.3302 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3249 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 5s - loss: 0.3317 - acc: 0.8646
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3439 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 4s - loss: 0.3558 - acc: 0.8531
 384/1000 [==========>...................] - ETA: 4s - loss: 0.3687 - acc: 0.8359
 448/1000 [============>.................] - ETA: 3s - loss: 0.3899 - acc: 0.8170
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3892 - acc: 0.8184
 576/1000 [================>.............] - ETA: 2s - loss: 0.3889 - acc: 0.8177
 640/1000 [==================>...........] - ETA: 2s - loss: 0.4032 - acc: 0.8109
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4221 - acc: 0.7969
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4177 - acc: 0.7982
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4149 - acc: 0.8017
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4207 - acc: 0.8013
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4232 - acc: 0.8010
1000/1000 [==============================] - 7s 7ms/step - loss: 0.4201 - acc: 0.8030

Test accuracy: 73.82553807947019

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7601

choose_one :  11727

F1score :  0.7647523831667054

AUC :  0.8258455085087905

Confusion Matrix
[[6046 3504]
 [1555 8223]]
True label 0
0.6330890052356021  
0.3669109947643979  
True label 1
0.1590304765800777  
0.8409695234199223  

Train_result {'loss': [0.420125253200531], 'acc': [0.8030000009536743]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.2935 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3373 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 5s - loss: 0.3392 - acc: 0.8542
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3298 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 4s - loss: 0.3236 - acc: 0.8688
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3394 - acc: 0.8646
 448/1000 [============>.................] - ETA: 3s - loss: 0.3546 - acc: 0.8549
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3641 - acc: 0.8496
 576/1000 [================>.............] - ETA: 2s - loss: 0.3729 - acc: 0.8420
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3754 - acc: 0.8406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3756 - acc: 0.8381
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3740 - acc: 0.8385
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3748 - acc: 0.8401
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3771 - acc: 0.8415
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3793 - acc: 0.8427
1000/1000 [==============================] - 7s 7ms/step - loss: 0.3747 - acc: 0.8440

Test accuracy: 75.67777317880795

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9747

choose_one :  9581

F1score :  0.7571672090500543

AUC :  0.8256594781103856

Confusion Matrix
[[7298 2252]
 [2449 7329]]
True label 0
0.7641884816753927  
0.23581151832460734  
True label 1
0.25046021681325426  
0.7495397831867457  

Train_result {'loss': [0.37466713547706604], 'acc': [0.844]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.2977 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3272 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 5s - loss: 0.3330 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3407 - acc: 0.8438
 320/1000 [========>.....................] - ETA: 4s - loss: 0.3565 - acc: 0.8406
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3857 - acc: 0.8177
 448/1000 [============>.................] - ETA: 3s - loss: 0.3844 - acc: 0.8147
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3975 - acc: 0.8105
 576/1000 [================>.............] - ETA: 2s - loss: 0.3957 - acc: 0.8142
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3895 - acc: 0.8172
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3761 - acc: 0.8267
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3752 - acc: 0.8320
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3738 - acc: 0.8341
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3740 - acc: 0.8348
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3703 - acc: 0.8333
1000/1000 [==============================] - 6s 6ms/step - loss: 0.3676 - acc: 0.8350

Test accuracy: 75.22764900662253

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10908

choose_one :  8420

F1score :  0.7368941641938674

AUC :  0.8270079856585839

Confusion Matrix
[[7835 1715]
 [3073 6705]]
True label 0
0.8204188481675393  
0.17958115183246073  
True label 1
0.31427694825117614  
0.6857230517488239  

Train_result {'loss': [0.36760974931716917], 'acc': [0.835]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3671 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3189 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 5s - loss: 0.2931 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3229 - acc: 0.8750
 320/1000 [========>.....................] - ETA: 4s - loss: 0.3177 - acc: 0.8656
 384/1000 [==========>...................] - ETA: 4s - loss: 0.2961 - acc: 0.8802
 448/1000 [============>.................] - ETA: 3s - loss: 0.3012 - acc: 0.8705
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3109 - acc: 0.8652
 576/1000 [================>.............] - ETA: 2s - loss: 0.3356 - acc: 0.8507
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3444 - acc: 0.8469
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3437 - acc: 0.8409
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3447 - acc: 0.8411
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3449 - acc: 0.8413
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3480 - acc: 0.8404
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3485 - acc: 0.8385
1000/1000 [==============================] - 7s 7ms/step - loss: 0.3473 - acc: 0.8410

Test accuracy: 74.7982201986755

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11505

choose_one :  7823

F1score :  0.7232543605476962

AUC :  0.8248238378923087

Confusion Matrix
[[8092 1458]
 [3413 6365]]
True label 0
0.8473298429319371  
0.15267015706806283  
True label 1
0.3490488852526079  
0.6509511147473921  

Train_result {'loss': [0.3472855577468872], 'acc': [0.8409999990463257]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 5s - loss: 0.3147 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 5s - loss: 0.3278 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 5s - loss: 0.3146 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 4s - loss: 0.3024 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 4s - loss: 0.3061 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 3s - loss: 0.3151 - acc: 0.8672
 448/1000 [============>.................] - ETA: 3s - loss: 0.3304 - acc: 0.8549
 512/1000 [==============>...............] - ETA: 3s - loss: 0.3382 - acc: 0.8516
 576/1000 [================>.............] - ETA: 2s - loss: 0.3389 - acc: 0.8455
 640/1000 [==================>...........] - ETA: 2s - loss: 0.3272 - acc: 0.8562
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3213 - acc: 0.8594
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3259 - acc: 0.8568
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3237 - acc: 0.8582
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3180 - acc: 0.8616
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3099 - acc: 0.8688
1000/1000 [==============================] - 7s 7ms/step - loss: 0.3062 - acc: 0.8710

Test accuracy: 74.57574503311258

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11388

choose_one :  7940

F1score :  0.7226549271926853

AUC :  0.8307071329054754

Confusion Matrix
[[8012 1538]
 [3376 6402]]
True label 0
0.8389528795811518  
0.16104712041884817  
True label 1
0.34526488034362857  
0.6547351196563714  

Train_result {'loss': [0.30619936299324035], 'acc': [0.8710000004768371]}
Saved model to disk


[[69.5105546357616, 1], [71.69391556291392, 2], [67.50310430463577, 3], [72.40790562913907, 4], [65.40252483443709, 5], [73.69101821192054, 6], [73.71171357615894, 7], [74.2239238410596, 8], [68.66204470198676, 9], [74.15149006622516, 10], [73.82553807947019, 11], [75.67777317880795, 12], [75.22764900662253, 13], [74.7982201986755, 14], [74.57574503311258, 15]]
max accuracy :  [75.67777317880795, 12]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:354: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-05-26 22:01:45.438861: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-05-26 22:01:45.448248: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-05-26 22:01:45.453582: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5e92d60 executing computations on platform Host. Devices:
2019-05-26 22:01:45.453622: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41596

one : 
17568
guava-CAST_s
all data

Sentence length Average : 50

Under 10 : 5631
Over 10, Under 200 : 52010
Over 200, Under 400 : 1282
Over 400 : 241

guava-CAST_s
updated_train_data

Sentence length Average : 52

Under 10 : 0
Over 10, Under 200 : 46386
Over 200, Under 400 : 1313
Over 400 : 0


Test_zero:  3677
Train_zero:  32970
zero:  36647
Test_one:  1661
Train_one:  14729
one:  16390

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1483s - loss: 0.2926 - acc: 0.8750

Test accuracy: 90.8516400842612

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1820

choose_one :  1503

F1score :  0.9039190897597977

AUC : 0.9724271910778234

Confusion Matrix
[[1589   73]
 [ 231 1430]]
True label 0
0.9560770156438027  
0.043922984356197355  
True label 1
0.1390728476821192  
0.8609271523178808  

Train_result {'loss': [0.29258102642315914], 'acc': [0.8750466750338161]}
Saved model to disk



2

Epoch 1/1
 - 1664s - loss: 0.1935 - acc: 0.9212

Test accuracy: 93.71050255792959

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1721

choose_one :  1602

F1score :  0.9359485136377567

AUC : 0.9846354862851385

Confusion Matrix
[[1587   75]
 [ 134 1527]]
True label 0
0.9548736462093863  
0.04512635379061372  
True label 1
0.0806742925948224  
0.9193257074051776  

Train_result {'loss': [0.19350613198162497], 'acc': [0.9212125326866911]}
Saved model to disk



3

Epoch 1/1
 - 1423s - loss: 0.1477 - acc: 0.9417

Test accuracy: 94.91423412578996

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1679

choose_one :  1644

F1score :  0.9488653555219365

AUC : 0.9873744014849043

Confusion Matrix
[[1586   76]
 [  93 1568]]
True label 0
0.9542719614921781  
0.0457280385078219  
True label 1
0.055990367248645395  
0.9440096327513546  

Train_result {'loss': [0.1476811209890887], 'acc': [0.9416816592693993]}
Saved model to disk



4

Epoch 1/1
 - 1614s - loss: 0.1175 - acc: 0.9549

Test accuracy: 95.63647306650617

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1697

choose_one :  1626

F1score :  0.9558868268938243

AUC : 0.9917031988182202

Confusion Matrix
[[1607   55]
 [  90 1571]]
True label 0
0.96690734055355  
0.03309265944645006  
True label 1
0.054184226369656835  
0.9458157736303432  

Train_result {'loss': [0.1174610614429614], 'acc': [0.9549203978552304]}
Saved model to disk



5

Epoch 1/1
 - 1598s - loss: 0.0926 - acc: 0.9659

Test accuracy: 96.53927174240144

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1687

choose_one :  1636

F1score :  0.965119805884137

AUC : 0.993657496861169

Confusion Matrix
[[1617   45]
 [  70 1591]]
True label 0
0.9729241877256317  
0.02707581227436823  
True label 1
0.04214328717639976  
0.9578567128236002  

Train_result {'loss': [0.09255840728310617], 'acc': [0.9658508435594295]}
Saved model to disk



6

Epoch 1/1
 - 1611s - loss: 0.0771 - acc: 0.9726

Test accuracy: 96.65964489918748

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1675

choose_one :  1648

F1score :  0.9664551223934724

AUC : 0.9949798629419447

Confusion Matrix
[[1613   49]
 [  62 1599]]
True label 0
0.970517448856799  
0.029482551143200964  
True label 1
0.03732691149909693  
0.962673088500903  

Train_result {'loss': [0.07705905458594403], 'acc': [0.9726399402701121]}
Saved model to disk



7

Epoch 1/1
 - 1610s - loss: 0.0614 - acc: 0.9775

Test accuracy: 97.26151068311766

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1669

choose_one :  1654

F1score :  0.9725490196078431

AUC : 0.995758684219487

Confusion Matrix
[[1620   42]
 [  49 1612]]
True label 0
0.9747292418772563  
0.02527075812274368  
True label 1
0.029500301023479832  
0.9704996989765202  

Train_result {'loss': [0.06142807578093774], 'acc': [0.9775280898876404]}
Saved model to disk



8

Epoch 1/1
 - 1626s - loss: 0.0558 - acc: 0.9798

Test accuracy: 97.20132410472465

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1671

choose_one :  1652

F1score :  0.9719287654693631

AUC : 0.9960327206364454

Confusion Matrix
[[1620   42]
 [  51 1610]]
True label 0
0.9747292418772563  
0.02527075812274368  
True label 1
0.030704394942805538  
0.9692956050571945  

Train_result {'loss': [0.05582294262314048], 'acc': [0.9798024372857191]}
Saved model to disk



9

Epoch 1/1
 - 1634s - loss: 0.0486 - acc: 0.9825

Test accuracy: 96.7198314775805

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1611

choose_one :  1712

F1score :  0.967684553809665

AUC : 0.9948056243212483

Confusion Matrix
[[1582   80]
 [  29 1632]]
True label 0
0.9518652226233454  
0.048134777376654635  
True label 1
0.017459361830222758  
0.9825406381697772  

Train_result {'loss': [0.04862822428934779], 'acc': [0.9824501850170485]}
Saved model to disk



10

Epoch 1/1
 - 1711s - loss: 0.0415 - acc: 0.9853

Test accuracy: 97.44207041829672

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1671

choose_one :  1652

F1score :  0.9743434953214609

AUC : 0.9958947062612158

Confusion Matrix
[[1624   38]
 [  47 1614]]
True label 0
0.9771359807460891  
0.02286401925391095  
True label 1
0.028296207104154123  
0.9717037928958459  

Train_result {'loss': [0.04146015100452952], 'acc': [0.9852676601519819]}
Saved model to disk



11

Epoch 1/1
 - 1785s - loss: 0.0388 - acc: 0.9870

Test accuracy: 97.74300331026181

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1665

choose_one :  1658

F1score :  0.977402832178367

AUC : 0.9959334662038656

Confusion Matrix
[[1626   36]
 [  39 1622]]
True label 0
0.9783393501805054  
0.021660649819494584  
True label 1
0.023479831426851294  
0.9765201685731487  

Train_result {'loss': [0.03877157225781799], 'acc': [0.9870328252825962]}
Saved model to disk



12

Epoch 1/1
 - 1777s - loss: 0.0386 - acc: 0.9882

Test accuracy: 97.83328317785134

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1658

choose_one :  1665

F1score :  0.9783523752254961

AUC : 0.9959552007511459

Confusion Matrix
[[1624   38]
 [  34 1627]]
True label 0
0.9771359807460891  
0.02286401925391095  
True label 1
0.020469596628537028  
0.979530403371463  

Train_result {'loss': [0.038620955836377806], 'acc': [0.9881530262398588]}
Saved model to disk



13

Epoch 1/1
 - 1787s - loss: 0.0329 - acc: 0.9892

Test accuracy: 98.0439362022269

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1645

choose_one :  1678

F1score :  0.9805330937406408

AUC : 0.9972259472821311

Confusion Matrix
[[1621   41]
 [  24 1637]]
True label 0
0.9753309265944645  
0.0246690734055355  
True label 1
0.014449127031908489  
0.9855508729680915  

Train_result {'loss': [0.032853342977615246], 'acc': [0.989239281713568]}
Saved model to disk



14

Epoch 1/1
 - 1834s - loss: 0.0298 - acc: 0.9902

Test accuracy: 97.62263015347578

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1633

choose_one :  1690

F1score :  0.9764249477767831

AUC : 0.9962942596887179

Confusion Matrix
[[1608   54]
 [  25 1636]]
True label 0
0.9675090252707581  
0.032490974729241874  
True label 1
0.015051173991571343  
0.9849488260084287  

Train_result {'loss': [0.029764578823451297], 'acc': [0.9901558097695101]}
Saved model to disk



15

Epoch 1/1
 - 1813s - loss: 0.0326 - acc: 0.9903

Test accuracy: 97.86337646704784

data size :  32782

zero :  16392

one :  16390

train_zero :  14730

train_one :  14729

test_zero :  1662

test_one :  1661

choose_zero :  1655

choose_one :  1668

F1score :  0.978672273956143

AUC : 0.9966360354446997

Confusion Matrix
[[1623   39]
 [  32 1629]]
True label 0
0.9765342960288809  
0.023465703971119134  
True label 1
0.01926550270921132  
0.9807344972907887  

Train_result {'loss': [0.03261376300091092], 'acc': [0.9902915917037238]}
Saved model to disk




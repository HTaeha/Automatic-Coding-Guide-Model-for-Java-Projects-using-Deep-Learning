Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-12 20:04:11.776737: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-12 20:04:11.788142: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-12 20:04:11.790465: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xb4d1480 executing computations on platform Host. Devices:
2019-07-12 20:04:11.790504: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41586

one : 
17568
guava-code
all data

Sentence length Average : 42

Under 10 : 4802
Over 10, Under 200 : 53280
Over 200, Under 400 : 940
Over 400 : 132

guava-code
updated_train_data

Sentence length Average : 44

Under 10 : 0
Over 10, Under 200 : 47324
Over 200, Under 400 : 927
Over 400 : 0


Test_zero:  3657
Train_zero:  33456
zero:  37113
Test_one:  1683
Train_one:  14795
one:  16478

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 665s - loss: 0.2701 - acc: 0.8853

Test accuracy: 90.13959013959014

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1620

choose_one :  1747

F1score :  0.9032069970845481

AUC : 0.968630344241634

Confusion Matrix
[[1486  198]
 [ 134 1549]]
True label 0
0.8824228028503563  
0.11757719714964371  
True label 1
0.0796197266785502  
0.9203802733214498  

Train_result {'acc': [0.8853029637168176], 'loss': [0.2701404663217317]}
Saved model to disk



2

Epoch 1/1
 - 761s - loss: 0.1789 - acc: 0.9309

Test accuracy: 93.7035937035937

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1626

choose_one :  1741

F1score :  0.9380841121495328

AUC : 0.9850407808700389

Confusion Matrix
[[1549  135]
 [  77 1606]]
True label 0
0.919833729216152  
0.08016627078384798  
True label 1
0.0457516339869281  
0.954248366013072  

Train_result {'acc': [0.9308573552547852], 'loss': [0.17894088985276108]}
Saved model to disk



3

Epoch 1/1
 - 761s - loss: 0.1359 - acc: 0.9496

Test accuracy: 93.76299376299376

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1598

choose_one :  1769

F1score :  0.9391657010428737

AUC : 0.987400200128997

Confusion Matrix
[[1536  148]
 [  62 1621]]
True label 0
0.9121140142517815  
0.08788598574821853  
True label 1
0.0368389780154486  
0.9631610219845514  

Train_result {'acc': [0.9496468520914608], 'loss': [0.1359403374260281]}
Saved model to disk



4

Epoch 1/1
 - 759s - loss: 0.1033 - acc: 0.9629

Test accuracy: 95.27769527769527

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1693

choose_one :  1674

F1score :  0.9526362823949955

AUC : 0.9892427135685484

Confusion Matrix
[[1609   75]
 [  84 1599]]
True label 0
0.9554631828978623  
0.04453681710213777  
True label 1
0.049910873440285206  
0.9500891265597148  

Train_result {'acc': [0.9629279172721436], 'loss': [0.10326698753485632]}
Saved model to disk



5

Epoch 1/1
 - 760s - loss: 0.0806 - acc: 0.9709

Test accuracy: 96.07959607959607

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1660

choose_one :  1707

F1score :  0.9610619469026549

AUC : 0.9910612341099977

Confusion Matrix
[[1606   78]
 [  54 1629]]
True label 0
0.9536817102137767  
0.04631828978622328  
True label 1
0.03208556149732621  
0.9679144385026738  

Train_result {'acc': [0.9709033152133026], 'loss': [0.08063220623930352]}
Saved model to disk



6

Epoch 1/1
 - 758s - loss: 0.0675 - acc: 0.9771

Test accuracy: 96.02019602019602

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1686

choose_one :  1681

F1score :  0.960166468489893

AUC : 0.992564495027119

Confusion Matrix
[[1618   66]
 [  68 1615]]
True label 0
0.9608076009501187  
0.039192399049881234  
True label 1
0.04040404040404041  
0.9595959595959596  

Train_result {'acc': [0.9770538339359941], 'loss': [0.06753067342514547]}
Saved model to disk



7

Epoch 1/1
 - 759s - loss: 0.0523 - acc: 0.9822

Test accuracy: 96.7032967032967

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1697

choose_one :  1670

F1score :  0.9668953176260066

AUC : 0.9937068039624977

Confusion Matrix
[[1635   49]
 [  62 1621]]
True label 0
0.9709026128266033  
0.029097387173396674  
True label 1
0.0368389780154486  
0.9631610219845514  

Train_result {'acc': [0.982190530904667], 'loss': [0.05233467150809268]}
Saved model to disk



8

Epoch 1/1
 - 760s - loss: 0.0432 - acc: 0.9860

Test accuracy: 96.85179685179686

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1644

choose_one :  1723

F1score :  0.9688784497944803

AUC : 0.9951246783893144

Confusion Matrix
[[1611   73]
 [  33 1650]]
True label 0
0.9566508313539193  
0.04334916864608076  
True label 1
0.0196078431372549  
0.9803921568627451  

Train_result {'acc': [0.9860092595721672], 'loss': [0.04322604814017994]}
Saved model to disk



9

Epoch 1/1
 - 754s - loss: 0.0412 - acc: 0.9867

Test accuracy: 97.05969705969706

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1687

choose_one :  1680

F1score :  0.9705619982158786

AUC : 0.9938484679123215

Confusion Matrix
[[1636   48]
 [  51 1632]]
True label 0
0.9714964370546318  
0.028503562945368172  
True label 1
0.030303030303030304  
0.9696969696969697  

Train_result {'acc': [0.9867189348112602], 'loss': [0.04115221168327363]}
Saved model to disk



10

Epoch 1/1
 - 762s - loss: 0.0377 - acc: 0.9886

Test accuracy: 97.14879714879714

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1654

choose_one :  1713

F1score :  0.9717314487632509

AUC : 0.9938745778308444

Confusion Matrix
[[1621   63]
 [  33 1650]]
True label 0
0.9625890736342043  
0.037410926365795724  
True label 1
0.0196078431372549  
0.9803921568627451  

Train_result {'acc': [0.9885776080565036], 'loss': [0.03773188067443349]}
Saved model to disk



11

Epoch 1/1
 - 760s - loss: 0.0322 - acc: 0.9903

Test accuracy: 97.38639738639738

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1686

choose_one :  1681

F1score :  0.9738406658739596

AUC : 0.9951873069100957

Confusion Matrix
[[1641   43]
 [  45 1638]]
True label 0
0.9744655581947743  
0.02553444180522565  
True label 1
0.026737967914438502  
0.9732620320855615  

Train_result {'acc': [0.9903011050657294], 'loss': [0.03223411111154081]}
Saved model to disk



12

Epoch 1/1
 - 759s - loss: 0.0287 - acc: 0.9919

Test accuracy: 97.53489753489754

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1653

choose_one :  1714

F1score :  0.9755666764792463

AUC : 0.9948852786633978

Confusion Matrix
[[1627   57]
 [  26 1657]]
True label 0
0.9661520190023754  
0.033847980997624705  
True label 1
0.015448603683897801  
0.9845513963161022  

Train_result {'acc': [0.991923219897942], 'loss': [0.028715592111773346]}
Saved model to disk



13

Epoch 1/1
 - 755s - loss: 0.0290 - acc: 0.9918

Test accuracy: 97.5051975051975

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1668

choose_one :  1699

F1score :  0.9751626256652868

AUC : 0.9945181520387614

Confusion Matrix
[[1634   50]
 [  34 1649]]
True label 0
0.9703087885985748  
0.029691211401425176  
True label 1
0.020202020202020204  
0.9797979797979798  

Train_result {'acc': [0.9917542496029198], 'loss': [0.0290197754925654]}
Saved model to disk



14

Epoch 1/1
 - 763s - loss: 0.0276 - acc: 0.9929

Test accuracy: 97.56459756459756

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1648

choose_one :  1719

F1score :  0.975896531452087

AUC : 0.9943385581397318

Confusion Matrix
[[1625   59]
 [  23 1660]]
True label 0
0.9649643705463183  
0.03503562945368171  
True label 1
0.013666072489601902  
0.9863339275103981  

Train_result {'acc': [0.9929370416680747], 'loss': [0.02756722852270174]}
Saved model to disk



15

Epoch 1/1
 - 712s - loss: 0.0267 - acc: 0.9928

Test accuracy: 98.0991980991981

data size :  32958

zero :  16480

one :  16478

train_zero :  14796

train_one :  14795

test_zero :  1684

test_one :  1683

choose_zero :  1674

choose_one :  1693

F1score :  0.9810426540284359

AUC : 0.9956306462698805

Confusion Matrix
[[1647   37]
 [  27 1656]]
True label 0
0.9780285035629454  
0.021971496437054632  
True label 1
0.016042780748663103  
0.983957219251337  

Train_result {'acc': [0.9927680713730526], 'loss': [0.026712557782268234]}
Saved model to disk




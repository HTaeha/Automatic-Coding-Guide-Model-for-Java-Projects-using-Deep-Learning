Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 08:13:11.507657: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 08:13:11.513783: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-02 08:13:11.515956: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x75e1810 executing computations on platform Host. Devices:
2019-07-02 08:13:11.515995: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25742

one : 
13729
glassfish-CAST
all data

Sentence length Average : 78

Under 10 : 8565
Over 10, Under 200 : 26742
Over 200, Under 400 : 2834
Over 400 : 1330

glassfish-CAST
updated_train_data

Sentence length Average : 87

Under 10 : 0
Over 10, Under 200 : 23721
Over 200, Under 400 : 3591
Over 400 : 0


Test_zero:  1840
Train_zero:  16542
zero:  18382
Test_one:  1167
Train_one:  10770
one:  11937

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 487s - loss: 0.4490 - acc: 0.7862

Test accuracy: 83.12633832976445

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1482

choose_one :  853

F1score :  0.804950495049505

AUC : 0.9230229719101782

Confusion Matrix
[[1128   40]
 [ 354  813]]
True label 0
0.9657534246575342  
0.03424657534246575  
True label 1
0.3033419023136247  
0.6966580976863753  

Train_result {'loss': [0.44901735156941924], 'acc': [0.7861752007854421]}
Saved model to disk



2

Epoch 1/1
 - 485s - loss: 0.3113 - acc: 0.8641

Test accuracy: 86.7237687366167

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1334

choose_one :  1001

F1score :  0.8570110701107011

AUC : 0.9447917033489454

Confusion Matrix
[[1096   72]
 [ 238  929]]
True label 0
0.9383561643835616  
0.06164383561643835  
True label 1
0.20394173093401885  
0.7960582690659811  

Train_result {'loss': [0.3113179193794669], 'acc': [0.8640731628058121]}
Saved model to disk



3

Epoch 1/1
 - 485s - loss: 0.2640 - acc: 0.8846

Test accuracy: 86.50963597430406

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1397

choose_one :  938

F1score :  0.8503562945368169

AUC : 0.9529703841955136

Confusion Matrix
[[1125   43]
 [ 272  895]]
True label 0
0.9631849315068494  
0.036815068493150686  
True label 1
0.23307626392459296  
0.766923736075407  

Train_result {'loss': [0.26397402005136184], 'acc': [0.8846385961654519]}
Saved model to disk



4

Epoch 1/1
 - 488s - loss: 0.2342 - acc: 0.9016

Test accuracy: 88.56531049250536

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1177

choose_one :  1158

F1score :  0.8851612903225807

AUC : 0.9584455811059854

Confusion Matrix
[[1039  129]
 [ 138 1029]]
True label 0
0.889554794520548  
0.11044520547945205  
True label 1
0.11825192802056556  
0.8817480719794345  

Train_result {'loss': [0.23424915546638422], 'acc': [0.9016294508174925]}
Saved model to disk



5

Epoch 1/1
 - 539s - loss: 0.2025 - acc: 0.9155

Test accuracy: 88.43683083511777

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1104

choose_one :  1231

F1score :  0.8874061718098415

AUC : 0.9596803066051579

Confusion Matrix
[[1001  167]
 [ 103 1064]]
True label 0
0.8570205479452054  
0.1429794520547945  
True label 1
0.08826049700085689  
0.9117395029991431  

Train_result {'loss': [0.20250428668218348], 'acc': [0.9155099577549789]}
Saved model to disk



6

Epoch 1/1
 - 540s - loss: 0.1765 - acc: 0.9287

Test accuracy: 88.39400428265525

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1085

choose_one :  1250

F1score :  0.887877534133223

AUC : 0.9630147257339391

Confusion Matrix
[[ 991  177]
 [  94 1073]]
True label 0
0.848458904109589  
0.15154109589041095  
True label 1
0.0805484147386461  
0.919451585261354  

Train_result {'loss': [0.17646620951416178], 'acc': [0.9286941181932129]}
Saved model to disk



7

Epoch 1/1
 - 539s - loss: 0.1574 - acc: 0.9369

Test accuracy: 87.92291220556746

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1052

choose_one :  1283

F1score :  0.8848979591836734

AUC : 0.9642179044734771

Confusion Matrix
[[ 969  199]
 [  83 1084]]
True label 0
0.8296232876712328  
0.1703767123287671  
True label 1
0.07112253641816624  
0.9288774635818338  

Train_result {'loss': [0.15743750954293026], 'acc': [0.9368645838224413]}
Saved model to disk



8

Epoch 1/1
 - 541s - loss: 0.1373 - acc: 0.9460

Test accuracy: 90.36402569593149

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1263

choose_one :  1072

F1score :  0.8995087092451988

AUC : 0.9667203695226022

Confusion Matrix
[[1103   65]
 [ 160 1007]]
True label 0
0.9443493150684932  
0.05565068493150685  
True label 1
0.13710368466152528  
0.8628963153384748  

Train_result {'loss': [0.13725484116039666], 'acc': [0.9460099345434289]}
Saved model to disk



9

Epoch 1/1
 - 540s - loss: 0.1215 - acc: 0.9539

Test accuracy: 89.29336188436831

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1250

choose_one :  1085

F1score :  0.88898756660746

AUC : 0.9616028248289138

Confusion Matrix
[[1084   84]
 [ 166 1001]]
True label 0
0.928082191780822  
0.07191780821917808  
True label 1
0.14224507283633248  
0.8577549271636675  

Train_result {'loss': [0.1215186429530248], 'acc': [0.9539018615690824]}
Saved model to disk



10

Epoch 1/1
 - 538s - loss: 0.1098 - acc: 0.9589

Test accuracy: 90.32119914346896

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1206

choose_one :  1129

F1score :  0.9015679442508712

AUC : 0.9663065934194927

Confusion Matrix
[[1074   94]
 [ 132 1035]]
True label 0
0.9195205479452054  
0.08047945205479452  
True label 1
0.11311053984575835  
0.8868894601542416  

Train_result {'loss': [0.10978728179804274], 'acc': [0.9588691332807204]}
Saved model to disk



11

Epoch 1/1
 - 537s - loss: 0.0939 - acc: 0.9662

Test accuracy: 89.42184154175588

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1121

choose_one :  1214

F1score :  0.8962620747585048

AUC : 0.9642600890939182

Confusion Matrix
[[1021  147]
 [ 100 1067]]
True label 0
0.8741438356164384  
0.12585616438356165  
True label 1
0.0856898029134533  
0.9143101970865467  

Train_result {'loss': [0.09391966645079391], 'acc': [0.9662039831047586]}
Saved model to disk



12

Epoch 1/1
 - 540s - loss: 0.0819 - acc: 0.9708

Test accuracy: 90.62098501070663

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1227

choose_one :  1108

F1score :  0.9037362637362638

AUC : 0.9645487786268501

Confusion Matrix
[[1088   80]
 [ 139 1028]]
True label 0
0.9315068493150684  
0.0684931506849315  
True label 1
0.11910882604970009  
0.8808911739502999  

Train_result {'loss': [0.08189231021262613], 'acc': [0.970753446915185]}
Saved model to disk



13

Epoch 1/1
 - 540s - loss: 0.0766 - acc: 0.9731

Test accuracy: 90.32119914346896

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1200

choose_one :  1135

F1score :  0.901824500434405

AUC : 0.9623834237184677

Confusion Matrix
[[1071   97]
 [ 129 1038]]
True label 0
0.9169520547945206  
0.08304794520547945  
True label 1
0.11053984575835475  
0.8894601542416453  

Train_result {'loss': [0.07660076081092028], 'acc': [0.9730746019219163]}
Saved model to disk



14

Epoch 1/1
 - 536s - loss: 0.0676 - acc: 0.9760

Test accuracy: 90.74946466809422

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1186

choose_one :  1149

F1score :  0.9067357512953368

AUC : 0.9634820579638694

Confusion Matrix
[[1069   99]
 [ 117 1050]]
True label 0
0.9152397260273972  
0.08476027397260275  
True label 1
0.10025706940874037  
0.8997429305912596  

Train_result {'loss': [0.06763613139194058], 'acc': [0.9759992572303978]}
Saved model to disk



15

Epoch 1/1
 - 538s - loss: 0.0642 - acc: 0.9785

Test accuracy: 89.67880085653105

data size :  23876

zero :  11939

one :  11937

train_zero :  10771

train_one :  10770

test_zero :  1168

test_one :  1167

choose_zero :  1143

choose_one :  1192

F1score :  0.8978380669775329

AUC : 0.9620371430080643

Confusion Matrix
[[1035  133]
 [ 108 1059]]
True label 0
0.8861301369863014  
0.11386986301369863  
True label 1
0.09254498714652956  
0.9074550128534704  

Train_result {'loss': [0.06416387575433861], 'acc': [0.978459681537533]}
Saved model to disk




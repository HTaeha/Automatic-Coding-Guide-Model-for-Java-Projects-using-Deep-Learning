2020-10-15 17:22:33.645733: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-10-15 17:22:33.645774: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-10-15 17:23:06.766745: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-10-15 17:23:06.824208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:d8:00.0 name: TITAN V computeCapability: 7.0
coreClock: 1.455GHz coreCount: 80 deviceMemorySize: 11.78GiB deviceMemoryBandwidth: 607.97GiB/s
2020-10-15 17:23:06.824371: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-10-15 17:23:06.824437: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:23:06.826534: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-10-15 17:23:06.826888: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-10-15 17:23:06.826970: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:23:06.827030: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:23:06.827088: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-10-15 17:23:06.827095: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-10-15 17:23:06.827505: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-10-15 17:23:06.843107: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2020-10-15 17:23:06.845832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c7bcb71e90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-15 17:23:06.845878: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-10-15 17:23:06.848799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-15 17:23:06.848825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
2020-10-15 17:23:08.266461: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 8117215200 exceeds 10% of free system memory.
1th data
zero :  10136
one :  10287

Train
zero :  8089
one :  8250
Test
zero :  2046
one :  2037


Sentence length Average : 28

Under 10 : 7798
Over 10, Under 30 : 6304
Over 30, Under 100 : 5232
Over 100, Under 150 : 749
Over 150, Under 200 : 283
Over 200, Under 400 : 55
Over 400 : 1

621
Count model parameter.
Get a short summary of each layer dimensions and parameters.
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 621, 200)]   0                                            
__________________________________________________________________________________________________
masking (Masking)               (None, 621, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm (LSTM)                     (None, 64)           67840       masking[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking[0][0]                    
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64)           0           lstm[0][0]                       
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128)          0           dropout[0][0]                    
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           concatenate[0][0]                
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            258         dropout_2[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

256/256 - 150s - loss: 0.5839 - accuracy: 0.6901
2020-10-15 17:26:09.912060: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 8117215200 exceeds 10% of free system memory.

Test accuracy: 71.98138623561107

data size :  20422

zero :  10135

one :  10287

train_zero :  8089

train_one :  8250

test_zero :  2046

test_one :  2037

choose_zero :  1594

choose_one :  2489

F1score :  0.7472381794078657

AUC :  0.8082060569589669

Confusion Matrix
[[1248  798]
 [ 346 1691]]
True label 0
0.6099706744868035  
0.39002932551319647  
True label 1
0.16985763377515956  
0.8301423662248405  

Train_result {'loss': [0.583855926990509], 'accuracy': [0.6900666952133179]}
Saved model to disk


2

256/256 - 147s - loss: 0.5474 - accuracy: 0.7218
2020-10-15 17:28:59.935274: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 8117215200 exceeds 10% of free system memory.

Test accuracy: 72.00587803085966

data size :  20422

zero :  10135

one :  10287

train_zero :  8089

train_one :  8250

test_zero :  2046

test_one :  2037

choose_zero :  1591

choose_one :  2492

F1score :  0.7476264075954957

AUC :  0.8065453096214652

Confusion Matrix
[[1247  799]
 [ 344 1693]]
True label 0
0.6094819159335289  
0.39051808406647115  
True label 1
0.16887579774177713  
0.8311242022582229  

Train_result {'loss': [0.5473816990852356], 'accuracy': [0.7217699885368347]}
Saved model to disk


3

256/256 - 142s - loss: 0.5341 - accuracy: 0.7292
2020-10-15 17:31:45.258747: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 8117215200 exceeds 10% of free system memory.

Test accuracy: 72.42223855008572

data size :  20422

zero :  10135

one :  10287

train_zero :  8089

train_one :  8250

test_zero :  2046

test_one :  2037

choose_zero :  1388

choose_one :  2695

F1score :  0.7620456466610314

AUC :  0.8221167204373058

Confusion Matrix
[[1154  892]
 [ 234 1803]]
True label 0
0.5640273704789834  
0.4359726295210166  
True label 1
0.11487481590574374  
0.8851251840942562  

Train_result {'loss': [0.5340797901153564], 'accuracy': [0.7291755676269531]}
Saved model to disk


4

256/256 - 141s - loss: 0.5235 - accuracy: 0.7373
2020-10-15 17:34:33.005683: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 8117215200 exceeds 10% of free system memory.

Test accuracy: 74.5285329414646

data size :  20422

zero :  10135

one :  10287

train_zero :  8089

train_one :  8250

test_zero :  2046

test_one :  2037

choose_zero :  1978

choose_one :  2105

F1score :  0.748913568324481

AUC :  0.8267210563519176

Confusion Matrix
[[1492  554]
 [ 486 1551]]
True label 0
0.729227761485826  
0.270772238514174  
True label 1
0.23858615611192932  
0.7614138438880707  

Train_result {'loss': [0.5234680771827698], 'accuracy': [0.7372544407844543]}
Saved model to disk


5

256/256 - 141s - loss: 0.5109 - accuracy: 0.7465

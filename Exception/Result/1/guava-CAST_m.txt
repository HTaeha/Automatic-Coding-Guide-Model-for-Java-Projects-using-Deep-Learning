Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 19:07:44.759016: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 19:07:44.768781: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-02 19:07:44.771283: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x707b460 executing computations on platform Host. Devices:
2019-07-02 19:07:44.771322: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34938
Over 200, Under 400 : 310
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34353
Over 200, Under 400 : 895
Over 400 : 0


Test_zero:  2468
Train_zero:  21725
zero:  24193
Test_one:  1418
Train_one:  13523
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1102s - loss: 0.2664 - acc: 0.8920

Test accuracy: 91.36411702502643

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1594

choose_one :  1243

F1score :  0.9079293498684705

AUC : 0.972118766965751

Confusion Matrix
[[1384   35]
 [ 210 1208]]
True label 0
0.9753347427766033  
0.02466525722339676  
True label 1
0.14809590973201692  
0.8519040902679831  

Train_result {'acc': [0.891965837246275], 'loss': [0.2663934479202123]}
Saved model to disk



2

Epoch 1/1
 - 1096s - loss: 0.1783 - acc: 0.9313

Test accuracy: 93.83151216073317

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1522

choose_one :  1315

F1score :  0.9359678009513357

AUC : 0.9843654175500537

Confusion Matrix
[[1383   36]
 [ 139 1279]]
True label 0
0.9746300211416491  
0.02536997885835095  
True label 1
0.09802538787023977  
0.9019746121297603  

Train_result {'acc': [0.93130476577809], 'loss': [0.17829313013655387]}
Saved model to disk



3

Epoch 1/1
 - 1096s - loss: 0.1283 - acc: 0.9531

Test accuracy: 95.17095523440254

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1458

choose_one :  1379

F1score :  0.9510189488737933

AUC : 0.9877916170926306

Confusion Matrix
[[1370   49]
 [  88 1330]]
True label 0
0.9654686398872445  
0.03453136011275546  
True label 1
0.06205923836389281  
0.9379407616361072  

Train_result {'acc': [0.9530816726439162], 'loss': [0.1283462189040007]}
Saved model to disk



4

Epoch 1/1
 - 1103s - loss: 0.0982 - acc: 0.9645

Test accuracy: 96.33415579837857

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1421

choose_one :  1416

F1score :  0.963302752293578

AUC : 0.9927828155269358

Confusion Matrix
[[1368   51]
 [  53 1365]]
True label 0
0.9640591966173362  
0.035940803382663845  
True label 1
0.03737658674188998  
0.96262341325811  

Train_result {'acc': [0.9644692572189152], 'loss': [0.0982491390480353]}
Saved model to disk



5

Epoch 1/1
 - 1103s - loss: 0.0754 - acc: 0.9748

Test accuracy: 96.33415579837857

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1475

choose_one :  1362

F1score :  0.962589928057554

AUC : 0.9919583210330087

Confusion Matrix
[[1395   24]
 [  80 1338]]
True label 0
0.9830866807610994  
0.016913319238900635  
True label 1
0.056417489421720736  
0.9435825105782792  

Train_result {'acc': [0.9747846341597667], 'loss': [0.07536574136079444]}
Saved model to disk



6

Epoch 1/1
 - 1103s - loss: 0.0585 - acc: 0.9803

Test accuracy: 97.77934437786394

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1430

choose_one :  1407

F1score :  0.9776991150442478

AUC : 0.9947374489474401

Confusion Matrix
[[1393   26]
 [  37 1381]]
True label 0
0.981677237491191  
0.018322762508809022  
True label 1
0.02609308885754584  
0.9739069111424542  

Train_result {'acc': [0.980293563056901], 'loss': [0.05848530297334434]}
Saved model to disk



7

Epoch 1/1
 - 1103s - loss: 0.0474 - acc: 0.9842

Test accuracy: 97.7088473739866

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1412

choose_one :  1425

F1score :  0.9771368272951109

AUC : 0.9962356036502394

Confusion Matrix
[[1383   36]
 [  29 1389]]
True label 0
0.9746300211416491  
0.02536997885835095  
True label 1
0.020451339915373765  
0.9795486600846263  

Train_result {'acc': [0.9842126668392058], 'loss': [0.047436990589483204]}
Saved model to disk



8

Epoch 1/1
 - 1124s - loss: 0.0394 - acc: 0.9869

Test accuracy: 98.09658089531194

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1419

choose_one :  1418

F1score :  0.9809590973201693

AUC : 0.9959376624512586

Confusion Matrix
[[1392   27]
 [  27 1391]]
True label 0
0.9809725158562368  
0.019027484143763214  
True label 1
0.01904090267983075  
0.9809590973201693  

Train_result {'acc': [0.9869116722741894], 'loss': [0.03939115019061069]}
Saved model to disk



9

Epoch 1/1
 - 1124s - loss: 0.0337 - acc: 0.9900

Test accuracy: 97.63835037010928

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1424

choose_one :  1413

F1score :  0.9763334510773579

AUC : 0.996169753426945

Confusion Matrix
[[1388   31]
 [  36 1382]]
True label 0
0.97815362931642  
0.021846370683579985  
True label 1
0.02538787023977433  
0.9746121297602257  

Train_result {'acc': [0.9899804044810885], 'loss': [0.033702550619086634]}
Saved model to disk



10

Epoch 1/1
 - 1124s - loss: 0.0284 - acc: 0.9917

Test accuracy: 98.41381741275997

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1422

choose_one :  1415

F1score :  0.9841157783268619

AUC : 0.9965474603681053

Confusion Matrix
[[1398   21]
 [  24 1394]]
True label 0
0.985200845665962  
0.014799154334038054  
True label 1
0.01692524682651622  
0.9830747531734838  

Train_result {'acc': [0.9916811476319001], 'loss': [0.028427329230177066]}
Saved model to disk



11

Epoch 1/1
 - 1124s - loss: 0.0275 - acc: 0.9918

Test accuracy: 98.09658089531194

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1405

choose_one :  1432

F1score :  0.9810526315789474

AUC : 0.9965777763199615

Confusion Matrix
[[1385   34]
 [  20 1398]]
True label 0
0.9760394644115574  
0.023960535588442564  
True label 1
0.014104372355430184  
0.9858956276445698  

Train_result {'acc': [0.9917920656634747], 'loss': [0.02746619897240323]}
Saved model to disk



12

Epoch 1/1
 - 1122s - loss: 0.0234 - acc: 0.9938

Test accuracy: 98.23757490306662

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1429

choose_one :  1408

F1score :  0.9823071479122434

AUC : 0.9963454368528663

Confusion Matrix
[[1399   20]
 [  30 1388]]
True label 0
0.9859055673009162  
0.014094432699083862  
True label 1
0.021156558533145273  
0.9788434414668548  

Train_result {'acc': [0.9938255629090103], 'loss': [0.023433504000327728]}
Saved model to disk



13

Epoch 1/1
 - 1122s - loss: 0.0214 - acc: 0.9940

Test accuracy: 98.37856891082129

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1415

choose_one :  1422

F1score :  0.9838028169014085

AUC : 0.99708171689672

Confusion Matrix
[[1394   25]
 [  21 1397]]
True label 0
0.9823819591261451  
0.017618040873854827  
True label 1
0.014809590973201692  
0.9851904090267983  

Train_result {'acc': [0.9940473989721595], 'loss': [0.021402320295433486]}
Saved model to disk



14

Epoch 1/1
 - 1122s - loss: 0.0180 - acc: 0.9951

Test accuracy: 98.55481142051462

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1430

choose_one :  1407

F1score :  0.9854867256637169

AUC : 0.995736632901654

Confusion Matrix
[[1404   15]
 [  26 1392]]
True label 0
0.9894291754756871  
0.010570824524312896  
True label 1
0.018335684062059238  
0.9816643159379408  

Train_result {'acc': [0.9951196066107146], 'loss': [0.017989990778055978]}
Saved model to disk



15

Epoch 1/1
 - 1123s - loss: 0.0173 - acc: 0.9957

Test accuracy: 98.09658089531194

data size :  29884

zero :  14943

one :  14941

train_zero :  13524

train_one :  13523

test_zero :  1419

test_one :  1418

choose_zero :  1433

choose_one :  1404

F1score :  0.9808646350106307

AUC : 0.9952717054760548

Confusion Matrix
[[1399   20]
 [  34 1384]]
True label 0
0.9859055673009162  
0.014094432699083862  
True label 1
0.023977433004231313  
0.9760225669957687  

Train_result {'acc': [0.995674196768588], 'loss': [0.017279127394640124]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 06:51:05.432581: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 06:51:05.442354: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-05 06:51:05.444236: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x82a3f90 executing computations on platform Host. Devices:
2019-07-05 06:51:05.444275: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34877
Over 200, Under 400 : 319
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34288
Over 200, Under 400 : 908
Over 400 : 0


Test_zero:  2386
Train_zero:  21807
zero:  24193
Test_one:  1552
Train_one:  13389
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1096s - loss: 0.2737 - acc: 0.8857

Test accuracy: 92.5281803542673

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1643

choose_one :  1462

F1score :  0.9230258792302587

AUC : 0.9789167623688108

Confusion Matrix
[[1482   71]
 [ 161 1391]]
True label 0
0.9542820347714102  
0.04571796522858983  
True label 1
0.10373711340206186  
0.8962628865979382  

Train_result {'acc': [0.8857313566444889], 'loss': [0.27366607978847085]}
Saved model to disk



2

Epoch 1/1
 - 1104s - loss: 0.1748 - acc: 0.9333

Test accuracy: 94.81481481481482

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1608

choose_one :  1497

F1score :  0.947195801902263

AUC : 0.9893160726495442

Confusion Matrix
[[1500   53]
 [ 108 1444]]
True label 0
0.9658725048293625  
0.03412749517063748  
True label 1
0.06958762886597938  
0.9304123711340206  

Train_result {'acc': [0.9333059487133966], 'loss': [0.17477350366374209]}
Saved model to disk



3

Epoch 1/1
 - 1103s - loss: 0.1336 - acc: 0.9509

Test accuracy: 95.94202898550725

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1571

choose_one :  1534

F1score :  0.9591704471808167

AUC : 0.9915457113269296

Confusion Matrix
[[1499   54]
 [  72 1480]]
True label 0
0.9652285898261429  
0.03477141017385705  
True label 1
0.04639175257731959  
0.9536082474226805  

Train_result {'acc': [0.9508943575033708], 'loss': [0.13356976942412593]}
Saved model to disk



4

Epoch 1/1
 - 1101s - loss: 0.1000 - acc: 0.9646

Test accuracy: 96.1352657004831

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1541

choose_one :  1564

F1score :  0.9614890885750962

AUC : 0.9939520947152501

Confusion Matrix
[[1487   66]
 [  54 1498]]
True label 0
0.9575016097875081  
0.04249839021249195  
True label 1
0.03479381443298969  
0.9652061855670103  

Train_result {'acc': [0.9645617834870608], 'loss': [0.09997230869522757]}
Saved model to disk



5

Epoch 1/1
 - 1099s - loss: 0.0743 - acc: 0.9735

Test accuracy: 97.1658615136876

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1599

choose_one :  1506

F1score :  0.9712230215827339

AUC : 0.9959215950504843

Confusion Matrix
[[1532   21]
 [  67 1485]]
True label 0
0.9864777849323889  
0.013522215067611075  
True label 1
0.043170103092783504  
0.9568298969072165  

Train_result {'acc': [0.973486687329624], 'loss': [0.07431851043602213]}
Saved model to disk



6

Epoch 1/1
 - 1100s - loss: 0.0590 - acc: 0.9802

Test accuracy: 97.58454106280193

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1532

choose_one :  1573

F1score :  0.976

AUC : 0.9964082653460878

Confusion Matrix
[[1505   48]
 [  27 1525]]
True label 0
0.9690920798454604  
0.030907920154539602  
True label 1
0.017396907216494846  
0.9826030927835051  

Train_result {'acc': [0.9802083722319728], 'loss': [0.058960926042902]}
Saved model to disk



7

Epoch 1/1
 - 1101s - loss: 0.0482 - acc: 0.9844

Test accuracy: 97.29468599033815

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1593

choose_one :  1512

F1score :  0.9725848563968669

AUC : 0.9954662492282977

Confusion Matrix
[[1531   22]
 [  62 1490]]
True label 0
0.9858338699291693  
0.014166130070830651  
True label 1
0.03994845360824742  
0.9600515463917526  

Train_result {'acc': [0.9843534112395074], 'loss': [0.04821566978351283]}
Saved model to disk



8

Epoch 1/1
 - 1099s - loss: 0.0372 - acc: 0.9880

Test accuracy: 98.06763285024155

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1551

choose_one :  1554

F1score :  0.9806825499034126

AUC : 0.9964512068427587

Confusion Matrix
[[1522   31]
 [  29 1523]]
True label 0
0.9800386349001932  
0.019961365099806824  
True label 1
0.018685567010309278  
0.9813144329896907  

Train_result {'acc': [0.9879756525858339], 'loss': [0.037242538595444616]}
Saved model to disk



9

Epoch 1/1
 - 1101s - loss: 0.0335 - acc: 0.9901

Test accuracy: 98.06763285024155

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1543

choose_one :  1562

F1score :  0.9807321772639691

AUC : 0.9969768771450004

Confusion Matrix
[[1518   35]
 [  25 1527]]
True label 0
0.9774629748873149  
0.022537025112685124  
True label 1
0.01610824742268041  
0.9838917525773195  

Train_result {'acc': [0.9901415288098884], 'loss': [0.033463004763737265]}
Saved model to disk



10

Epoch 1/1
 - 1113s - loss: 0.0275 - acc: 0.9916

Test accuracy: 98.06763285024155

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1555

choose_one :  1550

F1score :  0.9806576402321082

AUC : 0.9969163026666048

Confusion Matrix
[[1524   29]
 [  31 1521]]
True label 0
0.9813264649066323  
0.018673535093367676  
True label 1
0.01997422680412371  
0.9800257731958762  

Train_result {'acc': [0.991597893872064], 'loss': [0.027518020125117018]}
Saved model to disk



11

Epoch 1/1
 - 1115s - loss: 0.0279 - acc: 0.9919

Test accuracy: 98.35748792270532

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1558

choose_one :  1547

F1score :  0.9835430784123911

AUC : 0.99615103125975

Confusion Matrix
[[1530   23]
 [  28 1524]]
True label 0
0.9851899549259497  
0.014810045074050225  
True label 1
0.01804123711340206  
0.9819587628865979  

Train_result {'acc': [0.9919339781171814], 'loss': [0.027885115262156396]}
Saved model to disk



12

Epoch 1/1
 - 1114s - loss: 0.0258 - acc: 0.9933

Test accuracy: 97.8743961352657

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1521

choose_one :  1584

F1score :  0.9789540816326531

AUC : 0.9965684143095173

Confusion Matrix
[[1504   49]
 [  17 1535]]
True label 0
0.9684481648422408  
0.031551835157759174  
True label 1
0.01095360824742268  
0.9890463917525774  

Train_result {'acc': [0.9933156577915531], 'loss': [0.025846234819778064]}
Saved model to disk



13

Epoch 1/1
 - 1111s - loss: 0.0204 - acc: 0.9938

Test accuracy: 98.5829307568438

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1559

choose_one :  1546

F1score :  0.9857972885732731

AUC : 0.9967229622081637

Confusion Matrix
[[1534   19]
 [  25 1527]]
True label 0
0.9877656149388281  
0.012234385061171926  
True label 1
0.01610824742268041  
0.9838917525773195  

Train_result {'acc': [0.9938384555061802], 'loss': [0.020416113339869674]}
Saved model to disk



14

Epoch 1/1
 - 1114s - loss: 0.0210 - acc: 0.9943

Test accuracy: 98.51851851851852

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1553

choose_one :  1552

F1score :  0.9851804123711341

AUC : 0.997104664400794

Confusion Matrix
[[1530   23]
 [  23 1529]]
True label 0
0.9851899549259497  
0.014810045074050225  
True label 1
0.014819587628865979  
0.9851804123711341  

Train_result {'acc': [0.9943239105269054], 'loss': [0.021020902199987698]}
Saved model to disk



15

Epoch 1/1
 - 1111s - loss: 0.0215 - acc: 0.9944

Test accuracy: 98.71175523349437

data size :  29884

zero :  14943

one :  14941

train_zero :  13390

train_one :  13389

test_zero :  1553

test_one :  1552

choose_zero :  1563

choose_one :  1542

F1score :  0.9870717517776342

AUC : 0.9967916271134685

Confusion Matrix
[[1538   15]
 [  25 1527]]
True label 0
0.9903412749517064  
0.009658725048293626  
True label 1
0.01610824742268041  
0.9838917525773195  

Train_result {'acc': [0.9943985959147092], 'loss': [0.021480208981587697]}
Saved model to disk




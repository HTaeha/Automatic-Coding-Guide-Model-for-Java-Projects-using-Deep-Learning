2020-10-15 17:35:12.867667: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-10-15 17:35:12.867707: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-10-15 17:35:44.975368: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-10-15 17:35:45.049264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:d8:00.0 name: TITAN V computeCapability: 7.0
coreClock: 1.455GHz coreCount: 80 deviceMemorySize: 11.78GiB deviceMemoryBandwidth: 607.97GiB/s
2020-10-15 17:35:45.049431: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-10-15 17:35:45.049511: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:35:45.052027: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-10-15 17:35:45.052471: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-10-15 17:35:45.052568: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:35:45.052643: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-10-15 17:35:45.052716: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-10-15 17:35:45.052726: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-10-15 17:35:45.053255: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-10-15 17:35:45.073419: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2020-10-15 17:35:45.076251: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56464f69ed40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-15 17:35:45.076302: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-10-15 17:35:45.080797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-15 17:35:45.080837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
2020-10-15 17:35:46.523093: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 5315065600 exceeds 10% of free system memory.
1th data
zero :  6264
one :  6281

Train
zero :  5013
one :  5023
Test
zero :  1250
one :  1258


Sentence length Average : 103

Under 10 : 735
Over 10, Under 30 : 1604
Over 30, Under 100 : 4906
Over 100, Under 150 : 2280
Over 150, Under 200 : 1361
Over 200, Under 400 : 1630
Over 400 : 28

662
Count model parameter.
Get a short summary of each layer dimensions and parameters.
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 662, 200)]   0                                            
__________________________________________________________________________________________________
masking (Masking)               (None, 662, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm (LSTM)                     (None, 64)           67840       masking[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking[0][0]                    
__________________________________________________________________________________________________
dropout (Dropout)               (None, 64)           0           lstm[0][0]                       
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 128)          0           dropout[0][0]                    
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 128)          0           concatenate[0][0]                
__________________________________________________________________________________________________
dense (Dense)                   (None, 2)            258         dropout_2[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

157/157 - 104s - loss: 0.5073 - accuracy: 0.7492

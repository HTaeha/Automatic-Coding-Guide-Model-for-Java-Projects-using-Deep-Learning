Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-03 21:45:28.964681: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-03 21:45:28.974385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-03 21:45:28.976855: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x59e7db0 executing computations on platform Host. Devices:
2019-07-03 21:45:28.976892: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST_s
all data

Sentence length Average : 68

Under 10 : 8789
Over 10, Under 200 : 36286
Over 200, Under 400 : 3039
Over 400 : 1139

hbase-CAST_s
updated_train_data

Sentence length Average : 75

Under 10 : 0
Over 10, Under 200 : 31759
Over 200, Under 400 : 3521
Over 400 : 0


Test_zero:  1761
Train_zero:  16238
zero:  17999
Test_one:  2113
Train_one:  19042
one:  21155

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 730s - loss: 0.4030 - acc: 0.8177

Test accuracy: 84.78569401078626

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1555

choose_one :  1968

F1score :  0.8563002680965147

AUC : 0.9411310194844664

Confusion Matrix
[[1390  371]
 [ 165 1597]]
True label 0
0.7893242475865985  
0.21067575241340147  
True label 1
0.09364358683314415  
0.9063564131668559  

Train_result {'acc': [0.8177479447029963], 'loss': [0.40299290518739833]}
Saved model to disk



2

Epoch 1/1
 - 728s - loss: 0.3034 - acc: 0.8661

Test accuracy: 87.39710474027818

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1845

choose_one :  1678

F1score :  0.8709302325581396

AUC : 0.9524851412332149

Confusion Matrix
[[1581  180]
 [ 264 1498]]
True label 0
0.8977853492333902  
0.10221465076660988  
True label 1
0.14982973893303064  
0.8501702610669694  

Train_result {'acc': [0.8660590571660796], 'loss': [0.30341921362513286]}
Saved model to disk



3

Epoch 1/1
 - 820s - loss: 0.2641 - acc: 0.8886

Test accuracy: 88.92988929889299

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1909

choose_one :  1614

F1score :  0.884478672985782

AUC : 0.9621949851782955

Confusion Matrix
[[1640  121]
 [ 269 1493]]
True label 0
0.9312890403180011  
0.06871095968199886  
True label 1
0.15266742338251987  
0.8473325766174802  

Train_result {'acc': [0.8885672937973228], 'loss': [0.2640712568555614]}
Saved model to disk



4

Epoch 1/1
 - 840s - loss: 0.2317 - acc: 0.9030

Test accuracy: 88.87311950042577

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1745

choose_one :  1778

F1score :  0.8892655367231639

AUC : 0.9596405857522134

Confusion Matrix
[[1557  204]
 [ 188 1574]]
True label 0
0.8841567291311755  
0.11584327086882454  
True label 1
0.10669693530079455  
0.8933030646992054  

Train_result {'acc': [0.9030082827718929], 'loss': [0.23174972136307626]}
Saved model to disk



5

Epoch 1/1
 - 838s - loss: 0.2017 - acc: 0.9157

Test accuracy: 90.4342889582742

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1780

choose_one :  1743

F1score :  0.903851640513552

AUC : 0.9667217444943121

Confusion Matrix
[[1602  159]
 [ 178 1584]]
True label 0
0.909710391822828  
0.09028960817717206  
True label 1
0.10102156640181612  
0.8989784335981839  

Train_result {'acc': [0.9157249745808898], 'loss': [0.2016703363638865]}
Saved model to disk



6

Epoch 1/1
 - 836s - loss: 0.1760 - acc: 0.9283

Test accuracy: 90.4342889582742

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1794

choose_one :  1729

F1score :  0.9034660555714695

AUC : 0.967796874002943

Confusion Matrix
[[1609  152]
 [ 185 1577]]
True label 0
0.9136854060193073  
0.08631459398069279  
True label 1
0.10499432463110102  
0.895005675368899  

Train_result {'acc': [0.9282569202820458], 'loss': [0.17596729048110105]}
Saved model to disk



7

Epoch 1/1
 - 871s - loss: 0.1538 - acc: 0.9395

Test accuracy: 90.23559466363893

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1739

choose_one :  1784

F1score :  0.9029892836999435

AUC : 0.9702850446778188

Confusion Matrix
[[1578  183]
 [ 161 1601]]
True label 0
0.8960817717206133  
0.10391822827938671  
True label 1
0.09137343927355278  
0.9086265607264472  

Train_result {'acc': [0.939526434112007], 'loss': [0.15381243210297946]}
Saved model to disk



8

Epoch 1/1
 - 841s - loss: 0.1326 - acc: 0.9483

Test accuracy: 90.83167754754471

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1824

choose_one :  1699

F1score :  0.9066743715689106

AUC : 0.9664951809317918

Confusion Matrix
[[1631  130]
 [ 193 1569]]
True label 0
0.9261783077796707  
0.07382169222032936  
True label 1
0.10953461975028377  
0.8904653802497162  

Train_result {'acc': [0.9483326661982082], 'loss': [0.13256743756013428]}
Saved model to disk



9

Epoch 1/1
 - 839s - loss: 0.1142 - acc: 0.9566

Test accuracy: 90.60459835367584

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1746

choose_one :  1777

F1score :  0.9064707544504097

AUC : 0.9662626551702579

Confusion Matrix
[[1588  173]
 [ 158 1604]]
True label 0
0.9017603634298694  
0.0982396365701306  
True label 1
0.08967082860385925  
0.9103291713961408  

Train_result {'acc': [0.9566462419558457], 'loss': [0.11417813201345411]}
Saved model to disk



10

Epoch 1/1
 - 838s - loss: 0.0990 - acc: 0.9636

Test accuracy: 90.46267385750781

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1731

choose_one :  1792

F1score :  0.9054586381541925

AUC : 0.9692830729624909

Confusion Matrix
[[1578  183]
 [ 153 1609]]
True label 0
0.8960817717206133  
0.10391822827938671  
True label 1
0.08683314415437003  
0.91316685584563  

Train_result {'acc': [0.9635742217404181], 'loss': [0.09903745818438697]}
Saved model to disk



11

Epoch 1/1
 - 839s - loss: 0.0896 - acc: 0.9663

Test accuracy: 91.31422083451604

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1807

choose_one :  1716

F1score :  0.9120184013801035

AUC : 0.9684594837960322

Confusion Matrix
[[1631  130]
 [ 176 1586]]
True label 0
0.9261783077796707  
0.07382169222032936  
True label 1
0.09988649262202043  
0.9001135073779796  

Train_result {'acc': [0.9663146226560335], 'loss': [0.08960918451525433]}
Saved model to disk



12

Epoch 1/1
 - 833s - loss: 0.0806 - acc: 0.9715

Test accuracy: 90.57621345444224

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1757

choose_one :  1766

F1score :  0.9058956916099772

AUC : 0.9677865610100544

Confusion Matrix
[[1593  168]
 [ 164 1598]]
True label 0
0.9045996592844975  
0.09540034071550256  
True label 1
0.09307604994324631  
0.9069239500567536  

Train_result {'acc': [0.9715490962835237], 'loss': [0.08062742868211303]}
Saved model to disk



13

Epoch 1/1
 - 839s - loss: 0.0749 - acc: 0.9737

Test accuracy: 90.86006244677831

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1731

choose_one :  1792

F1score :  0.9093978615644345

AUC : 0.9697168632258654

Confusion Matrix
[[1585  176]
 [ 146 1616]]
True label 0
0.9000567859170926  
0.09994321408290743  
True label 1
0.08286038592508513  
0.9171396140749148  

Train_result {'acc': [0.9737352588022049], 'loss': [0.07485712314232816]}
Saved model to disk



14

Epoch 1/1
 - 841s - loss: 0.0670 - acc: 0.9775

Test accuracy: 90.86006244677831

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1771

choose_one :  1752

F1score :  0.9083665338645418

AUC : 0.9673161918500284

Confusion Matrix
[[1605  156]
 [ 166 1596]]
True label 0
0.9114139693356048  
0.08858603066439523  
True label 1
0.094211123723042  
0.905788876276958  

Train_result {'acc': [0.9775225544231302], 'loss': [0.06696267972948378]}
Saved model to disk



15

Epoch 1/1
 - 841s - loss: 0.0659 - acc: 0.9792

Test accuracy: 91.22906613681522

data size :  36000

zero :  17999

one :  18001

train_zero :  16238

train_one :  16239

test_zero :  1761

test_one :  1762

choose_zero :  1782

choose_one :  1741

F1score :  0.911789894376249

AUC : 0.9689284026914333

Confusion Matrix
[[1617  144]
 [ 165 1597]]
True label 0
0.9182282793867121  
0.0817717206132879  
True label 1
0.09364358683314415  
0.9063564131668559  

Train_result {'acc': [0.9791852695588742], 'loss': [0.06592835175526375]}
Saved model to disk




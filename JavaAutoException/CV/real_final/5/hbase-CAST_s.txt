Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 03:07:49.634406: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 03:07:49.644438: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-18 03:07:49.647043: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6887920 executing computations on platform Host. Devices:
2019-07-18 03:07:49.647086: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26255

one : 
22998
hbase-CAST_s
all data

Sentence length Average : 66

Under 10 : 9405
Over 10, Under 200 : 35846
Over 200, Under 400 : 2894
Over 400 : 1108

hbase-CAST_s
updated_train_data

Sentence length Average : 74

Under 10 : 0
Over 10, Under 200 : 31261
Over 200, Under 400 : 3385
Over 400 : 0


Test_zero:  1722
Train_zero:  15914
zero:  17636
Test_one:  2079
Train_one:  18732
one:  20811

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 718s - loss: 0.4091 - acc: 0.8143

Test accuracy: 85.97968069666183

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1753

choose_one :  1692

F1score :  0.8585651537335285

AUC : 0.940861764350999

Confusion Matrix
[[1496  226]
 [ 257 1466]]
True label 0
0.8687572590011614  
0.13124274099883856  
True label 1
0.14915844457341845  
0.8508415554265816  

Train_result {'loss': [0.4091099256893], 'acc': [0.8142574381927933]}
Saved model to disk



2

Epoch 1/1
 - 800s - loss: 0.3119 - acc: 0.8622

Test accuracy: 87.80841799709724

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1756

choose_one :  1689

F1score :  0.876905041031653

AUC : 0.9547589388090216

Confusion Matrix
[[1529  193]
 [ 227 1496]]
True label 0
0.8879210220673636  
0.11207897793263646  
True label 1
0.1317469529889727  
0.8682530470110272  

Train_result {'loss': [0.3118500668906503], 'acc': [0.8622011373332122]}
Saved model to disk



3

Epoch 1/1
 - 823s - loss: 0.2691 - acc: 0.8848

Test accuracy: 88.3599419448476

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1765

choose_one :  1680

F1score :  0.8821627975315898

AUC : 0.956859709754547

Confusion Matrix
[[1543  179]
 [ 222 1501]]
True label 0
0.8960511033681765  
0.10394889663182347  
True label 1
0.12884503772489844  
0.8711549622751016  

Train_result {'loss': [0.26906553850033427], 'acc': [0.8847591818819067]}
Saved model to disk



4

Epoch 1/1
 - 817s - loss: 0.2353 - acc: 0.9008

Test accuracy: 89.37590711175616

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1642

choose_one :  1803

F1score :  0.8961996596710153

AUC : 0.9638851421264399

Confusion Matrix
[[1499  223]
 [ 143 1580]]
True label 0
0.870499419279907  
0.1295005807200929  
True label 1
0.08299477655252467  
0.9170052234474754  

Train_result {'loss': [0.23532931649563932], 'acc': [0.9008137233378117]}
Saved model to disk



5

Epoch 1/1
 - 819s - loss: 0.2067 - acc: 0.9138

Test accuracy: 89.81132075471699

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1853

choose_one :  1592

F1score :  0.8941176470588236

AUC : 0.9661438163589827

Confusion Matrix
[[1612  110]
 [ 241 1482]]
True label 0
0.9361207897793263  
0.06387921022067364  
True label 1
0.13987231572838074  
0.8601276842716192  

Train_result {'loss': [0.20674400945467677], 'acc': [0.9137578937484435]}
Saved model to disk



6

Epoch 1/1
 - 821s - loss: 0.1821 - acc: 0.9251

Test accuracy: 90.36284470246734

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1786

choose_one :  1659

F1score :  0.9018332347723241

AUC : 0.9663576683026593

Confusion Matrix
[[1588  134]
 [ 198 1525]]
True label 0
0.9221835075493612  
0.07781649245063879  
True label 1
0.11491584445734185  
0.8850841555426582  

Train_result {'loss': [0.18214569837716355], 'acc': [0.9251311696898931]}
Saved model to disk



7

Epoch 1/1
 - 824s - loss: 0.1568 - acc: 0.9366

Test accuracy: 89.95645863570391

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1618

choose_one :  1827

F1score :  0.9025352112676056

AUC : 0.964754705585361

Confusion Matrix
[[1497  225]
 [ 121 1602]]
True label 0
0.8693379790940766  
0.13066202090592335  
True label 1
0.0702263493905978  
0.9297736506094022  

Train_result {'loss': [0.15678720501757107], 'acc': [0.9365986993012537]}
Saved model to disk



8

Epoch 1/1
 - 824s - loss: 0.1359 - acc: 0.9468

Test accuracy: 91.20464441219158

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1809

choose_one :  1636

F1score :  0.9097945817207502

AUC : 0.972343669005051

Confusion Matrix
[[1614  108]
 [ 195 1528]]
True label 0
0.9372822299651568  
0.0627177700348432  
True label 1
0.11317469529889727  
0.8868253047011028  

Train_result {'loss': [0.135922867415137], 'acc': [0.9467780954494205]}
Saved model to disk



9

Epoch 1/1
 - 821s - loss: 0.1225 - acc: 0.9527

Test accuracy: 90.9433962264151

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1738

choose_one :  1707

F1score :  0.9090379008746354

AUC : 0.969250483484024

Confusion Matrix
[[1574  148]
 [ 164 1559]]
True label 0
0.9140534262485482  
0.0859465737514518  
True label 1
0.09518282066163668  
0.9048171793383634  

Train_result {'loss': [0.12248946867414809], 'acc': [0.952653240755286]}
Saved model to disk



10

Epoch 1/1
 - 821s - loss: 0.1036 - acc: 0.9601

Test accuracy: 90.85631349782292

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1763

choose_one :  1682

F1score :  0.9074889867841409

AUC : 0.968467033770744

Confusion Matrix
[[1585  137]
 [ 178 1545]]
True label 0
0.9204413472706156  
0.07955865272938444  
True label 1
0.1033081834010447  
0.8966918165989554  

Train_result {'loss': [0.10357418387845978], 'acc': [0.9600678626447331]}
Saved model to disk



11

Epoch 1/1
 - 823s - loss: 0.0925 - acc: 0.9656

Test accuracy: 91.6400580551524

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1748

choose_one :  1697

F1score :  0.9157894736842106

AUC : 0.9718495682179275

Confusion Matrix
[[1591  131]
 [ 157 1566]]
True label 0
0.9239256678281068  
0.07607433217189315  
True label 1
0.09112013929193268  
0.9088798607080674  

Train_result {'loss': [0.09247639769073024], 'acc': [0.9655659932784443]}
Saved model to disk



12

Epoch 1/1
 - 825s - loss: 0.0855 - acc: 0.9700

Test accuracy: 91.32075471698113

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1775

choose_one :  1670

F1score :  0.9118773946360154

AUC : 0.9685578660777902

Confusion Matrix
[[1599  123]
 [ 176 1547]]
True label 0
0.9285714285714286  
0.07142857142857142  
True label 1
0.10214741729541497  
0.897852582704585  

Train_result {'loss': [0.0854887806559474], 'acc': [0.9700273335656039]}
Saved model to disk



13

Epoch 1/1
 - 823s - loss: 0.0762 - acc: 0.9732

Test accuracy: 91.69811320754717

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1736

choose_one :  1709

F1score :  0.9166666666666667

AUC : 0.9687998608698465

Confusion Matrix
[[1586  136]
 [ 150 1573]]
True label 0
0.9210220673635308  
0.07897793263646923  
True label 1
0.08705745792222867  
0.9129425420777714  

Train_result {'loss': [0.07622792852408766], 'acc': [0.9731691224983505]}
Saved model to disk



14

Epoch 1/1
 - 819s - loss: 0.0688 - acc: 0.9767

Test accuracy: 90.65312046444122

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1640

choose_one :  1805

F1score :  0.9087301587301587

AUC : 0.9669857425296747

Confusion Matrix
[[1520  202]
 [ 120 1603]]
True label 0
0.8826945412311266  
0.1173054587688734  
True label 1
0.06964596633778293  
0.930354033662217  

Train_result {'loss': [0.06880553128952292], 'acc': [0.9767193439944705]}
Saved model to disk



15

Epoch 1/1
 - 823s - loss: 0.0661 - acc: 0.9779

Test accuracy: 91.69811320754717

data size :  35274

zero :  17636

one :  17638

train_zero :  15914

train_one :  15915

test_zero :  1722

test_one :  1723

choose_zero :  1756

choose_one :  1689

F1score :  0.9161781946072686

AUC : 0.970079265090802

Confusion Matrix
[[1596  126]
 [ 160 1563]]
True label 0
0.926829268292683  
0.07317073170731707  
True label 1
0.09286128845037725  
0.9071387115496228  

Train_result {'loss': [0.06609516301551702], 'acc': [0.9779132237896259]}
Saved model to disk




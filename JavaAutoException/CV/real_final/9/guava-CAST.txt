Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 15:22:16.972963: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 15:22:16.983865: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-21 15:22:16.985976: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5b6fbb0 executing computations on platform Host. Devices:
2019-07-21 15:22:16.986015: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-CAST
all data

Sentence length Average : 64

Under 10 : 4040
Over 10, Under 200 : 51774
Over 200, Under 400 : 2750
Over 400 : 590

guava-CAST
updated_train_data

Sentence length Average : 66

Under 10 : 0
Over 10, Under 200 : 46563
Over 200, Under 400 : 2888
Over 400 : 0


Test_zero:  3849
Train_zero:  34606
zero:  38455
Test_one:  1630
Train_one:  14845
one:  16475

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 675s - loss: 0.3133 - acc: 0.8632

Test accuracy: 90.49371358478993

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1797

choose_one :  1464

F1score :  0.8998060762766644

AUC : 0.9678954158877274

Confusion Matrix
[[1559   72]
 [ 238 1392]]
True label 0
0.9558553034947884  
0.04414469650521153  
True label 1
0.1460122699386503  
0.8539877300613496  

Train_result {'acc': [0.863157185679162], 'loss': [0.3133008621914354]}
Saved model to disk



2

Epoch 1/1
 - 674s - loss: 0.2050 - acc: 0.9152

Test accuracy: 92.6096289481754

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1598

choose_one :  1663

F1score :  0.9268144549043426

AUC : 0.9812937977002327

Confusion Matrix
[[1494  137]
 [ 104 1526]]
True label 0
0.9160024524831392  
0.08399754751686082  
True label 1
0.0638036809815951  
0.9361963190184049  

Train_result {'acc': [0.9152268364210978], 'loss': [0.20504060423144116]}
Saved model to disk



3

Epoch 1/1
 - 675s - loss: 0.1568 - acc: 0.9392

Test accuracy: 94.1735663906777

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1655

choose_one :  1606

F1score :  0.9412855377008652

AUC : 0.9865978567102873

Confusion Matrix
[[1548   83]
 [ 107 1523]]
True label 0
0.9491109748620479  
0.050889025137952175  
True label 1
0.0656441717791411  
0.9343558282208589  

Train_result {'acc': [0.9392408474149084], 'loss': [0.15675774486459745]}
Saved model to disk



4

Epoch 1/1
 - 710s - loss: 0.1274 - acc: 0.9515

Test accuracy: 95.36951855259123

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1660

choose_one :  1601

F1score :  0.9532652429588363

AUC : 0.9909201701692288

Confusion Matrix
[[1570   61]
 [  90 1540]]
True label 0
0.9625996321275291  
0.03740036787247088  
True label 1
0.05521472392638037  
0.9447852760736196  

Train_result {'acc': [0.951466774463509], 'loss': [0.12739196698921315]}
Saved model to disk



5

Epoch 1/1
 - 713s - loss: 0.0994 - acc: 0.9642

Test accuracy: 95.95216191352345

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1637

choose_one :  1624

F1score :  0.9594345421020282

AUC : 0.992643679025627

Confusion Matrix
[[1568   63]
 [  69 1561]]
True label 0
0.9613733905579399  
0.03862660944206009  
True label 1
0.04233128834355828  
0.9576687116564417  

Train_result {'acc': [0.9641642248352285], 'loss': [0.0994390569903818]}
Saved model to disk



6

Epoch 1/1
 - 712s - loss: 0.0833 - acc: 0.9701

Test accuracy: 95.27752223244403

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1717

choose_one :  1544

F1score :  0.9514807813484563

AUC : 0.993526497726187

Confusion Matrix
[[1597   34]
 [ 120 1510]]
True label 0
0.9791538933169834  
0.020846106683016553  
True label 1
0.0736196319018405  
0.9263803680981595  

Train_result {'acc': [0.9700919470546631], 'loss': [0.08331578109739102]}
Saved model to disk



7

Epoch 1/1
 - 712s - loss: 0.0701 - acc: 0.9753

Test accuracy: 96.41214351425943

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1588

choose_one :  1673

F1score :  0.9645776566757494

AUC : 0.9957563014146915

Confusion Matrix
[[1551   80]
 [  37 1593]]
True label 0
0.9509503372164316  
0.049049662783568364  
True label 1
0.022699386503067485  
0.9773006134969325  

Train_result {'acc': [0.9753123842241757], 'loss': [0.07007039601875281]}
Saved model to disk



8

Epoch 1/1
 - 711s - loss: 0.0602 - acc: 0.9792

Test accuracy: 96.44280895430849

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1625

choose_one :  1636

F1score :  0.964482547458665

AUC : 0.9952323276397106

Confusion Matrix
[[1570   61]
 [  55 1575]]
True label 0
0.9625996321275291  
0.03740036787247088  
True label 1
0.03374233128834356  
0.9662576687116564  

Train_result {'acc': [0.9791856118075786], 'loss': [0.060201290815470224]}
Saved model to disk



9

Epoch 1/1
 - 711s - loss: 0.0553 - acc: 0.9819

Test accuracy: 96.74946335479913

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1653

choose_one :  1608

F1score :  0.9672637430512662

AUC : 0.9962003437990167

Confusion Matrix
[[1589   42]
 [  64 1566]]
True label 0
0.9742489270386266  
0.02575107296137339  
True label 1
0.0392638036809816  
0.9607361963190184  

Train_result {'acc': [0.9819137112316464], 'loss': [0.055339665530084826]}
Saved model to disk



10

Epoch 1/1
 - 712s - loss: 0.0476 - acc: 0.9836

Test accuracy: 97.63876111622201

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1620

choose_one :  1641

F1score :  0.9764597982268419

AUC : 0.9973978100679698

Confusion Matrix
[[1587   44]
 [  33 1597]]
True label 0
0.9730226854690374  
0.0269773145309626  
True label 1
0.020245398773006136  
0.9797546012269939  

Train_result {'acc': [0.983564042975986], 'loss': [0.04763163397019837]}
Saved model to disk



11

Epoch 1/1
 - 713s - loss: 0.0453 - acc: 0.9854

Test accuracy: 97.2094449555351

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1582

choose_one :  1679

F1score :  0.9724992444847386

AUC : 0.9967884507603826

Confusion Matrix
[[1561   70]
 [  21 1609]]
True label 0
0.9570815450643777  
0.04291845493562232  
True label 1
0.012883435582822086  
0.9871165644171779  

Train_result {'acc': [0.9854164561852429], 'loss': [0.045282274356959244]}
Saved model to disk



12

Epoch 1/1
 - 709s - loss: 0.0395 - acc: 0.9863

Test accuracy: 97.17877951548604

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1601

choose_one :  1660

F1score :  0.9720364741641337

AUC : 0.9961755180494485

Confusion Matrix
[[1570   61]
 [  31 1599]]
True label 0
0.9625996321275291  
0.03740036787247088  
True label 1
0.01901840490797546  
0.9809815950920245  

Train_result {'acc': [0.9862584621602506], 'loss': [0.039534636290649496]}
Saved model to disk



13

Epoch 1/1
 - 709s - loss: 0.0373 - acc: 0.9868

Test accuracy: 97.70009199632015

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1608

choose_one :  1653

F1score :  0.977155041120926

AUC : 0.9968121480667888

Confusion Matrix
[[1582   49]
 [  26 1604]]
True label 0
0.9699570815450643  
0.030042918454935622  
True label 1
0.015950920245398775  
0.9840490797546012  

Train_result {'acc': [0.9867636657573002], 'loss': [0.037347607906578276]}
Saved model to disk



14

Epoch 1/1
 - 711s - loss: 0.0366 - acc: 0.9883

Test accuracy: 97.51609935602575

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1580

choose_one :  1681

F1score :  0.9755360918151617

AUC : 0.9965467758498118

Confusion Matrix
[[1565   66]
 [  15 1615]]
True label 0
0.9595340282035562  
0.0404659717964439  
True label 1
0.009202453987730062  
0.99079754601227  

Train_result {'acc': [0.9883129567882524], 'loss': [0.03660285364493803]}
Saved model to disk



15

Epoch 1/1
 - 711s - loss: 0.0324 - acc: 0.9898

Test accuracy: 97.91475007666361

data size :  32952

zero :  16477

one :  16475

train_zero :  14846

train_one :  14845

test_zero :  1631

test_one :  1630

choose_zero :  1591

choose_one :  1670

F1score :  0.9793939393939394

AUC : 0.9974021357667584

Confusion Matrix
[[1577   54]
 [  14 1616]]
True label 0
0.9668914776210914  
0.03310852237890864  
True label 1
0.008588957055214725  
0.9914110429447853  

Train_result {'acc': [0.9898285675794012], 'loss': [0.032350466542801486]}
Saved model to disk




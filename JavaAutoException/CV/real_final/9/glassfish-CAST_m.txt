Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 13:33:58.279089: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 13:33:58.290241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-22 13:33:58.292740: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xcd04260 executing computations on platform Host. Devices:
2019-07-22 13:33:58.292781: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
25926
one : 
13545

Second data
zero : 
25926
one : 
13545

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15791
Over 200, Under 400 : 693
Over 400 : 0


glassfish-code

Sentence length Average : 80

Under 10 : 0
Over 10, Under 200 : 15024
Over 200, Under 400 : 1460
Over 400 : 0


Test_zero:  967
Train_zero:  8620
zero:  9587
Test_one:  861
Train_one:  7864
one:  8725
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 639s - loss: 0.4222 - acc: 0.8063

Test accuracy: 85.95473012188044

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  1058

choose_one :  665

F1score :  0.8414154652686763

AUC : 0.934031005871875

Confusion Matrix
[[839  23]
 [219 642]]
True label 0
0.9733178654292344  
0.02668213457076566  
True label 1
0.25435540069686413  
0.7456445993031359  

Train_result {'loss': [0.42220625643891896], 'acc': [0.8062813910648868]}
Saved model to disk



2

Epoch 1/1
 - 649s - loss: 0.3014 - acc: 0.8695

Test accuracy: 87.86999419616947

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  943

choose_one :  780

F1score :  0.8726386349786714

AUC : 0.9433925910356219

Confusion Matrix
[[798  64]
 [145 716]]
True label 0
0.925754060324826  
0.07424593967517401  
True label 1
0.16840882694541232  
0.8315911730545877  

Train_result {'loss': [0.3013789754653888], 'acc': [0.8695403395116545]}
Saved model to disk



3

Epoch 1/1
 - 649s - loss: 0.2637 - acc: 0.8838

Test accuracy: 87.81195589088799

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  1022

choose_one :  701

F1score :  0.8655569782330345

AUC : 0.9514229663344032

Confusion Matrix
[[837  25]
 [185 676]]
True label 0
0.9709976798143851  
0.029002320185614848  
True label 1
0.2148664343786295  
0.7851335656213705  

Train_result {'loss': [0.2637051664128444], 'acc': [0.8838451268395705]}
Saved model to disk



4

Epoch 1/1
 - 648s - loss: 0.2347 - acc: 0.9022

Test accuracy: 88.21822402785838

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  801

choose_one :  922

F1score :  0.886146943353898

AUC : 0.9601917049995823

Confusion Matrix
[[730 132]
 [ 71 790]]
True label 0
0.8468677494199536  
0.1531322505800464  
True label 1
0.08246225319396051  
0.9175377468060395  

Train_result {'loss': [0.2347198428575586], 'acc': [0.9022188314578168]}
Saved model to disk



5

Epoch 1/1
 - 648s - loss: 0.2074 - acc: 0.9165

Test accuracy: 90.13348810214742

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  868

choose_one :  855

F1score :  0.900932400932401

AUC : 0.9647202438215964

Confusion Matrix
[[780  82]
 [ 88 773]]
True label 0
0.9048723897911833  
0.0951276102088167  
True label 1
0.10220673635307782  
0.8977932636469221  

Train_result {'loss': [0.2074274612608789], 'acc': [0.916460041964499]}
Saved model to disk



6

Epoch 1/1
 - 649s - loss: 0.1845 - acc: 0.9264

Test accuracy: 90.53975623911782

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  881

choose_one :  842

F1score :  0.904286553141515

AUC : 0.9648233182696428

Confusion Matrix
[[790  72]
 [ 91 770]]
True label 0
0.9164733178654292  
0.08352668213457076  
True label 1
0.10569105691056911  
0.8943089430894309  

Train_result {'loss': [0.18448455128348618], 'acc': [0.9264416046830444]}
Saved model to disk



7

Epoch 1/1
 - 648s - loss: 0.1552 - acc: 0.9399

Test accuracy: 90.65583284968078

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  945

choose_one :  778

F1score :  0.9017693715680294

AUC : 0.9648482447701509

Confusion Matrix
[[823  39]
 [122 739]]
True label 0
0.9547563805104409  
0.04524361948955916  
True label 1
0.14169570267131243  
0.8583042973286876  

Train_result {'loss': [0.15522338572828698], 'acc': [0.9398563163621085]}
Saved model to disk



8

Epoch 1/1
 - 648s - loss: 0.1375 - acc: 0.9476

Test accuracy: 90.82994776552525

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  932

choose_one :  791

F1score :  0.9043583535108959

AUC : 0.9657644620861191

Confusion Matrix
[[818  44]
 [114 747]]
True label 0
0.9489559164733179  
0.05104408352668213  
True label 1
0.13240418118466898  
0.867595818815331  

Train_result {'loss': [0.1374890404179104], 'acc': [0.9476126899395769]}
Saved model to disk



9

Epoch 1/1
 - 650s - loss: 0.1140 - acc: 0.9585

Test accuracy: 89.7852582704585

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  798

choose_one :  925

F1score :  0.9014557670772676

AUC : 0.9686579572126514

Confusion Matrix
[[742 120]
 [ 56 805]]
True label 0
0.8607888631090487  
0.13921113689095127  
True label 1
0.06504065040650407  
0.9349593495934959  

Train_result {'loss': [0.11400357610144901], 'acc': [0.9584843283107636]}
Saved model to disk



10

Epoch 1/1
 - 660s - loss: 0.0955 - acc: 0.9648

Test accuracy: 91.23621590249564

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  911

choose_one :  812

F1score :  0.9097429766885833

AUC : 0.966863922865281

Confusion Matrix
[[811  51]
 [100 761]]
True label 0
0.9408352668213457  
0.05916473317865429  
True label 1
0.11614401858304298  
0.883855981416957  

Train_result {'loss': [0.09551646583238427], 'acc': [0.9648420115709835]}
Saved model to disk



11

Epoch 1/1
 - 658s - loss: 0.0796 - acc: 0.9720

Test accuracy: 90.65583284968078

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  841

choose_one :  882

F1score :  0.9076305220883534

AUC : 0.9670464926392718

Confusion Matrix
[[771  91]
 [ 70 791]]
True label 0
0.894431554524362  
0.10556844547563805  
True label 1
0.08130081300813008  
0.9186991869918699  

Train_result {'loss': [0.07961576568292332], 'acc': [0.9719626168262194]}
Saved model to disk



12

Epoch 1/1
 - 660s - loss: 0.0696 - acc: 0.9762

Test accuracy: 91.8165989553105

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  889

choose_one :  834

F1score :  0.9168141592920355

AUC : 0.9683480601793092

Confusion Matrix
[[805  57]
 [ 84 777]]
True label 0
0.9338747099767981  
0.06612529002320186  
True label 1
0.0975609756097561  
0.9024390243902439  

Train_result {'loss': [0.0696271117755631], 'acc': [0.9761586877741751]}
Saved model to disk



13

Epoch 1/1
 - 659s - loss: 0.0625 - acc: 0.9785

Test accuracy: 91.52640742890308

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  888

choose_one :  835

F1score :  0.9139150943396226

AUC : 0.967618454772549

Confusion Matrix
[[802  60]
 [ 86 775]]
True label 0
0.9303944315545244  
0.06960556844547564  
True label 1
0.09988385598141696  
0.9001161440185831  

Train_result {'loss': [0.06251858171915839], 'acc': [0.9785110305804565]}
Saved model to disk



14

Epoch 1/1
 - 657s - loss: 0.0529 - acc: 0.9817

Test accuracy: 91.12013929193267

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  855

choose_one :  868

F1score :  0.9115095430884904

AUC : 0.966502825452517

Confusion Matrix
[[782  80]
 [ 73 788]]
True label 0
0.9071925754060325  
0.09280742459396751  
True label 1
0.08478513356562137  
0.9152148664343787  

Train_result {'loss': [0.05287544158220083], 'acc': [0.9816898722105665]}
Saved model to disk



15

Epoch 1/1
 - 660s - loss: 0.0487 - acc: 0.9837

Test accuracy: 92.28090539756239

data size :  17452

zero :  8727

one :  8725

train_zero :  7865

train_one :  7864

test_zero :  862

test_one :  861

choose_zero :  865

choose_one :  858

F1score :  0.9226294357184409

AUC : 0.9687098312812761

Confusion Matrix
[[797  65]
 [ 68 793]]
True label 0
0.9245939675174014  
0.07540603248259861  
True label 1
0.07897793263646923  
0.9210220673635308  

Train_result {'loss': [0.048736551488927964], 'acc': [0.9837243308538368]}
Saved model to disk




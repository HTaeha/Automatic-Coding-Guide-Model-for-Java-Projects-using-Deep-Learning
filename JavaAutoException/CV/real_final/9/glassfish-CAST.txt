Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 18:25:32.403343: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 18:25:32.414167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-21 18:25:32.417059: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6921fa0 executing computations on platform Host. Devices:
2019-07-21 18:25:32.417128: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-CAST
all data

Sentence length Average : 73

Under 10 : 9491
Over 10, Under 200 : 26126
Over 200, Under 400 : 2656
Over 400 : 1198

glassfish-CAST
updated_train_data

Sentence length Average : 84

Under 10 : 0
Over 10, Under 200 : 23066
Over 200, Under 400 : 3339
Over 400 : 0


Test_zero:  1791
Train_zero:  16065
zero:  17856
Test_one:  1139
Train_one:  10340
one:  11479

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 477s - loss: 0.5108 - acc: 0.7490

Test accuracy: 81.61474330846863

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1265

choose_one :  1014

F1score :  0.8053878309335811

AUC : 0.9066193798807818

Confusion Matrix
[[993 147]
 [272 867]]
True label 0
0.8710526315789474  
0.12894736842105264  
True label 1
0.23880597014925373  
0.7611940298507462  

Train_result {'loss': [0.5107628766494681], 'acc': [0.7489966636042744]}
Saved model to disk



2

Epoch 1/1
 - 491s - loss: 0.3721 - acc: 0.8290

Test accuracy: 84.7740236946029

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1127

choose_one :  1152

F1score :  0.8485377564382367

AUC : 0.933344885479722

Confusion Matrix
[[960 180]
 [167 972]]
True label 0
0.8421052631578947  
0.15789473684210525  
True label 1
0.1466198419666374  
0.8533801580333626  

Train_result {'loss': [0.37206548165032266], 'acc': [0.8289734538977614]}
Saved model to disk



3

Epoch 1/1
 - 491s - loss: 0.3133 - acc: 0.8618

Test accuracy: 86.96796840719614

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1215

choose_one :  1064

F1score :  0.8651838402178847

AUC : 0.9474223310691126

Confusion Matrix
[[1029  111]
 [ 186  953]]
True label 0
0.9026315789473685  
0.09736842105263158  
True label 1
0.16330114135206322  
0.8366988586479368  

Train_result {'loss': [0.31330215805855716], 'acc': [0.8618055219766936]}
Saved model to disk



4

Epoch 1/1
 - 492s - loss: 0.2750 - acc: 0.8798

Test accuracy: 84.24747696358051

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1419

choose_one :  860

F1score :  0.8204102051025514

AUC : 0.9524321118863884

Confusion Matrix
[[1100   40]
 [ 319  820]]
True label 0
0.9649122807017544  
0.03508771929824561  
True label 1
0.2800702370500439  
0.7199297629499561  

Train_result {'loss': [0.27495393850005495], 'acc': [0.8798414003248977]}
Saved model to disk



5

Epoch 1/1
 - 502s - loss: 0.2363 - acc: 0.8997

Test accuracy: 87.80166739798157

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1208

choose_one :  1071

F1score :  0.87420814479638

AUC : 0.9542635121605594

Confusion Matrix
[[1035  105]
 [ 173  966]]
True label 0
0.9078947368421053  
0.09210526315789473  
True label 1
0.15188762071992976  
0.8481123792800702  

Train_result {'loss': [0.23629496806747857], 'acc': [0.8996663604303275]}
Saved model to disk



6

Epoch 1/1
 - 500s - loss: 0.2066 - acc: 0.9146

Test accuracy: 88.81088196577446

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1177

choose_one :  1102

F1score :  0.8862115127175367

AUC : 0.9591200345024106

Confusion Matrix
[[1031  109]
 [ 146  993]]
True label 0
0.9043859649122807  
0.0956140350877193  
True label 1
0.12818261633011413  
0.8718173836698858  

Train_result {'loss': [0.20662495018991348], 'acc': [0.9146076108534212]}
Saved model to disk



7

Epoch 1/1
 - 500s - loss: 0.1824 - acc: 0.9261

Test accuracy: 88.94251864853005

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1128

choose_one :  1151

F1score :  0.8899563318777293

AUC : 0.959515888052

Confusion Matrix
[[1008  132]
 [ 120 1019]]
True label 0
0.8842105263157894  
0.11578947368421053  
True label 1
0.10535557506584724  
0.8946444249341527  

Train_result {'loss': [0.1824136902068179], 'acc': [0.926115758425608]}
Saved model to disk



8

Epoch 1/1
 - 499s - loss: 0.1585 - acc: 0.9396

Test accuracy: 88.50372970601141

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1090

choose_one :  1189

F1score :  0.8874570446735395

AUC : 0.9600881043697919

Confusion Matrix
[[ 984  156]
 [ 106 1033]]
True label 0
0.8631578947368421  
0.1368421052631579  
True label 1
0.09306409130816505  
0.9069359086918349  

Train_result {'loss': [0.15849140841105155], 'acc': [0.9396064020172723]}
Saved model to disk



9

Epoch 1/1
 - 503s - loss: 0.1420 - acc: 0.9447

Test accuracy: 89.03027643703379

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1136

choose_one :  1143

F1score :  0.8904469763365469

AUC : 0.9609414229163777

Confusion Matrix
[[1013  127]
 [ 123 1016]]
True label 0
0.8885964912280702  
0.11140350877192982  
True label 1
0.10798946444249341  
0.8920105355575065  

Train_result {'loss': [0.14195433867970358], 'acc': [0.9447318795029254]}
Saved model to disk



10

Epoch 1/1
 - 501s - loss: 0.1241 - acc: 0.9520

Test accuracy: 89.77621763931549

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1221

choose_one :  1058

F1score :  0.8939462903959946

AUC : 0.9623850561434315

Confusion Matrix
[[1064   76]
 [ 157  982]]
True label 0
0.9333333333333333  
0.06666666666666667  
True label 1
0.13784021071115013  
0.8621597892888498  

Train_result {'loss': [0.12410282806328657], 'acc': [0.9519849136888932]}
Saved model to disk



11

Epoch 1/1
 - 500s - loss: 0.1071 - acc: 0.9589

Test accuracy: 90.65379552435279

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1149

choose_one :  1130

F1score :  0.9061260467166152

AUC : 0.9632306732590916

Confusion Matrix
[[1038  102]
 [ 111 1028]]
True label 0
0.9105263157894737  
0.08947368421052632  
True label 1
0.09745390693590869  
0.9025460930640913  

Train_result {'loss': [0.1070981207889354], 'acc': [0.9588994729461825]}
Saved model to disk



12

Epoch 1/1
 - 500s - loss: 0.0948 - acc: 0.9647

Test accuracy: 89.68845985081177

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1105

choose_one :  1174

F1score :  0.8984003458711629

AUC : 0.9601843722563652

Confusion Matrix
[[1005  135]
 [ 100 1039]]
True label 0
0.881578947368421  
0.11842105263157894  
True label 1
0.08779631255487269  
0.9122036874451273  

Train_result {'loss': [0.09482174427209585], 'acc': [0.9647019002949567]}
Saved model to disk



13

Epoch 1/1
 - 505s - loss: 0.0860 - acc: 0.9689

Test accuracy: 89.20579201404124

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1090

choose_one :  1189

F1score :  0.8943298969072166

AUC : 0.9582659458127321

Confusion Matrix
[[ 992  148]
 [  98 1041]]
True label 0
0.8701754385964913  
0.12982456140350876  
True label 1
0.08604038630377524  
0.9139596136962248  

Train_result {'loss': [0.08599642111065683], 'acc': [0.9689086601228181]}
Saved model to disk



14

Epoch 1/1
 - 504s - loss: 0.0761 - acc: 0.9731

Test accuracy: 89.24967090829311

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1209

choose_one :  1070

F1score :  0.88909008601177

AUC : 0.9605467245814272

Confusion Matrix
[[1052   88]
 [ 157  982]]
True label 0
0.9228070175438596  
0.07719298245614035  
True label 1
0.13784021071115013  
0.8621597892888498  

Train_result {'loss': [0.07607979877191227], 'acc': [0.9731154199506794]}
Saved model to disk



15

Epoch 1/1
 - 503s - loss: 0.0713 - acc: 0.9751

Test accuracy: 90.17112768758227

data size :  22960

zero :  11481

one :  11479

train_zero :  10341

train_one :  10340

test_zero :  1140

test_one :  1139

choose_zero :  1178

choose_one :  1101

F1score :  0.9

AUC : 0.9636118940899219

Confusion Matrix
[[1047   93]
 [ 131 1008]]
True label 0
0.9184210526315789  
0.08157894736842106  
True label 1
0.11501316944688324  
0.8849868305531168  

Train_result {'loss': [0.07131062897181811], 'acc': [0.9750979159643927]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-23 15:46:07.899458: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-23 15:46:07.910699: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-23 15:46:07.913125: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x66988f0 executing computations on platform Host. Devices:
2019-07-23 15:46:07.913169: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41834

one : 
17320
guava-CAST_s
all data

Sentence length Average : 47

Under 10 : 5998
Over 10, Under 200 : 51675
Over 200, Under 400 : 1254
Over 400 : 227

guava-CAST_s
updated_train_data

Sentence length Average : 51

Under 10 : 0
Over 10, Under 200 : 46127
Over 200, Under 400 : 1271
Over 400 : 0


Test_zero:  3610
Train_zero:  33006
zero:  36616
Test_one:  1648
Train_one:  14392
one:  16040

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 646s - loss: 0.3164 - acc: 0.8618

Test accuracy: 88.41370943281771

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1939

choose_one :  1358

F1score :  0.8729208250166334

AUC : 0.9655101355926217

Confusion Matrix
[[1603   46]
 [ 336 1312]]
True label 0
0.9721043056397817  
0.027895694360218316  
True label 1
0.20388349514563106  
0.7961165048543689  

Train_result {'loss': [0.31643612833772244], 'acc': [0.8618377627277821]}
Saved model to disk



2

Epoch 1/1
 - 685s - loss: 0.2167 - acc: 0.9104

Test accuracy: 91.53776160145587

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1578

choose_one :  1719

F1score :  0.917136917136917

AUC : 0.9770701719783099

Confusion Matrix
[[1474  175]
 [ 104 1544]]
True label 0
0.8938750758035173  
0.10612492419648271  
True label 1
0.06310679611650485  
0.9368932038834952  

Train_result {'loss': [0.21671577179951657], 'acc': [0.910404724687136]}
Saved model to disk



3

Epoch 1/1
 - 738s - loss: 0.1655 - acc: 0.9342

Test accuracy: 92.99363057324841

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1666

choose_one :  1631

F1score :  0.929551692589204

AUC : 0.9831088788733389

Confusion Matrix
[[1542  107]
 [ 124 1524]]
True label 0
0.9351121892055791  
0.06488781079442087  
True label 1
0.07524271844660194  
0.9247572815533981  

Train_result {'loss': [0.16546431884431004], 'acc': [0.9341671009206184]}
Saved model to disk



4

Epoch 1/1
 - 735s - loss: 0.1293 - acc: 0.9509

Test accuracy: 94.0552016985138

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1629

choose_one :  1668

F1score :  0.9408926417370326

AUC : 0.9869916012646677

Confusion Matrix
[[1541  108]
 [  88 1560]]
True label 0
0.9345057610673135  
0.06549423893268648  
True label 1
0.05339805825242718  
0.9466019417475728  

Train_result {'loss': [0.129267016040258], 'acc': [0.9509466736188713]}
Saved model to disk



5

Epoch 1/1
 - 736s - loss: 0.1036 - acc: 0.9602

Test accuracy: 93.93387928419776

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1553

choose_one :  1744

F1score :  0.9410377358490566

AUC : 0.988241071376003

Confusion Matrix
[[1501  148]
 [  52 1596]]
True label 0
0.9102486355366889  
0.0897513644633111  
True label 1
0.03155339805825243  
0.9684466019417476  

Train_result {'loss': [0.103550325340543], 'acc': [0.9601875977112805]}
Saved model to disk



6

Epoch 1/1
 - 735s - loss: 0.0831 - acc: 0.9694

Test accuracy: 95.08644222020018

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1579

choose_one :  1718

F1score :  0.9518716577540106

AUC : 0.9908542688419577

Confusion Matrix
[[1533  116]
 [  46 1602]]
True label 0
0.9296543359611886  
0.0703456640388114  
True label 1
0.027912621359223302  
0.9720873786407767  

Train_result {'loss': [0.08306533242456922], 'acc': [0.9693937814834115]}
Saved model to disk



7

Epoch 1/1
 - 738s - loss: 0.0696 - acc: 0.9744

Test accuracy: 95.96602972399151

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1580

choose_one :  1717

F1score :  0.9604754829123328

AUC : 0.9925502805466095

Confusion Matrix
[[1548  101]
 [  32 1616]]
True label 0
0.9387507580351728  
0.061249241964827165  
True label 1
0.019417475728155338  
0.9805825242718447  

Train_result {'loss': [0.06958339812129863], 'acc': [0.9744311273232587]}
Saved model to disk



8

Epoch 1/1
 - 733s - loss: 0.0583 - acc: 0.9796

Test accuracy: 95.81437670609645

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1701

choose_one :  1596

F1score :  0.9574599260172626

AUC : 0.9920621574122592

Confusion Matrix
[[1606   43]
 [  95 1553]]
True label 0
0.9739235900545785  
0.02607640994542147  
True label 1
0.05764563106796117  
0.9423543689320388  

Train_result {'loss': [0.05829837399079331], 'acc': [0.979607434429724]}
Saved model to disk



9

Epoch 1/1
 - 734s - loss: 0.0507 - acc: 0.9817

Test accuracy: 96.51198058841372

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1654

choose_one :  1643

F1score :  0.9650562139167426

AUC : 0.9940897175104653

Confusion Matrix
[[1594   55]
 [  60 1588]]
True label 0
0.9666464523953912  
0.03335354760460885  
True label 1
0.03640776699029126  
0.9635922330097088  

Train_result {'loss': [0.05073485729961682], 'acc': [0.9817265937120028]}
Saved model to disk



10

Epoch 1/1
 - 735s - loss: 0.0424 - acc: 0.9851

Test accuracy: 96.9972702456779

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1606

choose_one :  1691

F1score :  0.9703504043126685

AUC : 0.9951331198078269

Confusion Matrix
[[1578   71]
 [  28 1620]]
True label 0
0.9569436021831413  
0.0430563978168587  
True label 1
0.01699029126213592  
0.9830097087378641  

Train_result {'loss': [0.04243028861944331], 'acc': [0.9850964043793505]}
Saved model to disk



11

Epoch 1/1
 - 737s - loss: 0.0382 - acc: 0.9865

Test accuracy: 96.7242948134668

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1621

choose_one :  1676

F1score :  0.9675090252707582

AUC : 0.9949607220027437

Confusion Matrix
[[1581   68]
 [  40 1608]]
True label 0
0.9587628865979382  
0.041237113402061855  
True label 1
0.024271844660194174  
0.9757281553398058  

Train_result {'loss': [0.03820472884503289], 'acc': [0.986451276706618]}
Saved model to disk



12

Epoch 1/1
 - 732s - loss: 0.0392 - acc: 0.9876

Test accuracy: 96.96693964209888

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1593

choose_one :  1704

F1score :  0.9701670644391407

AUC : 0.9950348696179503

Confusion Matrix
[[1571   78]
 [  22 1626]]
True label 0
0.9526986052152819  
0.04730139478471801  
True label 1
0.013349514563106795  
0.9866504854368932  

Train_result {'loss': [0.03915793738587292], 'acc': [0.987597707139135]}
Saved model to disk



13

Epoch 1/1
 - 736s - loss: 0.0366 - acc: 0.9891

Test accuracy: 97.0276008492569

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1611

choose_one :  1686

F1score :  0.9706058788242352

AUC : 0.9945493223312747

Confusion Matrix
[[1581   68]
 [  30 1618]]
True label 0
0.9587628865979382  
0.041237113402061855  
True label 1
0.01820388349514563  
0.9817961165048543  

Train_result {'loss': [0.03664161397661526], 'acc': [0.9890915407330206]}
Saved model to disk



14

Epoch 1/1
 - 740s - loss: 0.0332 - acc: 0.9899

Test accuracy: 96.63330300272975

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1610

choose_one :  1687

F1score :  0.9667166416791605

AUC : 0.9913352164006429

Confusion Matrix
[[1574   75]
 [  36 1612]]
True label 0
0.9545178896300789  
0.04548211036992116  
True label 1
0.021844660194174758  
0.9781553398058253  

Train_result {'loss': [0.033195365793860024], 'acc': [0.9899253083203057]}
Saved model to disk



15

Epoch 1/1
 - 737s - loss: 0.0336 - acc: 0.9902

Test accuracy: 96.84561722778284

data size :  32082

zero :  16042

one :  16040

train_zero :  14393

train_one :  14392

test_zero :  1649

test_one :  1648

choose_zero :  1613

choose_one :  1684

F1score :  0.9687875150060024

AUC : 0.9909309923048392

Confusion Matrix
[[1579   70]
 [  34 1614]]
True label 0
0.957550030321407  
0.04244996967859309  
True label 1
0.02063106796116505  
0.9793689320388349  

Train_result {'loss': [0.0336279308851589], 'acc': [0.9902379711655376]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-23 18:54:57.250973: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-23 18:54:57.260775: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-23 18:54:57.263907: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5ffc7e0 executing computations on platform Host. Devices:
2019-07-23 18:54:57.263947: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25899

one : 
13572
glassfish-CAST_s
all data

Sentence length Average : 53

Under 10 : 10931
Over 10, Under 200 : 26175
Over 200, Under 400 : 1822
Over 400 : 543

glassfish-CAST_s
updated_train_data

Sentence length Average : 65

Under 10 : 0
Over 10, Under 200 : 22955
Over 200, Under 400 : 1961
Over 400 : 0


Test_zero:  1626
Train_zero:  14969
zero:  16595
Test_one:  1109
Train_one:  9947
one:  11056

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 448s - loss: 0.5029 - acc: 0.7487

Test accuracy: 82.33438485804416

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1226

choose_one :  993

F1score :  0.813510941960038

AUC : 0.9076056669834849

Confusion Matrix
[[972 138]
 [254 855]]
True label 0
0.8756756756756757  
0.12432432432432433  
True label 1
0.2290351668169522  
0.7709648331830478  

Train_result {'loss': [0.5028890900903684], 'acc': [0.7486805730112895]}
Saved model to disk



2

Epoch 1/1
 - 446s - loss: 0.3716 - acc: 0.8276

Test accuracy: 84.76791347453808

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1158

choose_one :  1061

F1score :  0.8442396313364056

AUC : 0.929708202341205

Confusion Matrix
[[965 145]
 [193 916]]
True label 0
0.8693693693693694  
0.13063063063063063  
True label 1
0.1740306582506763  
0.8259693417493237  

Train_result {'loss': [0.37162856136802813], 'acc': [0.8276451369361322]}
Saved model to disk



3

Epoch 1/1
 - 469s - loss: 0.3158 - acc: 0.8568

Test accuracy: 86.79585398828301

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1137

choose_one :  1082

F1score :  0.8662711090826106

AUC : 0.943951210001706

Confusion Matrix
[[977 133]
 [160 949]]
True label 0
0.8801801801801802  
0.11981981981981982  
True label 1
0.1442741208295762  
0.8557258791704238  

Train_result {'loss': [0.3157694895742646], 'acc': [0.8567981905031217]}
Saved model to disk



4

Epoch 1/1
 - 491s - loss: 0.2746 - acc: 0.8794

Test accuracy: 85.48895899053628

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1266

choose_one :  953

F1score :  0.8438409311348205

AUC : 0.9456766505008164

Confusion Matrix
[[1027   83]
 [ 239  870]]
True label 0
0.9252252252252252  
0.07477477477477477  
True label 1
0.21550946798917944  
0.7844905320108205  

Train_result {'loss': [0.27460007352366406], 'acc': [0.879366675034993]}
Saved model to disk



5

Epoch 1/1
 - 492s - loss: 0.2458 - acc: 0.8948

Test accuracy: 88.46327174402884

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1092

choose_one :  1127

F1score :  0.885509838998211

AUC : 0.9525459183259004

Confusion Matrix
[[973 137]
 [119 990]]
True label 0
0.8765765765765766  
0.12342342342342343  
True label 1
0.1073038773669973  
0.8926961226330027  

Train_result {'loss': [0.24580999639322482], 'acc': [0.8947976878283161]}
Saved model to disk



6

Epoch 1/1
 - 490s - loss: 0.2179 - acc: 0.9091

Test accuracy: 87.83235691753042

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1062

choose_one :  1157

F1score :  0.880847308031774

AUC : 0.9533952347297705

Confusion Matrix
[[951 159]
 [111 998]]
True label 0
0.8567567567567568  
0.14324324324324325  
True label 1
0.10009017132551848  
0.8999098286744815  

Train_result {'loss': [0.21789713379695028], 'acc': [0.909072631281445]}
Saved model to disk



7

Epoch 1/1
 - 489s - loss: 0.1834 - acc: 0.9237

Test accuracy: 88.73366381252816

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1174

choose_one :  1045

F1score :  0.8839368616527391

AUC : 0.9561641443066149

Confusion Matrix
[[1017   93]
 [ 157  952]]
True label 0
0.9162162162162162  
0.08378378378378379  
True label 1
0.14156898106402163  
0.8584310189359784  

Train_result {'loss': [0.183372611274976], 'acc': [0.923699421965318]}
Saved model to disk



8

Epoch 1/1
 - 488s - loss: 0.1617 - acc: 0.9353

Test accuracy: 88.46327174402884

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1230

choose_one :  989

F1score :  0.8779790276453766

AUC : 0.9569834036019789

Confusion Matrix
[[1042   68]
 [ 188  921]]
True label 0
0.9387387387387387  
0.06126126126126126  
True label 1
0.16952209197475204  
0.830477908025248  

Train_result {'loss': [0.16173854213049735], 'acc': [0.935260115630904]}
Saved model to disk



9

Epoch 1/1
 - 541s - loss: 0.1398 - acc: 0.9441

Test accuracy: 88.77872915727806

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1107

choose_one :  1112

F1score :  0.8878883385862224

AUC : 0.9580398703482562

Confusion Matrix
[[984 126]
 [123 986]]
True label 0
0.8864864864864865  
0.11351351351351352  
True label 1
0.1109107303877367  
0.8890892696122633  

Train_result {'loss': [0.1398225110824697], 'acc': [0.9440562955756139]}
Saved model to disk



10

Epoch 1/1
 - 582s - loss: 0.1209 - acc: 0.9531

Test accuracy: 88.46327174402884

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1058

choose_one :  1161

F1score :  0.8872246696035243

AUC : 0.9572153307500466

Confusion Matrix
[[ 956  154]
 [ 102 1007]]
True label 0
0.8612612612612612  
0.13873873873873874  
True label 1
0.09197475202885483  
0.9080252479711451  

Train_result {'loss': [0.12089358629159336], 'acc': [0.9531037949353314]}
Saved model to disk



11

Epoch 1/1
 - 581s - loss: 0.1044 - acc: 0.9616

Test accuracy: 88.73366381252816

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1150

choose_one :  1069

F1score :  0.8852157943067035

AUC : 0.9562356314836025

Confusion Matrix
[[1005  105]
 [ 145  964]]
True label 0
0.9054054054054054  
0.0945945945945946  
True label 1
0.13074842200180342  
0.8692515779981965  

Train_result {'loss': [0.10435012465960328], 'acc': [0.9616486554410656]}
Saved model to disk



12

Epoch 1/1
 - 581s - loss: 0.0877 - acc: 0.9672

Test accuracy: 89.99549346552502

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1150

choose_one :  1069

F1score :  0.8980716253443526

AUC : 0.9601844856578852

Confusion Matrix
[[1019   91]
 [ 131  978]]
True label 0
0.918018018018018  
0.08198198198198198  
True label 1
0.11812443642921551  
0.8818755635707844  

Train_result {'loss': [0.08772349861609888], 'acc': [0.9671776828348831]}
Saved model to disk



13

Epoch 1/1
 - 503s - loss: 0.0867 - acc: 0.9683

Test accuracy: 88.91392519152772

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1154

choose_one :  1065

F1score :  0.8868445262189513

AUC : 0.9569923394991023

Confusion Matrix
[[1009  101]
 [ 145  964]]
True label 0
0.909009009009009  
0.09099099099099099  
True label 1
0.13074842200180342  
0.8692515779981965  

Train_result {'loss': [0.08673699866567433], 'acc': [0.9683337522110288]}
Saved model to disk



14

Epoch 1/1
 - 489s - loss: 0.0733 - acc: 0.9743

Test accuracy: 89.49977467327625

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1127

choose_one :  1092

F1score :  0.8941390277146752

AUC : 0.9541515365681281

Confusion Matrix
[[1002  108]
 [ 125  984]]
True label 0
0.9027027027027027  
0.0972972972972973  
True label 1
0.1127141568981064  
0.8872858431018936  

Train_result {'loss': [0.07333258763577385], 'acc': [0.9743151545614476]}
Saved model to disk



15

Epoch 1/1
 - 490s - loss: 0.0708 - acc: 0.9738

Test accuracy: 89.95042812077513

data size :  22114

zero :  11058

one :  11056

train_zero :  9948

train_one :  9947

test_zero :  1110

test_one :  1109

choose_zero :  1083

choose_one :  1136

F1score :  0.9006681514476615

AUC : 0.9620228434024647

Confusion Matrix
[[ 985  125]
 [  98 1011]]
True label 0
0.8873873873873874  
0.11261261261261261  
True label 1
0.08836789900811542  
0.9116321009918846  

Train_result {'loss': [0.07080189686410876], 'acc': [0.9737622518220659]}
Saved model to disk




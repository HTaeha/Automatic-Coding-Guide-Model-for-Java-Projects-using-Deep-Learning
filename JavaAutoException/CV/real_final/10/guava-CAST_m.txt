Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-24 21:23:03.061698: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-24 21:23:03.073437: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-24 21:23:03.076028: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x10262ea0 executing computations on platform Host. Devices:
2019-07-24 21:23:03.076072: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41860
one : 
17294

Second data
zero : 
41860
one : 
17294

guava-AST

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32797
Over 200, Under 400 : 266
Over 400 : 0


guava-code

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 32157
Over 200, Under 400 : 906
Over 400 : 0


Test_zero:  2225
Train_zero:  20436
zero:  22661
Test_one:  1436
Train_one:  12627
one:  14063
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 971s - loss: 0.2688 - acc: 0.8909

Test accuracy: 91.8552036199095

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1611

choose_one :  1262

F1score :  0.9132690882134914

AUC : 0.9795355729884491

Confusion Matrix
[[1407   30]
 [ 204 1232]]
True label 0
0.9791231732776617  
0.020876826722338204  
True label 1
0.14206128133704735  
0.8579387186629527  

Train_result {'loss': [0.26881961699119206], 'acc': [0.8909126905563255]}
Saved model to disk



2

Epoch 1/1
 - 963s - loss: 0.1699 - acc: 0.9355

Test accuracy: 94.1872607030978

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1550

choose_one :  1323

F1score :  0.9394708227618703

AUC : 0.9882187433972431

Confusion Matrix
[[1410   27]
 [ 140 1296]]
True label 0
0.9812108559498957  
0.018789144050104383  
True label 1
0.09749303621169916  
0.9025069637883009  

Train_result {'loss': [0.16988283412258498], 'acc': [0.935497921203722]}
Saved model to disk



3

Epoch 1/1
 - 1102s - loss: 0.1284 - acc: 0.9535

Test accuracy: 95.50991994430909

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1438

choose_one :  1435

F1score :  0.9550679205851621

AUC : 0.9907406330505173

Confusion Matrix
[[1373   64]
 [  65 1371]]
True label 0
0.9554627696590118  
0.04453723034098817  
True label 1
0.04526462395543175  
0.9547353760445683  

Train_result {'loss': [0.12843204076232073], 'acc': [0.95351415561275]}
Saved model to disk



4

Epoch 1/1
 - 1148s - loss: 0.0896 - acc: 0.9677

Test accuracy: 95.85798816568047

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1502

choose_one :  1371

F1score :  0.9576059850374065

AUC : 0.9938338731844235

Confusion Matrix
[[1410   27]
 [  92 1344]]
True label 0
0.9812108559498957  
0.018789144050104383  
True label 1
0.06406685236768803  
0.935933147632312  

Train_result {'loss': [0.08961467253528439], 'acc': [0.9676895664224906]}
Saved model to disk



5

Epoch 1/1
 - 1145s - loss: 0.0710 - acc: 0.9757

Test accuracy: 97.14584058475462

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1447

choose_one :  1426

F1score :  0.9713487071977638

AUC : 0.9937301674992198

Confusion Matrix
[[1401   36]
 [  46 1390]]
True label 0
0.9749478079331941  
0.025052192066805846  
True label 1
0.03203342618384401  
0.967966573816156  

Train_result {'loss': [0.07099604876156969], 'acc': [0.9756879825777074]}
Saved model to disk



6

Epoch 1/1
 - 1147s - loss: 0.0544 - acc: 0.9808

Test accuracy: 97.35468151757745

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1433

choose_one :  1440

F1score :  0.9735744089012518

AUC : 0.9956087426800262

Confusion Matrix
[[1397   40]
 [  36 1400]]
True label 0
0.9721642310368824  
0.027835768963117607  
True label 1
0.025069637883008356  
0.9749303621169917  

Train_result {'loss': [0.05437361086409696], 'acc': [0.980835478123144]}
Saved model to disk



7

Epoch 1/1
 - 1149s - loss: 0.0436 - acc: 0.9860

Test accuracy: 97.9463974939088

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1418

choose_one :  1455

F1score :  0.979591836734694

AUC : 0.9962661107266569

Confusion Matrix
[[1398   39]
 [  20 1416]]
True label 0
0.9728601252609603  
0.027139874739039668  
True label 1
0.013927576601671309  
0.9860724233983287  

Train_result {'loss': [0.04360799909414884], 'acc': [0.9859829736685805]}
Saved model to disk



8

Epoch 1/1
 - 1150s - loss: 0.0330 - acc: 0.9901

Test accuracy: 97.9463974939088

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1446

choose_one :  1427

F1score :  0.9793922458959133

AUC : 0.9963429207785486

Confusion Matrix
[[1412   25]
 [  34 1402]]
True label 0
0.9826026443980515  
0.017397355601948505  
True label 1
0.023676880222841225  
0.9763231197771588  

Train_result {'loss': [0.033003799701866766], 'acc': [0.9900613739853494]}
Saved model to disk



9

Epoch 1/1
 - 1150s - loss: 0.0324 - acc: 0.9898

Test accuracy: 98.19004524886877

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1431

choose_one :  1442

F1score :  0.9819318971507992

AUC : 0.9962828296338512

Confusion Matrix
[[1408   29]
 [  23 1413]]
True label 0
0.9798190675017397  
0.020180932498260265  
True label 1
0.016016713091922007  
0.983983286908078  

Train_result {'loss': [0.032371418628220565], 'acc': [0.989823797272588]}
Saved model to disk



10

Epoch 1/1
 - 1147s - loss: 0.0289 - acc: 0.9916

Test accuracy: 98.64253393665159

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1450

choose_one :  1423

F1score :  0.9863588667366212

AUC : 0.9974175345960228

Confusion Matrix
[[1424   13]
 [  26 1410]]
True label 0
0.9909533750869868  
0.009046624913013222  
True label 1
0.018105849582172703  
0.9818941504178273  

Train_result {'loss': [0.028933925738861624], 'acc': [0.9915660265294001]}
Saved model to disk



11

Epoch 1/1
 - 1146s - loss: 0.0246 - acc: 0.9929

Test accuracy: 98.32927253741734

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1427

choose_one :  1446

F1score :  0.9833448993754337

AUC : 0.9971989772874856

Confusion Matrix
[[1408   29]
 [  19 1417]]
True label 0
0.9798190675017397  
0.020180932498260265  
True label 1
0.013231197771587743  
0.9867688022284122  

Train_result {'loss': [0.024563292550707362], 'acc': [0.9928726984755494]}
Saved model to disk



12

Epoch 1/1
 - 1150s - loss: 0.0208 - acc: 0.9941

Test accuracy: 98.19004524886877

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1411

choose_one :  1462

F1score :  0.9820565907522428

AUC : 0.9971599665040329

Confusion Matrix
[[1398   39]
 [  13 1423]]
True label 0
0.9728601252609603  
0.027139874739039668  
True label 1
0.009052924791086351  
0.9909470752089137  

Train_result {'loss': [0.020784452602571876], 'acc': [0.9940605820629578]}
Saved model to disk



13

Epoch 1/1
 - 1147s - loss: 0.0216 - acc: 0.9943

Test accuracy: 98.22485207100591

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1432

choose_one :  1441

F1score :  0.9822732012513035

AUC : 0.9967829430316565

Confusion Matrix
[[1409   28]
 [  23 1413]]
True label 0
0.9805149617258176  
0.019485038274182326  
True label 1
0.016016713091922007  
0.983983286908078  

Train_result {'loss': [0.021635950677249258], 'acc': [0.9943377549000197]}
Saved model to disk



14

Epoch 1/1
 - 1145s - loss: 0.0219 - acc: 0.9945

Test accuracy: 98.25965889314305

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1453

choose_one :  1420

F1score :  0.9824929971988796

AUC : 0.9976402110556076

Confusion Matrix
[[1420   17]
 [  33 1403]]
True label 0
0.988169798190675  
0.011830201809324982  
True label 1
0.02298050139275766  
0.9770194986072424  

Train_result {'loss': [0.021918972933260467], 'acc': [0.9944961393783409]}
Saved model to disk



15

Epoch 1/1
 - 1144s - loss: 0.0169 - acc: 0.9954

Test accuracy: 98.25965889314305

data size :  28128

zero :  14065

one :  14063

train_zero :  12628

train_one :  12627

test_zero :  1437

test_one :  1436

choose_zero :  1421

choose_one :  1452

F1score :  0.9826869806094183

AUC : 0.997340966847134

Confusion Matrix
[[1404   33]
 [  17 1419]]
True label 0
0.9770354906054279  
0.022964509394572025  
True label 1
0.011838440111420613  
0.9881615598885793  

Train_result {'loss': [0.01693995403790462], 'acc': [0.9954068501286873]}
Saved model to disk




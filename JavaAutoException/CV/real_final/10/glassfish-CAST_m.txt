Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-25 05:34:10.278662: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-25 05:34:10.289920: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-25 05:34:10.292451: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xddcf740 executing computations on platform Host. Devices:
2019-07-25 05:34:10.292490: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
25926
one : 
13545

Second data
zero : 
25926
one : 
13545

glassfish-AST

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 15798
Over 200, Under 400 : 697
Over 400 : 0


glassfish-code

Sentence length Average : 80

Under 10 : 0
Over 10, Under 200 : 15044
Over 200, Under 400 : 1451
Over 400 : 0


Test_zero:  940
Train_zero:  8647
zero:  9587
Test_one:  877
Train_one:  7848
one:  8725
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 632s - loss: 0.4283 - acc: 0.7996

Test accuracy: 86.55270655270655

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  1004

choose_one :  751

F1score :  0.8550368550368552

AUC : 0.9375771097887549

Confusion Matrix
[[823  55]
 [181 696]]
True label 0
0.9373576309794989  
0.06264236902050115  
True label 1
0.2063854047890536  
0.7936145952109465  

Train_result {'loss': [0.42831181576219785], 'acc': [0.7995795374988348]}
Saved model to disk



2

Epoch 1/1
 - 630s - loss: 0.3023 - acc: 0.8677

Test accuracy: 86.72364672364672

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  1063

choose_one :  692

F1score :  0.851497769279796

AUC : 0.9484250772071906

Confusion Matrix
[[854  24]
 [209 668]]
True label 0
0.9726651480637813  
0.02733485193621868  
True label 1
0.23831242873432154  
0.7616875712656784  

Train_result {'loss': [0.3023245286286891], 'acc': [0.8677454290704727]}
Saved model to disk



3

Epoch 1/1
 - 633s - loss: 0.2588 - acc: 0.8890

Test accuracy: 83.58974358974359

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  662

choose_one :  1093

F1score :  0.8538071065989848

AUC : 0.9567399474809287

Confusion Matrix
[[626 252]
 [ 36 841]]
True label 0
0.7129840546697038  
0.2870159453302961  
True label 1
0.04104903078677309  
0.9589509692132269  

Train_result {'loss': [0.2588143084579618], 'acc': [0.8889596738382123]}
Saved model to disk



4

Epoch 1/1
 - 641s - loss: 0.2305 - acc: 0.9062

Test accuracy: 90.65527065527066

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  872

choose_one :  883

F1score :  0.9068181818181817

AUC : 0.9691392015127155

Confusion Matrix
[[793  85]
 [ 79 798]]
True label 0
0.9031890660592256  
0.09681093394077449  
True label 1
0.09007981755986318  
0.9099201824401368  

Train_result {'loss': [0.2304605523032611], 'acc': [0.9061604128253302]}
Saved model to disk



5

Epoch 1/1
 - 641s - loss: 0.2033 - acc: 0.9175

Test accuracy: 91.73789173789174

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  939

choose_one :  816

F1score :  0.9143532191376256

AUC : 0.9683405064376122

Confusion Matrix
[[836  42]
 [103 774]]
True label 0
0.9521640091116174  
0.04783599088838269  
True label 1
0.11744583808437856  
0.8825541619156214  

Train_result {'loss': [0.2032636886317445], 'acc': [0.917500159269899]}
Saved model to disk



6

Epoch 1/1
 - 642s - loss: 0.1803 - acc: 0.9275

Test accuracy: 90.71225071225071

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  941

choose_one :  814

F1score :  0.9036073329390893

AUC : 0.9697236125432789

Confusion Matrix
[[828  50]
 [113 764]]
True label 0
0.9430523917995444  
0.05694760820045558  
True label 1
0.12884834663625996  
0.87115165336374  

Train_result {'loss': [0.18031048954896367], 'acc': [0.9275020704669178]}
Saved model to disk



7

Epoch 1/1
 - 641s - loss: 0.1503 - acc: 0.9425

Test accuracy: 91.33903133903134

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  886

choose_one :  869

F1score :  0.9129438717067585

AUC : 0.9698891956686053

Confusion Matrix
[[806  72]
 [ 80 797]]
True label 0
0.9179954441913439  
0.08200455580865604  
True label 1
0.09122006841505131  
0.9087799315849487  

Train_result {'loss': [0.15029807456657446], 'acc': [0.9424730840325926]}
Saved model to disk



8

Epoch 1/1
 - 643s - loss: 0.1319 - acc: 0.9505

Test accuracy: 91.85185185185185

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  881

choose_one :  874

F1score :  0.9183323814962878

AUC : 0.9728183936229068

Confusion Matrix
[[808  70]
 [ 73 804]]
True label 0
0.9202733485193622  
0.07972665148063782  
True label 1
0.08323831242873432  
0.9167616875712656  

Train_result {'loss': [0.1318842217488969], 'acc': [0.9505000955596611]}
Saved model to disk



9

Epoch 1/1
 - 640s - loss: 0.1121 - acc: 0.9588

Test accuracy: 90.71225071225071

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  977

choose_one :  778

F1score :  0.9015105740181268

AUC : 0.9683781684818039

Confusion Matrix
[[846  32]
 [131 746]]
True label 0
0.9635535307517085  
0.03644646924829157  
True label 1
0.14937286202964653  
0.8506271379703535  

Train_result {'loss': [0.1121191005944264], 'acc': [0.9588456392979299]}
Saved model to disk



10

Epoch 1/1
 - 642s - loss: 0.0979 - acc: 0.9638

Test accuracy: 93.27635327635328

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  892

choose_one :  863

F1score :  0.932183908045977

AUC : 0.9781300405451386

Confusion Matrix
[[826  52]
 [ 66 811]]
True label 0
0.9407744874715261  
0.05922551252847381  
True label 1
0.07525655644241733  
0.9247434435575826  

Train_result {'loss': [0.09790806860315969], 'acc': [0.9638147416703828]}
Saved model to disk



11

Epoch 1/1
 - 644s - loss: 0.0797 - acc: 0.9717

Test accuracy: 92.02279202279202

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  870

choose_one :  885

F1score :  0.9205448354143019

AUC : 0.9733112469253488

Confusion Matrix
[[804  74]
 [ 66 811]]
True label 0
0.9157175398633257  
0.08428246013667426  
True label 1
0.07525655644241733  
0.9247434435575826  

Train_result {'loss': [0.0796726286007121], 'acc': [0.9717143403198063]}
Saved model to disk



12

Epoch 1/1
 - 640s - loss: 0.0670 - acc: 0.9754

Test accuracy: 92.76353276353277

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  893

choose_one :  862

F1score :  0.9269695227142035

AUC : 0.9747261709649017

Confusion Matrix
[[822  56]
 [ 71 806]]
True label 0
0.9362186788154897  
0.06378132118451026  
True label 1
0.08095781071835804  
0.9190421892816419  

Train_result {'loss': [0.06699806334190347], 'acc': [0.9754093138816334]}
Saved model to disk



13

Epoch 1/1
 - 642s - loss: 0.0584 - acc: 0.9789

Test accuracy: 91.5099715099715

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  859

choose_one :  896

F1score :  0.915961646926114

AUC : 0.9744540951628947

Confusion Matrix
[[794  84]
 [ 65 812]]
True label 0
0.9043280182232346  
0.09567198177676538  
True label 1
0.07411630558722919  
0.9258836944127709  

Train_result {'loss': [0.05844346867915678], 'acc': [0.978913168121297]}
Saved model to disk



14

Epoch 1/1
 - 642s - loss: 0.0521 - acc: 0.9821

Test accuracy: 92.64957264957265

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  901

choose_one :  854

F1score :  0.925476603119584

AUC : 0.9769151149471563

Confusion Matrix
[[825  53]
 [ 76 801]]
True label 0
0.9396355353075171  
0.06036446469248292  
True label 1
0.08665906499429875  
0.9133409350057012  

Train_result {'loss': [0.052107601303125396], 'acc': [0.982098490157355]}
Saved model to disk



15

Epoch 1/1
 - 640s - loss: 0.0474 - acc: 0.9854

Test accuracy: 91.85185185185185

data size :  17452

zero :  8727

one :  8725

train_zero :  7849

train_one :  7848

test_zero :  878

test_one :  877

choose_zero :  861

choose_one :  894

F1score :  0.9192546583850931

AUC : 0.9740489035150375

Confusion Matrix
[[798  80]
 [ 63 814]]
True label 0
0.908883826879271  
0.09111617312072894  
True label 1
0.07183580387685291  
0.928164196123147  

Train_result {'loss': [0.04736898459377736], 'acc': [0.985411225074855]}
Saved model to disk




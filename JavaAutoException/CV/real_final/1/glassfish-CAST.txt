Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-23 21:12:58.410297: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-23 21:12:58.419049: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-23 21:12:58.421900: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x74e3db0 executing computations on platform Host. Devices:
2019-07-23 21:12:58.421939: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-CAST
all data

Sentence length Average : 73

Under 10 : 9491
Over 10, Under 200 : 26126
Over 200, Under 400 : 2656
Over 400 : 1198

glassfish-CAST
updated_train_data

Sentence length Average : 84

Under 10 : 0
Over 10, Under 200 : 23083
Over 200, Under 400 : 3337
Over 400 : 0


Test_zero:  1783
Train_zero:  16072
zero:  17855
Test_one:  1132
Train_one:  10348
one:  11480

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 468s - loss: 0.5034 - acc: 0.7488

Test accuracy: 82.25165562913908

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1045

choose_one :  1220

F1score :  0.8290816326530612

AUC : 0.9137285233549256

Confusion Matrix
[[888 245]
 [157 975]]
True label 0
0.7837599293909974  
0.21624007060900266  
True label 1
0.13869257950530034  
0.8613074204946997  

Train_result {'acc': [0.7488041745122863], 'loss': [0.503409282822318]}
Saved model to disk



2

Epoch 1/1
 - 513s - loss: 0.3623 - acc: 0.8325

Test accuracy: 84.76821192052981

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1268

choose_one :  997

F1score :  0.8379520901831847

AUC : 0.9312466668122094

Confusion Matrix
[[1028  105]
 [ 240  892]]
True label 0
0.9073256840247131  
0.09267431597528684  
True label 1
0.21201413427561838  
0.7879858657243817  

Train_result {'acc': [0.8324878001325965], 'loss': [0.36229597286434573]}
Saved model to disk



3

Epoch 1/1
 - 498s - loss: 0.3073 - acc: 0.8628

Test accuracy: 84.90066225165563

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1135

choose_one :  1130

F1score :  0.8488063660477453

AUC : 0.9349634635836565

Confusion Matrix
[[963 170]
 [172 960]]
True label 0
0.8499558693733451  
0.1500441306266549  
True label 1
0.1519434628975265  
0.8480565371024735  

Train_result {'acc': [0.8627820457416657], 'loss': [0.30734891386955276]}
Saved model to disk



4

Epoch 1/1
 - 498s - loss: 0.2640 - acc: 0.8848

Test accuracy: 87.28476821192052

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1185

choose_one :  1080

F1score :  0.8698010849909584

AUC : 0.9467999837823847

Confusion Matrix
[[1015  118]
 [ 170  962]]
True label 0
0.8958517210944396  
0.10414827890556046  
True label 1
0.1501766784452297  
0.8498233215547704  

Train_result {'acc': [0.884814224298112], 'loss': [0.26399428815682013]}
Saved model to disk



5

Epoch 1/1
 - 494s - loss: 0.2293 - acc: 0.9030

Test accuracy: 87.3289183222958

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1226

choose_one :  1039

F1score :  0.8678028558268078

AUC : 0.9502618209263376

Confusion Matrix
[[1036   97]
 [ 190  942]]
True label 0
0.9143865842894969  
0.08561341571050309  
True label 1
0.16784452296819788  
0.8321554770318021  

Train_result {'acc': [0.9030294245744424], 'loss': [0.2293375913033412]}
Saved model to disk



6

Epoch 1/1
 - 497s - loss: 0.2041 - acc: 0.9161

Test accuracy: 86.84326710816777

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1151

choose_one :  1114

F1score :  0.8673196794300979

AUC : 0.9510079871756087

Confusion Matrix
[[993 140]
 [158 974]]
True label 0
0.8764342453662842  
0.1235657546337158  
True label 1
0.13957597173144876  
0.8604240282685512  

Train_result {'acc': [0.916123109649574], 'loss': [0.20411449429170633]}
Saved model to disk



7

Epoch 1/1
 - 496s - loss: 0.1752 - acc: 0.9287

Test accuracy: 87.41721854304636

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1170

choose_one :  1095

F1score :  0.8720251459362371

AUC : 0.951652013635272

Confusion Matrix
[[1009  124]
 [ 161  971]]
True label 0
0.8905560458958517  
0.10944395410414828  
True label 1
0.142226148409894  
0.857773851590106  

Train_result {'acc': [0.9287336328677372], 'loss': [0.17517583809575926]}
Saved model to disk



8

Epoch 1/1
 - 500s - loss: 0.1493 - acc: 0.9402

Test accuracy: 87.37306843267109

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1127

choose_one :  1138

F1score :  0.8740088105726873

AUC : 0.9516808622781384

Confusion Matrix
[[987 146]
 [140 992]]
True label 0
0.8711385701676964  
0.12886142983230361  
True label 1
0.12367491166077739  
0.8763250883392226  

Train_result {'acc': [0.9402328839669304], 'loss': [0.14932215491071002]}
Saved model to disk



9

Epoch 1/1
 - 503s - loss: 0.1309 - acc: 0.9484

Test accuracy: 88.30022075055187

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1176

choose_one :  1089

F1score :  0.8806843764070239

AUC : 0.9569625030018182

Confusion Matrix
[[1022  111]
 [ 154  978]]
True label 0
0.9020300088261254  
0.09796999117387467  
True label 1
0.13604240282685512  
0.8639575971731449  

Train_result {'acc': [0.9484466347520684], 'loss': [0.13088080479894887]}
Saved model to disk



10

Epoch 1/1
 - 502s - loss: 0.1156 - acc: 0.9554

Test accuracy: 88.96247240618102

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1163

choose_one :  1102

F1score :  0.8880931065353626

AUC : 0.9537934405983053

Confusion Matrix
[[1023  110]
 [ 140  992]]
True label 0
0.9029126213592233  
0.0970873786407767  
True label 1
0.12367491166077739  
0.8763250883392226  

Train_result {'acc': [0.955404164828891], 'loss': [0.11559503357563179]}
Saved model to disk



11

Epoch 1/1
 - 502s - loss: 0.1001 - acc: 0.9621

Test accuracy: 88.56512141280352

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1178

choose_one :  1087

F1score :  0.8832807570977917

AUC : 0.9561796911791768

Confusion Matrix
[[1026  107]
 [ 152  980]]
True label 0
0.9055604589585172  
0.09443954104148279  
True label 1
0.13427561837455831  
0.8657243816254417  

Train_result {'acc': [0.9621201140463465], 'loss': [0.10011324412131152]}
Saved model to disk



12

Epoch 1/1
 - 504s - loss: 0.0906 - acc: 0.9660

Test accuracy: 89.71302428256071

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1160

choose_one :  1105

F1score :  0.8958426464014305

AUC : 0.9596582917237142

Confusion Matrix
[[1030  103]
 [ 130 1002]]
True label 0
0.9090909090909091  
0.09090909090909091  
True label 1
0.11484098939929328  
0.8851590106007067  

Train_result {'acc': [0.9659854084873923], 'loss': [0.09064662053645803]}
Saved model to disk



13

Epoch 1/1
 - 505s - loss: 0.0815 - acc: 0.9701

Test accuracy: 89.49227373068432

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1167

choose_one :  1098

F1score :  0.8932735426008968

AUC : 0.9578045714962933

Confusion Matrix
[[1031  102]
 [ 136  996]]
True label 0
0.909973521624007  
0.09002647837599294  
True label 1
0.12014134275618374  
0.8798586572438163  

Train_result {'acc': [0.9700922838799613], 'loss': [0.08150548878470396]}
Saved model to disk



14

Epoch 1/1
 - 505s - loss: 0.0761 - acc: 0.9731

Test accuracy: 88.91832229580574

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1128

choose_one :  1137

F1score :  0.8893785808726312

AUC : 0.9588267490854202

Confusion Matrix
[[1005  128]
 [ 123 1009]]
True label 0
0.8870255957634599  
0.11297440423654016  
True label 1
0.10865724381625441  
0.8913427561837456  

Train_result {'acc': [0.97313620331449], 'loss': [0.07607650963039043]}
Saved model to disk



15

Epoch 1/1
 - 508s - loss: 0.0689 - acc: 0.9757

Test accuracy: 88.8300220750552

data size :  22962

zero :  11482

one :  11480

train_zero :  10349

train_one :  10348

test_zero :  1133

test_one :  1132

choose_zero :  1148

choose_one :  1117

F1score :  0.8875055580257893

AUC : 0.9575461032500725

Confusion Matrix
[[1014  119]
 [ 134  998]]
True label 0
0.8949691085613416  
0.10503089143865843  
True label 1
0.11837455830388692  
0.8816254416961131  

Train_result {'acc': [0.9757452770932985], 'loss': [0.06887923692565551]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:522: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-25 00:20:36.774661: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-25 00:20:36.785255: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-25 00:20:36.787296: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x72115c0 executing computations on platform Host. Devices:
2019-07-25 00:20:36.787336: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
26276
one : 
22977

Second data
zero : 
26276
one : 
22977

hbase-AST

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23382
Over 200, Under 400 : 1548
Over 400 : 0


hbase-code

Sentence length Average : 88

Under 10 : 0
Over 10, Under 200 : 22169
Over 200, Under 400 : 2761
Over 400 : 0


Test_zero:  1043
Train_zero:  9343
zero:  10386
Test_one:  1725
Train_one:  15587
one:  17312
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1047s - loss: 0.4494 - acc: 0.7900

Test accuracy: 81.83996166746526

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1326

choose_one :  761

F1score :  0.790027700831025

AUC : 0.9209012464046021

Confusion Matrix
[[995  48]
 [331 713]]
True label 0
0.9539789069990412  
0.046021093000958774  
True label 1
0.3170498084291188  
0.6829501915708812  

Train_result {'loss': [0.4494099062391261], 'acc': [0.789960935419212]}
Saved model to disk



2

Epoch 1/1
 - 973s - loss: 0.3133 - acc: 0.8605

Test accuracy: 87.3981792045999

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1026

choose_one :  1061

F1score :  0.8750593824228028

AUC : 0.9510070787552851

Confusion Matrix
[[903 140]
 [123 921]]
True label 0
0.8657718120805369  
0.1342281879194631  
True label 1
0.11781609195402298  
0.882183908045977  

Train_result {'loss': [0.3132997166608395], 'acc': [0.8605447637012225]}
Saved model to disk



3

Epoch 1/1
 - 895s - loss: 0.2635 - acc: 0.8845

Test accuracy: 88.06899856252994

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1132

choose_one :  955

F1score :  0.8754377188594297

AUC : 0.9538797236089529

Confusion Matrix
[[963  80]
 [169 875]]
True label 0
0.9232981783317353  
0.07670182166826463  
True label 1
0.16187739463601533  
0.8381226053639846  

Train_result {'loss': [0.26349462034576376], 'acc': [0.8845186493315997]}
Saved model to disk



4

Epoch 1/1
 - 880s - loss: 0.2277 - acc: 0.9042

Test accuracy: 88.73981792046

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1190

choose_one :  897

F1score :  0.8789283874291602

AUC : 0.9620889858682036

Confusion Matrix
[[999  44]
 [191 853]]
True label 0
0.9578139980824545  
0.04218600191754554  
True label 1
0.18295019157088122  
0.8170498084291188  

Train_result {'loss': [0.22768713936011123], 'acc': [0.9042114838810266]}
Saved model to disk



5

Epoch 1/1
 - 882s - loss: 0.1926 - acc: 0.9178

Test accuracy: 90.70436032582656

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1053

choose_one :  1034

F1score :  0.9066410009624639

AUC : 0.9663713205717371

Confusion Matrix
[[951  92]
 [102 942]]
True label 0
0.9117929050814957  
0.08820709491850431  
True label 1
0.09770114942528736  
0.9022988505747126  

Train_result {'loss': [0.19256730759991314], 'acc': [0.9177503077005404]}
Saved model to disk



6

Epoch 1/1
 - 888s - loss: 0.1679 - acc: 0.9302

Test accuracy: 90.17728797316722

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1100

choose_one :  987

F1score :  0.8990645002461841

AUC : 0.9664002490605128

Confusion Matrix
[[969  74]
 [131 913]]
True label 0
0.9290508149568553  
0.07094918504314478  
True label 1
0.12547892720306514  
0.8745210727969349  

Train_result {'loss': [0.16790078207272335], 'acc': [0.930218868738653]}
Saved model to disk



7

Epoch 1/1
 - 889s - loss: 0.1455 - acc: 0.9416

Test accuracy: 91.13560134163872

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1098

choose_one :  989

F1score :  0.9090014756517462

AUC : 0.9672515731587706

Confusion Matrix
[[978  65]
 [120 924]]
True label 0
0.9376797698945349  
0.062320230105465  
True label 1
0.11494252873563218  
0.8850574712643678  

Train_result {'loss': [0.14548680858725738], 'acc': [0.941563653832372]}
Saved model to disk



8

Epoch 1/1
 - 891s - loss: 0.1209 - acc: 0.9519

Test accuracy: 90.84810733109727

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1026

choose_one :  1061

F1score :  0.9092636579572446

AUC : 0.9708469710494705

Confusion Matrix
[[939 104]
 [ 87 957]]
True label 0
0.900287631831256  
0.09971236816874401  
True label 1
0.08333333333333333  
0.9166666666666666  

Train_result {'loss': [0.12091985205818845], 'acc': [0.9519452025025705]}
Saved model to disk



9

Epoch 1/1
 - 889s - loss: 0.1021 - acc: 0.9591

Test accuracy: 90.65644465740297

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1076

choose_one :  1011

F1score :  0.9051094890510949

AUC : 0.9681235604632967

Confusion Matrix
[[962  81]
 [114 930]]
True label 0
0.9223394055608821  
0.07766059443911794  
True label 1
0.10919540229885058  
0.8908045977011494  

Train_result {'loss': [0.10214889812131063], 'acc': [0.9591159629720984]}
Saved model to disk



10

Epoch 1/1
 - 889s - loss: 0.0831 - acc: 0.9683

Test accuracy: 91.18351701006229

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1073

choose_one :  1014

F1score :  0.9105928085519922

AUC : 0.9666867788541011

Confusion Matrix
[[966  77]
 [107 937]]
True label 0
0.9261744966442953  
0.0738255033557047  
True label 1
0.1024904214559387  
0.8975095785440613  

Train_result {'loss': [0.08312410036280457], 'acc': [0.9683202226146519]}
Saved model to disk



11

Epoch 1/1
 - 890s - loss: 0.0748 - acc: 0.9725

Test accuracy: 90.94393866794441

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1102

choose_one :  985

F1score :  0.9068506653523903

AUC : 0.9673401953545439

Confusion Matrix
[[978  65]
 [124 920]]
True label 0
0.9376797698945349  
0.062320230105465  
True label 1
0.11877394636015326  
0.8812260536398467  

Train_result {'loss': [0.07482247105880103], 'acc': [0.972494247289877]}
Saved model to disk



12

Epoch 1/1
 - 888s - loss: 0.0635 - acc: 0.9767

Test accuracy: 91.51892668902731

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1076

choose_one :  1011

F1score :  0.9138686131386861

AUC : 0.9694092710755522

Confusion Matrix
[[971  72]
 [105 939]]
True label 0
0.9309683604985618  
0.06903163950143816  
True label 1
0.10057471264367816  
0.8994252873563219  

Train_result {'loss': [0.06353406433790096], 'acc': [0.9766682720607909]}
Saved model to disk



13

Epoch 1/1
 - 890s - loss: 0.0564 - acc: 0.9798

Test accuracy: 91.27934834690944

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1057

choose_one :  1030

F1score :  0.9122468659594986

AUC : 0.9696122296793438

Confusion Matrix
[[959  84]
 [ 98 946]]
True label 0
0.9194630872483222  
0.08053691275167785  
True label 1
0.09386973180076628  
0.9061302681992337  

Train_result {'loss': [0.056366931465228386], 'acc': [0.9797720340343554]}
Saved model to disk



14

Epoch 1/1
 - 891s - loss: 0.0500 - acc: 0.9831

Test accuracy: 90.36895064686152

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1066

choose_one :  1021

F1score :  0.9026634382566586

AUC : 0.966230810769112

Confusion Matrix
[[954  89]
 [112 932]]
True label 0
0.9146692233940557  
0.08533077660594439  
True label 1
0.10727969348659004  
0.89272030651341  

Train_result {'loss': [0.049986441956153635], 'acc': [0.983089848557821]}
Saved model to disk



15

Epoch 1/1
 - 889s - loss: 0.0465 - acc: 0.9845

Test accuracy: 89.45855294681361

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  957

choose_one :  1130

F1score :  0.8988040478380865

AUC : 0.9663175962354393

Confusion Matrix
[[890 153]
 [ 67 977]]
True label 0
0.8533077660594439  
0.14669223394055608  
True label 1
0.06417624521072797  
0.935823754789272  

Train_result {'loss': [0.04650887770175026], 'acc': [0.9845347032696526]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-24 12:39:28.878141: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-24 12:39:28.888618: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-24 12:39:28.890731: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x72c5f40 executing computations on platform Host. Devices:
2019-07-24 12:39:28.890771: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
26276
one : 
22977

Second data
zero : 
26276
one : 
22977

hbase-AST

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23382
Over 200, Under 400 : 1548
Over 400 : 0


hbase-code

Sentence length Average : 88

Under 10 : 0
Over 10, Under 200 : 22169
Over 200, Under 400 : 2761
Over 400 : 0


Test_zero:  1043
Train_zero:  9343
zero:  10386
Test_one:  1725
Train_one:  15587
one:  17312
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 762s - loss: 0.4217 - acc: 0.8072

Test accuracy: 84.23574508864398

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1162

choose_one :  925

F1score :  0.8329101066531234

AUC : 0.9283895923562668

Confusion Matrix
[[938 105]
 [224 820]]
True label 0
0.8993288590604027  
0.10067114093959731  
True label 1
0.21455938697318008  
0.7854406130268199  

Train_result {'acc': [0.8072456787726837], 'loss': [0.42172265251828417]}
Saved model to disk



2

Epoch 1/1
 - 773s - loss: 0.3048 - acc: 0.8623

Test accuracy: 87.30234786775274

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1138

choose_one :  949

F1score :  0.8670346211741093

AUC : 0.9454270946980967

Confusion Matrix
[[958  85]
 [180 864]]
True label 0
0.9185043144774688  
0.08149568552253116  
True label 1
0.1724137931034483  
0.8275862068965517  

Train_result {'acc': [0.8623106972315264], 'loss': [0.30479519994347426]}
Saved model to disk



3

Epoch 1/1
 - 774s - loss: 0.2601 - acc: 0.8865

Test accuracy: 89.12314326784858

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1052

choose_one :  1035

F1score :  0.8908128908128908

AUC : 0.9633324517031991

Confusion Matrix
[[934 109]
 [118 926]]
True label 0
0.8954937679769894  
0.10450623202301054  
True label 1
0.11302681992337164  
0.8869731800766284  

Train_result {'acc': [0.886498635418184], 'loss': [0.26014983345425363]}
Saved model to disk



4

Epoch 1/1
 - 774s - loss: 0.2239 - acc: 0.9060

Test accuracy: 90.2252036415908

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  971

choose_one :  1116

F1score :  0.9055555555555556

AUC : 0.9712019190149254

Confusion Matrix
[[905 138]
 [ 66 978]]
True label 0
0.8676893576222435  
0.13231064237775647  
True label 1
0.06321839080459771  
0.9367816091954023  

Train_result {'acc': [0.9060309306030296], 'loss': [0.2238719365123685]}
Saved model to disk



5

Epoch 1/1
 - 773s - loss: 0.1932 - acc: 0.9202

Test accuracy: 90.8001916626737

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1169

choose_one :  918

F1score :  0.9021406727828746

AUC : 0.970684879675854

Confusion Matrix
[[1010   33]
 [ 159  885]]
True label 0
0.9683604985618408  
0.031639501438159155  
True label 1
0.15229885057471265  
0.8477011494252874  

Train_result {'acc': [0.9202119120307812], 'loss': [0.19318507589344394]}
Saved model to disk



6

Epoch 1/1
 - 773s - loss: 0.1646 - acc: 0.9355

Test accuracy: 90.70436032582656

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1137

choose_one :  950

F1score :  0.9027081243731193

AUC : 0.9719306414226572

Confusion Matrix
[[993  50]
 [144 900]]
True label 0
0.9520613614573347  
0.04793863854266539  
True label 1
0.13793103448275862  
0.8620689655172413  

Train_result {'acc': [0.9354631561570038], 'loss': [0.16455734950315515]}
Saved model to disk



7

Epoch 1/1
 - 773s - loss: 0.1459 - acc: 0.9417

Test accuracy: 92.18974604695735

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1098

choose_one :  989

F1score :  0.9198229217904574

AUC : 0.9727590064028389

Confusion Matrix
[[989  54]
 [109 935]]
True label 0
0.9482262703739214  
0.05177372962607862  
True label 1
0.10440613026819924  
0.8955938697318008  

Train_result {'acc': [0.9417241932926422], 'loss': [0.14594667450701143]}
Saved model to disk



8

Epoch 1/1
 - 773s - loss: 0.1241 - acc: 0.9518

Test accuracy: 91.99808337326306

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1064

choose_one :  1023

F1score :  0.919206579583938

AUC : 0.9731557399631918

Confusion Matrix
[[970  73]
 [ 94 950]]
True label 0
0.9300095877277086  
0.06999041227229147  
True label 1
0.09003831417624521  
0.9099616858237548  

Train_result {'acc': [0.9517846631379893], 'loss': [0.12406700216470959]}
Saved model to disk



9

Epoch 1/1
 - 773s - loss: 0.1026 - acc: 0.9602

Test accuracy: 91.90225203641592

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1106

choose_one :  981

F1score :  0.9165432098765431

AUC : 0.97431838970256

Confusion Matrix
[[990  53]
 [116 928]]
True label 0
0.9491850431447747  
0.05081495685522531  
True label 1
0.1111111111111111  
0.8888888888888888  

Train_result {'acc': [0.960186225673759], 'loss': [0.10260098324935119]}
Saved model to disk



10

Epoch 1/1
 - 774s - loss: 0.0905 - acc: 0.9674

Test accuracy: 92.04599904168663

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1081

choose_one :  1006

F1score :  0.9190243902439024

AUC : 0.97335456592573

Confusion Matrix
[[979  64]
 [102 942]]
True label 0
0.9386385426653883  
0.061361457334611694  
True label 1
0.09770114942528736  
0.9022988505747126  

Train_result {'acc': [0.967356986092253], 'loss': [0.09050709467181688]}
Saved model to disk



11

Epoch 1/1
 - 774s - loss: 0.0749 - acc: 0.9710

Test accuracy: 91.66267369429804

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1047

choose_one :  1040

F1score :  0.9165067178502879

AUC : 0.9743978282511029

Confusion Matrix
[[958  85]
 [ 89 955]]
True label 0
0.9185043144774688  
0.08149568552253116  
True label 1
0.08524904214559387  
0.9147509578544061  

Train_result {'acc': [0.9710493925780452], 'loss': [0.07485693954028018]}
Saved model to disk



12

Epoch 1/1
 - 773s - loss: 0.0611 - acc: 0.9784

Test accuracy: 91.61475802587447

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1126

choose_one :  961

F1score :  0.912718204488778

AUC : 0.9742642061839006

Confusion Matrix
[[997  46]
 [129 915]]
True label 0
0.9558964525407478  
0.04410354745925216  
True label 1
0.1235632183908046  
0.8764367816091954  

Train_result {'acc': [0.9783806924599989], 'loss': [0.06113550043703497]}
Saved model to disk



13

Epoch 1/1
 - 775s - loss: 0.0569 - acc: 0.9806

Test accuracy: 92.33349305222808

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1087

choose_one :  1000

F1score :  0.9217221135029353

AUC : 0.9762368536089897

Confusion Matrix
[[985  58]
 [102 942]]
True label 0
0.9443911792905082  
0.05560882070949185  
True label 1
0.09770114942528736  
0.9022988505747126  

Train_result {'acc': [0.9806282442339594], 'loss': [0.05685741152638365]}
Saved model to disk



14

Epoch 1/1
 - 783s - loss: 0.0466 - acc: 0.9830

Test accuracy: 91.99808337326306

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1028

choose_one :  1059

F1score :  0.9205896338563956

AUC : 0.9735194123935157

Confusion Matrix
[[952  91]
 [ 76 968]]
True label 0
0.912751677852349  
0.087248322147651  
True label 1
0.07279693486590039  
0.9272030651340997  

Train_result {'acc': [0.9829828222828705], 'loss': [0.04663619968710278]}
Saved model to disk



15

Epoch 1/1
 - 782s - loss: 0.0445 - acc: 0.9854

Test accuracy: 91.85433636799233

data size :  20774

zero :  10386

one :  10388

train_zero :  9343

train_one :  9344

test_zero :  1043

test_one :  1044

choose_zero :  1075

choose_one :  1012

F1score :  0.9173151750972763

AUC : 0.975093948711167

Confusion Matrix
[[974  69]
 [101 943]]
True label 0
0.9338446788111218  
0.06615532118887824  
True label 1
0.09674329501915709  
0.9032567049808429  

Train_result {'acc': [0.9854444266067319], 'loss': [0.04450031403659883]}
Saved model to disk




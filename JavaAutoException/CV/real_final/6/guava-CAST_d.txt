Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:522: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 14:30:02.156419: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 14:30:02.257807: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-22 14:30:02.275530: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6382030 executing computations on platform Host. Devices:
2019-07-22 14:30:02.275568: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41860
one : 
17294

Second data
zero : 
41860
one : 
17294

guava-AST

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32760
Over 200, Under 400 : 272
Over 400 : 0


guava-code

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 32131
Over 200, Under 400 : 901
Over 400 : 0


Test_zero:  2228
Train_zero:  20433
zero:  22661
Test_one:  1464
Train_one:  12599
one:  14063
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1299s - loss: 0.2895 - acc: 0.8771

Test accuracy: 91.77193581427107

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1628

choose_one :  1301

F1score :  0.9128390596745027

AUC : 0.9770818180122719

Confusion Matrix
[[1426   39]
 [ 202 1262]]
True label 0
0.9733788395904437  
0.026621160409556314  
True label 1
0.13797814207650272  
0.8620218579234973  

Train_result {'loss': [0.2894600942965074], 'acc': [0.8770982975514902]}
Saved model to disk



2

Epoch 1/1
 - 1196s - loss: 0.1779 - acc: 0.9306

Test accuracy: 94.67395015363606

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1497

choose_one :  1432

F1score :  0.9461325966850829

AUC : 0.9877114455696675

Confusion Matrix
[[1403   62]
 [  94 1370]]
True label 0
0.957679180887372  
0.042320819112627986  
True label 1
0.06420765027322405  
0.9357923497267759  

Train_result {'loss': [0.17786787684483965], 'acc': [0.9305924838287234]}
Saved model to disk



3

Epoch 1/1
 - 1173s - loss: 0.1309 - acc: 0.9525

Test accuracy: 95.11778764083306

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1480

choose_one :  1449

F1score :  0.9509097150703741

AUC : 0.9908600496092804

Confusion Matrix
[[1401   64]
 [  79 1385]]
True label 0
0.9563139931740614  
0.04368600682593857  
True label 1
0.05396174863387978  
0.9460382513661202  

Train_result {'loss': [0.13089534772979186], 'acc': [0.9525377991190127]}
Saved model to disk



4

Epoch 1/1
 - 1160s - loss: 0.0963 - acc: 0.9655

Test accuracy: 96.48344144759304

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1436

choose_one :  1493

F1score :  0.965167399391275

AUC : 0.993961562132826

Confusion Matrix
[[1399   66]
 [  37 1427]]
True label 0
0.9549488054607509  
0.04505119453924915  
True label 1
0.025273224043715847  
0.9747267759562842  

Train_result {'loss': [0.09630465715954457], 'acc': [0.9655145045461965]}
Saved model to disk



5

Epoch 1/1
 - 1162s - loss: 0.0706 - acc: 0.9746

Test accuracy: 96.65414817343803

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1451

choose_one :  1478

F1score :  0.9666893269884432

AUC : 0.9956148939741509

Confusion Matrix
[[1409   56]
 [  42 1422]]
True label 0
0.9617747440273038  
0.03822525597269624  
True label 1
0.028688524590163935  
0.9713114754098361  

Train_result {'loss': [0.07057572586456802], 'acc': [0.9746021667526489]}
Saved model to disk



6

Epoch 1/1
 - 1163s - loss: 0.0532 - acc: 0.9812

Test accuracy: 97.06384431546603

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1461

choose_one :  1468

F1score :  0.970668485675307

AUC : 0.9968374083813575

Confusion Matrix
[[1420   45]
 [  41 1423]]
True label 0
0.9692832764505119  
0.030716723549488054  
True label 1
0.028005464480874317  
0.9719945355191257  

Train_result {'loss': [0.05316789977203947], 'acc': [0.9812294138656296]}
Saved model to disk



7

Epoch 1/1
 - 1170s - loss: 0.0439 - acc: 0.9846

Test accuracy: 97.47354045749402

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1455

choose_one :  1474

F1score :  0.9748127978216474

AUC : 0.9975330573117738

Confusion Matrix
[[1423   42]
 [  32 1432]]
True label 0
0.9713310580204778  
0.028668941979522185  
True label 1
0.02185792349726776  
0.9781420765027322  

Train_result {'loss': [0.04389869531894655], 'acc': [0.9846422477082424]}
Saved model to disk



8

Epoch 1/1
 - 1182s - loss: 0.0355 - acc: 0.9885

Test accuracy: 97.98566063502902

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1466

choose_one :  1463

F1score :  0.9798428425008542

AUC : 0.996910843171264

Confusion Matrix
[[1436   29]
 [  30 1434]]
True label 0
0.9802047781569966  
0.019795221843003412  
True label 1
0.020491803278688523  
0.9795081967213115  

Train_result {'loss': [0.03552367097120804], 'acc': [0.9884916068121594]}
Saved model to disk



9

Epoch 1/1
 - 1169s - loss: 0.0291 - acc: 0.9906

Test accuracy: 98.05394332536702

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1456

choose_one :  1473

F1score :  0.9805924412665985

AUC : 0.9969987317928347

Confusion Matrix
[[1432   33]
 [  24 1440]]
True label 0
0.9774744027303754  
0.022525597269624574  
True label 1
0.01639344262295082  
0.9836065573770492  

Train_result {'loss': [0.029052882128486956], 'acc': [0.9905551807611414]}
Saved model to disk



10

Epoch 1/1
 - 1179s - loss: 0.0286 - acc: 0.9912

Test accuracy: 97.88323659952202

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1433

choose_one :  1496

F1score :  0.9790540540540541

AUC : 0.9965124302952312

Confusion Matrix
[[1418   47]
 [  15 1449]]
True label 0
0.9679180887372013  
0.032081911262798635  
True label 1
0.010245901639344262  
0.9897540983606558  

Train_result {'loss': [0.028644651858693485], 'acc': [0.9911901265923251]}
Saved model to disk



11

Epoch 1/1
 - 1163s - loss: 0.0260 - acc: 0.9929

Test accuracy: 98.25879139638101

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1462

choose_one :  1467

F1score :  0.9825997952917094

AUC : 0.9973390962158936

Confusion Matrix
[[1438   27]
 [  24 1440]]
True label 0
0.9815699658703072  
0.018430034129692834  
True label 1
0.01639344262295082  
0.9836065573770492  

Train_result {'loss': [0.026034256251507668], 'acc': [0.9929362276280804]}
Saved model to disk



12

Epoch 1/1
 - 1181s - loss: 0.0229 - acc: 0.9942

Test accuracy: 98.39535677705702

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1472

choose_one :  1457

F1score :  0.9839096199931531

AUC : 0.9967795930547008

Confusion Matrix
[[1445   20]
 [  27 1437]]
True label 0
0.9863481228668942  
0.013651877133105802  
True label 1
0.018442622950819672  
0.9815573770491803  

Train_result {'loss': [0.022936185446216444], 'acc': [0.994245803404897]}
Saved model to disk



13

Epoch 1/1
 - 1172s - loss: 0.0185 - acc: 0.9944

Test accuracy: 98.80505291908501

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1466

choose_one :  1463

F1score :  0.9880423641954219

AUC : 0.996177427777467

Confusion Matrix
[[1448   17]
 [  18 1446]]
True label 0
0.9883959044368601  
0.011604095563139932  
True label 1
0.012295081967213115  
0.9877049180327869  

Train_result {'loss': [0.0185029950717133], 'acc': [0.994364855748244]}
Saved model to disk



14

Epoch 1/1
 - 1173s - loss: 0.0197 - acc: 0.9949

Test accuracy: 98.36121543188801

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1465

choose_one :  1464

F1score :  0.9836065573770492

AUC : 0.9964541487159403

Confusion Matrix
[[1441   24]
 [  24 1440]]
True label 0
0.9836177474402731  
0.016382252559726963  
True label 1
0.01639344262295082  
0.9836065573770492  

Train_result {'loss': [0.019719388126409613], 'acc': [0.9948807492360808]}
Saved model to disk



15

Epoch 1/1
 - 1166s - loss: 0.0208 - acc: 0.9942

Test accuracy: 98.66848753840901

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1462

choose_one :  1467

F1score :  0.9866939611054248

AUC : 0.9974388742796396

Confusion Matrix
[[1444   21]
 [  18 1446]]
True label 0
0.985665529010239  
0.014334470989761093  
True label 1
0.012295081967213115  
0.9877049180327869  

Train_result {'loss': [0.020819191375703268], 'acc': [0.994245803404897]}
Saved model to disk




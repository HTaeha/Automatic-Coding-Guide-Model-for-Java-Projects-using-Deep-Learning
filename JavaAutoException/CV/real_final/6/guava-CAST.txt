Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 14:52:17.439499: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 14:52:17.453338: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-21 14:52:17.461611: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8119330 executing computations on platform Host. Devices:
2019-07-21 14:52:17.461652: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-CAST
all data

Sentence length Average : 64

Under 10 : 4040
Over 10, Under 200 : 51774
Over 200, Under 400 : 2750
Over 400 : 590

guava-CAST
updated_train_data

Sentence length Average : 66

Under 10 : 0
Over 10, Under 200 : 46495
Over 200, Under 400 : 2940
Over 400 : 0


Test_zero:  3788
Train_zero:  34667
zero:  38455
Test_one:  1707
Train_one:  14768
one:  16475

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 646s - loss: 0.3183 - acc: 0.8590

Test accuracy: 91.12737920937043

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1789

choose_one :  1626

F1score :  0.9090909090909091

AUC : 0.9718948975769972

Confusion Matrix
[[1597  111]
 [ 192 1515]]
True label 0
0.9350117096018735  
0.06498829039812647  
True label 1
0.11247803163444639  
0.8875219683655536  

Train_result {'loss': [0.31828126985569466], 'acc': [0.8589565629549378]}
Saved model to disk



2

Epoch 1/1
 - 643s - loss: 0.2071 - acc: 0.9165

Test accuracy: 93.00146412884334

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1725

choose_one :  1690

F1score :  0.9296438033559024

AUC : 0.9830721824585088

Confusion Matrix
[[1597  111]
 [ 128 1579]]
True label 0
0.9350117096018735  
0.06498829039812647  
True label 1
0.07498535442296426  
0.9250146455770357  

Train_result {'loss': [0.20713758760425743], 'acc': [0.9164776382164742]}
Saved model to disk



3

Epoch 1/1
 - 647s - loss: 0.1577 - acc: 0.9390

Test accuracy: 90.92240117130308

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1500

choose_one :  1915

F1score :  0.9144119271120928

AUC : 0.983657834046062

Confusion Matrix
[[1449  259]
 [  51 1656]]
True label 0
0.8483606557377049  
0.15163934426229508  
True label 1
0.029876977152899824  
0.9701230228471002  

Train_result {'loss': [0.1577291175227161], 'acc': [0.9389579171886109]}
Saved model to disk



4

Epoch 1/1
 - 650s - loss: 0.1265 - acc: 0.9505

Test accuracy: 94.64128843338214

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1725

choose_one :  1690

F1score :  0.9461289372976156

AUC : 0.9891317470835751

Confusion Matrix
[[1625   83]
 [ 100 1607]]
True label 0
0.9514051522248244  
0.04859484777517564  
True label 1
0.05858230814294083  
0.9414176918570591  

Train_result {'loss': [0.12652184872540215], 'acc': [0.9504689034092833]}
Saved model to disk



5

Epoch 1/1
 - 644s - loss: 0.1019 - acc: 0.9632

Test accuracy: 94.78770131771596

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1644

choose_one :  1771

F1score :  0.948821161587119

AUC : 0.9909339762295768

Confusion Matrix
[[1587  121]
 [  57 1650]]
True label 0
0.9291569086651054  
0.07084309133489461  
True label 1
0.033391915641476276  
0.9666080843585237  

Train_result {'loss': [0.10190966850929938], 'acc': [0.9631648440938484]}
Saved model to disk



6

Epoch 1/1
 - 644s - loss: 0.0812 - acc: 0.9708

Test accuracy: 95.78330893118594

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1754

choose_one :  1661

F1score :  0.9572446555819477

AUC : 0.9921075088250748

Confusion Matrix
[[1659   49]
 [  95 1612]]
True label 0
0.9713114754098361  
0.028688524590163935  
True label 1
0.05565319273579379  
0.9443468072642062  

Train_result {'loss': [0.08115926878712523], 'acc': [0.970816264346413]}
Saved model to disk



7

Epoch 1/1
 - 644s - loss: 0.0687 - acc: 0.9753

Test accuracy: 96.33967789165446

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1707

choose_one :  1708

F1score :  0.9633967789165447

AUC : 0.9923006109297849

Confusion Matrix
[[1645   63]
 [  62 1645]]
True label 0
0.9631147540983607  
0.036885245901639344  
True label 1
0.03632103104862332  
0.9636789689513767  

Train_result {'loss': [0.0686876246942377], 'acc': [0.9752513796255544]}
Saved model to disk



8

Epoch 1/1
 - 644s - loss: 0.0623 - acc: 0.9788

Test accuracy: 96.19326500732065

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1712

choose_one :  1703

F1score :  0.9618768328445748

AUC : 0.992354460006942

Confusion Matrix
[[1645   63]
 [  67 1640]]
True label 0
0.9631147540983607  
0.036885245901639344  
True label 1
0.03925014645577036  
0.9607498535442296  

Train_result {'loss': [0.06233638517338916], 'acc': [0.9788400988590581]}
Saved model to disk



9

Epoch 1/1
 - 644s - loss: 0.0557 - acc: 0.9814

Test accuracy: 96.66178623718888

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1712

choose_one :  1703

F1score :  0.9665689149560117

AUC : 0.9930538120344798

Confusion Matrix
[[1653   55]
 [  59 1648]]
True label 0
0.9677985948477752  
0.032201405152224825  
True label 1
0.03456356180433509  
0.9654364381956649  

Train_result {'loss': [0.05567129812073238], 'acc': [0.9814131428377967]}
Saved model to disk



10

Epoch 1/1
 - 643s - loss: 0.0479 - acc: 0.9838

Test accuracy: 96.48609077598829

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1692

choose_one :  1723

F1score :  0.9650145772594753

AUC : 0.9934376153296318

Confusion Matrix
[[1640   68]
 [  52 1655]]
True label 0
0.9601873536299765  
0.03981264637002342  
True label 1
0.03046280023432923  
0.9695371997656708  

Train_result {'loss': [0.04793243858254859], 'acc': [0.9837830517655821]}
Saved model to disk



11

Epoch 1/1
 - 643s - loss: 0.0434 - acc: 0.9861

Test accuracy: 96.89604685212299

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1692

choose_one :  1723

F1score :  0.9690962099125365

AUC : 0.9941484574468815

Confusion Matrix
[[1647   61]
 [  45 1662]]
True label 0
0.9642857142857143  
0.03571428571428571  
True label 1
0.026362038664323375  
0.9736379613356766  

Train_result {'loss': [0.043356690994049984], 'acc': [0.9860513931678911]}
Saved model to disk



12

Epoch 1/1
 - 642s - loss: 0.0428 - acc: 0.9868

Test accuracy: 97.24743777452416

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1698

choose_one :  1717

F1score :  0.9725467289719626

AUC : 0.9942379772503084

Confusion Matrix
[[1656   52]
 [  42 1665]]
True label 0
0.9695550351288056  
0.03044496487119438  
True label 1
0.02460456942003515  
0.9753954305799648  

Train_result {'loss': [0.042807220354874075], 'acc': [0.9867962216880523]}
Saved model to disk



13

Epoch 1/1
 - 643s - loss: 0.0394 - acc: 0.9876

Test accuracy: 96.98389458272328

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1679

choose_one :  1736

F1score :  0.9700842288701713

AUC : 0.9929598333902692

Confusion Matrix
[[1642   66]
 [  37 1670]]
True label 0
0.9613583138173302  
0.03864168618266979  
True label 1
0.021675454012888107  
0.9783245459871119  

Train_result {'loss': [0.039357359858428316], 'acc': [0.987574906050039]}
Saved model to disk



14

Epoch 1/1
 - 644s - loss: 0.0360 - acc: 0.9887

Test accuracy: 97.10102489019033

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1681

choose_one :  1734

F1score :  0.9712292938099389

AUC : 0.9939126533669735

Confusion Matrix
[[1645   63]
 [  36 1671]]
True label 0
0.9631147540983607  
0.036885245901639344  
True label 1
0.0210896309314587  
0.9789103690685413  

Train_result {'loss': [0.036035381122335335], 'acc': [0.9887260046721061]}
Saved model to disk



15

Epoch 1/1
 - 644s - loss: 0.0371 - acc: 0.9891

Test accuracy: 97.51098096632504

data size :  32952

zero :  16477

one :  16475

train_zero :  14769

train_one :  14768

test_zero :  1708

test_one :  1707

choose_zero :  1727

choose_one :  1688

F1score :  0.9749631811487481

AUC : 0.9941596045488407

Confusion Matrix
[[1675   33]
 [  52 1655]]
True label 0
0.9806791569086651  
0.019320843091334895  
True label 1
0.03046280023432923  
0.9695371997656708  

Train_result {'loss': [0.03707614515302447], 'acc': [0.9890645630903613]}
Saved model to disk




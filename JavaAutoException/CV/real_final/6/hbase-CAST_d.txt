Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:522: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("ou...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 19:38:19.984686: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 19:38:20.002714: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-22 19:38:20.012678: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6f127c0 executing computations on platform Host. Devices:
2019-07-22 19:38:20.012715: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
26276
one : 
22977

Second data
zero : 
26276
one : 
22977

hbase-AST

Sentence length Average : 63

Under 10 : 0
Over 10, Under 200 : 23349
Over 200, Under 400 : 1537
Over 400 : 0


hbase-code

Sentence length Average : 88

Under 10 : 0
Over 10, Under 200 : 22166
Over 200, Under 400 : 2720
Over 400 : 0


Test_zero:  1079
Train_zero:  9307
zero:  10386
Test_one:  1732
Train_one:  15579
one:  17311
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 858s - loss: 0.4540 - acc: 0.7909

Test accuracy: 84.80778138026864

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1219

choose_one :  940

F1score :  0.8376237623762376

AUC : 0.935766141489033

Confusion Matrix
[[985  94]
 [234 846]]
True label 0
0.9128822984244671  
0.0871177015755329  
True label 1
0.21666666666666667  
0.7833333333333333  

Train_result {'loss': [0.453959827558539], 'acc': [0.7908675798990699]}
Saved model to disk



2

Epoch 1/1
 - 864s - loss: 0.3172 - acc: 0.8557

Test accuracy: 88.14265863825845

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1163

choose_one :  996

F1score :  0.8766859344894028

AUC : 0.9535887138296776

Confusion Matrix
[[993  86]
 [170 910]]
True label 0
0.9202965708989805  
0.07970342910101946  
True label 1
0.1574074074074074  
0.8425925925925926  

Train_result {'loss': [0.3171612587421452], 'acc': [0.8557077625474717]}
Saved model to disk



3

Epoch 1/1
 - 867s - loss: 0.2639 - acc: 0.8862

Test accuracy: 88.55951829550717

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1212

choose_one :  947

F1score :  0.8781450419338924

AUC : 0.9586542752205401

Confusion Matrix
[[1022   57]
 [ 190  890]]
True label 0
0.9471733086190918  
0.05282669138090825  
True label 1
0.17592592592592593  
0.8240740740740741  

Train_result {'loss': [0.2639489440260925], 'acc': [0.8861670695675531]}
Saved model to disk



4

Epoch 1/1
 - 867s - loss: 0.2316 - acc: 0.9038

Test accuracy: 89.0690134321445

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1095

choose_one :  1064

F1score :  0.8899253731343284

AUC : 0.9624806919987643

Confusion Matrix
[[969 110]
 [126 954]]
True label 0
0.8980537534754403  
0.10194624652455977  
True label 1
0.11666666666666667  
0.8833333333333333  

Train_result {'loss': [0.2316485114549713], 'acc': [0.9037872682967687]}
Saved model to disk



5

Epoch 1/1
 - 938s - loss: 0.2037 - acc: 0.9157

Test accuracy: 89.90273274664197

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1087

choose_one :  1072

F1score :  0.8986988847583643

AUC : 0.9678770638107989

Confusion Matrix
[[974 105]
 [113 967]]
True label 0
0.9026876737720111  
0.09731232622798888  
True label 1
0.10462962962962963  
0.8953703703703704  

Train_result {'loss': [0.2037057619220686], 'acc': [0.9157131345945118]}
Saved model to disk



6

Epoch 1/1
 - 939s - loss: 0.1808 - acc: 0.9269

Test accuracy: 90.18063918480777

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1175

choose_one :  984

F1score :  0.8972868217054263

AUC : 0.9707016098582363

Confusion Matrix
[[1021   58]
 [ 154  926]]
True label 0
0.9462465245597775  
0.05375347544022243  
True label 1
0.1425925925925926  
0.8574074074074074  

Train_result {'loss': [0.1807573150674278], 'acc': [0.92688691916403]}
Saved model to disk



7

Epoch 1/1
 - 867s - loss: 0.1553 - acc: 0.9374

Test accuracy: 90.365910143585

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1147

choose_one :  1012

F1score :  0.9005736137667304

AUC : 0.9683674870421859

Confusion Matrix
[[1009   70]
 [ 138  942]]
True label 0
0.9351251158480074  
0.06487488415199258  
True label 1
0.12777777777777777  
0.8722222222222222  

Train_result {'loss': [0.15529093153088316], 'acc': [0.9373623422099607]}
Saved model to disk



8

Epoch 1/1
 - 867s - loss: 0.1332 - acc: 0.9490

Test accuracy: 91.06067623899953

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1132

choose_one :  1027

F1score :  0.9084005695301377

AUC : 0.9721823190196685

Confusion Matrix
[[1009   70]
 [ 123  957]]
True label 0
0.9351251158480074  
0.06487488415199258  
True label 1
0.11388888888888889  
0.8861111111111111  

Train_result {'loss': [0.13317758738334193], 'acc': [0.948965887724953]}
Saved model to disk



9

Epoch 1/1
 - 867s - loss: 0.1154 - acc: 0.9554

Test accuracy: 92.1259842519685

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1135

choose_one :  1024

F1score :  0.9192015209125475

AUC : 0.97252557237497

Confusion Matrix
[[1022   57]
 [ 113  967]]
True label 0
0.9471733086190918  
0.05282669138090825  
True label 1
0.10462962962962963  
0.8953703703703704  

Train_result {'loss': [0.11542412246863368], 'acc': [0.9553585818016878]}
Saved model to disk



10

Epoch 1/1
 - 868s - loss: 0.0953 - acc: 0.9634

Test accuracy: 90.96804075961093

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1026

choose_one :  1133

F1score :  0.9118843199276999

AUC : 0.9717309408574468

Confusion Matrix
[[ 955  124]
 [  71 1009]]
True label 0
0.8850787766450418  
0.11492122335495829  
True label 1
0.06574074074074074  
0.9342592592592592  

Train_result {'loss': [0.09534000145812253], 'acc': [0.9634165995293268]}
Saved model to disk



11

Epoch 1/1
 - 866s - loss: 0.0807 - acc: 0.9698

Test accuracy: 91.33858267716536

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1122

choose_one :  1037

F1score :  0.9116674539442607

AUC : 0.9712654034943191

Confusion Matrix
[[1007   72]
 [ 115  965]]
True label 0
0.933271547729379  
0.06672845227062095  
True label 1
0.10648148148148148  
0.8935185185185185  

Train_result {'loss': [0.08067484247119731], 'acc': [0.9697555734622616]}
Saved model to disk



12

Epoch 1/1
 - 960s - loss: 0.0702 - acc: 0.9751

Test accuracy: 90.59749884205651

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1042

choose_one :  1117

F1score :  0.9076012744651798

AUC : 0.9700833247519994

Confusion Matrix
[[959 120]
 [ 83 997]]
True label 0
0.8887859128822985  
0.11121408711770157  
True label 1
0.07685185185185185  
0.9231481481481482  

Train_result {'loss': [0.0702044455255996], 'acc': [0.9751275852934955]}
Saved model to disk



13

Epoch 1/1
 - 964s - loss: 0.0636 - acc: 0.9767

Test accuracy: 90.78276980083372

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1128

choose_one :  1031

F1score :  0.9057318806252961

AUC : 0.9682181718326297

Confusion Matrix
[[1004   75]
 [ 124  956]]
True label 0
0.9304911955514366  
0.06950880444856349  
True label 1
0.11481481481481481  
0.8851851851851852  

Train_result {'loss': [0.06356749269093696], 'acc': [0.9767391888262155]}
Saved model to disk



14

Epoch 1/1
 - 865s - loss: 0.0562 - acc: 0.9803

Test accuracy: 91.19962945808244

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1051

choose_one :  1108

F1score :  0.9131627056672761

AUC : 0.9684811897161295

Confusion Matrix
[[970 109]
 [ 81 999]]
True label 0
0.8989805375347544  
0.1010194624652456  
True label 1
0.075  
0.925  

Train_result {'loss': [0.05620378237686703], 'acc': [0.9802847166263766]}
Saved model to disk



15

Epoch 1/1
 - 864s - loss: 0.0489 - acc: 0.9848

Test accuracy: 91.70912459471978

data size :  20774

zero :  10386

one :  10388

train_zero :  9307

train_one :  9308

test_zero :  1079

test_one :  1080

choose_zero :  1064

choose_one :  1095

F1score :  0.9177011494252874

AUC : 0.9703901074383003

Confusion Matrix
[[982  97]
 [ 82 998]]
True label 0
0.9101019462465245  
0.08989805375347544  
True label 1
0.07592592592592592  
0.924074074074074  

Train_result {'loss': [0.048889483081014526], 'acc': [0.9847972065538544]}
Saved model to disk




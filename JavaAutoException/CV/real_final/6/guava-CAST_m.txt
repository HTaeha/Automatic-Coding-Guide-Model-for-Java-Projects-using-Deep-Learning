Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 04:13:11.804323: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 04:13:11.815904: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-22 04:13:11.817959: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xfdbfb80 executing computations on platform Host. Devices:
2019-07-22 04:13:11.818001: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41860
one : 
17294

Second data
zero : 
41860
one : 
17294

guava-AST

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32760
Over 200, Under 400 : 272
Over 400 : 0


guava-code

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 32131
Over 200, Under 400 : 901
Over 400 : 0


Test_zero:  2228
Train_zero:  20433
zero:  22661
Test_one:  1464
Train_one:  12599
one:  14063
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1241s - loss: 0.2716 - acc: 0.8911

Test accuracy: 91.56708774325708

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1430

choose_one :  1499

F1score :  0.9166385420182247

AUC : 0.9734240660959734

Confusion Matrix
[[1324  141]
 [ 106 1358]]
True label 0
0.903754266211604  
0.0962457337883959  
True label 1
0.07240437158469945  
0.9275956284153005  

Train_result {'loss': [0.2716318060149796], 'acc': [0.8911067899543476]}
Saved model to disk



2

Epoch 1/1
 - 1187s - loss: 0.1776 - acc: 0.9334

Test accuracy: 95.45920109252305

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1524

choose_one :  1405

F1score :  0.9536423841059604

AUC : 0.990029187414909

Confusion Matrix
[[1428   37]
 [  96 1368]]
True label 0
0.9747440273037543  
0.025255972696245733  
True label 1
0.06557377049180328  
0.9344262295081968  

Train_result {'loss': [0.17755269967432016], 'acc': [0.9333703718425177]}
Saved model to disk



3

Epoch 1/1
 - 1026s - loss: 0.1318 - acc: 0.9511

Test accuracy: 96.00546261522705

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1454

choose_one :  1475

F1score :  0.9601905410003402

AUC : 0.9918070087095994

Confusion Matrix
[[1401   64]
 [  53 1411]]
True label 0
0.9563139931740614  
0.04368600682593857  
True label 1
0.036202185792349725  
0.9637978142076503  

Train_result {'loss': [0.13180408883879613], 'acc': [0.9510694868844002]}
Saved model to disk



4

Epoch 1/1
 - 1002s - loss: 0.0938 - acc: 0.9661

Test accuracy: 95.86889723455104

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1436

choose_one :  1493

F1score :  0.9590801487994588

AUC : 0.9927975624312277

Confusion Matrix
[[1390   75]
 [  46 1418]]
True label 0
0.9488054607508533  
0.051194539249146756  
True label 1
0.031420765027322405  
0.9685792349726776  

Train_result {'loss': [0.09377553386853145], 'acc': [0.9661097662629312]}
Saved model to disk



5

Epoch 1/1
 - 1004s - loss: 0.0754 - acc: 0.9739

Test accuracy: 96.92727893479002

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1463

choose_one :  1466

F1score :  0.969283276450512

AUC : 0.9944940226412279

Confusion Matrix
[[1419   46]
 [  44 1420]]
True label 0
0.9686006825938567  
0.031399317406143344  
True label 1
0.030054644808743168  
0.9699453551912568  

Train_result {'loss': [0.07540394924691927], 'acc': [0.9738878526925672]}
Saved model to disk



6

Epoch 1/1
 - 998s - loss: 0.0565 - acc: 0.9818

Test accuracy: 97.64424718333903

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1452

choose_one :  1477

F1score :  0.9765385923155389

AUC : 0.9958892836494527

Confusion Matrix
[[1424   41]
 [  28 1436]]
True label 0
0.9720136518771331  
0.027986348122866895  
True label 1
0.01912568306010929  
0.9808743169398907  

Train_result {'loss': [0.056482967434612646], 'acc': [0.9818246755823644]}
Saved model to disk



7

Epoch 1/1
 - 1000s - loss: 0.0460 - acc: 0.9847

Test accuracy: 97.74667121884603

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1445

choose_one :  1484

F1score :  0.9776119402985075

AUC : 0.9970751972248644

Confusion Matrix
[[1422   43]
 [  23 1441]]
True label 0
0.9706484641638226  
0.029351535836177476  
True label 1
0.015710382513661202  
0.9842896174863388  

Train_result {'loss': [0.046000702441749274], 'acc': [0.9847216159371404]}
Saved model to disk



8

Epoch 1/1
 - 995s - loss: 0.0389 - acc: 0.9880

Test accuracy: 97.71252987367703

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1456

choose_one :  1473

F1score :  0.9771876064010895

AUC : 0.9960314907029225

Confusion Matrix
[[1427   38]
 [  29 1435]]
True label 0
0.974061433447099  
0.025938566552901023  
True label 1
0.01980874316939891  
0.980191256830601  

Train_result {'loss': [0.038941993823141105], 'acc': [0.9879757133219572]}
Saved model to disk



9

Epoch 1/1
 - 1005s - loss: 0.0307 - acc: 0.9903

Test accuracy: 98.29293274155002

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1461

choose_one :  1468

F1score :  0.9829467939972715

AUC : 0.9975400511012887

Confusion Matrix
[[1438   27]
 [  23 1441]]
True label 0
0.9815699658703072  
0.018430034129692834  
True label 1
0.015710382513661202  
0.9842896174863388  

Train_result {'loss': [0.030702036614615187], 'acc': [0.9902773919599984]}
Saved model to disk



10

Epoch 1/1
 - 1001s - loss: 0.0301 - acc: 0.9907

Test accuracy: 98.56606350290201

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1475

choose_one :  1454

F1score :  0.9856065798492117

AUC : 0.9971150618250993

Confusion Matrix
[[1449   16]
 [  26 1438]]
True label 0
0.9890784982935154  
0.010921501706484642  
True label 1
0.017759562841530054  
0.98224043715847  

Train_result {'loss': [0.030085206898992137], 'acc': [0.9906742331044883]}
Saved model to disk



11

Epoch 1/1
 - 1001s - loss: 0.0258 - acc: 0.9929

Test accuracy: 98.32707408671901

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1486

choose_one :  1443

F1score :  0.9831441348469212

AUC : 0.9972864096682146

Confusion Matrix
[[1451   14]
 [  35 1429]]
True label 0
0.990443686006826  
0.00955631399317406  
True label 1
0.02390710382513661  
0.9760928961748634  

Train_result {'loss': [0.025788843127043798], 'acc': [0.9928965435136315]}
Saved model to disk



12

Epoch 1/1
 - 1001s - loss: 0.0219 - acc: 0.9947

Test accuracy: 98.77091157391601

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1449

choose_one :  1480

F1score :  0.9877717391304348

AUC : 0.9977118651970383

Confusion Matrix
[[1439   26]
 [  10 1454]]
True label 0
0.9822525597269625  
0.017747440273037544  
True label 1
0.006830601092896175  
0.9931693989071039  

Train_result {'loss': [0.02189268373011965], 'acc': [0.9946823286638359]}
Saved model to disk



13

Epoch 1/1
 - 1004s - loss: 0.0194 - acc: 0.9954

Test accuracy: 98.77091157391601

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1469

choose_one :  1460

F1score :  0.9876880984952121

AUC : 0.9971162274566853

Confusion Matrix
[[1449   16]
 [  20 1444]]
True label 0
0.9890784982935154  
0.010921501706484642  
True label 1
0.01366120218579235  
0.9863387978142076  

Train_result {'loss': [0.019399733283635274], 'acc': [0.9953966427239176]}
Saved model to disk



14

Epoch 1/1
 - 970s - loss: 0.0228 - acc: 0.9944

Test accuracy: 98.56606350290201

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1473

choose_one :  1456

F1score :  0.9856164383561643

AUC : 0.9968709785710289

Confusion Matrix
[[1448   17]
 [  25 1439]]
True label 0
0.9883959044368601  
0.011604095563139932  
True label 1
0.01707650273224044  
0.9829234972677595  

Train_result {'loss': [0.022756310914209665], 'acc': [0.994364855748244]}
Saved model to disk



15

Epoch 1/1
 - 930s - loss: 0.0203 - acc: 0.9954

Test accuracy: 98.36121543188801

data size :  28128

zero :  14065

one :  14063

train_zero :  12600

train_one :  12599

test_zero :  1465

test_one :  1464

choose_zero :  1451

choose_one :  1478

F1score :  0.9836845683208701

AUC : 0.9954887726365653

Confusion Matrix
[[1434   31]
 [  17 1447]]
True label 0
0.978839590443686  
0.021160409556313993  
True label 1
0.011612021857923498  
0.9883879781420765  

Train_result {'loss': [0.020303747866438897], 'acc': [0.9953569586094686]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 12:16:23.493563: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 12:16:23.503966: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-21 12:16:23.506383: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7542270 executing computations on platform Host. Devices:
2019-07-21 12:16:23.506446: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26276

one : 
22977
hbase-CAST
all data

Sentence length Average : 94

Under 10 : 7520
Over 10, Under 200 : 35222
Over 200, Under 400 : 4098
Over 400 : 2413

hbase-CAST
updated_train_data

Sentence length Average : 93

Under 10 : 0
Over 10, Under 200 : 31466
Over 200, Under 400 : 5634
Over 400 : 0


Test_zero:  2004
Train_zero:  17788
zero:  19792
Test_one:  2166
Train_one:  19312
one:  21478

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 914s - loss: 0.4036 - acc: 0.8174

Test accuracy: 87.25367922175106

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2019

choose_one :  1990

F1score :  0.872090112640801

AUC : 0.9468000408161235

Confusion Matrix
[[1756  248]
 [ 263 1742]]
True label 0
0.8762475049900199  
0.12375249500998003  
True label 1
0.13117206982543642  
0.8688279301745636  

Train_result {'acc': [0.8174382325475545], 'loss': [0.4036427940283798]}
Saved model to disk



2

Epoch 1/1
 - 939s - loss: 0.3048 - acc: 0.8647

Test accuracy: 88.02693938638065

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2246

choose_one :  1763

F1score :  0.8726114649681528

AUC : 0.9619134548857398

Confusion Matrix
[[1885  119]
 [ 361 1644]]
True label 0
0.9406187624750499  
0.0593812375249501  
True label 1
0.1800498753117207  
0.8199501246882793  

Train_result {'acc': [0.8647159681783396], 'loss': [0.3047983407602311]}
Saved model to disk



3

Epoch 1/1
 - 939s - loss: 0.2642 - acc: 0.8864

Test accuracy: 90.62110251933152

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2018

choose_one :  1991

F1score :  0.9059059059059058

AUC : 0.9671299545547309

Confusion Matrix
[[1823  181]
 [ 195 1810]]
True label 0
0.9096806387225549  
0.09031936127744511  
True label 1
0.09725685785536159  
0.9027431421446384  

Train_result {'acc': [0.8863872726878947], 'loss': [0.2641569664607842]}
Saved model to disk



4

Epoch 1/1
 - 904s - loss: 0.2341 - acc: 0.9000

Test accuracy: 90.17211274632078

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1896

choose_one :  2113

F1score :  0.9043224866440019

AUC : 0.9691644143135177

Confusion Matrix
[[1753  251]
 [ 143 1862]]
True label 0
0.874750499001996  
0.125249500998004  
True label 1
0.0713216957605985  
0.9286783042394015  

Train_result {'acc': [0.9000196756415106], 'loss': [0.23411356403359435]}
Saved model to disk



5

Epoch 1/1
 - 858s - loss: 0.2064 - acc: 0.9160

Test accuracy: 90.94537291095037

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2027

choose_one :  1982

F1score :  0.90895410082769

AUC : 0.9711157485527697

Confusion Matrix
[[1834  170]
 [ 193 1812]]
True label 0
0.9151696606786427  
0.08483033932135728  
True label 1
0.09625935162094763  
0.9037406483790523  

Train_result {'acc': [0.9160131545778799], 'loss': [0.20638916972464091]}
Saved model to disk



6

Epoch 1/1
 - 1014s - loss: 0.1823 - acc: 0.9270

Test accuracy: 91.5689698179097

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2086

choose_one :  1923

F1score :  0.9139511201629328

AUC : 0.9755135614058666

Confusion Matrix
[[1876  128]
 [ 210 1795]]
True label 0
0.936127744510978  
0.06387225548902195  
True label 1
0.10473815461346633  
0.8952618453865336  

Train_result {'acc': [0.927003401085455], 'loss': [0.18231318249591075]}
Saved model to disk



7

Epoch 1/1
 - 1038s - loss: 0.1580 - acc: 0.9370

Test accuracy: 92.06784734347717

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1932

choose_one :  2077

F1score :  0.9220970112689857

AUC : 0.9766241830553358

Confusion Matrix
[[1809  195]
 [ 123 1882]]
True label 0
0.9026946107784432  
0.09730538922155689  
True label 1
0.06134663341645885  
0.9386533665835411  

Train_result {'acc': [0.9369817578705788], 'loss': [0.15804703412645835]}
Saved model to disk



8

Epoch 1/1
 - 1038s - loss: 0.1394 - acc: 0.9463

Test accuracy: 91.21975555001247

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1850

choose_one :  2159

F1score :  0.9154658981748318

AUC : 0.9760318515089521

Confusion Matrix
[[1751  253]
 [  99 1906]]
True label 0
0.8737524950099801  
0.12624750499001997  
True label 1
0.04937655860349127  
0.9506234413965087  

Train_result {'acc': [0.9462855215565459], 'loss': [0.13941047703998335]}
Saved model to disk



9

Epoch 1/1
 - 1043s - loss: 0.1245 - acc: 0.9530

Test accuracy: 92.34222998253928

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1971

choose_one :  2038

F1score :  0.9240662874103389

AUC : 0.9786403502222487

Confusion Matrix
[[1834  170]
 [ 137 1868]]
True label 0
0.9151696606786427  
0.08483033932135728  
True label 1
0.06832917705735661  
0.9316708229426434  

Train_result {'acc': [0.9530314529166943], 'loss': [0.12447733368725528]}
Saved model to disk



10

Epoch 1/1
 - 1033s - loss: 0.1120 - acc: 0.9583

Test accuracy: 91.99301571464206

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2079

choose_one :  1930

F1score :  0.9184243964421855

AUC : 0.9758205534069019

Confusion Matrix
[[1881  123]
 [ 198 1807]]
True label 0
0.938622754491018  
0.061377245508982034  
True label 1
0.09875311720698254  
0.9012468827930175  

Train_result {'acc': [0.9582595497208093], 'loss': [0.11203173210448435]}
Saved model to disk



11

Epoch 1/1
 - 845s - loss: 0.0975 - acc: 0.9637

Test accuracy: 92.39211773509604

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2091

choose_one :  1918

F1score :  0.9222533775172062

AUC : 0.9769365259505924

Confusion Matrix
[[1895  109]
 [ 196 1809]]
True label 0
0.9456087824351297  
0.05439121756487026  
True label 1
0.09775561097256857  
0.9022443890274314  

Train_result {'acc': [0.9636844028294561], 'loss': [0.0975370535583919]}
Saved model to disk



12

Epoch 1/1
 - 841s - loss: 0.0898 - acc: 0.9680

Test accuracy: 92.01795959092043

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1892

choose_one :  2117

F1score :  0.9223677826297915

AUC : 0.9774504606746607

Confusion Matrix
[[1788  216]
 [ 104 1901]]
True label 0
0.8922155688622755  
0.10778443113772455  
True label 1
0.05187032418952618  
0.9481296758104738  

Train_result {'acc': [0.9679849340682], 'loss': [0.08976290054158272]}
Saved model to disk



13

Epoch 1/1
 - 844s - loss: 0.0780 - acc: 0.9732

Test accuracy: 92.2424544774258

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2035

choose_one :  1974

F1score :  0.9218396582055792

AUC : 0.974578025992902

Confusion Matrix
[[1864  140]
 [ 171 1834]]
True label 0
0.9301397205588823  
0.06986027944111776  
True label 1
0.08528678304239401  
0.914713216957606  

Train_result {'acc': [0.9732130308907441], 'loss': [0.07796318725990305]}
Saved model to disk



14

Epoch 1/1
 - 844s - loss: 0.0730 - acc: 0.9747

Test accuracy: 92.34222998253928

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  1985

choose_one :  2024

F1score :  0.9238024323653511

AUC : 0.9749616726646457

Confusion Matrix
[[1841  163]
 [ 144 1861]]
True label 0
0.9186626746506986  
0.0813373253493014  
True label 1
0.07182044887780549  
0.9281795511221945  

Train_result {'acc': [0.9747308654467775], 'loss': [0.07296530022999613]}
Saved model to disk



15

Epoch 1/1
 - 843s - loss: 0.0676 - acc: 0.9776

Test accuracy: 92.26739835370417

data size :  39586

zero :  19792

one :  19794

train_zero :  17788

train_one :  17789

test_zero :  2004

test_one :  2005

choose_zero :  2000

choose_one :  2009

F1score :  0.9227703039362232

AUC : 0.9761976047904192

Confusion Matrix
[[1847  157]
 [ 153 1852]]
True label 0
0.9216566866267465  
0.0783433133732535  
True label 1
0.07630922693266833  
0.9236907730673317  

Train_result {'acc': [0.9775978862748405], 'loss': [0.06763938037698049]}
Saved model to disk




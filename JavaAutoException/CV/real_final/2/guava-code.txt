Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 07:03:08.213618: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 07:03:08.223510: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099930000 Hz
2019-07-19 07:03:08.225977: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xb3f04c0 executing computations on platform Host. Devices:
2019-07-19 07:03:08.226023: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-code
all data

Sentence length Average : 42

Under 10 : 4899
Over 10, Under 200 : 53186
Over 200, Under 400 : 937
Over 400 : 132

guava-code
updated_train_data

Sentence length Average : 44

Under 10 : 0
Over 10, Under 200 : 47299
Over 200, Under 400 : 900
Over 400 : 0


Test_zero:  3741
Train_zero:  33591
zero:  37332
Test_one:  1587
Train_one:  14608
one:  16195

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 632s - loss: 0.2534 - acc: 0.8951

Test accuracy: 92.78740157480316

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1607

choose_one :  1568

F1score :  0.9274167987321711

AUC : 0.9794141711862282

Confusion Matrix
[[1483  105]
 [ 124 1463]]
True label 0
0.9338790931989924  
0.06612090680100756  
True label 1
0.07813484562066793  
0.921865154379332  

Train_result {'acc': [0.8951295478659684], 'loss': [0.25344340126058357]}
Saved model to disk



2

Epoch 1/1
 - 683s - loss: 0.1623 - acc: 0.9367

Test accuracy: 94.07874015748031

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1656

choose_one :  1519

F1score :  0.9394719896973599

AUC : 0.9835488358657164

Confusion Matrix
[[1528   60]
 [ 128 1459]]
True label 0
0.9622166246851386  
0.037783375314861464  
True label 1
0.08065532451165722  
0.9193446754883428  

Train_result {'acc': [0.9367491528904405], 'loss': [0.16228165815376497]}
Saved model to disk



3

Epoch 1/1
 - 709s - loss: 0.1197 - acc: 0.9548

Test accuracy: 95.14960629921259

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1618

choose_one :  1557

F1score :  0.9510178117048346

AUC : 0.9878703937375305

Confusion Matrix
[[1526   62]
 [  92 1495]]
True label 0
0.9609571788413098  
0.03904282115869018  
True label 1
0.057971014492753624  
0.9420289855072463  

Train_result {'acc': [0.954786596844303], 'loss': [0.11967518928981931]}
Saved model to disk



4

Epoch 1/1
 - 720s - loss: 0.0919 - acc: 0.9660

Test accuracy: 95.18110236220473

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1545

choose_one :  1630

F1score :  0.9524401616412808

AUC : 0.9897325800466321

Confusion Matrix
[[1490   98]
 [  55 1532]]
True label 0
0.9382871536523929  
0.061712846347607056  
True label 1
0.03465658475110271  
0.9653434152488973  

Train_result {'acc': [0.9660471643221412], 'loss': [0.09191231598016301]}
Saved model to disk



5

Epoch 1/1
 - 691s - loss: 0.0720 - acc: 0.9741

Test accuracy: 96.37795275590551

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1553

choose_one :  1622

F1score :  0.9641632907447802

AUC : 0.9923530527475283

Confusion Matrix
[[1513   75]
 [  40 1547]]
True label 0
0.9527707808564232  
0.04722921914357683  
True label 1
0.02520478890989288  
0.9747952110901071  

Train_result {'acc': [0.9741246534551802], 'loss': [0.07198519373424987]}
Saved model to disk



6

Epoch 1/1
 - 686s - loss: 0.0597 - acc: 0.9802

Test accuracy: 96.91338582677166

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1594

choose_one :  1581

F1score :  0.9690656565656565

AUC : 0.994523553303843

Confusion Matrix
[[1542   46]
 [  52 1535]]
True label 0
0.9710327455919395  
0.028967254408060455  
True label 1
0.03276622558286074  
0.9672337744171392  

Train_result {'acc': [0.9801827703049595], 'loss': [0.05969772914585978]}
Saved model to disk



7

Epoch 1/1
 - 690s - loss: 0.0460 - acc: 0.9849

Test accuracy: 97.38582677165354

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1615

choose_one :  1560

F1score :  0.9736256752462662

AUC : 0.9939144640252427

Confusion Matrix
[[1560   28]
 [  55 1532]]
True label 0
0.982367758186398  
0.017632241813602016  
True label 1
0.03465658475110271  
0.9653434152488973  

Train_result {'acc': [0.9848718211999863], 'loss': [0.04597845799777321]}
Saved model to disk



8

Epoch 1/1
 - 707s - loss: 0.0424 - acc: 0.9864

Test accuracy: 97.25984251968504

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1619

choose_one :  1556

F1score :  0.9723194400254535

AUC : 0.9939805313639315

Confusion Matrix
[[1560   28]
 [  59 1528]]
True label 0
0.982367758186398  
0.017632241813602016  
True label 1
0.037177063642092  
0.962822936357908  

Train_result {'acc': [0.9864120203990827], 'loss': [0.04238778578939651]}
Saved model to disk



9

Epoch 1/1
 - 706s - loss: 0.0346 - acc: 0.9891

Test accuracy: 97.57480314960631

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1593

choose_one :  1582

F1score :  0.9757021142316188

AUC : 0.9947973458785884

Confusion Matrix
[[1552   36]
 [  41 1546]]
True label 0
0.9773299748110831  
0.022670025188916875  
True label 1
0.0258349086326402  
0.9741650913673598  

Train_result {'acc': [0.9891159256597186], 'loss': [0.03458223228292205]}
Saved model to disk



10

Epoch 1/1
 - 705s - loss: 0.0288 - acc: 0.9903

Test accuracy: 97.44881889763779

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1595

choose_one :  1580

F1score :  0.9744237448689612

AUC : 0.995758397496028

Confusion Matrix
[[1551   37]
 [  44 1543]]
True label 0
0.9767002518891688  
0.023299748110831235  
True label 1
0.027725267800882167  
0.9722747321991179  

Train_result {'acc': [0.9902796317212582], 'loss': [0.02879295079058117]}
Saved model to disk



11

Epoch 1/1
 - 707s - loss: 0.0302 - acc: 0.9910

Test accuracy: 97.8267716535433

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1561

choose_one :  1614

F1score :  0.9784442361761949

AUC : 0.9956351908373926

Confusion Matrix
[[1540   48]
 [  21 1566]]
True label 0
0.9697732997481109  
0.030226700251889168  
True label 1
0.013232514177693762  
0.9867674858223062  

Train_result {'acc': [0.991032617996372], 'loss': [0.03017188392255947]}
Saved model to disk



12

Epoch 1/1
 - 704s - loss: 0.0247 - acc: 0.9927

Test accuracy: 97.48031496062993

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1600

choose_one :  1575

F1score :  0.9746995572422518

AUC : 0.99470251047951

Confusion Matrix
[[1554   34]
 [  46 1541]]
True label 0
0.9785894206549118  
0.021410579345088162  
True label 1
0.028985507246376812  
0.9710144927536232  

Train_result {'acc': [0.9926754971420748], 'loss': [0.024729936749064308]}
Saved model to disk



13

Epoch 1/1
 - 706s - loss: 0.0219 - acc: 0.9932

Test accuracy: 97.8267716535433

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1595

choose_one :  1580

F1score :  0.9782128197031892

AUC : 0.9952633884569051

Confusion Matrix
[[1557   31]
 [  38 1549]]
True label 0
0.9804785894206549  
0.01952141057934509  
True label 1
0.023944549464398234  
0.9760554505356017  

Train_result {'acc': [0.9932231235239758], 'loss': [0.021920500198857173]}
Saved model to disk



14

Epoch 1/1
 - 702s - loss: 0.0198 - acc: 0.9943

Test accuracy: 97.57480314960631

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1587

choose_one :  1588

F1score :  0.9757480314960629

AUC : 0.9949322581617963

Confusion Matrix
[[1549   39]
 [  38 1549]]
True label 0
0.97544080604534  
0.02455919395465995  
True label 1
0.023944549464398234  
0.9760554505356017  

Train_result {'acc': [0.9942841496389089], 'loss': [0.0198058637552447]}
Saved model to disk



15

Epoch 1/1
 - 704s - loss: 0.0226 - acc: 0.9937

Test accuracy: 97.76377952755905

data size :  32392

zero :  16197

one :  16195

train_zero :  14609

train_one :  14608

test_zero :  1588

test_one :  1587

choose_zero :  1593

choose_one :  1582

F1score :  0.9775954559798042

AUC : 0.9944459787409986

Confusion Matrix
[[1555   33]
 [  38 1549]]
True label 0
0.9792191435768262  
0.020780856423173802  
True label 1
0.023944549464398234  
0.9760554505356017  

Train_result {'acc': [0.9937365232570079], 'loss': [0.022581017211973732]}
Saved model to disk




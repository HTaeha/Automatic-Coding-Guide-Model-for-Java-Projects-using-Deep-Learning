Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 09:13:23.259224: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 09:13:23.270093: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-19 09:13:23.272437: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xafcae30 executing computations on platform Host. Devices:
2019-07-19 09:13:23.272476: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-code
all data

Sentence length Average : 47

Under 10 : 10042
Over 10, Under 200 : 27631
Over 200, Under 400 : 1427
Over 400 : 371

glassfish-code
updated_train_data

Sentence length Average : 58

Under 10 : 0
Over 10, Under 200 : 23512
Over 200, Under 400 : 1473
Over 400 : 0


Test_zero:  1641
Train_zero:  14900
zero:  16541
Test_one:  1180
Train_one:  10085
one:  11265

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 460s - loss: 0.4085 - acc: 0.8063

Test accuracy: 85.93816179584923

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1199

choose_one :  1162

F1score :  0.8582408198121264

AUC : 0.9351648272793811

Confusion Matrix
[[1024  157]
 [ 175 1005]]
True label 0
0.8670618120237087  
0.13293818797629128  
True label 1
0.1483050847457627  
0.8516949152542372  

Train_result {'acc': [0.8063060829845219], 'loss': [0.40845817159952746]}
Saved model to disk



2

Epoch 1/1
 - 457s - loss: 0.2873 - acc: 0.8726

Test accuracy: 86.53113087674714

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1111

choose_one :  1250

F1score :  0.8691358024691358

AUC : 0.9513773877351857

Confusion Matrix
[[ 987  194]
 [ 124 1056]]
True label 0
0.8357324301439458  
0.1642675698560542  
True label 1
0.10508474576271186  
0.8949152542372881  

Train_result {'acc': [0.8726389371026733], 'loss': [0.2873177587598892]}
Saved model to disk



3

Epoch 1/1
 - 457s - loss: 0.2413 - acc: 0.9006

Test accuracy: 89.24184667513765

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1275

choose_one :  1086

F1score :  0.8879082082965578

AUC : 0.9562988848864077

Confusion Matrix
[[1101   80]
 [ 174 1006]]
True label 0
0.9322607959356477  
0.06773920406435224  
True label 1
0.14745762711864407  
0.8525423728813559  

Train_result {'acc': [0.9005502949897585], 'loss': [0.24131903959209472]}
Saved model to disk



4

Epoch 1/1
 - 457s - loss: 0.2082 - acc: 0.9170

Test accuracy: 90.97839898348158

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1282

choose_one :  1079

F1score :  0.9057104913678619

AUC : 0.9663876490764793

Confusion Matrix
[[1125   56]
 [ 157 1023]]
True label 0
0.9525825571549534  
0.04741744284504657  
True label 1
0.13305084745762713  
0.8669491525423729  

Train_result {'acc': [0.9170095681919588], 'loss': [0.20818756364827443]}
Saved model to disk



5

Epoch 1/1
 - 469s - loss: 0.1775 - acc: 0.9264

Test accuracy: 90.13130029648454

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1138

choose_one :  1223

F1score :  0.9030378693300042

AUC : 0.9710508187545746

Confusion Matrix
[[1043  138]
 [  95 1085]]
True label 0
0.8831498729889924  
0.11685012701100762  
True label 1
0.08050847457627118  
0.9194915254237288  

Train_result {'acc': [0.9263794556689318], 'loss': [0.17753692350645955]}
Saved model to disk



6

Epoch 1/1
 - 485s - loss: 0.1539 - acc: 0.9399

Test accuracy: 90.08894536213468

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1123

choose_one :  1238

F1score :  0.9032258064516129

AUC : 0.9691747154809914

Confusion Matrix
[[1035  146]
 [  88 1092]]
True label 0
0.8763759525825572  
0.12362404741744284  
True label 1
0.07457627118644068  
0.9254237288135593  

Train_result {'acc': [0.9398641614198602], 'loss': [0.15389917076877305]}
Saved model to disk



7

Epoch 1/1
 - 484s - loss: 0.1391 - acc: 0.9463

Test accuracy: 91.95256247352816

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1237

choose_one :  1124

F1score :  0.9175347222222223

AUC : 0.9715911537191981

Confusion Matrix
[[1114   67]
 [ 123 1057]]
True label 0
0.9432684165961049  
0.056731583403895  
True label 1
0.10423728813559321  
0.8957627118644068  

Train_result {'acc': [0.9462594814337415], 'loss': [0.13907652454751118]}
Saved model to disk



8

Epoch 1/1
 - 485s - loss: 0.1185 - acc: 0.9564

Test accuracy: 91.74078780177891

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1224

choose_one :  1137

F1score :  0.9158394475615019

AUC : 0.9711315460899267

Confusion Matrix
[[1105   76]
 [ 119 1061]]
True label 0
0.9356477561388654  
0.06435224386113463  
True label 1
0.10084745762711865  
0.8991525423728813  

Train_result {'acc': [0.9564225868821575], 'loss': [0.11854201119191249]}
Saved model to disk



9

Epoch 1/1
 - 486s - loss: 0.1013 - acc: 0.9631

Test accuracy: 91.78314273612877

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1299

choose_one :  1062

F1score :  0.9134701159678857

AUC : 0.9700810143658779

Confusion Matrix
[[1143   38]
 [ 156 1024]]
True label 0
0.9678238780694327  
0.03217612193056731  
True label 1
0.13220338983050847  
0.8677966101694915  

Train_result {'acc': [0.963065787516732], 'loss': [0.1013433395538969]}
Saved model to disk



10

Epoch 1/1
 - 485s - loss: 0.0884 - acc: 0.9690

Test accuracy: 92.37611181702668

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1235

choose_one :  1126

F1score :  0.9219427580225499

AUC : 0.9746204021297664

Confusion Matrix
[[1118   63]
 [ 117 1063]]
True label 0
0.9466553767993227  
0.05334462320067739  
True label 1
0.09915254237288136  
0.9008474576271186  

Train_result {'acc': [0.9690149224133657], 'loss': [0.08844326184848754]}
Saved model to disk



11

Epoch 1/1
 - 484s - loss: 0.0775 - acc: 0.9721

Test accuracy: 91.27488352393054

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1139

choose_one :  1222

F1score :  0.9142381348875936

AUC : 0.9728591110664618

Confusion Matrix
[[1057  124]
 [  82 1098]]
True label 0
0.8950042337002541  
0.10499576629974598  
True label 1
0.06949152542372881  
0.9305084745762712  

Train_result {'acc': [0.9720886421099598], 'loss': [0.07749452775537341]}
Saved model to disk



12

Epoch 1/1
 - 485s - loss: 0.0693 - acc: 0.9766

Test accuracy: 92.7149512918255

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1197

choose_one :  1164

F1score :  0.9266211604095564

AUC : 0.9754603252055857

Confusion Matrix
[[1103   78]
 [  94 1086]]
True label 0
0.9339542760372566  
0.06604572396274344  
True label 1
0.07966101694915254  
0.9203389830508475  

Train_result {'acc': [0.9766496455307124], 'loss': [0.06926076750984693]}
Saved model to disk



13

Epoch 1/1
 - 482s - loss: 0.0606 - acc: 0.9787

Test accuracy: 91.78314273612877

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1159

choose_one :  1202

F1score :  0.9185558354324098

AUC : 0.974600668781125

Confusion Matrix
[[1073  108]
 [  86 1094]]
True label 0
0.9085520745131245  
0.09144792548687553  
True label 1
0.07288135593220339  
0.9271186440677966  

Train_result {'acc': [0.9786822666203956], 'loss': [0.06064392503442023]}
Saved model to disk



14

Epoch 1/1
 - 485s - loss: 0.0528 - acc: 0.9828

Test accuracy: 92.24904701397712

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1246

choose_one :  1115

F1score :  0.9202614379084968

AUC : 0.9728339958954636

Confusion Matrix
[[1122   59]
 [ 124 1056]]
True label 0
0.9500423370025403  
0.04995766299745978  
True label 1
0.10508474576271186  
0.8949152542372881  

Train_result {'acc': [0.9828466610628142], 'loss': [0.052840708140831416]}
Saved model to disk



15

Epoch 1/1
 - 486s - loss: 0.0467 - acc: 0.9838

Test accuracy: 92.6302414231258

data size :  22532

zero :  11267

one :  11265

train_zero :  10086

train_one :  10085

test_zero :  1181

test_one :  1180

choose_zero :  1241

choose_one :  1120

F1score :  0.9243478260869565

AUC : 0.9740118974152902

Confusion Matrix
[[1124   57]
 [ 117 1063]]
True label 0
0.951735817104149  
0.04826418289585097  
True label 1
0.09915254237288136  
0.9008474576271186  

Train_result {'acc': [0.9838381835308115], 'loss': [0.04674165192572028]}
Saved model to disk




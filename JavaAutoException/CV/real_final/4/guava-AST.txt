Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 11:27:54.665043: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 11:27:54.672151: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-18 11:27:54.674645: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x784c4c0 executing computations on platform Host. Devices:
2019-07-18 11:27:54.674692: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41860

one : 
17294
guava-AST
all data

Sentence length Average : 23

Under 10 : 22297
Over 10, Under 200 : 36558
Over 200, Under 400 : 283
Over 400 : 16

guava-AST
updated_train_data

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 33016
Over 200, Under 400 : 276
Over 400 : 0


Test_zero:  2164
Train_zero:  20522
zero:  22686
Test_one:  1401
Train_one:  12770
one:  14171

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 578s - loss: 0.4124 - acc: 0.8056

Test accuracy: 83.26792722083482

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1265

choose_one :  1538

F1score :  0.840421912215039

AUC : 0.925192775488468

Confusion Matrix
[[1099  303]
 [ 166 1235]]
True label 0
0.7838801711840229  
0.2161198288159772  
True label 1
0.11848679514632406  
0.8815132048536759  

Train_result {'acc': [0.8056458243631653], 'loss': [0.41240743250570744]}
Saved model to disk



2

Epoch 1/1
 - 571s - loss: 0.3178 - acc: 0.8601

Test accuracy: 88.58366036389582

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1488

choose_one :  1315

F1score :  0.882179675994109

AUC : 0.9523152404895219

Confusion Matrix
[[1285  117]
 [ 203 1198]]
True label 0
0.9165477888730386  
0.08345221112696148  
True label 1
0.14489650249821556  
0.8551034975017845  

Train_result {'acc': [0.8601072784934027], 'loss': [0.3178366050663833]}
Saved model to disk



3

Epoch 1/1
 - 635s - loss: 0.2714 - acc: 0.8862

Test accuracy: 87.51337852301107

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1262

choose_one :  1541

F1score :  0.8810333106730115

AUC : 0.9571217726079089

Confusion Matrix
[[1157  245]
 [ 105 1296]]
True label 0
0.8252496433666191  
0.17475035663338087  
True label 1
0.07494646680942184  
0.9250535331905781  

Train_result {'acc': [0.8861829998848755], 'loss': [0.271383186820427]}
Saved model to disk



4

Epoch 1/1
 - 637s - loss: 0.2366 - acc: 0.9056

Test accuracy: 90.01070281840884

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1308

choose_one :  1495

F1score :  0.9033149171270719

AUC : 0.9652176812771802

Confusion Matrix
[[1215  187]
 [  93 1308]]
True label 0
0.8666191155492154  
0.13338088445078458  
True label 1
0.06638115631691649  
0.9336188436830836  

Train_result {'acc': [0.9056419090920171], 'loss': [0.23664760163352072]}
Saved model to disk



5

Epoch 1/1
 - 634s - loss: 0.2090 - acc: 0.9158

Test accuracy: 90.04637887977167

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1535

choose_one :  1268

F1score :  0.8954664668415137

AUC : 0.9647016956504474

Confusion Matrix
[[1329   73]
 [ 206 1195]]
True label 0
0.9479315263908702  
0.05206847360912981  
True label 1
0.1470378301213419  
0.8529621698786581  

Train_result {'acc': [0.915782467407682], 'loss': [0.20896125220873452]}
Saved model to disk



6

Epoch 1/1
 - 635s - loss: 0.1826 - acc: 0.9284

Test accuracy: 92.54370317516945

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1417

choose_one :  1386

F1score :  0.9250089702188733

AUC : 0.977409909978709

Confusion Matrix
[[1305   97]
 [ 112 1289]]
True label 0
0.9308131241084165  
0.06918687589158345  
True label 1
0.07994289793004997  
0.9200571020699501  

Train_result {'acc': [0.9283504952820955], 'loss': [0.18258942325628041]}
Saved model to disk



7

Epoch 1/1
 - 639s - loss: 0.1599 - acc: 0.9387

Test accuracy: 92.1869425615412

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1373

choose_one :  1430

F1score :  0.9226421759095726

AUC : 0.9808734030410314

Confusion Matrix
[[1278  124]
 [  95 1306]]
True label 0
0.9115549215406562  
0.0884450784593438  
True label 1
0.06780870806566738  
0.9321912919343326  

Train_result {'acc': [0.9386868172765203], 'loss': [0.1598817956331617]}
Saved model to disk



8

Epoch 1/1
 - 644s - loss: 0.1403 - acc: 0.9450

Test accuracy: 93.75668926150553

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1397

choose_one :  1406

F1score :  0.9376558603491271

AUC : 0.983230085296726

Confusion Matrix
[[1312   90]
 [  85 1316]]
True label 0
0.9358059914407989  
0.06419400855920114  
True label 1
0.06067094932191292  
0.939329050678087  

Train_result {'acc': [0.944951254845151], 'loss': [0.1403237928383933]}
Saved model to disk



9

Epoch 1/1
 - 612s - loss: 0.1262 - acc: 0.9511

Test accuracy: 94.14912593649662

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1410

choose_one :  1393

F1score :  0.9413027916964924

AUC : 0.9858362327296277

Confusion Matrix
[[1324   78]
 [  86 1315]]
True label 0
0.9443651925820257  
0.05563480741797432  
True label 1
0.06138472519628837  
0.9386152748037117  

Train_result {'acc': [0.9510590814768412], 'loss': [0.12624649941285085]}
Saved model to disk



10

Epoch 1/1
 - 600s - loss: 0.1118 - acc: 0.9589

Test accuracy: 94.29183018194792

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1412

choose_one :  1391

F1score :  0.9426934097421203

AUC : 0.9863300719579757

Confusion Matrix
[[1327   75]
 [  85 1316]]
True label 0
0.9465049928673324  
0.05349500713266762  
True label 1
0.06067094932191292  
0.939329050678087  

Train_result {'acc': [0.9589287811753651], 'loss': [0.11178379864851799]}
Saved model to disk



11

Epoch 1/1
 - 602s - loss: 0.1004 - acc: 0.9629

Test accuracy: 94.43453442739921

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1356

choose_one :  1447

F1score :  0.9452247191011236

AUC : 0.9860920618144162

Confusion Matrix
[[1301  101]
 [  55 1346]]
True label 0
0.927960057061341  
0.07203994293865906  
True label 1
0.039257673090649536  
0.9607423269093505  

Train_result {'acc': [0.9629223601268548], 'loss': [0.10041601640726516]}
Saved model to disk



12

Epoch 1/1
 - 603s - loss: 0.0940 - acc: 0.9655

Test accuracy: 94.57723867285051

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1360

choose_one :  1443

F1score :  0.9465541490857947

AUC : 0.9859808207098864

Confusion Matrix
[[1305   97]
 [  55 1346]]
True label 0
0.9308131241084165  
0.06918687589158345  
True label 1
0.039257673090649536  
0.9607423269093505  

Train_result {'acc': [0.9655455933596961], 'loss': [0.09398492991846691]}
Saved model to disk



13

Epoch 1/1
 - 603s - loss: 0.0870 - acc: 0.9684

Test accuracy: 94.61291473421333

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1419

choose_one :  1384

F1score :  0.9457809694793538

AUC : 0.9881672047986918

Confusion Matrix
[[1335   67]
 [  84 1317]]
True label 0
0.9522111269614836  
0.04778887303851641  
True label 1
0.059957173447537475  
0.9400428265524625  

Train_result {'acc': [0.9683645902666301], 'loss': [0.08699470164453327]}
Saved model to disk



14

Epoch 1/1
 - 604s - loss: 0.0813 - acc: 0.9710

Test accuracy: 95.1123795932929

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1351

choose_one :  1452

F1score :  0.9519803715387312

AUC : 0.9873908080737114

Confusion Matrix
[[1308   94]
 [  43 1358]]
True label 0
0.9329529243937232  
0.06704707560627675  
True label 1
0.030692362598144184  
0.9693076374018558  

Train_result {'acc': [0.9709878235018051], 'loss': [0.08127903228237024]}
Saved model to disk



15

Epoch 1/1
 - 601s - loss: 0.0770 - acc: 0.9720

Test accuracy: 95.07670353193008

data size :  28344

zero :  14173

one :  14171

train_zero :  12771

train_one :  12770

test_zero :  1402

test_one :  1401

choose_zero :  1336

choose_one :  1467

F1score :  0.9518828451882846

AUC : 0.9867057970616057

Confusion Matrix
[[1300  102]
 [  36 1365]]
True label 0
0.927246790299572  
0.07275320970042796  
True label 1
0.02569593147751606  
0.974304068522484  

Train_result {'acc': [0.9720449473395717], 'loss': [0.07700873180857189]}
Saved model to disk




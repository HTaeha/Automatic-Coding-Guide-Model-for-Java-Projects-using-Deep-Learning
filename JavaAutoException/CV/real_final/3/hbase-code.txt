Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-19 03:27:40.415929: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-19 03:27:40.425825: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-19 03:27:40.428729: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x535c0f0 executing computations on platform Host. Devices:
2019-07-19 03:27:40.428767: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26276

one : 
22977
hbase-code
all data

Sentence length Average : 60

Under 10 : 8982
Over 10, Under 200 : 36976
Over 200, Under 400 : 2527
Over 400 : 768

hbase-code
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 31803
Over 200, Under 400 : 2711
Over 400 : 0


Test_zero:  1735
Train_zero:  15816
zero:  17551
Test_one:  2063
Train_one:  18698
one:  20761

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 771s - loss: 0.3717 - acc: 0.8326

Test accuracy: 88.38951310861424

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1704

choose_one :  1767

F1score :  0.8849557522123894

AUC : 0.9541468014183456

Confusion Matrix
[[1518  217]
 [ 186 1550]]
True label 0
0.8749279538904899  
0.1250720461095101  
True label 1
0.10714285714285714  
0.8928571428571429  

Train_result {'loss': [0.3717059481891247], 'acc': [0.8326115132949643]}
Saved model to disk



2

Epoch 1/1
 - 816s - loss: 0.2660 - acc: 0.8847

Test accuracy: 89.65715932008067

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1774

choose_one :  1697

F1score :  0.895426740460239

AUC : 0.9647053745733676

Confusion Matrix
[[1575  160]
 [ 199 1537]]
True label 0
0.9077809798270894  
0.09221902017291066  
True label 1
0.11463133640552996  
0.8853686635944701  

Train_result {'loss': [0.2660242995620622], 'acc': [0.8847090064230018]}
Saved model to disk



3

Epoch 1/1
 - 813s - loss: 0.2240 - acc: 0.9053

Test accuracy: 91.09766637856525

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1718

choose_one :  1753

F1score :  0.9114359415305244

AUC : 0.9730577431307188

Confusion Matrix
[[1572  163]
 [ 146 1590]]
True label 0
0.9060518731988473  
0.09394812680115273  
True label 1
0.08410138248847926  
0.9158986175115207  

Train_result {'loss': [0.2240056846239834], 'acc': [0.905288780707464]}
Saved model to disk



4

Epoch 1/1
 - 812s - loss: 0.1943 - acc: 0.9190

Test accuracy: 91.55862863728032

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1740

choose_one :  1731

F1score :  0.9154888952985291

AUC : 0.9738074210812891

Confusion Matrix
[[1591  144]
 [ 149 1587]]
True label 0
0.9170028818443804  
0.0829971181556196  
True label 1
0.0858294930875576  
0.9141705069124424  

Train_result {'loss': [0.19427096483732526], 'acc': [0.9190086302298108]}
Saved model to disk



5

Epoch 1/1
 - 812s - loss: 0.1719 - acc: 0.9284

Test accuracy: 92.19245174301354

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1828

choose_one :  1643

F1score :  0.9197987570287068

AUC : 0.9769462409859362

Confusion Matrix
[[1646   89]
 [ 182 1554]]
True label 0
0.9487031700288184  
0.051296829971181554  
True label 1
0.10483870967741936  
0.8951612903225806  

Train_result {'loss': [0.17188547201431323], 'acc': [0.9283659469541302]}
Saved model to disk



6

Epoch 1/1
 - 815s - loss: 0.1483 - acc: 0.9422

Test accuracy: 92.01959089599539

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1758

choose_one :  1713

F1score :  0.9196868657581907

AUC : 0.9758184039628681

Confusion Matrix
[[1608  127]
 [ 150 1586]]
True label 0
0.9268011527377522  
0.07319884726224783  
True label 1
0.08640552995391705  
0.913594470046083  

Train_result {'loss': [0.14832088210472277], 'acc': [0.942212246704391]}
Saved model to disk



7

Epoch 1/1
 - 815s - loss: 0.1264 - acc: 0.9496

Test accuracy: 92.336502448862

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1729

choose_one :  1742

F1score :  0.9235192639447959

AUC : 0.9777425663023414

Confusion Matrix
[[1599  136]
 [ 130 1606]]
True label 0
0.9216138328530259  
0.07838616714697406  
True label 1
0.0748847926267281  
0.9251152073732719  

Train_result {'loss': [0.12644429549766692], 'acc': [0.9496411974836405]}
Saved model to disk



8

Epoch 1/1
 - 813s - loss: 0.1079 - acc: 0.9575

Test accuracy: 92.39412273120138

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1787

choose_one :  1684

F1score :  0.9228070175438596

AUC : 0.976666688800648

Confusion Matrix
[[1629  106]
 [ 158 1578]]
True label 0
0.9389048991354467  
0.06109510086455332  
True label 1
0.09101382488479262  
0.9089861751152074  

Train_result {'loss': [0.10785365271604111], 'acc': [0.9575443366105016]}
Saved model to disk



9

Epoch 1/1
 - 813s - loss: 0.0936 - acc: 0.9652

Test accuracy: 92.6534140017286

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1770

choose_one :  1701

F1score :  0.9258073901658425

AUC : 0.9777757672744659

Confusion Matrix
[[1625  110]
 [ 145 1591]]
True label 0
0.9365994236311239  
0.06340057636887608  
True label 1
0.08352534562211981  
0.9164746543778802  

Train_result {'loss': [0.09363512660943359], 'acc': [0.9651629627287959]}
Saved model to disk



10

Epoch 1/1
 - 813s - loss: 0.0830 - acc: 0.9705

Test accuracy: 92.6534140017286

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1800

choose_one :  1671

F1score :  0.9251540945113002

AUC : 0.9792976998366513

Confusion Matrix
[[1640   95]
 [ 160 1576]]
True label 0
0.9452449567723343  
0.05475504322766571  
True label 1
0.09216589861751152  
0.9078341013824884  

Train_result {'loss': [0.08299430414327963], 'acc': [0.9704738722220466]}
Saved model to disk



11

Epoch 1/1
 - 815s - loss: 0.0719 - acc: 0.9731

Test accuracy: 92.45174301354076

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1731

choose_one :  1740

F1score :  0.9246260069044879

AUC : 0.979696443511866

Confusion Matrix
[[1602  133]
 [ 129 1607]]
True label 0
0.923342939481268  
0.07665706051873199  
True label 1
0.07430875576036866  
0.9256912442396313  

Train_result {'loss': [0.07189954803504682], 'acc': [0.9731293269686719]}
Saved model to disk



12

Epoch 1/1
 - 816s - loss: 0.0625 - acc: 0.9768

Test accuracy: 91.64505906078941

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1687

choose_one :  1784

F1score :  0.9176136363636364

AUC : 0.9761615360097744

Confusion Matrix
[[1566  169]
 [ 121 1615]]
True label 0
0.9025936599423631  
0.09740634005763689  
True label 1
0.06970046082949309  
0.9302995391705069  

Train_result {'loss': [0.06248049258365433], 'acc': [0.9767647709689123]}
Saved model to disk



13

Epoch 1/1
 - 812s - loss: 0.0588 - acc: 0.9795

Test accuracy: 92.13483146067416

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1732

choose_one :  1739

F1score :  0.9214388489208634

AUC : 0.9782583434042949

Confusion Matrix
[[1597  138]
 [ 135 1601]]
True label 0
0.9204610951008646  
0.07953890489913544  
True label 1
0.07776497695852534  
0.9222350230414746  

Train_result {'loss': [0.05884462318910189], 'acc': [0.9794834508266683]}
Saved model to disk



14

Epoch 1/1
 - 814s - loss: 0.0513 - acc: 0.9821

Test accuracy: 91.18409680207434

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1601

choose_one :  1870

F1score :  0.9151414309484192

AUC : 0.9756243442808006

Confusion Matrix
[[1515  220]
 [  86 1650]]
True label 0
0.8731988472622478  
0.12680115273775217  
True label 1
0.04953917050691244  
0.9504608294930875  

Train_result {'loss': [0.051334133603867946], 'acc': [0.9820756804621631]}
Saved model to disk



15

Epoch 1/1
 - 815s - loss: 0.0502 - acc: 0.9835

Test accuracy: 92.50936329588015

data size :  35104

zero :  17551

one :  17553

train_zero :  15816

train_one :  15817

test_zero :  1735

test_one :  1736

choose_zero :  1757

choose_one :  1714

F1score :  0.9246376811594204

AUC : 0.9775805455583739

Confusion Matrix
[[1616  119]
 [ 141 1595]]
True label 0
0.9314121037463977  
0.0685878962536023  
True label 1
0.08122119815668202  
0.918778801843318  

Train_result {'loss': [0.05017003826387183], 'acc': [0.9834666329466064]}
Saved model to disk




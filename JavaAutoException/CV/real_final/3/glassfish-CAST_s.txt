Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 09:41:48.758851: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 09:41:48.769230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-18 09:41:48.771138: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5ab2f80 executing computations on platform Host. Devices:
2019-07-18 09:41:48.771178: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25899

one : 
13572
glassfish-CAST_s
all data

Sentence length Average : 53

Under 10 : 10931
Over 10, Under 200 : 26175
Over 200, Under 400 : 1822
Over 400 : 543

glassfish-CAST_s
updated_train_data

Sentence length Average : 65

Under 10 : 0
Over 10, Under 200 : 22943
Over 200, Under 400 : 1974
Over 400 : 0


Test_zero:  1672
Train_zero:  14922
zero:  16594
Test_one:  1062
Train_one:  9995
one:  11057

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 465s - loss: 0.4932 - acc: 0.7546

Test accuracy: 81.74117647058824

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1187

choose_one :  938

F1score :  0.8060000000000002

AUC : 0.9065369481604315

Confusion Matrix
[[931 132]
 [256 806]]
True label 0
0.8758231420507996  
0.12417685794920037  
True label 1
0.24105461393596986  
0.7589453860640302  

Train_result {'loss': [0.4931965469195936], 'acc': [0.7546395877936455]}
Saved model to disk



2

Epoch 1/1
 - 480s - loss: 0.3659 - acc: 0.8319

Test accuracy: 84.61176470588235

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1044

choose_one :  1081

F1score :  0.8474101726551563

AUC : 0.9276680255043379

Confusion Matrix
[[890 173]
 [154 908]]
True label 0
0.8372530573847601  
0.1627469426152399  
True label 1
0.14500941619585686  
0.8549905838041432  

Train_result {'loss': [0.36586501418151823], 'acc': [0.8318743434217573]}
Saved model to disk



3

Epoch 1/1
 - 476s - loss: 0.3087 - acc: 0.8628

Test accuracy: 86.4

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1024

choose_one :  1101

F1score :  0.8663892741562645

AUC : 0.9409392810384567

Confusion Matrix
[[899 164]
 [125 937]]
True label 0
0.845719661335842  
0.15428033866415805  
True label 1
0.11770244821092278  
0.8822975517890772  

Train_result {'loss': [0.30871417954862995], 'acc': [0.8627882547265479]}
Saved model to disk



4

Epoch 1/1
 - 476s - loss: 0.2743 - acc: 0.8802

Test accuracy: 86.72941176470587

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1179

choose_one :  946

F1score :  0.8595617529880478

AUC : 0.9413343537903067

Confusion Matrix
[[980  83]
 [199 863]]
True label 0
0.9219190968955786  
0.07808090310442145  
True label 1
0.1873822975517891  
0.812617702448211  

Train_result {'loss': [0.2742977654762191], 'acc': [0.88024611077369]}
Saved model to disk



5

Epoch 1/1
 - 477s - loss: 0.2397 - acc: 0.8962

Test accuracy: 86.30588235294118

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1232

choose_one :  893

F1score :  0.8511508951406649

AUC : 0.9466173445796197

Confusion Matrix
[[1002   61]
 [ 230  832]]
True label 0
0.9426152398871119  
0.05738476011288805  
True label 1
0.21657250470809794  
0.783427495291902  

Train_result {'loss': [0.23967930435430687], 'acc': [0.8962032914602955]}
Saved model to disk



6

Epoch 1/1
 - 476s - loss: 0.2077 - acc: 0.9144

Test accuracy: 87.81176470588235

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1062

choose_one :  1063

F1score :  0.8781176470588234

AUC : 0.9485625906851413

Confusion Matrix
[[933 130]
 [129 933]]
True label 0
0.8777046095954845  
0.12229539040451552  
True label 1
0.12146892655367232  
0.8785310734463276  

Train_result {'loss': [0.20770156826203595], 'acc': [0.9143614626820488]}
Saved model to disk



7

Epoch 1/1
 - 474s - loss: 0.1835 - acc: 0.9249

Test accuracy: 87.29411764705883

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1121

choose_one :  1004

F1score :  0.8693126815101646

AUC : 0.9524052489755568

Confusion Matrix
[[957 106]
 [164 898]]
True label 0
0.9002822201317028  
0.09971777986829727  
True label 1
0.1544256120527307  
0.8455743879472694  

Train_result {'loss': [0.18351649311997512], 'acc': [0.9249162123074592]}
Saved model to disk



8

Epoch 1/1
 - 479s - loss: 0.1614 - acc: 0.9355

Test accuracy: 87.38823529411765

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1137

choose_one :  988

F1score :  0.8692682926829268

AUC : 0.9498164594749253

Confusion Matrix
[[966  97]
 [171 891]]
True label 0
0.9087488240827846  
0.09125117591721543  
True label 1
0.16101694915254236  
0.8389830508474576  

Train_result {'loss': [0.16141910301124965], 'acc': [0.9354709619447961]}
Saved model to disk



9

Epoch 1/1
 - 478s - loss: 0.1423 - acc: 0.9431

Test accuracy: 87.85882352941177

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1057

choose_one :  1068

F1score :  0.8788732394366198

AUC : 0.9524322662825779

Confusion Matrix
[[931 132]
 [126 936]]
True label 0
0.8758231420507996  
0.12417685794920037  
True label 1
0.11864406779661017  
0.8813559322033898  

Train_result {'loss': [0.1422628347155039], 'acc': [0.9431244059618212]}
Saved model to disk



10

Epoch 1/1
 - 477s - loss: 0.1187 - acc: 0.9531

Test accuracy: 88.0

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1018

choose_one :  1107

F1score :  0.8824343015214385

AUC : 0.95248984415

Confusion Matrix
[[913 150]
 [105 957]]
True label 0
0.8588899341486359  
0.14111006585136407  
True label 1
0.09887005649717515  
0.9011299435028248  

Train_result {'loss': [0.11870045468474298], 'acc': [0.9530788855223269]}
Saved model to disk



11

Epoch 1/1
 - 477s - loss: 0.1081 - acc: 0.9586

Test accuracy: 88.09411764705882

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1026

choose_one :  1099

F1score :  0.882924571957427

AUC : 0.9517555048870323

Confusion Matrix
[[918 145]
 [108 954]]
True label 0
0.863593603010348  
0.13640639698965193  
True label 1
0.1016949152542373  
0.8983050847457628  

Train_result {'loss': [0.10805891055136145], 'acc': [0.958581361624652]}
Saved model to disk



12

Epoch 1/1
 - 477s - loss: 0.0958 - acc: 0.9638

Test accuracy: 88.56470588235294

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1062

choose_one :  1063

F1score :  0.8856470588235293

AUC : 0.9530297473837505

Confusion Matrix
[[941 122]
 [121 941]]
True label 0
0.8852304797742239  
0.1147695202257761  
True label 1
0.11393596986817325  
0.8860640301318268  

Train_result {'loss': [0.09582065951090683], 'acc': [0.9637837026661998]}
Saved model to disk



13

Epoch 1/1
 - 477s - loss: 0.0836 - acc: 0.9703

Test accuracy: 88.56470588235294

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1084

choose_one :  1041

F1score :  0.884450784593438

AUC : 0.9555888621373259

Confusion Matrix
[[952 111]
 [132 930]]
True label 0
0.8955785512699906  
0.10442144873000941  
True label 1
0.12429378531073447  
0.8757062146892656  

Train_result {'loss': [0.08362226033681396], 'acc': [0.9703366515170245]}
Saved model to disk



14

Epoch 1/1
 - 477s - loss: 0.0721 - acc: 0.9747

Test accuracy: 88.8

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1035

choose_one :  1090

F1score :  0.8894052044609665

AUC : 0.9555994918974652

Confusion Matrix
[[930 133]
 [105 957]]
True label 0
0.8748824082784572  
0.1251175917215428  
True label 1
0.09887005649717515  
0.9011299435028248  

Train_result {'loss': [0.07212233113131582], 'acc': [0.9746886098863698]}
Saved model to disk



15

Epoch 1/1
 - 476s - loss: 0.0743 - acc: 0.9741

Test accuracy: 88.89411764705882

data size :  22116

zero :  11059

one :  11057

train_zero :  9996

train_one :  9995

test_zero :  1063

test_one :  1062

choose_zero :  1105

choose_one :  1020

F1score :  0.8866474543707973

AUC : 0.9593442678132634

Confusion Matrix
[[966  97]
 [139 923]]
True label 0
0.9087488240827846  
0.09125117591721543  
True label 1
0.13088512241054615  
0.8691148775894538  

Train_result {'loss': [0.07432685588571701], 'acc': [0.9740883397528888]}
Saved model to disk




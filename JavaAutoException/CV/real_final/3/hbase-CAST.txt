Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-18 18:08:10.280783: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-18 18:08:10.291433: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-18 18:08:10.293666: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6379760 executing computations on platform Host. Devices:
2019-07-18 18:08:10.293703: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26276

one : 
22977
hbase-CAST
all data

Sentence length Average : 94

Under 10 : 7520
Over 10, Under 200 : 35222
Over 200, Under 400 : 4098
Over 400 : 2413

hbase-CAST
updated_train_data

Sentence length Average : 93

Under 10 : 0
Over 10, Under 200 : 31513
Over 200, Under 400 : 5668
Over 400 : 0


Test_zero:  1955
Train_zero:  17836
zero:  19791
Test_one:  2134
Train_one:  19345
one:  21479

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 866s - loss: 0.4048 - acc: 0.8148

Test accuracy: 85.29787778061876

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  2084

choose_one :  1827

F1score :  0.8480042294475284

AUC : 0.9354187260393622

Confusion Matrix
[[1732  223]
 [ 352 1604]]
True label 0
0.8859335038363171  
0.11406649616368286  
True label 1
0.17995910020449898  
0.820040899795501  

Train_result {'loss': [0.4047903923483675], 'acc': [0.8147898971177302]}
Saved model to disk



2

Epoch 1/1
 - 941s - loss: 0.3017 - acc: 0.8687

Test accuracy: 87.47123497826644

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1867

choose_one :  2044

F1score :  0.8775000000000001

AUC : 0.951528512178411

Confusion Matrix
[[1666  289]
 [ 201 1755]]
True label 0
0.8521739130434782  
0.14782608695652175  
True label 1
0.10276073619631902  
0.897239263803681  

Train_result {'loss': [0.3016730341385195], 'acc': [0.8686962128337183]}
Saved model to disk



3

Epoch 1/1
 - 940s - loss: 0.2621 - acc: 0.8881

Test accuracy: 88.54512912298644

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1999

choose_one :  1912

F1score :  0.8841778697001035

AUC : 0.9596752598078442

Confusion Matrix
[[1753  202]
 [ 246 1710]]
True label 0
0.8966751918158568  
0.10332480818414322  
True label 1
0.12576687116564417  
0.8742331288343558  

Train_result {'loss': [0.2620807479243802], 'acc': [0.8880666050070707]}
Saved model to disk



4

Epoch 1/1
 - 933s - loss: 0.2253 - acc: 0.9060

Test accuracy: 89.84914344157504

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1976

choose_one :  1935

F1score :  0.8979696736057569

AUC : 0.9645288416780422

Confusion Matrix
[[1767  188]
 [ 209 1747]]
True label 0
0.9038363171355499  
0.09616368286445012  
True label 1
0.10685071574642127  
0.8931492842535788  

Train_result {'loss': [0.22533354922492901], 'acc': [0.9059512796910053]}
Saved model to disk



5

Epoch 1/1
 - 939s - loss: 0.2009 - acc: 0.9172

Test accuracy: 89.64459217591408

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1954

choose_one :  1957

F1score :  0.8964988499872221

AUC : 0.9652333432706237

Confusion Matrix
[[1752  203]
 [ 202 1754]]
True label 0
0.8961636828644501  
0.10383631713554987  
True label 1
0.1032719836400818  
0.8967280163599182  

Train_result {'loss': [0.20085242779066173], 'acc': [0.9171922742540173]}
Saved model to disk



6

Epoch 1/1
 - 940s - loss: 0.1754 - acc: 0.9301

Test accuracy: 90.38609051393506

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1949

choose_one :  1962

F1score :  0.9040326697294538

AUC : 0.9644866081935576

Confusion Matrix
[[1764  191]
 [ 185 1771]]
True label 0
0.90230179028133  
0.09769820971867008  
True label 1
0.09458077709611452  
0.9054192229038854  

Train_result {'loss': [0.1754315207108675], 'acc': [0.9301152131981396]}
Saved model to disk



7

Epoch 1/1
 - 941s - loss: 0.1566 - acc: 0.9387

Test accuracy: 90.7184863206341

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1912

choose_one :  1999

F1score :  0.9082174462705436

AUC : 0.968550306225451

Confusion Matrix
[[1752  203]
 [ 160 1796]]
True label 0
0.8961636828644501  
0.10383631713554987  
True label 1
0.081799591002045  
0.918200408997955  

Train_result {'loss': [0.1566383736710123], 'acc': [0.9386650968519609]}
Saved model to disk



8

Epoch 1/1
 - 937s - loss: 0.1361 - acc: 0.9464

Test accuracy: 89.72129890053695

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1807

choose_one :  2104

F1score :  0.9009852216748768

AUC : 0.966795066919806

Confusion Matrix
[[1680  275]
 [ 127 1829]]
True label 0
0.8593350383631714  
0.14066496163682865  
True label 1
0.06492842535787322  
0.9350715746421268  

Train_result {'loss': [0.13613657596512022], 'acc': [0.9464020407591175]}
Saved model to disk



9

Epoch 1/1
 - 940s - loss: 0.1221 - acc: 0.9529

Test accuracy: 90.8207619534646

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1970

choose_one :  1941

F1score :  0.9078778547600719

AUC : 0.9688765370111769

Confusion Matrix
[[1783  172]
 [ 187 1769]]
True label 0
0.9120204603580563  
0.08797953964194373  
True label 1
0.09560327198364008  
0.90439672801636  

Train_result {'loss': [0.1220744512005072], 'acc': [0.9528775264055044]}
Saved model to disk



10

Epoch 1/1
 - 944s - loss: 0.1076 - acc: 0.9597

Test accuracy: 90.64177959601125

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1989

choose_one :  1922

F1score :  0.9056214543579165

AUC : 0.9697558564636845

Confusion Matrix
[[1789  166]
 [ 200 1756]]
True label 0
0.9150895140664962  
0.08491048593350384  
True label 1
0.10224948875255624  
0.8977505112474438  

Train_result {'loss': [0.10764966126923702], 'acc': [0.9596894009324576]}
Saved model to disk



11

Epoch 1/1
 - 940s - loss: 0.0975 - acc: 0.9641

Test accuracy: 90.9741754027103

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1884

choose_one :  2027

F1score :  0.9113733366808938

AUC : 0.9662690442941646

Confusion Matrix
[[1743  212]
 [ 141 1815]]
True label 0
0.8915601023017903  
0.10843989769820972  
True label 1
0.07208588957055215  
0.9279141104294478  

Train_result {'loss': [0.09748809022339792], 'acc': [0.9640904885897894]}
Saved model to disk



12

Epoch 1/1
 - 938s - loss: 0.0889 - acc: 0.9692

Test accuracy: 90.5650728713884

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1940

choose_one :  1971

F1score :  0.9060351413292589

AUC : 0.9666294018274154

Confusion Matrix
[[1763  192]
 [ 177 1779]]
True label 0
0.9017902813299232  
0.09820971867007673  
True label 1
0.09049079754601227  
0.9095092024539877  

Train_result {'loss': [0.08889181255304578], 'acc': [0.9692484511945605]}
Saved model to disk



13

Epoch 1/1
 - 944s - loss: 0.0807 - acc: 0.9722

Test accuracy: 90.74405522884173

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  2025

choose_one :  1886

F1score :  0.9057782404997399

AUC : 0.9677321795616086

Confusion Matrix
[[1809  146]
 [ 216 1740]]
True label 0
0.9253196930946291  
0.07468030690537085  
True label 1
0.11042944785276074  
0.8895705521472392  

Train_result {'loss': [0.08072883137756452], 'acc': [0.9722198862001299]}
Saved model to disk



14

Epoch 1/1
 - 940s - loss: 0.0743 - acc: 0.9742

Test accuracy: 90.61621068780363

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  1896

choose_one :  2015

F1score :  0.9075799546713674

AUC : 0.9659080329918044

Confusion Matrix
[[1742  213]
 [ 154 1802]]
True label 0
0.8910485933503837  
0.10895140664961638  
True label 1
0.0787321063394683  
0.9212678936605317  

Train_result {'loss': [0.07428546510345482], 'acc': [0.9741541221501853]}
Saved model to disk



15

Epoch 1/1
 - 942s - loss: 0.0725 - acc: 0.9759

Test accuracy: 90.76962413704935

data size :  39584

zero :  19791

one :  19793

train_zero :  17836

train_one :  17837

test_zero :  1955

test_one :  1956

choose_zero :  2056

choose_one :  1855

F1score :  0.90527420624508

AUC : 0.9680835150811458

Confusion Matrix
[[1825  130]
 [ 231 1725]]
True label 0
0.9335038363171355  
0.06649616368286446  
True label 1
0.11809815950920245  
0.8819018404907976  

Train_result {'loss': [0.0725064454334313], 'acc': [0.9759201637059062]}
Saved model to disk




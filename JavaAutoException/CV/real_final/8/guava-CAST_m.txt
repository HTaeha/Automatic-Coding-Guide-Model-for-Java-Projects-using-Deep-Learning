Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:529: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-22 05:10:26.133396: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-22 05:10:26.144241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-22 05:10:26.146916: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1031c670 executing computations on platform Host. Devices:
2019-07-22 05:10:26.146956: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41860
one : 
17294

Second data
zero : 
41860
one : 
17294

guava-AST

Sentence length Average : 35

Under 10 : 0
Over 10, Under 200 : 32713
Over 200, Under 400 : 267
Over 400 : 0


guava-code

Sentence length Average : 56

Under 10 : 0
Over 10, Under 200 : 32092
Over 200, Under 400 : 888
Over 400 : 0


Test_zero:  2340
Train_zero:  20321
zero:  22661
Test_one:  1404
Train_one:  12659
one:  14063
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1012s - loss: 0.2738 - acc: 0.8877

Test accuracy: 92.7376290494838

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1411

choose_one :  1398

F1score :  0.9271948608137045

AUC : 0.9814759051413856

Confusion Matrix
[[1306   99]
 [ 105 1299]]
True label 0
0.9295373665480428  
0.0704626334519573  
True label 1
0.07478632478632478  
0.9252136752136753  

Train_result {'loss': [0.27380238964196146], 'acc': [0.8876732888368263]}
Saved model to disk



2

Epoch 1/1
 - 1044s - loss: 0.1747 - acc: 0.9339

Test accuracy: 93.5564257742969

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1552

choose_one :  1257

F1score :  0.9319804584742578

AUC : 0.9893395585566405

Confusion Matrix
[[1388   17]
 [ 164 1240]]
True label 0
0.9879003558718861  
0.012099644128113879  
True label 1
0.1168091168091168  
0.8831908831908832  

Train_result {'loss': [0.17474353392030412], 'acc': [0.9338836446937083]}
Saved model to disk



3

Epoch 1/1
 - 1053s - loss: 0.1264 - acc: 0.9536

Test accuracy: 96.11961552153791

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1468

choose_one :  1341

F1score :  0.9602914389799635

AUC : 0.9945929778669992

Confusion Matrix
[[1382   23]
 [  86 1318]]
True label 0
0.9836298932384342  
0.016370106761565837  
True label 1
0.06125356125356125  
0.9387464387464387  

Train_result {'loss': [0.12636168113479992], 'acc': [0.9535921639875192]}
Saved model to disk



4

Epoch 1/1
 - 1043s - loss: 0.0930 - acc: 0.9655

Test accuracy: 95.69241723033109

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1350

choose_one :  1459

F1score :  0.9577366398882291

AUC : 0.9941565025194918

Confusion Matrix
[[1317   88]
 [  33 1371]]
True label 0
0.9373665480427046  
0.06263345195729537  
True label 1
0.023504273504273504  
0.9764957264957265  

Train_result {'loss': [0.09300520856914371], 'acc': [0.965519965243493]}
Saved model to disk



5

Epoch 1/1
 - 1042s - loss: 0.0719 - acc: 0.9754

Test accuracy: 96.51121395514419

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1459

choose_one :  1350

F1score :  0.9644153957879448

AUC : 0.9976178888990277

Confusion Matrix
[[1383   22]
 [  76 1328]]
True label 0
0.9843416370106761  
0.015658362989323844  
True label 1
0.05413105413105413  
0.9458689458689459  

Train_result {'loss': [0.07187494929607559], 'acc': [0.9753939729057229]}
Saved model to disk



6

Epoch 1/1
 - 1050s - loss: 0.0563 - acc: 0.9810

Test accuracy: 98.14880740477038

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1403

choose_one :  1406

F1score :  0.9814946619217083

AUC : 0.9988289685798583

Confusion Matrix
[[1378   27]
 [  25 1379]]
True label 0
0.9807829181494662  
0.019217081850533807  
True label 1
0.017806267806267807  
0.9821937321937322  

Train_result {'loss': [0.05629312451409562], 'acc': [0.9810024092578696]}
Saved model to disk



7

Epoch 1/1
 - 1053s - loss: 0.0441 - acc: 0.9855

Test accuracy: 98.25560697757209

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1380

choose_one :  1429

F1score :  0.982703847511472

AUC : 0.9990104531029798

Confusion Matrix
[[1368   37]
 [  12 1392]]
True label 0
0.9736654804270463  
0.026334519572953737  
True label 1
0.008547008547008548  
0.9914529914529915  

Train_result {'loss': [0.044085186560899374], 'acc': [0.9855444527824954]}
Saved model to disk



8

Epoch 1/1
 - 1051s - loss: 0.0341 - acc: 0.9880

Test accuracy: 98.61160555357779

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1384

choose_one :  1425

F1score :  0.9862142099681868

AUC : 0.9992872423477406

Confusion Matrix
[[1375   30]
 [   9 1395]]
True label 0
0.9786476868327402  
0.021352313167259787  
True label 1
0.00641025641025641  
0.9935897435897436  

Train_result {'loss': [0.03413312817389259], 'acc': [0.9879537106520795]}
Saved model to disk



9

Epoch 1/1
 - 1049s - loss: 0.0304 - acc: 0.9910

Test accuracy: 98.25560697757209

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1384

choose_one :  1425

F1score :  0.9826793920113114

AUC : 0.9987742190589166

Confusion Matrix
[[1370   35]
 [  14 1390]]
True label 0
0.9750889679715302  
0.02491103202846975  
True label 1
0.009971509971509971  
0.99002849002849  

Train_result {'loss': [0.03035632700433798], 'acc': [0.9909949050120462]}
Saved model to disk



10

Epoch 1/1
 - 1047s - loss: 0.0284 - acc: 0.9915

Test accuracy: 98.9320042719829

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1399

choose_one :  1410

F1score :  0.9893390191897654

AUC : 0.9995138445316382

Confusion Matrix
[[1387   18]
 [  12 1392]]
True label 0
0.9871886120996441  
0.012811387900355872  
True label 1
0.008547008547008548  
0.9914529914529915  

Train_result {'loss': [0.02838894405872153], 'acc': [0.9914688573798334]}
Saved model to disk



11

Epoch 1/1
 - 1047s - loss: 0.0255 - acc: 0.9930

Test accuracy: 99.00320398718405

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1387

choose_one :  1422

F1score :  0.9900920028308564

AUC : 0.99956453853251

Confusion Matrix
[[1382   23]
 [   5 1399]]
True label 0
0.9836298932384342  
0.016370106761565837  
True label 1
0.0035612535612535613  
0.9964387464387464  

Train_result {'loss': [0.025544995556296444], 'acc': [0.9930486986057901]}
Saved model to disk



12

Epoch 1/1
 - 1050s - loss: 0.0221 - acc: 0.9940

Test accuracy: 99.11000355998576

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1410

choose_one :  1399

F1score :  0.9910809846592937

AUC : 0.999539191532074

Confusion Matrix
[[1395   10]
 [  15 1389]]
True label 0
0.9928825622775801  
0.0071174377224199285  
True label 1
0.010683760683760684  
0.9893162393162394  

Train_result {'loss': [0.02212485151018727], 'acc': [0.9940360993720131]}
Saved model to disk



13

Epoch 1/1
 - 1054s - loss: 0.0197 - acc: 0.9944

Test accuracy: 99.0744037023852

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1397

choose_one :  1412

F1score :  0.9907670454545454

AUC : 0.9994596019507052

Confusion Matrix
[[1388   17]
 [   9 1395]]
True label 0
0.9879003558718861  
0.012099644128113879  
True label 1
0.00641025641025641  
0.9935897435897436  

Train_result {'loss': [0.019659249066380086], 'acc': [0.9944310596785023]}
Saved model to disk



14

Epoch 1/1
 - 1052s - loss: 0.0173 - acc: 0.9953

Test accuracy: 98.78960484158064

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1387

choose_one :  1422

F1score :  0.9879688605803255

AUC : 0.9990274355932719

Confusion Matrix
[[1379   26]
 [   8 1396]]
True label 0
0.9814946619217082  
0.018505338078291814  
True label 1
0.005698005698005698  
0.9943019943019943  

Train_result {'loss': [0.017347534779534053], 'acc': [0.9952999723527786]}
Saved model to disk



15

Epoch 1/1
 - 1047s - loss: 0.0207 - acc: 0.9948

Test accuracy: 99.11000355998576

data size :  28128

zero :  14065

one :  14063

train_zero :  12660

train_one :  12659

test_zero :  1405

test_one :  1404

choose_zero :  1402

choose_one :  1407

F1score :  0.9911063678406261

AUC : 0.9994449006904522

Confusion Matrix
[[1391   14]
 [  11 1393]]
True label 0
0.9900355871886121  
0.0099644128113879  
True label 1
0.007834757834757835  
0.9921652421652422  

Train_result {'loss': [0.020744758256305864], 'acc': [0.9947865239543426]}
Saved model to disk




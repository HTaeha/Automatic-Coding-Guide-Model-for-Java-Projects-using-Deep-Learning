Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 20:24:53.734514: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 20:24:53.745693: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-21 20:24:53.748058: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x67178d0 executing computations on platform Host. Devices:
2019-07-21 20:24:53.748086: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26276

one : 
22977
hbase-code
all data

Sentence length Average : 60

Under 10 : 8982
Over 10, Under 200 : 36976
Over 200, Under 400 : 2527
Over 400 : 768

hbase-code
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 31714
Over 200, Under 400 : 2724
Over 400 : 0


Test_zero:  1779
Train_zero:  15773
zero:  17552
Test_one:  2095
Train_one:  18665
one:  20760

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 709s - loss: 0.3745 - acc: 0.8333

Test accuracy: 88.0303456026974

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1945

choose_one :  1614

F1score :  0.8744843842074249

AUC : 0.9562596711951545

Confusion Matrix
[[1649  130]
 [ 296 1484]]
True label 0
0.9269252388982574  
0.07307476110174255  
True label 1
0.1662921348314607  
0.8337078651685393  

Train_result {'loss': [0.3744854260315497], 'acc': [0.8333280502353587]}
Saved model to disk



2

Epoch 1/1
 - 736s - loss: 0.2646 - acc: 0.8847

Test accuracy: 89.94099466142174

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1771

choose_one :  1788

F1score :  0.8996636771300448

AUC : 0.9672808862446395

Confusion Matrix
[[1596  183]
 [ 175 1605]]
True label 0
0.897133220910624  
0.10286677908937605  
True label 1
0.09831460674157304  
0.901685393258427  

Train_result {'loss': [0.26459153977654026], 'acc': [0.8847433987308327]}
Saved model to disk



3

Epoch 1/1
 - 820s - loss: 0.2215 - acc: 0.9088

Test accuracy: 90.1095813430739

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1745

choose_one :  1814

F1score :  0.9020589872008904

AUC : 0.9722161168690907

Confusion Matrix
[[1586  193]
 [ 159 1621]]
True label 0
0.8915120854412592  
0.10848791455874086  
True label 1
0.08932584269662922  
0.9106741573033708  

Train_result {'loss': [0.22145406119108585], 'acc': [0.9088344375305056]}
Saved model to disk



4

Epoch 1/1
 - 820s - loss: 0.1934 - acc: 0.9196

Test accuracy: 92.10452374262434

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1818

choose_one :  1741

F1score :  0.9201931269525703

AUC : 0.9752846884059344

Confusion Matrix
[[1658  121]
 [ 160 1620]]
True label 0
0.9319842608206858  
0.06801573917931422  
True label 1
0.0898876404494382  
0.9101123595505618  

Train_result {'loss': [0.1933858190908573], 'acc': [0.9196120074865697]}
Saved model to disk



5

Epoch 1/1
 - 819s - loss: 0.1692 - acc: 0.9317

Test accuracy: 90.81202584995786

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1944

choose_one :  1615

F1score :  0.9036818851251841

AUC : 0.9742289886377274

Confusion Matrix
[[1698   81]
 [ 246 1534]]
True label 0
0.954468802698145  
0.045531197301854974  
True label 1
0.13820224719101123  
0.8617977528089887  

Train_result {'loss': [0.16919979269249025], 'acc': [0.9316575268514523]}
Saved model to disk



6

Epoch 1/1
 - 810s - loss: 0.1459 - acc: 0.9423

Test accuracy: 90.72773250913177

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1657

choose_one :  1902

F1score :  0.9103747963063552

AUC : 0.9740120380721401

Confusion Matrix
[[1553  226]
 [ 104 1676]]
True label 0
0.8729623383923553  
0.12703766160764474  
True label 1
0.058426966292134834  
0.9415730337078652  

Train_result {'loss': [0.1458529647562883], 'acc': [0.9423083018855285]}
Saved model to disk



7

Epoch 1/1
 - 752s - loss: 0.1277 - acc: 0.9510

Test accuracy: 92.63838156785614

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1767

choose_one :  1792

F1score :  0.9266517357222844

AUC : 0.9766103921531476

Confusion Matrix
[[1642  137]
 [ 125 1655]]
True label 0
0.9229904440697021  
0.07700955593029792  
True label 1
0.0702247191011236  
0.9297752808988764  

Train_result {'loss': [0.1277112411252745], 'acc': [0.951025454103276]}
Saved model to disk



8

Epoch 1/1
 - 753s - loss: 0.1065 - acc: 0.9591

Test accuracy: 92.3293059848272

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1790

choose_one :  1769

F1score :  0.9230769230769229

AUC : 0.9768192899684838

Confusion Matrix
[[1648  131]
 [ 142 1638]]
True label 0
0.9263631253513209  
0.07363687464867903  
True label 1
0.07977528089887641  
0.9202247191011236  

Train_result {'loss': [0.10646815786666794], 'acc': [0.9590769328171543]}
Saved model to disk



9

Epoch 1/1
 - 744s - loss: 0.0945 - acc: 0.9651

Test accuracy: 92.27311042427648

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1780

choose_one :  1779

F1score :  0.9227311042427648

AUC : 0.9761193322848969

Confusion Matrix
[[1642  137]
 [ 138 1642]]
True label 0
0.9229904440697021  
0.07700955593029792  
True label 1
0.07752808988764046  
0.9224719101123595  

Train_result {'loss': [0.09449852095731708], 'acc': [0.9650996925222683]}
Saved model to disk



10

Epoch 1/1
 - 747s - loss: 0.0841 - acc: 0.9686

Test accuracy: 92.21691486372576

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1878

choose_one :  1681

F1score :  0.9199653279399017

AUC : 0.9776060910371311

Confusion Matrix
[[1690   89]
 [ 188 1592]]
True label 0
0.9499718943226532  
0.05002810567734682  
True label 1
0.10561797752808989  
0.8943820224719101  

Train_result {'loss': [0.08407530406420652], 'acc': [0.9686182521506339]}
Saved model to disk



11

Epoch 1/1
 - 750s - loss: 0.0726 - acc: 0.9736

Test accuracy: 91.71115481876932

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1716

choose_one :  1843

F1score :  0.918575765939829

AUC : 0.9765772337697608

Confusion Matrix
[[1600  179]
 [ 116 1664]]
True label 0
0.8993816750983699  
0.10061832490163013  
True label 1
0.0651685393258427  
0.9348314606741573  

Train_result {'loss': [0.07260968261218735], 'acc': [0.9736266522833477]}
Saved model to disk



12

Epoch 1/1
 - 750s - loss: 0.0632 - acc: 0.9776

Test accuracy: 92.24501264400112

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1751

choose_one :  1808

F1score :  0.923076923076923

AUC : 0.975936329588015

Confusion Matrix
[[1627  152]
 [ 124 1656]]
True label 0
0.9145587408656549  
0.08544125913434514  
True label 1
0.0696629213483146  
0.9303370786516854  

Train_result {'loss': [0.06321139645195599], 'acc': [0.9776206929343519]}
Saved model to disk



13

Epoch 1/1
 - 747s - loss: 0.0613 - acc: 0.9789

Test accuracy: 92.80696824950829

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1863

choose_one :  1696

F1score :  0.9263521288837744

AUC : 0.9775045632251423

Confusion Matrix
[[1693   86]
 [ 170 1610]]
True label 0
0.9516582349634626  
0.04834176503653738  
True label 1
0.09550561797752809  
0.9044943820224719  

Train_result {'loss': [0.06130553415595516], 'acc': [0.978856943626844]}
Saved model to disk



14

Epoch 1/1
 - 748s - loss: 0.0526 - acc: 0.9824

Test accuracy: 92.75077268895757

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1833

choose_one :  1726

F1score :  0.9264118653736452

AUC : 0.9774881419305127

Confusion Matrix
[[1677  102]
 [ 156 1624]]
True label 0
0.9426644182124789  
0.05733558178752108  
True label 1
0.08764044943820225  
0.9123595505617977  

Train_result {'loss': [0.05260166956516561], 'acc': [0.9823755032174216]}
Saved model to disk



15

Epoch 1/1
 - 747s - loss: 0.0508 - acc: 0.9837

Test accuracy: 92.5259904467547

data size :  35106

zero :  17552

one :  17554

train_zero :  15773

train_one :  15774

test_zero :  1779

test_one :  1780

choose_zero :  1765

choose_one :  1794

F1score :  0.9255735870173475

AUC : 0.9762622291275872

Confusion Matrix
[[1639  140]
 [ 126 1654]]
True label 0
0.9213041034288927  
0.07869589657110736  
True label 1
0.07078651685393259  
0.9292134831460674  

Train_result {'loss': [0.050776124874067845], 'acc': [0.9836751513803546]}
Saved model to disk




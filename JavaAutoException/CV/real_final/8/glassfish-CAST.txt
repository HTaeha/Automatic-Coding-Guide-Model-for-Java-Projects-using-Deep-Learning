Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-21 18:12:45.071478: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-21 18:12:45.082530: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-21 18:12:45.085501: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x64057b0 executing computations on platform Host. Devices:
2019-07-21 18:12:45.085522: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
25926

one : 
13545
glassfish-CAST
all data

Sentence length Average : 73

Under 10 : 9491
Over 10, Under 200 : 26126
Over 200, Under 400 : 2656
Over 400 : 1198

glassfish-CAST
updated_train_data

Sentence length Average : 84

Under 10 : 0
Over 10, Under 200 : 23076
Over 200, Under 400 : 3315
Over 400 : 0


Test_zero:  1798
Train_zero:  16057
zero:  17855
Test_one:  1146
Train_one:  10334
one:  11480

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 480s - loss: 0.5011 - acc: 0.7528

Test accuracy: 83.20976886175316

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1162

choose_one :  1131

F1score :  0.8309178743961352

AUC : 0.9164148526165078

Confusion Matrix
[[962 185]
 [200 946]]
True label 0
0.8387096774193549  
0.16129032258064516  
True label 1
0.17452006980802792  
0.8254799301919721  

Train_result {'acc': [0.7528182302373052], 'loss': [0.5010871476428396]}
Saved model to disk



2

Epoch 1/1
 - 507s - loss: 0.3703 - acc: 0.8293

Test accuracy: 83.86393371129525

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1061

choose_one :  1232

F1score :  0.8444070647603028

AUC : 0.9318044188420813

Confusion Matrix
[[ 919  228]
 [ 142 1004]]
True label 0
0.8012205754141238  
0.1987794245858762  
True label 1
0.12390924956369982  
0.8760907504363001  

Train_result {'acc': [0.8292612124495239], 'loss': [0.3703317184874809]}
Saved model to disk



3

Epoch 1/1
 - 508s - loss: 0.3115 - acc: 0.8627

Test accuracy: 85.39031836022679

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1018

choose_one :  1275

F1score :  0.8616274266831887

AUC : 0.9466713377792586

Confusion Matrix
[[ 915  232]
 [ 103 1043]]
True label 0
0.7977332170880558  
0.2022667829119442  
True label 1
0.08987783595113438  
0.9101221640488656  

Train_result {'acc': [0.8626929217986188], 'loss': [0.3115276146568911]}
Saved model to disk



4

Epoch 1/1
 - 507s - loss: 0.2684 - acc: 0.8841

Test accuracy: 88.70475359790667

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1198

choose_one :  1095

F1score :  0.8844265952699687

AUC : 0.9568253019105916

Confusion Matrix
[[1043  104]
 [ 155  991]]
True label 0
0.909328683522232  
0.09067131647776809  
True label 1
0.13525305410122165  
0.8647469458987783  

Train_result {'acc': [0.8840776041731894], 'loss': [0.26837712235493194]}
Saved model to disk



5

Epoch 1/1
 - 511s - loss: 0.2378 - acc: 0.9013

Test accuracy: 88.74836458787615

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1257

choose_one :  1036

F1score :  0.8817598533455545

AUC : 0.9581642527513158

Confusion Matrix
[[1073   74]
 [ 184  962]]
True label 0
0.9354838709677419  
0.06451612903225806  
True label 1
0.16055846422338568  
0.8394415357766143  

Train_result {'acc': [0.9012530843090022], 'loss': [0.23784998198126298]}
Saved model to disk



6

Epoch 1/1
 - 508s - loss: 0.2055 - acc: 0.9145

Test accuracy: 88.8355865678151

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1093

choose_one :  1200

F1score :  0.8908780903665814

AUC : 0.9607790107283436

Confusion Matrix
[[ 992  155]
 [ 101 1045]]
True label 0
0.8648648648648649  
0.13513513513513514  
True label 1
0.0881326352530541  
0.9118673647469459  

Train_result {'acc': [0.9144612705334391], 'loss': [0.20554811699774875]}
Saved model to disk



7

Epoch 1/1
 - 509s - loss: 0.1821 - acc: 0.9242

Test accuracy: 88.35586567815089

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1036

choose_one :  1257

F1score :  0.888888888888889

AUC : 0.9630677798217065

Confusion Matrix
[[ 958  189]
 [  78 1068]]
True label 0
0.8352223190932868  
0.16477768090671316  
True label 1
0.06806282722513089  
0.9319371727748691  

Train_result {'acc': [0.9242343606424699], 'loss': [0.182102682901182]}
Saved model to disk



8

Epoch 1/1
 - 506s - loss: 0.1598 - acc: 0.9349

Test accuracy: 90.14391626689925

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1119

choose_one :  1174

F1score :  0.9025862068965519

AUC : 0.966906232359703

Confusion Matrix
[[1020  127]
 [  99 1047]]
True label 0
0.8892763731473409  
0.11072362685265912  
True label 1
0.08638743455497382  
0.9136125654450262  

Train_result {'acc': [0.9349267017980337], 'loss': [0.15979156830561247]}
Saved model to disk



9

Epoch 1/1
 - 507s - loss: 0.1354 - acc: 0.9469

Test accuracy: 89.4461404273877

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1153

choose_one :  1140

F1score :  0.89413823272091

AUC : 0.9649248133456882

Confusion Matrix
[[1029  118]
 [ 124 1022]]
True label 0
0.8971229293809939  
0.1028770706190061  
True label 1
0.1082024432809773  
0.8917975567190227  

Train_result {'acc': [0.9468769655038948], 'loss': [0.13539528018179495]}
Saved model to disk



10

Epoch 1/1
 - 508s - loss: 0.1202 - acc: 0.9548

Test accuracy: 89.53336240732665

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1223

choose_one :  1070

F1score :  0.891696750902527

AUC : 0.9645653506910051

Confusion Matrix
[[1065   82]
 [ 158  988]]
True label 0
0.9285091543156059  
0.07149084568439407  
True label 1
0.13787085514834205  
0.8621291448516579  

Train_result {'acc': [0.9547631718797603], 'loss': [0.120172423439942]}
Saved model to disk



11

Epoch 1/1
 - 510s - loss: 0.1045 - acc: 0.9600

Test accuracy: 90.58002616659398

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1189

choose_one :  1104

F1score :  0.9040000000000001

AUC : 0.9644508551787728

Confusion Matrix
[[1060   87]
 [ 129 1017]]
True label 0
0.9241499564080209  
0.07585004359197908  
True label 1
0.112565445026178  
0.887434554973822  

Train_result {'acc': [0.9600367700161381], 'loss': [0.10446323847149527]}
Saved model to disk



12

Epoch 1/1
 - 508s - loss: 0.0951 - acc: 0.9629

Test accuracy: 90.05669428696031

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1083

choose_one :  1210

F1score :  0.9032258064516129

AUC : 0.9662112712273159

Confusion Matrix
[[1001  146]
 [  82 1064]]
True label 0
0.8727114210985178  
0.12728857890148212  
True label 1
0.07155322862129145  
0.9284467713787086  

Train_result {'acc': [0.9629396680760346], 'loss': [0.09511641423652366]}
Saved model to disk



13

Epoch 1/1
 - 507s - loss: 0.0863 - acc: 0.9680

Test accuracy: 89.96947230702136

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1131

choose_one :  1162

F1score :  0.9003466204506066

AUC : 0.9650967468059176

Confusion Matrix
[[1024  123]
 [ 107 1039]]
True label 0
0.8927637314734089  
0.10723626852659111  
True label 1
0.09336823734729494  
0.9066317626527051  

Train_result {'acc': [0.9680197397068073], 'loss': [0.08634877294688412]}
Saved model to disk



14

Epoch 1/1
 - 509s - loss: 0.0818 - acc: 0.9707

Test accuracy: 90.01308329699084

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1136

choose_one :  1157

F1score :  0.9005644811115936

AUC : 0.9643036466630455

Confusion Matrix
[[1027  120]
 [ 109 1037]]
True label 0
0.8953792502179599  
0.1046207497820401  
True label 1
0.09511343804537521  
0.9048865619546248  

Train_result {'acc': [0.9707291112293773], 'loss': [0.08178517948938822]}
Saved model to disk



15

Epoch 1/1
 - 509s - loss: 0.0708 - acc: 0.9748

Test accuracy: 90.01308329699084

data size :  22962

zero :  11482

one :  11480

train_zero :  10335

train_one :  10334

test_zero :  1147

test_one :  1146

choose_zero :  1150

choose_one :  1143

F1score :  0.8999563128003496

AUC : 0.9663105513890853

Confusion Matrix
[[1034  113]
 [ 116 1030]]
True label 0
0.9014821272885789  
0.0985178727114211  
True label 1
0.1012216404886562  
0.8987783595113438  

Train_result {'acc': [0.9747931685132324], 'loss': [0.07082579221625657]}
Saved model to disk




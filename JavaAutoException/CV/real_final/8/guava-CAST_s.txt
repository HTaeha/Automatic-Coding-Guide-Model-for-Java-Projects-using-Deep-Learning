Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:357: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-20 23:53:53.002315: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-20 23:53:53.012753: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-20 23:53:53.015062: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x67945e0 executing computations on platform Host. Devices:
2019-07-20 23:53:53.015100: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41834

one : 
17320
guava-CAST_s
all data

Sentence length Average : 47

Under 10 : 5998
Over 10, Under 200 : 51675
Over 200, Under 400 : 1254
Over 400 : 227

guava-CAST_s
updated_train_data

Sentence length Average : 51

Under 10 : 0
Over 10, Under 200 : 46075
Over 200, Under 400 : 1253
Over 400 : 0


Test_zero:  3731
Train_zero:  32885
zero:  36616
Test_one:  1597
Train_one:  14443
one:  16040

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 692s - loss: 0.3163 - acc: 0.8614

Test accuracy: 89.38967136150234

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1781

choose_one :  1414

F1score :  0.8874128196612421

AUC : 0.9676936496230808

Confusion Matrix
[[1520   78]
 [ 261 1336]]
True label 0
0.951188986232791  
0.04881101376720901  
True label 1
0.16343143393863493  
0.8365685660613651  

Train_result {'loss': [0.31634645951550655], 'acc': [0.8614255547416203]}
Saved model to disk



2

Epoch 1/1
 - 718s - loss: 0.2191 - acc: 0.9113

Test accuracy: 92.42566510172145

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1644

choose_one :  1551

F1score :  0.923125794155019

AUC : 0.9788785763042878

Confusion Matrix
[[1500   98]
 [ 144 1453]]
True label 0
0.9386733416770964  
0.06132665832290363  
True label 1
0.09016906700062617  
0.9098309329993738  

Train_result {'loss': [0.21911681243950495], 'acc': [0.9113442032603859]}
Saved model to disk



3

Epoch 1/1
 - 687s - loss: 0.1696 - acc: 0.9321

Test accuracy: 92.80125195618153

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1718

choose_one :  1477

F1score :  0.9251789199739753

AUC : 0.9843593627914667

Confusion Matrix
[[1543   55]
 [ 175 1422]]
True label 0
0.9655819774718398  
0.0344180225281602  
True label 1
0.10958046336881654  
0.8904195366311835  

Train_result {'loss': [0.1695999896739483], 'acc': [0.9321147921375302]}
Saved model to disk



4

Epoch 1/1
 - 684s - loss: 0.1301 - acc: 0.9493

Test accuracy: 94.39749608763694

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1631

choose_one :  1564

F1score :  0.9433723505219868

AUC : 0.9898001807205782

Confusion Matrix
[[1525   73]
 [ 106 1491]]
True label 0
0.9543178973717147  
0.045682102628285357  
True label 1
0.06637445209768315  
0.9336255479023169  

Train_result {'loss': [0.13014678479114805], 'acc': [0.9493197632235406]}
Saved model to disk



5

Epoch 1/1
 - 687s - loss: 0.1021 - acc: 0.9623

Test accuracy: 96.18153364632238

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1566

choose_one :  1629

F1score :  0.9621822690638562

AUC : 0.9928487628947581

Confusion Matrix
[[1521   77]
 [  45 1552]]
True label 0
0.9518147684605757  
0.04818523153942428  
True label 1
0.028177833437695678  
0.9718221665623044  

Train_result {'loss': [0.1020871482064241], 'acc': [0.9622667636043347]}
Saved model to disk



6

Epoch 1/1
 - 694s - loss: 0.0830 - acc: 0.9689

Test accuracy: 96.18153364632238

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1544

choose_one :  1651

F1score :  0.9624384236453203

AUC : 0.9936890822357002

Confusion Matrix
[[1510   88]
 [  34 1563]]
True label 0
0.9449311639549437  
0.05506883604505632  
True label 1
0.021289918597370068  
0.9787100814026299  

Train_result {'loss': [0.0829652286479856], 'acc': [0.9689479696749402]}
Saved model to disk



7

Epoch 1/1
 - 686s - loss: 0.0670 - acc: 0.9762

Test accuracy: 95.77464788732394

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1613

choose_one :  1582

F1score :  0.9575338156653035

AUC : 0.992767454308493

Confusion Matrix
[[1538   60]
 [  75 1522]]
True label 0
0.9624530663329162  
0.03754693366708386  
True label 1
0.046963055729492796  
0.9530369442705072  

Train_result {'loss': [0.06704233529004879], 'acc': [0.9762176757793616]}
Saved model to disk



8

Epoch 1/1
 - 682s - loss: 0.0590 - acc: 0.9791

Test accuracy: 96.21283255086071

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1615

choose_one :  1580

F1score :  0.9619137551148882

AUC : 0.9938244659299391

Confusion Matrix
[[1546   52]
 [  69 1528]]
True label 0
0.967459324155194  
0.03254067584480601  
True label 1
0.043206011271133375  
0.9567939887288667  

Train_result {'loss': [0.059020450818028224], 'acc': [0.9790563229134213]}
Saved model to disk



9

Epoch 1/1
 - 686s - loss: 0.0494 - acc: 0.9822

Test accuracy: 96.6510172143975

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1593

choose_one :  1602

F1score :  0.9665520475148485

AUC : 0.9954796344522702

Confusion Matrix
[[1542   56]
 [  51 1546]]
True label 0
0.9649561952440551  
0.03504380475594493  
True label 1
0.031934877896055106  
0.9680651221039449  

Train_result {'loss': [0.04938794807146294], 'acc': [0.9822411465365043]}
Saved model to disk



10

Epoch 1/1
 - 688s - loss: 0.0476 - acc: 0.9842

Test accuracy: 97.24569640062597

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1568

choose_one :  1627

F1score :  0.9727047146401985

AUC : 0.9945795581985308

Confusion Matrix
[[1539   59]
 [  29 1568]]
True label 0
0.9630788485607009  
0.036921151439299124  
True label 1
0.018159048215403883  
0.9818409517845961  

Train_result {'loss': [0.04763898764233987], 'acc': [0.9842143524768927]}
Saved model to disk



11

Epoch 1/1
 - 686s - loss: 0.0416 - acc: 0.9859

Test accuracy: 97.24569640062597

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1526

choose_one :  1669

F1score :  0.9730557256582978

AUC : 0.9941659619922524

Confusion Matrix
[[1518   80]
 [   8 1589]]
True label 0
0.9499374217772215  
0.05006257822277847  
True label 1
0.005009392611145898  
0.9949906073888541  

Train_result {'loss': [0.04156965806055603], 'acc': [0.9859106172326653]}
Saved model to disk



12

Epoch 1/1
 - 690s - loss: 0.0391 - acc: 0.9880

Test accuracy: 97.90297339593114

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1601

choose_one :  1594

F1score :  0.9790034471952366

AUC : 0.9958589439053042

Confusion Matrix
[[1566   32]
 [  35 1562]]
True label 0
0.9799749687108886  
0.02002503128911139  
True label 1
0.021916092673763307  
0.9780839073262367  

Train_result {'loss': [0.03909296884503414], 'acc': [0.9879530584774611]}
Saved model to disk



13

Epoch 1/1
 - 687s - loss: 0.0337 - acc: 0.9892

Test accuracy: 97.46478873239437

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1587

choose_one :  1608

F1score :  0.9747269890795632

AUC : 0.995519798934642

Confusion Matrix
[[1552   46]
 [  35 1562]]
True label 0
0.9712140175219024  
0.028785982478097622  
True label 1
0.021916092673763307  
0.9780839073262367  

Train_result {'loss': [0.03365093836612837], 'acc': [0.9892339114480562]}
Saved model to disk



14

Epoch 1/1
 - 689s - loss: 0.0318 - acc: 0.9905

Test accuracy: 97.80907668231612

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1554

choose_one :  1641

F1score :  0.9783817171093266

AUC : 0.9959498527824778

Confusion Matrix
[[1541   57]
 [  13 1584]]
True label 0
0.9643304130162703  
0.03566958698372966  
True label 1
0.008140262993112084  
0.9918597370068879  

Train_result {'loss': [0.03177493695791309], 'acc': [0.9904801467788279]}
Saved model to disk



15

Epoch 1/1
 - 684s - loss: 0.0308 - acc: 0.9905

Test accuracy: 96.77621283255085

data size :  32082

zero :  16042

one :  16040

train_zero :  14444

train_one :  14443

test_zero :  1598

test_one :  1597

choose_zero :  1529

choose_one :  1666

F1score :  0.9684339564817653

AUC : 0.9926207070046074

Confusion Matrix
[[1512   86]
 [  17 1580]]
True label 0
0.9461827284105131  
0.05381727158948686  
True label 1
0.010644959298685034  
0.989355040701315  

Train_result {'loss': [0.030824156285611932], 'acc': [0.9904801467788279]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:44: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 22:47:40.250254: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 22:47:40.262100: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 22:47:40.264633: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x943e940 executing computations on platform Host. Devices:
2019-10-14 22:47:40.264684: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

193
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 193, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128)          32896       concatenate_3[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            258         dense_1[0][0]                    
==================================================================================================
Total params: 304,514
Trainable params: 304,514
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 48s - loss: 0.7273 - acc: 0.5000
 128/1000 [==>...........................] - ETA: 24s - loss: 0.7800 - acc: 0.4531
 192/1000 [====>.........................] - ETA: 16s - loss: 0.7599 - acc: 0.4688
 256/1000 [======>.......................] - ETA: 12s - loss: 0.7310 - acc: 0.5312
 320/1000 [========>.....................] - ETA: 9s - loss: 0.7293 - acc: 0.5312 
 384/1000 [==========>...................] - ETA: 7s - loss: 0.7110 - acc: 0.5547
 448/1000 [============>.................] - ETA: 6s - loss: 0.7063 - acc: 0.5580
 512/1000 [==============>...............] - ETA: 4s - loss: 0.7053 - acc: 0.5586
 576/1000 [================>.............] - ETA: 4s - loss: 0.6983 - acc: 0.5642
 640/1000 [==================>...........] - ETA: 3s - loss: 0.6888 - acc: 0.5766
 704/1000 [====================>.........] - ETA: 2s - loss: 0.6861 - acc: 0.5795
 768/1000 [======================>.......] - ETA: 1s - loss: 0.6781 - acc: 0.5898
 832/1000 [=======================>......] - ETA: 1s - loss: 0.6901 - acc: 0.5889
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6833 - acc: 0.5982
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6803 - acc: 0.6010
1000/1000 [==============================] - 7s 7ms/step - loss: 0.6774 - acc: 0.6050

Test accuracy: 73.21793355553167

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  11053

choose_one :  7549

F1score :  0.7026026743075453

AUC :  0.8130722660287033

Confusion Matrix
[[7735 1664]
 [3318 5885]]
True label 0
0.8229598893499308  
0.17704011065006917  
True label 1
0.36053460827990874  
0.6394653917200913  

Train_result {'acc': [0.6049999995231629], 'loss': [0.6774455876350403]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.5823 - acc: 0.7188
 128/1000 [==>...........................] - ETA: 4s - loss: 0.5709 - acc: 0.7109
 192/1000 [====>.........................] - ETA: 3s - loss: 0.5814 - acc: 0.7031
 256/1000 [======>.......................] - ETA: 3s - loss: 0.5839 - acc: 0.6914
 320/1000 [========>.....................] - ETA: 3s - loss: 0.5991 - acc: 0.6781
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5965 - acc: 0.6849
 448/1000 [============>.................] - ETA: 2s - loss: 0.5896 - acc: 0.6875
 512/1000 [==============>...............] - ETA: 2s - loss: 0.5839 - acc: 0.7012
 576/1000 [================>.............] - ETA: 1s - loss: 0.5866 - acc: 0.6944
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5837 - acc: 0.6953
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5793 - acc: 0.6946
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5733 - acc: 0.7018
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5645 - acc: 0.7115
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5622 - acc: 0.7165
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5638 - acc: 0.7135
1000/1000 [==============================] - 4s 4ms/step - loss: 0.5650 - acc: 0.7110

Test accuracy: 77.32501881518117

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9619

choose_one :  8983

F1score :  0.768063345430551

AUC :  0.8472906107801459

Confusion Matrix
[[7400 1999]
 [2219 6984]]
True label 0
0.7873177997659325  
0.21268220023406745  
True label 1
0.24111702705639465  
0.7588829729436053  

Train_result {'acc': [0.7109999990463257], 'loss': [0.5649682459831238]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.6444 - acc: 0.6094
 128/1000 [==>...........................] - ETA: 4s - loss: 0.5416 - acc: 0.7109
 192/1000 [====>.........................] - ETA: 3s - loss: 0.5217 - acc: 0.7292
 256/1000 [======>.......................] - ETA: 3s - loss: 0.5235 - acc: 0.7383
 320/1000 [========>.....................] - ETA: 3s - loss: 0.5272 - acc: 0.7406
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5315 - acc: 0.7422
 448/1000 [============>.................] - ETA: 2s - loss: 0.5178 - acc: 0.7545
 512/1000 [==============>...............] - ETA: 2s - loss: 0.5099 - acc: 0.7598
 576/1000 [================>.............] - ETA: 1s - loss: 0.5090 - acc: 0.7622
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5041 - acc: 0.7625
 704/1000 [====================>.........] - ETA: 1s - loss: 0.5013 - acc: 0.7642
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5011 - acc: 0.7656
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4945 - acc: 0.7716
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4867 - acc: 0.7734
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4865 - acc: 0.7698
1000/1000 [==============================] - 4s 4ms/step - loss: 0.4978 - acc: 0.7630

Test accuracy: 77.64756477798086

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8351

choose_one :  10251

F1score :  0.7862650354682842

AUC :  0.8647229227409423

Confusion Matrix
[[6796 2603]
 [1555 7648]]
True label 0
0.7230556442174699  
0.27694435578253007  
True label 1
0.16896664131261546  
0.8310333586873846  

Train_result {'acc': [0.7630000009536743], 'loss': [0.49777501773834226]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3952 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4600 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4656 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4589 - acc: 0.8008
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4730 - acc: 0.7875
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4799 - acc: 0.7839
 448/1000 [============>.................] - ETA: 2s - loss: 0.4661 - acc: 0.7924
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4709 - acc: 0.7852
 576/1000 [================>.............] - ETA: 1s - loss: 0.4643 - acc: 0.7882
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4760 - acc: 0.7828
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4698 - acc: 0.7855
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4668 - acc: 0.7878
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4619 - acc: 0.7933
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4629 - acc: 0.7924
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4711 - acc: 0.7885
1000/1000 [==============================] - 4s 4ms/step - loss: 0.4701 - acc: 0.7880

Test accuracy: 77.53467369100096

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  11622

choose_one :  6980

F1score :  0.7417660507940431

AUC :  0.876245981210626

Confusion Matrix
[[8421  978]
 [3201 6002]]
True label 0
0.8959463772741781  
0.1040536227258219  
True label 1
0.3478213625991525  
0.6521786374008476  

Train_result {'acc': [0.7879999990463257], 'loss': [0.47010542440414427]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.4580 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4441 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4862 - acc: 0.7292
 256/1000 [======>.......................] - ETA: 3s - loss: 0.4680 - acc: 0.7500
 320/1000 [========>.....................] - ETA: 3s - loss: 0.4656 - acc: 0.7531
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4593 - acc: 0.7630
 448/1000 [============>.................] - ETA: 2s - loss: 0.4629 - acc: 0.7545
 512/1000 [==============>...............] - ETA: 2s - loss: 0.4629 - acc: 0.7578
 576/1000 [================>.............] - ETA: 1s - loss: 0.4552 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4459 - acc: 0.7688
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4370 - acc: 0.7812
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4286 - acc: 0.7904
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4290 - acc: 0.7933
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4296 - acc: 0.7935
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4256 - acc: 0.7927
1000/1000 [==============================] - 4s 4ms/step - loss: 0.4279 - acc: 0.7900

Test accuracy: 80.41070852596495

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9321

choose_one :  9281

F1score :  0.8028565245617831

AUC :  0.8871032284917708

Confusion Matrix
[[7538 1861]
 [1783 7420]]
True label 0
0.8020002127885946  
0.19799978721140546  
True label 1
0.19374117135716615  
0.8062588286428338  

Train_result {'acc': [0.7900000009536743], 'loss': [0.4279185178279877]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3996 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 4s - loss: 0.4035 - acc: 0.8359
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3768 - acc: 0.8333
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3983 - acc: 0.8203
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3826 - acc: 0.8313
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3958 - acc: 0.8307
 448/1000 [============>.................] - ETA: 2s - loss: 0.3846 - acc: 0.8348
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3853 - acc: 0.8320
 576/1000 [================>.............] - ETA: 1s - loss: 0.3841 - acc: 0.8299
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3854 - acc: 0.8297
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3857 - acc: 0.8267
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3913 - acc: 0.8255
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3866 - acc: 0.8281
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3841 - acc: 0.8304
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3860 - acc: 0.8323
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3870 - acc: 0.8320

Test accuracy: 80.7816363831846

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10658

choose_one :  7944

F1score :  0.7915087187263077

AUC :  0.8962048022360306

Confusion Matrix
[[8241 1158]
 [2417 6786]]
True label 0
0.8767954037663581  
0.12320459623364188  
True label 1
0.262631750516136  
0.7373682494838639  

Train_result {'acc': [0.8319999995231628], 'loss': [0.38703897094726564]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.4432 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3729 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3410 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3552 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 3s - loss: 0.3609 - acc: 0.8594
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3437 - acc: 0.8646
 448/1000 [============>.................] - ETA: 2s - loss: 0.3498 - acc: 0.8527
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3461 - acc: 0.8477
 576/1000 [================>.............] - ETA: 1s - loss: 0.3406 - acc: 0.8524
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3484 - acc: 0.8516
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3724 - acc: 0.8381
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3653 - acc: 0.8424
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3674 - acc: 0.8413
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3675 - acc: 0.8382
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3719 - acc: 0.8365
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3705 - acc: 0.8370

Test accuracy: 81.75465003763036

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8617

choose_one :  9985

F1score :  0.8231186158015426

AUC :  0.9002545486163267

Confusion Matrix
[[7311 2088]
 [1306 7897]]
True label 0
0.7778487073092882  
0.22215129269071177  
True label 1
0.14191024665869825  
0.8580897533413018  

Train_result {'acc': [0.8370000009536743], 'loss': [0.37049420046806336]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3201 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3387 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3318 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3327 - acc: 0.8555
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3501 - acc: 0.8531
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3461 - acc: 0.8542
 448/1000 [============>.................] - ETA: 2s - loss: 0.3279 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3232 - acc: 0.8691
 576/1000 [================>.............] - ETA: 1s - loss: 0.3281 - acc: 0.8628
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3360 - acc: 0.8578
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3275 - acc: 0.8622
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3227 - acc: 0.8659
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3260 - acc: 0.8618
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3248 - acc: 0.8638
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3309 - acc: 0.8604
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3407 - acc: 0.8570

Test accuracy: 81.14181270831094

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8485

choose_one :  10117

F1score :  0.8184265010351967

AUC :  0.9011827674718587

Confusion Matrix
[[7188 2211]
 [1297 7906]]
True label 0
0.7647622087456112  
0.23523779125438876  
True label 1
0.14093230468325546  
0.8590676953167445  

Train_result {'acc': [0.8569999990463257], 'loss': [0.34070191192626953]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.4483 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3871 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3631 - acc: 0.8542
 256/1000 [======>.......................] - ETA: 3s - loss: 0.3435 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3182 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3303 - acc: 0.8750
 448/1000 [============>.................] - ETA: 2s - loss: 0.3249 - acc: 0.8817
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3188 - acc: 0.8809
 576/1000 [================>.............] - ETA: 1s - loss: 0.3191 - acc: 0.8767
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3315 - acc: 0.8672
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3271 - acc: 0.8636
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3298 - acc: 0.8594
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3367 - acc: 0.8558
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3369 - acc: 0.8516
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3398 - acc: 0.8500
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3408 - acc: 0.8500

Test accuracy: 79.16353080313945

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7389

choose_one :  11213

F1score :  0.8101489028213166

AUC :  0.8976250499182089

Confusion Matrix
[[6456 2943]
 [ 933 8270]]
True label 0
0.6868815831471433  
0.3131184168528567  
True label 1
0.10137998478756927  
0.8986200152124307  

Train_result {'acc': [0.8500000009536743], 'loss': [0.34075096559524537]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2950 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2616 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2845 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2753 - acc: 0.8906
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2778 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3003 - acc: 0.8724
 448/1000 [============>.................] - ETA: 2s - loss: 0.3054 - acc: 0.8661
 512/1000 [==============>...............] - ETA: 2s - loss: 0.3032 - acc: 0.8691
 576/1000 [================>.............] - ETA: 1s - loss: 0.3032 - acc: 0.8663
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3151 - acc: 0.8625
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3196 - acc: 0.8565
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3185 - acc: 0.8555
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3160 - acc: 0.8546
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3103 - acc: 0.8583
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3072 - acc: 0.8615
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3076 - acc: 0.8610

Test accuracy: 81.2439522631975

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10134

choose_one :  8468

F1score :  0.8025578631656387

AUC :  0.9004464121127324

Confusion Matrix
[[8022 1377]
 [2112 7091]]
True label 0
0.8534950526651771  
0.14650494733482286  
True label 1
0.2294903835705748  
0.7705096164294252  

Train_result {'acc': [0.8610000009536743], 'loss': [0.30762636041641234]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1899 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1892 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2044 - acc: 0.9271
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2199 - acc: 0.9141
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2269 - acc: 0.9125
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2376 - acc: 0.9010
 448/1000 [============>.................] - ETA: 2s - loss: 0.2424 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2481 - acc: 0.8945
 576/1000 [================>.............] - ETA: 1s - loss: 0.2358 - acc: 0.9062
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2415 - acc: 0.9016
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2552 - acc: 0.8963
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2623 - acc: 0.8932
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2681 - acc: 0.8906
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2682 - acc: 0.8917
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2718 - acc: 0.8875
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2715 - acc: 0.8880

Test accuracy: 79.92688958176541

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8037

choose_one :  10565

F1score :  0.8111088628085795

AUC :  0.892703663373114

Confusion Matrix
[[6851 2548]
 [1186 8017]]
True label 0
0.7289073305670816  
0.2710926694329184  
True label 1
0.12887102031946104  
0.8711289796805389  

Train_result {'acc': [0.8879999990463256], 'loss': [0.2714836211204529]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.3791 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 4s - loss: 0.3234 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2952 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2779 - acc: 0.8945
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2741 - acc: 0.8875
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2524 - acc: 0.8958
 448/1000 [============>.................] - ETA: 2s - loss: 0.2863 - acc: 0.8817
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2801 - acc: 0.8848
 576/1000 [================>.............] - ETA: 1s - loss: 0.2757 - acc: 0.8872
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2755 - acc: 0.8844
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2728 - acc: 0.8849
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2656 - acc: 0.8880
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2703 - acc: 0.8858
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2746 - acc: 0.8839
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2773 - acc: 0.8844
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2725 - acc: 0.8870

Test accuracy: 82.42662079346307

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9958

choose_one :  8644

F1score :  0.8168319605535944

AUC :  0.9050852751506471

Confusion Matrix
[[8044 1355]
 [1914 7289]]
True label 0
0.8558357272050218  
0.14416427279497818  
True label 1
0.20797566011083343  
0.7920243398891665  

Train_result {'acc': [0.8869999995231629], 'loss': [0.2725360715389252]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2620 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2295 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2670 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2722 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2955 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2793 - acc: 0.8802
 448/1000 [============>.................] - ETA: 2s - loss: 0.2608 - acc: 0.8929
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2520 - acc: 0.8965
 576/1000 [================>.............] - ETA: 1s - loss: 0.2525 - acc: 0.8993
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2586 - acc: 0.8938
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2542 - acc: 0.8935
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2530 - acc: 0.8945
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2475 - acc: 0.8954
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2475 - acc: 0.8951
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2527 - acc: 0.8948
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2566 - acc: 0.8920

Test accuracy: 82.33523277066982

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9927

choose_one :  8675

F1score :  0.8161986799418279

AUC :  0.9040031238743728

Confusion Matrix
[[8020 1379]
 [1907 7296]]
True label 0
0.8532822640706458  
0.1467177359293542  
True label 1
0.20721503857437792  
0.792784961425622  

Train_result {'acc': [0.8919999995231629], 'loss': [0.2566190233230591]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.2722 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 4s - loss: 0.2579 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2520 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 3s - loss: 0.2275 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 3s - loss: 0.2144 - acc: 0.8938
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2045 - acc: 0.8984
 448/1000 [============>.................] - ETA: 2s - loss: 0.2008 - acc: 0.8996
 512/1000 [==============>...............] - ETA: 2s - loss: 0.2106 - acc: 0.9023
 576/1000 [================>.............] - ETA: 1s - loss: 0.2116 - acc: 0.9062
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2218 - acc: 0.9031
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2169 - acc: 0.9048
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2201 - acc: 0.9023
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2182 - acc: 0.9026
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2165 - acc: 0.9040
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2142 - acc: 0.9062
1000/1000 [==============================] - 4s 4ms/step - loss: 0.2094 - acc: 0.9080

Test accuracy: 81.3138372218041

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8869

choose_one :  9733

F1score :  0.816434305027461

AUC :  0.9000234707923838

Confusion Matrix
[[7396 2003]
 [1473 7730]]
True label 0
0.7868922225768699  
0.2131077774231301  
True label 1
0.1600565033141367  
0.8399434966858633  

Train_result {'acc': [0.9079999995231628], 'loss': [0.2094240630865097]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1810 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 4s - loss: 0.1567 - acc: 0.9297
 192/1000 [====>.........................] - ETA: 3s - loss: 0.1568 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 3s - loss: 0.1493 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 3s - loss: 0.1621 - acc: 0.9313
 384/1000 [==========>...................] - ETA: 2s - loss: 0.1476 - acc: 0.9427
 448/1000 [============>.................] - ETA: 2s - loss: 0.1575 - acc: 0.9308
 512/1000 [==============>...............] - ETA: 2s - loss: 0.1691 - acc: 0.9277
 576/1000 [================>.............] - ETA: 1s - loss: 0.1772 - acc: 0.9306
 640/1000 [==================>...........] - ETA: 1s - loss: 0.1813 - acc: 0.9266
 704/1000 [====================>.........] - ETA: 1s - loss: 0.1790 - acc: 0.9276
 768/1000 [======================>.......] - ETA: 0s - loss: 0.1760 - acc: 0.9310
 832/1000 [=======================>......] - ETA: 0s - loss: 0.1798 - acc: 0.9279
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1790 - acc: 0.9286
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1790 - acc: 0.9292
1000/1000 [==============================] - 4s 4ms/step - loss: 0.1859 - acc: 0.9280

Test accuracy: 82.15783249113

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9642

choose_one :  8960

F1score :  0.8172658701756318

AUC :  0.8981792181937092

Confusion Matrix
[[7861 1538]
 [1781 7422]]
True label 0
0.8363655708054049  
0.16363442919459517  
True label 1
0.19352385091817886  
0.8064761490818212  

Train_result {'acc': [0.9279999990463257], 'loss': [0.18585185956954955]}
Saved model to disk


[[73.21793355553167, 1], [77.32501881518117, 2], [77.64756477798086, 3], [77.53467369100096, 4], [80.41070852596495, 5], [80.7816363831846, 6], [81.75465003763036, 7], [81.14181270831094, 8], [79.16353080313945, 9], [81.2439522631975, 10], [79.92688958176541, 11], [82.42662079346307, 12], [82.33523277066982, 13], [81.3138372218041, 14], [82.15783249113, 15]]
max accuracy :  [82.42662079346307, 12]

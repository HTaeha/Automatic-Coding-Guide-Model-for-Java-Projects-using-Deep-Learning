Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:139: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-11 02:03:00.284847: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-11 02:03:00.343749: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-11 02:03:00.349360: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xe8c0990 executing computations on platform Host. Devices:
2019-10-11 02:03:00.349401: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

Second data
zero :  10049
one :  10279

Third data
zero :  10049
one :  10279

4th data
zero :  10049
one :  10279

hbase-code
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

300
hbase-AST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778
After balance out data.
hbase-AST

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
hbase-CAST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778
After balance out data.
hbase-CAST

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

697
hbase-depth_num
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778
After balance out data.
hbase-depth_num

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 300, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 300, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 621, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 697, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 697, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 621, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          196992      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            514         dense_3[0][0]                    
==================================================================================================
Total params: 1,068,674
Trainable params: 1,068,674
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 2:18 - loss: 0.7076 - acc: 0.4688
 128/1000 [==>...........................] - ETA: 1:16 - loss: 0.7296 - acc: 0.5078
 192/1000 [====>.........................] - ETA: 54s - loss: 0.7493 - acc: 0.4792 
 256/1000 [======>.......................] - ETA: 42s - loss: 0.7408 - acc: 0.4844
 320/1000 [========>.....................] - ETA: 34s - loss: 0.7517 - acc: 0.4750
 384/1000 [==========>...................] - ETA: 28s - loss: 0.7468 - acc: 0.4635
 448/1000 [============>.................] - ETA: 24s - loss: 0.7326 - acc: 0.4799
 512/1000 [==============>...............] - ETA: 20s - loss: 0.7242 - acc: 0.4941
 576/1000 [================>.............] - ETA: 17s - loss: 0.7290 - acc: 0.4965
 640/1000 [==================>...........] - ETA: 13s - loss: 0.7283 - acc: 0.5016
 704/1000 [====================>.........] - ETA: 11s - loss: 0.7233 - acc: 0.5085
 768/1000 [======================>.......] - ETA: 8s - loss: 0.7197 - acc: 0.5156 
 832/1000 [=======================>......] - ETA: 5s - loss: 0.7136 - acc: 0.5204
 896/1000 [=========================>....] - ETA: 3s - loss: 0.7095 - acc: 0.5246
 960/1000 [===========================>..] - ETA: 1s - loss: 0.7101 - acc: 0.5250
1000/1000 [==============================] - 33s 33ms/step - loss: 0.7065 - acc: 0.5320

Test accuracy: 67.35306291390728

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7130

choose_one :  12198

F1score :  0.7128685839097197

AUC :  0.7578836184232367

Confusion Matrix
[[5185 4365]
 [1945 7833]]
True label 0
0.5429319371727749  
0.4570680628272251  
True label 1
0.1989159337287789  
0.8010840662712211  

Train_result {'acc': [0.5319999995231628], 'loss': [0.7065190124511719]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 26s - loss: 0.6386 - acc: 0.5938
 128/1000 [==>...........................] - ETA: 22s - loss: 0.6320 - acc: 0.6094
 192/1000 [====>.........................] - ETA: 19s - loss: 0.6138 - acc: 0.6354
 256/1000 [======>.......................] - ETA: 17s - loss: 0.6353 - acc: 0.6172
 320/1000 [========>.....................] - ETA: 15s - loss: 0.6255 - acc: 0.6250
 384/1000 [==========>...................] - ETA: 14s - loss: 0.6189 - acc: 0.6302
 448/1000 [============>.................] - ETA: 12s - loss: 0.6117 - acc: 0.6406
 512/1000 [==============>...............] - ETA: 11s - loss: 0.6017 - acc: 0.6543
 576/1000 [================>.............] - ETA: 9s - loss: 0.6108 - acc: 0.6441 
 640/1000 [==================>...........] - ETA: 8s - loss: 0.6134 - acc: 0.6453
 704/1000 [====================>.........] - ETA: 6s - loss: 0.6111 - acc: 0.6477
 768/1000 [======================>.......] - ETA: 5s - loss: 0.6124 - acc: 0.6497
 832/1000 [=======================>......] - ETA: 3s - loss: 0.6123 - acc: 0.6502
 896/1000 [=========================>....] - ETA: 2s - loss: 0.6092 - acc: 0.6574
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6090 - acc: 0.6604
1000/1000 [==============================] - 23s 23ms/step - loss: 0.6092 - acc: 0.6610

Test accuracy: 70.79366721854305

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7411

choose_one :  11917

F1score :  0.7398017976492279

AUC :  0.7914012865723778

Confusion Matrix
[[5658 3892]
 [1753 8025]]
True label 0
0.5924607329842932  
0.4075392670157068  
True label 1
0.17928001636326446  
0.8207199836367355  

Train_result {'acc': [0.6610000004768372], 'loss': [0.6092396140098572]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 25s - loss: 0.5690 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 22s - loss: 0.5394 - acc: 0.7188
 192/1000 [====>.........................] - ETA: 20s - loss: 0.5590 - acc: 0.6927
 256/1000 [======>.......................] - ETA: 18s - loss: 0.5728 - acc: 0.6914
 320/1000 [========>.....................] - ETA: 16s - loss: 0.5822 - acc: 0.6844
 384/1000 [==========>...................] - ETA: 15s - loss: 0.5768 - acc: 0.6953
 448/1000 [============>.................] - ETA: 13s - loss: 0.5768 - acc: 0.6964
 512/1000 [==============>...............] - ETA: 11s - loss: 0.5876 - acc: 0.6934
 576/1000 [================>.............] - ETA: 10s - loss: 0.5814 - acc: 0.6997
 640/1000 [==================>...........] - ETA: 8s - loss: 0.5755 - acc: 0.7063 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.5774 - acc: 0.7017
 768/1000 [======================>.......] - ETA: 5s - loss: 0.5750 - acc: 0.7044
 832/1000 [=======================>......] - ETA: 4s - loss: 0.5718 - acc: 0.7079
 896/1000 [=========================>....] - ETA: 2s - loss: 0.5769 - acc: 0.6987
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5753 - acc: 0.6990
1000/1000 [==============================] - 24s 24ms/step - loss: 0.5727 - acc: 0.6990

Test accuracy: 68.5482201986755

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14069

choose_one :  5259

F1score :  0.5957305313559885

AUC :  0.8111080757207921

Confusion Matrix
[[8770  780]
 [5299 4479]]
True label 0
0.9183246073298429  
0.08167539267015707  
True label 1
0.5419308652076089  
0.4580691347923911  

Train_result {'acc': [0.6989999995231628], 'loss': [0.572723436832428]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 26s - loss: 0.5393 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 23s - loss: 0.5293 - acc: 0.7188
 192/1000 [====>.........................] - ETA: 21s - loss: 0.5604 - acc: 0.7083
 256/1000 [======>.......................] - ETA: 18s - loss: 0.5495 - acc: 0.7227
 320/1000 [========>.....................] - ETA: 17s - loss: 0.5644 - acc: 0.7188
 384/1000 [==========>...................] - ETA: 15s - loss: 0.5535 - acc: 0.7292
 448/1000 [============>.................] - ETA: 13s - loss: 0.5793 - acc: 0.7098
 512/1000 [==============>...............] - ETA: 12s - loss: 0.5738 - acc: 0.7168
 576/1000 [================>.............] - ETA: 10s - loss: 0.5562 - acc: 0.7344
 640/1000 [==================>...........] - ETA: 8s - loss: 0.5468 - acc: 0.7375 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.5481 - acc: 0.7273
 768/1000 [======================>.......] - ETA: 5s - loss: 0.5441 - acc: 0.7331
 832/1000 [=======================>......] - ETA: 4s - loss: 0.5424 - acc: 0.7308
 896/1000 [=========================>....] - ETA: 2s - loss: 0.5342 - acc: 0.7310
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5313 - acc: 0.7333
1000/1000 [==============================] - 24s 24ms/step - loss: 0.5365 - acc: 0.7310

Test accuracy: 73.29263245033113

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11226

choose_one :  8102

F1score :  0.7112975391498881

AUC :  0.8191192911964995

Confusion Matrix
[[7807 1743]
 [3419 6359]]
True label 0
0.8174869109947644  
0.1825130890052356  
True label 1
0.34966250767028023  
0.6503374923297198  

Train_result {'acc': [0.7310000004768371], 'loss': [0.5364930524826049]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 25s - loss: 0.5270 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 23s - loss: 0.5456 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 20s - loss: 0.5310 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 18s - loss: 0.5432 - acc: 0.7188
 320/1000 [========>.....................] - ETA: 17s - loss: 0.5476 - acc: 0.7250
 384/1000 [==========>...................] - ETA: 15s - loss: 0.5414 - acc: 0.7292
 448/1000 [============>.................] - ETA: 14s - loss: 0.5393 - acc: 0.7277
 512/1000 [==============>...............] - ETA: 12s - loss: 0.5294 - acc: 0.7266
 576/1000 [================>.............] - ETA: 10s - loss: 0.5149 - acc: 0.7413
 640/1000 [==================>...........] - ETA: 9s - loss: 0.5070 - acc: 0.7438 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.4982 - acc: 0.7500
 768/1000 [======================>.......] - ETA: 5s - loss: 0.4963 - acc: 0.7526
 832/1000 [=======================>......] - ETA: 4s - loss: 0.4939 - acc: 0.7512
 896/1000 [=========================>....] - ETA: 2s - loss: 0.4960 - acc: 0.7467
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5014 - acc: 0.7427
1000/1000 [==============================] - 24s 24ms/step - loss: 0.5033 - acc: 0.7410

Test accuracy: 74.64300496688742

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10295

choose_one :  9033

F1score :  0.7394609536973047

AUC :  0.8285674486693603

Confusion Matrix
[[7472 2078]
 [2823 6955]]
True label 0
0.7824083769633507  
0.21759162303664922  
True label 1
0.2887093475148292  
0.7112906524851708  

Train_result {'acc': [0.7409999995231629], 'loss': [0.503263979434967]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 25s - loss: 0.2893 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 22s - loss: 0.3694 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 21s - loss: 0.4038 - acc: 0.7969
 256/1000 [======>.......................] - ETA: 19s - loss: 0.4283 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 17s - loss: 0.4395 - acc: 0.7781
 384/1000 [==========>...................] - ETA: 15s - loss: 0.4268 - acc: 0.7839
 448/1000 [============>.................] - ETA: 14s - loss: 0.4183 - acc: 0.7924
 512/1000 [==============>...............] - ETA: 12s - loss: 0.4364 - acc: 0.7812
 576/1000 [================>.............] - ETA: 10s - loss: 0.4467 - acc: 0.7760
 640/1000 [==================>...........] - ETA: 9s - loss: 0.4437 - acc: 0.7812 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.4481 - acc: 0.7798
 768/1000 [======================>.......] - ETA: 5s - loss: 0.4467 - acc: 0.7812
 832/1000 [=======================>......] - ETA: 4s - loss: 0.4450 - acc: 0.7837
 896/1000 [=========================>....] - ETA: 2s - loss: 0.4417 - acc: 0.7868
 960/1000 [===========================>..] - ETA: 1s - loss: 0.4381 - acc: 0.7906
1000/1000 [==============================] - 25s 25ms/step - loss: 0.4434 - acc: 0.7890

Test accuracy: 74.58091887417218

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  11889

choose_one :  7439

F1score :  0.7146425045013649

AUC :  0.8356004664815446

Confusion Matrix
[[8263 1287]
 [3626 6152]]
True label 0
0.8652356020942409  
0.13476439790575917  
True label 1
0.37083248107997546  
0.6291675189200245  

Train_result {'acc': [0.789], 'loss': [0.44343314838409426]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 24s - loss: 0.4749 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 24s - loss: 0.4324 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 22s - loss: 0.3974 - acc: 0.8177
 256/1000 [======>.......................] - ETA: 21s - loss: 0.4096 - acc: 0.8047
 320/1000 [========>.....................] - ETA: 19s - loss: 0.3990 - acc: 0.8063
 384/1000 [==========>...................] - ETA: 16s - loss: 0.4046 - acc: 0.8099
 448/1000 [============>.................] - ETA: 15s - loss: 0.3953 - acc: 0.8170
 512/1000 [==============>...............] - ETA: 13s - loss: 0.4005 - acc: 0.8145
 576/1000 [================>.............] - ETA: 11s - loss: 0.3925 - acc: 0.8212
 640/1000 [==================>...........] - ETA: 10s - loss: 0.3871 - acc: 0.8219
 704/1000 [====================>.........] - ETA: 8s - loss: 0.3963 - acc: 0.8182 
 768/1000 [======================>.......] - ETA: 6s - loss: 0.3979 - acc: 0.8164
 832/1000 [=======================>......] - ETA: 4s - loss: 0.3974 - acc: 0.8185
 896/1000 [=========================>....] - ETA: 2s - loss: 0.4043 - acc: 0.8125
 960/1000 [===========================>..] - ETA: 1s - loss: 0.4074 - acc: 0.8115
1000/1000 [==============================] - 28s 28ms/step - loss: 0.4059 - acc: 0.8120

Test accuracy: 74.2135761589404

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12442

choose_one :  6886

F1score :  0.700912145943351

AUC :  0.8426348818107539

Confusion Matrix
[[8504 1046]
 [3938 5840]]
True label 0
0.8904712041884817  
0.10952879581151832  
True label 1
0.4027408467989364  
0.5972591532010636  

Train_result {'acc': [0.8119999995231628], 'loss': [0.40585323810577395]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 26s - loss: 0.4465 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 27s - loss: 0.3761 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 23s - loss: 0.3910 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 22s - loss: 0.4005 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 20s - loss: 0.4060 - acc: 0.8063
 384/1000 [==========>...................] - ETA: 17s - loss: 0.4039 - acc: 0.8047
 448/1000 [============>.................] - ETA: 16s - loss: 0.3958 - acc: 0.8103
 512/1000 [==============>...............] - ETA: 13s - loss: 0.3867 - acc: 0.8203
 576/1000 [================>.............] - ETA: 12s - loss: 0.4009 - acc: 0.8160
 640/1000 [==================>...........] - ETA: 10s - loss: 0.4166 - acc: 0.8078
 704/1000 [====================>.........] - ETA: 8s - loss: 0.4144 - acc: 0.8125 
 768/1000 [======================>.......] - ETA: 6s - loss: 0.4144 - acc: 0.8164
 832/1000 [=======================>......] - ETA: 4s - loss: 0.4164 - acc: 0.8173
 896/1000 [=========================>....] - ETA: 2s - loss: 0.4134 - acc: 0.8181
 960/1000 [===========================>..] - ETA: 1s - loss: 0.4212 - acc: 0.8156
1000/1000 [==============================] - 28s 28ms/step - loss: 0.4145 - acc: 0.8210

Test accuracy: 75.97268211920529

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10998

choose_one :  8330

F1score :  0.7435387673956263

AUC :  0.8448076084896214

Confusion Matrix
[[7952 1598]
 [3046 6732]]
True label 0
0.8326701570680628  
0.16732984293193717  
True label 1
0.31151564737165066  
0.6884843526283494  

Train_result {'acc': [0.8209999995231628], 'loss': [0.4145035994052887]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 26s - loss: 0.2649 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 24s - loss: 0.3209 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 21s - loss: 0.3367 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 19s - loss: 0.3321 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 17s - loss: 0.3155 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 16s - loss: 0.3392 - acc: 0.8516
 448/1000 [============>.................] - ETA: 14s - loss: 0.3248 - acc: 0.8571
 512/1000 [==============>...............] - ETA: 12s - loss: 0.3355 - acc: 0.8574
 576/1000 [================>.............] - ETA: 10s - loss: 0.3416 - acc: 0.8524
 640/1000 [==================>...........] - ETA: 8s - loss: 0.3257 - acc: 0.8594 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.3307 - acc: 0.8565
 768/1000 [======================>.......] - ETA: 5s - loss: 0.3319 - acc: 0.8568
 832/1000 [=======================>......] - ETA: 4s - loss: 0.3279 - acc: 0.8594
 896/1000 [=========================>....] - ETA: 2s - loss: 0.3355 - acc: 0.8549
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3346 - acc: 0.8542
1000/1000 [==============================] - 25s 25ms/step - loss: 0.3277 - acc: 0.8580

Test accuracy: 76.06063741721854

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9263

choose_one :  10065

F1score :  0.7668195333366932

AUC :  0.8480495749085188

Confusion Matrix
[[7093 2457]
 [2170 7608]]
True label 0
0.7427225130890053  
0.2572774869109948  
True label 1
0.2219267743914911  
0.7780732256085089  

Train_result {'acc': [0.8579999995231629], 'loss': [0.32772497379779814]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 25s - loss: 0.2118 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 23s - loss: 0.2866 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 21s - loss: 0.2561 - acc: 0.9010
 256/1000 [======>.......................] - ETA: 18s - loss: 0.2501 - acc: 0.9023
 320/1000 [========>.....................] - ETA: 17s - loss: 0.2566 - acc: 0.8969
 384/1000 [==========>...................] - ETA: 15s - loss: 0.2659 - acc: 0.8828
 448/1000 [============>.................] - ETA: 13s - loss: 0.2779 - acc: 0.8750
 512/1000 [==============>...............] - ETA: 12s - loss: 0.2874 - acc: 0.8730
 576/1000 [================>.............] - ETA: 10s - loss: 0.2759 - acc: 0.8802
 640/1000 [==================>...........] - ETA: 8s - loss: 0.2926 - acc: 0.8734 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.2869 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 5s - loss: 0.2955 - acc: 0.8672
 832/1000 [=======================>......] - ETA: 4s - loss: 0.2972 - acc: 0.8666
 896/1000 [=========================>....] - ETA: 2s - loss: 0.3108 - acc: 0.8583
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3078 - acc: 0.8583
1000/1000 [==============================] - 24s 24ms/step - loss: 0.3108 - acc: 0.8580

Test accuracy: 74.60161423841059

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12045

choose_one :  7283

F1score :  0.7122677451497568

AUC :  0.8395685152800549

Confusion Matrix
[[8343 1207]
 [3702 6076]]
True label 0
0.8736125654450262  
0.1263874345549738  
True label 1
0.3786050317038249  
0.6213949682961751  

Train_result {'acc': [0.8580000009536743], 'loss': [0.31084277606010435]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 24s - loss: 0.3999 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 22s - loss: 0.3451 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 20s - loss: 0.3356 - acc: 0.8698
 256/1000 [======>.......................] - ETA: 18s - loss: 0.3651 - acc: 0.8438
 320/1000 [========>.....................] - ETA: 16s - loss: 0.3342 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 15s - loss: 0.3268 - acc: 0.8646
 448/1000 [============>.................] - ETA: 13s - loss: 0.3168 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 11s - loss: 0.3080 - acc: 0.8691
 576/1000 [================>.............] - ETA: 10s - loss: 0.3087 - acc: 0.8646
 640/1000 [==================>...........] - ETA: 8s - loss: 0.3085 - acc: 0.8672 
 704/1000 [====================>.........] - ETA: 6s - loss: 0.2950 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 5s - loss: 0.2965 - acc: 0.8737
 832/1000 [=======================>......] - ETA: 3s - loss: 0.2871 - acc: 0.8762
 896/1000 [=========================>....] - ETA: 2s - loss: 0.2937 - acc: 0.8694
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2988 - acc: 0.8667
1000/1000 [==============================] - 24s 24ms/step - loss: 0.3031 - acc: 0.8650

Test accuracy: 75.50186258278146

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7863

choose_one :  11465

F1score :  0.7771030457091749

AUC :  0.852909603672739

Confusion Matrix
[[6339 3211]
 [1524 8254]]
True label 0
0.6637696335078535  
0.3362303664921466  
True label 1
0.15586009408877072  
0.8441399059112293  

Train_result {'acc': [0.8649999995231629], 'loss': [0.3030704607963562]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 24s - loss: 0.2365 - acc: 0.9062
 128/1000 [==>...........................] - ETA: 22s - loss: 0.3985 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 21s - loss: 0.3833 - acc: 0.8229
 256/1000 [======>.......................] - ETA: 19s - loss: 0.3725 - acc: 0.8242
 320/1000 [========>.....................] - ETA: 17s - loss: 0.3731 - acc: 0.8281
 384/1000 [==========>...................] - ETA: 15s - loss: 0.3641 - acc: 0.8385
 448/1000 [============>.................] - ETA: 13s - loss: 0.3546 - acc: 0.8393
 512/1000 [==============>...............] - ETA: 11s - loss: 0.3597 - acc: 0.8359
 576/1000 [================>.............] - ETA: 10s - loss: 0.3562 - acc: 0.8455
 640/1000 [==================>...........] - ETA: 8s - loss: 0.3443 - acc: 0.8578 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.3424 - acc: 0.8608
 768/1000 [======================>.......] - ETA: 5s - loss: 0.3353 - acc: 0.8646
 832/1000 [=======================>......] - ETA: 3s - loss: 0.3453 - acc: 0.8594
 896/1000 [=========================>....] - ETA: 2s - loss: 0.3445 - acc: 0.8616
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3369 - acc: 0.8625
1000/1000 [==============================] - 23s 23ms/step - loss: 0.3388 - acc: 0.8630

Test accuracy: 76.04511589403974

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10808

choose_one :  8520

F1score :  0.7469668816264073

AUC :  0.846085469142717

Confusion Matrix
[[7864 1686]
 [2944 6834]]
True label 0
0.8234554973821989  
0.17654450261780105  
True label 1
0.3010840662712211  
0.6989159337287789  

Train_result {'acc': [0.863], 'loss': [0.33875217485427855]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 26s - loss: 0.1954 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 22s - loss: 0.2670 - acc: 0.8906
 192/1000 [====>.........................] - ETA: 20s - loss: 0.2721 - acc: 0.8802
 256/1000 [======>.......................] - ETA: 19s - loss: 0.2499 - acc: 0.8828
 320/1000 [========>.....................] - ETA: 16s - loss: 0.2663 - acc: 0.8844
 384/1000 [==========>...................] - ETA: 14s - loss: 0.2553 - acc: 0.8854
 448/1000 [============>.................] - ETA: 13s - loss: 0.2513 - acc: 0.8862
 512/1000 [==============>...............] - ETA: 11s - loss: 0.2424 - acc: 0.8906
 576/1000 [================>.............] - ETA: 9s - loss: 0.2430 - acc: 0.8924 
 640/1000 [==================>...........] - ETA: 8s - loss: 0.2502 - acc: 0.8891
 704/1000 [====================>.........] - ETA: 6s - loss: 0.2594 - acc: 0.8878
 768/1000 [======================>.......] - ETA: 5s - loss: 0.2526 - acc: 0.8919
 832/1000 [=======================>......] - ETA: 3s - loss: 0.2468 - acc: 0.8930
 896/1000 [=========================>....] - ETA: 2s - loss: 0.2444 - acc: 0.8962
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2437 - acc: 0.8969
1000/1000 [==============================] - 23s 23ms/step - loss: 0.2503 - acc: 0.8930

Test accuracy: 76.83671357615894

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10339

choose_one :  8989

F1score :  0.761442958384398

AUC :  0.8479273109095212

Confusion Matrix
[[7706 1844]
 [2633 7145]]
True label 0
0.8069109947643979  
0.1930890052356021  
True label 1
0.26927797095520556  
0.7307220290447944  

Train_result {'acc': [0.8930000004768371], 'loss': [0.2503385100364685]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 27s - loss: 0.3559 - acc: 0.8594
 128/1000 [==>...........................] - ETA: 23s - loss: 0.2581 - acc: 0.8984
 192/1000 [====>.........................] - ETA: 20s - loss: 0.2281 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 18s - loss: 0.2133 - acc: 0.9102
 320/1000 [========>.....................] - ETA: 16s - loss: 0.2161 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 14s - loss: 0.2186 - acc: 0.9010
 448/1000 [============>.................] - ETA: 12s - loss: 0.2203 - acc: 0.9062
 512/1000 [==============>...............] - ETA: 11s - loss: 0.2170 - acc: 0.9043
 576/1000 [================>.............] - ETA: 9s - loss: 0.2204 - acc: 0.9080 
 640/1000 [==================>...........] - ETA: 8s - loss: 0.2219 - acc: 0.9016
 704/1000 [====================>.........] - ETA: 6s - loss: 0.2112 - acc: 0.9077
 768/1000 [======================>.......] - ETA: 5s - loss: 0.2094 - acc: 0.9115
 832/1000 [=======================>......] - ETA: 3s - loss: 0.2258 - acc: 0.9062
 896/1000 [=========================>....] - ETA: 2s - loss: 0.2210 - acc: 0.9085
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2183 - acc: 0.9104
1000/1000 [==============================] - 23s 23ms/step - loss: 0.2227 - acc: 0.9080

Test accuracy: 76.81601821192054

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  9073

choose_one :  10255

F1score :  0.7763190735286777

AUC :  0.8520029685189211

Confusion Matrix
[[7071 2479]
 [2002 7776]]
True label 0
0.7404188481675392  
0.2595811518324607  
True label 1
0.204745346696666  
0.795254653303334  

Train_result {'acc': [0.9080000009536743], 'loss': [0.2226844334602356]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 28s - loss: 0.1269 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 23s - loss: 0.1463 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 21s - loss: 0.1945 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 19s - loss: 0.2033 - acc: 0.9258
 320/1000 [========>.....................] - ETA: 17s - loss: 0.1784 - acc: 0.9406
 384/1000 [==========>...................] - ETA: 15s - loss: 0.1858 - acc: 0.9401
 448/1000 [============>.................] - ETA: 13s - loss: 0.1769 - acc: 0.9442
 512/1000 [==============>...............] - ETA: 12s - loss: 0.1769 - acc: 0.9434
 576/1000 [================>.............] - ETA: 10s - loss: 0.1847 - acc: 0.9410
 640/1000 [==================>...........] - ETA: 8s - loss: 0.1818 - acc: 0.9422 
 704/1000 [====================>.........] - ETA: 7s - loss: 0.1859 - acc: 0.9375
 768/1000 [======================>.......] - ETA: 5s - loss: 0.1944 - acc: 0.9323
 832/1000 [=======================>......] - ETA: 4s - loss: 0.1862 - acc: 0.9351
 896/1000 [=========================>....] - ETA: 2s - loss: 0.1832 - acc: 0.9364
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1838 - acc: 0.9375
1000/1000 [==============================] - 24s 24ms/step - loss: 0.1851 - acc: 0.9350

Test accuracy: 76.5521523178808

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10880

choose_one :  8448

F1score :  0.7513442335125644

AUC :  0.8481934923896899

Confusion Matrix
[[7949 1601]
 [2931 6847]]
True label 0
0.8323560209424083  
0.16764397905759162  
True label 1
0.2997545510329311  
0.700245448967069  

Train_result {'acc': [0.935], 'loss': [0.1850666617155075]}
Saved model to disk


[[67.35306291390728, 1], [70.79366721854305, 2], [68.5482201986755, 3], [73.29263245033113, 4], [74.64300496688742, 5], [74.58091887417218, 6], [74.2135761589404, 7], [75.97268211920529, 8], [76.06063741721854, 9], [74.60161423841059, 10], [75.50186258278146, 11], [76.04511589403974, 12], [76.83671357615894, 13], [76.81601821192054, 14], [76.5521523178808, 15]]
max accuracy :  [76.83671357615894, 13]

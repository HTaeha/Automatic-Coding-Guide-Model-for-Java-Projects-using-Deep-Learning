Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:139: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 21:58:05.442444: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 21:58:05.454086: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 21:58:05.456163: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xcfb83e0 executing computations on platform Host. Devices:
2019-10-14 21:58:05.456202: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

Third data
zero :  9884
one :  9718

4th data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

198
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
guava-CAST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-CAST

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

401
guava-depth_num
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-depth_num

Sentence length Average : 27

Under 10 : 6119
Over 10, Under 30 : 7122
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 198, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 198, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 401, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 401, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 193, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          196992      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            514         dense_3[0][0]                    
==================================================================================================
Total params: 1,068,674
Trainable params: 1,068,674
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:52 - loss: 0.7069 - acc: 0.4531
 128/1000 [==>...........................] - ETA: 57s - loss: 0.7020 - acc: 0.4766 
 192/1000 [====>.........................] - ETA: 37s - loss: 0.7059 - acc: 0.5000
 256/1000 [======>.......................] - ETA: 28s - loss: 0.6982 - acc: 0.5195
 320/1000 [========>.....................] - ETA: 21s - loss: 0.7080 - acc: 0.5031
 384/1000 [==========>...................] - ETA: 17s - loss: 0.6973 - acc: 0.5260
 448/1000 [============>.................] - ETA: 14s - loss: 0.6891 - acc: 0.5402
 512/1000 [==============>...............] - ETA: 11s - loss: 0.6827 - acc: 0.5527
 576/1000 [================>.............] - ETA: 9s - loss: 0.6737 - acc: 0.5642 
 640/1000 [==================>...........] - ETA: 7s - loss: 0.6700 - acc: 0.5641
 704/1000 [====================>.........] - ETA: 5s - loss: 0.6588 - acc: 0.5810
 768/1000 [======================>.......] - ETA: 4s - loss: 0.6494 - acc: 0.5924
 832/1000 [=======================>......] - ETA: 3s - loss: 0.6377 - acc: 0.6046
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6322 - acc: 0.6172
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6313 - acc: 0.6219
1000/1000 [==============================] - 17s 17ms/step - loss: 0.6318 - acc: 0.6230

Test accuracy: 73.37383077088485

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7356

choose_one :  11246

F1score :  0.7577876668785759

AUC :  0.8430089715375544

Confusion Matrix
[[5901 3498]
 [1455 7748]]
True label 0
0.6278327481646984  
0.37216725183530164  
True label 1
0.15810061936325112  
0.8418993806367489  

Train_result {'acc': [0.6229999990463256], 'loss': [0.6318165616989135]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4530 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 9s - loss: 0.4645 - acc: 0.7812 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4863 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4787 - acc: 0.7852
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4696 - acc: 0.7937
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4912 - acc: 0.7682
 448/1000 [============>.................] - ETA: 5s - loss: 0.5056 - acc: 0.7612
 512/1000 [==============>...............] - ETA: 4s - loss: 0.5092 - acc: 0.7617
 576/1000 [================>.............] - ETA: 4s - loss: 0.5068 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 3s - loss: 0.5036 - acc: 0.7625
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5039 - acc: 0.7628
 768/1000 [======================>.......] - ETA: 2s - loss: 0.5169 - acc: 0.7591
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5152 - acc: 0.7572
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5160 - acc: 0.7522
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5170 - acc: 0.7531
1000/1000 [==============================] - 10s 10ms/step - loss: 0.5161 - acc: 0.7550

Test accuracy: 78.52919040963337

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8297

choose_one :  10305

F1score :  0.7952634816485545

AUC :  0.8741361995214812

Confusion Matrix
[[6851 2548]
 [1446 7757]]
True label 0
0.7289073305670816  
0.2710926694329184  
True label 1
0.15712267738780833  
0.8428773226121917  

Train_result {'acc': [0.7550000004768371], 'loss': [0.5160813481807709]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.4076 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 9s - loss: 0.4282 - acc: 0.8203 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4036 - acc: 0.8177
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4337 - acc: 0.7930
 320/1000 [========>.....................] - ETA: 7s - loss: 0.4391 - acc: 0.8000
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4438 - acc: 0.7995
 448/1000 [============>.................] - ETA: 5s - loss: 0.4519 - acc: 0.7902
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4432 - acc: 0.7988
 576/1000 [================>.............] - ETA: 4s - loss: 0.4382 - acc: 0.8056
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4338 - acc: 0.8047
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4314 - acc: 0.8054
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4392 - acc: 0.7982
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4379 - acc: 0.7945
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4435 - acc: 0.7879
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4477 - acc: 0.7854
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4486 - acc: 0.7860

Test accuracy: 71.31491237501344

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  4991

choose_one :  13611

F1score :  0.766108529850092

AUC :  0.8888836017370237

Confusion Matrix
[[4527 4872]
 [ 464 8739]]
True label 0
0.48164698372167253  
0.5183530162783275  
True label 1
0.05041834184505053  
0.9495816581549494  

Train_result {'acc': [0.7860000004768372], 'loss': [0.448636390209198]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 11s - loss: 0.4889 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 9s - loss: 0.5072 - acc: 0.7500 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4667 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4848 - acc: 0.7656
 320/1000 [========>.....................] - ETA: 7s - loss: 0.4815 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4824 - acc: 0.7656
 448/1000 [============>.................] - ETA: 5s - loss: 0.4733 - acc: 0.7701
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4629 - acc: 0.7715
 576/1000 [================>.............] - ETA: 4s - loss: 0.4566 - acc: 0.7778
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4556 - acc: 0.7750
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4450 - acc: 0.7798
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4449 - acc: 0.7812
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4388 - acc: 0.7837
 896/1000 [=========================>....] - ETA: 1s - loss: 0.4432 - acc: 0.7812
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4372 - acc: 0.7854
1000/1000 [==============================] - 10s 10ms/step - loss: 0.4395 - acc: 0.7850

Test accuracy: 79.01300935383291

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7309

choose_one :  11293

F1score :  0.8095238095238096

AUC :  0.8959381112823771

Confusion Matrix
[[6402 2997]
 [ 907 8296]]
True label 0
0.6811362910947973  
0.31886370890520266  
True label 1
0.09855481908073455  
0.9014451809192655  

Train_result {'acc': [0.7849999990463257], 'loss': [0.4394725034236908]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.5279 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 9s - loss: 0.4353 - acc: 0.8203 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.4435 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 7s - loss: 0.4378 - acc: 0.8086
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4332 - acc: 0.8031
 384/1000 [==========>...................] - ETA: 6s - loss: 0.4316 - acc: 0.7943
 448/1000 [============>.................] - ETA: 5s - loss: 0.4196 - acc: 0.7991
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4106 - acc: 0.8066
 576/1000 [================>.............] - ETA: 4s - loss: 0.4108 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4024 - acc: 0.8125
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3944 - acc: 0.8153
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3959 - acc: 0.8151
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3920 - acc: 0.8209
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3929 - acc: 0.8181
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3898 - acc: 0.8198
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3894 - acc: 0.8200

Test accuracy: 82.88356090742931

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9275

choose_one :  9327

F1score :  0.8281705342687534

AUC :  0.9063162547422371

Confusion Matrix
[[7745 1654]
 [1530 7673]]
True label 0
0.8240238323225875  
0.1759761676774125  
True label 1
0.16625013582527437  
0.8337498641747256  

Train_result {'acc': [0.8199999995231628], 'loss': [0.38940616011619567]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.3650 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 9s - loss: 0.3505 - acc: 0.8828 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.3876 - acc: 0.8385
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3334 - acc: 0.8711
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3134 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 6s - loss: 0.3138 - acc: 0.8750
 448/1000 [============>.................] - ETA: 5s - loss: 0.2978 - acc: 0.8839
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3197 - acc: 0.8730
 576/1000 [================>.............] - ETA: 4s - loss: 0.3164 - acc: 0.8750
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3182 - acc: 0.8766
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3102 - acc: 0.8778
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3169 - acc: 0.8737
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3235 - acc: 0.8702
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3243 - acc: 0.8694
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3291 - acc: 0.8646
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3272 - acc: 0.8650

Test accuracy: 80.57735727341147

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  11820

choose_one :  6782

F1score :  0.773975602126994

AUC :  0.9074344468988467

Confusion Matrix
[[8803  596]
 [3017 6186]]
True label 0
0.9365889988296627  
0.06341100117033727  
True label 1
0.32782788221232206  
0.6721721177876779  

Train_result {'acc': [0.865], 'loss': [0.3272400662899017]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.3959 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 9s - loss: 0.3425 - acc: 0.8438 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.3660 - acc: 0.8281
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3636 - acc: 0.8320
 320/1000 [========>.....................] - ETA: 7s - loss: 0.3576 - acc: 0.8344
 384/1000 [==========>...................] - ETA: 6s - loss: 0.3659 - acc: 0.8333
 448/1000 [============>.................] - ETA: 5s - loss: 0.3533 - acc: 0.8438
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3555 - acc: 0.8418
 576/1000 [================>.............] - ETA: 4s - loss: 0.3602 - acc: 0.8385
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3587 - acc: 0.8453
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3510 - acc: 0.8466
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3491 - acc: 0.8503
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3402 - acc: 0.8546
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3339 - acc: 0.8583
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3263 - acc: 0.8615
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3215 - acc: 0.8650

Test accuracy: 82.47500268788302

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8619

choose_one :  9983

F1score :  0.8300844365683311

AUC :  0.9116520680580841

Confusion Matrix
[[7379 2020]
 [1240 7963]]
True label 0
0.7850835195233535  
0.21491648047664647  
True label 1
0.1347386721721178  
0.8652613278278822  

Train_result {'acc': [0.8649999995231629], 'loss': [0.32151902115345]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2130 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2603 - acc: 0.8906 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2827 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2868 - acc: 0.8828
 320/1000 [========>.....................] - ETA: 7s - loss: 0.3035 - acc: 0.8781
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2876 - acc: 0.8880
 448/1000 [============>.................] - ETA: 5s - loss: 0.2899 - acc: 0.8839
 512/1000 [==============>...............] - ETA: 5s - loss: 0.3003 - acc: 0.8770
 576/1000 [================>.............] - ETA: 4s - loss: 0.3031 - acc: 0.8733
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3103 - acc: 0.8672
 704/1000 [====================>.........] - ETA: 3s - loss: 0.3033 - acc: 0.8736
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3016 - acc: 0.8737
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3137 - acc: 0.8642
 896/1000 [=========================>....] - ETA: 1s - loss: 0.3194 - acc: 0.8594
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3199 - acc: 0.8573
1000/1000 [==============================] - 10s 10ms/step - loss: 0.3192 - acc: 0.8580

Test accuracy: 83.38350714976885

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9610

choose_one :  8992

F1score :  0.8301181643308602

AUC :  0.9150490438634797

Confusion Matrix
[[7959 1440]
 [1651 7552]]
True label 0
0.8467922119374401  
0.15320778806255986  
True label 1
0.1793980223840052  
0.8206019776159947  

Train_result {'acc': [0.858], 'loss': [0.3192065360546112]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2767 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2633 - acc: 0.8672 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2369 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2827 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 7s - loss: 0.2692 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2766 - acc: 0.8646
 448/1000 [============>.................] - ETA: 5s - loss: 0.2792 - acc: 0.8638
 512/1000 [==============>...............] - ETA: 5s - loss: 0.2651 - acc: 0.8750
 576/1000 [================>.............] - ETA: 4s - loss: 0.2693 - acc: 0.8715
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2718 - acc: 0.8734
 704/1000 [====================>.........] - ETA: 3s - loss: 0.2712 - acc: 0.8722
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2765 - acc: 0.8698
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2721 - acc: 0.8714
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2768 - acc: 0.8683
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2903 - acc: 0.8625
1000/1000 [==============================] - 11s 11ms/step - loss: 0.2910 - acc: 0.8600

Test accuracy: 83.44264057628212

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8723

choose_one :  9879

F1score :  0.8385913426265591

AUC :  0.9158487178758847

Confusion Matrix
[[7521 1878]
 [1202 8001]]
True label 0
0.8001915097350782  
0.1998084902649218  
True label 1
0.13060958383135934  
0.8693904161686407  

Train_result {'acc': [0.8600000004768371], 'loss': [0.29100964331626894]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2561 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2702 - acc: 0.8906 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2505 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 7s - loss: 0.2472 - acc: 0.9141
 320/1000 [========>.....................] - ETA: 7s - loss: 0.2504 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2485 - acc: 0.9115
 448/1000 [============>.................] - ETA: 5s - loss: 0.2492 - acc: 0.9085
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2576 - acc: 0.9004
 576/1000 [================>.............] - ETA: 4s - loss: 0.2559 - acc: 0.8976
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2544 - acc: 0.8953
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2591 - acc: 0.8892
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2504 - acc: 0.8932
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2474 - acc: 0.8942
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2548 - acc: 0.8940
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2749 - acc: 0.8906
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2742 - acc: 0.8900

Test accuracy: 83.96946564885496

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10187

choose_one :  8415

F1score :  0.8307412873197866

AUC :  0.9202943069964151

Confusion Matrix
[[8302 1097]
 [1885 7318]]
True label 0
0.8832854558995638  
0.11671454410043622  
True label 1
0.20482451374551777  
0.7951754862544822  

Train_result {'acc': [0.89], 'loss': [0.27424219298362734]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2042 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2267 - acc: 0.9062 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2538 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 7s - loss: 0.3024 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 7s - loss: 0.2896 - acc: 0.8750
 384/1000 [==========>...................] - ETA: 6s - loss: 0.2710 - acc: 0.8880
 448/1000 [============>.................] - ETA: 5s - loss: 0.2596 - acc: 0.8951
 512/1000 [==============>...............] - ETA: 5s - loss: 0.2610 - acc: 0.8945
 576/1000 [================>.............] - ETA: 4s - loss: 0.2525 - acc: 0.8993
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2531 - acc: 0.8984
 704/1000 [====================>.........] - ETA: 3s - loss: 0.2483 - acc: 0.9020
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2438 - acc: 0.9036
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2392 - acc: 0.9050
 896/1000 [=========================>....] - ETA: 1s - loss: 0.2330 - acc: 0.9074
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2343 - acc: 0.9042
1000/1000 [==============================] - 10s 10ms/step - loss: 0.2411 - acc: 0.9000

Test accuracy: 84.4532845930545

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9979

choose_one :  8623

F1score :  0.8377650622685965

AUC :  0.9208930827255719

Confusion Matrix
[[8243 1156]
 [1736 7467]]
True label 0
0.8770081923608894  
0.12299180763911054  
True label 1
0.1886341410409649  
0.8113658589590351  

Train_result {'acc': [0.9000000004768371], 'loss': [0.24113726449012757]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2223 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1697 - acc: 0.9453 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1833 - acc: 0.9271
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1920 - acc: 0.9336
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1878 - acc: 0.9281
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1799 - acc: 0.9323
 448/1000 [============>.................] - ETA: 5s - loss: 0.2110 - acc: 0.9129
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2127 - acc: 0.9141
 576/1000 [================>.............] - ETA: 4s - loss: 0.2118 - acc: 0.9115
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1980 - acc: 0.9187
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1995 - acc: 0.9190
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1986 - acc: 0.9193
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1954 - acc: 0.9183
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1889 - acc: 0.9208
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1854 - acc: 0.9219
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1884 - acc: 0.9220

Test accuracy: 83.78668960326846

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8803

choose_one :  9799

F1score :  0.8412798652773392

AUC :  0.9212427168375144

Confusion Matrix
[[7593 1806]
 [1210 7993]]
True label 0
0.8078518991382062  
0.19214810086179382  
True label 1
0.13147886558730848  
0.8685211344126915  

Train_result {'acc': [0.9220000004768372], 'loss': [0.18841000413894654]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.2842 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 9s - loss: 0.2420 - acc: 0.8906 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.2013 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1698 - acc: 0.9297
 320/1000 [========>.....................] - ETA: 7s - loss: 0.1916 - acc: 0.9219
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1850 - acc: 0.9219
 448/1000 [============>.................] - ETA: 5s - loss: 0.1817 - acc: 0.9196
 512/1000 [==============>...............] - ETA: 5s - loss: 0.2003 - acc: 0.9160
 576/1000 [================>.............] - ETA: 4s - loss: 0.1945 - acc: 0.9149
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1963 - acc: 0.9125
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1981 - acc: 0.9105
 768/1000 [======================>.......] - ETA: 2s - loss: 0.2014 - acc: 0.9102
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1944 - acc: 0.9147
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1858 - acc: 0.9196
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1843 - acc: 0.9208
1000/1000 [==============================] - 11s 11ms/step - loss: 0.1862 - acc: 0.9200

Test accuracy: 84.99086119772068

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9927

choose_one :  8675

F1score :  0.843830406085692

AUC :  0.9249445574496084

Confusion Matrix
[[8267 1132]
 [1660 7543]]
True label 0
0.8795616554952654  
0.12043834450473455  
True label 1
0.180375964359448  
0.819624035640552  

Train_result {'acc': [0.9199999990463257], 'loss': [0.1862192108631134]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1304 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1622 - acc: 0.9375 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1499 - acc: 0.9375
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1483 - acc: 0.9336
 320/1000 [========>.....................] - ETA: 7s - loss: 0.1326 - acc: 0.9437
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1339 - acc: 0.9453
 448/1000 [============>.................] - ETA: 5s - loss: 0.1453 - acc: 0.9442
 512/1000 [==============>...............] - ETA: 5s - loss: 0.1418 - acc: 0.9453
 576/1000 [================>.............] - ETA: 4s - loss: 0.1403 - acc: 0.9462
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1317 - acc: 0.9500
 704/1000 [====================>.........] - ETA: 3s - loss: 0.1250 - acc: 0.9531
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1305 - acc: 0.9518
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1383 - acc: 0.9519
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1416 - acc: 0.9498
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1405 - acc: 0.9510
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1415 - acc: 0.9490

Test accuracy: 85.32953445866036

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9342

choose_one :  9260

F1score :  0.8521908682229324

AUC :  0.9271843001832727

Confusion Matrix
[[8006 1393]
 [1336 7867]]
True label 0
0.8517927439089265  
0.14820725609107352  
True label 1
0.14517005324350754  
0.8548299467564925  

Train_result {'acc': [0.9489999990463257], 'loss': [0.1415228568315506]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 10s - loss: 0.1374 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 9s - loss: 0.1487 - acc: 0.9375 
 192/1000 [====>.........................] - ETA: 8s - loss: 0.1388 - acc: 0.9427
 256/1000 [======>.......................] - ETA: 7s - loss: 0.1441 - acc: 0.9375
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1502 - acc: 0.9375
 384/1000 [==========>...................] - ETA: 6s - loss: 0.1507 - acc: 0.9375
 448/1000 [============>.................] - ETA: 5s - loss: 0.1387 - acc: 0.9464
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1296 - acc: 0.9512
 576/1000 [================>.............] - ETA: 4s - loss: 0.1328 - acc: 0.9497
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1434 - acc: 0.9422
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1427 - acc: 0.9432
 768/1000 [======================>.......] - ETA: 2s - loss: 0.1442 - acc: 0.9414
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1488 - acc: 0.9387
 896/1000 [=========================>....] - ETA: 1s - loss: 0.1515 - acc: 0.9364
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1546 - acc: 0.9333
1000/1000 [==============================] - 10s 10ms/step - loss: 0.1535 - acc: 0.9330

Test accuracy: 84.5823029781744

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10401

choose_one :  8201

F1score :  0.835210296483567

AUC :  0.9218920365053482

Confusion Matrix
[[8466  933]
 [1935 7268]]
True label 0
0.9007341206511331  
0.0992658793488669  
True label 1
0.21025752472019993  
0.7897424752798  

Train_result {'acc': [0.9330000004768372], 'loss': [0.15348487162590027]}
Saved model to disk


[[73.37383077088485, 1], [78.52919040963337, 2], [71.31491237501344, 3], [79.01300935383291, 4], [82.88356090742931, 5], [80.57735727341147, 6], [82.47500268788302, 7], [83.38350714976885, 8], [83.44264057628212, 9], [83.96946564885496, 10], [84.4532845930545, 11], [83.78668960326846, 12], [84.99086119772068, 13], [85.32953445866036, 14], [84.5823029781744, 15]]
max accuracy :  [85.32953445866036, 14]

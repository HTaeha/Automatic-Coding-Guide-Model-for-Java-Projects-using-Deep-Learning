Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:139: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=[<tf.Tenso...)`
  model = Model(input=[input1, input2, input3, input4], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-11 04:11:46.008184: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-11 04:11:46.067775: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-11 04:11:46.070154: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xe031610 executing computations on platform Host. Devices:
2019-10-11 04:11:46.070195: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

Second data
zero :  10049
one :  10279

Third data
zero :  10049
one :  10279

4th data
zero :  10049
one :  10279

hbase-code
After set document size of train data, the number of zero and one label data :  1472 1528
After set document size of test data, the number of zero and one label data :  8577 8751

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

After balance out data.
hbase-code

Sentence length Average : 44

Under 10 : 3104
Over 10, Under 30 : 7785
Over 30, Under 100 : 7330
Over 100, Under 150 : 1113
Over 150, Under 200 : 509
Over 200, Under 400 : 487
Over 400 : 0

300
hbase-AST
After set document size of train data, the number of zero and one label data :  1472 1528
After set document size of test data, the number of zero and one label data :  8577 8751
After balance out data.
hbase-AST

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
hbase-CAST
After set document size of train data, the number of zero and one label data :  1472 1528
After set document size of test data, the number of zero and one label data :  8577 8751
After balance out data.
hbase-CAST

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

697
hbase-depth_num
After set document size of train data, the number of zero and one label data :  1472 1528
After set document size of test data, the number of zero and one label data :  8577 8751
After balance out data.
hbase-depth_num

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 300, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 300, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 621, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 697, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 697, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
masking_4 (Masking)             (None, 621, 200)     0           input_4[0][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
forwards_4 (LSTM)               (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
backwards_4 (LSTM)              (None, 64)           67840       masking_4[0][0]                  
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
after_dp_forward_4 (Dropout)    (None, 64)           0           forwards_4[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_4 (Dropout)   (None, 64)           0           backwards_4[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 128)          0           after_dp_forward_4[0][0]         
                                                                 after_dp_backward_4[0][0]        
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 384)          0           concatenate_5[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
after_dp_4 (Dropout)            (None, 128)          0           concatenate_4[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 512)          0           concatenate_6[0][0]              
                                                                 after_dp_4[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 384)          196992      concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          197120      dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          131328      dense_2[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            514         dense_3[0][0]                    
==================================================================================================
Total params: 1,068,674
Trainable params: 1,068,674
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/3000 [..............................] - ETA: 7:33 - loss: 0.6982 - acc: 0.4844
 128/3000 [>.............................] - ETA: 4:50 - loss: 0.7019 - acc: 0.5000
 192/3000 [>.............................] - ETA: 3:33 - loss: 0.7458 - acc: 0.5052
 256/3000 [=>............................] - ETA: 2:53 - loss: 0.7249 - acc: 0.5391
 320/3000 [==>...........................] - ETA: 2:31 - loss: 0.7170 - acc: 0.5469
 384/3000 [==>...........................] - ETA: 2:14 - loss: 0.7101 - acc: 0.5469
 448/3000 [===>..........................] - ETA: 2:02 - loss: 0.6939 - acc: 0.5670
 512/3000 [====>.........................] - ETA: 1:51 - loss: 0.6841 - acc: 0.5781
 576/3000 [====>.........................] - ETA: 1:44 - loss: 0.6877 - acc: 0.5729
 640/3000 [=====>........................] - ETA: 1:37 - loss: 0.6862 - acc: 0.5703
 704/3000 [======>.......................] - ETA: 1:31 - loss: 0.6765 - acc: 0.5810
 768/3000 [======>.......................] - ETA: 1:26 - loss: 0.6811 - acc: 0.5820
 832/3000 [=======>......................] - ETA: 1:22 - loss: 0.6744 - acc: 0.5925
 896/3000 [=======>......................] - ETA: 1:18 - loss: 0.6723 - acc: 0.5949
 960/3000 [========>.....................] - ETA: 1:14 - loss: 0.6698 - acc: 0.5969
1024/3000 [=========>....................] - ETA: 1:10 - loss: 0.6690 - acc: 0.5967
1088/3000 [=========>....................] - ETA: 1:07 - loss: 0.6642 - acc: 0.6002
1152/3000 [==========>...................] - ETA: 1:03 - loss: 0.6594 - acc: 0.6050
1216/3000 [===========>..................] - ETA: 1:00 - loss: 0.6569 - acc: 0.6069
1280/3000 [===========>..................] - ETA: 57s - loss: 0.6566 - acc: 0.6062 
1344/3000 [============>.................] - ETA: 54s - loss: 0.6544 - acc: 0.6124
1408/3000 [=============>................] - ETA: 52s - loss: 0.6491 - acc: 0.6165
1472/3000 [=============>................] - ETA: 49s - loss: 0.6536 - acc: 0.6114
1536/3000 [==============>...............] - ETA: 47s - loss: 0.6519 - acc: 0.6139
1600/3000 [===============>..............] - ETA: 44s - loss: 0.6554 - acc: 0.6131
1664/3000 [===============>..............] - ETA: 42s - loss: 0.6523 - acc: 0.6172
1728/3000 [================>.............] - ETA: 40s - loss: 0.6502 - acc: 0.6198
1792/3000 [================>.............] - ETA: 37s - loss: 0.6455 - acc: 0.6256
1856/3000 [=================>............] - ETA: 35s - loss: 0.6431 - acc: 0.6288
1920/3000 [==================>...........] - ETA: 33s - loss: 0.6404 - acc: 0.6323
1984/3000 [==================>...........] - ETA: 31s - loss: 0.6372 - acc: 0.6356
2048/3000 [===================>..........] - ETA: 28s - loss: 0.6348 - acc: 0.6367
2112/3000 [====================>.........] - ETA: 26s - loss: 0.6319 - acc: 0.6387
2176/3000 [====================>.........] - ETA: 24s - loss: 0.6292 - acc: 0.6411
2240/3000 [=====================>........] - ETA: 22s - loss: 0.6258 - acc: 0.6438
2304/3000 [======================>.......] - ETA: 20s - loss: 0.6214 - acc: 0.6484
2368/3000 [======================>.......] - ETA: 18s - loss: 0.6243 - acc: 0.6482
2432/3000 [=======================>......] - ETA: 16s - loss: 0.6207 - acc: 0.6509
2496/3000 [=======================>......] - ETA: 14s - loss: 0.6229 - acc: 0.6514
2560/3000 [========================>.....] - ETA: 12s - loss: 0.6217 - acc: 0.6516
2624/3000 [=========================>....] - ETA: 11s - loss: 0.6195 - acc: 0.6543
2688/3000 [=========================>....] - ETA: 9s - loss: 0.6194 - acc: 0.6536 
2752/3000 [==========================>...] - ETA: 7s - loss: 0.6170 - acc: 0.6566
2816/3000 [===========================>..] - ETA: 5s - loss: 0.6160 - acc: 0.6566
2880/3000 [===========================>..] - ETA: 3s - loss: 0.6152 - acc: 0.6580
2944/3000 [============================>.] - ETA: 1s - loss: 0.6168 - acc: 0.6569
3000/3000 [==============================] - 88s 29ms/step - loss: 0.6176 - acc: 0.6567

Test accuracy: 72.7319944598338

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  10800

choose_one :  6528

F1score :  0.6907520125662674

AUC :  0.820618152309101

Confusion Matrix
[[7326 1251]
 [3474 5277]]
True label 0
0.8541448058761805  
0.1458551941238195  
True label 1
0.3969832019197806  
0.6030167980802194  

Train_result {'acc': [0.656666666507721], 'loss': [0.6176249965031941]}
Saved model to disk


2

Epoch 1/1

  64/3000 [..............................] - ETA: 1:28 - loss: 0.5771 - acc: 0.6875
 128/3000 [>.............................] - ETA: 1:23 - loss: 0.5714 - acc: 0.6797
 192/3000 [>.............................] - ETA: 1:20 - loss: 0.5639 - acc: 0.6979
 256/3000 [=>............................] - ETA: 1:16 - loss: 0.5569 - acc: 0.7070
 320/3000 [==>...........................] - ETA: 1:13 - loss: 0.5502 - acc: 0.7188
 384/3000 [==>...........................] - ETA: 1:11 - loss: 0.5535 - acc: 0.7240
 448/3000 [===>..........................] - ETA: 1:09 - loss: 0.5527 - acc: 0.7232
 512/3000 [====>.........................] - ETA: 1:07 - loss: 0.5539 - acc: 0.7246
 576/3000 [====>.........................] - ETA: 1:04 - loss: 0.5427 - acc: 0.7326
 640/3000 [=====>........................] - ETA: 1:03 - loss: 0.5374 - acc: 0.7312
 704/3000 [======>.......................] - ETA: 1:01 - loss: 0.5329 - acc: 0.7358
 768/3000 [======>.......................] - ETA: 58s - loss: 0.5465 - acc: 0.7344 
 832/3000 [=======>......................] - ETA: 56s - loss: 0.5385 - acc: 0.7380
 896/3000 [=======>......................] - ETA: 55s - loss: 0.5418 - acc: 0.7377
 960/3000 [========>.....................] - ETA: 53s - loss: 0.5534 - acc: 0.7271
1024/3000 [=========>....................] - ETA: 51s - loss: 0.5523 - acc: 0.7295
1088/3000 [=========>....................] - ETA: 50s - loss: 0.5539 - acc: 0.7279
1152/3000 [==========>...................] - ETA: 48s - loss: 0.5539 - acc: 0.7248
1216/3000 [===========>..................] - ETA: 47s - loss: 0.5552 - acc: 0.7237
1280/3000 [===========>..................] - ETA: 45s - loss: 0.5529 - acc: 0.7273
1344/3000 [============>.................] - ETA: 43s - loss: 0.5519 - acc: 0.7284
1408/3000 [=============>................] - ETA: 41s - loss: 0.5530 - acc: 0.7259
1472/3000 [=============>................] - ETA: 40s - loss: 0.5540 - acc: 0.7242
1536/3000 [==============>...............] - ETA: 38s - loss: 0.5510 - acc: 0.7285
1600/3000 [===============>..............] - ETA: 36s - loss: 0.5539 - acc: 0.7281
1664/3000 [===============>..............] - ETA: 35s - loss: 0.5516 - acc: 0.7284
1728/3000 [================>.............] - ETA: 33s - loss: 0.5510 - acc: 0.7274
1792/3000 [================>.............] - ETA: 31s - loss: 0.5474 - acc: 0.7305
1856/3000 [=================>............] - ETA: 29s - loss: 0.5492 - acc: 0.7284
1920/3000 [==================>...........] - ETA: 28s - loss: 0.5511 - acc: 0.7276
1984/3000 [==================>...........] - ETA: 26s - loss: 0.5509 - acc: 0.7278
2048/3000 [===================>..........] - ETA: 24s - loss: 0.5529 - acc: 0.7246
2112/3000 [====================>.........] - ETA: 23s - loss: 0.5534 - acc: 0.7240
2176/3000 [====================>.........] - ETA: 21s - loss: 0.5496 - acc: 0.7261
2240/3000 [=====================>........] - ETA: 19s - loss: 0.5484 - acc: 0.7259
2304/3000 [======================>.......] - ETA: 18s - loss: 0.5506 - acc: 0.7240
2368/3000 [======================>.......] - ETA: 16s - loss: 0.5496 - acc: 0.7238
2432/3000 [=======================>......] - ETA: 14s - loss: 0.5482 - acc: 0.7249
2496/3000 [=======================>......] - ETA: 13s - loss: 0.5489 - acc: 0.7248
2560/3000 [========================>.....] - ETA: 11s - loss: 0.5479 - acc: 0.7234
2624/3000 [=========================>....] - ETA: 9s - loss: 0.5521 - acc: 0.7199 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.5543 - acc: 0.7180
2752/3000 [==========================>...] - ETA: 6s - loss: 0.5556 - acc: 0.7169
2816/3000 [===========================>..] - ETA: 4s - loss: 0.5558 - acc: 0.7166
2880/3000 [===========================>..] - ETA: 3s - loss: 0.5564 - acc: 0.7181
2944/3000 [============================>.] - ETA: 1s - loss: 0.5561 - acc: 0.7188
3000/3000 [==============================] - 78s 26ms/step - loss: 0.5597 - acc: 0.7167

Test accuracy: 72.06255771006464

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  11682

choose_one :  5646

F1score :  0.6637493922344933

AUC :  0.8310571798007141

Confusion Matrix
[[7709  868]
 [3973 4778]]
True label 0
0.8987991139092923  
0.10120088609070771  
True label 1
0.4540052565421095  
0.5459947434578906  

Train_result {'acc': [0.7166666668256124], 'loss': [0.5596975251833598]}
Saved model to disk


3

Epoch 1/1

  64/3000 [..............................] - ETA: 1:27 - loss: 0.4668 - acc: 0.7812
 128/3000 [>.............................] - ETA: 1:18 - loss: 0.4991 - acc: 0.7422
 192/3000 [>.............................] - ETA: 1:18 - loss: 0.5252 - acc: 0.7240
 256/3000 [=>............................] - ETA: 1:18 - loss: 0.5219 - acc: 0.7227
 320/3000 [==>...........................] - ETA: 1:15 - loss: 0.5269 - acc: 0.7219
 384/3000 [==>...........................] - ETA: 1:12 - loss: 0.5061 - acc: 0.7474
 448/3000 [===>..........................] - ETA: 1:09 - loss: 0.4975 - acc: 0.7545
 512/3000 [====>.........................] - ETA: 1:07 - loss: 0.4933 - acc: 0.7598
 576/3000 [====>.........................] - ETA: 1:05 - loss: 0.5069 - acc: 0.7500
 640/3000 [=====>........................] - ETA: 1:03 - loss: 0.5097 - acc: 0.7500
 704/3000 [======>.......................] - ETA: 1:02 - loss: 0.5124 - acc: 0.7443
 768/3000 [======>.......................] - ETA: 1:00 - loss: 0.5162 - acc: 0.7409
 832/3000 [=======>......................] - ETA: 58s - loss: 0.5175 - acc: 0.7380 
 896/3000 [=======>......................] - ETA: 56s - loss: 0.5166 - acc: 0.7411
 960/3000 [========>.....................] - ETA: 54s - loss: 0.5158 - acc: 0.7417
1024/3000 [=========>....................] - ETA: 53s - loss: 0.5195 - acc: 0.7373
1088/3000 [=========>....................] - ETA: 51s - loss: 0.5178 - acc: 0.7390
1152/3000 [==========>...................] - ETA: 49s - loss: 0.5145 - acc: 0.7431
1216/3000 [===========>..................] - ETA: 47s - loss: 0.5194 - acc: 0.7385
1280/3000 [===========>..................] - ETA: 45s - loss: 0.5192 - acc: 0.7391
1344/3000 [============>.................] - ETA: 43s - loss: 0.5146 - acc: 0.7418
1408/3000 [=============>................] - ETA: 42s - loss: 0.5175 - acc: 0.7372
1472/3000 [=============>................] - ETA: 40s - loss: 0.5183 - acc: 0.7351
1536/3000 [==============>...............] - ETA: 38s - loss: 0.5186 - acc: 0.7363
1600/3000 [===============>..............] - ETA: 37s - loss: 0.5186 - acc: 0.7362
1664/3000 [===============>..............] - ETA: 35s - loss: 0.5182 - acc: 0.7356
1728/3000 [================>.............] - ETA: 33s - loss: 0.5138 - acc: 0.7378
1792/3000 [================>.............] - ETA: 31s - loss: 0.5160 - acc: 0.7372
1856/3000 [=================>............] - ETA: 29s - loss: 0.5158 - acc: 0.7381
1920/3000 [==================>...........] - ETA: 28s - loss: 0.5165 - acc: 0.7375
1984/3000 [==================>...........] - ETA: 26s - loss: 0.5154 - acc: 0.7384
2048/3000 [===================>..........] - ETA: 25s - loss: 0.5114 - acc: 0.7412
2112/3000 [====================>.........] - ETA: 23s - loss: 0.5093 - acc: 0.7415
2176/3000 [====================>.........] - ETA: 21s - loss: 0.5102 - acc: 0.7394
2240/3000 [=====================>........] - ETA: 19s - loss: 0.5072 - acc: 0.7433
2304/3000 [======================>.......] - ETA: 18s - loss: 0.5069 - acc: 0.7435
2368/3000 [======================>.......] - ETA: 16s - loss: 0.5091 - acc: 0.7424
2432/3000 [=======================>......] - ETA: 14s - loss: 0.5092 - acc: 0.7418
2496/3000 [=======================>......] - ETA: 13s - loss: 0.5106 - acc: 0.7404
2560/3000 [========================>.....] - ETA: 11s - loss: 0.5076 - acc: 0.7402
2624/3000 [=========================>....] - ETA: 9s - loss: 0.5074 - acc: 0.7401 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.5073 - acc: 0.7414
2752/3000 [==========================>...] - ETA: 6s - loss: 0.5064 - acc: 0.7424
2816/3000 [===========================>..] - ETA: 4s - loss: 0.5065 - acc: 0.7425
2880/3000 [===========================>..] - ETA: 3s - loss: 0.5035 - acc: 0.7448
2944/3000 [============================>.] - ETA: 1s - loss: 0.5027 - acc: 0.7459
3000/3000 [==============================] - 78s 26ms/step - loss: 0.5046 - acc: 0.7447

Test accuracy: 74.29593721144968

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  11511

choose_one :  5817

F1score :  0.6942613948380012

AUC :  0.8546558152810317

Confusion Matrix
[[7817  760]
 [3694 5057]]
True label 0
0.9113909292293343  
0.08860907077066574  
True label 1
0.42212318592160897  
0.5778768140783911  

Train_result {'acc': [0.7446666661898295], 'loss': [0.5045905575752259]}
Saved model to disk


4

Epoch 1/1

  64/3000 [..............................] - ETA: 1:26 - loss: 0.5822 - acc: 0.7188
 128/3000 [>.............................] - ETA: 1:21 - loss: 0.5384 - acc: 0.7109
 192/3000 [>.............................] - ETA: 1:19 - loss: 0.5022 - acc: 0.7500
 256/3000 [=>............................] - ETA: 1:16 - loss: 0.4659 - acc: 0.7852
 320/3000 [==>...........................] - ETA: 1:13 - loss: 0.4751 - acc: 0.7625
 384/3000 [==>...........................] - ETA: 1:11 - loss: 0.4642 - acc: 0.7682
 448/3000 [===>..........................] - ETA: 1:09 - loss: 0.4703 - acc: 0.7567
 512/3000 [====>.........................] - ETA: 1:07 - loss: 0.4594 - acc: 0.7656
 576/3000 [====>.........................] - ETA: 1:04 - loss: 0.4600 - acc: 0.7604
 640/3000 [=====>........................] - ETA: 1:02 - loss: 0.4727 - acc: 0.7562
 704/3000 [======>.......................] - ETA: 1:00 - loss: 0.4668 - acc: 0.7628
 768/3000 [======>.......................] - ETA: 58s - loss: 0.4609 - acc: 0.7695 
 832/3000 [=======>......................] - ETA: 56s - loss: 0.4530 - acc: 0.7812
 896/3000 [=======>......................] - ETA: 54s - loss: 0.4631 - acc: 0.7790
 960/3000 [========>.....................] - ETA: 52s - loss: 0.4729 - acc: 0.7750
1024/3000 [=========>....................] - ETA: 50s - loss: 0.4739 - acc: 0.7734
1088/3000 [=========>....................] - ETA: 48s - loss: 0.4692 - acc: 0.7757
1152/3000 [==========>...................] - ETA: 47s - loss: 0.4704 - acc: 0.7700
1216/3000 [===========>..................] - ETA: 45s - loss: 0.4695 - acc: 0.7697
1280/3000 [===========>..................] - ETA: 44s - loss: 0.4637 - acc: 0.7727
1344/3000 [============>.................] - ETA: 42s - loss: 0.4692 - acc: 0.7686
1408/3000 [=============>................] - ETA: 40s - loss: 0.4721 - acc: 0.7656
1472/3000 [=============>................] - ETA: 39s - loss: 0.4716 - acc: 0.7663
1536/3000 [==============>...............] - ETA: 37s - loss: 0.4717 - acc: 0.7669
1600/3000 [===============>..............] - ETA: 35s - loss: 0.4734 - acc: 0.7681
1664/3000 [===============>..............] - ETA: 34s - loss: 0.4710 - acc: 0.7686
1728/3000 [================>.............] - ETA: 32s - loss: 0.4713 - acc: 0.7679
1792/3000 [================>.............] - ETA: 31s - loss: 0.4688 - acc: 0.7701
1856/3000 [=================>............] - ETA: 29s - loss: 0.4674 - acc: 0.7721
1920/3000 [==================>...........] - ETA: 27s - loss: 0.4652 - acc: 0.7750
1984/3000 [==================>...........] - ETA: 26s - loss: 0.4661 - acc: 0.7732
2048/3000 [===================>..........] - ETA: 24s - loss: 0.4697 - acc: 0.7705
2112/3000 [====================>.........] - ETA: 22s - loss: 0.4746 - acc: 0.7670
2176/3000 [====================>.........] - ETA: 21s - loss: 0.4736 - acc: 0.7675
2240/3000 [=====================>........] - ETA: 19s - loss: 0.4720 - acc: 0.7692
2304/3000 [======================>.......] - ETA: 18s - loss: 0.4690 - acc: 0.7708
2368/3000 [======================>.......] - ETA: 16s - loss: 0.4738 - acc: 0.7686
2432/3000 [=======================>......] - ETA: 14s - loss: 0.4741 - acc: 0.7677
2496/3000 [=======================>......] - ETA: 13s - loss: 0.4739 - acc: 0.7676
2560/3000 [========================>.....] - ETA: 11s - loss: 0.4734 - acc: 0.7668
2624/3000 [=========================>....] - ETA: 9s - loss: 0.4710 - acc: 0.7687 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.4694 - acc: 0.7708
2752/3000 [==========================>...] - ETA: 6s - loss: 0.4681 - acc: 0.7725
2816/3000 [===========================>..] - ETA: 4s - loss: 0.4704 - acc: 0.7717
2880/3000 [===========================>..] - ETA: 3s - loss: 0.4698 - acc: 0.7712
2944/3000 [============================>.] - ETA: 1s - loss: 0.4685 - acc: 0.7711
3000/3000 [==============================] - 78s 26ms/step - loss: 0.4659 - acc: 0.7727

Test accuracy: 78.16251154201292

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  9791

choose_one :  7537

F1score :  0.7676817288801573

AUC :  0.8699484994982568

Confusion Matrix
[[7292 1285]
 [2499 6252]]
True label 0
0.8501807158680191  
0.14981928413198087  
True label 1
0.28556736372985947  
0.7144326362701405  

Train_result {'acc': [0.7726666668256124], 'loss': [0.46592053476969403]}
Saved model to disk


5

Epoch 1/1

  64/3000 [..............................] - ETA: 1:29 - loss: 0.4718 - acc: 0.7656
 128/3000 [>.............................] - ETA: 1:23 - loss: 0.4189 - acc: 0.8047
 192/3000 [>.............................] - ETA: 1:18 - loss: 0.4043 - acc: 0.8333
 256/3000 [=>............................] - ETA: 1:15 - loss: 0.4217 - acc: 0.8242
 320/3000 [==>...........................] - ETA: 1:13 - loss: 0.4174 - acc: 0.8219
 384/3000 [==>...........................] - ETA: 1:10 - loss: 0.4291 - acc: 0.8125
 448/3000 [===>..........................] - ETA: 1:07 - loss: 0.4362 - acc: 0.8058
 512/3000 [====>.........................] - ETA: 1:04 - loss: 0.4199 - acc: 0.8086
 576/3000 [====>.........................] - ETA: 1:03 - loss: 0.4311 - acc: 0.7969
 640/3000 [=====>........................] - ETA: 1:01 - loss: 0.4221 - acc: 0.8031
 704/3000 [======>.......................] - ETA: 59s - loss: 0.4280 - acc: 0.8040 
 768/3000 [======>.......................] - ETA: 57s - loss: 0.4305 - acc: 0.8008
 832/3000 [=======>......................] - ETA: 55s - loss: 0.4420 - acc: 0.7957
 896/3000 [=======>......................] - ETA: 54s - loss: 0.4381 - acc: 0.7946
 960/3000 [========>.....................] - ETA: 52s - loss: 0.4354 - acc: 0.7948
1024/3000 [=========>....................] - ETA: 50s - loss: 0.4338 - acc: 0.7939
1088/3000 [=========>....................] - ETA: 49s - loss: 0.4349 - acc: 0.7960
1152/3000 [==========>...................] - ETA: 47s - loss: 0.4391 - acc: 0.7899
1216/3000 [===========>..................] - ETA: 46s - loss: 0.4336 - acc: 0.7944
1280/3000 [===========>..................] - ETA: 44s - loss: 0.4364 - acc: 0.7945
1344/3000 [============>.................] - ETA: 42s - loss: 0.4376 - acc: 0.7924
1408/3000 [=============>................] - ETA: 41s - loss: 0.4374 - acc: 0.7912
1472/3000 [=============>................] - ETA: 39s - loss: 0.4376 - acc: 0.7914
1536/3000 [==============>...............] - ETA: 37s - loss: 0.4351 - acc: 0.7923
1600/3000 [===============>..............] - ETA: 36s - loss: 0.4368 - acc: 0.7937
1664/3000 [===============>..............] - ETA: 34s - loss: 0.4370 - acc: 0.7927
1728/3000 [================>.............] - ETA: 33s - loss: 0.4355 - acc: 0.7940
1792/3000 [================>.............] - ETA: 31s - loss: 0.4344 - acc: 0.7946
1856/3000 [=================>............] - ETA: 29s - loss: 0.4305 - acc: 0.7953
1920/3000 [==================>...........] - ETA: 27s - loss: 0.4307 - acc: 0.7953
1984/3000 [==================>...........] - ETA: 26s - loss: 0.4292 - acc: 0.7954
2048/3000 [===================>..........] - ETA: 24s - loss: 0.4289 - acc: 0.7969
2112/3000 [====================>.........] - ETA: 22s - loss: 0.4353 - acc: 0.7955
2176/3000 [====================>.........] - ETA: 21s - loss: 0.4410 - acc: 0.7950
2240/3000 [=====================>........] - ETA: 19s - loss: 0.4431 - acc: 0.7933
2304/3000 [======================>.......] - ETA: 17s - loss: 0.4400 - acc: 0.7951
2368/3000 [======================>.......] - ETA: 16s - loss: 0.4379 - acc: 0.7956
2432/3000 [=======================>......] - ETA: 14s - loss: 0.4371 - acc: 0.7956
2496/3000 [=======================>......] - ETA: 13s - loss: 0.4377 - acc: 0.7953
2560/3000 [========================>.....] - ETA: 11s - loss: 0.4363 - acc: 0.7965
2624/3000 [=========================>....] - ETA: 9s - loss: 0.4356 - acc: 0.7973 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.4341 - acc: 0.7972
2752/3000 [==========================>...] - ETA: 6s - loss: 0.4320 - acc: 0.7976
2816/3000 [===========================>..] - ETA: 4s - loss: 0.4315 - acc: 0.7979
2880/3000 [===========================>..] - ETA: 3s - loss: 0.4328 - acc: 0.7972
2944/3000 [============================>.] - ETA: 1s - loss: 0.4317 - acc: 0.7986
3000/3000 [==============================] - 78s 26ms/step - loss: 0.4329 - acc: 0.7987

Test accuracy: 78.35295475530933

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  7286

choose_one :  10042

F1score :  0.8004044058958122

AUC :  0.8757634081480146

Confusion Matrix
[[6056 2521]
 [1230 7521]]
True label 0
0.7060743849830943  
0.2939256150169057  
True label 1
0.14055536510113129  
0.8594446348988687  

Train_result {'acc': [0.7986666661898295], 'loss': [0.4329335760275523]}
Saved model to disk


6

Epoch 1/1

  64/3000 [..............................] - ETA: 1:25 - loss: 0.2960 - acc: 0.8594
 128/3000 [>.............................] - ETA: 1:19 - loss: 0.3775 - acc: 0.8438
 192/3000 [>.............................] - ETA: 1:15 - loss: 0.3989 - acc: 0.8125
 256/3000 [=>............................] - ETA: 1:14 - loss: 0.3989 - acc: 0.8164
 320/3000 [==>...........................] - ETA: 1:10 - loss: 0.4026 - acc: 0.8125
 384/3000 [==>...........................] - ETA: 1:08 - loss: 0.4051 - acc: 0.8073
 448/3000 [===>..........................] - ETA: 1:07 - loss: 0.4004 - acc: 0.8080
 512/3000 [====>.........................] - ETA: 1:05 - loss: 0.4157 - acc: 0.8047
 576/3000 [====>.........................] - ETA: 1:03 - loss: 0.4187 - acc: 0.8038
 640/3000 [=====>........................] - ETA: 1:01 - loss: 0.4241 - acc: 0.7969
 704/3000 [======>.......................] - ETA: 59s - loss: 0.4218 - acc: 0.7969 
 768/3000 [======>.......................] - ETA: 57s - loss: 0.4122 - acc: 0.8021
 832/3000 [=======>......................] - ETA: 55s - loss: 0.4026 - acc: 0.8113
 896/3000 [=======>......................] - ETA: 53s - loss: 0.4033 - acc: 0.8080
 960/3000 [========>.....................] - ETA: 52s - loss: 0.4044 - acc: 0.8083
1024/3000 [=========>....................] - ETA: 51s - loss: 0.4030 - acc: 0.8105
1088/3000 [=========>....................] - ETA: 49s - loss: 0.4011 - acc: 0.8125
1152/3000 [==========>...................] - ETA: 47s - loss: 0.4023 - acc: 0.8099
1216/3000 [===========>..................] - ETA: 45s - loss: 0.4055 - acc: 0.8109
1280/3000 [===========>..................] - ETA: 44s - loss: 0.4076 - acc: 0.8094
1344/3000 [============>.................] - ETA: 42s - loss: 0.4065 - acc: 0.8088
1408/3000 [=============>................] - ETA: 41s - loss: 0.4121 - acc: 0.8075
1472/3000 [=============>................] - ETA: 39s - loss: 0.4109 - acc: 0.8098
1536/3000 [==============>...............] - ETA: 37s - loss: 0.4074 - acc: 0.8118
1600/3000 [===============>..............] - ETA: 36s - loss: 0.4076 - acc: 0.8094
1664/3000 [===============>..............] - ETA: 34s - loss: 0.4141 - acc: 0.8065
1728/3000 [================>.............] - ETA: 32s - loss: 0.4160 - acc: 0.8061
1792/3000 [================>.............] - ETA: 31s - loss: 0.4126 - acc: 0.8086
1856/3000 [=================>............] - ETA: 29s - loss: 0.4119 - acc: 0.8082
1920/3000 [==================>...........] - ETA: 27s - loss: 0.4099 - acc: 0.8083
1984/3000 [==================>...........] - ETA: 26s - loss: 0.4090 - acc: 0.8095
2048/3000 [===================>..........] - ETA: 24s - loss: 0.4076 - acc: 0.8101
2112/3000 [====================>.........] - ETA: 22s - loss: 0.4077 - acc: 0.8111
2176/3000 [====================>.........] - ETA: 21s - loss: 0.4025 - acc: 0.8139
2240/3000 [=====================>........] - ETA: 19s - loss: 0.4034 - acc: 0.8138
2304/3000 [======================>.......] - ETA: 18s - loss: 0.4056 - acc: 0.8129
2368/3000 [======================>.......] - ETA: 16s - loss: 0.4067 - acc: 0.8138
2432/3000 [=======================>......] - ETA: 14s - loss: 0.4041 - acc: 0.8141
2496/3000 [=======================>......] - ETA: 13s - loss: 0.4055 - acc: 0.8129
2560/3000 [========================>.....] - ETA: 11s - loss: 0.4040 - acc: 0.8125
2624/3000 [=========================>....] - ETA: 9s - loss: 0.4021 - acc: 0.8136 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.4033 - acc: 0.8132
2752/3000 [==========================>...] - ETA: 6s - loss: 0.3983 - acc: 0.8165
2816/3000 [===========================>..] - ETA: 4s - loss: 0.3993 - acc: 0.8164
2880/3000 [===========================>..] - ETA: 3s - loss: 0.3958 - acc: 0.8187
2944/3000 [============================>.] - ETA: 1s - loss: 0.3959 - acc: 0.8186
3000/3000 [==============================] - 78s 26ms/step - loss: 0.3950 - acc: 0.8187

Test accuracy: 79.76685133887351

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  8575

choose_one :  8753

F1score :  0.7997029250457038

AUC :  0.881096565029554

Confusion Matrix
[[6823 1754]
 [1752 6999]]
True label 0
0.7954995919319109  
0.20450040806808908  
True label 1
0.20020569077819678  
0.7997943092218032  

Train_result {'acc': [0.8186666671435038], 'loss': [0.39503569785753884]}
Saved model to disk


7

Epoch 1/1

  64/3000 [..............................] - ETA: 1:32 - loss: 0.3034 - acc: 0.8750
 128/3000 [>.............................] - ETA: 1:20 - loss: 0.3350 - acc: 0.8594
 192/3000 [>.............................] - ETA: 1:16 - loss: 0.3238 - acc: 0.8594
 256/3000 [=>............................] - ETA: 1:12 - loss: 0.3489 - acc: 0.8438
 320/3000 [==>...........................] - ETA: 1:11 - loss: 0.3339 - acc: 0.8469
 384/3000 [==>...........................] - ETA: 1:08 - loss: 0.3362 - acc: 0.8516
 448/3000 [===>..........................] - ETA: 1:06 - loss: 0.3481 - acc: 0.8482
 512/3000 [====>.........................] - ETA: 1:05 - loss: 0.3510 - acc: 0.8477
 576/3000 [====>.........................] - ETA: 1:03 - loss: 0.3567 - acc: 0.8385
 640/3000 [=====>........................] - ETA: 1:01 - loss: 0.3563 - acc: 0.8313
 704/3000 [======>.......................] - ETA: 59s - loss: 0.3603 - acc: 0.8281 
 768/3000 [======>.......................] - ETA: 58s - loss: 0.3582 - acc: 0.8307
 832/3000 [=======>......................] - ETA: 56s - loss: 0.3542 - acc: 0.8329
 896/3000 [=======>......................] - ETA: 54s - loss: 0.3531 - acc: 0.8304
 960/3000 [========>.....................] - ETA: 52s - loss: 0.3523 - acc: 0.8313
1024/3000 [=========>....................] - ETA: 50s - loss: 0.3526 - acc: 0.8320
1088/3000 [=========>....................] - ETA: 48s - loss: 0.3572 - acc: 0.8290
1152/3000 [==========>...................] - ETA: 47s - loss: 0.3651 - acc: 0.8247
1216/3000 [===========>..................] - ETA: 45s - loss: 0.3664 - acc: 0.8232
1280/3000 [===========>..................] - ETA: 43s - loss: 0.3692 - acc: 0.8227
1344/3000 [============>.................] - ETA: 41s - loss: 0.3633 - acc: 0.8281
1408/3000 [=============>................] - ETA: 40s - loss: 0.3603 - acc: 0.8303
1472/3000 [=============>................] - ETA: 38s - loss: 0.3621 - acc: 0.8302
1536/3000 [==============>...............] - ETA: 37s - loss: 0.3628 - acc: 0.8301
1600/3000 [===============>..............] - ETA: 35s - loss: 0.3640 - acc: 0.8287
1664/3000 [===============>..............] - ETA: 34s - loss: 0.3652 - acc: 0.8257
1728/3000 [================>.............] - ETA: 32s - loss: 0.3690 - acc: 0.8235
1792/3000 [================>.............] - ETA: 30s - loss: 0.3692 - acc: 0.8237
1856/3000 [=================>............] - ETA: 29s - loss: 0.3775 - acc: 0.8211
1920/3000 [==================>...........] - ETA: 27s - loss: 0.3770 - acc: 0.8214
1984/3000 [==================>...........] - ETA: 25s - loss: 0.3800 - acc: 0.8201
2048/3000 [===================>..........] - ETA: 24s - loss: 0.3786 - acc: 0.8203
2112/3000 [====================>.........] - ETA: 22s - loss: 0.3789 - acc: 0.8205
2176/3000 [====================>.........] - ETA: 20s - loss: 0.3775 - acc: 0.8217
2240/3000 [=====================>........] - ETA: 19s - loss: 0.3758 - acc: 0.8232
2304/3000 [======================>.......] - ETA: 17s - loss: 0.3736 - acc: 0.8251
2368/3000 [======================>.......] - ETA: 16s - loss: 0.3734 - acc: 0.8247
2432/3000 [=======================>......] - ETA: 14s - loss: 0.3753 - acc: 0.8232
2496/3000 [=======================>......] - ETA: 12s - loss: 0.3768 - acc: 0.8229
2560/3000 [========================>.....] - ETA: 11s - loss: 0.3757 - acc: 0.8230
2624/3000 [=========================>....] - ETA: 9s - loss: 0.3749 - acc: 0.8232 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.3759 - acc: 0.8225
2752/3000 [==========================>...] - ETA: 6s - loss: 0.3769 - acc: 0.8212
2816/3000 [===========================>..] - ETA: 4s - loss: 0.3772 - acc: 0.8207
2880/3000 [===========================>..] - ETA: 3s - loss: 0.3768 - acc: 0.8208
2944/3000 [============================>.] - ETA: 1s - loss: 0.3767 - acc: 0.8207
3000/3000 [==============================] - 76s 25ms/step - loss: 0.3746 - acc: 0.8203

Test accuracy: 78.27793167128347

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  6651

choose_one :  10677

F1score :  0.8062590076178711

AUC :  0.8872148617815819

Confusion Matrix
[[5732 2845]
 [ 919 7832]]
True label 0
0.6682989390229684  
0.3317010609770316  
True label 1
0.1050165695349103  
0.8949834304650897  

Train_result {'acc': [0.8203333328564961], 'loss': [0.3746120061079661]}
Saved model to disk


8

Epoch 1/1

  64/3000 [..............................] - ETA: 1:23 - loss: 0.4527 - acc: 0.8281
 128/3000 [>.............................] - ETA: 1:17 - loss: 0.4316 - acc: 0.8203
 192/3000 [>.............................] - ETA: 1:13 - loss: 0.4229 - acc: 0.8125
 256/3000 [=>............................] - ETA: 1:11 - loss: 0.4198 - acc: 0.8242
 320/3000 [==>...........................] - ETA: 1:08 - loss: 0.3861 - acc: 0.8375
 384/3000 [==>...........................] - ETA: 1:06 - loss: 0.3776 - acc: 0.8359
 448/3000 [===>..........................] - ETA: 1:04 - loss: 0.3682 - acc: 0.8438
 512/3000 [====>.........................] - ETA: 1:02 - loss: 0.3722 - acc: 0.8477
 576/3000 [====>.........................] - ETA: 1:00 - loss: 0.3680 - acc: 0.8472
 640/3000 [=====>........................] - ETA: 58s - loss: 0.3696 - acc: 0.8438 
 704/3000 [======>.......................] - ETA: 57s - loss: 0.3649 - acc: 0.8480
 768/3000 [======>.......................] - ETA: 56s - loss: 0.3693 - acc: 0.8438
 832/3000 [=======>......................] - ETA: 54s - loss: 0.3667 - acc: 0.8438
 896/3000 [=======>......................] - ETA: 52s - loss: 0.3733 - acc: 0.8415
 960/3000 [========>.....................] - ETA: 51s - loss: 0.3703 - acc: 0.8438
1024/3000 [=========>....................] - ETA: 49s - loss: 0.3665 - acc: 0.8457
1088/3000 [=========>....................] - ETA: 48s - loss: 0.3675 - acc: 0.8447
1152/3000 [==========>...................] - ETA: 46s - loss: 0.3647 - acc: 0.8455
1216/3000 [===========>..................] - ETA: 45s - loss: 0.3608 - acc: 0.8470
1280/3000 [===========>..................] - ETA: 44s - loss: 0.3581 - acc: 0.8469
1344/3000 [============>.................] - ETA: 42s - loss: 0.3602 - acc: 0.8445
1408/3000 [=============>................] - ETA: 41s - loss: 0.3607 - acc: 0.8409
1472/3000 [=============>................] - ETA: 39s - loss: 0.3590 - acc: 0.8424
1536/3000 [==============>...............] - ETA: 38s - loss: 0.3555 - acc: 0.8424
1600/3000 [===============>..............] - ETA: 36s - loss: 0.3540 - acc: 0.8438
1664/3000 [===============>..............] - ETA: 34s - loss: 0.3551 - acc: 0.8438
1728/3000 [================>.............] - ETA: 33s - loss: 0.3539 - acc: 0.8443
1792/3000 [================>.............] - ETA: 31s - loss: 0.3503 - acc: 0.8482
1856/3000 [=================>............] - ETA: 29s - loss: 0.3461 - acc: 0.8502
1920/3000 [==================>...........] - ETA: 28s - loss: 0.3446 - acc: 0.8500
1984/3000 [==================>...........] - ETA: 26s - loss: 0.3444 - acc: 0.8498
2048/3000 [===================>..........] - ETA: 24s - loss: 0.3406 - acc: 0.8506
2112/3000 [====================>.........] - ETA: 23s - loss: 0.3398 - acc: 0.8513
2176/3000 [====================>.........] - ETA: 21s - loss: 0.3383 - acc: 0.8516
2240/3000 [=====================>........] - ETA: 19s - loss: 0.3408 - acc: 0.8491
2304/3000 [======================>.......] - ETA: 18s - loss: 0.3419 - acc: 0.8485
2368/3000 [======================>.......] - ETA: 16s - loss: 0.3416 - acc: 0.8471
2432/3000 [=======================>......] - ETA: 14s - loss: 0.3448 - acc: 0.8458
2496/3000 [=======================>......] - ETA: 13s - loss: 0.3453 - acc: 0.8458
2560/3000 [========================>.....] - ETA: 11s - loss: 0.3477 - acc: 0.8453
2624/3000 [=========================>....] - ETA: 9s - loss: 0.3474 - acc: 0.8460 
2688/3000 [=========================>....] - ETA: 8s - loss: 0.3471 - acc: 0.8464
2752/3000 [==========================>...] - ETA: 6s - loss: 0.3503 - acc: 0.8445
2816/3000 [===========================>..] - ETA: 4s - loss: 0.3479 - acc: 0.8459
2880/3000 [===========================>..] - ETA: 3s - loss: 0.3485 - acc: 0.8462
2944/3000 [============================>.] - ETA: 1s - loss: 0.3490 - acc: 0.8461
3000/3000 [==============================] - 79s 26ms/step - loss: 0.3504 - acc: 0.8457

Test accuracy: 79.65720221606648

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  7444

choose_one :  9884

F1score :  0.8108398175476254

AUC :  0.8860546086326789

Confusion Matrix
[[6248 2329]
 [1196 7555]]
True label 0
0.7284598344409468  
0.2715401655590533  
True label 1
0.13667009484630327  
0.8633299051536967  

Train_result {'acc': [0.8456666671435038], 'loss': [0.35038650027910867]}
Saved model to disk


9

Epoch 1/1

  64/3000 [..............................] - ETA: 1:20 - loss: 0.3768 - acc: 0.8594
 128/3000 [>.............................] - ETA: 1:08 - loss: 0.3715 - acc: 0.8281
 192/3000 [>.............................] - ETA: 1:07 - loss: 0.3481 - acc: 0.8385
 256/3000 [=>............................] - ETA: 1:06 - loss: 0.3141 - acc: 0.8594
 320/3000 [==>...........................] - ETA: 1:04 - loss: 0.3401 - acc: 0.8531
 384/3000 [==>...........................] - ETA: 1:02 - loss: 0.3453 - acc: 0.8490
 448/3000 [===>..........................] - ETA: 59s - loss: 0.3590 - acc: 0.8415 
 512/3000 [====>.........................] - ETA: 58s - loss: 0.3610 - acc: 0.8398
 576/3000 [====>.........................] - ETA: 57s - loss: 0.3463 - acc: 0.8455
 640/3000 [=====>........................] - ETA: 55s - loss: 0.3422 - acc: 0.8484
 704/3000 [======>.......................] - ETA: 53s - loss: 0.3368 - acc: 0.8509
 768/3000 [======>.......................] - ETA: 52s - loss: 0.3383 - acc: 0.8503
 832/3000 [=======>......................] - ETA: 51s - loss: 0.3390 - acc: 0.8510
 896/3000 [=======>......................] - ETA: 49s - loss: 0.3387 - acc: 0.8538
 960/3000 [========>.....................] - ETA: 47s - loss: 0.3432 - acc: 0.8521
1024/3000 [=========>....................] - ETA: 46s - loss: 0.3421 - acc: 0.8516
1088/3000 [=========>....................] - ETA: 44s - loss: 0.3371 - acc: 0.8548
1152/3000 [==========>...................] - ETA: 43s - loss: 0.3298 - acc: 0.8585
1216/3000 [===========>..................] - ETA: 41s - loss: 0.3268 - acc: 0.8610
1280/3000 [===========>..................] - ETA: 40s - loss: 0.3253 - acc: 0.8617
1344/3000 [============>.................] - ETA: 39s - loss: 0.3200 - acc: 0.8624
1408/3000 [=============>................] - ETA: 37s - loss: 0.3233 - acc: 0.8608
1472/3000 [=============>................] - ETA: 35s - loss: 0.3182 - acc: 0.8621
1536/3000 [==============>...............] - ETA: 34s - loss: 0.3221 - acc: 0.8607
1600/3000 [===============>..............] - ETA: 33s - loss: 0.3274 - acc: 0.8556
1664/3000 [===============>..............] - ETA: 31s - loss: 0.3250 - acc: 0.8570
1728/3000 [================>.............] - ETA: 30s - loss: 0.3235 - acc: 0.8565
1792/3000 [================>.............] - ETA: 28s - loss: 0.3223 - acc: 0.8566
1856/3000 [=================>............] - ETA: 27s - loss: 0.3239 - acc: 0.8567
1920/3000 [==================>...........] - ETA: 25s - loss: 0.3275 - acc: 0.8573
1984/3000 [==================>...........] - ETA: 24s - loss: 0.3281 - acc: 0.8558
2048/3000 [===================>..........] - ETA: 22s - loss: 0.3272 - acc: 0.8569
2112/3000 [====================>.........] - ETA: 21s - loss: 0.3259 - acc: 0.8570
2176/3000 [====================>.........] - ETA: 19s - loss: 0.3280 - acc: 0.8557
2240/3000 [=====================>........] - ETA: 18s - loss: 0.3273 - acc: 0.8558
2304/3000 [======================>.......] - ETA: 16s - loss: 0.3242 - acc: 0.8568
2368/3000 [======================>.......] - ETA: 15s - loss: 0.3245 - acc: 0.8564
2432/3000 [=======================>......] - ETA: 13s - loss: 0.3235 - acc: 0.8569
2496/3000 [=======================>......] - ETA: 11s - loss: 0.3227 - acc: 0.8578
2560/3000 [========================>.....] - ETA: 10s - loss: 0.3217 - acc: 0.8590
2624/3000 [=========================>....] - ETA: 8s - loss: 0.3218 - acc: 0.8590 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.3204 - acc: 0.8594
2752/3000 [==========================>...] - ETA: 5s - loss: 0.3200 - acc: 0.8594
2816/3000 [===========================>..] - ETA: 4s - loss: 0.3185 - acc: 0.8604
2880/3000 [===========================>..] - ETA: 2s - loss: 0.3198 - acc: 0.8597
2944/3000 [============================>.] - ETA: 1s - loss: 0.3181 - acc: 0.8604
3000/3000 [==============================] - 71s 24ms/step - loss: 0.3196 - acc: 0.8597

Test accuracy: 80.69021237303787

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  9371

choose_one :  7957

F1score :  0.7997366531003113

AUC :  0.8910337894127245

Confusion Matrix
[[7301 1276]
 [2070 6681]]
True label 0
0.851230033811356  
0.14876996618864405  
True label 1
0.23654439492629414  
0.7634556050737059  

Train_result {'acc': [0.8596666671435038], 'loss': [0.3196019608974457]}
Saved model to disk


10

Epoch 1/1

  64/3000 [..............................] - ETA: 1:25 - loss: 0.4405 - acc: 0.8125
 128/3000 [>.............................] - ETA: 1:11 - loss: 0.3632 - acc: 0.8359
 192/3000 [>.............................] - ETA: 1:07 - loss: 0.3123 - acc: 0.8646
 256/3000 [=>............................] - ETA: 1:04 - loss: 0.2913 - acc: 0.8750
 320/3000 [==>...........................] - ETA: 1:03 - loss: 0.2955 - acc: 0.8625
 384/3000 [==>...........................] - ETA: 1:01 - loss: 0.2898 - acc: 0.8698
 448/3000 [===>..........................] - ETA: 59s - loss: 0.2830 - acc: 0.8750 
 512/3000 [====>.........................] - ETA: 57s - loss: 0.2740 - acc: 0.8828
 576/3000 [====>.........................] - ETA: 56s - loss: 0.2805 - acc: 0.8837
 640/3000 [=====>........................] - ETA: 54s - loss: 0.2949 - acc: 0.8766
 704/3000 [======>.......................] - ETA: 53s - loss: 0.2952 - acc: 0.8793
 768/3000 [======>.......................] - ETA: 51s - loss: 0.2871 - acc: 0.8828
 832/3000 [=======>......................] - ETA: 50s - loss: 0.2865 - acc: 0.8834
 896/3000 [=======>......................] - ETA: 48s - loss: 0.2897 - acc: 0.8783
 960/3000 [========>.....................] - ETA: 47s - loss: 0.2855 - acc: 0.8812
1024/3000 [=========>....................] - ETA: 46s - loss: 0.2799 - acc: 0.8848
1088/3000 [=========>....................] - ETA: 44s - loss: 0.2842 - acc: 0.8824
1152/3000 [==========>...................] - ETA: 43s - loss: 0.2838 - acc: 0.8819
1216/3000 [===========>..................] - ETA: 41s - loss: 0.2799 - acc: 0.8824
1280/3000 [===========>..................] - ETA: 40s - loss: 0.2831 - acc: 0.8797
1344/3000 [============>.................] - ETA: 38s - loss: 0.2991 - acc: 0.8743
1408/3000 [=============>................] - ETA: 37s - loss: 0.2912 - acc: 0.8778
1472/3000 [=============>................] - ETA: 35s - loss: 0.2917 - acc: 0.8770
1536/3000 [==============>...............] - ETA: 34s - loss: 0.2871 - acc: 0.8796
1600/3000 [===============>..............] - ETA: 32s - loss: 0.2918 - acc: 0.8756
1664/3000 [===============>..............] - ETA: 31s - loss: 0.2909 - acc: 0.8756
1728/3000 [================>.............] - ETA: 29s - loss: 0.2870 - acc: 0.8773
1792/3000 [================>.............] - ETA: 28s - loss: 0.2897 - acc: 0.8761
1856/3000 [=================>............] - ETA: 26s - loss: 0.2871 - acc: 0.8761
1920/3000 [==================>...........] - ETA: 25s - loss: 0.2874 - acc: 0.8760
1984/3000 [==================>...........] - ETA: 23s - loss: 0.2844 - acc: 0.8770
2048/3000 [===================>..........] - ETA: 22s - loss: 0.2827 - acc: 0.8784
2112/3000 [====================>.........] - ETA: 20s - loss: 0.2845 - acc: 0.8778
2176/3000 [====================>.........] - ETA: 19s - loss: 0.2839 - acc: 0.8796
2240/3000 [=====================>........] - ETA: 17s - loss: 0.2840 - acc: 0.8786
2304/3000 [======================>.......] - ETA: 16s - loss: 0.2866 - acc: 0.8776
2368/3000 [======================>.......] - ETA: 14s - loss: 0.2877 - acc: 0.8775
2432/3000 [=======================>......] - ETA: 13s - loss: 0.2900 - acc: 0.8766
2496/3000 [=======================>......] - ETA: 11s - loss: 0.2917 - acc: 0.8742
2560/3000 [========================>.....] - ETA: 10s - loss: 0.2951 - acc: 0.8730
2624/3000 [=========================>....] - ETA: 8s - loss: 0.2936 - acc: 0.8742 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.2936 - acc: 0.8739
2752/3000 [==========================>...] - ETA: 5s - loss: 0.2934 - acc: 0.8735
2816/3000 [===========================>..] - ETA: 4s - loss: 0.2968 - acc: 0.8707
2880/3000 [===========================>..] - ETA: 2s - loss: 0.2974 - acc: 0.8705
2944/3000 [============================>.] - ETA: 1s - loss: 0.2962 - acc: 0.8713
3000/3000 [==============================] - 71s 24ms/step - loss: 0.2958 - acc: 0.8713

Test accuracy: 80.77677746999076

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  9026

choose_one :  8302

F1score :  0.8046678003870287

AUC :  0.8910387989169931

Confusion Matrix
[[7136 1441]
 [1890 6861]]
True label 0
0.831992538183514  
0.16800746181648596  
True label 1
0.21597531710661638  
0.7840246828933836  

Train_result {'acc': [0.8713333333333333], 'loss': [0.29581894357999167]}
Saved model to disk


11

Epoch 1/1

  64/3000 [..............................] - ETA: 1:26 - loss: 0.2546 - acc: 0.8906
 128/3000 [>.............................] - ETA: 1:17 - loss: 0.2386 - acc: 0.9141
 192/3000 [>.............................] - ETA: 1:13 - loss: 0.2397 - acc: 0.9115
 256/3000 [=>............................] - ETA: 1:12 - loss: 0.2637 - acc: 0.8906
 320/3000 [==>...........................] - ETA: 1:09 - loss: 0.2696 - acc: 0.8812
 384/3000 [==>...........................] - ETA: 1:06 - loss: 0.2757 - acc: 0.8750
 448/3000 [===>..........................] - ETA: 1:03 - loss: 0.2738 - acc: 0.8750
 512/3000 [====>.........................] - ETA: 1:02 - loss: 0.2783 - acc: 0.8770
 576/3000 [====>.........................] - ETA: 1:00 - loss: 0.2698 - acc: 0.8802
 640/3000 [=====>........................] - ETA: 58s - loss: 0.2637 - acc: 0.8844 
 704/3000 [======>.......................] - ETA: 56s - loss: 0.2788 - acc: 0.8821
 768/3000 [======>.......................] - ETA: 54s - loss: 0.2899 - acc: 0.8763
 832/3000 [=======>......................] - ETA: 53s - loss: 0.2860 - acc: 0.8786
 896/3000 [=======>......................] - ETA: 51s - loss: 0.2817 - acc: 0.8783
 960/3000 [========>.....................] - ETA: 49s - loss: 0.2754 - acc: 0.8812
1024/3000 [=========>....................] - ETA: 47s - loss: 0.2803 - acc: 0.8770
1088/3000 [=========>....................] - ETA: 46s - loss: 0.2818 - acc: 0.8750
1152/3000 [==========>...................] - ETA: 44s - loss: 0.2803 - acc: 0.8767
1216/3000 [===========>..................] - ETA: 42s - loss: 0.2809 - acc: 0.8775
1280/3000 [===========>..................] - ETA: 41s - loss: 0.2759 - acc: 0.8797
1344/3000 [============>.................] - ETA: 39s - loss: 0.2712 - acc: 0.8839
1408/3000 [=============>................] - ETA: 38s - loss: 0.2719 - acc: 0.8828
1472/3000 [=============>................] - ETA: 36s - loss: 0.2696 - acc: 0.8852
1536/3000 [==============>...............] - ETA: 34s - loss: 0.2691 - acc: 0.8848
1600/3000 [===============>..............] - ETA: 33s - loss: 0.2715 - acc: 0.8838
1664/3000 [===============>..............] - ETA: 31s - loss: 0.2691 - acc: 0.8852
1728/3000 [================>.............] - ETA: 30s - loss: 0.2746 - acc: 0.8837
1792/3000 [================>.............] - ETA: 28s - loss: 0.2791 - acc: 0.8828
1856/3000 [=================>............] - ETA: 27s - loss: 0.2769 - acc: 0.8836
1920/3000 [==================>...........] - ETA: 25s - loss: 0.2737 - acc: 0.8849
1984/3000 [==================>...........] - ETA: 24s - loss: 0.2779 - acc: 0.8831
2048/3000 [===================>..........] - ETA: 22s - loss: 0.2771 - acc: 0.8838
2112/3000 [====================>.........] - ETA: 21s - loss: 0.2769 - acc: 0.8816
2176/3000 [====================>.........] - ETA: 19s - loss: 0.2785 - acc: 0.8796
2240/3000 [=====================>........] - ETA: 17s - loss: 0.2783 - acc: 0.8790
2304/3000 [======================>.......] - ETA: 16s - loss: 0.2770 - acc: 0.8802
2368/3000 [======================>.......] - ETA: 14s - loss: 0.2781 - acc: 0.8784
2432/3000 [=======================>......] - ETA: 13s - loss: 0.2780 - acc: 0.8787
2496/3000 [=======================>......] - ETA: 11s - loss: 0.2742 - acc: 0.8810
2560/3000 [========================>.....] - ETA: 10s - loss: 0.2746 - acc: 0.8812
2624/3000 [=========================>....] - ETA: 8s - loss: 0.2749 - acc: 0.8822 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.2764 - acc: 0.8810
2752/3000 [==========================>...] - ETA: 5s - loss: 0.2756 - acc: 0.8812
2816/3000 [===========================>..] - ETA: 4s - loss: 0.2759 - acc: 0.8810
2880/3000 [===========================>..] - ETA: 2s - loss: 0.2757 - acc: 0.8806
2944/3000 [============================>.] - ETA: 1s - loss: 0.2747 - acc: 0.8811
3000/3000 [==============================] - 71s 24ms/step - loss: 0.2745 - acc: 0.8813

Test accuracy: 81.00184672206832

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  9009

choose_one :  8319

F1score :  0.8071470415934388

AUC :  0.8896166592769816

Confusion Matrix
[[7147 1430]
 [1862 6889]]
True label 0
0.8332750378920368  
0.16672496210796317  
True label 1
0.21277568277911096  
0.787224317220889  

Train_result {'acc': [0.8813333331743877], 'loss': [0.2744956678549449]}
Saved model to disk


12

Epoch 1/1

  64/3000 [..............................] - ETA: 1:22 - loss: 0.2139 - acc: 0.8750
 128/3000 [>.............................] - ETA: 1:17 - loss: 0.2060 - acc: 0.8984
 192/3000 [>.............................] - ETA: 1:11 - loss: 0.2385 - acc: 0.8906
 256/3000 [=>............................] - ETA: 1:09 - loss: 0.2465 - acc: 0.8906
 320/3000 [==>...........................] - ETA: 1:06 - loss: 0.2575 - acc: 0.8906
 384/3000 [==>...........................] - ETA: 1:05 - loss: 0.2580 - acc: 0.8854
 448/3000 [===>..........................] - ETA: 1:02 - loss: 0.2626 - acc: 0.8817
 512/3000 [====>.........................] - ETA: 1:00 - loss: 0.2601 - acc: 0.8789
 576/3000 [====>.........................] - ETA: 59s - loss: 0.2486 - acc: 0.8837 
 640/3000 [=====>........................] - ETA: 58s - loss: 0.2465 - acc: 0.8875
 704/3000 [======>.......................] - ETA: 56s - loss: 0.2564 - acc: 0.8807
 768/3000 [======>.......................] - ETA: 54s - loss: 0.2541 - acc: 0.8815
 832/3000 [=======>......................] - ETA: 52s - loss: 0.2523 - acc: 0.8834
 896/3000 [=======>......................] - ETA: 51s - loss: 0.2449 - acc: 0.8895
 960/3000 [========>.....................] - ETA: 49s - loss: 0.2458 - acc: 0.8875
1024/3000 [=========>....................] - ETA: 47s - loss: 0.2398 - acc: 0.8916
1088/3000 [=========>....................] - ETA: 46s - loss: 0.2323 - acc: 0.8971
1152/3000 [==========>...................] - ETA: 44s - loss: 0.2293 - acc: 0.8993
1216/3000 [===========>..................] - ETA: 43s - loss: 0.2292 - acc: 0.8997
1280/3000 [===========>..................] - ETA: 41s - loss: 0.2299 - acc: 0.8992
1344/3000 [============>.................] - ETA: 39s - loss: 0.2269 - acc: 0.9018
1408/3000 [=============>................] - ETA: 38s - loss: 0.2301 - acc: 0.9006
1472/3000 [=============>................] - ETA: 36s - loss: 0.2334 - acc: 0.8988
1536/3000 [==============>...............] - ETA: 35s - loss: 0.2336 - acc: 0.8991
1600/3000 [===============>..............] - ETA: 33s - loss: 0.2331 - acc: 0.8994
1664/3000 [===============>..............] - ETA: 32s - loss: 0.2299 - acc: 0.9008
1728/3000 [================>.............] - ETA: 30s - loss: 0.2299 - acc: 0.9005
1792/3000 [================>.............] - ETA: 29s - loss: 0.2285 - acc: 0.9001
1856/3000 [=================>............] - ETA: 27s - loss: 0.2269 - acc: 0.9014
1920/3000 [==================>...........] - ETA: 25s - loss: 0.2248 - acc: 0.9026
1984/3000 [==================>...........] - ETA: 24s - loss: 0.2235 - acc: 0.9032
2048/3000 [===================>..........] - ETA: 22s - loss: 0.2223 - acc: 0.9043
2112/3000 [====================>.........] - ETA: 21s - loss: 0.2231 - acc: 0.9039
2176/3000 [====================>.........] - ETA: 19s - loss: 0.2299 - acc: 0.9017
2240/3000 [=====================>........] - ETA: 18s - loss: 0.2289 - acc: 0.9018
2304/3000 [======================>.......] - ETA: 16s - loss: 0.2264 - acc: 0.9032
2368/3000 [======================>.......] - ETA: 15s - loss: 0.2250 - acc: 0.9037
2432/3000 [=======================>......] - ETA: 13s - loss: 0.2303 - acc: 0.9021
2496/3000 [=======================>......] - ETA: 12s - loss: 0.2334 - acc: 0.9010
2560/3000 [========================>.....] - ETA: 10s - loss: 0.2337 - acc: 0.9008
2624/3000 [=========================>....] - ETA: 9s - loss: 0.2372 - acc: 0.9005 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.2409 - acc: 0.8984
2752/3000 [==========================>...] - ETA: 5s - loss: 0.2434 - acc: 0.8968
2816/3000 [===========================>..] - ETA: 4s - loss: 0.2424 - acc: 0.8974
2880/3000 [===========================>..] - ETA: 2s - loss: 0.2429 - acc: 0.8972
2944/3000 [============================>.] - ETA: 1s - loss: 0.2441 - acc: 0.8964
3000/3000 [==============================] - 72s 24ms/step - loss: 0.2453 - acc: 0.8960

Test accuracy: 80.93259464450601

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  8975

choose_one :  8353

F1score :  0.8068288119738073

AUC :  0.8917074345053615

Confusion Matrix
[[7124 1453]
 [1851 6900]]
True label 0
0.8305934475923983  
0.16940655240760172  
True label 1
0.21151868357901954  
0.7884813164209804  

Train_result {'acc': [0.896], 'loss': [0.24531608772277833]}
Saved model to disk


13

Epoch 1/1

  64/3000 [..............................] - ETA: 1:18 - loss: 0.2405 - acc: 0.9062
 128/3000 [>.............................] - ETA: 1:14 - loss: 0.2637 - acc: 0.8828
 192/3000 [>.............................] - ETA: 1:13 - loss: 0.2397 - acc: 0.9062
 256/3000 [=>............................] - ETA: 1:09 - loss: 0.2446 - acc: 0.9062
 320/3000 [==>...........................] - ETA: 1:06 - loss: 0.2369 - acc: 0.9156
 384/3000 [==>...........................] - ETA: 1:04 - loss: 0.2264 - acc: 0.9167
 448/3000 [===>..........................] - ETA: 1:04 - loss: 0.2273 - acc: 0.9174
 512/3000 [====>.........................] - ETA: 1:01 - loss: 0.2277 - acc: 0.9199
 576/3000 [====>.........................] - ETA: 59s - loss: 0.2172 - acc: 0.9253 
 640/3000 [=====>........................] - ETA: 57s - loss: 0.2212 - acc: 0.9203
 704/3000 [======>.......................] - ETA: 56s - loss: 0.2126 - acc: 0.9261
 768/3000 [======>.......................] - ETA: 55s - loss: 0.2070 - acc: 0.9284
 832/3000 [=======>......................] - ETA: 53s - loss: 0.2098 - acc: 0.9291
 896/3000 [=======>......................] - ETA: 51s - loss: 0.2147 - acc: 0.9275
 960/3000 [========>.....................] - ETA: 49s - loss: 0.2187 - acc: 0.9219
1024/3000 [=========>....................] - ETA: 47s - loss: 0.2142 - acc: 0.9229
1088/3000 [=========>....................] - ETA: 46s - loss: 0.2117 - acc: 0.9246
1152/3000 [==========>...................] - ETA: 44s - loss: 0.2128 - acc: 0.9236
1216/3000 [===========>..................] - ETA: 43s - loss: 0.2084 - acc: 0.9252
1280/3000 [===========>..................] - ETA: 42s - loss: 0.2099 - acc: 0.9242
1344/3000 [============>.................] - ETA: 40s - loss: 0.2076 - acc: 0.9256
1408/3000 [=============>................] - ETA: 38s - loss: 0.2060 - acc: 0.9268
1472/3000 [=============>................] - ETA: 36s - loss: 0.2082 - acc: 0.9253
1536/3000 [==============>...............] - ETA: 35s - loss: 0.2096 - acc: 0.9245
1600/3000 [===============>..............] - ETA: 33s - loss: 0.2092 - acc: 0.9231
1664/3000 [===============>..............] - ETA: 32s - loss: 0.2083 - acc: 0.9231
1728/3000 [================>.............] - ETA: 30s - loss: 0.2085 - acc: 0.9230
1792/3000 [================>.............] - ETA: 29s - loss: 0.2071 - acc: 0.9219
1856/3000 [=================>............] - ETA: 27s - loss: 0.2122 - acc: 0.9192
1920/3000 [==================>...........] - ETA: 25s - loss: 0.2128 - acc: 0.9187
1984/3000 [==================>...........] - ETA: 24s - loss: 0.2163 - acc: 0.9153
2048/3000 [===================>..........] - ETA: 22s - loss: 0.2223 - acc: 0.9131
2112/3000 [====================>.........] - ETA: 21s - loss: 0.2235 - acc: 0.9134
2176/3000 [====================>.........] - ETA: 19s - loss: 0.2231 - acc: 0.9127
2240/3000 [=====================>........] - ETA: 18s - loss: 0.2232 - acc: 0.9116
2304/3000 [======================>.......] - ETA: 16s - loss: 0.2241 - acc: 0.9119
2368/3000 [======================>.......] - ETA: 15s - loss: 0.2247 - acc: 0.9122
2432/3000 [=======================>......] - ETA: 13s - loss: 0.2263 - acc: 0.9116
2496/3000 [=======================>......] - ETA: 12s - loss: 0.2302 - acc: 0.9099
2560/3000 [========================>.....] - ETA: 10s - loss: 0.2314 - acc: 0.9094
2624/3000 [=========================>....] - ETA: 9s - loss: 0.2324 - acc: 0.9097 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.2346 - acc: 0.9089
2752/3000 [==========================>...] - ETA: 5s - loss: 0.2373 - acc: 0.9073
2816/3000 [===========================>..] - ETA: 4s - loss: 0.2359 - acc: 0.9084
2880/3000 [===========================>..] - ETA: 2s - loss: 0.2371 - acc: 0.9080
2944/3000 [============================>.] - ETA: 1s - loss: 0.2377 - acc: 0.9073
3000/3000 [==============================] - 72s 24ms/step - loss: 0.2385 - acc: 0.9070

Test accuracy: 81.20960295475531

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  8159

choose_one :  9169

F1score :  0.8183035714285714

AUC :  0.8942056516347832

Confusion Matrix
[[6740 1837]
 [1419 7332]]
True label 0
0.7858225486766934  
0.2141774513233065  
True label 1
0.16215289681179293  
0.8378471031882071  

Train_result {'acc': [0.9069999998410543], 'loss': [0.23847889971733094]}
Saved model to disk


14

Epoch 1/1

  64/3000 [..............................] - ETA: 1:20 - loss: 0.1901 - acc: 0.9219
 128/3000 [>.............................] - ETA: 1:20 - loss: 0.1898 - acc: 0.9141
 192/3000 [>.............................] - ETA: 1:14 - loss: 0.1952 - acc: 0.9167
 256/3000 [=>............................] - ETA: 1:10 - loss: 0.2084 - acc: 0.8906
 320/3000 [==>...........................] - ETA: 1:06 - loss: 0.2085 - acc: 0.8969
 384/3000 [==>...........................] - ETA: 1:05 - loss: 0.2108 - acc: 0.8984
 448/3000 [===>..........................] - ETA: 1:03 - loss: 0.2141 - acc: 0.8973
 512/3000 [====>.........................] - ETA: 1:01 - loss: 0.2081 - acc: 0.9004
 576/3000 [====>.........................] - ETA: 59s - loss: 0.1976 - acc: 0.9097 
 640/3000 [=====>........................] - ETA: 58s - loss: 0.1904 - acc: 0.9156
 704/3000 [======>.......................] - ETA: 57s - loss: 0.1930 - acc: 0.9162
 768/3000 [======>.......................] - ETA: 55s - loss: 0.1856 - acc: 0.9206
 832/3000 [=======>......................] - ETA: 54s - loss: 0.1856 - acc: 0.9207
 896/3000 [=======>......................] - ETA: 53s - loss: 0.1927 - acc: 0.9174
 960/3000 [========>.....................] - ETA: 51s - loss: 0.1908 - acc: 0.9187
1024/3000 [=========>....................] - ETA: 49s - loss: 0.1914 - acc: 0.9189
1088/3000 [=========>....................] - ETA: 47s - loss: 0.1906 - acc: 0.9200
1152/3000 [==========>...................] - ETA: 46s - loss: 0.1921 - acc: 0.9167
1216/3000 [===========>..................] - ETA: 44s - loss: 0.1916 - acc: 0.9169
1280/3000 [===========>..................] - ETA: 42s - loss: 0.1889 - acc: 0.9180
1344/3000 [============>.................] - ETA: 40s - loss: 0.1856 - acc: 0.9189
1408/3000 [=============>................] - ETA: 39s - loss: 0.1828 - acc: 0.9197
1472/3000 [=============>................] - ETA: 37s - loss: 0.1832 - acc: 0.9212
1536/3000 [==============>...............] - ETA: 36s - loss: 0.1871 - acc: 0.9206
1600/3000 [===============>..............] - ETA: 34s - loss: 0.1843 - acc: 0.9225
1664/3000 [===============>..............] - ETA: 33s - loss: 0.1823 - acc: 0.9237
1728/3000 [================>.............] - ETA: 31s - loss: 0.1879 - acc: 0.9213
1792/3000 [================>.............] - ETA: 30s - loss: 0.1854 - acc: 0.9219
1856/3000 [=================>............] - ETA: 28s - loss: 0.1834 - acc: 0.9230
1920/3000 [==================>...........] - ETA: 26s - loss: 0.1819 - acc: 0.9229
1984/3000 [==================>...........] - ETA: 25s - loss: 0.1806 - acc: 0.9239
2048/3000 [===================>..........] - ETA: 23s - loss: 0.1856 - acc: 0.9224
2112/3000 [====================>.........] - ETA: 21s - loss: 0.1847 - acc: 0.9228
2176/3000 [====================>.........] - ETA: 20s - loss: 0.1858 - acc: 0.9219
2240/3000 [=====================>........] - ETA: 18s - loss: 0.1867 - acc: 0.9223
2304/3000 [======================>.......] - ETA: 17s - loss: 0.1879 - acc: 0.9219
2368/3000 [======================>.......] - ETA: 15s - loss: 0.1866 - acc: 0.9227
2432/3000 [=======================>......] - ETA: 13s - loss: 0.1861 - acc: 0.9235
2496/3000 [=======================>......] - ETA: 12s - loss: 0.1861 - acc: 0.9239
2560/3000 [========================>.....] - ETA: 10s - loss: 0.1876 - acc: 0.9234
2624/3000 [=========================>....] - ETA: 9s - loss: 0.1884 - acc: 0.9234 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.1886 - acc: 0.9234
2752/3000 [==========================>...] - ETA: 6s - loss: 0.1919 - acc: 0.9211
2816/3000 [===========================>..] - ETA: 4s - loss: 0.1931 - acc: 0.9194
2880/3000 [===========================>..] - ETA: 2s - loss: 0.1941 - acc: 0.9191
2944/3000 [============================>.] - ETA: 1s - loss: 0.1937 - acc: 0.9188
3000/3000 [==============================] - 72s 24ms/step - loss: 0.1934 - acc: 0.9187

Test accuracy: 79.89958448753463

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  7386

choose_one :  9942

F1score :  0.8136735676456428

AUC :  0.8904301241636277

Confusion Matrix
[[6240 2337]
 [1146 7605]]
True label 0
0.7275271073802029  
0.2724728926197971  
True label 1
0.130956462118615  
0.869043537881385  

Train_result {'acc': [0.9186666663487753], 'loss': [0.19344603514671327]}
Saved model to disk


15

Epoch 1/1

  64/3000 [..............................] - ETA: 1:24 - loss: 0.2522 - acc: 0.8750
 128/3000 [>.............................] - ETA: 1:15 - loss: 0.2142 - acc: 0.9141
 192/3000 [>.............................] - ETA: 1:12 - loss: 0.2088 - acc: 0.9115
 256/3000 [=>............................] - ETA: 1:09 - loss: 0.2193 - acc: 0.9023
 320/3000 [==>...........................] - ETA: 1:09 - loss: 0.2247 - acc: 0.9000
 384/3000 [==>...........................] - ETA: 1:06 - loss: 0.2254 - acc: 0.9089
 448/3000 [===>..........................] - ETA: 1:04 - loss: 0.2229 - acc: 0.9085
 512/3000 [====>.........................] - ETA: 1:02 - loss: 0.2089 - acc: 0.9160
 576/3000 [====>.........................] - ETA: 1:00 - loss: 0.1982 - acc: 0.9219
 640/3000 [=====>........................] - ETA: 58s - loss: 0.1962 - acc: 0.9203 
 704/3000 [======>.......................] - ETA: 56s - loss: 0.1927 - acc: 0.9219
 768/3000 [======>.......................] - ETA: 55s - loss: 0.1922 - acc: 0.9232
 832/3000 [=======>......................] - ETA: 54s - loss: 0.1877 - acc: 0.9243
 896/3000 [=======>......................] - ETA: 52s - loss: 0.1909 - acc: 0.9219
 960/3000 [========>.....................] - ETA: 50s - loss: 0.1885 - acc: 0.9229
1024/3000 [=========>....................] - ETA: 49s - loss: 0.1897 - acc: 0.9229
1088/3000 [=========>....................] - ETA: 47s - loss: 0.1854 - acc: 0.9237
1152/3000 [==========>...................] - ETA: 45s - loss: 0.1821 - acc: 0.9245
1216/3000 [===========>..................] - ETA: 43s - loss: 0.1783 - acc: 0.9260
1280/3000 [===========>..................] - ETA: 42s - loss: 0.1775 - acc: 0.9258
1344/3000 [============>.................] - ETA: 40s - loss: 0.1752 - acc: 0.9278
1408/3000 [=============>................] - ETA: 38s - loss: 0.1773 - acc: 0.9276
1472/3000 [=============>................] - ETA: 37s - loss: 0.1770 - acc: 0.9273
1536/3000 [==============>...............] - ETA: 35s - loss: 0.1831 - acc: 0.9245
1600/3000 [===============>..............] - ETA: 33s - loss: 0.1804 - acc: 0.9244
1664/3000 [===============>..............] - ETA: 32s - loss: 0.1840 - acc: 0.9231
1728/3000 [================>.............] - ETA: 30s - loss: 0.1834 - acc: 0.9230
1792/3000 [================>.............] - ETA: 29s - loss: 0.1847 - acc: 0.9224
1856/3000 [=================>............] - ETA: 27s - loss: 0.1865 - acc: 0.9219
1920/3000 [==================>...........] - ETA: 26s - loss: 0.1870 - acc: 0.9208
1984/3000 [==================>...........] - ETA: 24s - loss: 0.1839 - acc: 0.9229
2048/3000 [===================>..........] - ETA: 22s - loss: 0.1819 - acc: 0.9243
2112/3000 [====================>.........] - ETA: 21s - loss: 0.1815 - acc: 0.9238
2176/3000 [====================>.........] - ETA: 19s - loss: 0.1816 - acc: 0.9246
2240/3000 [=====================>........] - ETA: 18s - loss: 0.1788 - acc: 0.9259
2304/3000 [======================>.......] - ETA: 16s - loss: 0.1776 - acc: 0.9258
2368/3000 [======================>.......] - ETA: 15s - loss: 0.1784 - acc: 0.9257
2432/3000 [=======================>......] - ETA: 13s - loss: 0.1805 - acc: 0.9264
2496/3000 [=======================>......] - ETA: 12s - loss: 0.1802 - acc: 0.9263
2560/3000 [========================>.....] - ETA: 10s - loss: 0.1797 - acc: 0.9270
2624/3000 [=========================>....] - ETA: 9s - loss: 0.1824 - acc: 0.9257 
2688/3000 [=========================>....] - ETA: 7s - loss: 0.1838 - acc: 0.9252
2752/3000 [==========================>...] - ETA: 5s - loss: 0.1842 - acc: 0.9255
2816/3000 [===========================>..] - ETA: 4s - loss: 0.1835 - acc: 0.9258
2880/3000 [===========================>..] - ETA: 2s - loss: 0.1832 - acc: 0.9260
2944/3000 [============================>.] - ETA: 1s - loss: 0.1826 - acc: 0.9263
3000/3000 [==============================] - 72s 24ms/step - loss: 0.1824 - acc: 0.9263

Test accuracy: 81.30193905817174

data size :  20328

zero :  10049

one :  10279

train_zero :  1472

train_one :  1528

test_zero :  8577

test_one :  8751

choose_zero :  9117

choose_one :  8211

F1score :  0.8089847895295367

AUC :  0.8902841424129053

Confusion Matrix
[[7227 1350]
 [1890 6861]]
True label 0
0.8426023084994754  
0.15739769150052466  
True label 1
0.21597531710661638  
0.7840246828933836  

Train_result {'acc': [0.9263333328564962], 'loss': [0.18241372700532277]}
Saved model to disk


[[72.7319944598338, 1], [72.06255771006464, 2], [74.29593721144968, 3], [78.16251154201292, 4], [78.35295475530933, 5], [79.76685133887351, 6], [78.27793167128347, 7], [79.65720221606648, 8], [80.69021237303787, 9], [80.77677746999076, 10], [81.00184672206832, 11], [80.93259464450601, 12], [81.20960295475531, 13], [79.89958448753463, 14], [81.30193905817174, 15]]
max accuracy :  [81.30193905817174, 15]

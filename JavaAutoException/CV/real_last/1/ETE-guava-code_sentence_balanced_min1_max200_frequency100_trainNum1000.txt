Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 21:16:11.374078: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 21:16:11.385176: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 21:16:11.387755: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7592d10 executing computations on platform Host. Devices:
2019-10-14 21:16:11.387794: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

193
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 193, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 23s - loss: 0.6983 - acc: 0.5625
 128/1000 [==>...........................] - ETA: 12s - loss: 0.6845 - acc: 0.6250
 192/1000 [====>.........................] - ETA: 8s - loss: 0.7323 - acc: 0.6042 
 256/1000 [======>.......................] - ETA: 6s - loss: 0.7066 - acc: 0.6055
 320/1000 [========>.....................] - ETA: 5s - loss: 0.6964 - acc: 0.6219
 384/1000 [==========>...................] - ETA: 4s - loss: 0.6805 - acc: 0.6276
 448/1000 [============>.................] - ETA: 3s - loss: 0.6673 - acc: 0.6384
 512/1000 [==============>...............] - ETA: 3s - loss: 0.6604 - acc: 0.6406
 576/1000 [================>.............] - ETA: 2s - loss: 0.6589 - acc: 0.6372
 640/1000 [==================>...........] - ETA: 1s - loss: 0.6476 - acc: 0.6406
 704/1000 [====================>.........] - ETA: 1s - loss: 0.6442 - acc: 0.6420
 768/1000 [======================>.......] - ETA: 1s - loss: 0.6354 - acc: 0.6497
 832/1000 [=======================>......] - ETA: 0s - loss: 0.6291 - acc: 0.6550
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6299 - acc: 0.6540
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6287 - acc: 0.6531
1000/1000 [==============================] - 5s 5ms/step - loss: 0.6259 - acc: 0.6550

Test accuracy: 66.84227502419094

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  4501

choose_one :  14101

F1score :  0.7353244078269826

AUC :  0.8242118460633712

Confusion Matrix
[[3866 5533]
 [ 635 8568]]
True label 0
0.4113203532290669  
0.5886796467709331  
True label 1
0.06899923937846354  
0.9310007606215365  

Train_result {'loss': [0.6258924288749694], 'acc': [0.6549999995231628]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.6551 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 3s - loss: 0.6079 - acc: 0.6797
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5930 - acc: 0.6875
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5807 - acc: 0.6875
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5585 - acc: 0.7063
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5682 - acc: 0.6979
 448/1000 [============>.................] - ETA: 1s - loss: 0.5761 - acc: 0.6853
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5748 - acc: 0.6836
 576/1000 [================>.............] - ETA: 1s - loss: 0.5552 - acc: 0.6979
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5582 - acc: 0.6937
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5503 - acc: 0.7017
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5579 - acc: 0.6927
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5504 - acc: 0.6983
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5525 - acc: 0.6964
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5515 - acc: 0.7010
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5541 - acc: 0.7000

Test accuracy: 74.49199010859047

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7442

choose_one :  11160

F1score :  0.766979325246771

AUC :  0.8492424831238217

Confusion Matrix
[[6048 3351]
 [1394 7809]]
True label 0
0.6434727098627514  
0.35652729013724865  
True label 1
0.15147234597413886  
0.8485276540258612  

Train_result {'loss': [0.554061779499054], 'acc': [0.7000000004768372]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5469 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 3s - loss: 0.5318 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5280 - acc: 0.7292
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5191 - acc: 0.7305
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5284 - acc: 0.7188
 384/1000 [==========>...................] - ETA: 2s - loss: 0.5113 - acc: 0.7318
 448/1000 [============>.................] - ETA: 1s - loss: 0.4982 - acc: 0.7455
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5027 - acc: 0.7441
 576/1000 [================>.............] - ETA: 1s - loss: 0.5095 - acc: 0.7344
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5053 - acc: 0.7406
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5024 - acc: 0.7443
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4945 - acc: 0.7513
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4903 - acc: 0.7548
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4956 - acc: 0.7556
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4974 - acc: 0.7542
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4977 - acc: 0.7560

Test accuracy: 72.65347812063219

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  5656

choose_one :  12946

F1score :  0.770328231522868

AUC :  0.8609848389340283

Confusion Matrix
[[4984 4415]
 [ 672 8531]]
True label 0
0.5302691775720821  
0.46973082242791786  
True label 1
0.07301966749972835  
0.9269803325002717  

Train_result {'loss': [0.4976754946708679], 'acc': [0.7560000004768371]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5508 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 3s - loss: 0.5164 - acc: 0.7734
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5017 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4948 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4846 - acc: 0.7906
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4727 - acc: 0.7917
 448/1000 [============>.................] - ETA: 1s - loss: 0.4622 - acc: 0.8013
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4575 - acc: 0.8047
 576/1000 [================>.............] - ETA: 1s - loss: 0.4556 - acc: 0.8038
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4746 - acc: 0.7922
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4763 - acc: 0.7855
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4711 - acc: 0.7904
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4755 - acc: 0.7897
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4694 - acc: 0.7935
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4644 - acc: 0.7958
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4707 - acc: 0.7910

Test accuracy: 76.1853564132889

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  6899

choose_one :  11703

F1score :  0.7880991103032622

AUC :  0.873223501077128

Confusion Matrix
[[5934 3465]
 [ 965 8238]]
True label 0
0.6313437599744653  
0.36865624002553465  
True label 1
0.10485711181136585  
0.8951428881886342  

Train_result {'loss': [0.47067206287384034], 'acc': [0.7910000004768372]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4652 - acc: 0.7969
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4756 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4587 - acc: 0.7760
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4600 - acc: 0.7734
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4687 - acc: 0.7531
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4607 - acc: 0.7552
 448/1000 [============>.................] - ETA: 1s - loss: 0.4604 - acc: 0.7522
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4604 - acc: 0.7578
 576/1000 [================>.............] - ETA: 1s - loss: 0.4555 - acc: 0.7656
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4533 - acc: 0.7703
 704/1000 [====================>.........] - ETA: 1s - loss: 0.4510 - acc: 0.7699
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4581 - acc: 0.7630
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4568 - acc: 0.7680
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4523 - acc: 0.7712
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4432 - acc: 0.7823
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4413 - acc: 0.7850

Test accuracy: 79.63122244919902

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10622

choose_one :  7980

F1score :  0.7794913577372986

AUC :  0.8813561040482354

Confusion Matrix
[[8116 1283]
 [2506 6697]]
True label 0
0.8634961166081498  
0.13650388339185018  
True label 1
0.2723025100510703  
0.7276974899489297  

Train_result {'loss': [0.44130689096450804], 'acc': [0.7850000009536743]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3262 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3813 - acc: 0.8594
 192/1000 [====>.........................] - ETA: 2s - loss: 0.3408 - acc: 0.8750
 256/1000 [======>.......................] - ETA: 2s - loss: 0.3844 - acc: 0.8438
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3990 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3796 - acc: 0.8542
 448/1000 [============>.................] - ETA: 1s - loss: 0.3736 - acc: 0.8438
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3801 - acc: 0.8398
 576/1000 [================>.............] - ETA: 1s - loss: 0.3934 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3994 - acc: 0.8391
 704/1000 [====================>.........] - ETA: 0s - loss: 0.3909 - acc: 0.8438
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3984 - acc: 0.8372
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3981 - acc: 0.8329
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4061 - acc: 0.8259
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4085 - acc: 0.8250
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4079 - acc: 0.8250

Test accuracy: 78.79797871196645

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  11517

choose_one :  7085

F1score :  0.7578585461689588

AUC :  0.8841816050190732

Confusion Matrix
[[8486  913]
 [3031 6172]]
True label 0
0.9028620065964464  
0.09713799340355357  
True label 1
0.3293491252852331  
0.6706508747147669  

Train_result {'loss': [0.4079128906726837], 'acc': [0.8249999995231628]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3721 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4301 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4828 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4597 - acc: 0.8008
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4428 - acc: 0.8125
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4432 - acc: 0.8021
 448/1000 [============>.................] - ETA: 1s - loss: 0.4440 - acc: 0.8058
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4303 - acc: 0.8105
 576/1000 [================>.............] - ETA: 1s - loss: 0.4266 - acc: 0.8073
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4292 - acc: 0.8063
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4282 - acc: 0.8040
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4182 - acc: 0.8112
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4139 - acc: 0.8101
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4037 - acc: 0.8158
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4021 - acc: 0.8177
1000/1000 [==============================] - 3s 3ms/step - loss: 0.3981 - acc: 0.8200

Test accuracy: 77.41103107192775

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  6735

choose_one :  11867

F1score :  0.8005695301376364

AUC :  0.8879130297892357

Confusion Matrix
[[5966 3433]
 [ 769 8434]]
True label 0
0.6347483774869667  
0.3652516225130333  
True label 1
0.08355970879061175  
0.9164402912093882  

Train_result {'loss': [0.3981331973075867], 'acc': [0.82]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4539 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3639 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 2s - loss: 0.3535 - acc: 0.8646
 256/1000 [======>.......................] - ETA: 2s - loss: 0.3321 - acc: 0.8789
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3517 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3637 - acc: 0.8411
 448/1000 [============>.................] - ETA: 1s - loss: 0.3657 - acc: 0.8348
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3586 - acc: 0.8340
 576/1000 [================>.............] - ETA: 1s - loss: 0.3602 - acc: 0.8351
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3611 - acc: 0.8313
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3566 - acc: 0.8338
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3580 - acc: 0.8307
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3573 - acc: 0.8329
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3598 - acc: 0.8326
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3629 - acc: 0.8313
1000/1000 [==============================] - 3s 3ms/step - loss: 0.3633 - acc: 0.8340

Test accuracy: 80.42683582410494

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10432

choose_one :  8170

F1score :  0.790421919069821

AUC :  0.8883061730762034

Confusion Matrix
[[8095 1304]
 [2337 6866]]
True label 0
0.8612618363655709  
0.1387381636344292  
True label 1
0.25393893295664455  
0.7460610670433554  

Train_result {'loss': [0.3633170657157898], 'acc': [0.8339999990463257]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3157 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3030 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2980 - acc: 0.8906
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2958 - acc: 0.8867
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2864 - acc: 0.8969
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2957 - acc: 0.8880
 448/1000 [============>.................] - ETA: 2s - loss: 0.2950 - acc: 0.8973
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3230 - acc: 0.8809
 576/1000 [================>.............] - ETA: 1s - loss: 0.3324 - acc: 0.8750
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3346 - acc: 0.8734
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3305 - acc: 0.8750
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3355 - acc: 0.8737
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3335 - acc: 0.8726
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3327 - acc: 0.8705
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3371 - acc: 0.8719
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3384 - acc: 0.8710

Test accuracy: 81.78152886786367

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9270

choose_one :  9332

F1score :  0.8171567305098463

AUC :  0.8982864968942934

Confusion Matrix
[[7640 1759]
 [1630 7573]]
True label 0
0.8128524311096925  
0.18714756889030748  
True label 1
0.1771161577746387  
0.8228838422253613  

Train_result {'loss': [0.33836951208114624], 'acc': [0.8710000009536744]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3482 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3339 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 3s - loss: 0.3397 - acc: 0.8438
 256/1000 [======>.......................] - ETA: 2s - loss: 0.3257 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3178 - acc: 0.8531
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3159 - acc: 0.8516
 448/1000 [============>.................] - ETA: 1s - loss: 0.3180 - acc: 0.8504
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3218 - acc: 0.8555
 576/1000 [================>.............] - ETA: 1s - loss: 0.3204 - acc: 0.8576
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3142 - acc: 0.8625
 704/1000 [====================>.........] - ETA: 1s - loss: 0.3031 - acc: 0.8679
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3006 - acc: 0.8698
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2945 - acc: 0.8714
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2922 - acc: 0.8705
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2974 - acc: 0.8688
1000/1000 [==============================] - 4s 4ms/step - loss: 0.3064 - acc: 0.8640

Test accuracy: 78.44855391893346

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  6988

choose_one :  11614

F1score :  0.8074170149397127

AUC :  0.9004134579733912

Confusion Matrix
[[6189 3210]
 [ 799 8404]]
True label 0
0.6584743057772103  
0.34152569422278967  
True label 1
0.08681951537542106  
0.9131804846245789  

Train_result {'loss': [0.30637474822998045], 'acc': [0.864]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3011 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 3s - loss: 0.3105 - acc: 0.8438
 192/1000 [====>.........................] - ETA: 2s - loss: 0.3025 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2890 - acc: 0.8672
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2594 - acc: 0.8812
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2651 - acc: 0.8802
 448/1000 [============>.................] - ETA: 1s - loss: 0.2663 - acc: 0.8817
 512/1000 [==============>...............] - ETA: 1s - loss: 0.2788 - acc: 0.8730
 576/1000 [================>.............] - ETA: 1s - loss: 0.2957 - acc: 0.8681
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2925 - acc: 0.8734
 704/1000 [====================>.........] - ETA: 0s - loss: 0.2864 - acc: 0.8778
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2879 - acc: 0.8763
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2959 - acc: 0.8738
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2982 - acc: 0.8728
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2961 - acc: 0.8719
1000/1000 [==============================] - 3s 3ms/step - loss: 0.2941 - acc: 0.8720

Test accuracy: 81.45898290506398

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9068

choose_one :  9534

F1score :  0.8159257084912206

AUC :  0.8983527635586341

Confusion Matrix
[[7509 1890]
 [1559 7644]]
True label 0
0.7989147781678902  
0.2010852218321098  
True label 1
0.16940128219059003  
0.83059871780941  

Train_result {'loss': [0.29406096482276917], 'acc': [0.872]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.2483 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 3s - loss: 0.2602 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 2s - loss: 0.2484 - acc: 0.9219
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2986 - acc: 0.8828
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3118 - acc: 0.8781
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2926 - acc: 0.8880
 448/1000 [============>.................] - ETA: 1s - loss: 0.2917 - acc: 0.8862
 512/1000 [==============>...............] - ETA: 1s - loss: 0.2969 - acc: 0.8867
 576/1000 [================>.............] - ETA: 1s - loss: 0.2939 - acc: 0.8906
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2935 - acc: 0.8906
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2914 - acc: 0.8892
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2968 - acc: 0.8802
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3005 - acc: 0.8762
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2984 - acc: 0.8750
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3062 - acc: 0.8719
1000/1000 [==============================] - 3s 3ms/step - loss: 0.3049 - acc: 0.8720

Test accuracy: 81.75465003763036

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8643

choose_one :  9959

F1score :  0.82287861392339

AUC :  0.9008581567714594

Confusion Matrix
[[7324 2075]
 [1319 7884]]
True label 0
0.7792318331737419  
0.2207681668262581  
True label 1
0.1433228295121156  
0.8566771704878844  

Train_result {'loss': [0.3048704421520233], 'acc': [0.872]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.2470 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 3s - loss: 0.2381 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2308 - acc: 0.9219
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2427 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2436 - acc: 0.9000
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2574 - acc: 0.8906
 448/1000 [============>.................] - ETA: 1s - loss: 0.2766 - acc: 0.8839
 512/1000 [==============>...............] - ETA: 1s - loss: 0.2708 - acc: 0.8867
 576/1000 [================>.............] - ETA: 1s - loss: 0.2640 - acc: 0.8889
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2592 - acc: 0.8922
 704/1000 [====================>.........] - ETA: 0s - loss: 0.2495 - acc: 0.8977
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2460 - acc: 0.9010
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2482 - acc: 0.8990
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2502 - acc: 0.8962
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2498 - acc: 0.8948
1000/1000 [==============================] - 3s 3ms/step - loss: 0.2503 - acc: 0.8940

Test accuracy: 81.57724975809053

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9762

choose_one :  8840

F1score :  0.8100648450922796

AUC :  0.8979713487313616

Confusion Matrix
[[7867 1532]
 [1895 7308]]
True label 0
0.8370039365889989  
0.16299606341100117  
True label 1
0.2059111159404542  
0.7940888840595458  

Train_result {'loss': [0.250316695690155], 'acc': [0.894]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.2882 - acc: 0.8750
 128/1000 [==>...........................] - ETA: 3s - loss: 0.2895 - acc: 0.8750
 192/1000 [====>.........................] - ETA: 2s - loss: 0.2764 - acc: 0.8854
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2952 - acc: 0.8633
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2839 - acc: 0.8719
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2808 - acc: 0.8802
 448/1000 [============>.................] - ETA: 1s - loss: 0.2781 - acc: 0.8772
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3012 - acc: 0.8672
 576/1000 [================>.............] - ETA: 1s - loss: 0.2955 - acc: 0.8715
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2833 - acc: 0.8812
 704/1000 [====================>.........] - ETA: 0s - loss: 0.2805 - acc: 0.8835
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2776 - acc: 0.8841
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2712 - acc: 0.8858
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2729 - acc: 0.8850
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2763 - acc: 0.8812
1000/1000 [==============================] - 3s 3ms/step - loss: 0.2712 - acc: 0.8850

Test accuracy: 82.23309321578324

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10312

choose_one :  8290

F1score :  0.8110672840564797

AUC :  0.9017722829780326

Confusion Matrix
[[8203 1196]
 [2109 7094]]
True label 0
0.8727524204702628  
0.1272475795297372  
True label 1
0.2291644029120939  
0.7708355970879062  

Train_result {'loss': [0.27123802495002747], 'acc': [0.8850000009536744]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 4s - loss: 0.1492 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 3s - loss: 0.1785 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 3s - loss: 0.2293 - acc: 0.9115
 256/1000 [======>.......................] - ETA: 2s - loss: 0.2278 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 2s - loss: 0.2279 - acc: 0.9187
 384/1000 [==========>...................] - ETA: 2s - loss: 0.2353 - acc: 0.9115
 448/1000 [============>.................] - ETA: 1s - loss: 0.2160 - acc: 0.9196
 512/1000 [==============>...............] - ETA: 1s - loss: 0.2275 - acc: 0.9180
 576/1000 [================>.............] - ETA: 1s - loss: 0.2397 - acc: 0.9115
 640/1000 [==================>...........] - ETA: 1s - loss: 0.2263 - acc: 0.9187
 704/1000 [====================>.........] - ETA: 1s - loss: 0.2259 - acc: 0.9205
 768/1000 [======================>.......] - ETA: 0s - loss: 0.2181 - acc: 0.9245
 832/1000 [=======================>......] - ETA: 0s - loss: 0.2138 - acc: 0.9279
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2188 - acc: 0.9241
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2231 - acc: 0.9208
1000/1000 [==============================] - 3s 3ms/step - loss: 0.2241 - acc: 0.9180

Test accuracy: 80.95366089667777

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  10332

choose_one :  8270

F1score :  0.7972300120185429

AUC :  0.8896139454657491

Confusion Matrix
[[8094 1305]
 [2238 6965]]
True label 0
0.8611554420683052  
0.13884455793169487  
True label 1
0.2431815712267739  
0.7568184287732261  

Train_result {'loss': [0.22408587849140169], 'acc': [0.9180000009536743]}
Saved model to disk


[[66.84227502419094, 1], [74.49199010859047, 2], [72.65347812063219, 3], [76.1853564132889, 4], [79.63122244919902, 5], [78.79797871196645, 6], [77.41103107192775, 7], [80.42683582410494, 8], [81.78152886786367, 9], [78.44855391893346, 10], [81.45898290506398, 11], [81.75465003763036, 12], [81.57724975809053, 13], [82.23309321578324, 14], [80.95366089667777, 15]]
max accuracy :  [82.23309321578324, 14]

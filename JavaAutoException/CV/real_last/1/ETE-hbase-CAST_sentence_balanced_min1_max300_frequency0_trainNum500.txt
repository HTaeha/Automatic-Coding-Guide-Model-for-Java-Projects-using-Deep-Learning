Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-10 13:14:52.300812: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-10 13:14:52.396016: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099840000 Hz
2019-10-10 13:14:52.397928: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xa3c1220 executing computations on platform Host. Devices:
2019-10-10 13:14:52.397964: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

hbase-CAST
After set document size of train data, the number of zero and one label data :  241 259
After set document size of test data, the number of zero and one label data :  9808 10020

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

After balance out data.
hbase-CAST

Sentence length Average : 66

Under 10 : 1960
Over 10, Under 30 : 6663
Over 30, Under 100 : 7615
Over 100, Under 150 : 1826
Over 150, Under 200 : 842
Over 200, Under 400 : 1236
Over 400 : 186

697
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 697, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 697, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

 64/500 [==>...........................] - ETA: 18s - loss: 0.7435 - acc: 0.5938
128/500 [======>.......................] - ETA: 10s - loss: 0.7092 - acc: 0.6094
192/500 [==========>...................] - ETA: 7s - loss: 0.7375 - acc: 0.5833 
256/500 [==============>...............] - ETA: 5s - loss: 0.8680 - acc: 0.5547
320/500 [==================>...........] - ETA: 3s - loss: 0.8278 - acc: 0.5719
384/500 [======================>.......] - ETA: 2s - loss: 0.7915 - acc: 0.5807
448/500 [=========================>....] - ETA: 0s - loss: 0.7825 - acc: 0.5781
500/500 [==============================] - 9s 19ms/step - loss: 0.7644 - acc: 0.5820

Test accuracy: 69.96671373814807

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  8163

choose_one :  11665

F1score :  0.7253862116670509

AUC :  0.7683877300456183

Confusion Matrix
[[6008 3800]
 [2155 7865]]
True label 0
0.6125611745513866  
0.38743882544861336  
True label 1
0.2150698602794411  
0.7849301397205589  

Train_result {'acc': [0.5820000023841858], 'loss': [0.7643684983253479]}
Saved model to disk


2

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.6133 - acc: 0.6406
128/500 [======>.......................] - ETA: 4s - loss: 0.6000 - acc: 0.6484
192/500 [==========>...................] - ETA: 4s - loss: 0.5994 - acc: 0.6667
256/500 [==============>...............] - ETA: 3s - loss: 0.6269 - acc: 0.6602
320/500 [==================>...........] - ETA: 2s - loss: 0.6282 - acc: 0.6594
384/500 [======================>.......] - ETA: 1s - loss: 0.6164 - acc: 0.6693
448/500 [=========================>....] - ETA: 0s - loss: 0.6090 - acc: 0.6763
500/500 [==============================] - 7s 13ms/step - loss: 0.6020 - acc: 0.6880

Test accuracy: 68.87230179544079

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  13002

choose_one :  6826

F1score :  0.633622224860501

AUC :  0.7742063588972137

Confusion Matrix
[[8319 1489]
 [4683 5337]]
True label 0
0.8481851549755302  
0.15181484502446982  
True label 1
0.46736526946107787  
0.5326347305389222  

Train_result {'acc': [0.6880000028610229], 'loss': [0.6019861593246459]}
Saved model to disk


3

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.5513 - acc: 0.7656
128/500 [======>.......................] - ETA: 4s - loss: 0.5848 - acc: 0.7578
192/500 [==========>...................] - ETA: 4s - loss: 0.5891 - acc: 0.7240
256/500 [==============>...............] - ETA: 3s - loss: 0.5884 - acc: 0.7070
320/500 [==================>...........] - ETA: 2s - loss: 0.5889 - acc: 0.6906
384/500 [======================>.......] - ETA: 1s - loss: 0.5836 - acc: 0.6901
448/500 [=========================>....] - ETA: 0s - loss: 0.5747 - acc: 0.7031
500/500 [==============================] - 7s 13ms/step - loss: 0.5877 - acc: 0.6900

Test accuracy: 68.15109945531572

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  6131

choose_one :  13697

F1score :  0.7337352953577603

AUC :  0.7865050689811242

Confusion Matrix
[[4812 4996]
 [1319 8701]]
True label 0
0.49061990212071777  
0.5093800978792822  
True label 1
0.1316367265469062  
0.8683632734530938  

Train_result {'acc': [0.6899999995231628], 'loss': [0.5877092456817627]}
Saved model to disk


4

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.6033 - acc: 0.6562
128/500 [======>.......................] - ETA: 4s - loss: 0.5763 - acc: 0.6562
192/500 [==========>...................] - ETA: 3s - loss: 0.5533 - acc: 0.6771
256/500 [==============>...............] - ETA: 3s - loss: 0.5663 - acc: 0.6836
320/500 [==================>...........] - ETA: 2s - loss: 0.5424 - acc: 0.7031
384/500 [======================>.......] - ETA: 1s - loss: 0.5472 - acc: 0.7031
448/500 [=========================>....] - ETA: 0s - loss: 0.5282 - acc: 0.7232
500/500 [==============================] - 6s 12ms/step - loss: 0.5327 - acc: 0.7260

Test accuracy: 72.332055678838

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  9500

choose_one :  10328

F1score :  0.7303911932376645

AUC :  0.7926330098774719

Confusion Matrix
[[6911 2897]
 [2589 7431]]
True label 0
0.7046288743882545  
0.2953711256117455  
True label 1
0.25838323353293413  
0.7416167664670659  

Train_result {'acc': [0.726], 'loss': [0.5326649436950683]}
Saved model to disk


5

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3949 - acc: 0.8281
128/500 [======>.......................] - ETA: 4s - loss: 0.4046 - acc: 0.8203
192/500 [==========>...................] - ETA: 3s - loss: 0.4654 - acc: 0.7760
256/500 [==============>...............] - ETA: 2s - loss: 0.4834 - acc: 0.7812
320/500 [==================>...........] - ETA: 2s - loss: 0.4994 - acc: 0.7625
384/500 [======================>.......] - ETA: 1s - loss: 0.5086 - acc: 0.7552
448/500 [=========================>....] - ETA: 0s - loss: 0.5085 - acc: 0.7500
500/500 [==============================] - 6s 13ms/step - loss: 0.5164 - acc: 0.7500

Test accuracy: 72.2866653217672

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  10335

choose_one :  9493

F1score :  0.7183928662942655

AUC :  0.7935284559347863

Confusion Matrix
[[7324 2484]
 [3011 7009]]
True label 0
0.7467373572593801  
0.2532626427406199  
True label 1
0.300499001996008  
0.699500998003992  

Train_result {'acc': [0.75], 'loss': [0.5163989691734314]}
Saved model to disk


6

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.4626 - acc: 0.8594
128/500 [======>.......................] - ETA: 4s - loss: 0.5358 - acc: 0.7812
192/500 [==========>...................] - ETA: 3s - loss: 0.5259 - acc: 0.7656
256/500 [==============>...............] - ETA: 3s - loss: 0.5276 - acc: 0.7461
320/500 [==================>...........] - ETA: 2s - loss: 0.5230 - acc: 0.7375
384/500 [======================>.......] - ETA: 1s - loss: 0.5326 - acc: 0.7292
448/500 [=========================>....] - ETA: 0s - loss: 0.5214 - acc: 0.7366
500/500 [==============================] - 6s 12ms/step - loss: 0.5168 - acc: 0.7460

Test accuracy: 67.86867056687512

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  13529

choose_one :  6299

F1score :  0.6095961762362891

AUC :  0.7914411134907998

Confusion Matrix
[[8483 1325]
 [5046 4974]]
True label 0
0.8649061990212071  
0.1350938009787928  
True label 1
0.5035928143712575  
0.49640718562874253  

Train_result {'acc': [0.7459999995231629], 'loss': [0.5168040468692779]}
Saved model to disk


7

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.6109 - acc: 0.6250
128/500 [======>.......................] - ETA: 4s - loss: 0.5475 - acc: 0.7031
192/500 [==========>...................] - ETA: 4s - loss: 0.4945 - acc: 0.7604
256/500 [==============>...............] - ETA: 3s - loss: 0.5262 - acc: 0.7461
320/500 [==================>...........] - ETA: 2s - loss: 0.5150 - acc: 0.7594
384/500 [======================>.......] - ETA: 1s - loss: 0.5192 - acc: 0.7578
448/500 [=========================>....] - ETA: 0s - loss: 0.4978 - acc: 0.7768
500/500 [==============================] - 6s 13ms/step - loss: 0.5093 - acc: 0.7680

Test accuracy: 73.0028242888844

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  10409

choose_one :  9419

F1score :  0.7246257523535161

AUC :  0.8033522219427377

Confusion Matrix
[[7432 2376]
 [2977 7043]]
True label 0
0.7577487765089723  
0.24225122349102773  
True label 1
0.2971057884231537  
0.7028942115768463  

Train_result {'acc': [0.7680000019073486], 'loss': [0.5092553305625915]}
Saved model to disk


8

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3930 - acc: 0.7812
128/500 [======>.......................] - ETA: 4s - loss: 0.4327 - acc: 0.7734
192/500 [==========>...................] - ETA: 3s - loss: 0.4690 - acc: 0.7656
256/500 [==============>...............] - ETA: 3s - loss: 0.4546 - acc: 0.7773
320/500 [==================>...........] - ETA: 2s - loss: 0.4758 - acc: 0.7594
384/500 [======================>.......] - ETA: 1s - loss: 0.4782 - acc: 0.7552
448/500 [=========================>....] - ETA: 0s - loss: 0.4723 - acc: 0.7612
500/500 [==============================] - 6s 13ms/step - loss: 0.4771 - acc: 0.7600

Test accuracy: 70.89469437159572

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  12399

choose_one :  7429

F1score :  0.6692647143102757

AUC :  0.8032668451840201

Confusion Matrix
[[8218 1590]
 [4181 5839]]
True label 0
0.8378874388254486  
0.1621125611745514  
True label 1
0.4172654690618762  
0.5827345309381238  

Train_result {'acc': [0.76], 'loss': [0.4770793046951294]}
Saved model to disk


9

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.4847 - acc: 0.8125
128/500 [======>.......................] - ETA: 4s - loss: 0.4644 - acc: 0.7891
192/500 [==========>...................] - ETA: 3s - loss: 0.4636 - acc: 0.7760
256/500 [==============>...............] - ETA: 3s - loss: 0.4881 - acc: 0.7695
320/500 [==================>...........] - ETA: 2s - loss: 0.5093 - acc: 0.7531
384/500 [======================>.......] - ETA: 1s - loss: 0.5012 - acc: 0.7526
448/500 [=========================>....] - ETA: 0s - loss: 0.4857 - acc: 0.7589
500/500 [==============================] - 6s 13ms/step - loss: 0.4800 - acc: 0.7640

Test accuracy: 73.59289893080492

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  8570

choose_one :  11258

F1score :  0.753924241000094

AUC :  0.8116404120795929

Confusion Matrix
[[6571 3237]
 [1999 8021]]
True label 0
0.669963295269168  
0.33003670473083196  
True label 1
0.19950099800399201  
0.800499001996008  

Train_result {'acc': [0.7639999980926514], 'loss': [0.48003481578826906]}
Saved model to disk


10

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3813 - acc: 0.8438
128/500 [======>.......................] - ETA: 4s - loss: 0.4168 - acc: 0.8125
192/500 [==========>...................] - ETA: 3s - loss: 0.4665 - acc: 0.7812
256/500 [==============>...............] - ETA: 3s - loss: 0.4632 - acc: 0.7891
320/500 [==================>...........] - ETA: 2s - loss: 0.4629 - acc: 0.7969
384/500 [======================>.......] - ETA: 1s - loss: 0.4512 - acc: 0.7995
448/500 [=========================>....] - ETA: 0s - loss: 0.4549 - acc: 0.7879
500/500 [==============================] - 6s 13ms/step - loss: 0.4519 - acc: 0.7860

Test accuracy: 73.58281218478919

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  10018

choose_one :  9810

F1score :  0.7358547655068078

AUC :  0.8096895727305584

Confusion Matrix
[[7294 2514]
 [2724 7296]]
True label 0
0.7436786296900489  
0.25632137030995106  
True label 1
0.2718562874251497  
0.7281437125748503  

Train_result {'acc': [0.7860000014305115], 'loss': [0.4519258458614349]}
Saved model to disk


11

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3504 - acc: 0.8438
128/500 [======>.......................] - ETA: 4s - loss: 0.3738 - acc: 0.8438
192/500 [==========>...................] - ETA: 4s - loss: 0.3829 - acc: 0.8438
256/500 [==============>...............] - ETA: 3s - loss: 0.3988 - acc: 0.8164
320/500 [==================>...........] - ETA: 2s - loss: 0.4219 - acc: 0.8063
384/500 [======================>.......] - ETA: 1s - loss: 0.4534 - acc: 0.8021
448/500 [=========================>....] - ETA: 0s - loss: 0.4422 - acc: 0.8036
500/500 [==============================] - 6s 13ms/step - loss: 0.4489 - acc: 0.7940

Test accuracy: 73.73915674803308

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  8527

choose_one :  11301

F1score :  0.7557806857089254

AUC :  0.8150733606197067

Confusion Matrix
[[6564 3244]
 [1963 8057]]
True label 0
0.6692495921696574  
0.3307504078303426  
True label 1
0.19590818363273452  
0.8040918163672655  

Train_result {'acc': [0.7939999971389771], 'loss': [0.44894273281097413]}
Saved model to disk


12

Epoch 1/1

 64/500 [==>...........................] - ETA: 6s - loss: 0.5214 - acc: 0.7500
128/500 [======>.......................] - ETA: 5s - loss: 0.5332 - acc: 0.7578
192/500 [==========>...................] - ETA: 4s - loss: 0.4544 - acc: 0.7969
256/500 [==============>...............] - ETA: 3s - loss: 0.4248 - acc: 0.8008
320/500 [==================>...........] - ETA: 2s - loss: 0.4173 - acc: 0.8031
384/500 [======================>.......] - ETA: 1s - loss: 0.4250 - acc: 0.7943
448/500 [=========================>....] - ETA: 0s - loss: 0.4520 - acc: 0.7790
500/500 [==============================] - 6s 12ms/step - loss: 0.4479 - acc: 0.7820

Test accuracy: 73.67863627193867

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  8077

choose_one :  11751

F1score :  0.7602774332828074

AUC :  0.8164646034195882

Confusion Matrix
[[6333 3475]
 [1744 8276]]
True label 0
0.6456973898858075  
0.3543026101141925  
True label 1
0.17405189620758482  
0.8259481037924151  

Train_result {'acc': [0.7819999980926514], 'loss': [0.4478715691566467]}
Saved model to disk


13

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3837 - acc: 0.8281
128/500 [======>.......................] - ETA: 4s - loss: 0.3819 - acc: 0.8125
192/500 [==========>...................] - ETA: 3s - loss: 0.3619 - acc: 0.8281
256/500 [==============>...............] - ETA: 2s - loss: 0.3836 - acc: 0.8125
320/500 [==================>...........] - ETA: 2s - loss: 0.3999 - acc: 0.8031
384/500 [======================>.......] - ETA: 1s - loss: 0.3965 - acc: 0.8073
448/500 [=========================>....] - ETA: 0s - loss: 0.3923 - acc: 0.8214
500/500 [==============================] - 6s 12ms/step - loss: 0.3881 - acc: 0.8200

Test accuracy: 73.5021182166633

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  7958

choose_one :  11870

F1score :  0.7599817268158977

AUC :  0.818046324764826

Confusion Matrix
[[6256 3552]
 [1702 8318]]
True label 0
0.6378466557911908  
0.3621533442088091  
True label 1
0.16986027944111776  
0.8301397205588822  

Train_result {'acc': [0.8199999980926513], 'loss': [0.388146906375885]}
Saved model to disk


14

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.2618 - acc: 0.8906
128/500 [======>.......................] - ETA: 4s - loss: 0.3541 - acc: 0.8359
192/500 [==========>...................] - ETA: 4s - loss: 0.3839 - acc: 0.8281
256/500 [==============>...............] - ETA: 3s - loss: 0.3765 - acc: 0.8281
320/500 [==================>...........] - ETA: 2s - loss: 0.4161 - acc: 0.8187
384/500 [======================>.......] - ETA: 1s - loss: 0.4049 - acc: 0.8281
448/500 [=========================>....] - ETA: 0s - loss: 0.4045 - acc: 0.8281
500/500 [==============================] - 6s 13ms/step - loss: 0.3926 - acc: 0.8320

Test accuracy: 74.75791809562236

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  9541

choose_one :  10287

F1score :  0.7535332643915892

AUC :  0.8192210247124022

Confusion Matrix
[[7172 2636]
 [2369 7651]]
True label 0
0.7312398042414355  
0.2687601957585644  
True label 1
0.23642714570858284  
0.7635728542914172  

Train_result {'acc': [0.8320000023841858], 'loss': [0.39257189679145815]}
Saved model to disk


15

Epoch 1/1

 64/500 [==>...........................] - ETA: 5s - loss: 0.3578 - acc: 0.8125
128/500 [======>.......................] - ETA: 4s - loss: 0.3274 - acc: 0.8438
192/500 [==========>...................] - ETA: 3s - loss: 0.3635 - acc: 0.8333
256/500 [==============>...............] - ETA: 3s - loss: 0.3508 - acc: 0.8398
320/500 [==================>...........] - ETA: 2s - loss: 0.3547 - acc: 0.8375
384/500 [======================>.......] - ETA: 1s - loss: 0.3693 - acc: 0.8281
448/500 [=========================>....] - ETA: 0s - loss: 0.3620 - acc: 0.8326
500/500 [==============================] - 6s 13ms/step - loss: 0.3561 - acc: 0.8380

Test accuracy: 73.99636877143433

data size :  20328

zero :  10049

one :  10279

train_zero :  241

train_one :  259

test_zero :  9808

test_one :  10020

choose_zero :  9856

choose_one :  9972

F1score :  0.742096838735494

AUC :  0.8147288416641432

Confusion Matrix
[[7254 2554]
 [2602 7418]]
True label 0
0.7396003262642741  
0.2603996737357259  
True label 1
0.25968063872255487  
0.7403193612774451  

Train_result {'acc': [0.8379999976158142], 'loss': [0.35609719848632815]}
Saved model to disk


[[69.96671373814807, 1], [68.87230179544079, 2], [68.15109945531572, 3], [72.332055678838, 4], [72.2866653217672, 5], [67.86867056687512, 6], [73.0028242888844, 7], [70.89469437159572, 8], [73.59289893080492, 9], [73.58281218478919, 10], [73.73915674803308, 11], [73.67863627193867, 12], [73.5021182166633, 13], [74.75791809562236, 14], [73.99636877143433, 15]]
max accuracy :  [74.75791809562236, 14]

Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 19:17:49.570931: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 19:17:49.581642: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 19:17:49.584083: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x89dbb70 executing computations on platform Host. Devices:
2019-10-14 19:17:49.584120: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10792
one :  10820

glassfish-code
After set document size of train data, the number of zero and one label data :  504 496
After set document size of test data, the number of zero and one label data :  10288 10324

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
glassfish-code

Sentence length Average : 31

Under 10 : 5630
Over 10, Under 30 : 8221
Over 30, Under 100 : 6586
Over 100, Under 150 : 962
Over 150, Under 200 : 213
Over 200, Under 400 : 0
Over 400 : 0

175
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 175, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 175, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 25s - loss: 0.7572 - acc: 0.5312
 128/1000 [==>...........................] - ETA: 13s - loss: 0.7356 - acc: 0.5391
 192/1000 [====>.........................] - ETA: 9s - loss: 0.7357 - acc: 0.5677 
 256/1000 [======>.......................] - ETA: 6s - loss: 0.7290 - acc: 0.5625
 320/1000 [========>.....................] - ETA: 5s - loss: 0.7316 - acc: 0.5531
 384/1000 [==========>...................] - ETA: 4s - loss: 0.7134 - acc: 0.5651
 448/1000 [============>.................] - ETA: 3s - loss: 0.7045 - acc: 0.5737
 512/1000 [==============>...............] - ETA: 2s - loss: 0.7018 - acc: 0.5703
 576/1000 [================>.............] - ETA: 2s - loss: 0.7020 - acc: 0.5608
 640/1000 [==================>...........] - ETA: 1s - loss: 0.6939 - acc: 0.5703
 704/1000 [====================>.........] - ETA: 1s - loss: 0.6927 - acc: 0.5724
 768/1000 [======================>.......] - ETA: 1s - loss: 0.7042 - acc: 0.5625
 832/1000 [=======================>......] - ETA: 0s - loss: 0.7030 - acc: 0.5625
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6984 - acc: 0.5692
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6928 - acc: 0.5729
1000/1000 [==============================] - 5s 5ms/step - loss: 0.6920 - acc: 0.5770

Test accuracy: 59.41684455656899

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  4193

choose_one :  16419

F1score :  0.6872078674793404

AUC :  0.7011659235332008

Confusion Matrix
[[3058 7230]
 [1135 9189]]
True label 0
0.29723950233281493  
0.7027604976671851  
True label 1
0.10993800852382797  
0.890061991476172  

Train_result {'acc': [0.5770000004768372], 'loss': [0.6919943928718567]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.6216 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 2s - loss: 0.6237 - acc: 0.6328
 192/1000 [====>.........................] - ETA: 2s - loss: 0.6128 - acc: 0.6510
 256/1000 [======>.......................] - ETA: 2s - loss: 0.6249 - acc: 0.6445
 320/1000 [========>.....................] - ETA: 2s - loss: 0.6354 - acc: 0.6344
 384/1000 [==========>...................] - ETA: 1s - loss: 0.6342 - acc: 0.6328
 448/1000 [============>.................] - ETA: 1s - loss: 0.6362 - acc: 0.6295
 512/1000 [==============>...............] - ETA: 1s - loss: 0.6440 - acc: 0.6094
 576/1000 [================>.............] - ETA: 1s - loss: 0.6370 - acc: 0.6215
 640/1000 [==================>...........] - ETA: 1s - loss: 0.6293 - acc: 0.6281
 704/1000 [====================>.........] - ETA: 0s - loss: 0.6278 - acc: 0.6264
 768/1000 [======================>.......] - ETA: 0s - loss: 0.6262 - acc: 0.6276
 832/1000 [=======================>......] - ETA: 0s - loss: 0.6229 - acc: 0.6310
 896/1000 [=========================>....] - ETA: 0s - loss: 0.6238 - acc: 0.6272
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6219 - acc: 0.6312
1000/1000 [==============================] - 3s 3ms/step - loss: 0.6219 - acc: 0.6340

Test accuracy: 65.53464001552494

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12684

choose_one :  7928

F1score :  0.6107823800131493

AUC :  0.7250977871775621

Confusion Matrix
[[7934 2354]
 [4750 5574]]
True label 0
0.7711897356143079  
0.22881026438569207  
True label 1
0.46009298721425806  
0.5399070127857419  

Train_result {'acc': [0.6339999995231629], 'loss': [0.6219269709587097]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5737 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 2s - loss: 0.5769 - acc: 0.6875
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5696 - acc: 0.6927
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5745 - acc: 0.6758
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5798 - acc: 0.6844
 384/1000 [==========>...................] - ETA: 1s - loss: 0.5818 - acc: 0.6823
 448/1000 [============>.................] - ETA: 1s - loss: 0.5806 - acc: 0.6786
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5896 - acc: 0.6738
 576/1000 [================>.............] - ETA: 1s - loss: 0.5913 - acc: 0.6719
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5872 - acc: 0.6703
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5895 - acc: 0.6634
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5879 - acc: 0.6654
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5901 - acc: 0.6635
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5940 - acc: 0.6618
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5945 - acc: 0.6625
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5978 - acc: 0.6600

Test accuracy: 67.43159324665243

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  9297

choose_one :  11315

F1score :  0.6897730948749943

AUC :  0.744555762464125

Confusion Matrix
[[6436 3852]
 [2861 7463]]
True label 0
0.6255832037325039  
0.37441679626749613  
True label 1
0.2771212708252615  
0.7228787291747385  

Train_result {'acc': [0.6600000009536743], 'loss': [0.5977843894958496]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.6300 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 2s - loss: 0.6058 - acc: 0.6562
 192/1000 [====>.........................] - ETA: 2s - loss: 0.6311 - acc: 0.6302
 256/1000 [======>.......................] - ETA: 2s - loss: 0.6235 - acc: 0.6367
 320/1000 [========>.....................] - ETA: 2s - loss: 0.6294 - acc: 0.6375
 384/1000 [==========>...................] - ETA: 1s - loss: 0.6276 - acc: 0.6484
 448/1000 [============>.................] - ETA: 1s - loss: 0.6173 - acc: 0.6540
 512/1000 [==============>...............] - ETA: 1s - loss: 0.6099 - acc: 0.6562
 576/1000 [================>.............] - ETA: 1s - loss: 0.6194 - acc: 0.6458
 640/1000 [==================>...........] - ETA: 1s - loss: 0.6087 - acc: 0.6562
 704/1000 [====================>.........] - ETA: 0s - loss: 0.6066 - acc: 0.6577
 768/1000 [======================>.......] - ETA: 0s - loss: 0.6042 - acc: 0.6641
 832/1000 [=======================>......] - ETA: 0s - loss: 0.6003 - acc: 0.6647
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5940 - acc: 0.6708
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5898 - acc: 0.6771
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5936 - acc: 0.6720

Test accuracy: 63.094313991849404

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  4977

choose_one :  15635

F1score :  0.7069609769251514

AUC :  0.7481395128701005

Confusion Matrix
[[3829 6459]
 [1148 9176]]
True label 0
0.37218118195956457  
0.6278188180404355  
True label 1
0.11119721038357226  
0.8888027896164278  

Train_result {'acc': [0.6720000004768372], 'loss': [0.5936106462478637]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5001 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 2s - loss: 0.4992 - acc: 0.7578
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4957 - acc: 0.7656
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5172 - acc: 0.7344
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5189 - acc: 0.7344
 384/1000 [==========>...................] - ETA: 1s - loss: 0.5084 - acc: 0.7552
 448/1000 [============>.................] - ETA: 1s - loss: 0.5117 - acc: 0.7455
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5120 - acc: 0.7422
 576/1000 [================>.............] - ETA: 1s - loss: 0.5259 - acc: 0.7361
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5324 - acc: 0.7281
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5324 - acc: 0.7315
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5357 - acc: 0.7279
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5380 - acc: 0.7260
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5392 - acc: 0.7232
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5406 - acc: 0.7271
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5445 - acc: 0.7270

Test accuracy: 69.14903939452745

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12681

choose_one :  7931

F1score :  0.6516570802519858

AUC :  0.7709183007116849

Confusion Matrix
[[8305 1983]
 [4376 5948]]
True label 0
0.807251166407465  
0.192748833592535  
True label 1
0.42386671832623013  
0.5761332816737699  

Train_result {'acc': [0.7270000009536743], 'loss': [0.5444895639419556]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5403 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4863 - acc: 0.7734
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5029 - acc: 0.7604
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5140 - acc: 0.7578
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5118 - acc: 0.7625
 384/1000 [==========>...................] - ETA: 1s - loss: 0.5154 - acc: 0.7656
 448/1000 [============>.................] - ETA: 1s - loss: 0.5093 - acc: 0.7746
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5202 - acc: 0.7637
 576/1000 [================>.............] - ETA: 1s - loss: 0.5188 - acc: 0.7604
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5086 - acc: 0.7703
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5103 - acc: 0.7642
 768/1000 [======================>.......] - ETA: 0s - loss: 0.5097 - acc: 0.7656
 832/1000 [=======================>......] - ETA: 0s - loss: 0.5087 - acc: 0.7656
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5145 - acc: 0.7600
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5251 - acc: 0.7521
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5278 - acc: 0.7470

Test accuracy: 68.29516786338056

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  7497

choose_one :  13115

F1score :  0.7211911770979991

AUC :  0.7737564854394146

Confusion Matrix
[[5625 4663]
 [1872 8452]]
True label 0
0.546753499222395  
0.453246500777605  
True label 1
0.18132506780317706  
0.818674932196823  

Train_result {'acc': [0.747], 'loss': [0.5278218460083007]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4989 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 2s - loss: 0.4905 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4606 - acc: 0.7812
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4558 - acc: 0.7852
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4807 - acc: 0.7719
 384/1000 [==========>...................] - ETA: 1s - loss: 0.5064 - acc: 0.7552
 448/1000 [============>.................] - ETA: 1s - loss: 0.5133 - acc: 0.7567
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5099 - acc: 0.7598
 576/1000 [================>.............] - ETA: 1s - loss: 0.5130 - acc: 0.7569
 640/1000 [==================>...........] - ETA: 1s - loss: 0.5039 - acc: 0.7641
 704/1000 [====================>.........] - ETA: 0s - loss: 0.5007 - acc: 0.7713
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4999 - acc: 0.7734
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4984 - acc: 0.7776
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5022 - acc: 0.7746
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5071 - acc: 0.7688
1000/1000 [==============================] - 3s 3ms/step - loss: 0.5067 - acc: 0.7670

Test accuracy: 68.15447312245294

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  6586

choose_one :  14026

F1score :  0.7304312114989734

AUC :  0.7774473740165451

Confusion Matrix
[[5155 5133]
 [1431 8893]]
True label 0
0.5010692068429238  
0.4989307931570762  
True label 1
0.13860906625339015  
0.8613909337466098  

Train_result {'acc': [0.7670000009536743], 'loss': [0.5066573023796082]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.5274 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 2s - loss: 0.4701 - acc: 0.7812
 192/1000 [====>.........................] - ETA: 2s - loss: 0.5433 - acc: 0.7240
 256/1000 [======>.......................] - ETA: 2s - loss: 0.5318 - acc: 0.7148
 320/1000 [========>.....................] - ETA: 2s - loss: 0.5319 - acc: 0.7094
 384/1000 [==========>...................] - ETA: 1s - loss: 0.5177 - acc: 0.7214
 448/1000 [============>.................] - ETA: 1s - loss: 0.5072 - acc: 0.7344
 512/1000 [==============>...............] - ETA: 1s - loss: 0.5036 - acc: 0.7363
 576/1000 [================>.............] - ETA: 1s - loss: 0.4944 - acc: 0.7500
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4902 - acc: 0.7516
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4973 - acc: 0.7472
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4999 - acc: 0.7500
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4943 - acc: 0.7560
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4981 - acc: 0.7533
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5023 - acc: 0.7510
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4994 - acc: 0.7520

Test accuracy: 71.78342712982729

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10546

choose_one :  10066

F1score :  0.7147621383030898

AUC :  0.7923842681791149

Confusion Matrix
[[7509 2779]
 [3037 7287]]
True label 0
0.7298794712286159  
0.27012052877138415  
True label 1
0.2941689267725688  
0.7058310732274312  

Train_result {'acc': [0.7519999990463256], 'loss': [0.4994431555271149]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4206 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 2s - loss: 0.4312 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4328 - acc: 0.7969
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4399 - acc: 0.7852
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4466 - acc: 0.7812
 384/1000 [==========>...................] - ETA: 1s - loss: 0.4546 - acc: 0.7786
 448/1000 [============>.................] - ETA: 1s - loss: 0.4469 - acc: 0.7879
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4420 - acc: 0.8008
 576/1000 [================>.............] - ETA: 1s - loss: 0.4430 - acc: 0.8056
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4418 - acc: 0.8063
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4485 - acc: 0.8011
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4572 - acc: 0.7956
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4615 - acc: 0.7957
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4667 - acc: 0.7891
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4670 - acc: 0.7854
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4743 - acc: 0.7810

Test accuracy: 69.18785173685232

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  6869

choose_one :  13743

F1score :  0.7361116882037646

AUC :  0.7916378881020112

Confusion Matrix
[[5403 4885]
 [1466 8858]]
True label 0
0.5251749611197511  
0.47482503888024885  
True label 1
0.14199922510654786  
0.8580007748934522  

Train_result {'acc': [0.7810000004768372], 'loss': [0.47432096338272095]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4574 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4255 - acc: 0.8203
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4172 - acc: 0.8229
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4244 - acc: 0.8125
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4385 - acc: 0.8094
 384/1000 [==========>...................] - ETA: 1s - loss: 0.4400 - acc: 0.7995
 448/1000 [============>.................] - ETA: 1s - loss: 0.4455 - acc: 0.7969
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4397 - acc: 0.8027
 576/1000 [================>.............] - ETA: 1s - loss: 0.4426 - acc: 0.7951
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4573 - acc: 0.7875
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4540 - acc: 0.7884
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4507 - acc: 0.7917
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4493 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4558 - acc: 0.7835
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4575 - acc: 0.7802
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4661 - acc: 0.7770

Test accuracy: 68.33883174849602

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  14982

choose_one :  5630

F1score :  0.5909489783126488

AUC :  0.7857076662857476

Confusion Matrix
[[9372  916]
 [5610 4714]]
True label 0
0.9109642301710731  
0.0890357698289269  
True label 1
0.5433940333204185  
0.45660596667958153  

Train_result {'acc': [0.7769999995231628], 'loss': [0.4660821061134338]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4264 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4234 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 3s - loss: 0.4415 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4744 - acc: 0.7578
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4638 - acc: 0.7812
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4602 - acc: 0.7812
 448/1000 [============>.................] - ETA: 1s - loss: 0.4659 - acc: 0.7790
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4630 - acc: 0.7812
 576/1000 [================>.............] - ETA: 1s - loss: 0.4587 - acc: 0.7830
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4530 - acc: 0.7844
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4520 - acc: 0.7827
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4497 - acc: 0.7878
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4435 - acc: 0.7909
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4420 - acc: 0.7924
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4379 - acc: 0.7969
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4384 - acc: 0.7950

Test accuracy: 71.34678827867262

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  12296

choose_one :  8316

F1score :  0.6831545064377683

AUC :  0.7954252852975718

Confusion Matrix
[[8339 1949]
 [3957 6367]]
True label 0
0.8105559875583204  
0.18944401244167963  
True label 1
0.38328167376985667  
0.6167183262301433  

Train_result {'acc': [0.795], 'loss': [0.43835891771316526]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4644 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 3s - loss: 0.4956 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4928 - acc: 0.7396
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4854 - acc: 0.7500
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4728 - acc: 0.7562
 384/1000 [==========>...................] - ETA: 2s - loss: 0.4868 - acc: 0.7526
 448/1000 [============>.................] - ETA: 1s - loss: 0.4790 - acc: 0.7567
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4764 - acc: 0.7598
 576/1000 [================>.............] - ETA: 1s - loss: 0.4706 - acc: 0.7691
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4654 - acc: 0.7719
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4570 - acc: 0.7784
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4543 - acc: 0.7799
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4535 - acc: 0.7812
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4510 - acc: 0.7846
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4565 - acc: 0.7792
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4499 - acc: 0.7840

Test accuracy: 73.02057054143218

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10877

choose_one :  9735

F1score :  0.7227678348870831

AUC :  0.7986572153968798

Confusion Matrix
[[7802 2486]
 [3075 7249]]
True label 0
0.7583592534992224  
0.2416407465007776  
True label 1
0.29784967067028284  
0.7021503293297172  

Train_result {'acc': [0.7839999990463257], 'loss': [0.4499289469718933]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3710 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 2s - loss: 0.3403 - acc: 0.8828
 192/1000 [====>.........................] - ETA: 2s - loss: 0.3343 - acc: 0.8490
 256/1000 [======>.......................] - ETA: 2s - loss: 0.3379 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3637 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 2s - loss: 0.3668 - acc: 0.8281
 448/1000 [============>.................] - ETA: 1s - loss: 0.3877 - acc: 0.8147
 512/1000 [==============>...............] - ETA: 1s - loss: 0.3961 - acc: 0.8145
 576/1000 [================>.............] - ETA: 1s - loss: 0.4007 - acc: 0.8108
 640/1000 [==================>...........] - ETA: 1s - loss: 0.3975 - acc: 0.8094
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4015 - acc: 0.8068
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4054 - acc: 0.8047
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4160 - acc: 0.7993
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4226 - acc: 0.7935
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4196 - acc: 0.7937
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4181 - acc: 0.7970

Test accuracy: 72.8410634581797

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10084

choose_one :  10528

F1score :  0.7315365432572415

AUC :  0.7991284510551747

Confusion Matrix
[[7387 2901]
 [2697 7627]]
True label 0
0.7180209953343701  
0.28197900466562986  
True label 1
0.2612359550561798  
0.7387640449438202  

Train_result {'acc': [0.797], 'loss': [0.41808800864219664]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.3777 - acc: 0.8281
 128/1000 [==>...........................] - ETA: 2s - loss: 0.4542 - acc: 0.8125
 192/1000 [====>.........................] - ETA: 2s - loss: 0.4215 - acc: 0.8125
 256/1000 [======>.......................] - ETA: 2s - loss: 0.4346 - acc: 0.7930
 320/1000 [========>.....................] - ETA: 2s - loss: 0.4283 - acc: 0.7969
 384/1000 [==========>...................] - ETA: 1s - loss: 0.4222 - acc: 0.8099
 448/1000 [============>.................] - ETA: 1s - loss: 0.4111 - acc: 0.8103
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4022 - acc: 0.8125
 576/1000 [================>.............] - ETA: 1s - loss: 0.3977 - acc: 0.8160
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4006 - acc: 0.8156
 704/1000 [====================>.........] - ETA: 0s - loss: 0.3920 - acc: 0.8210
 768/1000 [======================>.......] - ETA: 0s - loss: 0.3956 - acc: 0.8216
 832/1000 [=======================>......] - ETA: 0s - loss: 0.4007 - acc: 0.8173
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4043 - acc: 0.8158
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3996 - acc: 0.8156
1000/1000 [==============================] - 3s 3ms/step - loss: 0.3957 - acc: 0.8170

Test accuracy: 72.80710265864545

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10983

choose_one :  9629

F1score :  0.7190898611737583

AUC :  0.8079707419348717

Confusion Matrix
[[7833 2455]
 [3150 7174]]
True label 0
0.7613724727838258  
0.2386275272161742  
True label 1
0.30511429678419216  
0.6948857032158078  

Train_result {'acc': [0.8170000009536743], 'loss': [0.39570947909355164]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 3s - loss: 0.4570 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 2s - loss: 0.3685 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 2s - loss: 0.3711 - acc: 0.8073
 256/1000 [======>.......................] - ETA: 2s - loss: 0.3597 - acc: 0.8164
 320/1000 [========>.....................] - ETA: 2s - loss: 0.3406 - acc: 0.8281
 384/1000 [==========>...................] - ETA: 1s - loss: 0.3515 - acc: 0.8255
 448/1000 [============>.................] - ETA: 1s - loss: 0.4187 - acc: 0.8058
 512/1000 [==============>...............] - ETA: 1s - loss: 0.4143 - acc: 0.8086
 576/1000 [================>.............] - ETA: 1s - loss: 0.4129 - acc: 0.8090
 640/1000 [==================>...........] - ETA: 1s - loss: 0.4241 - acc: 0.8047
 704/1000 [====================>.........] - ETA: 0s - loss: 0.4185 - acc: 0.8082
 768/1000 [======================>.......] - ETA: 0s - loss: 0.4097 - acc: 0.8138
 832/1000 [=======================>......] - ETA: 0s - loss: 0.3974 - acc: 0.8209
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3974 - acc: 0.8214
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3974 - acc: 0.8219
1000/1000 [==============================] - 3s 3ms/step - loss: 0.4003 - acc: 0.8150

Test accuracy: 72.28313603725985

data size :  21612

zero :  10792

one :  10820

train_zero :  504

train_one :  496

test_zero :  10288

test_one :  10324

choose_zero :  10291

choose_one :  10321

F1score :  0.7232744005812545

AUC :  0.7973923692352235

Confusion Matrix
[[7433 2855]
 [2858 7466]]
True label 0
0.7224922239502333  
0.27750777604976673  
True label 1
0.27683068578070513  
0.7231693142192949  

Train_result {'acc': [0.8149999990463257], 'loss': [0.40027513074874876]}
Saved model to disk


[[59.41684455656899, 1], [65.53464001552494, 2], [67.43159324665243, 3], [63.094313991849404, 4], [69.14903939452745, 5], [68.29516786338056, 6], [68.15447312245294, 7], [71.78342712982729, 8], [69.18785173685232, 9], [68.33883174849602, 10], [71.34678827867262, 11], [73.02057054143218, 12], [72.8410634581797, 13], [72.80710265864545, 14], [72.28313603725985, 15]]
max accuracy :  [73.02057054143218, 12]

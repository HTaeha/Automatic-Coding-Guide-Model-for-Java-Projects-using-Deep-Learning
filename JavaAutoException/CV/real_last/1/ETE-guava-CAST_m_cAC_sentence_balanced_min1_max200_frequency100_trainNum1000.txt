Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:86: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2, input3], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-14 22:25:11.182771: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-14 22:25:11.193317: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100085000 Hz
2019-10-14 22:25:11.195954: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xafc4db0 executing computations on platform Host. Devices:
2019-10-14 22:25:11.195992: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  9884
one :  9718

Second data
zero :  9884
one :  9718

Third data
zero :  9884
one :  9718

guava-code
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

After balance out data.
guava-code

Sentence length Average : 36

Under 10 : 2153
Over 10, Under 30 : 9115
Over 30, Under 100 : 7127
Over 100, Under 150 : 1007
Over 150, Under 200 : 200
Over 200, Under 400 : 0
Over 400 : 0

198
guava-AST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-AST

Sentence length Average : 27

Under 10 : 6120
Over 10, Under 30 : 7121
Over 30, Under 100 : 5710
Over 100, Under 150 : 587
Over 150, Under 200 : 64
Over 200, Under 400 : 0
Over 400 : 0

193
guava-CAST
After set document size of train data, the number of zero and one label data :  485 515
After set document size of test data, the number of zero and one label data :  9399 9203
After balance out data.
guava-CAST

Sentence length Average : 57

Under 10 : 1490
Over 10, Under 30 : 6826
Over 30, Under 100 : 8029
Over 100, Under 150 : 1685
Over 150, Under 200 : 889
Over 200, Under 400 : 680
Over 400 : 3

401
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 198, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 193, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 198, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 193, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 401, 200)     0                                            
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 64)           67840       masking_2[0][0]                  
__________________________________________________________________________________________________
masking_3 (Masking)             (None, 401, 200)     0           input_3[0][0]                    
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 64)           0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 64)           0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 64)           0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 64)           0           backwards_2[0][0]                
__________________________________________________________________________________________________
forwards_3 (LSTM)               (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
backwards_3 (LSTM)              (None, 64)           67840       masking_3[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 128)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_forward_3 (Dropout)    (None, 64)           0           forwards_3[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_3 (Dropout)   (None, 64)           0           backwards_3[0][0]                
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 128)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           after_dp_forward_3[0][0]         
                                                                 after_dp_backward_3[0][0]        
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 256)          0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
after_dp_3 (Dropout)            (None, 128)          0           concatenate_3[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           concatenate_4[0][0]              
                                                                 after_dp_3[0][0]                 
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 256)          98560       concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 128)          32896       dense_1[0][0]                    
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            258         dense_2[0][0]                    
==================================================================================================
Total params: 538,754
Trainable params: 538,754
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 1:16 - loss: 0.7948 - acc: 0.4219
 128/1000 [==>...........................] - ETA: 39s - loss: 0.7600 - acc: 0.4453 
 192/1000 [====>.........................] - ETA: 26s - loss: 0.7303 - acc: 0.4896
 256/1000 [======>.......................] - ETA: 19s - loss: 0.7188 - acc: 0.5195
 320/1000 [========>.....................] - ETA: 15s - loss: 0.7078 - acc: 0.5250
 384/1000 [==========>...................] - ETA: 12s - loss: 0.6966 - acc: 0.5521
 448/1000 [============>.................] - ETA: 10s - loss: 0.6855 - acc: 0.5737
 512/1000 [==============>...............] - ETA: 8s - loss: 0.6772 - acc: 0.5820 
 576/1000 [================>.............] - ETA: 6s - loss: 0.6657 - acc: 0.5972
 640/1000 [==================>...........] - ETA: 5s - loss: 0.6645 - acc: 0.6000
 704/1000 [====================>.........] - ETA: 4s - loss: 0.6570 - acc: 0.6108
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6501 - acc: 0.6172
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6410 - acc: 0.6226
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6410 - acc: 0.6205
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6324 - acc: 0.6281
1000/1000 [==============================] - 13s 13ms/step - loss: 0.6277 - acc: 0.6330

Test accuracy: 74.95430598860338

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8976

choose_one :  9626

F1score :  0.7525625365128259

AUC :  0.8371334062983412

Confusion Matrix
[[6858 2541]
 [2118 7085]]
True label 0
0.7296520906479412  
0.2703479093520587  
True label 1
0.23014234488753668  
0.7698576551124633  

Train_result {'acc': [0.633], 'loss': [0.6277157664299011]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.5889 - acc: 0.7031
 128/1000 [==>...........................] - ETA: 7s - loss: 0.5726 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 7s - loss: 0.5428 - acc: 0.6979
 256/1000 [======>.......................] - ETA: 6s - loss: 0.5161 - acc: 0.7227
 320/1000 [========>.....................] - ETA: 5s - loss: 0.5126 - acc: 0.7312
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4864 - acc: 0.7500
 448/1000 [============>.................] - ETA: 4s - loss: 0.4931 - acc: 0.7545
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4849 - acc: 0.7598
 576/1000 [================>.............] - ETA: 3s - loss: 0.4869 - acc: 0.7622
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4960 - acc: 0.7578
 704/1000 [====================>.........] - ETA: 2s - loss: 0.5169 - acc: 0.7472
 768/1000 [======================>.......] - ETA: 1s - loss: 0.5184 - acc: 0.7461
 832/1000 [=======================>......] - ETA: 1s - loss: 0.5183 - acc: 0.7404
 896/1000 [=========================>....] - ETA: 0s - loss: 0.5164 - acc: 0.7400
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5166 - acc: 0.7427
1000/1000 [==============================] - 8s 8ms/step - loss: 0.5153 - acc: 0.7420

Test accuracy: 77.86797118589399

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8660

choose_one :  9942

F1score :  0.7849569078088274

AUC :  0.8696546504464092

Confusion Matrix
[[6971 2428]
 [1689 7514]]
True label 0
0.7416746462389616  
0.25832535376103843  
True label 1
0.18352711072476366  
0.8164728892752363  

Train_result {'acc': [0.7420000009536744], 'loss': [0.5152657964229583]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.4371 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4195 - acc: 0.7969
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4568 - acc: 0.7865
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4417 - acc: 0.7969
 320/1000 [========>.....................] - ETA: 5s - loss: 0.4396 - acc: 0.7969
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4536 - acc: 0.7891
 448/1000 [============>.................] - ETA: 4s - loss: 0.4663 - acc: 0.7835
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4612 - acc: 0.7891
 576/1000 [================>.............] - ETA: 3s - loss: 0.4640 - acc: 0.7830
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4653 - acc: 0.7812
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4678 - acc: 0.7741
 768/1000 [======================>.......] - ETA: 1s - loss: 0.4749 - acc: 0.7695
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4762 - acc: 0.7680
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4715 - acc: 0.7734
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4730 - acc: 0.7708
1000/1000 [==============================] - 8s 8ms/step - loss: 0.4725 - acc: 0.7710

Test accuracy: 79.31942801849263

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7954

choose_one :  10648

F1score :  0.8062062364616392

AUC :  0.8876725819144469

Confusion Matrix
[[6753 2646]
 [1201 8002]]
True label 0
0.7184806894350463  
0.2815193105649537  
True label 1
0.1305009236118657  
0.8694990763881343  

Train_result {'acc': [0.7709999990463257], 'loss': [0.4724866256713867]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.4019 - acc: 0.7500
 128/1000 [==>...........................] - ETA: 8s - loss: 0.4162 - acc: 0.7891
 192/1000 [====>.........................] - ETA: 7s - loss: 0.4228 - acc: 0.7969
 256/1000 [======>.......................] - ETA: 6s - loss: 0.4337 - acc: 0.7891
 320/1000 [========>.....................] - ETA: 6s - loss: 0.4508 - acc: 0.7719
 384/1000 [==========>...................] - ETA: 5s - loss: 0.4542 - acc: 0.7708
 448/1000 [============>.................] - ETA: 4s - loss: 0.4410 - acc: 0.7835
 512/1000 [==============>...............] - ETA: 4s - loss: 0.4450 - acc: 0.7812
 576/1000 [================>.............] - ETA: 3s - loss: 0.4311 - acc: 0.7899
 640/1000 [==================>...........] - ETA: 3s - loss: 0.4320 - acc: 0.7875
 704/1000 [====================>.........] - ETA: 2s - loss: 0.4351 - acc: 0.7898
 768/1000 [======================>.......] - ETA: 2s - loss: 0.4254 - acc: 0.7982
 832/1000 [=======================>......] - ETA: 1s - loss: 0.4226 - acc: 0.7981
 896/1000 [=========================>....] - ETA: 0s - loss: 0.4194 - acc: 0.8013
 960/1000 [===========================>..] - ETA: 0s - loss: 0.4169 - acc: 0.8021
1000/1000 [==============================] - 9s 9ms/step - loss: 0.4150 - acc: 0.8010

Test accuracy: 80.85689710783787

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9810

choose_one :  8792

F1score :  0.8021116976938039

AUC :  0.8947404326549591

Confusion Matrix
[[7824 1575]
 [1986 7217]]
True label 0
0.8324289818065752  
0.16757101819342482  
True label 1
0.21579919591437574  
0.7842008040856242  

Train_result {'acc': [0.8009999990463257], 'loss': [0.4149719235897064]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3139 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3370 - acc: 0.8672
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3428 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3427 - acc: 0.8477
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3482 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3754 - acc: 0.8307
 448/1000 [============>.................] - ETA: 4s - loss: 0.3877 - acc: 0.8281
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3913 - acc: 0.8223
 576/1000 [================>.............] - ETA: 3s - loss: 0.3839 - acc: 0.8247
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3822 - acc: 0.8250
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3905 - acc: 0.8182
 768/1000 [======================>.......] - ETA: 2s - loss: 0.3930 - acc: 0.8190
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3923 - acc: 0.8149
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3924 - acc: 0.8170
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3917 - acc: 0.8187
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3915 - acc: 0.8170

Test accuracy: 78.5238146435867

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  6796

choose_one :  11806

F1score :  0.8098434004474273

AUC :  0.8986157608278394

Confusion Matrix
[[6100 3299]
 [ 696 8507]]
True label 0
0.649005213320566  
0.35099478667943396  
True label 1
0.07562751276757579  
0.9243724872324242  

Train_result {'acc': [0.8169999990463257], 'loss': [0.3914549498558044]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3368 - acc: 0.8438
 128/1000 [==>...........................] - ETA: 8s - loss: 0.3845 - acc: 0.8281
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3918 - acc: 0.8177
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3827 - acc: 0.8281
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3698 - acc: 0.8375
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3717 - acc: 0.8359
 448/1000 [============>.................] - ETA: 4s - loss: 0.3522 - acc: 0.8460
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3585 - acc: 0.8359
 576/1000 [================>.............] - ETA: 3s - loss: 0.3580 - acc: 0.8316
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3731 - acc: 0.8266
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3630 - acc: 0.8324
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3589 - acc: 0.8359
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3520 - acc: 0.8438
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3444 - acc: 0.8438
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3410 - acc: 0.8448
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3433 - acc: 0.8470

Test accuracy: 81.44285560692398

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9905

choose_one :  8697

F1score :  0.8071508379888268

AUC :  0.9028600643773939

Confusion Matrix
[[7926 1473]
 [1979 7224]]
True label 0
0.8432812001276732  
0.15671879987232684  
True label 1
0.21503857437792023  
0.7849614256220797  

Train_result {'acc': [0.8469999990463257], 'loss': [0.34327928614616393]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.3368 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 7s - loss: 0.3759 - acc: 0.8047
 192/1000 [====>.........................] - ETA: 7s - loss: 0.3334 - acc: 0.8281
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3417 - acc: 0.8359
 320/1000 [========>.....................] - ETA: 6s - loss: 0.3311 - acc: 0.8469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.3130 - acc: 0.8516
 448/1000 [============>.................] - ETA: 4s - loss: 0.3123 - acc: 0.8527
 512/1000 [==============>...............] - ETA: 4s - loss: 0.3047 - acc: 0.8555
 576/1000 [================>.............] - ETA: 3s - loss: 0.3136 - acc: 0.8490
 640/1000 [==================>...........] - ETA: 3s - loss: 0.3249 - acc: 0.8469
 704/1000 [====================>.........] - ETA: 2s - loss: 0.3189 - acc: 0.8523
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3187 - acc: 0.8529
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3124 - acc: 0.8558
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3235 - acc: 0.8527
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3271 - acc: 0.8490
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3210 - acc: 0.8520

Test accuracy: 81.94817761531019

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9467

choose_one :  9135

F1score :  0.8168829752426656

AUC :  0.9054386491903484

Confusion Matrix
[[7754 1645]
 [1713 7490]]
True label 0
0.8249813809979785  
0.17501861900202148  
True label 1
0.1861349559926111  
0.8138650440073889  

Train_result {'acc': [0.8520000004768371], 'loss': [0.3209940493106842]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2862 - acc: 0.8906
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2190 - acc: 0.9062
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2942 - acc: 0.8594
 256/1000 [======>.......................] - ETA: 6s - loss: 0.3211 - acc: 0.8516
 320/1000 [========>.....................] - ETA: 5s - loss: 0.3044 - acc: 0.8625
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2949 - acc: 0.8698
 448/1000 [============>.................] - ETA: 4s - loss: 0.3053 - acc: 0.8683
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2978 - acc: 0.8711
 576/1000 [================>.............] - ETA: 3s - loss: 0.2983 - acc: 0.8698
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2933 - acc: 0.8703
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2999 - acc: 0.8665
 768/1000 [======================>.......] - ETA: 1s - loss: 0.3064 - acc: 0.8659
 832/1000 [=======================>......] - ETA: 1s - loss: 0.3222 - acc: 0.8558
 896/1000 [=========================>....] - ETA: 0s - loss: 0.3202 - acc: 0.8560
 960/1000 [===========================>..] - ETA: 0s - loss: 0.3165 - acc: 0.8604
1000/1000 [==============================] - 9s 9ms/step - loss: 0.3136 - acc: 0.8620

Test accuracy: 82.17933555531664

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9818

choose_one :  8784

F1score :  0.8157002279424028

AUC :  0.9095733965562629

Confusion Matrix
[[7951 1448]
 [1867 7336]]
True label 0
0.8459410575593148  
0.1540589424406852  
True label 1
0.2028686297946322  
0.7971313702053678  

Train_result {'acc': [0.8619999990463257], 'loss': [0.3136375428438187]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.2296 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2494 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2217 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2213 - acc: 0.9180
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2467 - acc: 0.9031
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2443 - acc: 0.9010
 448/1000 [============>.................] - ETA: 4s - loss: 0.2512 - acc: 0.8951
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2653 - acc: 0.8828
 576/1000 [================>.............] - ETA: 3s - loss: 0.2653 - acc: 0.8819
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2625 - acc: 0.8844
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2688 - acc: 0.8864
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2706 - acc: 0.8867
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2731 - acc: 0.8858
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2765 - acc: 0.8862
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2797 - acc: 0.8875
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2748 - acc: 0.8900

Test accuracy: 82.3244812385765

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  8699

choose_one :  9903

F1score :  0.8279074636239925

AUC :  0.9127202133916071

Confusion Matrix
[[7405 1994]
 [1294 7909]]
True label 0
0.7878497712522609  
0.21215022874773912  
True label 1
0.14060632402477452  
0.8593936759752254  

Train_result {'acc': [0.8899999995231629], 'loss': [0.2748487739562988]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 8s - loss: 0.1909 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 7s - loss: 0.2032 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1948 - acc: 0.9323
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2081 - acc: 0.9219
 320/1000 [========>.....................] - ETA: 5s - loss: 0.2495 - acc: 0.9094
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2458 - acc: 0.9062
 448/1000 [============>.................] - ETA: 4s - loss: 0.2443 - acc: 0.9018
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2406 - acc: 0.8984
 576/1000 [================>.............] - ETA: 3s - loss: 0.2328 - acc: 0.9010
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2387 - acc: 0.8969
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2409 - acc: 0.8935
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2403 - acc: 0.8945
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2353 - acc: 0.8966
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2354 - acc: 0.8962
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2347 - acc: 0.8948
1000/1000 [==============================] - 8s 8ms/step - loss: 0.2327 - acc: 0.8960

Test accuracy: 83.07708848510913

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9385

choose_one :  9217

F1score :  0.829098805646037

AUC :  0.915298260626074

Confusion Matrix
[[7818 1581]
 [1567 7636]]
True label 0
0.8317906160229812  
0.16820938397701884  
True label 1
0.17027056394653917  
0.8297294360534608  

Train_result {'acc': [0.8960000004768371], 'loss': [0.23270114886760712]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1468 - acc: 0.9531
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1198 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1349 - acc: 0.9583
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1613 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1489 - acc: 0.9469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1660 - acc: 0.9453
 448/1000 [============>.................] - ETA: 4s - loss: 0.1994 - acc: 0.9353
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1991 - acc: 0.9355
 576/1000 [================>.............] - ETA: 3s - loss: 0.2166 - acc: 0.9271
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2184 - acc: 0.9187
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2221 - acc: 0.9176
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2189 - acc: 0.9180
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2103 - acc: 0.9219
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2091 - acc: 0.9219
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2090 - acc: 0.9187
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2108 - acc: 0.9180

Test accuracy: 82.75991828835609

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9038

choose_one :  9564

F1score :  0.8291149357915489

AUC :  0.9131535825785355

Confusion Matrix
[[7615 1784]
 [1423 7780]]
True label 0
0.8101925736780509  
0.18980742632194914  
True label 1
0.15462349233945452  
0.8453765076605455  

Train_result {'acc': [0.9179999990463257], 'loss': [0.21083035469055175]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1183 - acc: 0.9688
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1592 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 7s - loss: 0.2331 - acc: 0.8958
 256/1000 [======>.......................] - ETA: 6s - loss: 0.2143 - acc: 0.8945
 320/1000 [========>.....................] - ETA: 6s - loss: 0.2267 - acc: 0.8938
 384/1000 [==========>...................] - ETA: 5s - loss: 0.2119 - acc: 0.9010
 448/1000 [============>.................] - ETA: 4s - loss: 0.2060 - acc: 0.9040
 512/1000 [==============>...............] - ETA: 4s - loss: 0.2120 - acc: 0.9004
 576/1000 [================>.............] - ETA: 3s - loss: 0.2054 - acc: 0.9045
 640/1000 [==================>...........] - ETA: 3s - loss: 0.2023 - acc: 0.9047
 704/1000 [====================>.........] - ETA: 2s - loss: 0.2142 - acc: 0.8991
 768/1000 [======================>.......] - ETA: 1s - loss: 0.2099 - acc: 0.9010
 832/1000 [=======================>......] - ETA: 1s - loss: 0.2070 - acc: 0.9038
 896/1000 [=========================>....] - ETA: 0s - loss: 0.2064 - acc: 0.9007
 960/1000 [===========================>..] - ETA: 0s - loss: 0.2060 - acc: 0.9031
1000/1000 [==============================] - 9s 9ms/step - loss: 0.2117 - acc: 0.9010

Test accuracy: 83.20610687022901

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9275

choose_one :  9327

F1score :  0.8314085267134377

AUC :  0.9145588705496782

Confusion Matrix
[[7775 1624]
 [1500 7703]]
True label 0
0.8272156612405575  
0.1727843387594425  
True label 1
0.16299032924046505  
0.8370096707595349  

Train_result {'acc': [0.9010000009536743], 'loss': [0.2116717622280121]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1223 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1542 - acc: 0.9219
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1561 - acc: 0.9167
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1801 - acc: 0.9062
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1648 - acc: 0.9156
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1756 - acc: 0.9115
 448/1000 [============>.................] - ETA: 4s - loss: 0.1662 - acc: 0.9196
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1774 - acc: 0.9199
 576/1000 [================>.............] - ETA: 3s - loss: 0.1681 - acc: 0.9236
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1654 - acc: 0.9250
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1593 - acc: 0.9304
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1589 - acc: 0.9323
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1703 - acc: 0.9279
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1655 - acc: 0.9308
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1651 - acc: 0.9313
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1674 - acc: 0.9310

Test accuracy: 83.07708848510913

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9245

choose_one :  9357

F1score :  0.8303879310344827

AUC :  0.9157128145659307

Confusion Matrix
[[7748 1651]
 [1497 7706]]
True label 0
0.8243430152143845  
0.17565698478561548  
True label 1
0.16266434858198414  
0.8373356514180159  

Train_result {'acc': [0.9310000004768372], 'loss': [0.16742307817935945]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1674 - acc: 0.9219
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1062 - acc: 0.9609
 192/1000 [====>.........................] - ETA: 7s - loss: 0.0958 - acc: 0.9635
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1074 - acc: 0.9570
 320/1000 [========>.....................] - ETA: 6s - loss: 0.1176 - acc: 0.9563
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1276 - acc: 0.9557
 448/1000 [============>.................] - ETA: 4s - loss: 0.1272 - acc: 0.9554
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1282 - acc: 0.9531
 576/1000 [================>.............] - ETA: 3s - loss: 0.1519 - acc: 0.9410
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1456 - acc: 0.9422
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1399 - acc: 0.9446
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1414 - acc: 0.9427
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1543 - acc: 0.9375
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1519 - acc: 0.9375
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1519 - acc: 0.9385
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1597 - acc: 0.9370

Test accuracy: 80.07741103107193

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  7309

choose_one :  11293

F1score :  0.8191842310694769

AUC :  0.9113935217075407

Confusion Matrix
[[6501 2898]
 [ 808 8395]]
True label 0
0.6916693265240983  
0.3083306734759017  
True label 1
0.08779745735086385  
0.9122025426491361  

Train_result {'acc': [0.9369999990463257], 'loss': [0.1597362813949585]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 9s - loss: 0.1436 - acc: 0.9375
 128/1000 [==>...........................] - ETA: 8s - loss: 0.1465 - acc: 0.9375
 192/1000 [====>.........................] - ETA: 7s - loss: 0.1271 - acc: 0.9479
 256/1000 [======>.......................] - ETA: 6s - loss: 0.1449 - acc: 0.9414
 320/1000 [========>.....................] - ETA: 5s - loss: 0.1491 - acc: 0.9469
 384/1000 [==========>...................] - ETA: 5s - loss: 0.1714 - acc: 0.9401
 448/1000 [============>.................] - ETA: 4s - loss: 0.1609 - acc: 0.9420
 512/1000 [==============>...............] - ETA: 4s - loss: 0.1503 - acc: 0.9453
 576/1000 [================>.............] - ETA: 3s - loss: 0.1494 - acc: 0.9462
 640/1000 [==================>...........] - ETA: 3s - loss: 0.1418 - acc: 0.9484
 704/1000 [====================>.........] - ETA: 2s - loss: 0.1355 - acc: 0.9517
 768/1000 [======================>.......] - ETA: 1s - loss: 0.1366 - acc: 0.9492
 832/1000 [=======================>......] - ETA: 1s - loss: 0.1386 - acc: 0.9483
 896/1000 [=========================>....] - ETA: 0s - loss: 0.1406 - acc: 0.9475
 960/1000 [===========================>..] - ETA: 0s - loss: 0.1434 - acc: 0.9448
1000/1000 [==============================] - 9s 9ms/step - loss: 0.1453 - acc: 0.9430

Test accuracy: 83.80281690140845

data size :  19602

zero :  9884

one :  9718

train_zero :  485

train_one :  515

test_zero :  9399

test_one :  9203

choose_zero :  9794

choose_one :  8808

F1score :  0.8327133418466492

AUC :  0.9163310009247851

Confusion Matrix
[[8090 1309]
 [1704 7499]]
True label 0
0.8607298648792425  
0.13927013512075753  
True label 1
0.1851570140171683  
0.8148429859828317  

Train_result {'acc': [0.9429999990463257], 'loss': [0.1452844797372818]}
Saved model to disk


[[74.95430598860338, 1], [77.86797118589399, 2], [79.31942801849263, 3], [80.85689710783787, 4], [78.5238146435867, 5], [81.44285560692398, 6], [81.94817761531019, 7], [82.17933555531664, 8], [82.3244812385765, 9], [83.07708848510913, 10], [82.75991828835609, 11], [83.20610687022901, 12], [83.07708848510913, 13], [80.07741103107193, 14], [83.80281690140845, 15]]
max accuracy :  [83.80281690140845, 15]

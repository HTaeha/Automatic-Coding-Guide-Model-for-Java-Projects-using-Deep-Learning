Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/2014313303/taeha/JavaAutoException/model.py:159: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-10 12:41:49.690556: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-10 12:41:49.701374: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099865000 Hz
2019-10-10 12:41:49.703462: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6bc6700 executing computations on platform Host. Devices:
2019-10-10 12:41:49.703499: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero :  10049
one :  10279

hbase-AST
After set document size of train data, the number of zero and one label data :  499 501
After set document size of test data, the number of zero and one label data :  9550 9778

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

After balance out data.
hbase-AST

Sentence length Average : 30

Under 10 : 7492
Over 10, Under 30 : 6294
Over 30, Under 100 : 5232
Over 100, Under 150 : 774
Over 150, Under 200 : 347
Over 200, Under 400 : 186
Over 400 : 3

621
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 621, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 621, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 64)           67840       masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 128)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            258         dropout_3[0][0]                  
==================================================================================================
Total params: 135,938
Trainable params: 135,938
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1

  64/1000 [>.............................] - ETA: 37s - loss: 0.7300 - acc: 0.5625
 128/1000 [==>...........................] - ETA: 23s - loss: 0.7363 - acc: 0.5000
 192/1000 [====>.........................] - ETA: 18s - loss: 0.7346 - acc: 0.4948
 256/1000 [======>.......................] - ETA: 15s - loss: 0.7179 - acc: 0.5156
 320/1000 [========>.....................] - ETA: 13s - loss: 0.6960 - acc: 0.5406
 384/1000 [==========>...................] - ETA: 11s - loss: 0.6901 - acc: 0.5573
 448/1000 [============>.................] - ETA: 9s - loss: 0.7042 - acc: 0.5536 
 512/1000 [==============>...............] - ETA: 8s - loss: 0.6901 - acc: 0.5645
 576/1000 [================>.............] - ETA: 7s - loss: 0.6936 - acc: 0.5556
 640/1000 [==================>...........] - ETA: 6s - loss: 0.6960 - acc: 0.5516
 704/1000 [====================>.........] - ETA: 4s - loss: 0.6908 - acc: 0.5568
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6927 - acc: 0.5456
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6907 - acc: 0.5469
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6885 - acc: 0.5502
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6891 - acc: 0.5542
1000/1000 [==============================] - 16s 16ms/step - loss: 0.6859 - acc: 0.5630

Test accuracy: 66.01303807947019

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8227

choose_one :  11101

F1score :  0.6853776521864074

AUC :  0.7293494638567829

Confusion Matrix
[[5604 3946]
 [2623 7155]]
True label 0
0.5868062827225131  
0.41319371727748694  
True label 1
0.2682552669257517  
0.7317447330742484  

Train_result {'loss': [0.6859176979064942], 'acc': [0.5629999990463257]}
Saved model to disk


2

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.6878 - acc: 0.5000
 128/1000 [==>...........................] - ETA: 12s - loss: 0.6339 - acc: 0.5938
 192/1000 [====>.........................] - ETA: 11s - loss: 0.6280 - acc: 0.6146
 256/1000 [======>.......................] - ETA: 10s - loss: 0.6242 - acc: 0.6328
 320/1000 [========>.....................] - ETA: 9s - loss: 0.6170 - acc: 0.6438 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.6037 - acc: 0.6667
 448/1000 [============>.................] - ETA: 7s - loss: 0.6116 - acc: 0.6674
 512/1000 [==============>...............] - ETA: 6s - loss: 0.6191 - acc: 0.6562
 576/1000 [================>.............] - ETA: 5s - loss: 0.6204 - acc: 0.6580
 640/1000 [==================>...........] - ETA: 4s - loss: 0.6193 - acc: 0.6625
 704/1000 [====================>.........] - ETA: 4s - loss: 0.6231 - acc: 0.6577
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6264 - acc: 0.6484
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6254 - acc: 0.6502
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6269 - acc: 0.6462
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6249 - acc: 0.6448
1000/1000 [==============================] - 14s 14ms/step - loss: 0.6212 - acc: 0.6480

Test accuracy: 67.34788907284768

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8383

choose_one :  10945

F1score :  0.6954591516672297

AUC :  0.7401573357863952

Confusion Matrix
[[5811 3739]
 [2572 7206]]
True label 0
0.6084816753926702  
0.3915183246073298  
True label 1
0.26303947637553693  
0.7369605236244631  

Train_result {'loss': [0.6212082080841065], 'acc': [0.6480000009536743]}
Saved model to disk


3

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.6203 - acc: 0.6094
 128/1000 [==>...........................] - ETA: 11s - loss: 0.6132 - acc: 0.6406
 192/1000 [====>.........................] - ETA: 11s - loss: 0.6118 - acc: 0.6510
 256/1000 [======>.......................] - ETA: 10s - loss: 0.6026 - acc: 0.6484
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5876 - acc: 0.6719 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.6026 - acc: 0.6562
 448/1000 [============>.................] - ETA: 7s - loss: 0.5972 - acc: 0.6674
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5970 - acc: 0.6641
 576/1000 [================>.............] - ETA: 5s - loss: 0.5985 - acc: 0.6649
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5930 - acc: 0.6719
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5979 - acc: 0.6690
 768/1000 [======================>.......] - ETA: 3s - loss: 0.6023 - acc: 0.6654
 832/1000 [=======================>......] - ETA: 2s - loss: 0.6078 - acc: 0.6575
 896/1000 [=========================>....] - ETA: 1s - loss: 0.6092 - acc: 0.6574
 960/1000 [===========================>..] - ETA: 0s - loss: 0.6089 - acc: 0.6552
1000/1000 [==============================] - 14s 14ms/step - loss: 0.6096 - acc: 0.6490

Test accuracy: 60.67363410596026

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  3269

choose_one :  16059

F1score :  0.7058094980067345

AUC :  0.7338504164172375

Confusion Matrix
[[2609 6941]
 [ 660 9118]]
True label 0
0.2731937172774869  
0.7268062827225131  
True label 1
0.06749846594395582  
0.9325015340560442  

Train_result {'loss': [0.609640431880951], 'acc': [0.649]}
Saved model to disk


4

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.6811 - acc: 0.6250
 128/1000 [==>...........................] - ETA: 12s - loss: 0.6019 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 11s - loss: 0.6127 - acc: 0.6719
 256/1000 [======>.......................] - ETA: 10s - loss: 0.6095 - acc: 0.6680
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5861 - acc: 0.6906 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5924 - acc: 0.6927
 448/1000 [============>.................] - ETA: 7s - loss: 0.5959 - acc: 0.6853
 512/1000 [==============>...............] - ETA: 6s - loss: 0.6036 - acc: 0.6777
 576/1000 [================>.............] - ETA: 5s - loss: 0.5985 - acc: 0.6719
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5938 - acc: 0.6766
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5888 - acc: 0.6832
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5909 - acc: 0.6745
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5896 - acc: 0.6731
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5871 - acc: 0.6719
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5887 - acc: 0.6729
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5964 - acc: 0.6640

Test accuracy: 66.83567880794702

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7038

choose_one :  12290

F1score :  0.7095341671198114

AUC :  0.7470987600115229

Confusion Matrix
[[5089 4461]
 [1949 7829]]
True label 0
0.5328795811518324  
0.4671204188481675  
True label 1
0.19932501534056044  
0.8006749846594395  

Train_result {'loss': [0.5964269690513611], 'acc': [0.6639999995231628]}
Saved model to disk


5

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5966 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5820 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5554 - acc: 0.7031
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5533 - acc: 0.7109
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5677 - acc: 0.7000 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5677 - acc: 0.7005
 448/1000 [============>.................] - ETA: 7s - loss: 0.5686 - acc: 0.7031
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5697 - acc: 0.7012
 576/1000 [================>.............] - ETA: 6s - loss: 0.5657 - acc: 0.7049
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5785 - acc: 0.6984
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5810 - acc: 0.6875
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5750 - acc: 0.6901
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5697 - acc: 0.6995
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5713 - acc: 0.6987
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5740 - acc: 0.6927
1000/1000 [==============================] - 15s 15ms/step - loss: 0.5769 - acc: 0.6880

Test accuracy: 61.915355960264904

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  15273

choose_one :  4055

F1score :  0.4678666955830261

AUC :  0.7440761662841789

Confusion Matrix
[[8731  819]
 [6542 3236]]
True label 0
0.9142408376963351  
0.08575916230366493  
True label 1
0.6690529760687257  
0.3309470239312743  

Train_result {'loss': [0.5769044165611267], 'acc': [0.6879999995231628]}
Saved model to disk


6

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5813 - acc: 0.6719
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5649 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5592 - acc: 0.7083
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5640 - acc: 0.7070
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5721 - acc: 0.6906 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5693 - acc: 0.6927
 448/1000 [============>.................] - ETA: 7s - loss: 0.5711 - acc: 0.6875
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5730 - acc: 0.6875
 576/1000 [================>.............] - ETA: 6s - loss: 0.5728 - acc: 0.6858
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5735 - acc: 0.6891
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5761 - acc: 0.6903
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5777 - acc: 0.6888
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5795 - acc: 0.6827
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5806 - acc: 0.6842
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5761 - acc: 0.6896
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5748 - acc: 0.6910

Test accuracy: 66.55629139072848

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12510

choose_one :  6818

F1score :  0.6105085562786213

AUC :  0.7456868983582119

Confusion Matrix
[[7798 1752]
 [4712 5066]]
True label 0
0.8165445026178011  
0.18345549738219896  
True label 1
0.4818981386786664  
0.5181018613213336  

Train_result {'loss': [0.5747526736259461], 'acc': [0.6910000009536743]}
Saved model to disk


7

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5365 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 12s - loss: 0.4946 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5489 - acc: 0.7031
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5561 - acc: 0.7070
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5507 - acc: 0.7156 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5463 - acc: 0.7109
 448/1000 [============>.................] - ETA: 7s - loss: 0.5397 - acc: 0.7232
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5568 - acc: 0.7148
 576/1000 [================>.............] - ETA: 5s - loss: 0.5610 - acc: 0.7083
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5690 - acc: 0.7031
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5572 - acc: 0.7131
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5603 - acc: 0.7148
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5640 - acc: 0.7091
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5778 - acc: 0.6964
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5754 - acc: 0.6937
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5758 - acc: 0.6930

Test accuracy: 67.9584023178808

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8681

choose_one :  10647

F1score :  0.6967931456548349

AUC :  0.755632427321083

Confusion Matrix
[[6019 3531]
 [2662 7116]]
True label 0
0.630261780104712  
0.36973821989528793  
True label 1
0.2722438126406218  
0.7277561873593782  

Train_result {'loss': [0.5758071055412293], 'acc': [0.6930000004768372]}
Saved model to disk


8

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5092 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5420 - acc: 0.7422
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5473 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5409 - acc: 0.7266
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5313 - acc: 0.7281 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5364 - acc: 0.7240
 448/1000 [============>.................] - ETA: 7s - loss: 0.5346 - acc: 0.7277
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5295 - acc: 0.7246
 576/1000 [================>.............] - ETA: 6s - loss: 0.5347 - acc: 0.7170
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5285 - acc: 0.7109
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5376 - acc: 0.7017
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5412 - acc: 0.6953
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5405 - acc: 0.7019
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5461 - acc: 0.7042
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5466 - acc: 0.7042
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5527 - acc: 0.6990

Test accuracy: 67.93253311258279

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8482

choose_one :  10846

F1score :  0.699476338246703

AUC :  0.7570647965996966

Confusion Matrix
[[5917 3633]
 [2565 7213]]
True label 0
0.6195811518324608  
0.3804188481675393  
True label 1
0.2623235835549192  
0.7376764164450808  

Train_result {'loss': [0.5526843357086182], 'acc': [0.6989999995231628]}
Saved model to disk


9

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5169 - acc: 0.7344
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5547 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5646 - acc: 0.6927
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5515 - acc: 0.6836
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5473 - acc: 0.6875 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5488 - acc: 0.6849
 448/1000 [============>.................] - ETA: 7s - loss: 0.5459 - acc: 0.6853
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5521 - acc: 0.6914
 576/1000 [================>.............] - ETA: 5s - loss: 0.5519 - acc: 0.6892
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5527 - acc: 0.6953
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5554 - acc: 0.6974
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5478 - acc: 0.7031
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5433 - acc: 0.7091
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5433 - acc: 0.7076
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5463 - acc: 0.7063
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5477 - acc: 0.7020

Test accuracy: 64.22288907284768

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  14293

choose_one :  5035

F1score :  0.5331803145885371

AUC :  0.7535899802848365

Confusion Matrix
[[8464 1086]
 [5829 3949]]
True label 0
0.886282722513089  
0.11371727748691099  
True label 1
0.5961341787686644  
0.40386582123133563  

Train_result {'loss': [0.547696328163147], 'acc': [0.7020000009536743]}
Saved model to disk


10

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5514 - acc: 0.6875
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5669 - acc: 0.6562
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5696 - acc: 0.6615
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5679 - acc: 0.6758
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5652 - acc: 0.6813 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5673 - acc: 0.6927
 448/1000 [============>.................] - ETA: 7s - loss: 0.5582 - acc: 0.7076
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5619 - acc: 0.6934
 576/1000 [================>.............] - ETA: 5s - loss: 0.5582 - acc: 0.6997
 640/1000 [==================>...........] - ETA: 5s - loss: 0.5596 - acc: 0.6953
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5583 - acc: 0.6932
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5509 - acc: 0.7018
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5462 - acc: 0.7079
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5422 - acc: 0.7132
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5513 - acc: 0.7094
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5480 - acc: 0.7140

Test accuracy: 68.69308774834437

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8539

choose_one :  10789

F1score :  0.7057908299703408

AUC :  0.7622009608063406

Confusion Matrix
[[6019 3531]
 [2520 7258]]
True label 0
0.630261780104712  
0.36973821989528793  
True label 1
0.25772141542237675  
0.7422785845776232  

Train_result {'loss': [0.5480000035762786], 'acc': [0.7139999995231628]}
Saved model to disk


11

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4623 - acc: 0.7812
 128/1000 [==>...........................] - ETA: 12s - loss: 0.5071 - acc: 0.7344
 192/1000 [====>.........................] - ETA: 11s - loss: 0.4972 - acc: 0.7188
 256/1000 [======>.......................] - ETA: 10s - loss: 0.5230 - acc: 0.7070
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5359 - acc: 0.6969 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5274 - acc: 0.7083
 448/1000 [============>.................] - ETA: 7s - loss: 0.5517 - acc: 0.6830
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5566 - acc: 0.6836
 576/1000 [================>.............] - ETA: 5s - loss: 0.5568 - acc: 0.6910
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5535 - acc: 0.6953
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5563 - acc: 0.6903
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5528 - acc: 0.6901
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5463 - acc: 0.6947
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5512 - acc: 0.6931
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5470 - acc: 0.6990
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5458 - acc: 0.7010

Test accuracy: 68.72413079470199

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  8447

choose_one :  10881

F1score :  0.7073914516675541

AUC :  0.7643411644261774

Confusion Matrix
[[5976 3574]
 [2471 7307]]
True label 0
0.6257591623036649  
0.3742408376963351  
True label 1
0.25271016567805277  
0.7472898343219472  

Train_result {'loss': [0.5458228054046631], 'acc': [0.701]}
Saved model to disk


12

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.4797 - acc: 0.8125
 128/1000 [==>...........................] - ETA: 11s - loss: 0.4967 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 10s - loss: 0.5115 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 9s - loss: 0.4962 - acc: 0.7656 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5052 - acc: 0.7562
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5162 - acc: 0.7474
 448/1000 [============>.................] - ETA: 7s - loss: 0.5142 - acc: 0.7500
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5183 - acc: 0.7363
 576/1000 [================>.............] - ETA: 5s - loss: 0.5353 - acc: 0.7309
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5358 - acc: 0.7297
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5275 - acc: 0.7315
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5277 - acc: 0.7344
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5326 - acc: 0.7332
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5293 - acc: 0.7310
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5298 - acc: 0.7302
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5319 - acc: 0.7300

Test accuracy: 67.92218543046357

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  7966

choose_one :  11362

F1score :  0.706717123935667

AUC :  0.7636725622965971

Confusion Matrix
[[5658 3892]
 [2308 7470]]
True label 0
0.5924607329842932  
0.4075392670157068  
True label 1
0.2360400899979546  
0.7639599100020454  

Train_result {'loss': [0.5319384889602661], 'acc': [0.7300000009536743]}
Saved model to disk


13

Epoch 1/1

  64/1000 [>.............................] - ETA: 12s - loss: 0.5333 - acc: 0.6406
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5231 - acc: 0.6797
 192/1000 [====>.........................] - ETA: 10s - loss: 0.4867 - acc: 0.7135
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4813 - acc: 0.7227
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4920 - acc: 0.7281 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4946 - acc: 0.7266
 448/1000 [============>.................] - ETA: 7s - loss: 0.4862 - acc: 0.7388
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5075 - acc: 0.7285
 576/1000 [================>.............] - ETA: 5s - loss: 0.5023 - acc: 0.7292
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5082 - acc: 0.7281
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5119 - acc: 0.7244
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5179 - acc: 0.7214
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5177 - acc: 0.7200
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5234 - acc: 0.7199
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5239 - acc: 0.7208
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5279 - acc: 0.7170

Test accuracy: 67.64279801324503

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12820

choose_one :  6508

F1score :  0.6159891931720496

AUC :  0.7639677114668146

Confusion Matrix
[[8058 1492]
 [4762 5016]]
True label 0
0.8437696335078534  
0.1562303664921466  
True label 1
0.4870116588259358  
0.5129883411740642  

Train_result {'loss': [0.5279336233139038], 'acc': [0.717]}
Saved model to disk


14

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5586 - acc: 0.7656
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5558 - acc: 0.7500
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5409 - acc: 0.7448
 256/1000 [======>.......................] - ETA: 9s - loss: 0.5569 - acc: 0.7266 
 320/1000 [========>.....................] - ETA: 9s - loss: 0.5639 - acc: 0.7156
 384/1000 [==========>...................] - ETA: 8s - loss: 0.5432 - acc: 0.7214
 448/1000 [============>.................] - ETA: 7s - loss: 0.5273 - acc: 0.7299
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5154 - acc: 0.7422
 576/1000 [================>.............] - ETA: 5s - loss: 0.5165 - acc: 0.7396
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5148 - acc: 0.7375
 704/1000 [====================>.........] - ETA: 3s - loss: 0.5029 - acc: 0.7472
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5057 - acc: 0.7422
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5120 - acc: 0.7368
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5122 - acc: 0.7355
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5151 - acc: 0.7333
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5160 - acc: 0.7350

Test accuracy: 69.61403145695364

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  10899

choose_one :  8429

F1score :  0.6774317570165321

AUC :  0.7683334314986416

Confusion Matrix
[[7288 2262]
 [3611 6167]]
True label 0
0.7631413612565445  
0.2368586387434555  
True label 1
0.36929842503579463  
0.6307015749642053  

Train_result {'loss': [0.5159898176193237], 'acc': [0.7349999990463257]}
Saved model to disk


15

Epoch 1/1

  64/1000 [>.............................] - ETA: 13s - loss: 0.5059 - acc: 0.6562
 128/1000 [==>...........................] - ETA: 11s - loss: 0.5036 - acc: 0.7031
 192/1000 [====>.........................] - ETA: 11s - loss: 0.5075 - acc: 0.7344
 256/1000 [======>.......................] - ETA: 10s - loss: 0.4853 - acc: 0.7617
 320/1000 [========>.....................] - ETA: 9s - loss: 0.4958 - acc: 0.7438 
 384/1000 [==========>...................] - ETA: 8s - loss: 0.4906 - acc: 0.7422
 448/1000 [============>.................] - ETA: 7s - loss: 0.4984 - acc: 0.7366
 512/1000 [==============>...............] - ETA: 6s - loss: 0.5106 - acc: 0.7383
 576/1000 [================>.............] - ETA: 5s - loss: 0.5149 - acc: 0.7309
 640/1000 [==================>...........] - ETA: 4s - loss: 0.5097 - acc: 0.7391
 704/1000 [====================>.........] - ETA: 4s - loss: 0.5011 - acc: 0.7500
 768/1000 [======================>.......] - ETA: 3s - loss: 0.5094 - acc: 0.7435
 832/1000 [=======================>......] - ETA: 2s - loss: 0.5062 - acc: 0.7476
 896/1000 [=========================>....] - ETA: 1s - loss: 0.5074 - acc: 0.7489
 960/1000 [===========================>..] - ETA: 0s - loss: 0.5105 - acc: 0.7438
1000/1000 [==============================] - 14s 14ms/step - loss: 0.5095 - acc: 0.7450

Test accuracy: 68.07740066225165

data size :  20328

zero :  10049

one :  10279

train_zero :  499

train_one :  501

test_zero :  9550

test_one :  9778

choose_zero :  12160

choose_one :  7168

F1score :  0.6359022778236751

AUC :  0.7616495948271522

Confusion Matrix
[[7770 1780]
 [4390 5388]]
True label 0
0.8136125654450261  
0.18638743455497384  
True label 1
0.44896706893025157  
0.5510329310697484  

Train_result {'loss': [0.509518230676651], 'acc': [0.7449999990463256]}
Saved model to disk


[[66.01303807947019, 1], [67.34788907284768, 2], [60.67363410596026, 3], [66.83567880794702, 4], [61.915355960264904, 5], [66.55629139072848, 6], [67.9584023178808, 7], [67.93253311258279, 8], [64.22288907284768, 9], [68.69308774834437, 10], [68.72413079470199, 11], [67.92218543046357, 12], [67.64279801324503, 13], [69.61403145695364, 14], [68.07740066225165, 15]]
max accuracy :  [69.61403145695364, 14]

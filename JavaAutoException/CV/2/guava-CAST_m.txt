Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 19:09:55.188176: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 19:09:55.197313: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-02 19:09:55.199782: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7a174c0 executing computations on platform Host. Devices:
2019-07-02 19:09:55.199821: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34868
Over 200, Under 400 : 315
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34291
Over 200, Under 400 : 892
Over 400 : 0


Test_zero:  2484
Train_zero:  21709
zero:  24193
Test_one:  1467
Train_one:  13474
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1090s - loss: 0.2646 - acc: 0.8918

Test accuracy: 91.9931856899489

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1651

choose_one :  1284

F1score :  0.9145765176299527

AUC : 0.9769019240734859

Confusion Matrix
[[1442   26]
 [ 209 1258]]
True label 0
0.9822888283378747  
0.017711171662125342  
True label 1
0.14246762099522836  
0.8575323790047716  

Train_result {'acc': [0.8917956139374373], 'loss': [0.26460855304166386]}
Saved model to disk



2

Epoch 1/1
 - 1101s - loss: 0.1718 - acc: 0.9348

Test accuracy: 94.24190800681431

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1579

choose_one :  1356

F1score :  0.9401346085724406

AUC : 0.9859372126845087

Confusion Matrix
[[1439   29]
 [ 140 1327]]
True label 0
0.9802452316076294  
0.019754768392370572  
True label 1
0.09543285616905249  
0.9045671438309475  

Train_result {'acc': [0.9348398827414747], 'loss': [0.1718131976918947]}
Saved model to disk



3

Epoch 1/1
 - 1101s - loss: 0.1271 - acc: 0.9535

Test accuracy: 95.60477001703578

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1481

choose_one :  1454

F1score :  0.9558370421088668

AUC : 0.9884159037424612

Confusion Matrix
[[1410   58]
 [  71 1396]]
True label 0
0.9604904632152589  
0.039509536784741145  
True label 1
0.04839809134287662  
0.9516019086571234  

Train_result {'acc': [0.9534676611377045], 'loss': [0.12708726458680972]}
Saved model to disk



4

Epoch 1/1
 - 1103s - loss: 0.0944 - acc: 0.9674

Test accuracy: 95.74105621805792

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1455

choose_one :  1480

F1score :  0.9575839837122496

AUC : 0.9898075555035484

Confusion Matrix
[[1399   69]
 [  56 1411]]
True label 0
0.9529972752043597  
0.04700272479564033  
True label 1
0.038173142467621  
0.961826857532379  

Train_result {'acc': [0.9674199413707373], 'loss': [0.09442245363955358]}
Saved model to disk



5

Epoch 1/1
 - 1101s - loss: 0.0703 - acc: 0.9762

Test accuracy: 96.11584327086882

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1526

choose_one :  1409

F1score :  0.9603616133518776

AUC : 0.9920814689750348

Confusion Matrix
[[1440   28]
 [  86 1381]]
True label 0
0.9809264305177112  
0.01907356948228883  
True label 1
0.05862304021813224  
0.9413769597818678  

Train_result {'acc': [0.9761772236446621], 'loss': [0.07031856703366325]}
Saved model to disk



6

Epoch 1/1
 - 1101s - loss: 0.0584 - acc: 0.9804

Test accuracy: 97.10391822827938

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1451

choose_one :  1484

F1score :  0.9711962046763808

AUC : 0.9940145508173457

Confusion Matrix
[[1417   51]
 [  34 1433]]
True label 0
0.965258855585831  
0.03474114441416894  
True label 1
0.023176550783912748  
0.9768234492160872  

Train_result {'acc': [0.9804074362685071], 'loss': [0.05843085452828947]}
Saved model to disk



7

Epoch 1/1
 - 1102s - loss: 0.0431 - acc: 0.9867

Test accuracy: 97.37649063032367

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1509

choose_one :  1426

F1score :  0.9733840304182511

AUC : 0.993154577823841

Confusion Matrix
[[1450   18]
 [  59 1408]]
True label 0
0.9877384196185286  
0.01226158038147139  
True label 1
0.04021813224267212  
0.9597818677573279  

Train_result {'acc': [0.986678540947716], 'loss': [0.04310053352957493]}
Saved model to disk



8

Epoch 1/1
 - 1100s - loss: 0.0382 - acc: 0.9888

Test accuracy: 97.68313458262351

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1470

choose_one :  1465

F1score :  0.9768076398362892

AUC : 0.9951224857862995

Confusion Matrix
[[1435   33]
 [  35 1432]]
True label 0
0.9775204359673024  
0.022479564032697547  
True label 1
0.023858214042263123  
0.9761417859577369  

Train_result {'acc': [0.9887565401313593], 'loss': [0.038171326107830035]}
Saved model to disk



9

Epoch 1/1
 - 1116s - loss: 0.0351 - acc: 0.9895

Test accuracy: 97.64906303236798

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1459

choose_one :  1476

F1score :  0.9765545361875638

AUC : 0.9948708090247014

Confusion Matrix
[[1429   39]
 [  30 1437]]
True label 0
0.973433242506812  
0.02656675749318801  
True label 1
0.02044989775051125  
0.9795501022494888  

Train_result {'acc': [0.9895357898252254], 'loss': [0.03510262888249999]}
Saved model to disk



10

Epoch 1/1
 - 1114s - loss: 0.0279 - acc: 0.9919

Test accuracy: 97.81942078364565

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1452

choose_one :  1483

F1score :  0.9783050847457626

AUC : 0.9943124302316726

Confusion Matrix
[[1428   40]
 [  24 1443]]
True label 0
0.9727520435967303  
0.027247956403269755  
True label 1
0.016359918200409  
0.983640081799591  

Train_result {'acc': [0.9919106460351034], 'loss': [0.027864585507407936]}
Saved model to disk



11

Epoch 1/1
 - 1115s - loss: 0.0250 - acc: 0.9928

Test accuracy: 97.81942078364565

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1468

choose_one :  1467

F1score :  0.978186775732788

AUC : 0.9943600259292074

Confusion Matrix
[[1436   32]
 [  32 1435]]
True label 0
0.9782016348773842  
0.021798365122615803  
True label 1
0.021813224267211998  
0.978186775732788  

Train_result {'acc': [0.9927641099855282], 'loss': [0.025047682816226456]}
Saved model to disk



12

Epoch 1/1
 - 1113s - loss: 0.0227 - acc: 0.9935

Test accuracy: 98.33049403747872

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1475

choose_one :  1460

F1score :  0.9832593098735908

AUC : 0.9946168105217602

Confusion Matrix
[[1447   21]
 [  28 1439]]
True label 0
0.9856948228882834  
0.01430517711171662  
True label 1
0.0190865712338105  
0.9809134287661895  

Train_result {'acc': [0.9934691454228357], 'loss': [0.022683307801411597]}
Saved model to disk



13

Epoch 1/1
 - 1113s - loss: 0.0220 - acc: 0.9946

Test accuracy: 98.26235093696764

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1487

choose_one :  1448

F1score :  0.9825042881646655

AUC : 0.9945536591572264

Confusion Matrix
[[1452   16]
 [  35 1432]]
True label 0
0.989100817438692  
0.010899182561307902  
True label 1
0.023858214042263123  
0.9761417859577369  

Train_result {'acc': [0.994582359271216], 'loss': [0.02199037980069733]}
Saved model to disk



14

Epoch 1/1
 - 1111s - loss: 0.0209 - acc: 0.9945

Test accuracy: 98.09199318568996

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1456

choose_one :  1479

F1score :  0.9809911744738629

AUC : 0.9941694109649344

Confusion Matrix
[[1434   34]
 [  22 1445]]
True label 0
0.9768392370572208  
0.02316076294277929  
True label 1
0.014996591683708248  
0.9850034083162917  

Train_result {'acc': [0.994471037886378], 'loss': [0.020867128978012604]}
Saved model to disk



15

Epoch 1/1
 - 1112s - loss: 0.0180 - acc: 0.9957

Test accuracy: 98.43270868824531

data size :  29884

zero :  14943

one :  14941

train_zero :  13475

train_one :  13474

test_zero :  1468

test_one :  1467

choose_zero :  1466

choose_one :  1469

F1score :  0.9843324250681199

AUC : 0.9943314685106865

Confusion Matrix
[[1444   24]
 [  22 1445]]
True label 0
0.9836512261580381  
0.01634877384196185  
True label 1
0.014996591683708248  
0.9850034083162917  

Train_result {'acc': [0.9956584659913169], 'loss': [0.018016114702621044]}
Saved model to disk




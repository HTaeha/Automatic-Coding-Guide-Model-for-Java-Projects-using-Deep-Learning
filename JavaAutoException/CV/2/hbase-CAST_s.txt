Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-01 01:14:46.845597: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-01 01:14:46.856191: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-01 01:14:46.858729: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6e86500 executing computations on platform Host. Devices:
2019-07-01 01:14:46.858770: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST_s
all data

Sentence length Average : 68

Under 10 : 8789
Over 10, Under 200 : 36286
Over 200, Under 400 : 3039
Over 400 : 1139

hbase-CAST_s
updated_train_data

Sentence length Average : 75

Under 10 : 0
Over 10, Under 200 : 31763
Over 200, Under 400 : 3543
Over 400 : 0


Test_zero:  1752
Train_zero:  16247
zero:  17999
Test_one:  2096
Train_one:  19059
one:  21155

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 733s - loss: 0.3987 - acc: 0.8199

Test accuracy: 85.27817403708987

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1734

choose_one :  1771

F1score :  0.8535754824063564

AUC : 0.9301184922390058

Confusion Matrix
[[1485  267]
 [ 249 1504]]
True label 0
0.8476027397260274  
0.1523972602739726  
True label 1
0.14204221334854536  
0.8579577866514546  

Train_result {'acc': [0.8199415294715745], 'loss': [0.3987458575366185]}
Saved model to disk



2

Epoch 1/1
 - 729s - loss: 0.3046 - acc: 0.8665

Test accuracy: 86.41940085592012

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1608

choose_one :  1897

F1score :  0.8695890410958903

AUC : 0.9474097893500246

Confusion Matrix
[[1442  310]
 [ 166 1587]]
True label 0
0.8230593607305936  
0.1769406392694064  
True label 1
0.09469480889903023  
0.9053051911009697  

Train_result {'acc': [0.8664717648869057], 'loss': [0.3045783749111323]}
Saved model to disk



3

Epoch 1/1
 - 730s - loss: 0.2637 - acc: 0.8880

Test accuracy: 88.7018544935806

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1838

choose_one :  1667

F1score :  0.8842105263157893

AUC : 0.954636474458658

Confusion Matrix
[[1597  155]
 [ 241 1512]]
True label 0
0.9115296803652968  
0.0884703196347032  
True label 1
0.1374786081003993  
0.8625213918996006  

Train_result {'acc': [0.8879519926197511], 'loss': [0.2637378841487238]}
Saved model to disk



4

Epoch 1/1
 - 730s - loss: 0.2330 - acc: 0.9004

Test accuracy: 89.01569186875892

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1835

choose_one :  1670

F1score :  0.8875255623721882

AUC : 0.9563641064111881

Confusion Matrix
[[1601  151]
 [ 234 1519]]
True label 0
0.9138127853881278  
0.08618721461187215  
True label 1
0.13348545350827154  
0.8665145464917284  

Train_result {'acc': [0.9004154485305431], 'loss': [0.2329910693512199]}
Saved model to disk



5

Epoch 1/1
 - 731s - loss: 0.2077 - acc: 0.9149

Test accuracy: 89.9286733238231

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1753

choose_one :  1752

F1score :  0.8992867332382312

AUC : 0.9618708111599945

Confusion Matrix
[[1576  176]
 [ 177 1576]]
True label 0
0.8995433789954338  
0.1004566210045662  
True label 1
0.10096976611523104  
0.899030233884769  

Train_result {'acc': [0.9148792121919931], 'loss': [0.20765125271008003]}
Saved model to disk



6

Epoch 1/1
 - 727s - loss: 0.1840 - acc: 0.9239

Test accuracy: 89.75748930099857

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1897

choose_one :  1608

F1score :  0.8931865516215413

AUC : 0.9663749944648052

Confusion Matrix
[[1645  107]
 [ 252 1501]]
True label 0
0.9389269406392694  
0.06107305936073059  
True label 1
0.1437535653166001  
0.8562464346833999  

Train_result {'acc': [0.9238959840012066], 'loss': [0.1839853272284521]}
Saved model to disk



7

Epoch 1/1
 - 732s - loss: 0.1589 - acc: 0.9346

Test accuracy: 90.01426533523538

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1666

choose_one :  1839

F1score :  0.9025612472160357

AUC : 0.966860463601862

Confusion Matrix
[[1534  218]
 [ 132 1621]]
True label 0
0.8755707762557078  
0.12442922374429223  
True label 1
0.07529948659440959  
0.9247005134055905  

Train_result {'acc': [0.9346053239014868], 'loss': [0.15892354552104557]}
Saved model to disk



8

Epoch 1/1
 - 732s - loss: 0.1373 - acc: 0.9461

Test accuracy: 90.0713266761769

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1872

choose_one :  1633

F1score :  0.8972238629651507

AUC : 0.9673014883813007

Confusion Matrix
[[1638  114]
 [ 234 1519]]
True label 0
0.934931506849315  
0.06506849315068493  
True label 1
0.13348545350827154  
0.8665145464917284  

Train_result {'acc': [0.9460840129305682], 'loss': [0.13731169882880337]}
Saved model to disk



9

Epoch 1/1
 - 733s - loss: 0.1198 - acc: 0.9529

Test accuracy: 89.95720399429386

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1706

choose_one :  1799

F1score :  0.9009009009009008

AUC : 0.9667507365064977

Confusion Matrix
[[1553  199]
 [ 153 1600]]
True label 0
0.8864155251141552  
0.11358447488584475  
True label 1
0.08727895037079293  
0.9127210496292071  

Train_result {'acc': [0.9529158332069427], 'loss': [0.11982492661270697]}
Saved model to disk



10

Epoch 1/1
 - 775s - loss: 0.1090 - acc: 0.9589

Test accuracy: 90.55634807417974

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1863

choose_one :  1642

F1score :  0.9025036818851252

AUC : 0.968416016118487

Confusion Matrix
[[1642  110]
 [ 221 1532]]
True label 0
0.9372146118721462  
0.06278538812785388  
True label 1
0.12606959498003423  
0.8739304050199658  

Train_result {'acc': [0.9588552084954487], 'loss': [0.10899723811247915]}
Saved model to disk



11

Epoch 1/1
 - 776s - loss: 0.0934 - acc: 0.9662

Test accuracy: 90.87018544935806

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1854

choose_one :  1651

F1score :  0.9059929494712102

AUC : 0.9692685989054641

Confusion Matrix
[[1643  109]
 [ 211 1542]]
True label 0
0.9377853881278538  
0.062214611872146115  
True label 1
0.12036508841985168  
0.8796349115801483  

Train_result {'acc': [0.9661794122172642], 'loss': [0.09343557168190356]}
Saved model to disk



12

Epoch 1/1
 - 782s - loss: 0.0855 - acc: 0.9699

Test accuracy: 90.95577746077032

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1831

choose_one :  1674

F1score :  0.9074992704989787

AUC : 0.9698890291138219

Confusion Matrix
[[1633  119]
 [ 198 1555]]
True label 0
0.9320776255707762  
0.06792237442922375  
True label 1
0.11294922989161438  
0.8870507701083856  

Train_result {'acc': [0.9699030620095399], 'loss': [0.08551466379068252]}
Saved model to disk



13

Epoch 1/1
 - 780s - loss: 0.0779 - acc: 0.9722

Test accuracy: 90.92724679029958

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1776

choose_one :  1729

F1score :  0.9086731763354394

AUC : 0.9685013232371382

Confusion Matrix
[[1605  147]
 [ 171 1582]]
True label 0
0.916095890410959  
0.0839041095890411  
True label 1
0.0975470621791215  
0.9024529378208785  

Train_result {'acc': [0.9722418833666718], 'loss': [0.07786819478238606]}
Saved model to disk



14

Epoch 1/1
 - 779s - loss: 0.0705 - acc: 0.9757

Test accuracy: 90.9843081312411

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1780

choose_one :  1725

F1score :  0.9091431857389304

AUC : 0.9699323338725265

Confusion Matrix
[[1608  144]
 [ 172 1581]]
True label 0
0.9178082191780822  
0.0821917808219178  
True label 1
0.09811751283513977  
0.9018824871648602  

Train_result {'acc': [0.9756885674719188], 'loss': [0.07053749041346216]}
Saved model to disk



15

Epoch 1/1
 - 778s - loss: 0.0656 - acc: 0.9778

Test accuracy: 90.95577746077032

data size :  36000

zero :  17999

one :  18001

train_zero :  16247

train_one :  16248

test_zero :  1752

test_one :  1753

choose_zero :  1859

choose_one :  1646

F1score :  0.9067372756693145

AUC : 0.9696197581705986

Confusion Matrix
[[1647  105]
 [ 212 1541]]
True label 0
0.940068493150685  
0.059931506849315065  
True label 1
0.12093553907586994  
0.87906446092413  

Train_result {'acc': [0.9777811971072473], 'loss': [0.0655895164395277]}
Saved model to disk




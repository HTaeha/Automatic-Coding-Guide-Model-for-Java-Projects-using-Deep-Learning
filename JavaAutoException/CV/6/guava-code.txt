Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 01:35:21.591922: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 01:35:21.603210: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-05 01:35:21.606307: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xc4a03c0 executing computations on platform Host. Devices:
2019-07-05 01:35:21.606349: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41586

one : 
17568
guava-code
all data

Sentence length Average : 42

Under 10 : 4802
Over 10, Under 200 : 53280
Over 200, Under 400 : 940
Over 400 : 132

guava-code
updated_train_data

Sentence length Average : 44

Under 10 : 0
Over 10, Under 200 : 47307
Over 200, Under 400 : 923
Over 400 : 0


Test_zero:  3649
Train_zero:  33464
zero:  37113
Test_one:  1712
Train_one:  14766
one:  16478

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 689s - loss: 0.2661 - acc: 0.8912

Test accuracy: 92.37956204379562

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1770

choose_one :  1655

F1score :  0.9224829224829224

AUC : 0.9727029013972318

Confusion Matrix
[[1611  102]
 [ 159 1553]]
True label 0
0.9404553415061296  
0.0595446584938704  
True label 1
0.09287383177570094  
0.907126168224299  

Train_result {'acc': [0.8912403074789171], 'loss': [0.26606502039862895]}
Saved model to disk



2

Epoch 1/1
 - 709s - loss: 0.1750 - acc: 0.9344

Test accuracy: 94.42335766423358

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1786

choose_one :  1639

F1score :  0.9430020889286779

AUC : 0.9866121358931971

Confusion Matrix
[[1654   59]
 [ 132 1580]]
True label 0
0.9655575014594279  
0.034442498540572096  
True label 1
0.07710280373831775  
0.9228971962616822  

Train_result {'acc': [0.9344462127152409], 'loss': [0.1750346000075756]}
Saved model to disk



3

Epoch 1/1
 - 710s - loss: 0.1312 - acc: 0.9510

Test accuracy: 95.38686131386861

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1737

choose_one :  1688

F1score :  0.953529411764706

AUC : 0.9905471354294535

Confusion Matrix
[[1646   67]
 [  91 1621]]
True label 0
0.960887332165791  
0.03911266783420899  
True label 1
0.053154205607476634  
0.9468457943925234  

Train_result {'acc': [0.9510378220791508], 'loss': [0.1312014990956801]}
Saved model to disk



4

Epoch 1/1
 - 704s - loss: 0.1037 - acc: 0.9620

Test accuracy: 96.05839416058394

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1760

choose_one :  1665

F1score :  0.9600236896653834

AUC : 0.9927717400199682

Confusion Matrix
[[1669   44]
 [  91 1621]]
True label 0
0.974314068884997  
0.02568593111500292  
True label 1
0.053154205607476634  
0.9468457943925234  

Train_result {'acc': [0.9619747401252569], 'loss': [0.10369517672483429]}
Saved model to disk



5

Epoch 1/1
 - 705s - loss: 0.0827 - acc: 0.9700

Test accuracy: 96.35036496350365

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1714

choose_one :  1711

F1score :  0.9634823254455157

AUC : 0.993937918392065

Confusion Matrix
[[1651   62]
 [  63 1649]]
True label 0
0.963806187974314  
0.03619381202568593  
True label 1
0.036799065420560745  
0.9632009345794392  

Train_result {'acc': [0.9700335218048812], 'loss': [0.08268085760754881]}
Saved model to disk



6

Epoch 1/1
 - 706s - loss: 0.0658 - acc: 0.9770

Test accuracy: 96.72992700729927

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1711

choose_one :  1714

F1score :  0.9673088149445418

AUC : 0.9945973888516075

Confusion Matrix
[[1656   57]
 [  55 1657]]
True label 0
0.9667250437828371  
0.03327495621716287  
True label 1
0.03212616822429906  
0.967873831775701  

Train_result {'acc': [0.9769749094051928], 'loss': [0.06575717011956235]}
Saved model to disk



7

Epoch 1/1
 - 706s - loss: 0.0555 - acc: 0.9813

Test accuracy: 96.84671532846714

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1687

choose_one :  1738

F1score :  0.968695652173913

AUC : 0.9954979377056155

Confusion Matrix
[[1646   67]
 [  41 1671]]
True label 0
0.960887332165791  
0.03911266783420899  
True label 1
0.02394859813084112  
0.9760514018691588  

Train_result {'acc': [0.9813090441201368], 'loss': [0.055514078868457536]}
Saved model to disk



8

Epoch 1/1
 - 707s - loss: 0.0472 - acc: 0.9839

Test accuracy: 97.25547445255475

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1681

choose_one :  1744

F1score :  0.9728009259259259

AUC : 0.9952660659825087

Confusion Matrix
[[1650   63]
 [  31 1681]]
True label 0
0.9632224168126094  
0.03677758318739054  
True label 1
0.018107476635514017  
0.981892523364486  

Train_result {'acc': [0.9838824365963499], 'loss': [0.047174205609989174]}
Saved model to disk



9

Epoch 1/1
 - 710s - loss: 0.0403 - acc: 0.9867

Test accuracy: 97.22627737226277

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1712

choose_one :  1713

F1score :  0.9722627737226277

AUC : 0.9957864134081871

Confusion Matrix
[[1665   48]
 [  47 1665]]
True label 0
0.9719789842381786  
0.028021015761821366  
True label 1
0.027453271028037383  
0.9725467289719626  

Train_result {'acc': [0.9866928520637931], 'loss': [0.040279886185419285]}
Saved model to disk



10

Epoch 1/1
 - 702s - loss: 0.0391 - acc: 0.9885

Test accuracy: 97.43065693430657

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1717

choose_one :  1708

F1score :  0.9742690058479532

AUC : 0.9962886884789761

Confusion Matrix
[[1671   42]
 [  46 1666]]
True label 0
0.9754816112084063  
0.024518388791593695  
True label 1
0.026869158878504672  
0.9731308411214953  

Train_result {'acc': [0.9885213151389971], 'loss': [0.03909605809062973]}
Saved model to disk



11

Epoch 1/1
 - 710s - loss: 0.0326 - acc: 0.9901

Test accuracy: 97.45985401459853

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1716

choose_one :  1709

F1score :  0.9745688395206079

AUC : 0.9955444825441511

Confusion Matrix
[[1671   42]
 [  45 1667]]
True label 0
0.9754816112084063  
0.024518388791593695  
True label 1
0.026285046728971962  
0.9737149532710281  

Train_result {'acc': [0.9901127552229709], 'loss': [0.03260286698655656]}
Saved model to disk



12

Epoch 1/1
 - 707s - loss: 0.0279 - acc: 0.9918

Test accuracy: 97.16788321167883

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1662

choose_one :  1763

F1score :  0.9720863309352519

AUC : 0.9946360909700966

Confusion Matrix
[[1639   74]
 [  23 1689]]
True label 0
0.9568009340338587  
0.04319906596614127  
True label 1
0.013434579439252336  
0.9865654205607477  

Train_result {'acc': [0.991771916161582], 'loss': [0.027887998085607737]}
Saved model to disk



13

Epoch 1/1
 - 712s - loss: 0.0282 - acc: 0.9922

Test accuracy: 97.25547445255475

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1677

choose_one :  1748

F1score :  0.9728323699421966

AUC : 0.9956396181481907

Confusion Matrix
[[1648   65]
 [  29 1683]]
True label 0
0.9620548744892002  
0.03794512551079977  
True label 1
0.016939252336448597  
0.9830607476635514  

Train_result {'acc': [0.9922121016985596], 'loss': [0.028190716972434356]}
Saved model to disk



14

Epoch 1/1
 - 707s - loss: 0.0278 - acc: 0.9923

Test accuracy: 98.16058394160584

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1704

choose_one :  1721

F1score :  0.9816487037576465

AUC : 0.9963376202323081

Confusion Matrix
[[1677   36]
 [  27 1685]]
True label 0
0.978984238178634  
0.021015761821366025  
True label 1
0.015771028037383176  
0.9842289719626168  

Train_result {'acc': [0.9923475434259981], 'loss': [0.027831113050886317]}
Saved model to disk



15

Epoch 1/1
 - 710s - loss: 0.0264 - acc: 0.9928

Test accuracy: 97.83941605839416

data size :  32958

zero :  16480

one :  16478

train_zero :  14767

train_one :  14766

test_zero :  1713

test_one :  1712

choose_zero :  1705

choose_one :  1720

F1score :  0.9784382284382285

AUC : 0.9958055087265605

Confusion Matrix
[[1672   41]
 [  33 1679]]
True label 0
0.9760653823701109  
0.023934617629889084  
True label 1
0.019275700934579438  
0.9807242990654206  

Train_result {'acc': [0.9928215894084583], 'loss': [0.02641382347682375]}
Saved model to disk




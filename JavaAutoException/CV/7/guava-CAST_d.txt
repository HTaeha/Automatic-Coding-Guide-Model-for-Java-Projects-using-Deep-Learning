Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:515: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ou..., inputs=Tensor("in...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-05 18:35:06.101456: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-05 18:35:06.111162: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-05 18:35:06.113392: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6c660a0 executing computations on platform Host. Devices:
2019-07-05 18:35:06.113425: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34860
Over 200, Under 400 : 313
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34269
Over 200, Under 400 : 904
Over 400 : 0


Test_zero:  2404
Train_zero:  21789
zero:  24193
Test_one:  1557
Train_one:  13384
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1752s - loss: 0.2953 - acc: 0.8779

Test accuracy: 91.01123595505618

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1562

choose_one :  1553

F1score :  0.909967845659164

AUC : 0.9722673618582854

Confusion Matrix
[[1420  138]
 [ 142 1415]]
True label 0
0.9114249037227214  
0.08857509627727857  
True label 1
0.09120102761721259  
0.9087989723827874  

Train_result {'loss': [0.2952921278049692], 'acc': [0.8778811311658565]}
Saved model to disk



2

Epoch 1/1
 - 1700s - loss: 0.1918 - acc: 0.9273

Test accuracy: 94.09309791332264

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1630

choose_one :  1485

F1score :  0.9395134779750165

AUC : 0.9850688801989937

Confusion Matrix
[[1502   56]
 [ 128 1429]]
True label 0
0.9640564826700898  
0.03594351732991014  
True label 1
0.08220937700706486  
0.9177906229929351  

Train_result {'loss': [0.19184511092572268], 'acc': [0.9272666143718185]}
Saved model to disk



3

Epoch 1/1
 - 1667s - loss: 0.1412 - acc: 0.9494

Test accuracy: 94.92776886035314

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1592

choose_one :  1523

F1score :  0.9487012987012987

AUC : 0.9898400778957591

Confusion Matrix
[[1496   62]
 [  96 1461]]
True label 0
0.9602053915275995  
0.03979460847240052  
True label 1
0.06165703275529865  
0.9383429672447013  

Train_result {'loss': [0.1411694710188939], 'acc': [0.9493817475482539]}
Saved model to disk



4

Epoch 1/1
 - 1662s - loss: 0.1065 - acc: 0.9625

Test accuracy: 95.98715890850723

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1575

choose_one :  1540

F1score :  0.9596383597029383

AUC : 0.9922660756878332

Confusion Matrix
[[1504   54]
 [  71 1486]]
True label 0
0.9653401797175867  
0.03465982028241335  
True label 1
0.045600513808606295  
0.9543994861913937  

Train_result {'loss': [0.1064992513713707], 'acc': [0.9624939295453696]}
Saved model to disk



5

Epoch 1/1
 - 1640s - loss: 0.0786 - acc: 0.9728

Test accuracy: 96.78972712680579

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1580

choose_one :  1535

F1score :  0.9676584734799483

AUC : 0.9941269005023485

Confusion Matrix
[[1519   39]
 [  61 1496]]
True label 0
0.9749679075738126  
0.02503209242618742  
True label 1
0.03917790622992935  
0.9608220937700707  

Train_result {'loss': [0.07864441802630077], 'acc': [0.9728043632560051]}
Saved model to disk



6

Epoch 1/1
 - 1631s - loss: 0.0594 - acc: 0.9788

Test accuracy: 96.69341894060996

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1573

choose_one :  1542

F1score :  0.9667634720877704

AUC : 0.9947802915814373

Confusion Matrix
[[1514   44]
 [  59 1498]]
True label 0
0.9717586649550706  
0.028241335044929396  
True label 1
0.03789338471419396  
0.962106615285806  

Train_result {'loss': [0.059440982805829], 'acc': [0.97878142627889]}
Saved model to disk



7

Epoch 1/1
 - 1623s - loss: 0.0520 - acc: 0.9824

Test accuracy: 97.9454253611557

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1550

choose_one :  1565

F1score :  0.9795003203074952

AUC : 0.9966674993795877

Confusion Matrix
[[1522   36]
 [  28 1529]]
True label 0
0.9768934531450578  
0.023106546854942234  
True label 1
0.01798330122029544  
0.9820166987797045  

Train_result {'loss': [0.052039069978646234], 'acc': [0.9824423773768165]}
Saved model to disk



8

Epoch 1/1
 - 1615s - loss: 0.0410 - acc: 0.9867

Test accuracy: 98.00963081861958

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1562

choose_one :  1553

F1score :  0.9800643086816719

AUC : 0.9967870472741844

Confusion Matrix
[[1529   29]
 [  33 1524]]
True label 0
0.9813863928112966  
0.018613607188703467  
True label 1
0.02119460500963391  
0.9788053949903661  

Train_result {'loss': [0.04095029850909808], 'acc': [0.9867010347790355]}
Saved model to disk



9

Epoch 1/1
 - 1637s - loss: 0.0333 - acc: 0.9883

Test accuracy: 97.65650080256822

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1549

choose_one :  1566

F1score :  0.9766250400256163

AUC : 0.9961567413057764

Confusion Matrix
[[1517   41]
 [  32 1525]]
True label 0
0.9736842105263158  
0.02631578947368421  
True label 1
0.020552344251766216  
0.9794476557482338  

Train_result {'loss': [0.03327534254490699], 'acc': [0.9883447271097164]}
Saved model to disk



10

Epoch 1/1
 - 1417s - loss: 0.0285 - acc: 0.9911

Test accuracy: 98.10593900481541

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1535

choose_one :  1580

F1score :  0.9811922218680268

AUC : 0.9965388823343665

Confusion Matrix
[[1517   41]
 [  18 1539]]
True label 0
0.9736842105263158  
0.02631578947368421  
True label 1
0.011560693641618497  
0.9884393063583815  

Train_result {'loss': [0.028546585613434976], 'acc': [0.9910717621128918]}
Saved model to disk



11

Epoch 1/1
 - 1280s - loss: 0.0272 - acc: 0.9925

Test accuracy: 98.33065810593901

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1554

choose_one :  1561

F1score :  0.9833226427196922

AUC : 0.9967186164103807

Confusion Matrix
[[1530   28]
 [  24 1533]]
True label 0
0.982028241335045  
0.01797175866495507  
True label 1
0.015414258188824663  
0.9845857418111753  

Train_result {'loss': [0.027247521752935776], 'acc': [0.992453957936419]}
Saved model to disk



12

Epoch 1/1
 - 1272s - loss: 0.0278 - acc: 0.9922

Test accuracy: 98.52327447833066

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1558

choose_one :  1557

F1score :  0.9852280025690431

AUC : 0.9967429382234193

Confusion Matrix
[[1535   23]
 [  23 1534]]
True label 0
0.9852374839537869  
0.014762516046213094  
True label 1
0.014771997430956968  
0.9852280025690431  

Train_result {'loss': [0.027756204617430693], 'acc': [0.9922298180731443]}
Saved model to disk



13

Epoch 1/1
 - 1275s - loss: 0.0221 - acc: 0.9936

Test accuracy: 98.26645264847512

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1536

choose_one :  1579

F1score :  0.9827806122448979

AUC : 0.9973821072253923

Confusion Matrix
[[1520   38]
 [  16 1541]]
True label 0
0.975609756097561  
0.024390243902439025  
True label 1
0.010276172125883108  
0.989723827874117  

Train_result {'loss': [0.02210486160180759], 'acc': [0.9936120138966715]}
Saved model to disk



14

Epoch 1/1
 - 1273s - loss: 0.0258 - acc: 0.9936

Test accuracy: 98.58747993579455

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1538

choose_one :  1577

F1score :  0.9859604339502234

AUC : 0.9968309502078897

Confusion Matrix
[[1526   32]
 [  12 1545]]
True label 0
0.9794608472400513  
0.02053915275994865  
True label 1
0.007707129094412331  
0.9922928709055877  

Train_result {'loss': [0.025786281210313802], 'acc': [0.9936120138966715]}
Saved model to disk



15

Epoch 1/1
 - 1275s - loss: 0.0211 - acc: 0.9945

Test accuracy: 98.10593900481541

data size :  29884

zero :  14943

one :  14941

train_zero :  13385

train_one :  13384

test_zero :  1558

test_one :  1557

choose_zero :  1529

choose_one :  1586

F1score :  0.981228125994273

AUC : 0.9965469208996929

Confusion Matrix
[[1514   44]
 [  15 1542]]
True label 0
0.9717586649550706  
0.028241335044929396  
True label 1
0.009633911368015413  
0.9903660886319846  

Train_result {'loss': [0.021081306249034856], 'acc': [0.994545929995876]}
Saved model to disk




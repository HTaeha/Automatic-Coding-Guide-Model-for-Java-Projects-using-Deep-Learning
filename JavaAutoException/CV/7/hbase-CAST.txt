Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 13:14:09.377045: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 13:14:09.387371: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-04 13:14:09.390460: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x76e5c20 executing computations on platform Host. Devices:
2019-07-04 13:14:09.390518: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST
all data

Sentence length Average : 100

Under 10 : 6634
Over 10, Under 200 : 35615
Over 200, Under 400 : 4427
Over 400 : 2577

hbase-CAST
updated_train_data

Sentence length Average : 97

Under 10 : 0
Over 10, Under 200 : 31891
Over 200, Under 400 : 6053
Over 400 : 0


Test_zero:  2053
Train_zero:  18278
zero:  20331
Test_one:  2219
Train_one:  19666
one:  21885

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 825s - loss: 0.3913 - acc: 0.8219

Test accuracy: 84.85512539566594

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2465

choose_one :  1642

F1score :  0.8317099567099566

AUC : 0.9457817210997183

Confusion Matrix
[[1948  105]
 [ 517 1537]]
True label 0
0.9488553336580614  
0.05114466634193863  
True label 1
0.2517039922103213  
0.7482960077896786  

Train_result {'acc': [0.8218672210585776], 'loss': [0.39130077025501453]}
Saved model to disk



2

Epoch 1/1
 - 818s - loss: 0.2933 - acc: 0.8712

Test accuracy: 88.11784757730705

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  1873

choose_one :  2234

F1score :  0.8861940298507461

AUC : 0.9602322769870106

Confusion Matrix
[[1719  334]
 [ 154 1900]]
True label 0
0.8373112518265953  
0.16268874817340478  
True label 1
0.07497565725413827  
0.9250243427458618  

Train_result {'acc': [0.8712421697622891], 'loss': [0.29329336412245083]}
Saved model to disk



3

Epoch 1/1
 - 819s - loss: 0.2552 - acc: 0.8908

Test accuracy: 89.38397857316777

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2287

choose_one :  1820

F1score :  0.8874548270521424

AUC : 0.968920965400338

Confusion Matrix
[[1952  101]
 [ 335 1719]]
True label 0
0.950803701899659  
0.049196298100340964  
True label 1
0.16309639727361247  
0.8369036027263875  

Train_result {'acc': [0.8908280219946824], 'loss': [0.2552395787479437]}
Saved model to disk



4

Epoch 1/1
 - 894s - loss: 0.2233 - acc: 0.9053

Test accuracy: 90.57706355003651

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2214

choose_one :  1893

F1score :  0.901950848745883

AUC : 0.9718891678219491

Confusion Matrix
[[1940  113]
 [ 274 1780]]
True label 0
0.9449585971748661  
0.05504140282513395  
True label 1
0.13339824732229796  
0.866601752677702  

Train_result {'acc': [0.9053259293722025], 'loss': [0.22326742421404508]}
Saved model to disk



5

Epoch 1/1
 - 964s - loss: 0.1976 - acc: 0.9185

Test accuracy: 90.09009009009009

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  1850

choose_one :  2257

F1score :  0.9055903502667595

AUC : 0.9729786035208172

Confusion Matrix
[[1748  305]
 [ 102 1952]]
True label 0
0.8514369215781783  
0.14856307842182173  
True label 1
0.04965920155793573  
0.9503407984420643  

Train_result {'acc': [0.9185108187263401], 'loss': [0.1975663521571112]}
Saved model to disk



6

Epoch 1/1
 - 872s - loss: 0.1782 - acc: 0.9281

Test accuracy: 91.42926710494278

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2115

choose_one :  1992

F1score :  0.9130004943153732

AUC : 0.9741868479452256

Confusion Matrix
[[1908  145]
 [ 207 1847]]
True label 0
0.9293716512420848  
0.07062834875791525  
True label 1
0.10077896786757547  
0.8992210321324245  

Train_result {'acc': [0.9280849084990562], 'loss': [0.17820267704978035]}
Saved model to disk



7

Epoch 1/1
 - 872s - loss: 0.1573 - acc: 0.9385

Test accuracy: 91.94058923788654

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2138

choose_one :  1969

F1score :  0.9177230922197365

AUC : 0.9759056616033439

Confusion Matrix
[[1930  123]
 [ 208 1846]]
True label 0
0.9400876765708719  
0.059912323429128105  
True label 1
0.10126582278481013  
0.8987341772151899  

Train_result {'acc': [0.9385069890871681], 'loss': [0.15733316906144426]}
Saved model to disk



8

Epoch 1/1
 - 871s - loss: 0.1383 - acc: 0.9457

Test accuracy: 91.98928658388118

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2070

choose_one :  2037

F1score :  0.9195795648985579

AUC : 0.9759456202266046

Confusion Matrix
[[1897  156]
 [ 173 1881]]
True label 0
0.9240136385776911  
0.07598636142230882  
True label 1
0.08422590068159688  
0.9157740993184031  

Train_result {'acc': [0.9456738791476325], 'loss': [0.13834019968491543]}
Saved model to disk



9

Epoch 1/1
 - 869s - loss: 0.1274 - acc: 0.9528

Test accuracy: 92.33016800584369

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2036

choose_one :  2071

F1score :  0.9236363636363636

AUC : 0.9762111019995438

Confusion Matrix
[[1887  166]
 [ 149 1905]]
True label 0
0.9191427179736971  
0.08085728202630298  
True label 1
0.07254138266796495  
0.927458617332035  

Train_result {'acc': [0.9528407692097273], 'loss': [0.12739852419693254]}
Saved model to disk



10

Epoch 1/1
 - 867s - loss: 0.1114 - acc: 0.9586

Test accuracy: 91.79449719990261

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2046

choose_one :  2061

F1score :  0.9181044957472662

AUC : 0.975812582911179

Confusion Matrix
[[1881  172]
 [ 165 1889]]
True label 0
0.9162201656113005  
0.08377983438869946  
True label 1
0.08033106134371958  
0.9196689386562804  

Train_result {'acc': [0.9586125776185136], 'loss': [0.11140007760427607]}
Saved model to disk



11

Epoch 1/1
 - 871s - loss: 0.0990 - acc: 0.9636

Test accuracy: 91.72145118091063

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2115

choose_one :  1992

F1score :  0.9159663865546219

AUC : 0.9751024577043308

Confusion Matrix
[[1914  139]
 [ 201 1853]]
True label 0
0.9322942036044812  
0.06770579639551876  
True label 1
0.09785783836416748  
0.9021421616358325  

Train_result {'acc': [0.9635911043028695], 'loss': [0.09896250476610936]}
Saved model to disk



12

Epoch 1/1
 - 871s - loss: 0.0925 - acc: 0.9670

Test accuracy: 91.64840516191867

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2060

choose_one :  2047

F1score :  0.9163618629602537

AUC : 0.974718760063763

Confusion Matrix
[[1885  168]
 [ 175 1879]]
True label 0
0.9181685338528982  
0.08183146614710181  
True label 1
0.08519961051606621  
0.9148003894839338  

Train_result {'acc': [0.9670377766228082], 'loss': [0.09253720714288695]}
Saved model to disk



13

Epoch 1/1
 - 865s - loss: 0.0817 - acc: 0.9719

Test accuracy: 92.1353786218651

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  1992

choose_one :  2115

F1score :  0.9225233869033342

AUC : 0.9744894426234484

Confusion Matrix
[[1861  192]
 [ 131 1923]]
True label 0
0.9064783244033122  
0.09352167559668777  
True label 1
0.06377799415774099  
0.936222005842259  

Train_result {'acc': [0.9719068851399076], 'loss': [0.08169804466814429]}
Saved model to disk



14

Epoch 1/1
 - 866s - loss: 0.0787 - acc: 0.9727

Test accuracy: 91.69710250791331

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2186

choose_one :  1921

F1score :  0.9142138364779875

AUC : 0.9741928950959268

Confusion Matrix
[[1949  104]
 [ 237 1817]]
True label 0
0.9493424257184608  
0.05065757428153921  
True label 1
0.11538461538461539  
0.8846153846153846  

Train_result {'acc': [0.9727275214049292], 'loss': [0.07871289265996444]}
Saved model to disk



15

Epoch 1/1
 - 868s - loss: 0.0765 - acc: 0.9744

Test accuracy: 91.84319454589725

data size :  40664

zero :  20331

one :  20333

train_zero :  18278

train_one :  18279

test_zero :  2053

test_one :  2054

choose_zero :  2096

choose_one :  2011

F1score :  0.9175891758917589

AUC : 0.9744520925750001

Confusion Matrix
[[1907  146]
 [ 189 1865]]
True label 0
0.9288845591816853  
0.07111544081831467  
True label 1
0.09201557935735151  
0.9079844206426485  

Train_result {'acc': [0.9744235030226769], 'loss': [0.07646610080589071]}
Saved model to disk




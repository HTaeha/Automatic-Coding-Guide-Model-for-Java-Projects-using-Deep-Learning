Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 17:00:33.307652: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 17:00:33.317392: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-04 17:00:33.320363: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x63b1c80 executing computations on platform Host. Devices:
2019-07-04 17:00:33.320428: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41586

one : 
17568
guava-CAST
all data

Sentence length Average : 67

Under 10 : 3464
Over 10, Under 200 : 52177
Over 200, Under 400 : 2905
Over 400 : 608

guava-CAST
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 46903
Over 200, Under 400 : 3082
Over 400 : 0


Test_zero:  3823
Train_zero:  34834
zero:  38657
Test_one:  1748
Train_one:  15151
one:  16899

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 687s - loss: 0.2888 - acc: 0.8785

Test accuracy: 91.44981412639405

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1866

choose_one :  1631

F1score :  0.9115122817401599

AUC : 0.9733065838210261

Confusion Matrix
[[1658   91]
 [ 208 1540]]
True label 0
0.9479702687249857  
0.05202973127501429  
True label 1
0.11899313501144165  
0.8810068649885584  

Train_result {'loss': [0.2887583831802467], 'acc': [0.8785268784993412]}
Saved model to disk



2

Epoch 1/1
 - 719s - loss: 0.1867 - acc: 0.9276

Test accuracy: 93.76608521589934

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1771

choose_one :  1726

F1score :  0.9372481289579736

AUC : 0.984460064136028

Confusion Matrix
[[1651   98]
 [ 120 1628]]
True label 0
0.9439679817038308  
0.05603201829616924  
True label 1
0.06864988558352403  
0.931350114416476  

Train_result {'loss': [0.18673357315096206], 'acc': [0.9275979276018615]}
Saved model to disk



3

Epoch 1/1
 - 724s - loss: 0.1423 - acc: 0.9447

Test accuracy: 93.79468115527595

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1836

choose_one :  1661

F1score :  0.9363449691991785

AUC : 0.9873921089919968

Confusion Matrix
[[1684   65]
 [ 152 1596]]
True label 0
0.9628359062321327  
0.037164093767867355  
True label 1
0.08695652173913043  
0.9130434782608695  

Train_result {'loss': [0.1422683840228265], 'acc': [0.9446589446314073]}
Saved model to disk



4

Epoch 1/1
 - 720s - loss: 0.1127 - acc: 0.9582

Test accuracy: 94.33800400343151

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1673

choose_one :  1824

F1score :  0.9445688689809629

AUC : 0.9912521113732201

Confusion Matrix
[[1612  137]
 [  61 1687]]
True label 0
0.9216695254431103  
0.07833047455688966  
True label 1
0.03489702517162471  
0.9651029748283753  

Train_result {'loss': [0.11271512695523539], 'acc': [0.9582219582258922]}
Saved model to disk



5

Epoch 1/1
 - 720s - loss: 0.0910 - acc: 0.9670

Test accuracy: 95.93937660852158

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1761

choose_one :  1736

F1score :  0.9592422502870264

AUC : 0.9918856868848234

Confusion Matrix
[[1684   65]
 [  77 1671]]
True label 0
0.9628359062321327  
0.037164093767867355  
True label 1
0.044050343249427915  
0.9559496567505721  

Train_result {'loss': [0.09095060855316307], 'acc': [0.9669669669669669]}
Saved model to disk



6

Epoch 1/1
 - 721s - loss: 0.0753 - acc: 0.9729

Test accuracy: 96.08235630540463

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1676

choose_one :  1821

F1score :  0.9616138974502662

AUC : 0.9946365232568334

Confusion Matrix
[[1644  105]
 [  32 1716]]
True label 0
0.9399656946826758  
0.060034305317324184  
True label 1
0.018306636155606407  
0.9816933638443935  

Train_result {'loss': [0.07529484223144989], 'acc': [0.9728739728444685]}
Saved model to disk



7

Epoch 1/1
 - 721s - loss: 0.0616 - acc: 0.9779

Test accuracy: 96.88304260794968

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1730

choose_one :  1767

F1score :  0.9689900426742531

AUC : 0.9954629189873782

Confusion Matrix
[[1685   64]
 [  45 1703]]
True label 0
0.9634076615208691  
0.03659233847913093  
True label 1
0.02574370709382151  
0.9742562929061785  

Train_result {'loss': [0.06160793934427776], 'acc': [0.9779229778934736]}
Saved model to disk



8

Epoch 1/1
 - 720s - loss: 0.0501 - acc: 0.9828

Test accuracy: 96.88304260794968

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1724

choose_one :  1773

F1score :  0.9690428855438795

AUC : 0.9950377005232149

Confusion Matrix
[[1682   67]
 [  42 1706]]
True label 0
0.9616923956546598  
0.038307604345340196  
True label 1
0.02402745995423341  
0.9759725400457666  

Train_result {'loss': [0.05014559097711504], 'acc': [0.9827739827759497]}
Saved model to disk



9

Epoch 1/1
 - 720s - loss: 0.0460 - acc: 0.9840

Test accuracy: 97.19759794109237

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1717

choose_one :  1780

F1score :  0.9722222222222222

AUC : 0.9956192685457398

Confusion Matrix
[[1684   65]
 [  33 1715]]
True label 0
0.9628359062321327  
0.037164093767867355  
True label 1
0.01887871853546911  
0.9811212814645309  

Train_result {'loss': [0.04603057759429736], 'acc': [0.9840279840279841]}
Saved model to disk



10

Epoch 1/1
 - 720s - loss: 0.0421 - acc: 0.9858

Test accuracy: 97.19759794109237

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1721

choose_one :  1776

F1score :  0.9721906923950057

AUC : 0.9954867966395966

Confusion Matrix
[[1686   63]
 [  35 1713]]
True label 0
0.9639794168096055  
0.036020583190394515  
True label 1
0.02002288329519451  
0.9799771167048055  

Train_result {'loss': [0.042055188337139005], 'acc': [0.9858429858449528]}
Saved model to disk



11

Epoch 1/1
 - 720s - loss: 0.0378 - acc: 0.9870

Test accuracy: 97.3119816985988

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1717

choose_one :  1780

F1score :  0.9733560090702947

AUC : 0.9961023821392545

Confusion Matrix
[[1686   63]
 [  31 1717]]
True label 0
0.9639794168096055  
0.036020583190394515  
True label 1
0.017734553775743706  
0.9822654462242563  

Train_result {'loss': [0.0378044517689738], 'acc': [0.9869649869649869]}
Saved model to disk



12

Epoch 1/1
 - 719s - loss: 0.0380 - acc: 0.9888

Test accuracy: 97.3119816985988

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1699

choose_one :  1798

F1score :  0.9734912577552173

AUC : 0.9950082623218498

Confusion Matrix
[[1677   72]
 [  22 1726]]
True label 0
0.9588336192109777  
0.0411663807890223  
True label 1
0.012585812356979404  
0.9874141876430206  

Train_result {'loss': [0.03795896878344518], 'acc': [0.9888129888129888]}
Saved model to disk



13

Epoch 1/1
 - 719s - loss: 0.0332 - acc: 0.9897

Test accuracy: 97.85530454675437

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1716

choose_one :  1781

F1score :  0.9787475205440634

AUC : 0.9952030450875492

Confusion Matrix
[[1695   54]
 [  21 1727]]
True label 0
0.9691252144082333  
0.030874785591766724  
True label 1
0.012013729977116704  
0.9879862700228833  

Train_result {'loss': [0.03315887630970252], 'acc': [0.9897369897369898]}
Saved model to disk



14

Epoch 1/1
 - 720s - loss: 0.0311 - acc: 0.9902

Test accuracy: 97.82670860737775

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1775

choose_one :  1722

F1score :  0.9780979827089337

AUC : 0.9957695669182651

Confusion Matrix
[[1724   25]
 [  51 1697]]
True label 0
0.9857061177815895  
0.01429388221841052  
True label 1
0.02917620137299771  
0.9708237986270023  

Train_result {'loss': [0.03112222411142865], 'acc': [0.9902319902024859]}
Saved model to disk



15

Epoch 1/1
 - 720s - loss: 0.0323 - acc: 0.9902

Test accuracy: 98.02688018301401

data size :  33800

zero :  16901

one :  16899

train_zero :  15152

train_one :  15151

test_zero :  1749

test_one :  1748

choose_zero :  1720

choose_one :  1777

F1score :  0.9804255319148937

AUC : 0.995320961438573

Confusion Matrix
[[1700   49]
 [  20 1728]]
True label 0
0.9719839908519153  
0.02801600914808462  
True label 1
0.011441647597254004  
0.988558352402746  

Train_result {'loss': [0.032261262127010214], 'acc': [0.9901659901659902]}
Saved model to disk




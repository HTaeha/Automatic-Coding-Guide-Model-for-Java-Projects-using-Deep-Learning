Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-04 01:05:37.970622: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-04 01:05:37.980958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-07-04 01:05:37.983545: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x74a9f70 executing computations on platform Host. Devices:
2019-07-04 01:05:37.983616: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41596

one : 
17568
guava-CAST_s
all data

Sentence length Average : 50

Under 10 : 5631
Over 10, Under 200 : 52010
Over 200, Under 400 : 1282
Over 400 : 241

guava-CAST_s
updated_train_data

Sentence length Average : 52

Under 10 : 0
Over 10, Under 200 : 46396
Over 200, Under 400 : 1316
Over 400 : 0


Test_zero:  3646
Train_zero:  32992
zero:  36638
Test_one:  1670
Train_one:  14720
one:  16390

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 664s - loss: 0.2933 - acc: 0.8735

Test accuracy: 91.37982639928165

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1815

choose_one :  1526

F1score :  0.9098873591989988

AUC : 0.9754401430532113

Confusion Matrix
[[1599   72]
 [ 216 1454]]
True label 0
0.9569120287253142  
0.04308797127468582  
True label 1
0.12934131736526946  
0.8706586826347306  

Train_result {'acc': [0.8735436975646208], 'loss': [0.29332712919394577]}
Saved model to disk



2

Epoch 1/1
 - 661s - loss: 0.1952 - acc: 0.9214

Test accuracy: 93.53486979946123

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1635

choose_one :  1706

F1score :  0.9360189573459716

AUC : 0.9820728381656793

Confusion Matrix
[[1545  126]
 [  90 1580]]
True label 0
0.9245960502692998  
0.07540394973070018  
True label 1
0.05389221556886228  
0.9461077844311377  

Train_result {'acc': [0.9214360925240311], 'loss': [0.19521766462300433]}
Saved model to disk



3

Epoch 1/1
 - 755s - loss: 0.1521 - acc: 0.9398

Test accuracy: 94.19335528284944

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1585

choose_one :  1756

F1score :  0.9433741973146527

AUC : 0.9895978241004527

Confusion Matrix
[[1531  140]
 [  54 1616]]
True label 0
0.9162178336325554  
0.08378216636744465  
True label 1
0.032335329341317366  
0.9676646706586827  

Train_result {'acc': [0.9398118270439183], 'loss': [0.1521153586127464]}
Saved model to disk



4

Epoch 1/1
 - 755s - loss: 0.1205 - acc: 0.9531

Test accuracy: 95.18108350793175

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1698

choose_one :  1643

F1score :  0.9514035617265318

AUC : 0.9921120057909316

Confusion Matrix
[[1604   67]
 [  94 1576]]
True label 0
0.959904248952723  
0.04009575104727708  
True label 1
0.0562874251497006  
0.9437125748502994  

Train_result {'acc': [0.9531265921673856], 'loss': [0.12051444156133904]}
Saved model to disk



5

Epoch 1/1
 - 752s - loss: 0.0947 - acc: 0.9631

Test accuracy: 95.95929362466327

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1670

choose_one :  1671

F1score :  0.9595929362466328

AUC : 0.9929100506348166

Confusion Matrix
[[1603   68]
 [  67 1603]]
True label 0
0.9593058049072412  
0.040694195092758824  
True label 1
0.040119760479041915  
0.9598802395209581  

Train_result {'acc': [0.9631466322475459], 'loss': [0.0946922394572815]}
Saved model to disk



6

Epoch 1/1
 - 752s - loss: 0.0783 - acc: 0.9715

Test accuracy: 95.80963783298414

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1661

choose_one :  1680

F1score :  0.9582089552238807

AUC : 0.9927117040604608

Confusion Matrix
[[1596   75]
 [  65 1605]]
True label 0
0.9551166965888689  
0.04488330341113106  
True label 1
0.038922155688622756  
0.9610778443113772  

Train_result {'acc': [0.9715023266872729], 'loss': [0.07829977146151726]}
Saved model to disk



7

Epoch 1/1
 - 751s - loss: 0.0652 - acc: 0.9759

Test accuracy: 97.27626459143968

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1660

choose_one :  1681

F1score :  0.9728439271859147

AUC : 0.9954545128772974

Confusion Matrix
[[1620   51]
 [  40 1630]]
True label 0
0.9694793536804309  
0.03052064631956912  
True label 1
0.023952095808383235  
0.9760479041916168  

Train_result {'acc': [0.9758500050949356], 'loss': [0.06524446299552034]}
Saved model to disk



8

Epoch 1/1
 - 748s - loss: 0.0556 - acc: 0.9803

Test accuracy: 96.46812331637234

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1685

choose_one :  1656

F1score :  0.9645219482862296

AUC : 0.994354379212849

Confusion Matrix
[[1619   52]
 [  66 1604]]
True label 0
0.9688809096349491  
0.031119090365050867  
True label 1
0.03952095808383234  
0.9604790419161676  

Train_result {'acc': [0.9803335484528379], 'loss': [0.05561765159138726]}
Saved model to disk



9

Epoch 1/1
 - 751s - loss: 0.0476 - acc: 0.9835

Test accuracy: 96.6477102663873

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1669

choose_one :  1672

F1score :  0.9664871334530222

AUC : 0.9949230802309206

Confusion Matrix
[[1614   57]
 [  55 1615]]
True label 0
0.9658886894075404  
0.03411131059245961  
True label 1
0.03293413173652695  
0.9670658682634731  

Train_result {'acc': [0.9834584423083456], 'loss': [0.047556940860738396]}
Saved model to disk



10

Epoch 1/1
 - 752s - loss: 0.0422 - acc: 0.9857

Test accuracy: 97.03681532475306

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1636

choose_one :  1705

F1score :  0.9706666666666667

AUC : 0.9951481238599998

Confusion Matrix
[[1604   67]
 [  32 1638]]
True label 0
0.959904248952723  
0.04009575104727708  
True label 1
0.019161676646706587  
0.9808383233532935  

Train_result {'acc': [0.9857341802248565], 'loss': [0.04218304837648537]}
Saved model to disk



11

Epoch 1/1
 - 751s - loss: 0.0370 - acc: 0.9875

Test accuracy: 97.27626459143968

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1652

choose_one :  1689

F1score :  0.9729086037511164

AUC : 0.9959691030864661

Confusion Matrix
[[1616   55]
 [  36 1634]]
True label 0
0.9670855774985039  
0.03291442250149611  
True label 1
0.02155688622754491  
0.9784431137724551  

Train_result {'acc': [0.9875343908155294], 'loss': [0.03696195771934056]}
Saved model to disk



12

Epoch 1/1
 - 750s - loss: 0.0350 - acc: 0.9889

Test accuracy: 97.21640227476803

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1664

choose_one :  1677

F1score :  0.9722139229160442

AUC : 0.9944256908086878

Confusion Matrix
[[1621   50]
 [  43 1627]]
True label 0
0.9700777977259126  
0.029922202274087373  
True label 1
0.025748502994011976  
0.974251497005988  

Train_result {'acc': [0.9889270065554838], 'loss': [0.03497249925833556]}
Saved model to disk



13

Epoch 1/1
 - 750s - loss: 0.0350 - acc: 0.9883

Test accuracy: 97.03681532475306

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1610

choose_one :  1731

F1score :  0.9708909144369303

AUC : 0.9922583916547515

Confusion Matrix
[[1591   80]
 [  19 1651]]
True label 0
0.9521244763614602  
0.047875523638539794  
True label 1
0.011377245508982036  
0.988622754491018  

Train_result {'acc': [0.9883156142794063], 'loss': [0.03497960316307614]}
Saved model to disk



14

Epoch 1/1
 - 753s - loss: 0.0309 - acc: 0.9912

Test accuracy: 97.45585154145465

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1666

choose_one :  1675

F1score :  0.9745889387144994

AUC : 0.9937342550088333

Confusion Matrix
[[1626   45]
 [  40 1630]]
True label 0
0.9730700179533214  
0.026929982046678635  
True label 1
0.023952095808383235  
0.9760479041916168  

Train_result {'acc': [0.9911687782344349], 'loss': [0.030912017720620886]}
Saved model to disk



15

Epoch 1/1
 - 752s - loss: 0.0289 - acc: 0.9913

Test accuracy: 97.36605806644717

data size :  32782

zero :  16392

one :  16390

train_zero :  14721

train_one :  14720

test_zero :  1671

test_one :  1670

choose_zero :  1645

choose_one :  1696

F1score :  0.9738562091503268

AUC : 0.9949279179522463

Confusion Matrix
[[1614   57]
 [  31 1639]]
True label 0
0.9658886894075404  
0.03411131059245961  
True label 1
0.018562874251497007  
0.981437125748503  

Train_result {'acc': [0.9912706769471146], 'loss': [0.02894926003105904]}
Saved model to disk




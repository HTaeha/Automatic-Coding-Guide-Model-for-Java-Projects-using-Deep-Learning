Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 10:41:15.390945: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 10:41:15.397225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-02 10:41:15.399443: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5241380 executing computations on platform Host. Devices:
2019-07-02 10:41:15.399462: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-code
all data

Sentence length Average : 60

Under 10 : 8815
Over 10, Under 200 : 37126
Over 200, Under 400 : 2541
Over 400 : 771

hbase-code
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 31808
Over 200, Under 400 : 2783
Over 400 : 0


Test_zero:  1716
Train_zero:  15724
zero:  17440
Test_one:  2118
Train_one:  18867
one:  20985

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 739s - loss: 0.3791 - acc: 0.8314

Test accuracy: 87.00844742207981

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1678

choose_one :  1755

F1score :  0.8715437788018433

AUC : 0.9475962302112564

Confusion Matrix
[[1474  242]
 [ 204 1513]]
True label 0
0.8589743589743589  
0.14102564102564102  
True label 1
0.1188118811881188  
0.8811881188118812  

Train_result {'acc': [0.8314095837838161], 'loss': [0.3791071011838619]}
Saved model to disk



2

Epoch 1/1
 - 751s - loss: 0.2751 - acc: 0.8822

Test accuracy: 88.78531896300612

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1565

choose_one :  1868

F1score :  0.8926080892608089

AUC : 0.9638681062676404

Confusion Matrix
[[1448  268]
 [ 117 1600]]
True label 0
0.8438228438228438  
0.1561771561771562  
True label 1
0.0681421083284799  
0.9318578916715201  

Train_result {'acc': [0.8821584152081399], 'loss': [0.275138154338284]}
Saved model to disk



3

Epoch 1/1
 - 750s - loss: 0.2341 - acc: 0.9020

Test accuracy: 89.97960967084182

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1792

choose_one :  1641

F1score :  0.8975580702799284

AUC : 0.966339959787834

Confusion Matrix
[[1582  134]
 [ 210 1507]]
True label 0
0.921911421911422  
0.0780885780885781  
True label 1
0.12230634828188701  
0.877693651718113  

Train_result {'acc': [0.901968266064535], 'loss': [0.23413482290122]}
Saved model to disk



4

Epoch 1/1
 - 753s - loss: 0.2082 - acc: 0.9153

Test accuracy: 90.9408680454413

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1801

choose_one :  1632

F1score :  0.9071364586443715

AUC : 0.9709276357500003

Confusion Matrix
[[1603  113]
 [ 198 1519]]
True label 0
0.9341491841491841  
0.06585081585081586  
True label 1
0.11531741409435062  
0.8846825859056494  

Train_result {'acc': [0.9152596266801347], 'loss': [0.2081522485575633]}
Saved model to disk



5

Epoch 1/1
 - 753s - loss: 0.1851 - acc: 0.9271

Test accuracy: 90.96999708709583

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1746

choose_one :  1687

F1score :  0.908930669800235

AUC : 0.9729497836661494

Confusion Matrix
[[1576  140]
 [ 170 1547]]
True label 0
0.9184149184149184  
0.08158508158508158  
True label 1
0.09900990099009901  
0.900990099009901  

Train_result {'acc': [0.9270565041775825], 'loss': [0.1851349112915422]}
Saved model to disk



6

Epoch 1/1
 - 746s - loss: 0.1643 - acc: 0.9349

Test accuracy: 90.9408680454413

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1723

choose_one :  1710

F1score :  0.9092500729501022

AUC : 0.9721291133638251

Confusion Matrix
[[1564  152]
 [ 159 1558]]
True label 0
0.9114219114219114  
0.08857808857808858  
True label 1
0.09260337798485731  
0.9073966220151427  

Train_result {'acc': [0.9349104899826245], 'loss': [0.1643108118226799]}
Saved model to disk



7

Epoch 1/1
 - 744s - loss: 0.1429 - acc: 0.9424

Test accuracy: 91.37780367025925

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1792

choose_one :  1641

F1score :  0.9118522930315665

AUC : 0.9699331924142641

Confusion Matrix
[[1606  110]
 [ 186 1531]]
True label 0
0.9358974358974359  
0.0641025641025641  
True label 1
0.10832847990681421  
0.8916715200931858  

Train_result {'acc': [0.9423511081433432], 'loss': [0.1429229931871336]}
Saved model to disk



8

Epoch 1/1
 - 745s - loss: 0.1246 - acc: 0.9525

Test accuracy: 91.46519079522284

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1737

choose_one :  1696

F1score :  0.9141517726340462

AUC : 0.9750440541791736

Confusion Matrix
[[1580  136]
 [ 157 1560]]
True label 0
0.9207459207459208  
0.07925407925407925  
True label 1
0.09143855562026791  
0.9085614443797321  

Train_result {'acc': [0.9524945149118751], 'loss': [0.12456101035981941]}
Saved model to disk



9

Epoch 1/1
 - 741s - loss: 0.1111 - acc: 0.9575

Test accuracy: 91.2321584619866

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1785

choose_one :  1648

F1score :  0.9105497771173848

AUC : 0.9732997055361644

Confusion Matrix
[[1600  116]
 [ 185 1532]]
True label 0
0.9324009324009324  
0.0675990675990676  
True label 1
0.10774606872451951  
0.8922539312754805  

Train_result {'acc': [0.957518522034518], 'loss': [0.11109136686104766]}
Saved model to disk



10

Epoch 1/1
 - 744s - loss: 0.0992 - acc: 0.9635

Test accuracy: 91.75648121176813

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1797

choose_one :  1636

F1score :  0.9155979719654042

AUC : 0.9733889678560615

Confusion Matrix
[[1615  101]
 [ 182 1535]]
True label 0
0.9411421911421911  
0.058857808857808856  
True label 1
0.1059988351776354  
0.8940011648223646  

Train_result {'acc': [0.9634646570638176], 'loss': [0.09916965169487703]}
Saved model to disk



11

Epoch 1/1
 - 745s - loss: 0.0833 - acc: 0.9702

Test accuracy: 91.87299737838626

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1779

choose_one :  1654

F1score :  0.9172352417680213

AUC : 0.9723229110241342

Confusion Matrix
[[1608  108]
 [ 171 1546]]
True label 0
0.9370629370629371  
0.06293706293706294  
True label 1
0.09959231217239371  
0.9004076878276063  

Train_result {'acc': [0.9701739323984865], 'loss': [0.08328863153476632]}
Saved model to disk



12

Epoch 1/1
 - 745s - loss: 0.0767 - acc: 0.9741

Test accuracy: 91.75648121176813

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1813

choose_one :  1620

F1score :  0.9151932873838776

AUC : 0.9730186819586936

Confusion Matrix
[[1623   93]
 [ 190 1527]]
True label 0
0.9458041958041958  
0.05419580419580419  
True label 1
0.110658124635993  
0.889341875364007  

Train_result {'acc': [0.9740532290507562], 'loss': [0.07667318102897001]}
Saved model to disk



13

Epoch 1/1
 - 741s - loss: 0.0702 - acc: 0.9749

Test accuracy: 91.96038450334983

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1730

choose_one :  1703

F1score :  0.9192982456140351

AUC : 0.9750674728106294

Confusion Matrix
[[1585  131]
 [ 145 1572]]
True label 0
0.9236596736596736  
0.07634032634032634  
True label 1
0.0844496214327315  
0.9155503785672685  

Train_result {'acc': [0.9749435594136538], 'loss': [0.07016773965699212]}
Saved model to disk



14

Epoch 1/1
 - 745s - loss: 0.0651 - acc: 0.9775

Test accuracy: 91.78561025342266

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1718

choose_one :  1715

F1score :  0.9178321678321679

AUC : 0.9740747264771726

Confusion Matrix
[[1576  140]
 [ 142 1575]]
True label 0
0.9184149184149184  
0.08158508158508158  
True label 1
0.08270238788584741  
0.9172976121141526  

Train_result {'acc': [0.9774873604713523], 'loss': [0.06514331049242793]}
Saved model to disk



15

Epoch 1/1
 - 743s - loss: 0.0620 - acc: 0.9796

Test accuracy: 92.25167491989514

data size :  34882

zero :  17440

one :  17442

train_zero :  15724

train_one :  15725

test_zero :  1716

test_one :  1717

choose_zero :  1744

choose_one :  1689

F1score :  0.92190252495596

AUC : 0.9737673993643708

Confusion Matrix
[[1597  119]
 [ 147 1570]]
True label 0
0.9306526806526807  
0.06934731934731934  
True label 1
0.0856144437973209  
0.9143855562026791  

Train_result {'acc': [0.9796495914019524], 'loss': [0.06197348016576675]}
Saved model to disk




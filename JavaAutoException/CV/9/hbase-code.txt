Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-12 17:02:23.052083: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-12 17:02:23.061696: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-12 17:02:23.064110: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5b53e10 executing computations on platform Host. Devices:
2019-07-12 17:02:23.064149: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-code
all data

Sentence length Average : 60

Under 10 : 8815
Over 10, Under 200 : 37126
Over 200, Under 400 : 2541
Over 400 : 771

hbase-code
updated_train_data

Sentence length Average : 68

Under 10 : 0
Over 10, Under 200 : 31823
Over 200, Under 400 : 2769
Over 400 : 0


Test_zero:  1757
Train_zero:  15685
zero:  17442
Test_one:  2076
Train_one:  18907
one:  20983

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 724s - loss: 0.3805 - acc: 0.8280

Test accuracy: 85.20625889046943

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1645

choose_one :  1870

F1score :  0.856670341786108

AUC : 0.9383731124583414

Confusion Matrix
[[1441  316]
 [ 204 1554]]
True label 0
0.8201479795105293  
0.1798520204894707  
True label 1
0.11604095563139932  
0.8839590443686007  

Train_result {'acc': [0.8279940072041057], 'loss': [0.3805498315024899]}
Saved model to disk



2

Epoch 1/1
 - 807s - loss: 0.2747 - acc: 0.8810

Test accuracy: 88.84779516358464

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1679

choose_one :  1836

F1score :  0.8909293266555369

AUC : 0.9635839868220925

Confusion Matrix
[[1522  235]
 [ 157 1601]]
True label 0
0.8662492885600456  
0.13375071143995446  
True label 1
0.08930602957906712  
0.9106939704209329  

Train_result {'acc': [0.8810366261815178], 'loss': [0.2747188883939482]}
Saved model to disk



3

Epoch 1/1
 - 806s - loss: 0.2331 - acc: 0.9004

Test accuracy: 89.75817923186344

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1949

choose_one :  1566

F1score :  0.8916967509025271

AUC : 0.9680213001399245

Confusion Matrix
[[1673   84]
 [ 276 1482]]
True label 0
0.952191235059761  
0.04780876494023904  
True label 1
0.15699658703071673  
0.8430034129692833  

Train_result {'acc': [0.9004494597015723], 'loss': [0.23313517953780966]}
Saved model to disk



4

Epoch 1/1
 - 807s - loss: 0.2049 - acc: 0.9165

Test accuracy: 90.7823613086771

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1723

choose_one :  1792

F1score :  0.9087323943661971

AUC : 0.9720461563464976

Confusion Matrix
[[1578  179]
 [ 145 1613]]
True label 0
0.8981217985202049  
0.10187820147979511  
True label 1
0.08248009101251422  
0.9175199089874858  

Train_result {'acc': [0.9164514997909022], 'loss': [0.20486014717747197]}
Saved model to disk



5

Epoch 1/1
 - 808s - loss: 0.1810 - acc: 0.9274

Test accuracy: 91.15220483641536

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1760

choose_one :  1755

F1score :  0.9114716766296614

AUC : 0.9739196958306866

Confusion Matrix
[[1603  154]
 [ 157 1601]]
True label 0
0.9123505976095617  
0.08764940239043825  
True label 1
0.08930602957906712  
0.9106939704209329  

Train_result {'acc': [0.9274170412259101], 'loss': [0.1810437057753083]}
Saved model to disk



6

Epoch 1/1
 - 808s - loss: 0.1601 - acc: 0.9380

Test accuracy: 91.29445234708392

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1829

choose_one :  1686

F1score :  0.9111498257839721

AUC : 0.9734437837792338

Confusion Matrix
[[1640  117]
 [ 189 1569]]
True label 0
0.93340922026181  
0.0665907797381901  
True label 1
0.1075085324232082  
0.8924914675767918  

Train_result {'acc': [0.937968187179242], 'loss': [0.16008483928306366]}
Saved model to disk



7

Epoch 1/1
 - 808s - loss: 0.1371 - acc: 0.9458

Test accuracy: 92.09103840682789

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1875

choose_one :  1640

F1score :  0.9181871689228959

AUC : 0.97417108746875

Confusion Matrix
[[1677   80]
 [ 198 1560]]
True label 0
0.9544678429140581  
0.045532157085941945  
True label 1
0.11262798634812286  
0.8873720136518771  

Train_result {'acc': [0.9458098243600778], 'loss': [0.13705263848142998]}
Saved model to disk



8

Epoch 1/1
 - 800s - loss: 0.1177 - acc: 0.9553

Test accuracy: 91.72119487908962

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1858

choose_one :  1657

F1score :  0.914787701317716

AUC : 0.9747972193786207

Confusion Matrix
[[1662   95]
 [ 196 1562]]
True label 0
0.9459305634604439  
0.05406943653955606  
True label 1
0.11149032992036405  
0.888509670079636  

Train_result {'acc': [0.9552771668196112], 'loss': [0.11772453548013641]}
Saved model to disk



9

Epoch 1/1
 - 807s - loss: 0.1045 - acc: 0.9610

Test accuracy: 92.00568990042674

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1792

choose_one :  1723

F1score :  0.9192760700948004

AUC : 0.9759538151635294

Confusion Matrix
[[1634  123]
 [ 158 1600]]
True label 0
0.9299943084803642  
0.07000569151963575  
True label 1
0.08987485779294653  
0.9101251422070534  

Train_result {'acc': [0.9610149501226618], 'loss': [0.1045034294578374]}
Saved model to disk



10

Epoch 1/1
 - 808s - loss: 0.0879 - acc: 0.9682

Test accuracy: 91.74964438122333

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1729

choose_one :  1786

F1score :  0.9181715575620766

AUC : 0.9763282316856416

Confusion Matrix
[[1598  159]
 [ 131 1627]]
True label 0
0.9095048377916903  
0.09049516220830962  
True label 1
0.0745164960182025  
0.9254835039817975  

Train_result {'acc': [0.9681871792419751], 'loss': [0.08794671923476932]}
Saved model to disk



11

Epoch 1/1
 - 807s - loss: 0.0789 - acc: 0.9712

Test accuracy: 91.40825035561878

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1911

choose_one :  1604

F1score :  0.9101725163593098

AUC : 0.9747314981905628

Confusion Matrix
[[1683   74]
 [ 228 1530]]
True label 0
0.9578827546955037  
0.0421172453044963  
True label 1
0.1296928327645051  
0.8703071672354948  

Train_result {'acc': [0.9712473303350354], 'loss': [0.0788772151088837]}
Saved model to disk



12

Epoch 1/1
 - 804s - loss: 0.0714 - acc: 0.9752

Test accuracy: 92.48933143669986

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1769

choose_one :  1746

F1score :  0.9246575342465754

AUC : 0.9759059002086892

Confusion Matrix
[[1631  126]
 [ 138 1620]]
True label 0
0.9282868525896414  
0.07171314741035857  
True label 1
0.07849829351535836  
0.9215017064846417  

Train_result {'acc': [0.975231902075165], 'loss': [0.07135184936581722]}
Saved model to disk



13

Epoch 1/1
 - 806s - loss: 0.0685 - acc: 0.9778

Test accuracy: 92.29018492176387

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1762

choose_one :  1753

F1score :  0.9228140131016805

AUC : 0.9754375962750654

Confusion Matrix
[[1624  133]
 [ 138 1620]]
True label 0
0.9243027888446215  
0.07569721115537849  
True label 1
0.07849829351535836  
0.9215017064846417  

Train_result {'acc': [0.9778457811335436], 'loss': [0.06854992414252767]}
Saved model to disk



14

Epoch 1/1
 - 805s - loss: 0.0610 - acc: 0.9800

Test accuracy: 92.1479374110953

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1807

choose_one :  1708

F1score :  0.9203693017888056

AUC : 0.9741147550218434

Confusion Matrix
[[1644  113]
 [ 163 1595]]
True label 0
0.935685828116107  
0.064314171883893  
True label 1
0.09271899886234357  
0.9072810011376564  

Train_result {'acc': [0.9799815115966346], 'loss': [0.0609659288936853]}
Saved model to disk



15

Epoch 1/1
 - 808s - loss: 0.0566 - acc: 0.9818

Test accuracy: 92.46088193456615

data size :  34886

zero :  17442

one :  17444

train_zero :  15685

train_one :  15686

test_zero :  1757

test_one :  1758

choose_zero :  1744

choose_one :  1771

F1score :  0.9249079059223577

AUC : 0.9754890724765491

Confusion Matrix
[[1618  139]
 [ 126 1632]]
True label 0
0.9208878770631759  
0.07911212293682413  
True label 1
0.07167235494880546  
0.9283276450511946  

Train_result {'acc': [0.9817665997258614], 'loss': [0.0565845177541736]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
doc_product.py:515: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("ou...)`
  model = Model(input=input1, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-13 13:11:50.850508: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-13 13:11:51.162156: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-13 13:11:51.175320: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x59be850 executing computations on platform Host. Devices:
2019-07-13 13:11:51.175359: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34901
Over 200, Under 400 : 299
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34305
Over 200, Under 400 : 895
Over 400 : 0


Test_zero:  2449
Train_zero:  21745
zero:  24194
Test_one:  1486
Train_one:  13455
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 800, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 800, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            1026        after_dp_1[0][0]                 
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1609s - loss: 0.2899 - acc: 0.8783

Test accuracy: 91.05280861083081

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1473

choose_one :  1500

F1score :  0.9109176155391829

AUC : 0.9700653759228703

Confusion Matrix
[[1347  140]
 [ 126 1360]]
True label 0
0.9058507061197041  
0.0941492938802959  
True label 1
0.0847913862718708  
0.9152086137281292  

Train_result {'acc': [0.8783397123896998], 'loss': [0.2898982926826095]}
Saved model to disk



2

Epoch 1/1
 - 1446s - loss: 0.1871 - acc: 0.9269

Test accuracy: 93.87823747056845

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1475

choose_one :  1498

F1score :  0.9390080428954423

AUC : 0.9840882081675102

Confusion Matrix
[[1390   97]
 [  85 1401]]
True label 0
0.9347679892400808  
0.0652320107599193  
True label 1
0.05720053835800808  
0.9427994616419919  

Train_result {'acc': [0.9268700531048988], 'loss': [0.18713254549273997]}
Saved model to disk



3

Epoch 1/1
 - 1465s - loss: 0.1440 - acc: 0.9456

Test accuracy: 94.820047090481

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1533

choose_one :  1440

F1score :  0.9473684210526315

AUC : 0.9881313238737521

Confusion Matrix
[[1433   54]
 [ 100 1386]]
True label 0
0.9636852723604573  
0.0363147276395427  
True label 1
0.06729475100942127  
0.9327052489905787  

Train_result {'acc': [0.9456356136917842], 'loss': [0.14404816187195305]}
Saved model to disk



4

Epoch 1/1
 - 1495s - loss: 0.1093 - acc: 0.9611

Test accuracy: 95.29095190043726

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1431

choose_one :  1542

F1score :  0.9537648612945839

AUC : 0.9912190984947155

Confusion Matrix
[[1389   98]
 [  42 1444]]
True label 0
0.9340954942837929  
0.06590450571620712  
True label 1
0.02826379542395693  
0.971736204576043  

Train_result {'acc': [0.9610939764076374], 'loss': [0.10928307706554183]}
Saved model to disk



5

Epoch 1/1
 - 1484s - loss: 0.0809 - acc: 0.9712

Test accuracy: 96.50184998318197

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1527

choose_one :  1446

F1score :  0.9645293315143246

AUC : 0.9943113986537427

Confusion Matrix
[[1455   32]
 [  72 1414]]
True label 0
0.9784801613987895  
0.02151983860121049  
True label 1
0.04845222072678331  
0.9515477792732167  

Train_result {'acc': [0.9711642079469215], 'loss': [0.08085459669575941]}
Saved model to disk



6

Epoch 1/1
 - 1478s - loss: 0.0641 - acc: 0.9784

Test accuracy: 96.90548267743021

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1503

choose_one :  1470

F1score :  0.9688768606224627

AUC : 0.995933351495826

Confusion Matrix
[[1449   38]
 [  54 1432]]
True label 0
0.9744451916610626  
0.025554808338937456  
True label 1
0.03633916554508748  
0.9636608344549125  

Train_result {'acc': [0.9784474750102189], 'loss': [0.06414735267250066]}
Saved model to disk



7

Epoch 1/1
 - 1480s - loss: 0.0515 - acc: 0.9834

Test accuracy: 97.20820719811638

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1460

choose_one :  1513

F1score :  0.972324108036012

AUC : 0.9969977580484433

Confusion Matrix
[[1432   55]
 [  28 1458]]
True label 0
0.9630127774041695  
0.03698722259583053  
True label 1
0.018842530282637954  
0.9811574697173621  

Train_result {'acc': [0.9834268514733752], 'loss': [0.05149900649120102]}
Saved model to disk



8

Epoch 1/1
 - 1481s - loss: 0.0406 - acc: 0.9861

Test accuracy: 97.37638748738647

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1473

choose_one :  1500

F1score :  0.9738780977896853

AUC : 0.9976512457448629

Confusion Matrix
[[1441   46]
 [  32 1454]]
True label 0
0.9690652320107599  
0.03093476798924008  
True label 1
0.021534320323014805  
0.9784656796769852  

Train_result {'acc': [0.9860651778083311], 'loss': [0.04055628206635972]}
Saved model to disk



9

Epoch 1/1
 - 1493s - loss: 0.0353 - acc: 0.9884

Test accuracy: 97.88092835519677

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1454

choose_one :  1519

F1score :  0.9790349417637272

AUC : 0.9967907146820221

Confusion Matrix
[[1439   48]
 [  15 1471]]
True label 0
0.9677202420981843  
0.03227975790181574  
True label 1
0.010094212651413189  
0.9899057873485868  

Train_result {'acc': [0.988443387462376], 'loss': [0.035327917249574375]}
Saved model to disk



10

Epoch 1/1
 - 1481s - loss: 0.0310 - acc: 0.9907

Test accuracy: 97.7463841237807

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1468

choose_one :  1505

F1score :  0.9775994650618522

AUC : 0.9978537635732201

Confusion Matrix
[[1444   43]
 [  24 1462]]
True label 0
0.9710827168796234  
0.028917283120376596  
True label 1
0.016150740242261104  
0.9838492597577388  

Train_result {'acc': [0.990672959013043], 'loss': [0.03098088012982216]}
Saved model to disk



11

Epoch 1/1
 - 1465s - loss: 0.0305 - acc: 0.9916

Test accuracy: 97.88092835519677

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1450

choose_one :  1523

F1score :  0.979062811565304

AUC : 0.9981200914882774

Confusion Matrix
[[1437   50]
 [  13 1473]]
True label 0
0.9663752521856086  
0.03362474781439139  
True label 1
0.008748317631224764  
0.9912516823687753  

Train_result {'acc': [0.9915647876333098], 'loss': [0.030533638478556353]}
Saved model to disk



12

Epoch 1/1
 - 1456s - loss: 0.0255 - acc: 0.9925

Test accuracy: 98.04910864446687

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1471

choose_one :  1502

F1score :  0.9805890227576974

AUC : 0.9971663343413215

Confusion Matrix
[[1450   37]
 [  21 1465]]
True label 0
0.9751176866173503  
0.02488231338264963  
True label 1
0.014131897711978465  
0.9858681022880216  

Train_result {'acc': [0.9925309353052655], 'loss': [0.0255091469539246]}
Saved model to disk



13

Epoch 1/1
 - 1454s - loss: 0.0255 - acc: 0.9926

Test accuracy: 98.21728893373697

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1474

choose_one :  1499

F1score :  0.9822445561139028

AUC : 0.9981040258281508

Confusion Matrix
[[1454   33]
 [  20 1466]]
True label 0
0.9778076664425017  
0.02219233355749832  
True label 1
0.013458950201884253  
0.9865410497981157  

Train_result {'acc': [0.9926052543237311], 'loss': [0.025512060128708176]}
Saved model to disk



14

Epoch 1/1
 - 1415s - loss: 0.0216 - acc: 0.9937

Test accuracy: 98.04910864446687

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1467

choose_one :  1506

F1score :  0.9806149732620321

AUC : 0.9978254789603209

Confusion Matrix
[[1448   39]
 [  19 1467]]
True label 0
0.9737726967047747  
0.026227303295225286  
True label 1
0.01278600269179004  
0.9872139973082099  

Train_result {'acc': [0.9936828806064435], 'loss': [0.02164706476401964]}
Saved model to disk



15

Epoch 1/1
 - 1400s - loss: 0.0213 - acc: 0.9939

Test accuracy: 98.55364951227716

data size :  29884

zero :  14943

one :  14941

train_zero :  13456

train_one :  13455

test_zero :  1487

test_one :  1486

choose_zero :  1480

choose_one :  1493

F1score :  0.9855656260490098

AUC : 0.9978942671388914

Confusion Matrix
[[1462   25]
 [  18 1468]]
True label 0
0.9831876260928043  
0.016812373907195696  
True label 1
0.012113055181695828  
0.9878869448183042  

Train_result {'acc': [0.9939058377615102], 'loss': [0.021347306721260395]}
Saved model to disk




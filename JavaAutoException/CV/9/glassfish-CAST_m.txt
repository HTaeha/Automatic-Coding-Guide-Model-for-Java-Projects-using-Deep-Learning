Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-13 10:14:46.056410: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-13 10:14:46.066865: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2099830000 Hz
2019-07-13 10:14:46.069376: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0xf387bd0 executing computations on platform Host. Devices:
2019-07-13 10:14:46.069412: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
25742
one : 
13729

Second data
zero : 
25742
one : 
13729

glassfish-AST

Sentence length Average : 62

Under 10 : 0
Over 10, Under 200 : 16457
Over 200, Under 400 : 807
Over 400 : 0


glassfish-code

Sentence length Average : 78

Under 10 : 0
Over 10, Under 200 : 15838
Over 200, Under 400 : 1426
Over 400 : 0


Test_zero:  1023
Train_zero:  9085
zero:  10108
Test_one:  902
Train_one:  8179
one:  9081
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 661s - loss: 0.4345 - acc: 0.7981

Test accuracy: 85.3185595567867

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  966

choose_one :  839

F1score :  0.8477886272257323

AUC : 0.930595968599372

Confusion Matrix
[[802 101]
 [164 738]]
True label 0
0.8881506090808416  
0.11184939091915837  
True label 1
0.18181818181818182  
0.8181818181818182  

Train_result {'loss': [0.43448000311354157], 'acc': [0.7980927929580047]}
Saved model to disk



2

Epoch 1/1
 - 659s - loss: 0.3013 - acc: 0.8699

Test accuracy: 87.03601108033241

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  961

choose_one :  844

F1score :  0.865979381443299

AUC : 0.9434110982607864

Confusion Matrix
[[815  88]
 [146 756]]
True label 0
0.902547065337763  
0.09745293466223699  
True label 1
0.16186252771618626  
0.8381374722838137  

Train_result {'loss': [0.30132980977767865], 'acc': [0.8698575707561587]}
Saved model to disk



3

Epoch 1/1
 - 659s - loss: 0.2650 - acc: 0.8859

Test accuracy: 84.0443213296399

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  753

choose_one :  1052

F1score :  0.8526100307062435

AUC : 0.9493779051351372

Confusion Matrix
[[684 219]
 [ 69 833]]
True label 0
0.7574750830564784  
0.2425249169435216  
True label 1
0.07649667405764966  
0.9235033259423503  

Train_result {'loss': [0.2650461337612867], 'acc': [0.8858732196453826]}
Saved model to disk



4

Epoch 1/1
 - 659s - loss: 0.2299 - acc: 0.9045

Test accuracy: 89.69529085872577

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  991

choose_one :  814

F1score :  0.8916083916083917

AUC : 0.9583821359204229

Confusion Matrix
[[854  49]
 [137 765]]
True label 0
0.9457364341085271  
0.05426356589147287  
True label 1
0.15188470066518847  
0.8481152993348116  

Train_result {'loss': [0.22985664360966204], 'acc': [0.9044562626077388]}
Saved model to disk



5

Epoch 1/1
 - 671s - loss: 0.2047 - acc: 0.9161

Test accuracy: 90.19390581717451

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  1000

choose_one :  805

F1score :  0.8963093145869948

AUC : 0.9646742933753711

Confusion Matrix
[[863  40]
 [137 765]]
True label 0
0.955703211517165  
0.044296788482835  
True label 1
0.15188470066518847  
0.8481152993348116  

Train_result {'loss': [0.2046937128887955], 'acc': [0.9161317928968763]}
Saved model to disk



6

Epoch 1/1
 - 671s - loss: 0.1784 - acc: 0.9279

Test accuracy: 88.80886426592798

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  841

choose_one :  964

F1score :  0.8917470525187567

AUC : 0.9613170437050187

Confusion Matrix
[[771 132]
 [ 70 832]]
True label 0
0.8538205980066446  
0.1461794019933555  
True label 1
0.07760532150776053  
0.9223946784922394  

Train_result {'loss': [0.1784074225337328], 'acc': [0.9279295800513238]}
Saved model to disk



7

Epoch 1/1
 - 671s - loss: 0.1592 - acc: 0.9377

Test accuracy: 89.63988919667591

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  910

choose_one :  895

F1score :  0.8959376739009459

AUC : 0.9645822130223718

Confusion Matrix
[[813  90]
 [ 97 805]]
True label 0
0.9003322259136213  
0.09966777408637874  
True label 1
0.10753880266075388  
0.8924611973392461  

Train_result {'loss': [0.1591741751028602], 'acc': [0.937710128980989]}
Saved model to disk



8

Epoch 1/1
 - 670s - loss: 0.1361 - acc: 0.9499

Test accuracy: 90.30470914127424

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  860

choose_one :  945

F1score :  0.9052517596101787

AUC : 0.9665306332918358

Confusion Matrix
[[794 109]
 [ 66 836]]
True label 0
0.8792912513842747  
0.12070874861572536  
True label 1
0.07317073170731707  
0.926829268292683  

Train_result {'loss': [0.13614979791673298], 'acc': [0.949874686724079]}
Saved model to disk



9

Epoch 1/1
 - 671s - loss: 0.1116 - acc: 0.9573

Test accuracy: 89.91689750692521

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  883

choose_one :  922

F1score :  0.900219298245614

AUC : 0.9635644181872202

Confusion Matrix
[[802 101]
 [ 81 821]]
True label 0
0.8881506090808416  
0.11184939091915837  
True label 1
0.08980044345898004  
0.9101995565410199  

Train_result {'loss': [0.1116291184216971], 'acc': [0.9572712268476068]}
Saved model to disk



10

Epoch 1/1
 - 670s - loss: 0.0986 - acc: 0.9625

Test accuracy: 91.68975069252078

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  965

choose_one :  840

F1score :  0.9138920780711824

AUC : 0.9680094437610037

Confusion Matrix
[[859  44]
 [106 796]]
True label 0
0.9512735326688815  
0.048726467331118496  
True label 1
0.11751662971175167  
0.8824833702882483  

Train_result {'loss': [0.0986164803249302], 'acc': [0.9625282718992604]}
Saved model to disk



11

Epoch 1/1
 - 669s - loss: 0.0797 - acc: 0.9720

Test accuracy: 91.3573407202216

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  919

choose_one :  886

F1score :  0.912751677852349

AUC : 0.9637504205002787

Confusion Matrix
[[833  70]
 [ 86 816]]
True label 0
0.9224806201550387  
0.07751937984496124  
True label 1
0.09534368070953436  
0.9046563192904656  

Train_result {'loss': [0.0797224158831562], 'acc': [0.9720031786784034]}
Saved model to disk



12

Epoch 1/1
 - 671s - loss: 0.0709 - acc: 0.9751

Test accuracy: 90.803324099723

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  895

choose_one :  910

F1score :  0.9083885209713024

AUC : 0.9623422049684103

Confusion Matrix
[[816  87]
 [ 79 823]]
True label 0
0.9036544850498339  
0.09634551495016612  
True label 1
0.08758314855875832  
0.9124168514412417  

Train_result {'loss': [0.07090791884286941], 'acc': [0.9750596002200623]}
Saved model to disk



13

Epoch 1/1
 - 672s - loss: 0.0584 - acc: 0.9791

Test accuracy: 90.74792243767314

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  890

choose_one :  915

F1score :  0.9080902586681343

AUC : 0.966138370988059

Confusion Matrix
[[813  90]
 [ 77 825]]
True label 0
0.9003322259136213  
0.09966777408637874  
True label 1
0.08536585365853659  
0.9146341463414634  

Train_result {'loss': [0.05844660254496608], 'acc': [0.9790940766550522]}
Saved model to disk



14

Epoch 1/1
 - 672s - loss: 0.0527 - acc: 0.9832

Test accuracy: 91.24653739612188

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  911

choose_one :  894

F1score :  0.9120267260579065

AUC : 0.964936415446909

Confusion Matrix
[[828  75]
 [ 83 819]]
True label 0
0.9169435215946844  
0.08305647840531562  
True label 1
0.09201773835920177  
0.9079822616407982  

Train_result {'loss': [0.05268649128810075], 'acc': [0.9831896815245189]}
Saved model to disk



15

Epoch 1/1
 - 670s - loss: 0.0438 - acc: 0.9839

Test accuracy: 90.74792243767314

data size :  18164

zero :  9083

one :  9081

train_zero :  8180

train_one :  8179

test_zero :  903

test_one :  902

choose_zero :  872

choose_one :  933

F1score :  0.908991825613079

AUC : 0.9665926340628552

Confusion Matrix
[[804  99]
 [ 68 834]]
True label 0
0.8903654485049833  
0.10963455149501661  
True label 1
0.07538802660753881  
0.9246119733924612  

Train_result {'loss': [0.04383838986388422], 'acc': [0.9839232226908735]}
Saved model to disk




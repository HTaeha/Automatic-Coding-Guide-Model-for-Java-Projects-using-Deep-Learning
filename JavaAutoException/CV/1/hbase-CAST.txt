Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-02 01:13:03.902721: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-02 01:13:03.907110: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-02 01:13:03.909976: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x732e3a0 executing computations on platform Host. Devices:
2019-07-02 01:13:03.910061: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST
all data

Sentence length Average : 100

Under 10 : 6634
Over 10, Under 200 : 35615
Over 200, Under 400 : 4427
Over 400 : 2577

hbase-CAST
updated_train_data

Sentence length Average : 97

Under 10 : 0
Over 10, Under 200 : 31897
Over 200, Under 400 : 6128
Over 400 : 0


Test_zero:  2033
Train_zero:  18299
zero:  20332
Test_one:  2159
Train_one:  19726
one:  21885

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 862s - loss: 0.3865 - acc: 0.8249

Test accuracy: 83.55052864519301

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  1686

choose_one :  2381

F1score :  0.8484711211778029

AUC : 0.9364633014455196

Confusion Matrix
[[1525  508]
 [ 161 1873]]
True label 0
0.750122970978849  
0.249877029021151  
True label 1
0.0791543756145526  
0.9208456243854474  

Train_result {'acc': [0.8248586026826625], 'loss': [0.3864854795161992]}
Saved model to disk



2

Epoch 1/1
 - 881s - loss: 0.2863 - acc: 0.8742

Test accuracy: 87.11581017949348

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2081

choose_one :  1986

F1score :  0.8696517412935324

AUC : 0.9492222962224574

Confusion Matrix
[[1795  238]
 [ 286 1748]]
True label 0
0.88293162813576  
0.11706837186424005  
True label 1
0.14060963618485742  
0.8593903638151426  

Train_result {'acc': [0.874231536362861], 'loss': [0.28634537967385715]}
Saved model to disk



3

Epoch 1/1
 - 881s - loss: 0.2486 - acc: 0.8944

Test accuracy: 88.54192279321367

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2157

choose_one :  1910

F1score :  0.8818458417849899

AUC : 0.958734953890115

Confusion Matrix
[[1862  171]
 [ 295 1739]]
True label 0
0.9158878504672897  
0.08411214953271028  
True label 1
0.14503441494591937  
0.8549655850540806  

Train_result {'acc': [0.8943686985804079], 'loss': [0.24861121473098968]}
Saved model to disk



4

Epoch 1/1
 - 882s - loss: 0.2200 - acc: 0.9079

Test accuracy: 89.20580280304893

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2166

choose_one :  1901

F1score :  0.8884371029224905

AUC : 0.9623671320942888

Confusion Matrix
[[1880  153]
 [ 286 1748]]
True label 0
0.9247417609444171  
0.07525823905558288  
True label 1
0.14060963618485742  
0.8593903638151426  

Train_result {'acc': [0.907948304611515], 'loss': [0.22000982540448985]}
Saved model to disk



5

Epoch 1/1
 - 885s - loss: 0.1947 - acc: 0.9215

Test accuracy: 89.18121465453652

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2117

choose_one :  1950

F1score :  0.8895582329317269

AUC : 0.964412416368852

Confusion Matrix
[[1855  178]
 [ 262 1772]]
True label 0
0.912444663059518  
0.08755533694048205  
True label 1
0.1288102261553589  
0.8711897738446411  

Train_result {'acc': [0.9215005874428587], 'loss': [0.1946789026366234]}
Saved model to disk



6

Epoch 1/1
 - 881s - loss: 0.1706 - acc: 0.9317

Test accuracy: 90.18932874354562

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2198

choose_one :  1869

F1score :  0.897770945426595

AUC : 0.9680149702959187

Confusion Matrix
[[1916  117]
 [ 282 1752]]
True label 0
0.9424495818986719  
0.057550418101328084  
True label 1
0.13864306784660768  
0.8613569321533924  

Train_result {'acc': [0.9317467690439197], 'loss': [0.17063496446618617]}
Saved model to disk



7

Epoch 1/1
 - 879s - loss: 0.1525 - acc: 0.9402

Test accuracy: 89.99262355544627

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2052

choose_one :  2015

F1score :  0.8994813534205977

AUC : 0.9671188661422806

Confusion Matrix
[[1839  194]
 [ 213 1821]]
True label 0
0.9045745204131825  
0.0954254795868175  
True label 1
0.10471976401179942  
0.8952802359882006  

Train_result {'acc': [0.9401896226493716], 'loss': [0.15252622435231616]}
Saved model to disk



8

Epoch 1/1
 - 877s - loss: 0.1346 - acc: 0.9474

Test accuracy: 90.55815097123187

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2083

choose_one :  1984

F1score :  0.9044300647088104

AUC : 0.9686912502218799

Confusion Matrix
[[1866  167]
 [ 217 1817]]
True label 0
0.9178553861288736  
0.08214461387112641  
True label 1
0.10668633235004917  
0.8933136676499508  

Train_result {'acc': [0.9474029345129217], 'loss': [0.13462302019909342]}
Saved model to disk



9

Epoch 1/1
 - 881s - loss: 0.1191 - acc: 0.9548

Test accuracy: 90.63191541676912

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2122

choose_one :  1945

F1score :  0.9042472983161599

AUC : 0.9695331842688074

Confusion Matrix
[[1887  146]
 [ 235 1799]]
True label 0
0.9281849483521889  
0.07181505164781112  
True label 1
0.11553588987217306  
0.884464110127827  

Train_result {'acc': [0.9547528621000574], 'loss': [0.11913595263711581]}
Saved model to disk



10

Epoch 1/1
 - 880s - loss: 0.1054 - acc: 0.9610

Test accuracy: 90.73026801081878

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2102

choose_one :  1965

F1score :  0.905726431607902

AUC : 0.9677286425890217

Confusion Matrix
[[1879  154]
 [ 223 1811]]
True label 0
0.9242498770290212  
0.07575012297097884  
True label 1
0.1096361848574238  
0.8903638151425762  

Train_result {'acc': [0.9610371868148971], 'loss': [0.10539044806479109]}
Saved model to disk



11

Epoch 1/1
 - 881s - loss: 0.0946 - acc: 0.9658

Test accuracy: 90.55815097123187

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2033

choose_one :  2034

F1score :  0.9056047197640118

AUC : 0.9671590100606464

Confusion Matrix
[[1841  192]
 [ 192 1842]]
True label 0
0.9055582882439744  
0.09444171175602557  
True label 1
0.0943952802359882  
0.9056047197640118  

Train_result {'acc': [0.9658187382168911], 'loss': [0.09456752443938508]}
Saved model to disk



12

Epoch 1/1
 - 883s - loss: 0.0879 - acc: 0.9693

Test accuracy: 90.82862060486845

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2162

choose_one :  1905

F1score :  0.9053059152069052

AUC : 0.969636446034724

Confusion Matrix
[[1911  122]
 [ 251 1783]]
True label 0
0.9399901623216921  
0.06000983767830792  
True label 1
0.12340216322517207  
0.8765978367748279  

Train_result {'acc': [0.9692614552310173], 'loss': [0.0879052590833312]}
Saved model to disk



13

Epoch 1/1
 - 884s - loss: 0.0800 - acc: 0.9711

Test accuracy: 90.65650356528153

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  1997

choose_one :  2070

F1score :  0.9074074074074074

AUC : 0.9686270441355781

Confusion Matrix
[[1825  208]
 [ 172 1862]]
True label 0
0.897688145597639  
0.10231185440236104  
True label 1
0.08456243854473942  
0.9154375614552606  

Train_result {'acc': [0.9711467526500291], 'loss': [0.07997418768728519]}
Saved model to disk



14

Epoch 1/1
 - 879s - loss: 0.0712 - acc: 0.9742

Test accuracy: 90.92697319891812

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2024

choose_one :  2043

F1score :  0.9094922737306844

AUC : 0.9673968506854211

Confusion Matrix
[[1844  189]
 [ 180 1854]]
True label 0
0.9070339399901624  
0.09296606000983768  
True label 1
0.08849557522123894  
0.911504424778761  

Train_result {'acc': [0.9741796223940545], 'loss': [0.07115377282327312]}
Saved model to disk



15

Epoch 1/1
 - 881s - loss: 0.0704 - acc: 0.9769

Test accuracy: 90.73026801081878

data size :  40666

zero :  20332

one :  20334

train_zero :  18299

train_one :  18300

test_zero :  2033

test_one :  2034

choose_zero :  2058

choose_one :  2009

F1score :  0.9067524115755627

AUC : 0.9690571402730076

Confusion Matrix
[[1857  176]
 [ 201 1833]]
True label 0
0.9134284308903099  
0.08657156910969012  
True label 1
0.09882005899705015  
0.9011799410029498  

Train_result {'acc': [0.9768572911828192], 'loss': [0.07043689611321594]}
Saved model to disk




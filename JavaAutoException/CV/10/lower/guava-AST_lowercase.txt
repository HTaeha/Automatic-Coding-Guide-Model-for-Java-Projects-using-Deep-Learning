Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:354: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-05-26 01:57:19.471683: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-05-26 01:57:19.478941: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100010000 Hz
2019-05-26 01:57:19.487677: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7992550 executing computations on platform Host. Devices:
2019-05-26 01:57:19.487734: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
41586

one : 
17568
guava-AST
all data

Sentence length Average : 26

Under 10 : 19371
Over 10, Under 200 : 39434
Over 200, Under 400 : 325
Over 400 : 24

guava-AST
updated_train_data

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 35505
Over 200, Under 400 : 307
Over 400 : 0


Test_zero:  2417
Train_zero:  22212
zero:  24629
Test_one:  1552
Train_one:  13600
one:  15152

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1638s - loss: 0.3449 - acc: 0.8478

Test accuracy: 86.76328502415458

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1874

choose_one :  1231

F1score :  0.8523176428314768

AUC : 0.9407780750260553

Confusion Matrix
[[1508   45]
 [ 366 1186]]
True label 0
0.9710238248551192  
0.028976175144880875  
True label 1
0.23582474226804123  
0.7641752577319587  

Train_result {'loss': [0.344883451310244], 'acc': [0.8477997132458366]}
Saved model to disk



2

Epoch 1/1
 - 1861s - loss: 0.2725 - acc: 0.8836

Test accuracy: 90.49919484702093

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1664

choose_one :  1441

F1score :  0.9014366855997327

AUC : 0.960824078438141

Confusion Matrix
[[1461   92]
 [ 203 1349]]
True label 0
0.9407598197037991  
0.0592401802962009  
True label 1
0.13079896907216496  
0.8692010309278351  

Train_result {'loss': [0.27248045915404884], 'acc': [0.8836439836770706]}
Saved model to disk



3

Epoch 1/1
 - 1845s - loss: 0.2383 - acc: 0.9007

Test accuracy: 88.66344605475041

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1411

choose_one :  1694

F1score :  0.8915588416512631

AUC : 0.9666715900717601

Confusion Matrix
[[1306  247]
 [ 105 1447]]
True label 0
0.840952994204765  
0.15904700579523504  
True label 1
0.06765463917525773  
0.9323453608247423  

Train_result {'loss': [0.23830272355441998], 'acc': [0.9007389434211978]}
Saved model to disk



4

Epoch 1/1
 - 1844s - loss: 0.2134 - acc: 0.9146

Test accuracy: 91.52979066022544

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1666

choose_one :  1439

F1score :  0.9120695419592109

AUC : 0.9750532723494932

Confusion Matrix
[[1478   75]
 [ 188 1364]]
True label 0
0.9517063747585319  
0.04829362524146812  
True label 1
0.1211340206185567  
0.8788659793814433  

Train_result {'loss': [0.21335593050119872], 'acc': [0.9145987279879416]}
Saved model to disk



5

Epoch 1/1
 - 1537s - loss: 0.1817 - acc: 0.9268

Test accuracy: 92.46376811594203

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1673

choose_one :  1432

F1score :  0.9215817694369972

AUC : 0.9767941662628369

Confusion Matrix
[[1496   57]
 [ 177 1375]]
True label 0
0.9632968448164843  
0.03670315518351577  
True label 1
0.11404639175257732  
0.8859536082474226  

Train_result {'loss': [0.18172036691720153], 'acc': [0.9268041616117054]}
Saved model to disk



6

Epoch 1/1
 - 1535s - loss: 0.1619 - acc: 0.9367

Test accuracy: 92.914653784219

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1641

choose_one :  1464

F1score :  0.9270557029177718

AUC : 0.980728603102741

Confusion Matrix
[[1487   66]
 [ 154 1398]]
True label 0
0.9575016097875081  
0.04249839021249195  
True label 1
0.09922680412371133  
0.9007731958762887  

Train_result {'loss': [0.1618745463105063], 'acc': [0.9366567405610088]}
Saved model to disk



7

Epoch 1/1
 - 1543s - loss: 0.1431 - acc: 0.9440

Test accuracy: 93.65539452495975

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1530

choose_one :  1575

F1score :  0.9370003197953309

AUC : 0.9836258057235414

Confusion Matrix
[[1443  110]
 [  87 1465]]
True label 0
0.9291693496458467  
0.07083065035415326  
True label 1
0.05605670103092784  
0.9439432989690721  

Train_result {'loss': [0.14307042907833706], 'acc': [0.9440461747729862]}
Saved model to disk



8

Epoch 1/1
 - 1533s - loss: 0.1245 - acc: 0.9526

Test accuracy: 94.13848631239937

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1493

choose_one :  1612

F1score :  0.9424778761061947

AUC : 0.9850192261734854

Confusion Matrix
[[1432  121]
 [  61 1491]]
True label 0
0.9220862846104314  
0.07791371538956858  
True label 1
0.039304123711340205  
0.9606958762886598  

Train_result {'loss': [0.12449452072170517], 'acc': [0.952612036322194]}
Saved model to disk



9

Epoch 1/1
 - 1551s - loss: 0.1112 - acc: 0.9586

Test accuracy: 94.91143317230274

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1575

choose_one :  1530

F1score :  0.9487345879299157

AUC : 0.9872420191050245

Confusion Matrix
[[1485   68]
 [  90 1462]]
True label 0
0.9562137797810689  
0.0437862202189311  
True label 1
0.05798969072164949  
0.9420103092783505  

Train_result {'loss': [0.11117889921601935], 'acc': [0.9586412264254991]}
Saved model to disk



10

Epoch 1/1
 - 1566s - loss: 0.1019 - acc: 0.9628

Test accuracy: 94.36392914653784

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1510

choose_one :  1595

F1score :  0.9443914839529711

AUC : 0.9866159445303735

Confusion Matrix
[[1444  109]
 [  66 1486]]
True label 0
0.9298132646490663  
0.07018673535093367  
True label 1
0.04252577319587629  
0.9574742268041238  

Train_result {'loss': [0.10194270468872767], 'acc': [0.9627587221058049]}
Saved model to disk



11

Epoch 1/1
 - 1565s - loss: 0.0920 - acc: 0.9652

Test accuracy: 94.97584541062803

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1513

choose_one :  1592

F1score :  0.9503816793893131

AUC : 0.9889907959984334

Confusion Matrix
[[1455   98]
 [  58 1494]]
True label 0
0.9368963296844817  
0.06310367031551835  
True label 1
0.037371134020618556  
0.9626288659793815  

Train_result {'loss': [0.09202547568793218], 'acc': [0.9651851034888423]}
Saved model to disk



12

Epoch 1/1
 - 1553s - loss: 0.0848 - acc: 0.9686

Test accuracy: 94.91143317230274

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1547

choose_one :  1558

F1score :  0.9491961414790996

AUC : 0.9902491685530499

Confusion Matrix
[[1471   82]
 [  76 1476]]
True label 0
0.9471989697359948  
0.05280103026400515  
True label 1
0.04896907216494845  
0.9510309278350515  

Train_result {'loss': [0.08483605669190761], 'acc': [0.9686040954376677]}
Saved model to disk



13

Epoch 1/1
 - 1562s - loss: 0.0789 - acc: 0.9714

Test accuracy: 95.45893719806763

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1542

choose_one :  1563

F1score :  0.9547351524879615

AUC : 0.9886756842426696

Confusion Matrix
[[1477   76]
 [  65 1487]]
True label 0
0.9510624597553123  
0.0489375402446877  
True label 1
0.04188144329896907  
0.958118556701031  

Train_result {'loss': [0.07891061756286125], 'acc': [0.9713981103635896]}
Saved model to disk



14

Epoch 1/1
 - 1541s - loss: 0.0748 - acc: 0.9728

Test accuracy: 96.39291465378422

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1563

choose_one :  1542

F1score :  0.9638009049773756

AUC : 0.9921294667454411

Confusion Matrix
[[1502   51]
 [  61 1491]]
True label 0
0.9671603348358017  
0.032839665164198326  
True label 1
0.039304123711340205  
0.9606958762886598  

Train_result {'loss': [0.07480921434274042], 'acc': [0.9727951178265505]}
Saved model to disk



15

Epoch 1/1
 - 1537s - loss: 0.0714 - acc: 0.9751

Test accuracy: 96.1352657004831

data size :  30306

zero :  15154

one :  15152

train_zero :  13601

train_one :  13600

test_zero :  1553

test_one :  1552

choose_zero :  1587

choose_one :  1518

F1score :  0.9609120521172638

AUC : 0.9908646633386661

Confusion Matrix
[[1510   43]
 [  77 1475]]
True label 0
0.9723116548615582  
0.027688345138441726  
True label 1
0.04961340206185567  
0.9503865979381443  

Train_result {'loss': [0.07142648724086871], 'acc': [0.975147972501011]}
Saved model to disk




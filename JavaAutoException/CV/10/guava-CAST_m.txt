Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
merge_network_2_wordvec_model.py:519: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("ou...)`
  model = Model(input=[input1, input2], output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-13 01:28:13.821250: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-13 01:28:13.832612: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-13 01:28:13.835027: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x8101d20 executing computations on platform Host. Devices:
2019-07-13 01:28:13.835066: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
First data
zero : 
41586
one : 
17568

Second data
zero : 
41586
one : 
17568

guava-AST

Sentence length Average : 36

Under 10 : 0
Over 10, Under 200 : 34933
Over 200, Under 400 : 303
Over 400 : 0


guava-code

Sentence length Average : 54

Under 10 : 0
Over 10, Under 200 : 34324
Over 200, Under 400 : 912
Over 400 : 0


Test_zero:  2370
Train_zero:  21823
zero:  24193
Test_one:  1528
Train_one:  13413
one:  14941
Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
masking_2 (Masking)             (None, 400, 200)     0           input_2[0][0]                    
__________________________________________________________________________________________________
forwards_1 (LSTM)               (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
backwords_1 (LSTM)              (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
forwards_2 (LSTM)               (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
backwards_2 (LSTM)              (None, 256)          467968      masking_2[0][0]                  
__________________________________________________________________________________________________
after_dp_forward_1 (Dropout)    (None, 256)          0           forwards_1[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_1 (Dropout)   (None, 256)          0           backwords_1[0][0]                
__________________________________________________________________________________________________
after_dp_forward_2 (Dropout)    (None, 256)          0           forwards_2[0][0]                 
__________________________________________________________________________________________________
after_dp_backward_2 (Dropout)   (None, 256)          0           backwards_2[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           after_dp_forward_1[0][0]         
                                                                 after_dp_backward_1[0][0]        
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 512)          0           after_dp_forward_2[0][0]         
                                                                 after_dp_backward_2[0][0]        
__________________________________________________________________________________________________
after_dp_1 (Dropout)            (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
after_dp_2 (Dropout)            (None, 512)          0           concatenate_2[0][0]              
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 1024)         0           after_dp_1[0][0]                 
                                                                 after_dp_2[0][0]                 
__________________________________________________________________________________________________
output (Dense)                  (None, 2)            2050        concatenate_3[0][0]              
==================================================================================================
Total params: 1,873,922
Trainable params: 1,873,922
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 1087s - loss: 0.2693 - acc: 0.8903

Test accuracy: 93.0323846908734

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1636

choose_one :  1421

F1score :  0.9277721261444557

AUC : 0.9796722355575798

Confusion Matrix
[[1476   53]
 [ 160 1368]]
True label 0
0.9653368214519293  
0.03466317854807063  
True label 1
0.10471204188481675  
0.8952879581151832  

Train_result {'loss': [0.2692526118579128], 'acc': [0.8902598128750885]}
Saved model to disk



2

Epoch 1/1
 - 1082s - loss: 0.1722 - acc: 0.9340

Test accuracy: 94.63526333006214

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1633

choose_one :  1424

F1score :  0.9444444444444444

AUC : 0.9887343813668723

Confusion Matrix
[[1499   30]
 [ 134 1394]]
True label 0
0.9803793328973185  
0.01962066710268149  
True label 1
0.08769633507853403  
0.912303664921466  

Train_result {'loss': [0.17221772163262355], 'acc': [0.9340216945614492]}
Saved model to disk



3

Epoch 1/1
 - 1084s - loss: 0.1236 - acc: 0.9548

Test accuracy: 95.94373568858357

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1539

choose_one :  1518

F1score :  0.959290873276428

AUC : 0.9910097623947487

Confusion Matrix
[[1472   57]
 [  67 1461]]
True label 0
0.9627207325049052  
0.03727926749509483  
True label 1
0.04384816753926701  
0.956151832460733  

Train_result {'loss': [0.1235766305644113], 'acc': [0.9547843590412644]}
Saved model to disk



4

Epoch 1/1
 - 1088s - loss: 0.0911 - acc: 0.9678

Test accuracy: 96.27085377821393

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1505

choose_one :  1552

F1score :  0.962987012987013

AUC : 0.9930578621348519

Confusion Matrix
[[1460   69]
 [  45 1483]]
True label 0
0.9548724656638325  
0.04512753433616743  
True label 1
0.029450261780104712  
0.9705497382198953  

Train_result {'loss': [0.09109394566610349], 'acc': [0.9677563648563015]}
Saved model to disk



5

Epoch 1/1
 - 1096s - loss: 0.0696 - acc: 0.9760

Test accuracy: 96.46712463199215

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1567

choose_one :  1490

F1score :  0.9642147117296223

AUC : 0.9931276302137728

Confusion Matrix
[[1494   35]
 [  73 1455]]
True label 0
0.9771092217135383  
0.02289077828646174  
True label 1
0.047774869109947646  
0.9522251308900523  

Train_result {'loss': [0.06958466200362867], 'acc': [0.9760316099452044]}
Saved model to disk



6

Epoch 1/1
 - 1095s - loss: 0.0506 - acc: 0.9829

Test accuracy: 97.18678442917893

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1565

choose_one :  1492

F1score :  0.971523178807947

AUC : 0.9957616962118073

Confusion Matrix
[[1504   25]
 [  61 1467]]
True label 0
0.9836494440810988  
0.016350555918901243  
True label 1
0.03992146596858639  
0.9600785340314136  

Train_result {'loss': [0.050633964940704754], 'acc': [0.9828530957617326]}
Saved model to disk



7

Epoch 1/1
 - 1098s - loss: 0.0414 - acc: 0.9870

Test accuracy: 97.74288518155055

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1544

choose_one :  1513

F1score :  0.9773100953633672

AUC : 0.9967512900674225

Confusion Matrix
[[1502   27]
 [  42 1486]]
True label 0
0.9823413996075867  
0.01765860039241334  
True label 1
0.0274869109947644  
0.9725130890052356  

Train_result {'loss': [0.041379306755713705], 'acc': [0.9869907183061841]}
Saved model to disk



8

Epoch 1/1
 - 1096s - loss: 0.0380 - acc: 0.9882

Test accuracy: 97.35034347399412

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1514

choose_one :  1543

F1score :  0.9736242266362748

AUC : 0.9962969415043881

Confusion Matrix
[[1481   48]
 [  33 1495]]
True label 0
0.9686069326357096  
0.031393067364290386  
True label 1
0.021596858638743454  
0.9784031413612565  

Train_result {'loss': [0.03799482880367527], 'acc': [0.9882208223058858]}
Saved model to disk



9

Epoch 1/1
 - 1096s - loss: 0.0289 - acc: 0.9908

Test accuracy: 97.87373241740268

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1508

choose_one :  1549

F1score :  0.9788755281117971

AUC : 0.9971166094254534

Confusion Matrix
[[1486   43]
 [  22 1506]]
True label 0
0.9718770438194899  
0.028122956180510136  
True label 1
0.014397905759162303  
0.9856020942408377  

Train_result {'loss': [0.028855410663625878], 'acc': [0.9907555820628471]}
Saved model to disk



10

Epoch 1/1
 - 1096s - loss: 0.0286 - acc: 0.9916

Test accuracy: 98.10271508014394

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1511

choose_one :  1546

F1score :  0.9811320754716981

AUC : 0.9974966956468143

Confusion Matrix
[[1491   38]
 [  20 1508]]
True label 0
0.9751471550032701  
0.02485284499672989  
True label 1
0.013089005235602094  
0.9869109947643979  

Train_result {'loss': [0.028550187930916893], 'acc': [0.9915756513959817]}
Saved model to disk



11

Epoch 1/1
 - 1105s - loss: 0.0239 - acc: 0.9928

Test accuracy: 98.26627412495911

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1510

choose_one :  1547

F1score :  0.9827642276422763

AUC : 0.9973162830991751

Confusion Matrix
[[1493   36]
 [  17 1511]]
True label 0
0.9764551994767822  
0.02354480052321779  
True label 1
0.01112565445026178  
0.9888743455497382  

Train_result {'loss': [0.023929466591290072], 'acc': [0.9928430312744623]}
Saved model to disk



12

Epoch 1/1
 - 1120s - loss: 0.0231 - acc: 0.9941

Test accuracy: 98.10271508014394

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1503

choose_one :  1554

F1score :  0.9811810512654121

AUC : 0.9971748208287249

Confusion Matrix
[[1487   42]
 [  16 1512]]
True label 0
0.972531066056246  
0.027468933943754086  
True label 1
0.010471204188481676  
0.9895287958115183  

Train_result {'loss': [0.023063928383187524], 'acc': [0.994110411152943]}
Saved model to disk



13

Epoch 1/1
 - 1123s - loss: 0.0198 - acc: 0.9944

Test accuracy: 97.84102060843965

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1503

choose_one :  1554

F1score :  0.9785853341985724

AUC : 0.9969015268508657

Confusion Matrix
[[1483   46]
 [  20 1508]]
True label 0
0.9699149771092217  
0.030085022890778287  
True label 1
0.013089005235602094  
0.9869109947643979  

Train_result {'loss': [0.019780812734005], 'acc': [0.9943713423043948]}
Saved model to disk



14

Epoch 1/1
 - 1122s - loss: 0.0199 - acc: 0.9950

Test accuracy: 98.26627412495911

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1510

choose_one :  1547

F1score :  0.9827642276422763

AUC : 0.9967637027931201

Confusion Matrix
[[1493   36]
 [  17 1511]]
True label 0
0.9764551994767822  
0.02354480052321779  
True label 1
0.01112565445026178  
0.9888743455497382  

Train_result {'loss': [0.01990420845793777], 'acc': [0.9949677563648563]}
Saved model to disk



15

Epoch 1/1
 - 1121s - loss: 0.0181 - acc: 0.9948

Test accuracy: 98.23356231599607

data size :  29884

zero :  14943

one :  14941

train_zero :  13414

train_one :  13413

test_zero :  1529

test_one :  1528

choose_zero :  1517

choose_one :  1540

F1score :  0.9823989569752282

AUC : 0.9976368738421924

Confusion Matrix
[[1496   33]
 [  21 1507]]
True label 0
0.9784172661870504  
0.02158273381294964  
True label 1
0.0137434554973822  
0.9862565445026178  

Train_result {'loss': [0.01812006612980622], 'acc': [0.9948186528497409]}
Saved model to disk




Using TensorFlow backend.
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3368: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
balanced_auto_exception.py:350: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("de..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=output)
WARNING:tensorflow:From /home/2014313303/.local/lib/python3.5/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-07-12 07:10:53.240638: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-07-12 07:10:53.249586: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100220000 Hz
2019-07-12 07:10:53.252100: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x7e60800 executing computations on platform Host. Devices:
2019-07-12 07:10:53.252139: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
zero : 
26081

one : 
23172
hbase-CAST
all data

Sentence length Average : 100

Under 10 : 6634
Over 10, Under 200 : 35615
Over 200, Under 400 : 4427
Over 400 : 2577

hbase-CAST
updated_train_data

Sentence length Average : 97

Under 10 : 0
Over 10, Under 200 : 31890
Over 200, Under 400 : 6111
Over 400 : 0


Test_zero:  2046
Train_zero:  18285
zero:  20331
Test_one:  2169
Train_one:  19716
one:  21885

Count model parameter.
Get a short summary of each layer dimensions and parameters.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 400, 200)     0                                            
__________________________________________________________________________________________________
masking_1 (Masking)             (None, 400, 200)     0           input_1[0][0]                    
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 256)          467968      masking_1[0][0]                  
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 256)          0           lstm_1[0][0]                     
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 256)          0           lstm_2[0][0]                     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 512)          0           dropout_1[0][0]                  
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 2)            1026        dropout_3[0][0]                  
==================================================================================================
Total params: 936,962
Trainable params: 936,962
Non-trainable params: 0
__________________________________________________________________________________________________
1

Epoch 1/1
 - 818s - loss: 0.3905 - acc: 0.8250

Test accuracy: 85.53628145614464

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2230

choose_one :  1863

F1score :  0.8485933503836316

AUC : 0.9436422230085656

Confusion Matrix
[[1842  204]
 [ 388 1659]]
True label 0
0.9002932551319648  
0.09970674486803519  
True label 1
0.1895456765999023  
0.8104543234000977  

Train_result {'loss': [0.3904882325130205], 'acc': [0.8250252932586362]}
Saved model to disk



2

Epoch 1/1
 - 818s - loss: 0.2945 - acc: 0.8720

Test accuracy: 88.22379672611777

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2208

choose_one :  1885

F1score :  0.8774160732451679

AUC : 0.9592149253061366

Confusion Matrix
[[1886  160]
 [ 322 1725]]
True label 0
0.9217986314760508  
0.07820136852394917  
True label 1
0.15730337078651685  
0.8426966292134831  

Train_result {'loss': [0.29449612479198034], 'acc': [0.8720024062993864]}
Saved model to disk



3

Epoch 1/1
 - 818s - loss: 0.2537 - acc: 0.8901

Test accuracy: 88.88345956511117

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2253

choose_one :  1840

F1score :  0.882943143812709

AUC : 0.9645279958129603

Confusion Matrix
[[1922  124]
 [ 331 1716]]
True label 0
0.9393939393939394  
0.06060606060606061  
True label 1
0.1617000488519785  
0.8382999511480215  

Train_result {'loss': [0.2536533866599718], 'acc': [0.89007683685423]}
Saved model to disk



4

Epoch 1/1
 - 819s - loss: 0.2217 - acc: 0.9047

Test accuracy: 89.54312240410457

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2162

choose_one :  1931

F1score :  0.8924082453494218

AUC : 0.9661640356796132

Confusion Matrix
[[1890  156]
 [ 272 1775]]
True label 0
0.9237536656891495  
0.07624633431085044  
True label 1
0.13287738153395212  
0.8671226184660479  

Train_result {'loss': [0.22166630446259739], 'acc': [0.9046512263701503]}
Saved model to disk



5

Epoch 1/1
 - 939s - loss: 0.1978 - acc: 0.9198

Test accuracy: 90.76472025409235

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2096

choose_one :  1997

F1score :  0.9065281899109792

AUC : 0.9712456203938625

Confusion Matrix
[[1882  164]
 [ 214 1833]]
True label 0
0.9198435972629521  
0.0801564027370479  
True label 1
0.10454323400097704  
0.8954567659990229  

Train_result {'loss': [0.19781172462301772], 'acc': [0.9197724973339532]}
Saved model to disk



6

Epoch 1/1
 - 961s - loss: 0.1748 - acc: 0.9295

Test accuracy: 90.93574395309064

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2073

choose_one :  2020

F1score :  0.9087779690189328

AUC : 0.9707229567528668

Confusion Matrix
[[1874  172]
 [ 199 1848]]
True label 0
0.9159335288367546  
0.08406647116324535  
True label 1
0.09721543722520762  
0.9027845627747924  

Train_result {'loss': [0.17483938578936437], 'acc': [0.9295343304690264]}
Saved model to disk



7

Epoch 1/1
 - 956s - loss: 0.1545 - acc: 0.9391

Test accuracy: 90.64256046909357

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2205

choose_one :  1888

F1score :  0.9026683608640406

AUC : 0.9724523549948643

Confusion Matrix
[[1934  112]
 [ 271 1776]]
True label 0
0.9452590420332356  
0.05474095796676442  
True label 1
0.13238886174890083  
0.8676111382510991  

Train_result {'loss': [0.15453882268897745], 'acc': [0.939050067009271]}
Saved model to disk



8

Epoch 1/1
 - 960s - loss: 0.1360 - acc: 0.9467

Test accuracy: 91.00903982408991

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2056

choose_one :  2037

F1score :  0.9098922624877571

AUC : 0.9703153793955439

Confusion Matrix
[[1867  179]
 [ 189 1858]]
True label 0
0.9125122189638318  
0.08748778103616814  
True label 1
0.09233023937469467  
0.9076697606253054  

Train_result {'loss': [0.13603518808154672], 'acc': [0.9467337507747332]}
Saved model to disk



9

Epoch 1/1
 - 961s - loss: 0.1229 - acc: 0.9532

Test accuracy: 91.71756657708282

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2035

choose_one :  2058

F1score :  0.9174177831912304

AUC : 0.9735837582213869

Confusion Matrix
[[1871  175]
 [ 164 1883]]
True label 0
0.9144672531769306  
0.0855327468230694  
True label 1
0.08011724474841231  
0.9198827552515877  

Train_result {'loss': [0.12286083931646542], 'acc': [0.9532416395504635]}
Saved model to disk



10

Epoch 1/1
 - 958s - loss: 0.1088 - acc: 0.9599

Test accuracy: 91.44881505008551

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2018

choose_one :  2075

F1score :  0.9150897622513343

AUC : 0.9727684841226294

Confusion Matrix
[[1857  189]
 [ 161 1886]]
True label 0
0.907624633431085  
0.09237536656891496  
True label 1
0.07865168539325842  
0.9213483146067416  

Train_result {'loss': [0.10876190520150492], 'acc': [0.9598589045851295]}
Saved model to disk



11

Epoch 1/1
 - 953s - loss: 0.0996 - acc: 0.9643

Test accuracy: 91.22892743708772

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2073

choose_one :  2020

F1score :  0.911728546840423

AUC : 0.9703139467862036

Confusion Matrix
[[1880  166]
 [ 193 1854]]
True label 0
0.9188660801564027  
0.08113391984359726  
True label 1
0.09428431851489985  
0.9057156814851002  

Train_result {'loss': [0.09961513334677487], 'acc': [0.9643159880779852]}
Saved model to disk



12

Epoch 1/1
 - 959s - loss: 0.0869 - acc: 0.9697

Test accuracy: 91.52211092108477

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  1981

choose_one :  2112

F1score :  0.9165664823274825

AUC : 0.972365443361551

Confusion Matrix
[[1840  206]
 [ 141 1906]]
True label 0
0.8993157380254154  
0.10068426197458455  
True label 1
0.06888128969223253  
0.9311187103077675  

Train_result {'loss': [0.08694576858902824], 'acc': [0.9697027699543354]}
Saved model to disk



13

Epoch 1/1
 - 917s - loss: 0.0808 - acc: 0.9709

Test accuracy: 90.7402882970926

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2211

choose_one :  1882

F1score :  0.9035377958768135

AUC : 0.970702661453879

Confusion Matrix
[[1939  107]
 [ 272 1775]]
True label 0
0.947702834799609  
0.05229716520039101  
True label 1
0.13287738153395212  
0.8671226184660479  

Train_result {'loss': [0.0808121081690789], 'acc': [0.9709332531403584]}
Saved model to disk



14

Epoch 1/1
 - 867s - loss: 0.0803 - acc: 0.9733

Test accuracy: 90.86244808209138

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  1946

choose_one :  2147

F1score :  0.910824988078207

AUC : 0.9695951350496947

Confusion Matrix
[[1809  237]
 [ 137 1910]]
True label 0
0.8841642228739003  
0.1158357771260997  
True label 1
0.06692721055202736  
0.9330727894479727  

Train_result {'loss': [0.08029067347052928], 'acc': [0.9732574991113178]}
Saved model to disk



15

Epoch 1/1
 - 859s - loss: 0.0763 - acc: 0.9745

Test accuracy: 91.32665526508673

data size :  40664

zero :  20331

one :  20333

train_zero :  18285

train_one :  18286

test_zero :  2046

test_one :  2047

choose_zero :  2017

choose_one :  2076

F1score :  0.9138976473441669

AUC : 0.9709497865650851

Confusion Matrix
[[1854  192]
 [ 163 1884]]
True label 0
0.906158357771261  
0.093841642228739  
True label 1
0.07962872496336101  
0.920371275036639  

Train_result {'loss': [0.076319596471121], 'acc': [0.9745426704105101]}
Saved model to disk



